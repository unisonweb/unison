<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.Attoparsec.ByteString.Buffer</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">attoparsec-0.14.4: Fast combinator parsing for bytestrings and text</span><ul class="links" id="page-menu"><li><a href="src/Data.Attoparsec.ByteString.Buffer.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Bryan O'Sullivan 2007-2015</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>bos@serpentine.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>GHC</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.Attoparsec.ByteString.Buffer</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>An &quot;immutable&quot; buffer that supports cheap appends.</p><p>A Buffer is divided into an immutable read-only zone, followed by a
 mutable area that we've preallocated, but not yet written to.</p><p>We overallocate at the end of a Buffer so that we can cheaply
 append.  Since a user of an existing Buffer cannot see past the end
 of its immutable zone into the data that will change during an
 append, this is safe.</p><p>Once we run out of space at the end of a Buffer, we do the usual
 doubling of the buffer size.</p><p>The fact of having a mutable buffer really helps with performance,
 but it does have a consequence: if someone misuses the Partial API
 that attoparsec uses by calling the same continuation repeatedly
 (which never makes sense in practice), they could overwrite data.</p><p>Since the API *looks* pure, it should *act* pure, too, so we use
 two generation counters (one mutable, one immutable) to track the
 number of appends to a mutable buffer. If the counters ever get out
 of sync, someone is appending twice to a mutable buffer, so we
 duplicate the entire buffer in order to preserve the immutability
 of its older self.</p><p>While we could go a step further and gain protection against API
 abuse on a multicore system, by use of an atomic increment
 instruction to bump the mutable generation counter, that would be
 very expensive, and feels like it would also be in the realm of the
 ridiculous.  Clients should never call a continuation more than
 once; we lack a linear type system that could enforce this; and
 there's only so far we should go to accommodate broken uses.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Buffer">Buffer</a></li><li class="src short"><a href="#v:buffer">buffer</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></li><li class="src short"><a href="#v:unbuffer">unbuffer</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:pappend">pappend</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></li><li class="src short"><a href="#v:length">length</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:unsafeIndex">unsafeIndex</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Word.html#t:Word8" title="Data.Word">Word8</a></li><li class="src short"><a href="#v:substring">substring</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:unsafeDrop">unsafeDrop</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Buffer" class="def">Buffer</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#Buffer" class="link">Source</a> <a href="#t:Buffer" class="selflink">#</a></p><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Buffer">Instances</h4><details id="i:Buffer" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Buffer:Monoid:1"></span> <a href="../base-4.18.2.1/Data-Monoid.html#t:Monoid" title="Data.Monoid">Monoid</a> <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></span> <a href="src/Data.Attoparsec.ByteString.Buffer.html#line-96" class="link">Source</a> <a href="#t:Buffer" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Buffer:Monoid:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Attoparsec-ByteString-Buffer.html">Data.Attoparsec.ByteString.Buffer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mempty">mempty</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:mempty" class="selflink">#</a></p><p class="src"><a href="#v:mappend">mappend</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:mappend" class="selflink">#</a></p><p class="src"><a href="#v:mconcat">mconcat</a> :: [<a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a>] -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:mconcat" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Buffer:Semigroup:2"></span> <a href="../base-4.18.2.1/Prelude.html#t:Semigroup" title="Prelude">Semigroup</a> <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></span> <a href="src/Data.Attoparsec.ByteString.Buffer.html#line-91" class="link">Source</a> <a href="#t:Buffer" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Buffer:Semigroup:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Attoparsec-ByteString-Buffer.html">Data.Attoparsec.ByteString.Buffer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-60--62-">(&lt;&gt;)</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:-60--62-" class="selflink">#</a></p><p class="src"><a href="#v:sconcat">sconcat</a> :: <a href="../base-4.18.2.1/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:sconcat" class="selflink">#</a></p><p class="src"><a href="#v:stimes">stimes</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> b =&gt; b -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="#v:stimes" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Buffer:Show:3"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></span> <a href="src/Data.Attoparsec.ByteString.Buffer.html#line-79" class="link">Source</a> <a href="#t:Buffer" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Buffer:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Attoparsec-ByteString-Buffer.html">Data.Attoparsec.ByteString.Buffer</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:buffer" class="def">buffer</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#buffer" class="link">Source</a> <a href="#v:buffer" class="selflink">#</a></p><div class="doc"><p>The initial <code><a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a></code> has no mutable zone, so we can avoid all
 copies in the (hopefully) common case of no further input being fed
 to us.</p></div></div><div class="top"><p class="src"><a id="v:unbuffer" class="def">unbuffer</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#unbuffer" class="link">Source</a> <a href="#v:unbuffer" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pappend" class="def">pappend</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#pappend" class="link">Source</a> <a href="#v:pappend" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:length" class="def">length</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#length" class="link">Source</a> <a href="#v:length" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unsafeIndex" class="def">unsafeIndex</a> :: <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Word.html#t:Word8" title="Data.Word">Word8</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#unsafeIndex" class="link">Source</a> <a href="#v:unsafeIndex" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:substring" class="def">substring</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#substring" class="link">Source</a> <a href="#v:substring" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unsafeDrop" class="def">unsafeDrop</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Attoparsec-ByteString-Buffer.html#t:Buffer" title="Data.Attoparsec.ByteString.Buffer">Buffer</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.Attoparsec.ByteString.Buffer.html#unsafeDrop" class="link">Source</a> <a href="#v:unsafeDrop" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>