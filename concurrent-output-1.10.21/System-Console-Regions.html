<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>System.Console.Regions</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">concurrent-output-1.10.21: Ungarble output from several threads or commands</span><ul class="links" id="page-menu"><li><a href="src/System.Console.Regions.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>2015 Joey Hess &lt;id@joeyh.name&gt;</td></tr><tr><th>License</th><td>BSD-2-clause</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">System.Console.Regions</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Initialization</a></li><li><a href="#g:3">Region content and display</a></li><li><a href="#g:4">STM region contents</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Console regions are displayed near the bottom of the console, and can be
 updated concurrently by threads. </p><p>Any other output lines displayed using
 <code><a href="System-Console-Concurrent-Internal.html#v:outputConcurrent" title="System.Console.Concurrent.Internal">outputConcurrent</a></code> and <code><a href="System-Console-Concurrent-Internal.html#v:createProcessConcurrent" title="System.Console.Concurrent.Internal">createProcessConcurrent</a></code>
 will scroll up above the open console regions.</p><p>For example, this program:</p><pre> import Control.Concurrent.Async
 import Control.Concurrent
 import System.Console.Concurrent
 import System.Console.Regions
 import System.Process
 
 main = displayConsoleRegions $ do
 	mapConcurrently download [1..5]
		`concurrently` mapM_ message [1..10]
		`concurrently` createProcessConcurrent (proc &quot;echo&quot; [&quot;hello world&quot;])
 
 message :: Int -&gt; IO ()
 message n = do
 	threadDelay 500000
 	outputConcurrent (&quot;Message &quot; ++ show n ++ &quot;\n&quot;)
 
 download :: Int -&gt; IO ()
 download n = withConsoleRegion Linear $ \r -&gt; do
 	setConsoleRegion r basemsg
 	go n r
   where
 	basemsg = &quot;Download &quot; ++ show n
	go c r
		| c &lt; 1 = finishConsoleRegion r (basemsg ++ &quot; done!&quot;)
 		| otherwise = do
 			threadDelay 1000000
 			appendConsoleRegion r &quot; ... &quot;
 			go (c-1) r</pre><p>Will display like this:</p><pre>Message 1
hello world
Message 2
Download 1 ...
Download 2 ...
Download 3 ...</pre><p>Once the 1st download has finished, and another message has displayed,
 the console will update like this:</p><pre>Message 1
hello world
Message 2
Download 1 done!
Message 3
Download 2 ... ...
Download 3 ... ...</pre></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:ConsoleRegion">ConsoleRegion</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:RegionLayout">RegionLayout</a><ul class="subs"><li>= <a href="#v:Linear">Linear</a></li><li>| <a href="#v:InLine">InLine</a> <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a></li></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:ToRegionContent">ToRegionContent</a> v <span class="keyword">where</span><ul class="subs"><li><a href="#v:toRegionContent">toRegionContent</a> :: v -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a></li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:RegionContent">RegionContent</a> = <a href="#v:RegionContent">RegionContent</a> (<a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><span class="keyword">class</span> <a href="#t:LiftRegion">LiftRegion</a> m <span class="keyword">where</span><ul class="subs"><li><a href="#v:liftRegion">liftRegion</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; m a</li></ul></li><li class="src short"><a href="#v:displayConsoleRegions">displayConsoleRegions</a> :: (<a href="../base-4.18.2.1/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../exceptions-0.10.7/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m) =&gt; m a -&gt; m a</li><li class="src short"><a href="#v:withConsoleRegion">withConsoleRegion</a> :: (<a href="../base-4.18.2.1/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../exceptions-0.10.7/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m) =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; (<a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m a) -&gt; m a</li><li class="src short"><a href="#v:openConsoleRegion">openConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; m <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a></li><li class="src short"><a href="#v:newConsoleRegion">newConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> v =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; v -&gt; m <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a></li><li class="src short"><a href="#v:closeConsoleRegion">closeConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m ()</li><li class="src short"><a href="#v:setConsoleRegion">setConsoleRegion</a> :: (<a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m ()</li><li class="src short"><a href="#v:appendConsoleRegion">appendConsoleRegion</a> :: (<a href="System-Console-Concurrent-Internal.html#t:Outputable" title="System.Console.Concurrent.Internal">Outputable</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m ()</li><li class="src short"><a href="#v:finishConsoleRegion">finishConsoleRegion</a> :: (<a href="System-Console-Concurrent-Internal.html#t:Outputable" title="System.Console.Concurrent.Internal">Outputable</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m ()</li><li class="src short"><a href="#v:getConsoleRegion">getConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:tuneDisplay">tuneDisplay</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; (<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; m ()</li><li class="src short"><a href="#v:consoleWidth">consoleWidth</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:consoleHeight">consoleHeight</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:regionList">regionList</a> :: <a href="../stm-2.5.1.0/Control-Concurrent-STM-TMVar.html#t:TMVar" title="Control.Concurrent.STM.TMVar">TMVar</a> [<a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a>]</li><li class="src short"><a href="#v:waitDisplayChange">waitDisplayChange</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Types</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ConsoleRegion" class="def">ConsoleRegion</a> <a href="src/System.Console.Regions.html#ConsoleRegion" class="link">Source</a> <a href="#t:ConsoleRegion" class="selflink">#</a></p><div class="doc"><p>A handle allowing access to a region of the console.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ConsoleRegion">Instances</h4><details id="i:ConsoleRegion" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ConsoleRegion:Eq:1"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a></span> <a href="src/System.Console.Regions.html#line-167" class="link">Source</a> <a href="#t:ConsoleRegion" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ConsoleRegion:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RegionLayout" class="def">RegionLayout</a> <a href="src/System.Console.Regions.html#RegionLayout" class="link">Source</a> <a href="#t:RegionLayout" class="selflink">#</a></p><div class="doc"><p>Controls how a region is laid out in the console.</p><p>Here's an annotated example of how the console layout works.
 Each sequence of the same letter represents a distinct region.</p><pre>scrolling......
scrolling......
scrolling......
aaaaaa......... -- Linear
bbbbbbbbbbbbbbb -- Linear
bbb............       (expanded to multiple lines)
ccccccccc...... -- Linear
ddddeeeefffffff -- [InLine]
fffffggggg.....       (expanded to multiple lines)
</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Linear" class="def">Linear</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:InLine" class="def">InLine</a> <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RegionLayout">Instances</h4><details id="i:RegionLayout" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RegionLayout:Eq:1"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a></span> <a href="src/System.Console.Regions.html#line-163" class="link">Source</a> <a href="#t:RegionLayout" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RegionLayout:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:ToRegionContent" class="def">ToRegionContent</a> v <span class="keyword">where</span> <a href="src/System.Console.Regions.html#ToRegionContent" class="link">Source</a> <a href="#t:ToRegionContent" class="selflink">#</a></p><div class="doc"><p>Values that can be displayed in a region.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:toRegionContent" class="def">toRegionContent</a> :: v -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a> <a href="src/System.Console.Regions.html#toRegionContent" class="link">Source</a> <a href="#v:toRegionContent" class="selflink">#</a></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ToRegionContent">Instances</h4><details id="i:ToRegionContent" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ToRegionContent:ToRegionContent:1"></span> <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></span> <a href="src/System.Console.Regions.html#line-248" class="link">Source</a> <a href="#t:ToRegionContent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:ToRegionContent:ToRegionContent:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRegionContent">toRegionContent</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a> <a href="src/System.Console.Regions.html#toRegionContent" class="link">Source</a> <a href="#v:toRegionContent" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ToRegionContent:ToRegionContent:2"></span> <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> <a href="../text-2.0.2/Data-Text-Lazy.html#t:Text" title="Data.Text.Lazy">Text</a></span> <a href="src/System.Console.Regions.html#line-252" class="link">Source</a> <a href="#t:ToRegionContent" class="selflink">#</a></td><td class="doc"><p>Note that using a lazy Text in a region will buffer it all in memory.</p></td></tr><tr><td colspan="2"><details id="i:ic:ToRegionContent:ToRegionContent:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRegionContent">toRegionContent</a> :: <a href="../text-2.0.2/Data-Text-Lazy.html#t:Text" title="Data.Text.Lazy">Text</a> -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a> <a href="src/System.Console.Regions.html#toRegionContent" class="link">Source</a> <a href="#v:toRegionContent" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ToRegionContent:ToRegionContent:3"></span> <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></span> <a href="src/System.Console.Regions.html#line-245" class="link">Source</a> <a href="#t:ToRegionContent" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:ToRegionContent:ToRegionContent:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRegionContent">toRegionContent</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a> <a href="src/System.Console.Regions.html#toRegionContent" class="link">Source</a> <a href="#v:toRegionContent" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:ToRegionContent:ToRegionContent:4"></span> <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> (<a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</span> <a href="src/System.Console.Regions.html#line-262" class="link">Source</a> <a href="#t:ToRegionContent" class="selflink">#</a></td><td class="doc"><p>Makes a STM action be run to get the content of a region.</p><p>Any change to the values that action reads will result in an immediate
 refresh of the display.</p></td></tr><tr><td colspan="2"><details id="i:ic:ToRegionContent:ToRegionContent:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toRegionContent">toRegionContent</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Console-Regions.html#t:RegionContent" title="System.Console.Regions">RegionContent</a> <a href="src/System.Console.Regions.html#toRegionContent" class="link">Source</a> <a href="#v:toRegionContent" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:RegionContent" class="def">RegionContent</a> <a href="src/System.Console.Regions.html#RegionContent" class="link">Source</a> <a href="#t:RegionContent" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RegionContent" class="def">RegionContent</a> (<a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:LiftRegion" class="def">LiftRegion</a> m <span class="keyword">where</span> <a href="src/System.Console.Regions.html#LiftRegion" class="link">Source</a> <a href="#t:LiftRegion" class="selflink">#</a></p><div class="doc"><p>Many actions in this module can be run in either the IO monad
 or the STM monad. Using STM allows making several changes to the
 displayed regions atomically, with the display updated a single time.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:liftRegion" class="def">liftRegion</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; m a <a href="src/System.Console.Regions.html#liftRegion" class="link">Source</a> <a href="#v:liftRegion" class="selflink">#</a></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:LiftRegion">Instances</h4><details id="i:LiftRegion" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:LiftRegion:LiftRegion:1"></span> <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a></span> <a href="src/System.Console.Regions.html#line-235" class="link">Source</a> <a href="#t:LiftRegion" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:LiftRegion:LiftRegion:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftRegion">liftRegion</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a <a href="src/System.Console.Regions.html#liftRegion" class="link">Source</a> <a href="#v:liftRegion" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:LiftRegion:LiftRegion:2"></span> <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a></span> <a href="src/System.Console.Regions.html#line-238" class="link">Source</a> <a href="#t:LiftRegion" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:LiftRegion:LiftRegion:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Console-Regions.html">System.Console.Regions</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftRegion">liftRegion</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/System.Console.Regions.html#liftRegion" class="link">Source</a> <a href="#v:liftRegion" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Initialization</h1></a><div class="top"><p class="src"><a id="v:displayConsoleRegions" class="def">displayConsoleRegions</a> :: (<a href="../base-4.18.2.1/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../exceptions-0.10.7/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m) =&gt; m a -&gt; m a <a href="src/System.Console.Regions.html#displayConsoleRegions" class="link">Source</a> <a href="#v:displayConsoleRegions" class="selflink">#</a></p><div class="doc"><p>Handles all display for the other functions in this module.</p><p>Note that this uses <code><a href="System-Console-Concurrent-Internal.html#v:lockOutput" title="System.Console.Concurrent.Internal">lockOutput</a></code>, so it takes over all output to the
 console while the passed IO action is running. As well as displaying
 the console regions, this handles display of anything buffered by
 <code><a href="System-Console-Concurrent-Internal.html#v:outputConcurrent" title="System.Console.Concurrent.Internal">outputConcurrent</a></code> and <code><a href="System-Console-Concurrent-Internal.html#v:createProcessConcurrent" title="System.Console.Concurrent.Internal">createProcessConcurrent</a></code>. So,
 <code><a href="System-Console-Concurrent-Internal.html#v:withConcurrentOutput" title="System.Console.Concurrent.Internal">withConcurrentOutput</a></code> and <code><a href="System-Console-Concurrent-Internal.html#v:flushConcurrentOutput" title="System.Console.Concurrent.Internal">flushConcurrentOutput</a></code> should not be run
 while this is in use, and will block.</p><p>When standard output is not an ANSI capable terminal,
 console regions are not displayed.</p></div></div><div class="top"><p class="src"><a id="v:withConsoleRegion" class="def">withConsoleRegion</a> :: (<a href="../base-4.18.2.1/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="../exceptions-0.10.7/Control-Monad-Catch.html#t:MonadMask" title="Control.Monad.Catch">MonadMask</a> m) =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; (<a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m a) -&gt; m a <a href="src/System.Console.Regions.html#withConsoleRegion" class="link">Source</a> <a href="#v:withConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Runs the action with a new console region, closing the region when
 the action finishes or on exception.</p></div></div><div class="top"><p class="src"><a id="v:openConsoleRegion" class="def">openConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; m <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> <a href="src/System.Console.Regions.html#openConsoleRegion" class="link">Source</a> <a href="#v:openConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Opens a new console region.</p></div></div><div class="top"><p class="src"><a id="v:newConsoleRegion" class="def">newConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> v =&gt; <a href="System-Console-Regions.html#t:RegionLayout" title="System.Console.Regions">RegionLayout</a> -&gt; v -&gt; m <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> <a href="src/System.Console.Regions.html#newConsoleRegion" class="link">Source</a> <a href="#v:newConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Makes a new region, but does not add it to the display.</p></div></div><div class="top"><p class="src"><a id="v:closeConsoleRegion" class="def">closeConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m () <a href="src/System.Console.Regions.html#closeConsoleRegion" class="link">Source</a> <a href="#v:closeConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Closes a console region. Once closed, the region is removed from the
 display.</p></div></div><a href="#g:3" id="g:3"><h1>Region content and display</h1></a><div class="top"><p class="src"><a id="v:setConsoleRegion" class="def">setConsoleRegion</a> :: (<a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m () <a href="src/System.Console.Regions.html#setConsoleRegion" class="link">Source</a> <a href="#v:setConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Sets the value of a console region. This will cause the
 console to be updated to display the new value.</p><p>It's fine for the value to be longer than the terminal is wide,
 or to include newlines ('n'). Regions expand to multiple lines as
 necessary.</p><p>The value can include ANSI SGR escape sequences for changing
 the colors of all or part of a region. For this to display properly,
 a reset escape sequence must be included to get the color back
 to default. System.Console.ANSI makes it easy to construct such
 values. For example:</p><pre> import System.Console.ANSI
 
 setConsoleRegion region 
 	( &quot;hello &quot;
 	&lt;&gt; setSGRCode [SetColor Foreground Vivid Red] 
	&lt;&gt; &quot;Mars&quot; 
	&lt;&gt; setSGRCode [Reset]
 	&lt;&gt; &quot;!&quot;
	)</pre><p>Other ANSI escape sequences, especially those doing cursor
 movement, will mess up the layouts of regions. Caveat emptor.</p><p>ANSI SGR escape sequences that span multiple lines do not currently
 display as you might hope. (Patches would be accepted.)</p></div></div><div class="top"><p class="src"><a id="v:appendConsoleRegion" class="def">appendConsoleRegion</a> :: (<a href="System-Console-Concurrent-Internal.html#t:Outputable" title="System.Console.Concurrent.Internal">Outputable</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m () <a href="src/System.Console.Regions.html#appendConsoleRegion" class="link">Source</a> <a href="#v:appendConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Appends a value to the current value of a console region.</p><pre>appendConsoleRegion progress &quot;.&quot; -- add another dot to progress display</pre></div></div><div class="top"><p class="src"><a id="v:finishConsoleRegion" class="def">finishConsoleRegion</a> :: (<a href="System-Console-Concurrent-Internal.html#t:Outputable" title="System.Console.Concurrent.Internal">Outputable</a> v, <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m) =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; v -&gt; m () <a href="src/System.Console.Regions.html#finishConsoleRegion" class="link">Source</a> <a href="#v:finishConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Closes the console region, and displays the passed value in the
 scrolling area above the active console regions. When Nothing is passed,
 displays the current value of the console region.</p></div></div><div class="top"><p class="src"><a id="v:getConsoleRegion" class="def">getConsoleRegion</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; m <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/System.Console.Regions.html#getConsoleRegion" class="link">Source</a> <a href="#v:getConsoleRegion" class="selflink">#</a></p><div class="doc"><p>Gets the current content of a console region.</p></div></div><div class="top"><p class="src"><a id="v:tuneDisplay" class="def">tuneDisplay</a> :: <a href="System-Console-Regions.html#t:LiftRegion" title="System.Console.Regions">LiftRegion</a> m =&gt; <a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a> -&gt; (<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; m () <a href="src/System.Console.Regions.html#tuneDisplay" class="link">Source</a> <a href="#v:tuneDisplay" class="selflink">#</a></p><div class="doc"><p>Changes how a console region displays.</p><p>Each time the region's value changes, the STM action is provided
 with the current value of the region, and returns the value to display.</p><p>For example, this will prevent a region from ever displaying more
 than 10 characters wide, and will make it display text reversed:</p><pre>tuneDisplay myregion $ pure . T.take 10
tuneDisplay myregion $ pure . T.reverse</pre><p>Note that repeated calls to tuneDisplay are cumulative.</p><p>Normally, the STM action should avoid retrying, as that would
 block all display updates.</p></div></div><a href="#g:4" id="g:4"><h1>STM region contents</h1></a><div class="doc"><p>The <code><a href="System-Console-Regions.html#t:ToRegionContent" title="System.Console.Regions">ToRegionContent</a></code> instance for <code><a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a></code> <code><a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></code> can be used to
 make regions that automatically update whenever there's
 a change to any of the STM values that they use.</p><p>For example, a region that displays the screen size,
 and automatically refreshes it:</p><pre>import qualified Data.Text as T</pre><pre> r &lt;- openConsoleRegion Linear s
 setConsoleRegion r $ do
 	w &lt;- readTVar consoleWidth
 	h &lt;- readTVar consoleHeight
 	return $ T.pack $ unwords
 		[ &quot;size:&quot;
		, show w
 		, &quot;x&quot;
		, show h
 		]
</pre></div><div class="top"><p class="src"><a id="v:consoleWidth" class="def">consoleWidth</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/System.Console.Regions.html#consoleWidth" class="link">Source</a> <a href="#v:consoleWidth" class="selflink">#</a></p><div class="doc"><p>Gets the width of the console.</p><p>On Unix, this is automatically updated when the terminal is resized.
 On Windows, it is determined at start. On WASM,
 the console width is hard coded to 80 since WASI does not provide a way
 to determine it.</p></div></div><div class="top"><p class="src"><a id="v:consoleHeight" class="def">consoleHeight</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/System.Console.Regions.html#consoleHeight" class="link">Source</a> <a href="#v:consoleHeight" class="selflink">#</a></p><div class="doc"><p>Get the height of the console.</p><p>On Unix, this is automatically updated when the terminal is resized.
 On Windows, it is determined at start. On WASM,
 the console heigth is hard coded to 25 since WASI does not provide a way
 to determine it.</p></div></div><div class="top"><p class="src"><a id="v:regionList" class="def">regionList</a> :: <a href="../stm-2.5.1.0/Control-Concurrent-STM-TMVar.html#t:TMVar" title="Control.Concurrent.STM.TMVar">TMVar</a> [<a href="System-Console-Regions.html#t:ConsoleRegion" title="System.Console.Regions">ConsoleRegion</a>] <a href="src/System.Console.Regions.html#regionList" class="link">Source</a> <a href="#v:regionList" class="selflink">#</a></p><div class="doc"><p>All the regions that are currently displayed on the screen.</p><p>The list is ordered from the bottom of the screen up. Reordering
 it will change the order in which regions are displayed.
 It's also fine to remove, duplicate, or add new regions to the list.</p></div></div><div class="top"><p class="src"><a id="v:waitDisplayChange" class="def">waitDisplayChange</a> :: <a href="../base-4.18.2.1/GHC-Conc.html#t:STM" title="GHC.Conc">STM</a> a -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="src/System.Console.Regions.html#waitDisplayChange" class="link">Source</a> <a href="#v:waitDisplayChange" class="selflink">#</a></p><div class="doc"><p>Runs a STM action, and waits for the display to be fully updated
 with any changes that action makes to the displayed regions.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>