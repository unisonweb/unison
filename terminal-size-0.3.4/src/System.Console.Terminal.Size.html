<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="annot"><span class="hs-comment">{- |
Get terminal window height and width without ncurses dependency

Based on answer by Andreas Hammar at &lt;http://stackoverflow.com/a/12807521/972985&gt;
-}</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Console.Terminal.Size</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.Console.Terminal.Common.html#Window"><span class="hs-identifier">Window</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.Terminal.Size.html#size"><span class="hs-identifier">size</span></a></span><span class="hs-cpp">
#if !defined(mingw32_HOST_OS)
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.Terminal.Size.html#fdSize"><span class="hs-identifier">fdSize</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.Terminal.Size.html#hSize"><span class="hs-identifier">hSize</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Console.Terminal.Common.html"><span class="hs-identifier">System.Console.Terminal.Common</span></a></span><span class="hs-cpp">
#if defined(mingw32_HOST_OS)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">System.Console.Terminal.Windows</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Host</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="System.Console.Terminal.Posix.html"><span class="hs-identifier">System.Console.Terminal.Posix</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Host</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Types</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Fd</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Handle</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | Get terminal window width and height for @stdout@.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- &gt;&gt;&gt; import System.Console.Terminal.Size</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;&gt;&gt; size</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Just (Window {height = 60, width = 112})</span><span>
</span><span id="line-31"></span><span id="local-6989586621679036631"><span class="annot"><a href="System.Console.Terminal.Size.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679036631"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.Terminal.Common.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679036631"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-32"></span><span id="size"><span class="annot"><span class="annottext">size :: forall n. Integral n =&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Size.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Window n))
forall n. Integral n =&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Posix.html#size"><span class="hs-identifier hs-var">Host.size</span></a></span><span class="hs-cpp">

#if !defined(mingw32_HOST_OS)
</span><span class="hs-comment">-- | /Not available on Windows:/</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Get terminal window width and height for a specified file descriptor. If</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- it's not attached to a terminal then 'Nothing' is returned.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;&gt;&gt; import System.Console.Terminal.Size</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- &gt;&gt;&gt; import System.Posix</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt;&gt;&gt; fdSize stdOutput</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Just (Window {height = 56, width = 85})</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &gt;&gt;&gt; fd &lt;- openFd &quot;foo&quot; ReadWrite (Just stdFileMode) defaultFileFlags</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- &gt;&gt;&gt; fdSize fd</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-46"></span><span id="local-6989586621679036634"><span class="annot"><a href="System.Console.Terminal.Size.html#fdSize"><span class="hs-identifier hs-type">fdSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679036634"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fd</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.Terminal.Common.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679036634"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-47"></span><span id="fdSize"><span class="annot"><span class="annottext">fdSize :: forall n. Integral n =&gt; Fd -&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Size.html#fdSize"><span class="hs-identifier hs-var hs-var">fdSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fd -&gt; IO (Maybe (Window n))
forall n. Integral n =&gt; Fd -&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Posix.html#fdSize"><span class="hs-identifier hs-var">Host.fdSize</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Same as 'fdSize', but takes 'Handle' instead of 'Fd' (file descriptor).</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- Note that on Windows with shells that use the native console API (cmd.exe,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- PowerShell) this works only for output handles like 'stdout' and 'stderr';</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- for input handles like 'stdin' it always returns 'Nothing'.</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;&gt;&gt; import System.Console.Terminal.Size</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt;&gt;&gt; import System.IO</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt;&gt;&gt; hSize stdout</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Just (Window {height = 56, width = 85})</span><span>
</span><span id="line-60"></span><span id="local-6989586621679036637"><span class="annot"><a href="System.Console.Terminal.Size.html#hSize"><span class="hs-identifier hs-type">hSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679036637"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.Terminal.Common.html#Window"><span class="hs-identifier hs-type">Window</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679036637"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-61"></span><span id="hSize"><span class="annot"><span class="annottext">hSize :: forall n. Integral n =&gt; Handle -&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Size.html#hSize"><span class="hs-identifier hs-var hs-var">hSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (Maybe (Window n))
forall n. Integral n =&gt; Handle -&gt; IO (Maybe (Window n))
</span><a href="System.Console.Terminal.Posix.html#hSize"><span class="hs-identifier hs-var">Host.hSize</span></a></span><span>
</span><span id="line-62"></span></pre></body></html>