<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies, FlexibleInstances, TypeSynonymInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Text.Regex.Base.RegexLike</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (c) Chris Kuklewicz 2006</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- SPDX-License-Identifier: BSD-3-Clause</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  hvr@gnu.org, Andreas Abel</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   :  stable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  non-portable (MPTC+FD)</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Classes and instances for Regex matching.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- All the /classes/ are declared here, and some common type aliases, and</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- the 'MatchResult' data type.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- The only /instances/ here are for 'Extract' 'String', 'Extract' 'SB.ByteString',</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- and 'Extract' 'ST.Text'. There are no data values.  The 'RegexContext'</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- instances are in &quot;Text.Regex.Base.Context&quot;, except for ones which</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- run afoul of a repeated variable (@'RegexContext' regex a a@), which</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- are defined in each modules' String and ByteString modules.</span><span>
</span><span id="line-23"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.Base.RegexLike</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Type aliases</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier">MatchOffset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier">MatchLength</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier">MatchArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier">MatchText</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Data types</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchResult"><span class="hs-identifier">MatchResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Classes</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexOptions"><span class="hs-identifier">RegexOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexMaker"><span class="hs-identifier">RegexMaker</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier">RegexLike</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier">RegexContext</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier">Extract</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier">AllSubmatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier">AllTextSubmatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier">AllMatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier">AllTextMatches</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if !MIN_VERSION_base(4,13,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Fail</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Fail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MonadFail</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><span class="hs-comment">-- | 0 based index from start of source, or (-1) for unused</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">type</span><span> </span><span id="MatchOffset"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-var">MatchOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | non-negative length of a match</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">type</span><span> </span><span id="MatchLength"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-var">MatchLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | 0 based array, with 0th index indicating the full match.  If the</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- full match location is not available, represent as (0,0).</span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="MatchArray"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-var">MatchArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">type</span><span> </span><span id="MatchText"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-var">MatchText</span></a></span></span><span> </span><span id="local-6989586621679046988"><span class="annot"><a href="#local-6989586621679046988"><span class="hs-identifier hs-type">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046988"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchOffset"><span class="hs-identifier hs-type">MatchOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchLength"><span class="hs-identifier hs-type">MatchLength</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | This is the same as the type from JRegex.</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="MatchResult"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchResult"><span class="hs-identifier hs-var">MatchResult</span></a></span></span><span> </span><span id="local-6989586621679046881"><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MR"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MR"><span class="hs-identifier hs-var">MR</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-66"></span><span>    </span><span id="mrBefore"><span class="annot"><span class="annottext">forall a. MatchResult a -&gt; a
</span><a href="Text.Regex.Base.RegexLike.html#mrBefore"><span class="hs-identifier hs-var hs-var">mrBefore</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span id="mrMatch"><span class="annot"><span class="annottext">forall a. MatchResult a -&gt; a
</span><a href="Text.Regex.Base.RegexLike.html#mrMatch"><span class="hs-identifier hs-var hs-var">mrMatch</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span id="mrAfter"><span class="annot"><span class="annottext">forall a. MatchResult a -&gt; a
</span><a href="Text.Regex.Base.RegexLike.html#mrAfter"><span class="hs-identifier hs-var hs-var">mrAfter</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span id="mrSubList"><span class="annot"><span class="annottext">forall a. MatchResult a -&gt; [a]
</span><a href="Text.Regex.Base.RegexLike.html#mrSubList"><span class="hs-identifier hs-var hs-var">mrSubList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span id="mrSubs"><span class="annot"><span class="annottext">forall a. MatchResult a -&gt; Array Int a
</span><a href="Text.Regex.Base.RegexLike.html#mrSubs"><span class="hs-identifier hs-var hs-var">mrSubs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="#local-6989586621679046881"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-71"></span><span class="hs-special">}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Rather than carry them around separately, the options for how to</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- execute a regex are kept as part of the regex.  There are two types</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- of options.  Those that can only be specified at compilation time</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- and never changed are @compOpt@.  Those that can be changed later and</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- affect how matching is performed are @execOpt@.  The actually types</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- for these depend on the backend.</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-keyword">class</span><span> </span><span id="RegexOptions"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexOptions"><span class="hs-identifier hs-var">RegexOptions</span></a></span></span><span> </span><span id="local-6989586621679046895"><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span></span><span> </span><span id="local-6989586621679046896"><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span></span><span> </span><span id="local-6989586621679046897"><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- | No options set at all in the backend.</span><span>
</span><span id="line-88"></span><span>  </span><span id="blankCompOpt"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#blankCompOpt"><span class="hs-identifier hs-type">blankCompOpt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- | No options set at all in the backend.</span><span>
</span><span id="line-91"></span><span>  </span><span id="blankExecOpt"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#blankExecOpt"><span class="hs-identifier hs-type">blankExecOpt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | Reasonable options (extended, caseSensitive, multiline regex).</span><span>
</span><span id="line-94"></span><span>  </span><span id="defaultCompOpt"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#defaultCompOpt"><span class="hs-identifier hs-type">defaultCompOpt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046896"><span class="hs-identifier hs-type">compOpt</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- | Reasonable options (extended, caseSensitive, multiline regex).</span><span>
</span><span id="line-97"></span><span>  </span><span id="defaultExecOpt"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#defaultExecOpt"><span class="hs-identifier hs-type">defaultExecOpt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- | Forget old flags and use new ones.</span><span>
</span><span id="line-100"></span><span>  </span><span id="setExecOpts"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#setExecOpts"><span class="hs-identifier hs-type">setExecOpts</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- | Retrieve the current flags.</span><span>
</span><span id="line-103"></span><span>  </span><span id="getExecOpts"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#getExecOpts"><span class="hs-identifier hs-type">getExecOpts</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046895"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046897"><span class="hs-identifier hs-type">execOpt</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | @RegexMaker@ captures the creation of the compiled regular</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- expression from a source type and an option type.  Methods 'makeRegexM' and</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- 'makeRegexM' report parse errors using 'MonadError', usually (@Either</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- String regex@).</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- The 'makeRegex' function has a default implementation that depends</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- on 'makeRegexOpts' and uses 'defaultCompOpt' and 'defaultExecOpt'.</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Similarly for 'makeRegexM' and 'makeRegexOptsM'.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- There are also default implementaions for 'makeRegexOpts' and</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- 'makeRegexOptsM' in terms of each other.  So a minimal instance</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- definition needs to only define one of these, hopefully</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- 'makeRegexOptsM'.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexOptions"><span class="hs-identifier hs-type">RegexOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="RegexMaker"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexMaker"><span class="hs-identifier hs-var">RegexMaker</span></a></span></span><span> </span><span id="local-6989586621679046889"><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span></span><span> </span><span id="local-6989586621679046890"><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span></span><span> </span><span id="local-6989586621679046891"><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span></span><span> </span><span id="local-6989586621679046892"><span class="annot"><a href="#local-6989586621679046892"><span class="hs-identifier hs-type">source</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- | Use the 'defaultCompOpt' and 'defaultExecOpt'.</span><span>
</span><span id="line-124"></span><span>  </span><span id="makeRegex"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegex"><span class="hs-identifier hs-type">makeRegex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046892"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- | Specify your own options.</span><span>
</span><span id="line-127"></span><span>  </span><span id="makeRegexOpts"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexOpts"><span class="hs-identifier hs-type">makeRegexOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046892"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- | Use the 'defaultCompOpt' and 'defaultExecOpt', reporting errors with 'fail'.</span><span>
</span><span id="line-130"></span><span>  </span><span id="makeRegexM"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexM"><span class="hs-identifier hs-type">makeRegexM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679046898"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679046898"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046892"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046898"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">-- | Specify your own options, reporting errors with fail</span><span>
</span><span id="line-133"></span><span>  </span><span id="makeRegexOptsM"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexOptsM"><span class="hs-identifier hs-type">makeRegexOptsM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679046900"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679046900"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046890"><span class="hs-identifier hs-type">compOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046891"><span class="hs-identifier hs-type">execOpt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046892"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046889"><span class="hs-identifier hs-type">regex</span></a></span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679047007"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegex"><span class="hs-identifier hs-var hs-var">makeRegex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">compOpt -&gt; execOpt -&gt; source -&gt; regex
forall regex compOpt execOpt source.
RegexMaker regex compOpt execOpt source =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; regex
</span><a href="Text.Regex.Base.RegexLike.html#makeRegexOpts"><span class="hs-identifier hs-var">makeRegexOpts</span></a></span><span> </span><span class="annot"><span class="annottext">compOpt
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
compOpt
</span><a href="Text.Regex.Base.RegexLike.html#defaultCompOpt"><span class="hs-identifier hs-var">defaultCompOpt</span></a></span><span> </span><span class="annot"><span class="annottext">execOpt
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
execOpt
</span><a href="Text.Regex.Base.RegexLike.html#defaultExecOpt"><span class="hs-identifier hs-var">defaultExecOpt</span></a></span></span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679047012"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexM"><span class="hs-identifier hs-var hs-var">makeRegexM</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">compOpt -&gt; execOpt -&gt; source -&gt; m regex
forall regex compOpt execOpt source (m :: * -&gt; *).
(RegexMaker regex compOpt execOpt source, MonadFail m) =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
forall (m :: * -&gt; *).
MonadFail m =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
</span><a href="Text.Regex.Base.RegexLike.html#makeRegexOptsM"><span class="hs-identifier hs-var">makeRegexOptsM</span></a></span><span> </span><span class="annot"><span class="annottext">compOpt
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
compOpt
</span><a href="Text.Regex.Base.RegexLike.html#defaultCompOpt"><span class="hs-identifier hs-var">defaultCompOpt</span></a></span><span> </span><span class="annot"><span class="annottext">execOpt
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
execOpt
</span><a href="Text.Regex.Base.RegexLike.html#defaultExecOpt"><span class="hs-identifier hs-var">defaultExecOpt</span></a></span></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679047019"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexOpts"><span class="hs-identifier hs-var hs-var">makeRegexOpts</span></a></span><span> </span><span id="local-6989586621679047025"><span class="annot"><span class="annottext">compOpt
</span><a href="#local-6989586621679047025"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679047026"><span class="annot"><span class="annottext">execOpt
</span><a href="#local-6989586621679047026"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679047027"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047027"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">regex -&gt; (regex -&gt; regex) -&gt; Maybe regex -&gt; regex
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; regex
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;makeRegexOpts failed&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">regex -&gt; regex
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">compOpt -&gt; execOpt -&gt; source -&gt; Maybe regex
forall regex compOpt execOpt source (m :: * -&gt; *).
(RegexMaker regex compOpt execOpt source, MonadFail m) =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
forall (m :: * -&gt; *).
MonadFail m =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
</span><a href="Text.Regex.Base.RegexLike.html#makeRegexOptsM"><span class="hs-identifier hs-var">makeRegexOptsM</span></a></span><span> </span><span class="annot"><span class="annottext">compOpt
</span><a href="#local-6989586621679047025"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">execOpt
</span><a href="#local-6989586621679047026"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047027"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679047031"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#makeRegexOptsM"><span class="hs-identifier hs-var hs-var">makeRegexOptsM</span></a></span><span> </span><span id="local-6989586621679047037"><span class="annot"><span class="annottext">compOpt
</span><a href="#local-6989586621679047037"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679047038"><span class="annot"><span class="annottext">execOpt
</span><a href="#local-6989586621679047038"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679047039"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047039"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">regex -&gt; m regex
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">compOpt -&gt; execOpt -&gt; source -&gt; regex
forall regex compOpt execOpt source.
RegexMaker regex compOpt execOpt source =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; regex
</span><a href="Text.Regex.Base.RegexLike.html#makeRegexOpts"><span class="hs-identifier hs-var">makeRegexOpts</span></a></span><span> </span><span class="annot"><span class="annottext">compOpt
</span><a href="#local-6989586621679047037"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">execOpt
</span><a href="#local-6989586621679047038"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047039"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | RegexLike is parametrized on a regular expression type and a</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- source type to run the matching on.</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- There are default implementations: 'matchTest' and 'matchOnceText' use</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- 'matchOnce'; 'matchCount' and 'matchAllText' use 'matchAll'.</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Conversely, 'matchOnce' uses</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- 'matchOnceText' and 'matchAll' uses 'matchAllText'. So a minimal complete</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- instance need to provide at least ('matchOnce' or 'matchOnceText') and</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- ('matchAll' or 'matchAllText').  Additional definitions are often</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- provided where they will increase efficiency.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt; [ c | let notVowel = makeRegex &quot;[^aeiou]&quot; :: Regex, c &lt;- ['a'..'z'], matchTest notVowel [c]  ]</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- &gt; &quot;bcdfghjklmnpqrstvwxyz&quot;</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- The strictness of these functions is instance dependent.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="RegexLike"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-var">RegexLike</span></a></span></span><span> </span><span id="local-6989586621679046911"><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span></span><span> </span><span id="local-6989586621679046912"><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">-- | This returns the first match in the source (it checks the whole</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- source, not just at the start). This returns an array of</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- (offset,length) index pairs for the match and captured</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- substrings.  The offset is 0-based.  A (-1) for an offset means a</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- failure to match.  The lower bound of the array is 0, and the 0th</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- element is the (offset,length) for the whole match.</span><span>
</span><span id="line-166"></span><span>  </span><span id="matchOnce"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-type">matchOnce</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-type">MatchArray</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- | @matchAll@ returns a list of matches.  The matches are in order</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- and do not overlap. If any match succeeds but has 0 length then</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">-- this will be the last match in the list.</span><span>
</span><span id="line-171"></span><span>  </span><span id="matchAll"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-type">matchAll</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchArray"><span class="hs-identifier hs-type">MatchArray</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-comment">-- | @matchCount@ returns the number of non-overlapping matches</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- returned by @matchAll@.</span><span>
</span><span id="line-175"></span><span>  </span><span id="matchCount"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchCount"><span class="hs-identifier hs-type">matchCount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- | @matchTest@ returns @True@ if there is a match somewhere in the</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- source (it checks the whole source not just at the start).</span><span>
</span><span id="line-179"></span><span>  </span><span id="matchTest"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchTest"><span class="hs-identifier hs-type">matchTest</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- | This is @matchAll@ with the actual subsections of the source</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- instead of just the (offset,length) information.</span><span>
</span><span id="line-183"></span><span>  </span><span id="matchAllText"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-type">matchAllText</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- | This can return a tuple of three items: the source before the</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- match, an array of the match and captured substrings (with their</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- indices), and the source after the match.</span><span>
</span><span id="line-188"></span><span>  </span><span id="matchOnceText"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-type">matchOnceText</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046911"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#MatchText"><span class="hs-identifier hs-type">MatchText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679046912"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679047048"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-var hs-var">matchAll</span></a></span><span> </span><span id="local-6989586621679047052"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047052"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047053"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047053"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Array Int (source, (Int, Int)) -&gt; MatchArray)
-&gt; [Array Int (source, (Int, Int))] -&gt; [MatchArray]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((source, (Int, Int)) -&gt; (Int, Int))
-&gt; Array Int (source, (Int, Int)) -&gt; MatchArray
forall a b. (a -&gt; b) -&gt; Array Int a -&gt; Array Int b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(source, (Int, Int)) -&gt; (Int, Int)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex -&gt; source -&gt; [Array Int (source, (Int, Int))]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [Array Int (source, (Int, Int))]
</span><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var">matchAllText</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047052"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047053"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679047055"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var hs-var">matchOnce</span></a></span><span> </span><span id="local-6989586621679047060"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047060"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047061"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047061"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((source, Array Int (source, (Int, Int)), source) -&gt; MatchArray)
-&gt; Maybe (source, Array Int (source, (Int, Int)), source)
-&gt; Maybe MatchArray
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">source
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679047062"><span class="annot"><span class="annottext">Array Int (source, (Int, Int))
</span><a href="#local-6989586621679047062"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">source
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((source, (Int, Int)) -&gt; (Int, Int))
-&gt; Array Int (source, (Int, Int)) -&gt; MatchArray
forall a b. (a -&gt; b) -&gt; Array Int a -&gt; Array Int b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(source, (Int, Int)) -&gt; (Int, Int)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Array Int (source, (Int, Int))
</span><a href="#local-6989586621679047062"><span class="hs-identifier hs-var">mt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex
-&gt; source -&gt; Maybe (source, Array Int (source, (Int, Int)), source)
forall regex source.
RegexLike regex source =&gt;
regex
-&gt; source -&gt; Maybe (source, Array Int (source, (Int, Int)), source)
</span><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-var">matchOnceText</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047060"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047061"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679047063"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchTest"><span class="hs-identifier hs-var hs-var">matchTest</span></a></span><span> </span><span id="local-6989586621679047065"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047065"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047066"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047066"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MatchArray -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex -&gt; source -&gt; Maybe MatchArray
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe MatchArray
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047065"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047066"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679047067"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchCount"><span class="hs-identifier hs-var hs-var">matchCount</span></a></span><span> </span><span id="local-6989586621679047071"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047071"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047072"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047072"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MatchArray] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex -&gt; source -&gt; [MatchArray]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [MatchArray]
</span><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-var">matchAll</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047071"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047072"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679047074"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchOnceText"><span class="hs-identifier hs-var hs-var">matchOnceText</span></a></span><span> </span><span id="local-6989586621679047084"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047084"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047085"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">(MatchArray -&gt; (source, Array Int (source, (Int, Int)), source))
-&gt; Maybe MatchArray
-&gt; Maybe (source, Array Int (source, (Int, Int)), source)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679047086"><span class="annot"><span class="annottext">MatchArray
</span><a href="#local-6989586621679047086"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679047094"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047094"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679047095"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047095"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchArray
</span><a href="#local-6989586621679047086"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">MatchArray -&gt; Int -&gt; (Int, Int)
forall i e. Ix i =&gt; Array i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-196"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; source -&gt; source
forall source. Extract source =&gt; Int -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047094"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">source</span></a></span><span>
</span><span id="line-197"></span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (source, (Int, Int)))
-&gt; MatchArray -&gt; Array Int (source, (Int, Int))
forall a b. (a -&gt; b) -&gt; Array Int a -&gt; Array Int b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679047097"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047097"><span class="hs-identifier hs-var">ol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; source -&gt; source
forall source. Extract source =&gt; (Int, Int) -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047097"><span class="hs-identifier hs-var">ol</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047097"><span class="hs-identifier hs-var">ol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MatchArray
</span><a href="#local-6989586621679047086"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-198"></span><span>                    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; source -&gt; source
forall source. Extract source =&gt; Int -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var">after</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047094"><span class="hs-identifier hs-var">o</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047095"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex -&gt; source -&gt; Maybe MatchArray
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe MatchArray
</span><a href="Text.Regex.Base.RegexLike.html#matchOnce"><span class="hs-identifier hs-var">matchOnce</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047084"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047085"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679047101"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchAllText"><span class="hs-identifier hs-var hs-var">matchAllText</span></a></span><span> </span><span id="local-6989586621679047106"><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047106"><span class="hs-identifier hs-var">regex</span></a></span></span><span> </span><span id="local-6989586621679047107"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047107"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">(MatchArray -&gt; Array Int (source, (Int, Int)))
-&gt; [MatchArray] -&gt; [Array Int (source, (Int, Int))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (source, (Int, Int)))
-&gt; MatchArray -&gt; Array Int (source, (Int, Int))
forall a b. (a -&gt; b) -&gt; Array Int a -&gt; Array Int b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679047108"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047108"><span class="hs-identifier hs-var">ol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; source -&gt; source
forall source. Extract source =&gt; (Int, Int) -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047108"><span class="hs-identifier hs-var">ol</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047107"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679047108"><span class="hs-identifier hs-var">ol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">regex -&gt; source -&gt; [MatchArray]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [MatchArray]
</span><a href="Text.Regex.Base.RegexLike.html#matchAll"><span class="hs-identifier hs-var">matchAll</span></a></span><span> </span><span class="annot"><span class="annottext">regex
</span><a href="#local-6989586621679047106"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047107"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | @RegexContext@ is the polymorphic interface to do matching.  Since</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- 'target' is polymorphic you may need to supply the type explicitly</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- in contexts where it cannot be inferred.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- The monadic 'matchM' version uses 'fail' to report when the 'regex'</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- has no match in 'source'.  Two examples:</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Here the contest 'Bool' is inferred:</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- &gt; [ c | let notVowel = makeRegex &quot;[^aeiou]&quot; :: Regex, c &lt;- ['a'..'z'], match notVowel [c]  ]</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- &gt; &quot;bcdfghjklmnpqrstvwxyz&quot;</span><span>
</span><span id="line-217"></span><span class="hs-comment">--</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- Here the context @[String]@ must be supplied:</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- &gt; let notVowel = (makeRegex &quot;[^aeiou]&quot; :: Regex )</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- &gt; in do { c &lt;- ['a'..'z'] ; matchM notVowel [c] } :: [String]</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- &gt; [&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;j&quot;,&quot;k&quot;,&quot;l&quot;,&quot;m&quot;,&quot;n&quot;,&quot;p&quot;,&quot;q&quot;,&quot;r&quot;,&quot;s&quot;,&quot;t&quot;,&quot;v&quot;,&quot;w&quot;,&quot;x&quot;,&quot;y&quot;,&quot;z&quot;]</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexLike"><span class="hs-identifier hs-type">RegexLike</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046931"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046932"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="RegexContext"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#RegexContext"><span class="hs-identifier hs-var">RegexContext</span></a></span></span><span> </span><span id="local-6989586621679046931"><span class="annot"><a href="#local-6989586621679046931"><span class="hs-identifier hs-type">regex</span></a></span></span><span> </span><span id="local-6989586621679046932"><span class="annot"><a href="#local-6989586621679046932"><span class="hs-identifier hs-type">source</span></a></span></span><span> </span><span id="local-6989586621679046933"><span class="annot"><a href="#local-6989586621679046933"><span class="hs-identifier hs-type">target</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span id="match"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#match"><span class="hs-identifier hs-type">match</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046931"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046932"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046933"><span class="hs-identifier hs-type">target</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span id="matchM"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#matchM"><span class="hs-identifier hs-type">matchM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679047112"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679047112"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046931"><span class="hs-identifier hs-type">regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046932"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679047112"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046933"><span class="hs-identifier hs-type">target</span></a></span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Extract allows for indexing operations on 'String' or 'ByteString'.</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-keyword">class</span><span> </span><span id="Extract"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-var">Extract</span></a></span></span><span> </span><span id="local-6989586621679046929"><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">-- | @before@ is a renamed 'take'.</span><span>
</span><span id="line-235"></span><span>  </span><span id="before"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-type">before</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- | @after@ is a renamed 'drop'.</span><span>
</span><span id="line-238"></span><span>  </span><span id="after"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-type">after</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- | When there is no match, this can construct an empty data value.</span><span>
</span><span id="line-241"></span><span>  </span><span id="empty"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-type">empty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- | @extract@ takes an offset and length, and has this default implementation:</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">--   extract (off, len) source = before len (after off source)</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-248"></span><span>  </span><span id="extract"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#extract"><span class="hs-identifier hs-type">extract</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679046929"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679047115"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679047118"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047118"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679047119"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047119"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679047120"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047120"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; source -&gt; source
forall source. Extract source =&gt; Int -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047119"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; source -&gt; source
forall source. Extract source =&gt; Int -&gt; source -&gt; source
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var">after</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679047118"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679047120"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047125"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679047129"><span class="annot"><span class="annottext">before :: Int -&gt; [Char] -&gt; [Char]
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047131"><span class="annot"><span class="annottext">after :: Int -&gt; [Char] -&gt; [Char]
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047133"><span class="annot"><span class="annottext">empty :: [Char]
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047138"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SB.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679047141"><span class="annot"><span class="annottext">before :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">SB.take</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047142"><span class="annot"><span class="annottext">after :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">SB.drop</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047143"><span class="annot"><span class="annottext">empty :: ByteString
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">SB.empty</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047148"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LB.ByteString</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679047153"><span class="annot"><span class="annottext">before :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LB.take</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; ByteString -&gt; ByteString)
-&gt; (Int -&gt; Int64) -&gt; Int -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047157"><span class="annot"><span class="annottext">after :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">LB.drop</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; ByteString -&gt; ByteString)
-&gt; (Int -&gt; Int64) -&gt; Int -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047158"><span class="annot"><span class="annottext">empty :: ByteString
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">LB.empty</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679046945"><span id="local-6989586621679047163"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679046945"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679047166"><span class="annot"><span class="annottext">before :: Int -&gt; Seq a -&gt; Seq a
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq a -&gt; Seq a
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047167"><span class="annot"><span class="annottext">after :: Int -&gt; Seq a -&gt; Seq a
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq a -&gt; Seq a
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.drop</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047168"><span class="annot"><span class="annottext">empty :: Seq a
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq a
forall a. Seq a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-comment">-- | @since 0.94.0.0</span></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047173"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679047176"><span class="annot"><span class="annottext">before :: Int -&gt; Text -&gt; Text
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">ST.take</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047177"><span class="annot"><span class="annottext">after :: Int -&gt; Text -&gt; Text
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">ST.drop</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047178"><span class="annot"><span class="annottext">empty :: Text
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">ST.empty</span></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-comment">-- | @since 0.94.0.0</span></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679047183"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#Extract"><span class="hs-identifier hs-type">Extract</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679047187"><span class="annot"><span class="annottext">before :: Int -&gt; Text -&gt; Text
</span><a href="Text.Regex.Base.RegexLike.html#before"><span class="hs-identifier hs-var hs-var hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.take</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Text -&gt; Text) -&gt; (Int -&gt; Int64) -&gt; Int -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047189"><span class="annot"><span class="annottext">after :: Int -&gt; Text -&gt; Text
</span><a href="Text.Regex.Base.RegexLike.html#after"><span class="hs-identifier hs-var hs-var hs-var hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.drop</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Text -&gt; Text) -&gt; (Int -&gt; Int64) -&gt; Int -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679047190"><span class="annot"><span class="annottext">empty :: Text
</span><a href="Text.Regex.Base.RegexLike.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">LT.empty</span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">-- | Used in results of 'RegexContext' instances.</span></span><span>
</span><span id="line-272"></span><span class="hs-keyword">newtype</span><span> </span><span id="AllSubmatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier hs-var">AllSubmatches</span></a></span></span><span> </span><span id="local-6989586621679046948"><span class="annot"><a href="#local-6989586621679046948"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679046949"><span class="annot"><a href="#local-6989586621679046949"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AllSubmatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllSubmatches"><span class="hs-identifier hs-var">AllSubmatches</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getAllSubmatches"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. AllSubmatches f b -&gt; f b
</span><a href="Text.Regex.Base.RegexLike.html#getAllSubmatches"><span class="hs-identifier hs-var hs-var">getAllSubmatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046948"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046949"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><span class="hs-comment">-- | Used in results of 'RegexContext' instances.</span></span><span>
</span><span id="line-275"></span><span class="hs-keyword">newtype</span><span> </span><span id="AllTextSubmatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span></span><span> </span><span id="local-6989586621679046953"><span class="annot"><a href="#local-6989586621679046953"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679046954"><span class="annot"><a href="#local-6989586621679046954"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AllTextSubmatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextSubmatches"><span class="hs-identifier hs-var">AllTextSubmatches</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getAllTextSubmatches"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. AllTextSubmatches f b -&gt; f b
</span><a href="Text.Regex.Base.RegexLike.html#getAllTextSubmatches"><span class="hs-identifier hs-var hs-var">getAllTextSubmatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046954"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><span class="hs-comment">-- | Used in results of 'RegexContext' instances.</span></span><span>
</span><span id="line-278"></span><span class="hs-keyword">newtype</span><span> </span><span id="AllMatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span></span><span> </span><span id="local-6989586621679046958"><span class="annot"><a href="#local-6989586621679046958"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679046959"><span class="annot"><a href="#local-6989586621679046959"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AllMatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllMatches"><span class="hs-identifier hs-var">AllMatches</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getAllMatches"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. AllMatches f b -&gt; f b
</span><a href="Text.Regex.Base.RegexLike.html#getAllMatches"><span class="hs-identifier hs-var hs-var">getAllMatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046958"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046959"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><span class="hs-comment">-- | Used in results of 'RegexContext' instances.</span></span><span>
</span><span id="line-281"></span><span class="hs-keyword">newtype</span><span> </span><span id="AllTextMatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span></span><span> </span><span id="local-6989586621679046963"><span class="annot"><a href="#local-6989586621679046963"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679046964"><span class="annot"><a href="#local-6989586621679046964"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AllTextMatches"><span class="annot"><a href="Text.Regex.Base.RegexLike.html#AllTextMatches"><span class="hs-identifier hs-var">AllTextMatches</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getAllTextMatches"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) b. AllTextMatches f b -&gt; f b
</span><a href="Text.Regex.Base.RegexLike.html#getAllTextMatches"><span class="hs-identifier hs-var hs-var">getAllTextMatches</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679046963"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679046964"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-282"></span></pre></body></html>