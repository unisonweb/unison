<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.Acquire.Internal</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">resourcet-1.3.0: Deterministic allocation and freeing of scarce resources.</span><ul class="links" id="page-menu"><li><a href="src/Data.Acquire.Internal.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.Acquire.Internal</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">newtype</span> <a href="#t:Acquire">Acquire</a> a = <a href="#v:Acquire">Acquire</a> ((<span class="keyword">forall</span> b. <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> b -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> b) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Acquire-Internal.html#t:Allocated" title="Data.Acquire.Internal">Allocated</a> a))</li><li class="src short"><span class="keyword">data</span> <a href="#t:Allocated">Allocated</a> a = <a href="#v:Allocated">Allocated</a> !a !(<a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ())</li><li class="src short"><a href="#v:with">with</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadUnliftIO" title="Control.Monad.Trans.Resource">MonadUnliftIO</a> m =&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; (a -&gt; m b) -&gt; m b</li><li class="src short"><a href="#v:mkAcquire">mkAcquire</a> :: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a -&gt; (a -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:ReleaseType">ReleaseType</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:ReleaseEarly">ReleaseEarly</a></li><li><a href="#v:ReleaseNormal">ReleaseNormal</a></li><li><a href="#v:ReleaseExceptionWith">ReleaseExceptionWith</a> <a href="../base-4.18.2.1/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a></li><li><span class="keyword">pattern</span> <a href="#v:ReleaseException">ReleaseException</a> :: <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a></li></ul></li><li class="src short"><a href="#v:mkAcquireType">mkAcquireType</a> :: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a -&gt; (a -&gt; <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Acquire" class="def">Acquire</a> a <a href="src/Data.Acquire.Internal.html#Acquire" class="link">Source</a> <a href="#t:Acquire" class="selflink">#</a></p><div class="doc"><p>A method for acquiring a scarce resource, providing the means of freeing
 it when no longer needed. This data type provides
 <code>Functor</code>/<code>Applicative</code>/<code>Monad</code> instances for composing different resources
 together. You can allocate these resources using either the <code>bracket</code>
 pattern (via <code>with</code>) or using <code>ResourceT</code> (via <code>allocateAcquire</code>).</p><p>This concept was originally introduced by Gabriel Gonzalez and described at:
 <a href="http://www.haskellforall.com/2013/06/the-resource-applicative.html">http://www.haskellforall.com/2013/06/the-resource-applicative.html</a>. The
 implementation in this package is slightly different, due to taking a
 different approach to async exception safety.</p><p><em>Since: 1.1.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Acquire" class="def">Acquire</a> ((<span class="keyword">forall</span> b. <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> b -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> b) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Data-Acquire-Internal.html#t:Allocated" title="Data.Acquire.Internal">Allocated</a> a))</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Acquire">Instances</h4><details id="i:Acquire" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Acquire:MonadIO:1"></span> <a href="../base-4.18.2.1/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a></span> <a href="src/Data.Acquire.Internal.html#line-68" class="link">Source</a> <a href="#t:Acquire" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Acquire:MonadIO:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Acquire-Internal.html">Data.Acquire.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:liftIO">liftIO</a> :: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a <a href="#v:liftIO" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Acquire:Applicative:2"></span> <a href="../base-4.18.2.1/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a></span> <a href="src/Data.Acquire.Internal.html#line-56" class="link">Source</a> <a href="#t:Acquire" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Acquire:Applicative:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Acquire-Internal.html">Data.Acquire.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a <a href="#v:pure" class="selflink">#</a></p><p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> (a -&gt; b) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b <a href="#v:-60--42--62-" class="selflink">#</a></p><p class="src"><a href="#v:liftA2">liftA2</a> :: (a -&gt; b -&gt; c) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> c <a href="#v:liftA2" class="selflink">#</a></p><p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b <a href="#v:-42--62-" class="selflink">#</a></p><p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a <a href="#v:-60--42-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Acquire:Functor:3"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a></span> <a href="src/Data.Acquire.Internal.html#line-54" class="link">Source</a> <a href="#t:Acquire" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Acquire:Functor:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Acquire-Internal.html">Data.Acquire.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Acquire:Monad:4"></span> <a href="../base-4.18.2.1/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a></span> <a href="src/Data.Acquire.Internal.html#line-60" class="link">Source</a> <a href="#t:Acquire" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Acquire:Monad:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Acquire-Internal.html">Data.Acquire.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; (a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b) -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b <a href="#v:-62--62--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> b <a href="#v:-62--62-" class="selflink">#</a></p><p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a <a href="#v:return" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Allocated" class="def">Allocated</a> a <a href="src/Data.Acquire.Internal.html#Allocated" class="link">Source</a> <a href="#t:Allocated" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Allocated" class="def">Allocated</a> !a !(<a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ())</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:with" class="def">with</a> :: <a href="Control-Monad-Trans-Resource.html#t:MonadUnliftIO" title="Control.Monad.Trans.Resource">MonadUnliftIO</a> m =&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a -&gt; (a -&gt; m b) -&gt; m b <a href="src/Data.Acquire.Internal.html#with" class="link">Source</a> <a href="#v:with" class="selflink">#</a></p><div class="doc"><p>Allocate the given resource and provide it to the provided function. The
 resource will be freed as soon as the inner block is exited, whether
 normally or via an exception. This function is similar in function to
 <code>bracket</code>.</p><p><em>Since: 1.1.0</em></p></div></div><div class="top"><p class="src"><a id="v:mkAcquire" class="def">mkAcquire</a> <a href="src/Data.Acquire.Internal.html#mkAcquire" class="link">Source</a> <a href="#v:mkAcquire" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a</td><td class="doc"><p>acquire the resource</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ())</td><td class="doc"><p>free the resource</p></td></tr><tr><td class="src">-&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create an <code>Acquire</code> value using the given allocate and free functions.</p><p>To acquire and free the resource in an arbitrary monad with <code><a href="Control-Monad-Trans-Resource.html#t:MonadUnliftIO" title="Control.Monad.Trans.Resource">MonadUnliftIO</a></code>,
 do the following:</p><pre>acquire &lt;- withRunInIO $ \runInIO -&gt;
  return $ mkAcquire (runInIO create) (runInIO . free)</pre><p>Note that this is only safe if the Acquire is run and freed within the same
 monadic scope it was created in.</p><p><em>Since: 1.1.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ReleaseType" class="def">ReleaseType</a> <a href="src/Data.Acquire.Internal.html#ReleaseType" class="link">Source</a> <a href="#t:ReleaseType" class="selflink">#</a></p><div class="doc"><p>The way in which a release is called.</p><p><em>Since: 1.1.2</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ReleaseEarly" class="def">ReleaseEarly</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ReleaseNormal" class="def">ReleaseNormal</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ReleaseExceptionWith" class="def">ReleaseExceptionWith</a> <a href="../base-4.18.2.1/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs bundled-patterns"><p class="caption">Bundled Patterns</p><table><tr><td class="src"><span class="keyword">pattern</span> <a id="v:ReleaseException" class="def">ReleaseException</a> :: <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a></td><td class="doc"><div class="warning"><p>Deprecated: Use <code><a href="Data-Acquire-Internal.html#v:ReleaseExceptionWith" title="Data.Acquire.Internal">ReleaseExceptionWith</a></code>, which has the exception in the constructor. This pattern synonym hides the exception and can obscure problems.</p></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ReleaseType">Instances</h4><details id="i:ReleaseType" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ReleaseType:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a></span> <a href="src/Data.Acquire.Internal.html#line-30" class="link">Source</a> <a href="#t:ReleaseType" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ReleaseType:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-Acquire-Internal.html">Data.Acquire.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:mkAcquireType" class="def">mkAcquireType</a> <a href="src/Data.Acquire.Internal.html#mkAcquireType" class="link">Source</a> <a href="#v:mkAcquireType" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a</td><td class="doc"><p>acquire the resource</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="Data-Acquire-Internal.html#t:ReleaseType" title="Data.Acquire.Internal">ReleaseType</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ())</td><td class="doc"><p>free the resource</p></td></tr><tr><td class="src">-&gt; <a href="Data-Acquire-Internal.html#t:Acquire" title="Data.Acquire.Internal">Acquire</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Same as <code><a href="Data-Acquire-Internal.html#v:mkAcquire" title="Data.Acquire.Internal">mkAcquire</a></code>, but the cleanup function will be informed of <em>how</em>
 cleanup was initiated. This allows you to distinguish, for example, between
 normal and exceptional exits.</p><p>To acquire and free the resource in an arbitrary monad with <code><a href="Control-Monad-Trans-Resource.html#t:MonadUnliftIO" title="Control.Monad.Trans.Resource">MonadUnliftIO</a></code>,
 do the following:</p><pre>acquire &lt;- withRunInIO $ \runInIO -&gt;
  return $ mkAcquireType (runInIO create) (\a -&gt; runInIO . free a)</pre><p>Note that this is only safe if the Acquire is run and freed within the same
 monadic scope it was created in.</p><p><em>Since: 1.1.2</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>