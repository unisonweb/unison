<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.HTTP.Client.Manager</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier">ManagerSettings</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier">newManager</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#closeManager"><span class="hs-identifier">closeManager</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#withManager"><span class="hs-identifier">withManager</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#getConn"><span class="hs-identifier">getConn</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#defaultManagerSettings"><span class="hs-identifier">defaultManagerSettings</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocket"><span class="hs-identifier">rawConnectionModifySocket</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocketSize"><span class="hs-identifier">rawConnectionModifySocketSize</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyFromRequest"><span class="hs-identifier">proxyFromRequest</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#noProxy"><span class="hs-identifier">noProxy</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#useProxy"><span class="hs-identifier">useProxy</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyEnvironment"><span class="hs-identifier">proxyEnvironment</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyEnvironmentNamed"><span class="hs-identifier">proxyEnvironmentNamed</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#defaultProxy"><span class="hs-identifier">defaultProxy</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#dropProxyAuthSecure"><span class="hs-identifier">dropProxyAuthSecure</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Manager.html#useProxySecureWithoutConnect"><span class="hs-identifier">useProxySecureWithoutConnect</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S8</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">handle</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.Socket</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NS</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">status200</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html"><span class="hs-identifier">Network.HTTP.Client.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Connection.html"><span class="hs-identifier">Network.HTTP.Client.Connection</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Headers.html"><span class="hs-identifier">Network.HTTP.Client.Headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Headers.html#parseStatusHeaders"><span class="hs-identifier">parseStatusHeaders</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.HTTP.Proxy.html"><span class="hs-identifier">Network.HTTP.Proxy</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.KeyedPool.html"><span class="hs-identifier">Data.KeyedPool</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | A value for the @managerRawConnection@ setting, but also allows you to</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- modify the underlying @Socket@ to set additional settings. For a motivating</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- use case, see: &lt;https://github.com/snoyberg/http-client/issues/71&gt;.</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Since 0.3.8</span><span>
</span><span id="line-45"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocket"><span class="hs-identifier hs-type">rawConnectionModifySocket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS.HostAddress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span id="rawConnectionModifySocket"><span class="annot"><span class="annottext">rawConnectionModifySocket :: (Socket -&gt; IO ())
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocket"><span class="hs-identifier hs-var hs-var">rawConnectionModifySocket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
 -&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection))
-&gt; ((Socket -&gt; IO ())
    -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; (Socket -&gt; IO ())
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Socket -&gt; IO ())
-&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="Network.HTTP.Client.Connection.html#openSocketConnection"><span class="hs-identifier hs-var">openSocketConnection</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Same as @rawConnectionModifySocket@, but also takes in a chunk size.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- @since 0.5.2</span><span>
</span><span id="line-52"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocketSize"><span class="hs-identifier hs-type">rawConnectionModifySocketSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NS.Socket</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NS.HostAddress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span id="rawConnectionModifySocketSize"><span class="annot"><span class="annottext">rawConnectionModifySocketSize :: (Socket -&gt; IO ())
-&gt; IO (Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Manager.html#rawConnectionModifySocketSize"><span class="hs-identifier hs-var hs-var">rawConnectionModifySocketSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
 -&gt; IO (Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection))
-&gt; ((Socket -&gt; IO ())
    -&gt; Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; (Socket -&gt; IO ())
-&gt; IO (Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Socket -&gt; IO ())
-&gt; Int -&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="Network.HTTP.Client.Connection.html#openSocketConnectionSize"><span class="hs-identifier hs-var">openSocketConnectionSize</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Default value for @ManagerSettings@.</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Note that this value does /not/ have support for SSL/TLS. If you need to</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- make any https connections, please use the http-client-tls package, which</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- provides a @tlsManagerSettings@ value.</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Since 0.1.0</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#defaultManagerSettings"><span class="hs-identifier hs-type">defaultManagerSettings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier hs-type">ManagerSettings</span></a></span><span>
</span><span id="line-65"></span><span id="defaultManagerSettings"><span class="annot"><span class="annottext">defaultManagerSettings :: ManagerSettings
</span><a href="Network.HTTP.Client.Manager.html#defaultManagerSettings"><span class="hs-identifier hs-var hs-var">defaultManagerSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier hs-type">ManagerSettings</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">managerConnCount :: Int
</span><a href="Network.HTTP.Client.Types.html#managerConnCount"><span class="hs-identifier hs-var">managerConnCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerRawConnection :: IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerRawConnection"><span class="hs-identifier hs-var">managerRawConnection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
 -&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection))
-&gt; (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Socket -&gt; IO ())
-&gt; Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="Network.HTTP.Client.Connection.html#openSocketConnection"><span class="hs-identifier hs-var">openSocketConnection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; Socket -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Socket -&gt; IO ()) -&gt; IO () -&gt; Socket -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerTlsConnection :: IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerTlsConnection"><span class="hs-identifier hs-var">managerTlsConnection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
 -&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection))
-&gt; (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Maybe HostAddress
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO Connection
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#TlsNotSupported"><span class="hs-identifier hs-var">TlsNotSupported</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerTlsProxyConnection :: IO
  (ByteString
   -&gt; (Connection -&gt; IO ())
   -&gt; String
   -&gt; Maybe HostAddress
   -&gt; String
   -&gt; Int
   -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerTlsProxyConnection"><span class="hs-identifier hs-var">managerTlsProxyConnection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString
 -&gt; (Connection -&gt; IO ())
 -&gt; String
 -&gt; Maybe HostAddress
 -&gt; String
 -&gt; Int
 -&gt; IO Connection)
-&gt; IO
     (ByteString
      -&gt; (Connection -&gt; IO ())
      -&gt; String
      -&gt; Maybe HostAddress
      -&gt; String
      -&gt; Int
      -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((ByteString
  -&gt; (Connection -&gt; IO ())
  -&gt; String
  -&gt; Maybe HostAddress
  -&gt; String
  -&gt; Int
  -&gt; IO Connection)
 -&gt; IO
      (ByteString
       -&gt; (Connection -&gt; IO ())
       -&gt; String
       -&gt; Maybe HostAddress
       -&gt; String
       -&gt; Int
       -&gt; IO Connection))
-&gt; (ByteString
    -&gt; (Connection -&gt; IO ())
    -&gt; String
    -&gt; Maybe HostAddress
    -&gt; String
    -&gt; Int
    -&gt; IO Connection)
-&gt; IO
     (ByteString
      -&gt; (Connection -&gt; IO ())
      -&gt; String
      -&gt; Maybe HostAddress
      -&gt; String
      -&gt; Int
      -&gt; IO Connection)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO Connection
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#TlsNotSupported"><span class="hs-identifier hs-var">TlsNotSupported</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerResponseTimeout :: ResponseTimeout
</span><a href="Network.HTTP.Client.Types.html#managerResponseTimeout"><span class="hs-identifier hs-var">managerResponseTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResponseTimeout
</span><a href="Network.HTTP.Client.Types.html#ResponseTimeoutDefault"><span class="hs-identifier hs-var">ResponseTimeoutDefault</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerRetryableException :: SomeException -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#managerRetryableException"><span class="hs-identifier hs-var">managerRetryableException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107216"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107216"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Maybe IOException
forall e. Exception e =&gt; SomeException -&gt; Maybe e
</span><span class="hs-identifier hs-var">fromException</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107216"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-73"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-74"></span><span>            </span><span class="annot"><span class="annottext">Maybe IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContentWrapper -&gt; HttpExceptionContent)
-&gt; Maybe HttpExceptionContentWrapper -&gt; Maybe HttpExceptionContent
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContentWrapper -&gt; HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#unHttpExceptionContentWrapper"><span class="hs-identifier hs-var">unHttpExceptionContentWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HttpExceptionContentWrapper -&gt; Maybe HttpExceptionContent)
-&gt; Maybe HttpExceptionContentWrapper -&gt; Maybe HttpExceptionContent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Maybe HttpExceptionContentWrapper
forall e. Exception e =&gt; SomeException -&gt; Maybe e
</span><span class="hs-identifier hs-var">fromException</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107216"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-76"></span><span>                    </span><span class="hs-comment">-- Note: Some servers will timeout connections by accepting</span><span>
</span><span id="line-77"></span><span>                    </span><span class="hs-comment">-- the incoming packets for the new request, but closing</span><span>
</span><span id="line-78"></span><span>                    </span><span class="hs-comment">-- the connection as soon as we try to read. To make sure</span><span>
</span><span id="line-79"></span><span>                    </span><span class="hs-comment">-- we open a new connection under these circumstances, we</span><span>
</span><span id="line-80"></span><span>                    </span><span class="hs-comment">-- check for the NoResponseDataReceived exception.</span><span>
</span><span id="line-81"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#NoResponseDataReceived"><span class="hs-identifier hs-var">NoResponseDataReceived</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-82"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#IncompleteHeaders"><span class="hs-identifier hs-var">IncompleteHeaders</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-83"></span><span>                    </span><span class="annot"><span class="annottext">Maybe HttpExceptionContent
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerWrapException :: forall a. Request -&gt; IO a -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#managerWrapException"><span class="hs-identifier hs-var">managerWrapException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107223"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107223"><span class="hs-identifier hs-var">_req</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107226"><span class="annot"><span class="annottext">wrapper :: SomeException -&gt; IO a
</span><a href="#local-6989586621679107226"><span class="hs-identifier hs-var hs-var">wrapper</span></a></span></span><span> </span><span id="local-6989586621679107227"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107227"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Maybe IOException
forall e. Exception e =&gt; SomeException -&gt; Maybe e
</span><span class="hs-identifier hs-var">fromException</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107227"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-87"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO a
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContent -&gt; IO a) -&gt; HttpExceptionContent -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#InternalException"><span class="hs-identifier hs-var">InternalException</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107227"><span class="hs-identifier hs-var">se</span></a></span><span>
</span><span id="line-88"></span><span>                    </span><span class="annot"><span class="annottext">Maybe IOException
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679107227"><span class="hs-identifier hs-var">se</span></a></span><span>
</span><span id="line-89"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; IO a) -&gt; IO a -&gt; IO a
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; IO a
forall {a}. SomeException -&gt; IO a
</span><a href="#local-6989586621679107226"><span class="hs-identifier hs-var">wrapper</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerIdleConnectionCount :: Int
</span><a href="Network.HTTP.Client.Types.html#managerIdleConnectionCount"><span class="hs-identifier hs-var">managerIdleConnectionCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">512</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerModifyRequest :: Request -&gt; IO Request
</span><a href="Network.HTTP.Client.Types.html#managerModifyRequest"><span class="hs-identifier hs-var">managerModifyRequest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerModifyResponse :: Response BodyReader -&gt; IO (Response BodyReader)
</span><a href="Network.HTTP.Client.Types.html#managerModifyResponse"><span class="hs-identifier hs-var">managerModifyResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response BodyReader -&gt; IO (Response BodyReader)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerProxyInsecure :: ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#managerProxyInsecure"><span class="hs-identifier hs-var">managerProxyInsecure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#defaultProxy"><span class="hs-identifier hs-var">defaultProxy</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerProxySecure :: ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#managerProxySecure"><span class="hs-identifier hs-var">managerProxySecure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#defaultProxy"><span class="hs-identifier hs-var">defaultProxy</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">managerMaxHeaderLength :: Maybe MaxHeaderLength
</span><a href="Network.HTTP.Client.Types.html#managerMaxHeaderLength"><span class="hs-identifier hs-var">managerMaxHeaderLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaxHeaderLength -&gt; Maybe MaxHeaderLength
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MaxHeaderLength -&gt; Maybe MaxHeaderLength)
-&gt; MaxHeaderLength -&gt; Maybe MaxHeaderLength
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; MaxHeaderLength
</span><a href="Network.HTTP.Client.Types.html#MaxHeaderLength"><span class="hs-identifier hs-var">MaxHeaderLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4096</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Create a 'Manager'. The @Manager@ will be shut down automatically via</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- garbage collection.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Creating a new 'Manager' is a relatively expensive operation, you are</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- advised to share a single 'Manager' between requests instead.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- The first argument to this function is often 'defaultManagerSettings',</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- though add-on libraries may provide a recommended replacement.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Since 0.1.0</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier hs-type">newManager</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier hs-type">ManagerSettings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span>
</span><span id="line-109"></span><span id="newManager"><span class="annot"><span class="annottext">newManager :: ManagerSettings -&gt; IO Manager
</span><a href="Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier hs-var hs-var">newManager</span></a></span></span><span> </span><span id="local-6989586621679107237"><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
</span><span class="hs-identifier hs-var">NS.withSocketsDo</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679107239"><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679107239"><span class="hs-identifier hs-var">httpProxy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProxyOverride -&gt; Bool -&gt; IO (Request -&gt; Request)
</span><a href="Network.HTTP.Client.Types.html#runProxyOverride"><span class="hs-identifier hs-var">runProxyOverride</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ManagerSettings -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#managerProxyInsecure"><span class="hs-identifier hs-var">managerProxyInsecure</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679107241"><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679107241"><span class="hs-identifier hs-var">httpsProxy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProxyOverride -&gt; Bool -&gt; IO (Request -&gt; Request)
</span><a href="Network.HTTP.Client.Types.html#runProxyOverride"><span class="hs-identifier hs-var">runProxyOverride</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ManagerSettings -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#managerProxySecure"><span class="hs-identifier hs-var">managerProxySecure</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679107242"><span class="annot"><span class="annottext">ConnKey -&gt; IO Connection
</span><a href="#local-6989586621679107242"><span class="hs-identifier hs-var">createConnection</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO (ConnKey -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Manager.html#mkCreateConnection"><span class="hs-identifier hs-var">mkCreateConnection</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679107244"><span class="annot"><span class="annottext">KeyedPool ConnKey Connection
</span><a href="#local-6989586621679107244"><span class="hs-identifier hs-var">keyedPool</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ConnKey -&gt; IO Connection)
-&gt; (Connection -&gt; IO ())
-&gt; Int
-&gt; Int
-&gt; (SomeException -&gt; IO ())
-&gt; IO (KeyedPool ConnKey Connection)
forall key resource.
Ord key =&gt;
(key -&gt; IO resource)
-&gt; (resource -&gt; IO ())
-&gt; Int
-&gt; Int
-&gt; (SomeException -&gt; IO ())
-&gt; IO (KeyedPool key resource)
</span><a href="Data.KeyedPool.html#createKeyedPool"><span class="hs-identifier hs-var">createKeyedPool</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">ConnKey -&gt; IO Connection
</span><a href="#local-6989586621679107242"><span class="hs-identifier hs-var">createConnection</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">Connection -&gt; IO ()
</span><a href="Network.HTTP.Client.Types.html#connectionClose"><span class="hs-identifier hs-var">connectionClose</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ManagerSettings -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#managerConnCount"><span class="hs-identifier hs-var">managerConnCount</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ManagerSettings -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#managerIdleConnectionCount"><span class="hs-identifier hs-var">managerIdleConnectionCount</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; SomeException -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- could allow something in ManagerSettings to handle exceptions more nicely</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107247"><span class="annot"><span class="annottext">manager :: Manager
</span><a href="#local-6989586621679107247"><span class="hs-identifier hs-var hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mConns :: KeyedPool ConnKey Connection
</span><a href="Network.HTTP.Client.Types.html#mConns"><span class="hs-identifier hs-var">mConns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyedPool ConnKey Connection
</span><a href="#local-6989586621679107244"><span class="hs-identifier hs-var">keyedPool</span></a></span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mResponseTimeout :: ResponseTimeout
</span><a href="Network.HTTP.Client.Types.html#mResponseTimeout"><span class="hs-identifier hs-var">mResponseTimeout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; ResponseTimeout
</span><a href="Network.HTTP.Client.Types.html#managerResponseTimeout"><span class="hs-identifier hs-var">managerResponseTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mRetryableException :: SomeException -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#mRetryableException"><span class="hs-identifier hs-var">mRetryableException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; SomeException -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#managerRetryableException"><span class="hs-identifier hs-var">managerRetryableException</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mWrapException :: forall a. Request -&gt; IO a -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#mWrapException"><span class="hs-identifier hs-var">mWrapException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; forall a. Request -&gt; IO a -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#managerWrapException"><span class="hs-identifier hs-var">managerWrapException</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-129"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mModifyRequest :: Request -&gt; IO Request
</span><a href="Network.HTTP.Client.Types.html#mModifyRequest"><span class="hs-identifier hs-var">mModifyRequest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; Request -&gt; IO Request
</span><a href="Network.HTTP.Client.Types.html#managerModifyRequest"><span class="hs-identifier hs-var">managerModifyRequest</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mModifyResponse :: Response BodyReader -&gt; IO (Response BodyReader)
</span><a href="Network.HTTP.Client.Types.html#mModifyResponse"><span class="hs-identifier hs-var">mModifyResponse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; Response BodyReader -&gt; IO (Response BodyReader)
</span><a href="Network.HTTP.Client.Types.html#managerModifyResponse"><span class="hs-identifier hs-var">managerModifyResponse</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mSetProxy :: Request -&gt; Request
</span><a href="Network.HTTP.Client.Types.html#mSetProxy"><span class="hs-identifier hs-var">mSetProxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107255"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107255"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107255"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-133"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679107241"><span class="hs-identifier hs-var">httpsProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107255"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-134"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679107239"><span class="hs-identifier hs-var">httpProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107255"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mMaxHeaderLength :: Maybe MaxHeaderLength
</span><a href="Network.HTTP.Client.Types.html#mMaxHeaderLength"><span class="hs-identifier hs-var">mMaxHeaderLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; Maybe MaxHeaderLength
</span><a href="Network.HTTP.Client.Types.html#managerMaxHeaderLength"><span class="hs-identifier hs-var">managerMaxHeaderLength</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107237"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Manager -&gt; IO Manager
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107247"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">{- FIXME why isn't this being used anymore?
    flushStaleCerts now =
        Map.fromList . mapMaybe flushStaleCerts' . Map.toList
      where
        flushStaleCerts' (host', inner) =
            case mapMaybe flushStaleCerts'' $ Map.toList inner of
                [] -&gt; Nothing
                pairs -&gt;
                    let x = take 10 pairs
                     in x `seqPairs` Just (host', Map.fromList x)
        flushStaleCerts'' (certs, expires)
            | expires &gt; now = Just (certs, expires)
            | otherwise     = Nothing

        seqPairs :: [(L.ByteString, UTCTime)] -&gt; b -&gt; b
        seqPairs [] b = b
        seqPairs (p:ps) b = p `seqPair` ps `seqPairs` b

        seqPair :: (L.ByteString, UTCTime) -&gt; b -&gt; b
        seqPair (lbs, utc) b = lbs `seqLBS` utc `seqUTC` b

        seqLBS :: L.ByteString -&gt; b -&gt; b
        seqLBS lbs b = L.length lbs `seq` b

        seqUTC :: UTCTime -&gt; b -&gt; b
        seqUTC (UTCTime day dt) b = day `seqDay` dt `seqDT` b

        seqDay :: Day -&gt; b -&gt; b
        seqDay (ModifiedJulianDay i) b = i `deepseq` b

        seqDT :: DiffTime -&gt; b -&gt; b
        seqDT = seq
    -}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Close all connections in a 'Manager'.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Note that this doesn't affect currently in-flight connections,</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- meaning you can safely use it without hurting any queries you may</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- have concurrently running.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- Since 0.1.0</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#closeManager"><span class="hs-identifier hs-type">closeManager</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span id="closeManager"><span class="annot"><span class="annottext">closeManager :: Manager -&gt; IO ()
</span><a href="Network.HTTP.Client.Manager.html#closeManager"><span class="hs-identifier hs-var hs-var">closeManager</span></a></span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">closeManager</span><span> </span><span class="hs-pragma">&quot;Manager will be closed for you automatically when no longer in use&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Create, use and close a 'Manager'.</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- Since 0.2.1</span><span>
</span><span id="line-187"></span><span id="local-6989586621679107106"><span class="annot"><a href="Network.HTTP.Client.Manager.html#withManager"><span class="hs-identifier hs-type">withManager</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier hs-type">ManagerSettings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679107106"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679107106"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-188"></span><span id="withManager"><span class="annot"><span class="annottext">withManager :: forall a. ManagerSettings -&gt; (Manager -&gt; IO a) -&gt; IO a
</span><a href="Network.HTTP.Client.Manager.html#withManager"><span class="hs-identifier hs-var hs-var">withManager</span></a></span></span><span> </span><span id="local-6989586621679107259"><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107259"><span class="hs-identifier hs-var">settings</span></a></span></span><span> </span><span id="local-6989586621679107260"><span class="annot"><span class="annottext">Manager -&gt; IO a
</span><a href="#local-6989586621679107260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManagerSettings -&gt; IO Manager
</span><a href="Network.HTTP.Client.Manager.html#newManager"><span class="hs-identifier hs-var">newManager</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107259"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">IO Manager -&gt; (Manager -&gt; IO a) -&gt; IO a
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; IO a
</span><a href="#local-6989586621679107260"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-189"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">withManager</span><span> </span><span class="hs-pragma">&quot;Use newManager instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Drop the Proxy-Authorization header from the request if we're using a</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- secure proxy.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#dropProxyAuthSecure"><span class="hs-identifier hs-type">dropProxyAuthSecure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-194"></span><span id="dropProxyAuthSecure"><span class="annot"><span class="annottext">dropProxyAuthSecure :: Request -&gt; Request
</span><a href="Network.HTTP.Client.Manager.html#dropProxyAuthSecure"><span class="hs-identifier hs-var hs-var">dropProxyAuthSecure</span></a></span></span><span> </span><span id="local-6989586621679107261"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107261"><span class="hs-identifier hs-var">req</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107261"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107263"><span class="hs-identifier hs-var">useProxy'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107261"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#requestHeaders"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679107265"><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621679107265"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><a href="#local-6989586621679107265"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; HeaderName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Proxy-Authorization&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Types.html#requestHeaders"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679107261"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107261"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679107263"><span class="annot"><span class="annottext">useProxy' :: Bool
</span><a href="#local-6989586621679107263"><span class="hs-identifier hs-var hs-var">useProxy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107261"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#getConn"><span class="hs-identifier hs-type">getConn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">Manager</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.KeyedPool.html#Managed"><span class="hs-identifier hs-type">Managed</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span id="getConn"><span class="annot"><span class="annottext">getConn :: Request -&gt; Manager -&gt; IO (Managed Connection)
</span><a href="Network.HTTP.Client.Manager.html#getConn"><span class="hs-identifier hs-var hs-var">getConn</span></a></span></span><span> </span><span id="local-6989586621679107268"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107268"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621679107269"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107269"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- Stop Mac OS X from getting high:</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- https://github.com/snoyberg/http-client/issues/40#issuecomment-39117909</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">S8.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107271"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO (Managed Connection)
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContent -&gt; IO (Managed Connection))
-&gt; HttpExceptionContent -&gt; IO (Managed Connection)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#InvalidDestinationHost"><span class="hs-identifier hs-var">InvalidDestinationHost</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107271"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyedPool ConnKey Connection -&gt; ConnKey -&gt; IO (Managed Connection)
forall key resource.
Ord key =&gt;
KeyedPool key resource -&gt; key -&gt; IO (Managed resource)
</span><a href="Data.KeyedPool.html#takeKeyedPool"><span class="hs-identifier hs-var">takeKeyedPool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Manager -&gt; KeyedPool ConnKey Connection
</span><a href="Network.HTTP.Client.Types.html#mConns"><span class="hs-identifier hs-var">mConns</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679107269"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConnKey
</span><a href="#local-6989586621679107274"><span class="hs-identifier hs-var">connkey</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679107271"><span class="annot"><span class="annottext">h :: ByteString
</span><a href="#local-6989586621679107271"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#host"><span class="hs-identifier hs-var">host</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107268"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679107274"><span class="annot"><span class="annottext">connkey :: ConnKey
</span><a href="#local-6989586621679107274"><span class="hs-identifier hs-var hs-var">connkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ConnKey
</span><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var">connKey</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107268"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-type">connKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ConnKey"><span class="hs-identifier hs-type">ConnKey</span></a></span><span>
</span><span id="line-216"></span><span id="connKey"><span class="annot"><span class="annottext">connKey :: Request -&gt; ConnKey
</span><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var hs-var">connKey</span></a></span></span><span> </span><span id="local-6989586621679107277"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679107277"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; ByteString -&gt; Int -&gt; ConnKey
</span><a href="Network.HTTP.Client.Types.html#CKRaw"><span class="hs-identifier hs-var">CKRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Maybe HostAddress
</span><a href="Network.HTTP.Client.Types.html#hostAddress"><span class="hs-identifier hs-var">hostAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107277"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#host"><span class="hs-identifier hs-var">host</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107277"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#port"><span class="hs-identifier hs-var">port</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107277"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var">connKey</span></a></span><span> </span><span id="local-6989586621679107282"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679107282"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; ByteString -&gt; Int -&gt; ConnKey
</span><a href="Network.HTTP.Client.Types.html#CKSecure"><span class="hs-identifier hs-var">CKSecure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Maybe HostAddress
</span><a href="Network.HTTP.Client.Types.html#hostAddress"><span class="hs-identifier hs-var">hostAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107282"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#host"><span class="hs-identifier hs-var">host</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107282"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#port"><span class="hs-identifier hs-var">port</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107282"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var">connKey</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107284"><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107284"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; ByteString -&gt; Int -&gt; ConnKey
</span><a href="Network.HTTP.Client.Types.html#CKRaw"><span class="hs-identifier hs-var">CKRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#proxyHost"><span class="hs-identifier hs-var">proxyHost</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107284"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#proxyPort"><span class="hs-identifier hs-var">proxyPort</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107284"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var">connKey</span></a></span><span> </span><span id="local-6989586621679107287"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679107287"><span class="hs-identifier hs-var">req</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107288"><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107288"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>                      </span><span class="annot"><span class="annottext">proxySecureMode :: Request -&gt; ProxySecureMode
</span><a href="Network.HTTP.Client.Types.html#proxySecureMode"><span class="hs-identifier hs-var">proxySecureMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProxySecureMode
</span><a href="Network.HTTP.Client.Types.html#ProxySecureWithConnect"><span class="hs-identifier hs-var">ProxySecureWithConnect</span></a></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">ByteString
-&gt; Int -&gt; Maybe ByteString -&gt; ByteString -&gt; Int -&gt; ConnKey
</span><a href="Network.HTTP.Client.Types.html#CKProxy"><span class="hs-identifier hs-var">CKProxy</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#proxyHost"><span class="hs-identifier hs-var">proxyHost</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107288"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#proxyPort"><span class="hs-identifier hs-var">proxyPort</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107288"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName -&gt; [Header] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Proxy-Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><a href="Network.HTTP.Client.Types.html#requestHeaders"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107287"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#host"><span class="hs-identifier hs-var">host</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107287"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#port"><span class="hs-identifier hs-var">port</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107287"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#connKey"><span class="hs-identifier hs-var">connKey</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Request -&gt; Maybe Proxy
</span><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107293"><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107293"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">secure :: Request -&gt; Bool
</span><a href="Network.HTTP.Client.Types.html#secure"><span class="hs-identifier hs-var">secure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>                  </span><span class="annot"><span class="annottext">proxySecureMode :: Request -&gt; ProxySecureMode
</span><a href="Network.HTTP.Client.Types.html#proxySecureMode"><span class="hs-identifier hs-var">proxySecureMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProxySecureMode
</span><a href="Network.HTTP.Client.Types.html#ProxySecureWithoutConnect"><span class="hs-identifier hs-var">ProxySecureWithoutConnect</span></a></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; ByteString -&gt; Int -&gt; ConnKey
</span><a href="Network.HTTP.Client.Types.html#CKRaw"><span class="hs-identifier hs-var">CKRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; ByteString
</span><a href="Network.HTTP.Client.Types.html#proxyHost"><span class="hs-identifier hs-var">proxyHost</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107293"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy -&gt; Int
</span><a href="Network.HTTP.Client.Types.html#proxyPort"><span class="hs-identifier hs-var">proxyPort</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107293"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#mkCreateConnection"><span class="hs-identifier hs-type">mkCreateConnection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ManagerSettings"><span class="hs-identifier hs-type">ManagerSettings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Types.html#ConnKey"><span class="hs-identifier hs-type">ConnKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Connection"><span class="hs-identifier hs-type">Connection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="mkCreateConnection"><span class="annot"><span class="annottext">mkCreateConnection :: ManagerSettings -&gt; IO (ConnKey -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Manager.html#mkCreateConnection"><span class="hs-identifier hs-var hs-var">mkCreateConnection</span></a></span></span><span> </span><span id="local-6989586621679107295"><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107295"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679107296"><span class="annot"><span class="annottext">Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="#local-6989586621679107296"><span class="hs-identifier hs-var">rawConnection</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerRawConnection"><span class="hs-identifier hs-var">managerRawConnection</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107295"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679107297"><span class="annot"><span class="annottext">Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="#local-6989586621679107297"><span class="hs-identifier hs-var">tlsConnection</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings
-&gt; IO (Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerTlsConnection"><span class="hs-identifier hs-var">managerTlsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107295"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679107298"><span class="annot"><span class="annottext">ByteString
-&gt; (Connection -&gt; IO ())
-&gt; String
-&gt; Maybe HostAddress
-&gt; String
-&gt; Int
-&gt; IO Connection
</span><a href="#local-6989586621679107298"><span class="hs-identifier hs-var">tlsProxyConnection</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ManagerSettings
-&gt; IO
     (ByteString
      -&gt; (Connection -&gt; IO ())
      -&gt; String
      -&gt; Maybe HostAddress
      -&gt; String
      -&gt; Int
      -&gt; IO Connection)
</span><a href="Network.HTTP.Client.Types.html#managerTlsProxyConnection"><span class="hs-identifier hs-var">managerTlsProxyConnection</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107295"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">(ConnKey -&gt; IO Connection) -&gt; IO (ConnKey -&gt; IO Connection)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((ConnKey -&gt; IO Connection) -&gt; IO (ConnKey -&gt; IO Connection))
-&gt; (ConnKey -&gt; IO Connection) -&gt; IO (ConnKey -&gt; IO Connection)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107299"><span class="annot"><span class="annottext">ConnKey
</span><a href="#local-6989586621679107299"><span class="hs-identifier hs-var">ck</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Connection -&gt; IO Connection
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679107300"><span class="hs-identifier hs-var">wrapConnectExc</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Connection -&gt; IO Connection) -&gt; IO Connection -&gt; IO Connection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConnKey
</span><a href="#local-6989586621679107299"><span class="hs-identifier hs-var">ck</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><a href="Network.HTTP.Client.Types.html#CKRaw"><span class="hs-identifier hs-type">CKRaw</span></a></span><span> </span><span id="local-6989586621679107301"><span class="annot"><span class="annottext">Maybe HostAddress
</span><a href="#local-6989586621679107301"><span class="hs-identifier hs-var">connaddr</span></a></span></span><span> </span><span id="local-6989586621679107302"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107302"><span class="hs-identifier hs-var">connhost</span></a></span></span><span> </span><span id="local-6989586621679107303"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107303"><span class="hs-identifier hs-var">connport</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>            </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="#local-6989586621679107296"><span class="hs-identifier hs-var">rawConnection</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress
</span><a href="#local-6989586621679107301"><span class="hs-identifier hs-var">connaddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107302"><span class="hs-identifier hs-var">connhost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107303"><span class="hs-identifier hs-var">connport</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><a href="Network.HTTP.Client.Types.html#CKSecure"><span class="hs-identifier hs-type">CKSecure</span></a></span><span> </span><span id="local-6989586621679107305"><span class="annot"><span class="annottext">Maybe HostAddress
</span><a href="#local-6989586621679107305"><span class="hs-identifier hs-var">connaddr</span></a></span></span><span> </span><span id="local-6989586621679107306"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107306"><span class="hs-identifier hs-var">connhost</span></a></span></span><span> </span><span id="local-6989586621679107307"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107307"><span class="hs-identifier hs-var">connport</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>            </span><span class="annot"><span class="annottext">Maybe HostAddress -&gt; String -&gt; Int -&gt; IO Connection
</span><a href="#local-6989586621679107297"><span class="hs-identifier hs-var">tlsConnection</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HostAddress
</span><a href="#local-6989586621679107305"><span class="hs-identifier hs-var">connaddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107306"><span class="hs-identifier hs-var">connhost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107307"><span class="hs-identifier hs-var">connport</span></a></span><span>
</span><span id="line-245"></span><span>        </span><span class="annot"><a href="Network.HTTP.Client.Types.html#CKProxy"><span class="hs-identifier hs-type">CKProxy</span></a></span><span> </span><span id="local-6989586621679107308"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107308"><span class="hs-identifier hs-var">connhost</span></a></span></span><span> </span><span id="local-6989586621679107309"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107309"><span class="hs-identifier hs-var">connport</span></a></span></span><span> </span><span id="local-6989586621679107310"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679107310"><span class="hs-identifier hs-var">mProxyAuthHeader</span></a></span></span><span> </span><span id="local-6989586621679107311"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107311"><span class="hs-identifier hs-var">ultHost</span></a></span></span><span> </span><span id="local-6989586621679107312"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107312"><span class="hs-identifier hs-var">ultPort</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107316"><span class="annot"><span class="annottext">proxyAuthorizationHeader :: ByteString
</span><a href="#local-6989586621679107316"><span class="hs-identifier hs-var hs-var">proxyAuthorizationHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-247"></span><span>                    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-248"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679107318"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107318"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Proxy-Authorization: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107318"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                    </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679107310"><span class="hs-identifier hs-var">mProxyAuthHeader</span></a></span><span>
</span><span id="line-250"></span><span>                </span><span id="local-6989586621679107325"><span class="annot"><span class="annottext">hostHeader :: ByteString
</span><a href="#local-6989586621679107325"><span class="hs-identifier hs-var hs-var">hostHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Host: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107311"><span class="hs-identifier hs-var">ultHost</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107312"><span class="hs-identifier hs-var">ultPort</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span>                </span><span id="local-6989586621679107333"><span class="annot"><span class="annottext">connstr :: ByteString
</span><a href="#local-6989586621679107333"><span class="hs-identifier hs-var hs-var">connstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.concat</span></span><span>
</span><span id="line-252"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;CONNECT &quot;</span></span><span>
</span><span id="line-253"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107311"><span class="hs-identifier hs-var">ultHost</span></a></span><span>
</span><span id="line-254"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-255"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107312"><span class="hs-identifier hs-var">ultPort</span></a></span><span>
</span><span id="line-256"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; HTTP/1.1\r\n&quot;</span></span><span>
</span><span id="line-257"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107316"><span class="hs-identifier hs-var">proxyAuthorizationHeader</span></a></span><span>
</span><span id="line-258"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107325"><span class="hs-identifier hs-var">hostHeader</span></a></span><span>
</span><span id="line-259"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-260"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>                </span><span id="local-6989586621679107340"><span class="annot"><span class="annottext">parse :: Connection -&gt; IO ()
</span><a href="#local-6989586621679107340"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679107341"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679107341"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>                    </span><span class="annot"><a href="Network.HTTP.Client.Types.html#StatusHeaders"><span class="hs-identifier hs-type">StatusHeaders</span></a></span><span> </span><span id="local-6989586621679107343"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107343"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="annot"><span class="annottext">HttpVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe MaxHeaderLength
-&gt; Connection
-&gt; Maybe Int
-&gt; ([Header] -&gt; IO ())
-&gt; Maybe (IO ())
-&gt; IO StatusHeaders
</span><a href="Network.HTTP.Client.Headers.html#parseStatusHeaders"><span class="hs-identifier hs-var">parseStatusHeaders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ManagerSettings -&gt; Maybe MaxHeaderLength
</span><a href="Network.HTTP.Client.Types.html#managerMaxHeaderLength"><span class="hs-identifier hs-var">managerMaxHeaderLength</span></a></span><span> </span><span class="annot"><span class="annottext">ManagerSettings
</span><a href="#local-6989586621679107295"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679107341"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[Header]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (IO ())
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-263"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107343"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-264"></span><span>                        </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO ()
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContent -&gt; IO ()) -&gt; HttpExceptionContent -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Status -&gt; HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#ProxyConnectException"><span class="hs-identifier hs-var">ProxyConnectException</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107311"><span class="hs-identifier hs-var">ultHost</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107312"><span class="hs-identifier hs-var">ultPort</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679107343"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-265"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (Connection -&gt; IO ())
-&gt; String
-&gt; Maybe HostAddress
-&gt; String
-&gt; Int
-&gt; IO Connection
</span><a href="#local-6989586621679107298"><span class="hs-identifier hs-var">tlsProxyConnection</span></a></span><span>
</span><span id="line-266"></span><span>                        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107333"><span class="hs-identifier hs-var">connstr</span></a></span><span>
</span><span id="line-267"></span><span>                        </span><span class="annot"><span class="annottext">Connection -&gt; IO ()
</span><a href="#local-6989586621679107340"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-268"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107311"><span class="hs-identifier hs-var">ultHost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                        </span><span class="annot"><span class="annottext">Maybe HostAddress
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- we never have a HostAddress we can use</span><span>
</span><span id="line-270"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679107308"><span class="hs-identifier hs-var">connhost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107309"><span class="hs-identifier hs-var">connport</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679107300"><span class="annot"><span class="annottext">wrapConnectExc :: IO a -&gt; IO a
</span><a href="#local-6989586621679107300"><span class="hs-identifier hs-var hs-var">wrapConnectExc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IOException -&gt; IO a) -&gt; IO a -&gt; IO a
forall e a. Exception e =&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><span class="hs-identifier hs-var">handle</span></span><span> </span><span class="annot"><span class="annottext">((IOException -&gt; IO a) -&gt; IO a -&gt; IO a)
-&gt; (IOException -&gt; IO a) -&gt; IO a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107347"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679107347"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><span class="annottext">HttpExceptionContent -&gt; IO a
forall a. HttpExceptionContent -&gt; IO a
</span><a href="Network.HTTP.Client.Types.html#throwHttp"><span class="hs-identifier hs-var">throwHttp</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpExceptionContent -&gt; IO a) -&gt; HttpExceptionContent -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; HttpExceptionContent
</span><a href="Network.HTTP.Client.Types.html#ConnectionFailure"><span class="hs-identifier hs-var">ConnectionFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException -&gt; SomeException
forall e. Exception e =&gt; e -&gt; SomeException
</span><span class="hs-identifier hs-var">toException</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621679107347"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Get the proxy settings from the @Request@ itself.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-279"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyFromRequest"><span class="hs-identifier hs-type">proxyFromRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-280"></span><span id="proxyFromRequest"><span class="annot"><span class="annottext">proxyFromRequest :: ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#proxyFromRequest"><span class="hs-identifier hs-var hs-var">proxyFromRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request))
-&gt; IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Never connect using a proxy, regardless of the proxy value in the @Request@.</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#noProxy"><span class="hs-identifier hs-type">noProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-286"></span><span id="noProxy"><span class="annot"><span class="annottext">noProxy :: ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#noProxy"><span class="hs-identifier hs-var hs-var">noProxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request))
-&gt; IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; IO (Request -&gt; Request))
-&gt; (Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107352"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107352"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107352"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Use the given proxy settings, regardless of the proxy value in the @Request@.</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#useProxy"><span class="hs-identifier hs-type">useProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-292"></span><span id="useProxy"><span class="annot"><span class="annottext">useProxy :: Proxy -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#useProxy"><span class="hs-identifier hs-var hs-var">useProxy</span></a></span></span><span> </span><span id="local-6989586621679107353"><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107353"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request))
-&gt; IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; IO (Request -&gt; Request))
-&gt; (Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107354"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107354"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107354"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679107353"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Send secure requests to the proxy in plain text rather than using CONNECT,</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- regardless of the value in the @Request@.</span><span>
</span><span id="line-296"></span><span class="hs-comment">--</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- @since 0.7.2</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#useProxySecureWithoutConnect"><span class="hs-identifier hs-type">useProxySecureWithoutConnect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-299"></span><span id="useProxySecureWithoutConnect"><span class="annot"><span class="annottext">useProxySecureWithoutConnect :: Proxy -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#useProxySecureWithoutConnect"><span class="hs-identifier hs-var hs-var">useProxySecureWithoutConnect</span></a></span></span><span> </span><span id="local-6989586621679107355"><span class="annot"><span class="annottext">Proxy
</span><a href="#local-6989586621679107355"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="annottext">IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request))
-&gt; IO (Request -&gt; Request) -&gt; Bool -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request) -&gt; IO (Request -&gt; Request))
-&gt; (Request -&gt; Request) -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107356"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107356"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679107356"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#proxy"><span class="hs-identifier hs-var">proxy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679107355"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>                                 </span><span class="annot"><a href="Network.HTTP.Client.Types.html#proxySecureMode"><span class="hs-identifier hs-var">proxySecureMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxySecureWithoutConnect"><span class="hs-identifier hs-type">ProxySecureWithoutConnect</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Get the proxy settings from the default environment variable (@http_proxy@</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- for insecure, @https_proxy@ for secure). If no variable is set, then fall</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- back to the given value. @Nothing@ is equivalent to 'noProxy', @Just@ is</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- equivalent to 'useProxy'.</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyEnvironment"><span class="hs-identifier hs-type">proxyEnvironment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ fallback if no environment set</span></span><span>
</span><span id="line-310"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-311"></span><span id="proxyEnvironment"><span class="annot"><span class="annottext">proxyEnvironment :: Maybe Proxy -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#proxyEnvironment"><span class="hs-identifier hs-var hs-var">proxyEnvironment</span></a></span></span><span> </span><span id="local-6989586621679107357"><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679107357"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107358"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107358"><span class="hs-identifier hs-var">secure'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; ProxyProtocol -&gt; EnvHelper -&gt; IO (Request -&gt; Request)
</span><a href="Network.HTTP.Proxy.html#systemProxyHelper"><span class="hs-identifier hs-var">systemProxyHelper</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; ProxyProtocol
</span><a href="Network.HTTP.Proxy.html#httpProtocol"><span class="hs-identifier hs-var">httpProtocol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107358"><span class="hs-identifier hs-var">secure'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EnvHelper -&gt; IO (Request -&gt; Request))
-&gt; EnvHelper -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EnvHelper -&gt; (Proxy -&gt; EnvHelper) -&gt; Maybe Proxy -&gt; EnvHelper
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">EnvHelper
</span><a href="Network.HTTP.Proxy.html#EHNoProxy"><span class="hs-identifier hs-var">EHNoProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy -&gt; EnvHelper
</span><a href="Network.HTTP.Proxy.html#EHUseProxy"><span class="hs-identifier hs-var">EHUseProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679107357"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Same as 'proxyEnvironment', but instead of default environment variable</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- names, allows you to set your own name.</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-318"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#proxyEnvironmentNamed"><span class="hs-identifier hs-type">proxyEnvironmentNamed</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ environment variable name</span></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ fallback if no environment set</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-322"></span><span id="proxyEnvironmentNamed"><span class="annot"><span class="annottext">proxyEnvironmentNamed :: Text -&gt; Maybe Proxy -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#proxyEnvironmentNamed"><span class="hs-identifier hs-var hs-var">proxyEnvironmentNamed</span></a></span></span><span> </span><span id="local-6989586621679107363"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679107363"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679107364"><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679107364"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107365"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107365"><span class="hs-identifier hs-var">secure'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; ProxyProtocol -&gt; EnvHelper -&gt; IO (Request -&gt; Request)
</span><a href="Network.HTTP.Proxy.html#systemProxyHelper"><span class="hs-identifier hs-var">systemProxyHelper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679107363"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; ProxyProtocol
</span><a href="Network.HTTP.Proxy.html#httpProtocol"><span class="hs-identifier hs-var">httpProtocol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107365"><span class="hs-identifier hs-var">secure'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EnvHelper -&gt; IO (Request -&gt; Request))
-&gt; EnvHelper -&gt; IO (Request -&gt; Request)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EnvHelper -&gt; (Proxy -&gt; EnvHelper) -&gt; Maybe Proxy -&gt; EnvHelper
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">EnvHelper
</span><a href="Network.HTTP.Proxy.html#EHNoProxy"><span class="hs-identifier hs-var">EHNoProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy -&gt; EnvHelper
</span><a href="Network.HTTP.Proxy.html#EHUseProxy"><span class="hs-identifier hs-var">EHUseProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679107364"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | The default proxy settings for a manager. In particular: if the @http_proxy@ (or @https_proxy@) environment variable is set, use it. Otherwise, use the values in the @Request@.</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- Since 0.4.7</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Network.HTTP.Client.Manager.html#defaultProxy"><span class="hs-identifier hs-type">defaultProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-type">ProxyOverride</span></a></span><span>
</span><span id="line-329"></span><span id="defaultProxy"><span class="annot"><span class="annottext">defaultProxy :: ProxyOverride
</span><a href="Network.HTTP.Client.Manager.html#defaultProxy"><span class="hs-identifier hs-var hs-var">defaultProxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
</span><a href="Network.HTTP.Client.Types.html#ProxyOverride"><span class="hs-identifier hs-var">ProxyOverride</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride)
-&gt; (Bool -&gt; IO (Request -&gt; Request)) -&gt; ProxyOverride
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107366"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107366"><span class="hs-identifier hs-var">secure'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; ProxyProtocol -&gt; EnvHelper -&gt; IO (Request -&gt; Request)
</span><a href="Network.HTTP.Proxy.html#systemProxyHelper"><span class="hs-identifier hs-var">systemProxyHelper</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; ProxyProtocol
</span><a href="Network.HTTP.Proxy.html#httpProtocol"><span class="hs-identifier hs-var">httpProtocol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107366"><span class="hs-identifier hs-var">secure'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EnvHelper
</span><a href="Network.HTTP.Proxy.html#EHFromRequest"><span class="hs-identifier hs-var">EHFromRequest</span></a></span><span>
</span><span id="line-331"></span></pre></body></html>