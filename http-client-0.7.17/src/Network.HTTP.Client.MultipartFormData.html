<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- | This module handles building multipart/form-data. Example usage:</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- &gt; {-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- &gt; import Network</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- &gt; import Network.HTTP.Client</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- &gt; import Network.HTTP.Client.MultipartFormData</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- &gt; import Data.Text.Encoding as TE</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- &gt; import Control.Monad</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &gt; main = void $ withManager defaultManagerSettings $ \m -&gt; do</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- &gt;     req1 &lt;- parseRequest &quot;http://random-cat-photo.net/cat.jpg&quot;</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &gt;     res &lt;- httpLbs req1 m</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- &gt;     req2 &lt;- parseRequest &quot;http://example.org/~friedrich/blog/addPost.hs&quot;</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- &gt;     flip httpLbs m =&lt;&lt;</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt;         (formDataBody [partBS &quot;title&quot; &quot;Bleaurgh&quot;</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- &gt;                       ,partBS &quot;text&quot; $ TE.encodeUtf8 &quot;&#30690;&#30000;&#30690;&#30000;&#30690;&#30000;&#30690;&#30000;&#30690;&#30000;&quot;</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- &gt;                       ,partFileSource &quot;file1&quot; &quot;/home/friedrich/Photos/MyLittlePony.jpg&quot;</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &gt;                       ,partFileRequestBody &quot;file2&quot; &quot;cat.jpg&quot; $ RequestBodyLBS $ responseBody res]</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt;             req2)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.HTTP.Client.MultipartFormData</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Part type</span></span><span>
</span><span id="line-26"></span><span>     </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier">Part</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier">PartM</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partName"><span class="hs-identifier">partName</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFilename"><span class="hs-identifier">partFilename</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partContentType"><span class="hs-identifier">partContentType</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partHeaders"><span class="hs-identifier">partHeaders</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partGetBody"><span class="hs-identifier">partGetBody</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constructing parts</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partBS"><span class="hs-identifier">partBS</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partLBS"><span class="hs-identifier">partLBS</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFile"><span class="hs-identifier">partFile</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileSource"><span class="hs-identifier">partFileSource</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileSourceChunked"><span class="hs-identifier">partFileSourceChunked</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBody"><span class="hs-identifier">partFileRequestBody</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier">partFileRequestBodyM</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Headers</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#addPartHeaders"><span class="hs-identifier">addPartHeaders</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Building form data</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#formDataBody"><span class="hs-identifier">formDataBody</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#formDataBodyWithBoundary"><span class="hs-identifier">formDataBodyWithBoundary</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Boundary</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundary"><span class="hs-identifier">webkitBoundary</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundaryPure"><span class="hs-identifier">webkitBoundaryPure</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Misc</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#renderParts"><span class="hs-identifier">renderParts</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#renderPart"><span class="hs-identifier">renderPart</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Request.html#streamFile"><span class="hs-identifier">streamFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.Mime</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hContentType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">methodPost</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Header</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CaseInsensitive</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CI</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">state</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runState</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.Base</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultChunkSize</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span id="Part"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-var">Part</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | A single part of a multipart message.</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="PartM"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-var">PartM</span></a></span></span><span> </span><span id="local-6989586621679109266"><span class="annot"><a href="#local-6989586621679109266"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Part"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-var">Part</span></a></span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="partName"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). PartM m -&gt; Text
</span><a href="Network.HTTP.Client.MultipartFormData.html#partName"><span class="hs-identifier hs-var hs-var">partName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="partFilename"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). PartM m -&gt; Maybe String
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFilename"><span class="hs-identifier hs-var hs-var">partFilename</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ A file name, if this is an attached file</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="partContentType"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). PartM m -&gt; Maybe MimeType
</span><a href="Network.HTTP.Client.MultipartFormData.html#partContentType"><span class="hs-identifier hs-var hs-var">partContentType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MimeType</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Content type</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="partHeaders"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). PartM m -&gt; [Header]
</span><a href="Network.HTTP.Client.MultipartFormData.html#partHeaders"><span class="hs-identifier hs-var hs-var">partHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Header</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ List of additional headers</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="partGetBody"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). PartM m -&gt; m RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#partGetBody"><span class="hs-identifier hs-var hs-var">partGetBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679109266"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span><span> </span><span class="hs-comment">-- ^ Action in m which returns the body</span><span>
</span><span id="line-90"></span><span>                                   </span><span class="hs-comment">-- of a message.</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679109280"><span id="local-6989586621679109444"><span id="local-6989586621679109448"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109280"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679109471"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; PartM m -&gt; ShowS
</span><a href="#local-6989586621679109471"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679109473"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109473"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span> </span><span id="local-6989586621679109474"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109474"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109475"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679109475"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679109476"><span class="annot"><span class="annottext">Maybe MimeType
</span><a href="#local-6989586621679109476"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679109477"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679109477"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="annottext">m RequestBody
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109473"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Part &quot;</span></span><span>
</span><span id="line-96"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109474"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-97"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-98"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe String -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679109475"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-100"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe MimeType -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">Maybe MimeType
</span><a href="#local-6989586621679109476"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Header] -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679109477"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;m (RequestBody m)&gt;&quot;</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Make a 'Part' whose content is a strict 'BS.ByteString'.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- The 'Part' does not have a file name or content type associated</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- with it.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679109294"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partBS"><span class="hs-identifier hs-type">partBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679109294"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-111"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-112"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The body for this 'Part'.</span></span><span>
</span><span id="line-113"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109294"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-114"></span><span id="partBS"><span class="annot"><span class="annottext">partBS :: forall (m :: * -&gt; *). Applicative m =&gt; Text -&gt; MimeType -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partBS"><span class="hs-identifier hs-var hs-var">partBS</span></a></span></span><span> </span><span id="local-6989586621679109493"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109493"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109494"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109494"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
forall (m :: * -&gt; *).
Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-var">Part</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109493"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">Data.Monoid.mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe MimeType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[Header]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(m RequestBody -&gt; PartM m) -&gt; m RequestBody -&gt; PartM m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; m RequestBody
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; m RequestBody) -&gt; RequestBody -&gt; m RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyBS"><span class="hs-identifier hs-var">RequestBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109494"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Make a 'Part' whose content is a lazy 'BL.ByteString'.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- The 'Part' does not have a file name or content type associated</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- with it.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679109302"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partLBS"><span class="hs-identifier hs-type">partLBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679109302"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The body for this 'Part'.</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109302"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-124"></span><span id="partLBS"><span class="annot"><span class="annottext">partLBS :: forall (m :: * -&gt; *).
Applicative m =&gt;
Text -&gt; ByteString -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partLBS"><span class="hs-identifier hs-var hs-var">partLBS</span></a></span></span><span> </span><span id="local-6989586621679109503"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109503"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109504"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679109504"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
forall (m :: * -&gt; *).
Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-var">Part</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109503"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe MimeType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[Header]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(m RequestBody -&gt; PartM m) -&gt; m RequestBody -&gt; PartM m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; m RequestBody
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; m RequestBody) -&gt; RequestBody -&gt; m RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyLBS"><span class="hs-identifier hs-var">RequestBodyLBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679109504"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Make a 'Part' from a file.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- The entire file will reside in memory at once.  If you want</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- constant memory usage, use 'partFileSource'.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- The 'FilePath' supplied will be used as the file name of the</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- 'Part'. If you do not want to reveal this name to the server, you</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- must remove it prior to uploading.</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- The 'Part' does not have a content type associated with it.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFile"><span class="hs-identifier hs-type">partFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-137"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The name of the local file to upload.</span></span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span>
</span><span id="line-139"></span><span id="partFile"><span class="annot"><span class="annottext">partFile :: Text -&gt; String -&gt; Part
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFile"><span class="hs-identifier hs-var hs-var">partFile</span></a></span></span><span> </span><span id="local-6989586621679109507"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109507"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109508"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109508"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; IO RequestBody -&gt; Part
forall (m :: * -&gt; *). Text -&gt; String -&gt; m RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier hs-var">partFileRequestBodyM</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109507"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109508"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(IO RequestBody -&gt; Part) -&gt; IO RequestBody -&gt; Part
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">(MimeType -&gt; RequestBody) -&gt; IO MimeType -&gt; IO RequestBody
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyBS"><span class="hs-identifier hs-var">RequestBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">(IO MimeType -&gt; IO RequestBody) -&gt; IO MimeType -&gt; IO RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO MimeType -&gt; IO MimeType
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO MimeType -&gt; IO MimeType) -&gt; IO MimeType -&gt; IO MimeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO MimeType
</span><span class="hs-identifier hs-var">BS.readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109508"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Stream a 'Part' from a file.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- The 'FilePath' supplied will be used as the file name of the</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- 'Part'. If you do not want to reveal this name to the server, you</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- must remove it prior to uploading.</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- The 'Part' does not have a content type associated with it.</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileSource"><span class="hs-identifier hs-type">partFileSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-151"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The name of the local file to upload.</span></span><span>
</span><span id="line-152"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span>
</span><span id="line-153"></span><span id="partFileSource"><span class="annot"><span class="annottext">partFileSource :: Text -&gt; String -&gt; Part
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileSource"><span class="hs-identifier hs-var hs-var">partFileSource</span></a></span></span><span> </span><span id="local-6989586621679109512"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109512"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109513"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109513"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; IO RequestBody -&gt; Part
forall (m :: * -&gt; *). Text -&gt; String -&gt; m RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier hs-var">partFileRequestBodyM</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109512"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109513"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(IO RequestBody -&gt; Part) -&gt; IO RequestBody -&gt; Part
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621679109514"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679109514"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer -&gt; IO Integer
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Integer -&gt; IO Integer) -&gt; IO Integer -&gt; IO Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO Integer) -&gt; IO Integer
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109513"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Integer
</span><span class="hs-identifier hs-var">hFileSize</span></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">RequestBody -&gt; IO RequestBody
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; IO RequestBody) -&gt; RequestBody -&gt; IO RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; GivesPopper () -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyStream"><span class="hs-identifier hs-var">RequestBodyStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679109514"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GivesPopper () -&gt; RequestBody) -&gt; GivesPopper () -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; GivesPopper ()
</span><a href="Network.HTTP.Client.MultipartFormData.html#streamFile"><span class="hs-identifier hs-var">streamFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109513"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#streamFile"><span class="hs-identifier hs-type">streamFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#GivesPopper"><span class="hs-identifier hs-type">GivesPopper</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span id="streamFile"><span class="annot"><span class="annottext">streamFile :: String -&gt; GivesPopper ()
</span><a href="Network.HTTP.Client.MultipartFormData.html#streamFile"><span class="hs-identifier hs-var hs-var">streamFile</span></a></span></span><span> </span><span id="local-6989586621679109520"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109520"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679109521"><span class="annot"><span class="annottext">NeedsPopper ()
</span><a href="#local-6989586621679109521"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109520"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO ()) -&gt; IO ()) -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NeedsPopper ()
</span><a href="#local-6989586621679109521"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">NeedsPopper () -&gt; (Handle -&gt; IO MimeType) -&gt; Handle -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO MimeType
</span><a href="#local-6989586621679109523"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679109523"><span class="annot"><span class="annottext">go :: Handle -&gt; IO MimeType
</span><a href="#local-6989586621679109523"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679109524"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679109524"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO MimeType
</span><span class="hs-identifier hs-var">BS.hGetSome</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679109524"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier hs-var">defaultChunkSize</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | 'partFileSourceChunked' will read a file and send it in chunks.</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Note that not all servers support this. Only use 'partFileSourceChunked'</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- if you know the server you're sending to supports chunked request bodies.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- The 'FilePath' supplied will be used as the file name of the</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- 'Part'. If you do not want to reveal this name to the server, you</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- must remove it prior to uploading.</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- The 'Part' does not have a content type associated with it.</span><span>
</span><span id="line-174"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileSourceChunked"><span class="hs-identifier hs-type">partFileSourceChunked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span>
</span><span id="line-175"></span><span id="partFileSourceChunked"><span class="annot"><span class="annottext">partFileSourceChunked :: Text -&gt; String -&gt; Part
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileSourceChunked"><span class="hs-identifier hs-var hs-var">partFileSourceChunked</span></a></span></span><span> </span><span id="local-6989586621679109526"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109526"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109527"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109527"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; RequestBody -&gt; Part
forall (m :: * -&gt; *).
Applicative m =&gt;
Text -&gt; String -&gt; RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBody"><span class="hs-identifier hs-var">partFileRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109526"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109527"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; Part) -&gt; RequestBody -&gt; Part
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">GivesPopper () -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyStreamChunked"><span class="hs-identifier hs-var">RequestBodyStreamChunked</span></a></span><span> </span><span class="annot"><span class="annottext">(GivesPopper () -&gt; RequestBody) -&gt; GivesPopper () -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; GivesPopper ()
</span><a href="Network.HTTP.Client.MultipartFormData.html#streamFile"><span class="hs-identifier hs-var">streamFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109527"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Construct a 'Part' from form name, filepath and a 'RequestBody'</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt; partFileRequestBody &quot;who_calls&quot; &quot;caller.json&quot; $ RequestBodyBS &quot;{\&quot;caller\&quot;:\&quot;Jason J Jason\&quot;}&quot;</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt; -- empty upload form</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt; partFileRequestBody &quot;file&quot; mempty mempty</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- The 'Part' does not have a content type associated with it.</span><span>
</span><span id="line-187"></span><span id="local-6989586621679109320"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBody"><span class="hs-identifier hs-type">partFileRequestBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679109320"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-188"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-189"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ File name to supply to the server.</span></span><span>
</span><span id="line-190"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Data to upload.</span></span><span>
</span><span id="line-191"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109320"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-192"></span><span id="partFileRequestBody"><span class="annot"><span class="annottext">partFileRequestBody :: forall (m :: * -&gt; *).
Applicative m =&gt;
Text -&gt; String -&gt; RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBody"><span class="hs-identifier hs-var hs-var">partFileRequestBody</span></a></span></span><span> </span><span id="local-6989586621679109531"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109531"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109532"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109532"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679109533"><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679109533"><span class="hs-identifier hs-var">rqb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; m RequestBody -&gt; PartM m
forall (m :: * -&gt; *). Text -&gt; String -&gt; m RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier hs-var">partFileRequestBodyM</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109531"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109532"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(m RequestBody -&gt; PartM m) -&gt; m RequestBody -&gt; PartM m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; m RequestBody
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679109533"><span class="hs-identifier hs-var">rqb</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Construct a 'Part' from action returning the 'RequestBody'</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- &gt; partFileRequestBodyM &quot;cat_photo&quot; &quot;haskell-the-cat.jpg&quot; $ do</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- &gt;     size &lt;- fromInteger &lt;$&gt; withBinaryFile &quot;haskell-the-cat.jpg&quot; ReadMode hFileSize</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- &gt;     return $ RequestBodySource size $ CB.sourceFile &quot;haskell-the-cat.jpg&quot; $= CL.map fromByteString</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- The 'Part' does not have a content type associated with it.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679109306"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier hs-type">partFileRequestBodyM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Name of the corresponding \&lt;input\&gt;.</span></span><span>
</span><span id="line-203"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ File name to supply to the server.</span></span><span>
</span><span id="line-204"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Action that will supply data to upload.</span></span><span>
</span><span id="line-205"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109306"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-206"></span><span id="partFileRequestBodyM"><span class="annot"><span class="annottext">partFileRequestBodyM :: forall (m :: * -&gt; *). Text -&gt; String -&gt; m RequestBody -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#partFileRequestBodyM"><span class="hs-identifier hs-var hs-var">partFileRequestBodyM</span></a></span></span><span> </span><span id="local-6989586621679109535"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109535"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679109536"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109536"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679109537"><span class="annot"><span class="annottext">m RequestBody
</span><a href="#local-6989586621679109537"><span class="hs-identifier hs-var">rqb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
forall (m :: * -&gt; *).
Text
-&gt; Maybe String
-&gt; Maybe MimeType
-&gt; [Header]
-&gt; m RequestBody
-&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-var">Part</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109535"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109536"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeType -&gt; Maybe MimeType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MimeType -&gt; Maybe MimeType) -&gt; MimeType -&gt; Maybe MimeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; MimeType
</span><span class="hs-identifier hs-var">defaultMimeLookup</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; MimeType) -&gt; Text -&gt; MimeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109536"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Header]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">m RequestBody
</span><a href="#local-6989586621679109537"><span class="hs-identifier hs-var">rqb</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-pragma hs-type">cp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-type">cp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span><span>
</span><span id="line-211"></span><span id="cp"><span class="annot"><span class="annottext">cp :: MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var hs-var">cp</span></a></span></span><span> </span><span id="local-6989586621679109541"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109541"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Builder -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyBuilder"><span class="hs-identifier hs-var">RequestBodyBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; Int -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; Int
</span><span class="hs-identifier hs-var">BS.length</span></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109541"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; RequestBody) -&gt; Builder -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; Builder
</span><span class="hs-identifier hs-var">copyByteString</span></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109541"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | Add a list of additional headers to this 'Part'.</span></span><span>
</span><span id="line-214"></span><span id="local-6989586621679109327"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#addPartHeaders"><span class="hs-identifier hs-type">addPartHeaders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109327"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109327"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-215"></span><span id="addPartHeaders"><span class="annot"><span class="annottext">addPartHeaders :: forall (m :: * -&gt; *). PartM m -&gt; [Header] -&gt; PartM m
</span><a href="Network.HTTP.Client.MultipartFormData.html#addPartHeaders"><span class="hs-identifier hs-var hs-var">addPartHeaders</span></a></span></span><span> </span><span id="local-6989586621679109546"><span class="annot"><span class="annottext">PartM m
</span><a href="#local-6989586621679109546"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679109547"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679109547"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PartM m
</span><a href="#local-6989586621679109546"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partHeaders"><span class="hs-identifier hs-var">partHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#partHeaders"><span class="hs-identifier hs-var">partHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109546"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679109547"><span class="hs-identifier hs-type">hs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679109330"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#renderPart"><span class="hs-identifier hs-type">renderPart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679109330"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-218"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Boundary between parts.</span></span><span>
</span><span id="line-219"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109330"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109330"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span></span><span>
</span><span id="line-220"></span><span id="renderPart"><span class="annot"><span class="annottext">renderPart :: forall (m :: * -&gt; *).
Functor m =&gt;
MimeType -&gt; PartM m -&gt; m RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#renderPart"><span class="hs-identifier hs-var hs-var">renderPart</span></a></span></span><span> </span><span id="local-6989586621679109550"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109550"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span> </span><span id="local-6989586621679109551"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109551"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679109552"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679109552"><span class="hs-identifier hs-var">mfilename</span></a></span></span><span> </span><span id="local-6989586621679109553"><span class="annot"><span class="annottext">Maybe MimeType
</span><a href="#local-6989586621679109553"><span class="hs-identifier hs-var">mcontenttype</span></a></span></span><span> </span><span id="local-6989586621679109554"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679109554"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span> </span><span id="local-6989586621679109555"><span class="annot"><span class="annottext">m RequestBody
</span><a href="#local-6989586621679109555"><span class="hs-identifier hs-var">get</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody
</span><a href="#local-6989586621679109556"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; RequestBody) -&gt; m RequestBody -&gt; m RequestBody
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m RequestBody
</span><a href="#local-6989586621679109555"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679109556"><span class="annot"><span class="annottext">render :: RequestBody -&gt; RequestBody
</span><a href="#local-6989586621679109556"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679109594"><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679109594"><span class="hs-identifier hs-var">renderBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>            </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109550"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-223"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;Content-Disposition: form-data; name=\&quot;&quot;</span></span><span>
</span><span id="line-224"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyBS"><span class="hs-identifier hs-var">RequestBodyBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; MimeType
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679109551"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679109552"><span class="hs-identifier hs-var">mfilename</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679109596"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109596"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\&quot;; filename=\&quot;&quot;</span></span><span>
</span><span id="line-227"></span><span>                        </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.Types.html#RequestBodyBS"><span class="hs-identifier hs-var">RequestBodyBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; MimeType
</span><span class="hs-identifier hs-var">TE.encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; MimeType) -&gt; Text -&gt; MimeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeFileName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679109596"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                 </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestBody
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-230"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MimeType
</span><a href="#local-6989586621679109553"><span class="hs-identifier hs-var">mcontenttype</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679109598"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109598"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-232"></span><span>                        </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;Content-Type: &quot;</span></span><span>
</span><span id="line-233"></span><span>                        </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109598"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-234"></span><span>                </span><span class="annot"><span class="annottext">Maybe MimeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RequestBody
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Header -&gt; RequestBody) -&gt; [Header] -&gt; RequestBody
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">Data.Foldable.foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679109599"><span class="annot"><span class="annottext">CI MimeType
</span><a href="#local-6989586621679109599"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679109600"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109600"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>               </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-237"></span><span>            </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CI MimeType -&gt; MimeType
forall s. CI s -&gt; s
</span><span class="hs-identifier hs-var">CI.original</span></span><span> </span><span class="annot"><span class="annottext">CI MimeType
</span><a href="#local-6989586621679109599"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>            </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-239"></span><span>            </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109600"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679109554"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-240"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\r\n\r\n&quot;</span></span><span>
</span><span id="line-241"></span><span>         </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679109594"><span class="hs-identifier hs-var">renderBody</span></a></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;\r\n&quot;</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | Combine the 'Part's to form multipart/form-data body</span></span><span>
</span><span id="line-244"></span><span id="local-6989586621679109339"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#renderParts"><span class="hs-identifier hs-type">renderParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679109339"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Boundary between parts.</span></span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109339"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109339"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span></span><span>
</span><span id="line-247"></span><span id="renderParts"><span class="annot"><span class="annottext">renderParts :: forall (m :: * -&gt; *).
Applicative m =&gt;
MimeType -&gt; [PartM m] -&gt; m RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#renderParts"><span class="hs-identifier hs-var hs-var">renderParts</span></a></span></span><span> </span><span id="local-6989586621679109611"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109611"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span id="local-6989586621679109612"><span class="annot"><span class="annottext">[PartM m]
</span><a href="#local-6989586621679109612"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody
</span><a href="#local-6989586621679109613"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; RequestBody)
-&gt; ([RequestBody] -&gt; RequestBody) -&gt; [RequestBody] -&gt; RequestBody
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[RequestBody] -&gt; RequestBody
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([RequestBody] -&gt; RequestBody) -&gt; m [RequestBody] -&gt; m RequestBody
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(PartM m -&gt; m RequestBody) -&gt; [PartM m] -&gt; m [RequestBody]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeType -&gt; PartM m -&gt; m RequestBody
forall (m :: * -&gt; *).
Functor m =&gt;
MimeType -&gt; PartM m -&gt; m RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#renderPart"><span class="hs-identifier hs-var">renderPart</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109611"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PartM m]
</span><a href="#local-6989586621679109612"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679109613"><span class="annot"><span class="annottext">fin :: RequestBody -&gt; RequestBody
</span><a href="#local-6989586621679109613"><span class="hs-identifier hs-var hs-var">fin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109611"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; RequestBody -&gt; RequestBody
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#cp"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;--\r\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">-- | Generate a boundary simillar to those generated by WebKit-based browsers.</span></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundary"><span class="hs-identifier hs-type">webkitBoundary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-252"></span><span id="webkitBoundary"><span class="annot"><span class="annottext">webkitBoundary :: IO MimeType
</span><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundary"><span class="hs-identifier hs-var hs-var">webkitBoundary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; (MimeType, StdGen)) -&gt; IO MimeType
forall (m :: * -&gt; *) a. MonadIO m =&gt; (StdGen -&gt; (a, StdGen)) -&gt; m a
</span><span class="hs-identifier hs-var">getStdRandom</span></span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (MimeType, StdGen)
forall g. RandomGen g =&gt; g -&gt; (MimeType, g)
</span><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundaryPure"><span class="hs-identifier hs-var">webkitBoundaryPure</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679109347"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundaryPure"><span class="hs-identifier hs-type">webkitBoundaryPure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RandomGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679109347"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109347"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679109347"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-255"></span><span id="webkitBoundaryPure"><span class="annot"><span class="annottext">webkitBoundaryPure :: forall g. RandomGen g =&gt; g -&gt; (MimeType, g)
</span><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundaryPure"><span class="hs-identifier hs-var hs-var">webkitBoundaryPure</span></a></span></span><span> </span><span id="local-6989586621679109729"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679109729"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State g MimeType -&gt; g -&gt; (MimeType, g)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-operator hs-var">`runState`</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679109729"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(State g MimeType -&gt; (MimeType, g))
-&gt; State g MimeType -&gt; (MimeType, g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">([[Word8]] -&gt; MimeType)
-&gt; StateT g Identity [[Word8]] -&gt; State g MimeType
forall a b. (a -&gt; b) -&gt; StateT g Identity a -&gt; StateT g Identity b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MimeType -&gt; MimeType -&gt; MimeType
</span><span class="hs-identifier hs-var">BS.append</span></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109731"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">(MimeType -&gt; MimeType)
-&gt; ([[Word8]] -&gt; MimeType) -&gt; [[Word8]] -&gt; MimeType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; MimeType
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; MimeType)
-&gt; ([[Word8]] -&gt; [Word8]) -&gt; [[Word8]] -&gt; MimeType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Word8]] -&gt; [Word8]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Prelude.concat</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT g Identity [[Word8]] -&gt; State g MimeType)
-&gt; StateT g Identity [[Word8]] -&gt; State g MimeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; StateT g Identity [Word8] -&gt; StateT g Identity [[Word8]]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(StateT g Identity [Word8] -&gt; StateT g Identity [[Word8]])
-&gt; StateT g Identity [Word8] -&gt; StateT g Identity [[Word8]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>        </span><span id="local-6989586621679109735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109735"><span class="hs-identifier hs-var">randomness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(g -&gt; (Int, g)) -&gt; StateT g Identity Int
forall (m :: * -&gt; *) s a. Monad m =&gt; (s -&gt; (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">((g -&gt; (Int, g)) -&gt; StateT g Identity Int)
-&gt; (g -&gt; (Int, g)) -&gt; StateT g Identity Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">g -&gt; (Int, g)
forall g. RandomGen g =&gt; g -&gt; (Int, g)
forall a g. (Random a, RandomGen g) =&gt; g -&gt; (a, g)
</span><span class="hs-identifier hs-var">random</span></span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="annottext">[Word8] -&gt; StateT g Identity [Word8]
forall a. a -&gt; StateT g Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UArray Int Word8 -&gt; Int -&gt; Word8
forall i. Ix i =&gt; UArray i Word8 -&gt; Int -&gt; Word8
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">unsafeAt</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word8
</span><a href="#local-6989586621679109738"><span class="hs-identifier hs-var">alphaNumericEncodingMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109735"><span class="hs-identifier hs-var">randomness</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x3F</span></span><span>
</span><span id="line-259"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">UArray Int Word8 -&gt; Int -&gt; Word8
forall i. Ix i =&gt; UArray i Word8 -&gt; Int -&gt; Word8
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">unsafeAt</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word8
</span><a href="#local-6989586621679109738"><span class="hs-identifier hs-var">alphaNumericEncodingMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109735"><span class="hs-identifier hs-var">randomness</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x3F</span></span><span>
</span><span id="line-260"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">UArray Int Word8 -&gt; Int -&gt; Word8
forall i. Ix i =&gt; UArray i Word8 -&gt; Int -&gt; Word8
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">unsafeAt</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word8
</span><a href="#local-6989586621679109738"><span class="hs-identifier hs-var">alphaNumericEncodingMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109735"><span class="hs-identifier hs-var">randomness</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x3F</span></span><span>
</span><span id="line-261"></span><span>               </span><span class="hs-special">,</span><span class="annot"><span class="annottext">UArray Int Word8 -&gt; Int -&gt; Word8
forall i. Ix i =&gt; UArray i Word8 -&gt; Int -&gt; Word8
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; Int -&gt; e
</span><span class="hs-identifier hs-var">unsafeAt</span></span><span> </span><span class="annot"><span class="annottext">UArray Int Word8
</span><a href="#local-6989586621679109738"><span class="hs-identifier hs-var">alphaNumericEncodingMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679109735"><span class="hs-identifier hs-var">randomness</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x3F</span></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679109731"><span class="annot"><span class="annottext">prefix :: MimeType
</span><a href="#local-6989586621679109731"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-string">&quot;----WebKitFormBoundary&quot;</span></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="#local-6989586621679109738"><span class="hs-identifier hs-type">alphaNumericEncodingMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UArray</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679109738"><span class="annot"><span class="annottext">alphaNumericEncodingMap :: UArray Int Word8
</span><a href="#local-6989586621679109738"><span class="hs-identifier hs-var hs-var">alphaNumericEncodingMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [Word8] -&gt; UArray Int Word8
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
(i, i) -&gt; [e] -&gt; a i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">63</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x41</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x42</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x43</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x44</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x45</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x46</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x47</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x48</span></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x49</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4A</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4B</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4C</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4D</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4E</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x4F</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x50</span></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x51</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x52</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x53</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x54</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x55</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x56</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x57</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x58</span></span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x59</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x5A</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x61</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x62</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x63</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x65</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x66</span></span><span class="hs-special">,</span><span>
</span><span id="line-270"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x67</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x68</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x69</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6A</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6B</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6C</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6D</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6E</span></span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x6F</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x70</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x71</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x72</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x73</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x74</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x75</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x76</span></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x77</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x78</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x79</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x7A</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x30</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x31</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x33</span></span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>         </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x34</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x35</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x36</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x37</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x38</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x39</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x41</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x42</span></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Add form data to the 'Request'.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- This sets a new 'requestBody', adds a content-type request header and changes the method to POST.</span><span>
</span><span id="line-278"></span><span id="local-6989586621679109390"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#formDataBody"><span class="hs-identifier hs-type">formDataBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679109390"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#Part"><span class="hs-identifier hs-type">Part</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109390"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span></span><span>
</span><span id="line-279"></span><span id="formDataBody"><span class="annot"><span class="annottext">formDataBody :: forall (m :: * -&gt; *). MonadIO m =&gt; [Part] -&gt; Request -&gt; m Request
</span><a href="Network.HTTP.Client.MultipartFormData.html#formDataBody"><span class="hs-identifier hs-var hs-var">formDataBody</span></a></span></span><span> </span><span id="local-6989586621679109748"><span class="annot"><span class="annottext">[Part]
</span><a href="#local-6989586621679109748"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679109749"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679109749"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Request -&gt; m Request
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Request -&gt; m Request) -&gt; IO Request -&gt; m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679109750"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109750"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO MimeType
</span><a href="Network.HTTP.Client.MultipartFormData.html#webkitBoundary"><span class="hs-identifier hs-var">webkitBoundary</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">MimeType -&gt; [Part] -&gt; Request -&gt; IO Request
forall (m :: * -&gt; *).
Applicative m =&gt;
MimeType -&gt; [PartM m] -&gt; Request -&gt; m Request
</span><a href="Network.HTTP.Client.MultipartFormData.html#formDataBodyWithBoundary"><span class="hs-identifier hs-var">formDataBodyWithBoundary</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109750"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">[Part]
</span><a href="#local-6989586621679109748"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679109749"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><span class="hs-comment">-- | Add form data with supplied boundary</span></span><span>
</span><span id="line-284"></span><span id="local-6989586621679109393"><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#formDataBodyWithBoundary"><span class="hs-identifier hs-type">formDataBodyWithBoundary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679109393"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.HTTP.Client.MultipartFormData.html#PartM"><span class="hs-identifier hs-type">PartM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109393"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679109393"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#Request"><span class="hs-identifier hs-type">Request</span></a></span></span><span>
</span><span id="line-285"></span><span id="formDataBodyWithBoundary"><span class="annot"><span class="annottext">formDataBodyWithBoundary :: forall (m :: * -&gt; *).
Applicative m =&gt;
MimeType -&gt; [PartM m] -&gt; Request -&gt; m Request
</span><a href="Network.HTTP.Client.MultipartFormData.html#formDataBodyWithBoundary"><span class="hs-identifier hs-var hs-var">formDataBodyWithBoundary</span></a></span></span><span> </span><span id="local-6989586621679109761"><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109761"><span class="hs-identifier hs-var">boundary</span></a></span></span><span> </span><span id="local-6989586621679109762"><span class="annot"><span class="annottext">[PartM m]
</span><a href="#local-6989586621679109762"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span id="local-6989586621679109763"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679109763"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679109764"><span class="annot"><span class="annottext">RequestBody
</span><a href="#local-6989586621679109764"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679109763"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#method"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">methodPost</span></span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#requestHeaders"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">hContentType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;multipart/form-data; boundary=&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679109761"><span class="hs-identifier hs-type">boundary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prelude.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679109767"><span class="annot"><span class="annottext">CI MimeType
</span><a href="#local-6989586621679109767"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MimeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CI MimeType
</span><a href="#local-6989586621679109767"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CI MimeType -&gt; CI MimeType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CI MimeType
</span><span class="hs-identifier hs-var">hContentType</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.HTTP.Client.Types.html#requestHeaders"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679109763"><span class="hs-identifier hs-type">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.HTTP.Client.Types.html#requestBody"><span class="hs-identifier hs-var">requestBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679109764"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; Request) -&gt; m RequestBody -&gt; m Request
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MimeType -&gt; [PartM m] -&gt; m RequestBody
forall (m :: * -&gt; *).
Applicative m =&gt;
MimeType -&gt; [PartM m] -&gt; m RequestBody
</span><a href="Network.HTTP.Client.MultipartFormData.html#renderParts"><span class="hs-identifier hs-var">renderParts</span></a></span><span> </span><span class="annot"><span class="annottext">MimeType
</span><a href="#local-6989586621679109761"><span class="hs-identifier hs-var">boundary</span></a></span><span> </span><span class="annot"><span class="annottext">[PartM m]
</span><a href="#local-6989586621679109762"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-293"></span></pre></body></html>