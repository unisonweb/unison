<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP
           , NoImplicitPrelude
           , RankNTypes
           , TypeFamilies
           , FunctionalDependencies
           , FlexibleInstances
           , UndecidableInstances
           , MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span class="hs-cpp">

#if MIN_VERSION_transformers(0,4,0)
</span><span class="hs-comment">-- Hide warnings for the deprecated ErrorT transformer:</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-warnings-deprecations #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-17"></span><span class="annot"><span class="hs-comment">{- |
Copyright   :  Bas van Dijk, Anders Kaseorg
License     :  BSD3
Maintainer  :  Bas van Dijk &lt;v.dijk.bas@gmail.com&gt;

This module defines the type class 'MonadBaseControl', a subset of
'MonadBase' into which generic control operations such as @catch@ can be
lifted from @IO@ or any other base monad. Instances are based on monad
transformers in 'MonadTransControl', which includes all standard monad
transformers in the @transformers@ library except @ContT@.

See the &lt;http://hackage.haskell.org/package/lifted-base lifted-base&gt;
package which uses @monad-control@ to lift @IO@
operations from the @base@ library (like @catch@ or @bracket@) into any monad
that is an instance of @MonadBase@ or @MonadBaseControl@.

See the following tutorial by Michael Snoyman on how to use this package:

&lt;https://www.yesodweb.com/book/monad-control&gt;

=== Quick implementation guide

Given a base monad @B@ and a stack of transformers @T@:

* Define instances @'MonadTransControl' T@ for all transformers @T@, using the
  @'defaultLiftWith'@ and @'defaultRestoreT'@ functions on the constructor and
  deconstructor of @T@.

* Define an instance @'MonadBaseControl' B B@ for the base monad:

    @
    instance MonadBaseControl B B where
        type StM B a   = a
        liftBaseWith f = f 'id'
        restoreM       = 'return'
    @

* Define instances @'MonadBaseControl' B m =&gt; 'MonadBaseControl' B (T m)@ for
  all transformers:

    @
    instance MonadBaseControl b m =&gt; MonadBaseControl b (T m) where
        type StM (T m) a = 'ComposeSt' T m a
        liftBaseWith f   = 'defaultLiftBaseWith'
        restoreM         = 'defaultRestoreM'
    @
-}</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Control</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * MonadTransControl</span></span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier">MonadTransControl</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#Run"><span class="hs-identifier">Run</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Defaults</span></span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="hs-comment">-- $MonadTransControlDefaults</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault"><span class="hs-identifier">RunDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith"><span class="hs-identifier">defaultLiftWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT"><span class="hs-identifier">defaultRestoreT</span></a></span><span>
</span><span id="line-72"></span><span>      </span><span class="annot"><span class="hs-comment">-- *** Defaults for a stack of two</span></span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="hs-comment">-- $MonadTransControlDefaults2</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault2"><span class="hs-identifier">RunDefault2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith2"><span class="hs-identifier">defaultLiftWith2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT2"><span class="hs-identifier">defaultRestoreT2</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>      </span><span class="annot"><span class="hs-comment">-- * MonadBaseControl</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier">MonadBaseControl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBase"><span class="hs-identifier">RunInBase</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Defaults</span></span><span>
</span><span id="line-80"></span><span>      </span><span class="annot"><span class="hs-comment">-- $MonadBaseControlDefaults</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#ComposeSt"><span class="hs-identifier">ComposeSt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBaseDefault"><span class="hs-identifier">RunInBaseDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftBaseWith"><span class="hs-identifier">defaultLiftBaseWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreM"><span class="hs-identifier">defaultRestoreM</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#control"><span class="hs-identifier">control</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#controlT"><span class="hs-identifier">controlT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#embed"><span class="hs-identifier">embed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#embed_"><span class="hs-identifier">embed_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#captureT"><span class="hs-identifier">captureT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#captureM"><span class="hs-identifier">captureM</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp"><span class="hs-identifier">liftBaseOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp_"><span class="hs-identifier">liftBaseOp_</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseDiscard"><span class="hs-identifier">liftBaseDiscard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOpDiscard"><span class="hs-identifier">liftBaseOpDiscard</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftThrough"><span class="hs-identifier">liftThrough</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Imports</span><span>
</span><span id="line-96"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- from base:</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">($)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">const</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mempty</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Monad</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;&gt;=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">return</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Either</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">id</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.ST.Lazy.Safe</span></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST.Safe</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- from stm:</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.STM</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">STM</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- from transformers:</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadTrans</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IdentityT</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IdentityT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runIdentityT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="hs-identifier">runMaybeT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="hs-identifier">runStateT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier">runWriterT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">RWST</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RWST</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="hs-identifier">runRWST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">

#if !(MIN_VERSION_transformers(0,6,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.List</span><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ListT</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span class="hs-special">)</span><span class="hs-special">,</span><span>     </span><span class="hs-identifier">runListT</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Error</span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">ErrorT</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="hs-identifier">runErrorT</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Error</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">RWST</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RWST</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="hs-identifier">runRWST</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StateT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="hs-identifier">runStateT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runWriterT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Identity</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- from transformers-base:</span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Base</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadBase</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- MonadTransControl type class</span><span>
</span><span id="line-142"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | The @MonadTransControl@ type class is a stronger version of @'MonadTrans'@:</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- Instances of @'MonadTrans'@ know how to @'lift'@ actions in the base monad to</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- the transformed monad. These lifted actions, however, are completely unaware</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- of the monadic state added by the transformer.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- @'MonadTransControl'@ instances are aware of the monadic state of the</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- transformer and allow to save and restore this state.</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- This allows to lift functions that have a monad transformer in both positive</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- and negative position. Take, for example, the function</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- withFile :: FilePath -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-159"></span><span class="hs-comment">--</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- @'MonadTrans'@ instances can only lift the return type of the @withFile@</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- function:</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- withFileLifted :: MonadTrans t =&gt; FilePath -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; t IO r</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- withFileLifted file mode action = lift (withFile file mode action)</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- However, @'MonadTrans'@ is not powerful enough to make @withFileLifted@</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- accept a function that returns @t IO@. The reason is that we need to take</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- away the transformer layer in order to pass the function to @'withFile'@.</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- @'MonadTransControl'@ allows us to do this:</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- withFileLifted' :: (Monad (t IO), MonadTransControl t) =&gt; FilePath -&gt; IOMode -&gt; (Handle -&gt; t IO r) -&gt; t IO r</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- withFileLifted' file mode action = liftWith (\\run -&gt; withFile file mode (run . action)) &gt;&gt;= restoreT . return</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-177"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadTransControl"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-var">MonadTransControl</span></a></span></span><span> </span><span id="local-6989586621679039253"><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- | Monadic state of @t@.</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- The monadic state of a monad transformer is the result type of its @run@</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- function, e.g.:</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- 'runReaderT' :: 'ReaderT' r m a -&gt; r -&gt; m a</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- 'StT' ('ReaderT' r) a ~ a</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- 'runStateT' :: 'StateT' s m a -&gt; s -&gt; m (a, s)</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- 'StT' ('StateT' s) a ~ (a, s)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-comment">-- 'runMaybeT' :: 'MaybeT' m a -&gt; m ('Maybe' a)</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-comment">-- 'StT' 'MaybeT' a ~ 'Maybe' a</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- Provided type instances:</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- StT 'IdentityT'    a ~ a</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">-- StT 'MaybeT'       a ~ 'Maybe' a</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- StT ('ErrorT' e)   a ~ 'Error' e =&gt; 'Either' e a</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- StT ('ExceptT' e)  a ~ 'Either' e a</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- StT 'ListT'        a ~ [a]</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- StT ('ReaderT' r)  a ~ a</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">-- StT ('StateT' s)   a ~ (a, s)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- StT ('WriterT' w)  a ~ 'Monoid' w =&gt; (a, w)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-comment">-- StT ('RWST' r w s) a ~ 'Monoid' w =&gt; (a, s, w)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039253"><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679039796"><span class="annot"><a href="#local-6989586621679039796"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">-- | @liftWith@ is similar to 'lift' in that it lifts a computation from</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-comment">-- the argument monad to the constructed monad.</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">-- Instances should satisfy similar laws as the 'MonadTrans' laws:</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- @liftWith (\\_ -&gt; return a) = return a@</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- @liftWith (\\_ -&gt; m &gt;&gt;= f)  =  liftWith (\\_ -&gt; m) &gt;&gt;= (\\a -&gt; liftWith (\\_ -&gt; f a))@</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">-- The difference with 'lift' is that before lifting the @m@ computation</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- @liftWith@ captures the state of @t@. It then provides the @m@</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- computation with a 'Run' function that allows running @t n@ computations in</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- @n@ (for all @n@) on the captured state, e.g.</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- withFileLifted :: (Monad (t IO), MonadTransControl t) =&gt; FilePath -&gt; IOMode -&gt; (Handle -&gt; t IO r) -&gt; t IO r</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- withFileLifted file mode action = liftWith (\\run -&gt; withFile file mode (run . action)) &gt;&gt;= restoreT . return</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- If the @Run@ function is ignored, @liftWith@ coincides with @lift@:</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- @lift f = liftWith (\\_ -&gt; f)@</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- Implementations use the @'Run'@ function associated with a transformer:</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- liftWith :: 'Monad' m =&gt; (('Monad' n =&gt; 'ReaderT' r n b -&gt; n b) -&gt; m a) -&gt; 'ReaderT' r m a</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- liftWith f = 'ReaderT' (\\r -&gt; f (\\action -&gt; 'runReaderT' action r))</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-comment">-- liftWith :: 'Monad' m =&gt; (('Monad' n =&gt; 'StateT' s n b -&gt; n (b, s)) -&gt; m a) -&gt; 'StateT' s m a</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- liftWith f = 'StateT' (\\s -&gt; 'liftM' (\\x -&gt; (x, s)) (f (\\action -&gt; 'runStateT' action s)))</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-comment">-- liftWith :: 'Monad' m =&gt; (('Monad' n =&gt; 'MaybeT' n b -&gt; n ('Maybe' b)) -&gt; m a) -&gt; 'MaybeT' m a</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- liftWith f = 'MaybeT' ('liftM' 'Just' (f 'runMaybeT'))</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-244"></span><span>  </span><span id="liftWith"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-type">liftWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039272"><span id="local-6989586621679039273"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039272"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#Run"><span class="hs-identifier hs-type">Run</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039272"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039273"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039272"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039273"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">-- | Construct a @t@ computation from the monadic state of @t@ that is</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- returned from a 'Run' function.</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-comment">-- Instances should satisfy:</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- @liftWith (\\run -&gt; run t) &gt;&gt;= restoreT . return = t@</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-comment">-- @restoreT@ is usually implemented through the constructor of the monad</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- transformer:</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- 'ReaderT'  :: (r -&gt; m a) -&gt; 'ReaderT' r m a</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- restoreT ::       m a  -&gt; 'ReaderT' r m a</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-comment">-- restoreT action = 'ReaderT' { runReaderT = 'const' action }</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- 'StateT'   :: (s -&gt; m (a, s)) -&gt; 'StateT' s m a</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-comment">-- restoreT ::       m (a, s)  -&gt; 'StateT' s m a</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-comment">-- restoreT action = 'StateT' { runStateT = 'const' action }</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- 'MaybeT'   :: m ('Maybe' a) -&gt; 'MaybeT' m a</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-comment">-- restoreT :: m ('Maybe' a) -&gt; 'MaybeT' m a</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-comment">-- restoreT action = 'MaybeT' action</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- Example type signatures:</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m a            -&gt; 'IdentityT' m a</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m ('Maybe' a)    -&gt; 'MaybeT' m a</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- restoreT :: ('Monad' m, 'Error' e)  =&gt; m ('Either' e a) -&gt; 'ErrorT' e m a</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m ('Either' e a) -&gt; 'ExceptT' e m a</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m [a]          -&gt; 'ListT' m a</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m a            -&gt; 'ReaderT' r m a</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">-- restoreT :: 'Monad' m             =&gt; m (a, s)       -&gt; 'StateT' s m a</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- restoreT :: ('Monad' m, 'Monoid' w) =&gt; m (a, w)       -&gt; 'WriterT' w m a</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">-- restoreT :: ('Monad' m, 'Monoid' w) =&gt; m (a, s, w)    -&gt; 'RWST' r w s m a</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-283"></span><span>  </span><span id="restoreT"><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-type">restoreT</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039288"><span id="local-6989586621679039289"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039288"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039288"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039289"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039253"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039288"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039289"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | A function that runs a transformed monad @t n@ on the monadic state that</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- was captured by 'liftWith'</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- A @Run t@ function yields a computation in @n@ that returns the monadic state</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- of @t@. This state can later be used to restore a @t@ computation using</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- 'restoreT'.</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Example type equalities:</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- Run 'IdentityT'    ~ forall n b. 'Monad' n             =&gt; 'IdentityT'  n b -&gt; n b</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- Run 'MaybeT'       ~ forall n b. 'Monad' n             =&gt; 'MaybeT'     n b -&gt; n ('Maybe' b)</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- Run ('ErrorT' e)   ~ forall n b. ('Monad' n, 'Error' e)  =&gt; 'ErrorT' e   n b -&gt; n ('Either' e b)</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- Run ('ExceptT' e)  ~ forall n b. 'Monad' n             =&gt; 'ExceptT' e  n b -&gt; n ('Either' e b)</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- Run 'ListT'        ~ forall n b. 'Monad' n             =&gt; 'ListT'      n b -&gt; n [b]</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- Run ('ReaderT' r)  ~ forall n b. 'Monad' n             =&gt; 'ReaderT' r  n b -&gt; n b</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- Run ('StateT' s)   ~ forall n b. 'Monad' n             =&gt; 'StateT' s   n b -&gt; n (a, s)</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- Run ('WriterT' w)  ~ forall n b. ('Monad' n, 'Monoid' w) =&gt; 'WriterT' w  n b -&gt; n (a, w)</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- Run ('RWST' r w s) ~ forall n b. ('Monad' n, 'Monoid' w) =&gt; 'RWST' r w s n b -&gt; n (a, s, w)</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- This type is usually satisfied by the @run@ function of a transformer:</span><span>
</span><span id="line-307"></span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- 'flip' 'runReaderT' :: r -&gt; Run ('ReaderT' r)</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- 'flip' 'runStateT'  :: s -&gt; Run ('StateT' s)</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- 'runMaybeT'       ::      Run 'MaybeT'</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-313"></span><span class="hs-keyword">type</span><span> </span><span id="Run"><span class="annot"><a href="Control.Monad.Trans.Control.html#Run"><span class="hs-identifier hs-var">Run</span></a></span></span><span> </span><span id="local-6989586621679039799"><span class="annot"><a href="#local-6989586621679039799"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039800"><span class="annot"><a href="#local-6989586621679039800"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679039801"><span class="annot"><a href="#local-6989586621679039801"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039800"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039799"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039800"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039801"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039800"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039799"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039801"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- Defaults for MonadTransControl</span><span>
</span><span id="line-318"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- $MonadTransControlDefaults</span><span>
</span><span id="line-321"></span><span class="hs-comment">--</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- The following functions can be used to define a 'MonadTransControl' instance</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- for a monad transformer which simply is a newtype around another monad</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- transformer which already has a @MonadTransControl@ instance. For example:</span><span>
</span><span id="line-325"></span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- {-\# LANGUAGE GeneralizedNewtypeDeriving \#-}</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- {-\# LANGUAGE UndecidableInstances \#-}</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- {-\# LANGUAGE TypeFamilies \#-}</span><span>
</span><span id="line-330"></span><span class="hs-comment">--</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- newtype CounterT m a = CounterT {unCounterT :: StateT Int m a}</span><span>
</span><span id="line-332"></span><span class="hs-comment">--   deriving (Monad, MonadTrans)</span><span>
</span><span id="line-333"></span><span class="hs-comment">--</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- instance MonadTransControl CounterT where</span><span>
</span><span id="line-335"></span><span class="hs-comment">--     type StT CounterT a = StT (StateT Int) a</span><span>
</span><span id="line-336"></span><span class="hs-comment">--     liftWith = 'defaultLiftWith' CounterT unCounterT</span><span>
</span><span id="line-337"></span><span class="hs-comment">--     restoreT = 'defaultRestoreT' CounterT</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | A function like 'Run' that runs a monad transformer @t@ which wraps the</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- monad transformer @t'@. This is used in 'defaultLiftWith'.</span><span>
</span><span id="line-342"></span><span class="hs-keyword">type</span><span> </span><span id="RunDefault"><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault"><span class="hs-identifier hs-var">RunDefault</span></a></span></span><span> </span><span id="local-6989586621679039802"><span class="annot"><a href="#local-6989586621679039802"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679039803"><span class="annot"><a href="#local-6989586621679039803"><span class="hs-identifier hs-type">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039804"><span class="annot"><a href="#local-6989586621679039804"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679039805"><span class="annot"><a href="#local-6989586621679039805"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039802"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039805"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039804"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039803"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039805"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><span class="hs-comment">-- | Default definition for the 'liftWith' method.</span></span><span>
</span><span id="line-345"></span><span id="local-6989586621679039256"><span id="local-6989586621679039257"><span id="local-6989586621679039259"><span id="local-6989586621679039263"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith"><span class="hs-identifier hs-type">defaultLiftWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039257"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039258"><span class="annot"><a href="#local-6989586621679039258"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>   </span><span class="annot"><a href="#local-6989586621679039257"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039258"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039258"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad constructor</span></span><span>
</span><span id="line-347"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039260"><span class="annot"><a href="#local-6989586621679039260"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span id="local-6989586621679039261"><span class="annot"><a href="#local-6989586621679039261"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039260"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039261"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039257"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039260"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039261"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad deconstructor</span></span><span>
</span><span id="line-348"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault"><span class="hs-identifier hs-type">RunDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039257"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039263"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039259"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039263"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-350"></span><span id="defaultLiftWith"><span class="annot"><span class="annottext">defaultLiftWith :: forall (m :: * -&gt; *) (n :: (* -&gt; *) -&gt; * -&gt; *)
       (t :: (* -&gt; *) -&gt; * -&gt; *) a.
(Monad m, MonadTransControl n) =&gt;
(forall b. n m b -&gt; t m b)
-&gt; (forall (o :: * -&gt; *) b. t o b -&gt; n o b)
-&gt; (RunDefault t n -&gt; m a)
-&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultLiftWith"><span class="hs-identifier hs-var hs-var">defaultLiftWith</span></a></span></span><span> </span><span id="local-6989586621679039810"><span class="annot"><span class="annottext">forall b. n m b -&gt; t m b
</span><a href="#local-6989586621679039810"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679039811"><span class="annot"><span class="annottext">forall (o :: * -&gt; *) b. t o b -&gt; n o b
</span><a href="#local-6989586621679039811"><span class="hs-identifier hs-var">unT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039812"><span class="annot"><span class="annottext">RunDefault t n -&gt; m a
</span><a href="#local-6989586621679039812"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">n m a -&gt; t m a
forall b. n m b -&gt; t m b
</span><a href="#local-6989586621679039810"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(n m a -&gt; t m a) -&gt; n m a -&gt; t m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Run n -&gt; m a) -&gt; n m a
forall (m :: * -&gt; *) a. Monad m =&gt; (Run n -&gt; m a) -&gt; n m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run n -&gt; m a) -&gt; n m a) -&gt; (Run n -&gt; m a) -&gt; n m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039813"><span class="annot"><span class="annottext">Run n
</span><a href="#local-6989586621679039813"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunDefault t n -&gt; m a
</span><a href="#local-6989586621679039812"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(RunDefault t n -&gt; m a) -&gt; RunDefault t n -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">n n b -&gt; n (StT n b)
Run n
</span><a href="#local-6989586621679039813"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(n n b -&gt; n (StT n b)) -&gt; (t n b -&gt; n n b) -&gt; t n b -&gt; n (StT n b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t n b -&gt; n n b
forall (o :: * -&gt; *) b. t o b -&gt; n o b
</span><a href="#local-6989586621679039811"><span class="hs-identifier hs-var">unT</span></a></span><span>
</span><span id="line-351"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith"><span class="hs-pragma hs-type">defaultLiftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">-- | Default definition for the 'restoreT' method.</span></span><span>
</span><span id="line-354"></span><span id="local-6989586621679039280"><span id="local-6989586621679039281"><span id="local-6989586621679039282"><span id="local-6989586621679039283"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT"><span class="hs-identifier hs-type">defaultRestoreT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039281"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039281"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039283"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad constructor</span></span><span>
</span><span id="line-356"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039281"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039283"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039282"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-358"></span><span id="defaultRestoreT"><span class="annot"><span class="annottext">defaultRestoreT :: forall (m :: * -&gt; *) (n :: (* -&gt; *) -&gt; * -&gt; *) a
       (t :: (* -&gt; *) -&gt; * -&gt; *).
(Monad m, MonadTransControl n) =&gt;
(n m a -&gt; t m a) -&gt; m (StT n a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultRestoreT"><span class="hs-identifier hs-var hs-var">defaultRestoreT</span></a></span></span><span> </span><span id="local-6989586621679039820"><span class="annot"><span class="annottext">n m a -&gt; t m a
</span><a href="#local-6989586621679039820"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n m a -&gt; t m a
</span><a href="#local-6989586621679039820"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(n m a -&gt; t m a) -&gt; (m (StT n a) -&gt; n m a) -&gt; m (StT n a) -&gt; t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m (StT n a) -&gt; n m a
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT n a) -&gt; n m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span>
</span><span id="line-359"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT"><span class="hs-pragma hs-type">defaultRestoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-362"></span><span class="hs-comment">--</span><span>
</span><span id="line-363"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- $MonadTransControlDefaults2</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- The following functions can be used to define a 'MonadTransControl' instance</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- for a monad transformer stack of two.</span><span>
</span><span id="line-369"></span><span class="hs-comment">--</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- {-\# LANGUAGE GeneralizedNewtypeDeriving \#-}</span><span>
</span><span id="line-372"></span><span class="hs-comment">--</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- newtype CalcT m a = CalcT { unCalcT :: StateT Int (ExceptT String m) a }</span><span>
</span><span id="line-374"></span><span class="hs-comment">--   deriving (Monad, MonadTrans)</span><span>
</span><span id="line-375"></span><span class="hs-comment">--</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- instance MonadTransControl CalcT where</span><span>
</span><span id="line-377"></span><span class="hs-comment">--     type StT CalcT a = StT (ExceptT String) (StT (StateT Int) a)</span><span>
</span><span id="line-378"></span><span class="hs-comment">--     liftWith = 'defaultLiftWith2' CalcT unCalcT</span><span>
</span><span id="line-379"></span><span class="hs-comment">--     restoreT = 'defaultRestoreT2' CalcT</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | A function like 'Run' that runs a monad transformer @t@ which wraps the</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- monad transformers @n@ and @n'@. This is used in 'defaultLiftWith2'.</span><span>
</span><span id="line-384"></span><span class="hs-keyword">type</span><span> </span><span id="RunDefault2"><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault2"><span class="hs-identifier hs-var">RunDefault2</span></a></span></span><span> </span><span id="local-6989586621679039821"><span class="annot"><a href="#local-6989586621679039821"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679039822"><span class="annot"><a href="#local-6989586621679039822"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679039823"><span class="annot"><a href="#local-6989586621679039823"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039824"><span class="annot"><a href="#local-6989586621679039824"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679039825"><span class="annot"><a href="#local-6989586621679039825"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039823"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039821"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039824"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039825"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039824"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039823"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039822"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039825"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="annot"><span class="hs-comment">-- | Default definition for the 'liftWith' method.</span></span><span>
</span><span id="line-387"></span><span id="local-6989586621679039290"><span id="local-6989586621679039291"><span id="local-6989586621679039292"><span id="local-6989586621679039294"><span id="local-6989586621679039298"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith2"><span class="hs-identifier hs-type">defaultLiftWith2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039293"><span class="annot"><a href="#local-6989586621679039293"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>   </span><span class="annot"><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039293"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039293"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad constructor</span></span><span>
</span><span id="line-389"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679039295"><span class="annot"><a href="#local-6989586621679039295"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span id="local-6989586621679039296"><span class="annot"><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039295"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039295"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039296"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad deconstructor</span></span><span>
</span><span id="line-390"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunDefault2"><span class="hs-identifier hs-type">RunDefault2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039292"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039291"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039298"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039298"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-392"></span><span id="defaultLiftWith2"><span class="annot"><span class="annottext">defaultLiftWith2 :: forall (m :: * -&gt; *) (n' :: (* -&gt; *) -&gt; * -&gt; *)
       (n :: (* -&gt; *) -&gt; * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) a.
(Monad m, Monad (n' m), MonadTransControl n,
 MonadTransControl n') =&gt;
(forall b. n (n' m) b -&gt; t m b)
-&gt; (forall (o :: * -&gt; *) b. t o b -&gt; n (n' o) b)
-&gt; (RunDefault2 t n n' -&gt; m a)
-&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultLiftWith2"><span class="hs-identifier hs-var hs-var">defaultLiftWith2</span></a></span></span><span> </span><span id="local-6989586621679039834"><span class="annot"><span class="annottext">forall b. n (n' m) b -&gt; t m b
</span><a href="#local-6989586621679039834"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679039835"><span class="annot"><span class="annottext">forall (o :: * -&gt; *) b. t o b -&gt; n (n' o) b
</span><a href="#local-6989586621679039835"><span class="hs-identifier hs-var">unT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039836"><span class="annot"><span class="annottext">RunDefault2 t n n' -&gt; m a
</span><a href="#local-6989586621679039836"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">n (n' m) a -&gt; t m a
forall b. n (n' m) b -&gt; t m b
</span><a href="#local-6989586621679039834"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(n (n' m) a -&gt; t m a) -&gt; n (n' m) a -&gt; t m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Run n -&gt; n' m a) -&gt; n (n' m) a
forall (m :: * -&gt; *) a. Monad m =&gt; (Run n -&gt; m a) -&gt; n m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run n -&gt; n' m a) -&gt; n (n' m) a)
-&gt; (Run n -&gt; n' m a) -&gt; n (n' m) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039837"><span class="annot"><span class="annottext">Run n
</span><a href="#local-6989586621679039837"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Run n' -&gt; m a) -&gt; n' m a
forall (m :: * -&gt; *) a. Monad m =&gt; (Run n' -&gt; m a) -&gt; n' m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run n' -&gt; m a) -&gt; n' m a) -&gt; (Run n' -&gt; m a) -&gt; n' m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039838"><span class="annot"><span class="annottext">Run n'
</span><a href="#local-6989586621679039838"><span class="hs-identifier hs-var">run'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunDefault2 t n n' -&gt; m a
</span><a href="#local-6989586621679039836"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(RunDefault2 t n n' -&gt; m a) -&gt; RunDefault2 t n n' -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">n' m (StT n b) -&gt; m (StT n' (StT n b))
Run n'
</span><a href="#local-6989586621679039838"><span class="hs-identifier hs-var">run'</span></a></span><span> </span><span class="annot"><span class="annottext">(n' m (StT n b) -&gt; m (StT n' (StT n b)))
-&gt; (t m b -&gt; n' m (StT n b)) -&gt; t m b -&gt; m (StT n' (StT n b))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">n (n' m) b -&gt; n' m (StT n b)
Run n
</span><a href="#local-6989586621679039837"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(n (n' m) b -&gt; n' m (StT n b))
-&gt; (t m b -&gt; n (n' m) b) -&gt; t m b -&gt; n' m (StT n b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t m b -&gt; n (n' m) b
forall (o :: * -&gt; *) b. t o b -&gt; n (n' o) b
</span><a href="#local-6989586621679039835"><span class="hs-identifier hs-var">unT</span></a></span><span>
</span><span id="line-393"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftWith2"><span class="hs-pragma hs-type">defaultLiftWith2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><span class="hs-comment">-- | Default definition for the 'restoreT' method for double 'MonadTransControl'.</span></span><span>
</span><span id="line-396"></span><span id="local-6989586621679039306"><span id="local-6989586621679039307"><span id="local-6989586621679039308"><span id="local-6989586621679039309"><span id="local-6989586621679039310"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT2"><span class="hs-identifier hs-type">defaultRestoreT2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039307"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039307"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039307"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039310"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Monad constructor</span></span><span>
</span><span id="line-398"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039307"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039308"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039310"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039309"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-400"></span><span id="defaultRestoreT2"><span class="annot"><span class="annottext">defaultRestoreT2 :: forall (m :: * -&gt; *) (n' :: (* -&gt; *) -&gt; * -&gt; *)
       (n :: (* -&gt; *) -&gt; * -&gt; *) a (t :: (* -&gt; *) -&gt; * -&gt; *).
(Monad m, Monad (n' m), MonadTransControl n,
 MonadTransControl n') =&gt;
(n (n' m) a -&gt; t m a) -&gt; m (StT n' (StT n a)) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultRestoreT2"><span class="hs-identifier hs-var hs-var">defaultRestoreT2</span></a></span></span><span> </span><span id="local-6989586621679039851"><span class="annot"><span class="annottext">n (n' m) a -&gt; t m a
</span><a href="#local-6989586621679039851"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">n (n' m) a -&gt; t m a
</span><a href="#local-6989586621679039851"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(n (n' m) a -&gt; t m a)
-&gt; (m (StT n' (StT n a)) -&gt; n (n' m) a)
-&gt; m (StT n' (StT n a))
-&gt; t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">n' m (StT n a) -&gt; n (n' m) a
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT n a) -&gt; n m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span> </span><span class="annot"><span class="annottext">(n' m (StT n a) -&gt; n (n' m) a)
-&gt; (m (StT n' (StT n a)) -&gt; n' m (StT n a))
-&gt; m (StT n' (StT n a))
-&gt; n (n' m) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m (StT n' (StT n a)) -&gt; n' m (StT n a)
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT n' a) -&gt; n' m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span>
</span><span id="line-401"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreT2"><span class="hs-pragma hs-type">defaultRestoreT2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- MonadTransControl instances</span><span>
</span><span id="line-405"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039859"><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039859"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679039859"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679039861"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run IdentityT -&gt; m a) -&gt; IdentityT m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039862"><span class="annot"><span class="annottext">Run IdentityT -&gt; m a
</span><a href="#local-6989586621679039862"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; IdentityT m a
forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; IdentityT f a
</span><span class="hs-identifier hs-var">IdentityT</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; IdentityT m a) -&gt; m a -&gt; IdentityT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Run IdentityT -&gt; m a
</span><a href="#local-6989586621679039862"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run IdentityT -&gt; m a) -&gt; Run IdentityT -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IdentityT n b -&gt; n b
IdentityT n b -&gt; n (StT IdentityT b)
forall {k} (f :: k -&gt; *) (a :: k). IdentityT f a -&gt; f a
Run IdentityT
</span><span class="hs-identifier hs-var">runIdentityT</span></span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679039865"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT IdentityT a) -&gt; IdentityT m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; IdentityT m a
m (StT IdentityT a) -&gt; IdentityT m a
forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; IdentityT f a
</span><span class="hs-identifier hs-var">IdentityT</span></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039872"><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679039872"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679039877"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run MaybeT -&gt; m a) -&gt; MaybeT m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039878"><span class="annot"><span class="annottext">Run MaybeT -&gt; m a
</span><a href="#local-6989586621679039878"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; MaybeT m a
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe a) -&gt; MaybeT m a) -&gt; m (Maybe a) -&gt; MaybeT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; m a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m (Maybe a)) -&gt; m a -&gt; m (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Run MaybeT -&gt; m a
</span><a href="#local-6989586621679039878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run MaybeT -&gt; m a) -&gt; Run MaybeT -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MaybeT n b -&gt; n (Maybe b)
MaybeT n b -&gt; n (StT MaybeT b)
Run MaybeT
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">runMaybeT</span></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679039881"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a. Monad m =&gt; m (StT MaybeT a) -&gt; MaybeT m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; MaybeT m a
m (StT MaybeT a) -&gt; MaybeT m a
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">

#if !(MIN_VERSION_transformers(0,6,0))
</span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">MonadTransControl</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StT</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-identifier">liftWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">runListT</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-identifier">restoreT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ListT</span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">liftWith</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">restoreT</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Error</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">MonadTransControl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-identifier">liftWith</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">runErrorT</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-identifier">restoreT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ErrorT</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">liftWith</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">restoreT</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-437"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039347"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039347"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039888"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039347"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039888"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679039347"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039888"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679039893"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (ExceptT e) -&gt; m a) -&gt; ExceptT e m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039894"><span class="annot"><span class="annottext">Run (ExceptT e) -&gt; m a
</span><a href="#local-6989586621679039894"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either e a) -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">(m (Either e a) -&gt; ExceptT e m a)
-&gt; m (Either e a) -&gt; ExceptT e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either e a) -&gt; m a -&gt; m (Either e a)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either e a
forall a. a -&gt; Either e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m (Either e a)) -&gt; m a -&gt; m (Either e a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Run (ExceptT e) -&gt; m a
</span><a href="#local-6989586621679039894"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (ExceptT e) -&gt; m a) -&gt; Run (ExceptT e) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExceptT e n b -&gt; n (Either e b)
ExceptT e n b -&gt; n (StT (ExceptT e) b)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
Run (ExceptT e)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679039897"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (ExceptT e) a) -&gt; ExceptT e m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either e a) -&gt; ExceptT e m a
m (StT (ExceptT e) a) -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039363"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039904"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679039904"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679039906"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (ReaderT r) -&gt; m a) -&gt; ReaderT r m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039907"><span class="annot"><span class="annottext">Run (ReaderT r) -&gt; m a
</span><a href="#local-6989586621679039907"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m a) -&gt; ReaderT r m a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m a) -&gt; ReaderT r m a) -&gt; (r -&gt; m a) -&gt; ReaderT r m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039908"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679039908"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Run (ReaderT r) -&gt; m a
</span><a href="#local-6989586621679039907"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (ReaderT r) -&gt; m a) -&gt; Run (ReaderT r) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039910"><span class="annot"><span class="annottext">ReaderT r n b
</span><a href="#local-6989586621679039910"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT r n b -&gt; r -&gt; n b
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT r n b
</span><a href="#local-6989586621679039910"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679039908"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span id="local-6989586621679039912"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (ReaderT r) a) -&gt; ReaderT r m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; m a) -&gt; ReaderT r m a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; m a) -&gt; ReaderT r m a)
-&gt; (m a -&gt; r -&gt; m a) -&gt; m a -&gt; ReaderT r m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; r -&gt; m a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039380"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039380"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039919"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039380"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039919"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039919"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039380"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>    </span><span id="local-6989586621679039922"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (StateT s) -&gt; m a) -&gt; StateT s m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039923"><span class="annot"><span class="annottext">Run (StateT s) -&gt; m a
</span><a href="#local-6989586621679039923"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; StateT s m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (a, s)) -&gt; StateT s m a)
-&gt; (s -&gt; m (a, s)) -&gt; StateT s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039924"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039924"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>                   </span><span class="annot"><span class="annottext">(a -&gt; (a, s)) -&gt; m a -&gt; m (a, s)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679039925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039925"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039925"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039924"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (StateT s) -&gt; m a
</span><a href="#local-6989586621679039923"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (StateT s) -&gt; m a) -&gt; Run (StateT s) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039927"><span class="annot"><span class="annottext">StateT s n b
</span><a href="#local-6989586621679039927"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT s n b -&gt; s -&gt; n (b, s)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">StateT s n b
</span><a href="#local-6989586621679039927"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039924"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679039929"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (StateT s) a) -&gt; StateT s m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; StateT s m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (a, s)) -&gt; StateT s m a)
-&gt; (m (a, s) -&gt; s -&gt; m (a, s)) -&gt; m (a, s) -&gt; StateT s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m (a, s) -&gt; s -&gt; m (a, s)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039395"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039395"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039936"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039395"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039936"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039395"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679039939"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (StateT s) -&gt; m a) -&gt; StateT s m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039940"><span class="annot"><span class="annottext">Run (StateT s) -&gt; m a
</span><a href="#local-6989586621679039940"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; StateT s m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">Strict.StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (a, s)) -&gt; StateT s m a)
-&gt; (s -&gt; m (a, s)) -&gt; StateT s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039941"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039941"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-463"></span><span>                   </span><span class="annot"><span class="annottext">(a -&gt; (a, s)) -&gt; m a -&gt; m (a, s)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679039942"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039942"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039942"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039941"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (StateT s) -&gt; m a
</span><a href="#local-6989586621679039940"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (StateT s) -&gt; m a) -&gt; Run (StateT s) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039944"><span class="annot"><span class="annottext">StateT s n b
</span><a href="#local-6989586621679039944"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT s n b -&gt; s -&gt; n (b, s)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">Strict.runStateT</span></span><span> </span><span class="annot"><span class="annottext">StateT s n b
</span><a href="#local-6989586621679039944"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039941"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679039946"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (StateT s) a) -&gt; StateT s m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; m (a, s)) -&gt; StateT s m a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><span class="hs-identifier hs-var">Strict.StateT</span></span><span> </span><span class="annot"><span class="annottext">((s -&gt; m (a, s)) -&gt; StateT s m a)
-&gt; (m (a, s) -&gt; s -&gt; m (a, s)) -&gt; m (a, s) -&gt; StateT s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m (a, s) -&gt; s -&gt; m (a, s)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039410"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039410"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039410"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039954"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039410"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039954"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039954"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039410"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679039958"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (WriterT w) -&gt; m a) -&gt; WriterT w m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039959"><span class="annot"><span class="annottext">Run (WriterT w) -&gt; m a
</span><a href="#local-6989586621679039959"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; WriterT w m a
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="annot"><span class="annottext">(m (a, w) -&gt; WriterT w m a) -&gt; m (a, w) -&gt; WriterT w m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, w)) -&gt; m a -&gt; m (a, w)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679039960"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039960"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039960"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (WriterT w) -&gt; m a
</span><a href="#local-6989586621679039959"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (WriterT w) -&gt; m a) -&gt; Run (WriterT w) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriterT w n b -&gt; n (b, w)
WriterT w n b -&gt; n (StT (WriterT w) b)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
Run (WriterT w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679039963"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (WriterT w) a) -&gt; WriterT w m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; WriterT w m a
m (StT (WriterT w) a) -&gt; WriterT w m a
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039426"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039426"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039426"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039971"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679039426"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039971"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039971"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039426"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679039975"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (WriterT w) -&gt; m a) -&gt; WriterT w m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039976"><span class="annot"><span class="annottext">Run (WriterT w) -&gt; m a
</span><a href="#local-6989586621679039976"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; WriterT w m a
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">Strict.WriterT</span></span><span> </span><span class="annot"><span class="annottext">(m (a, w) -&gt; WriterT w m a) -&gt; m (a, w) -&gt; WriterT w m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, w)) -&gt; m a -&gt; m (a, w)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679039977"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039977"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039977"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (WriterT w) -&gt; m a
</span><a href="#local-6989586621679039976"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (WriterT w) -&gt; m a) -&gt; Run (WriterT w) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriterT w n b -&gt; n (b, w)
WriterT w n b -&gt; n (StT (WriterT w) b)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
Run (WriterT w)
</span><span class="hs-identifier hs-var">Strict.runWriterT</span></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>    </span><span id="local-6989586621679039980"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (WriterT w) a) -&gt; WriterT w m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; WriterT w m a
m (StT (WriterT w) a) -&gt; WriterT w m a
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">Strict.WriterT</span></span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039443"><span id="local-6989586621679039444"><span id="local-6989586621679039445"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039443"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679039444"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039443"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039445"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-486"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679039988"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679039444"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039443"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039445"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679039988"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039988"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039445"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039443"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679039992"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (RWST r w s) -&gt; m a) -&gt; RWST r w s m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679039993"><span class="annot"><span class="annottext">Run (RWST r w s) -&gt; m a
</span><a href="#local-6989586621679039993"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">RWST</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a)
-&gt; (r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039994"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679039994"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679039995"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039995"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, s, w)) -&gt; m a -&gt; m (a, s, w)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679039996"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039996"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679039996"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039995"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (RWST r w s) -&gt; m a
</span><a href="#local-6989586621679039993"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (RWST r w s) -&gt; m a) -&gt; Run (RWST r w s) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679039998"><span class="annot"><span class="annottext">RWST r w s n b
</span><a href="#local-6989586621679039998"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST r w s n b -&gt; r -&gt; s -&gt; n (b, s, w)
forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><span class="hs-identifier hs-var">runRWST</span></span><span> </span><span class="annot"><span class="annottext">RWST r w s n b
</span><a href="#local-6989586621679039998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679039994"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679039995"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679040000"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (RWST r w s) a) -&gt; RWST r w s m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span id="local-6989586621679040001"><span class="annot"><span class="annottext">m (StT (RWST r w s) a)
</span><a href="#local-6989586621679040001"><span class="hs-identifier hs-var">mSt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">RWST</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a)
-&gt; (r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, s, w)
m (StT (RWST r w s) a)
</span><a href="#local-6989586621679040001"><span class="hs-identifier hs-var">mSt</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679039466"><span id="local-6989586621679039467"><span id="local-6989586621679039468"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039466"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679039467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039466"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StT"><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-var">StT</span></a></span></span><span> </span><span id="local-6989586621679040009"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Strict.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679039467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039466"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679040009"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679040009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039468"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679039466"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679040013"><span class="annot"><span class="annottext">liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (RWST r w s) -&gt; m a) -&gt; RWST r w s m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftWith</span></a></span></span><span> </span><span id="local-6989586621679040014"><span class="annot"><span class="annottext">Run (RWST r w s) -&gt; m a
</span><a href="#local-6989586621679040014"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>        </span><span class="annot"><span class="annottext">(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">Strict.RWST</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a)
-&gt; (r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040015"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679040015"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679040016"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679040016"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, s, w)) -&gt; m a -&gt; m (a, s, w)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679040017"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040017"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679040017"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679040016"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Run (RWST r w s) -&gt; m a
</span><a href="#local-6989586621679040014"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Run (RWST r w s) -&gt; m a) -&gt; Run (RWST r w s) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040019"><span class="annot"><span class="annottext">RWST r w s n b
</span><a href="#local-6989586621679040019"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RWST r w s n b -&gt; r -&gt; s -&gt; n (b, s, w)
forall r w s (m :: * -&gt; *) a.
RWST r w s m a -&gt; r -&gt; s -&gt; m (a, s, w)
</span><span class="hs-identifier hs-var">Strict.runRWST</span></span><span> </span><span class="annot"><span class="annottext">RWST r w s n b
</span><a href="#local-6989586621679040019"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679040015"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679040016"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>    </span><span id="local-6989586621679040021"><span class="annot"><span class="annottext">restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (RWST r w s) a) -&gt; RWST r w s m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreT</span></a></span></span><span> </span><span id="local-6989586621679040022"><span class="annot"><span class="annottext">m (StT (RWST r w s) a)
</span><a href="#local-6989586621679040022"><span class="hs-identifier hs-var">mSt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall r w s (m :: * -&gt; *) a.
(r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
</span><span class="hs-identifier hs-var">Strict.RWST</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a)
-&gt; (r -&gt; s -&gt; m (a, s, w)) -&gt; RWST r w s m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, s, w)
m (StT (RWST r w s) a)
</span><a href="#local-6989586621679040022"><span class="hs-identifier hs-var">mSt</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-pragma hs-type">liftWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-pragma hs-type">restoreT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- MonadBaseControl type class</span><span>
</span><span id="line-505"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- == Writing instances</span><span>
</span><span id="line-509"></span><span class="hs-comment">--</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- The usual way to write a @'MonadBaseControl'@ instance for a transformer</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- stack over a base monad @B@ is to write an instance @MonadBaseControl B B@</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- for the base monad, and @MonadTransControl T@ instances for every transformer</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- @T@. Instances for @'MonadBaseControl'@ are then simply implemented using</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- @'ComposeSt'@, @'defaultLiftBaseWith'@, @'defaultRestoreM'@.</span><span>
</span><span id="line-515"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBase</span></span><span> </span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBaseControl"><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-var">MonadBaseControl</span></a></span></span><span> </span><span id="local-6989586621679039485"><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679039486"><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-comment">-- | Monadic state that @m@ adds to the base monad @b@.</span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-comment">-- For all base (non-transformed) monads, @StM m a ~ a@:</span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-comment">-- StM 'IO'         a ~ a</span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-comment">-- StM 'Maybe'      a ~ a</span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-comment">-- StM ('Either' e) a ~ a</span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-comment">-- StM []         a ~ a</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-comment">-- StM ((-&gt;) r)   a ~ a</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-comment">-- StM 'Identity'   a ~ a</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- StM 'STM'        a ~ a</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-comment">-- StM ('ST' s)     a ~ a</span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-comment">-- If @m@ is a transformed monad, @m ~ t b@, @'StM'@ is the monadic state of</span><span>
</span><span id="line-532"></span><span>    </span><span class="hs-comment">-- the transformer @t@ (given by its 'StT' from 'MonadTransControl'). For a</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-comment">-- transformer stack, @'StM'@ is defined recursively:</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-comment">-- StM ('IdentityT'  m) a ~ 'ComposeSt' 'IdentityT' m a ~ StM m a</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-comment">-- StM ('MaybeT'     m) a ~ 'ComposeSt' 'MaybeT'    m a ~ StM m ('Maybe' a)</span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-comment">-- StM ('ErrorT' e   m) a ~ 'ComposeSt' 'ErrorT'    m a ~ 'Error' e =&gt; StM m ('Either' e a)</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-comment">-- StM ('ExceptT' e  m) a ~ 'ComposeSt' 'ExceptT'   m a ~ StM m ('Either' e a)</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-comment">-- StM ('ListT'      m) a ~ 'ComposeSt' 'ListT'     m a ~ StM m [a]</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-comment">-- StM ('ReaderT' r  m) a ~ 'ComposeSt' 'ReaderT'   m a ~ StM m a</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-comment">-- StM ('StateT' s   m) a ~ 'ComposeSt' 'StateT'    m a ~ StM m (a, s)</span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-comment">-- StM ('WriterT' w  m) a ~ 'ComposeSt' 'WriterT'   m a ~ 'Monoid' w =&gt; StM m (a, w)</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-comment">-- StM ('RWST' r w s m) a ~ 'ComposeSt' 'RWST'      m a ~ 'Monoid' w =&gt; StM m (a, s, w)</span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StM"><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-var">StM</span></a></span></span><span> </span><span id="local-6989586621679039486"><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679040024"><span class="annot"><a href="#local-6989586621679040024"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-comment">-- | @liftBaseWith@ is similar to 'liftIO' and 'liftBase' in that it</span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-comment">-- lifts a base computation to the constructed monad.</span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-comment">-- Instances should satisfy similar laws as the 'MonadIO' and 'MonadBase' laws:</span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-comment">-- @liftBaseWith (\\_ -&gt; return a) = return a@</span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-comment">-- @liftBaseWith (\\_ -&gt; m &gt;&gt;= f)  =  liftBaseWith (\\_ -&gt; m) &gt;&gt;= (\\a -&gt; liftBaseWith (\\_ -&gt; f a))@</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-comment">-- As &lt;https://stackoverflow.com/a/58106822/1477667 Li-yao Xia explains&gt;, parametricity</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-comment">-- guarantees that</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-comment">-- @f &lt;$&gt; liftBaseWith q = liftBaseWith $ \runInBase -&gt; f &lt;$&gt; q runInBase@</span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-comment">-- The difference with 'liftBase' is that before lifting the base computation</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-comment">-- @liftBaseWith@ captures the state of @m@. It then provides the base</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-comment">-- computation with a 'RunInBase' function that allows running @m@</span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-comment">-- computations in the base monad on the captured state:</span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-comment">-- withFileLifted :: MonadBaseControl IO m =&gt; FilePath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-comment">-- withFileLifted file mode action = liftBaseWith (\\runInBase -&gt; withFile file mode (runInBase . action)) &gt;&gt;= restoreM</span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-comment">--                              -- = control $ \\runInBase -&gt; withFile file mode (runInBase . action)</span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-comment">--                              -- = liftBaseOp (withFile file mode) action</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-comment">-- @</span><span>
</span><span id="line-573"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-comment">-- @'liftBaseWith'@ is usually not implemented directly, but using</span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-comment">-- @'defaultLiftBaseWith'@.</span><span>
</span><span id="line-576"></span><span>    </span><span id="liftBaseWith"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-type">liftBaseWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039490"><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBase"><span class="hs-identifier hs-type">RunInBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039485"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039490"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039490"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-comment">-- | Construct a @m@ computation from the monadic state of @m@ that is</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-comment">-- returned from a 'RunInBase' function.</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-comment">-- Instances should satisfy:</span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-comment">-- @liftBaseWith (\\runInBase -&gt; runInBase m) &gt;&gt;= restoreM = m@</span><span>
</span><span id="line-584"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-comment">-- @'restoreM'@ is usually not implemented directly, but using</span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-comment">-- @'defaultRestoreM'@.</span><span>
</span><span id="line-587"></span><span>    </span><span id="restoreM"><span class="annot"><a href="Control.Monad.Trans.Control.html#restoreM"><span class="hs-identifier hs-type">restoreM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679039491"><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039491"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039486"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039491"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | A function that runs a @m@ computation on the monadic state that was</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- captured by 'liftBaseWith'</span><span>
</span><span id="line-591"></span><span class="hs-comment">--</span><span>
</span><span id="line-592"></span><span class="hs-comment">-- A @RunInBase m@ function yields a computation in the base monad of @m@ that</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- returns the monadic state of @m@. This state can later be used to restore the</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- @m@ computation using 'restoreM'.</span><span>
</span><span id="line-595"></span><span class="hs-comment">--</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- Example type equalities:</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- RunInBase ('IdentityT'  m) b ~ forall a.             'IdentityT'  m a -&gt; b ('StM' m a)</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- RunInBase ('MaybeT'     m) b ~ forall a.             'MaybeT'     m a -&gt; b ('StM' m ('Maybe' a))</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- RunInBase ('ErrorT' e   m) b ~ forall a. 'Error' e =&gt;  'ErrorT' e   m a -&gt; b ('StM' m ('Either' e a))</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- RunInBase ('ExceptT' e  m) b ~ forall a.             'ExceptT' e  m a -&gt; b ('StM' m ('Either' e a))</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- RunInBase ('ListT'      m) b ~ forall a.             'ListT'      m a -&gt; b ('StM' m [a])</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- RunInBase ('ReaderT' r  m) b ~ forall a.             'ReaderT'    m a -&gt; b ('StM' m a)</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- RunInBase ('StateT' s   m) b ~ forall a.             'StateT' s   m a -&gt; b ('StM' m (a, s))</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- RunInBase ('WriterT' w  m) b ~ forall a. 'Monoid' w =&gt; 'WriterT' w  m a -&gt; b ('StM' m (a, w))</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- RunInBase ('RWST' r w s m) b ~ forall a. 'Monoid' w =&gt; 'RWST' r w s m a -&gt; b ('StM' m (a, s, w))</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-609"></span><span class="hs-comment">--</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- For a transformed base monad @m ~ t b@, @'RunInBase m b' ~ 'Run' t@.</span><span>
</span><span id="line-611"></span><span class="hs-keyword">type</span><span> </span><span id="RunInBase"><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBase"><span class="hs-identifier hs-var">RunInBase</span></a></span></span><span> </span><span id="local-6989586621679040027"><span class="annot"><a href="#local-6989586621679040027"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679040028"><span class="annot"><a href="#local-6989586621679040028"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679040029"><span class="annot"><a href="#local-6989586621679040029"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679040027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040029"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679040028"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040027"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040029"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- MonadBaseControl instances for all monads in the base library</span><span>
</span><span id="line-616"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span class="hs-cpp">

#define BASE(M)                           \
instance MonadBaseControl (M) (M) where { \
    type StM (M) a = a;                   \
    liftBaseWith f = f id;                \
    restoreM = return;                    \
    {-# INLINABLE liftBaseWith #-};       \
    {-# INLINABLE restoreM #-}}
</span><span>
</span><span id="line-626"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-identifier">IO</span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span id="local-6989586621679039501"></span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span id="local-6989586621679039509"><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span></span><span>
</span><span id="line-631"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-identifier">Identity</span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span class="hs-identifier">STM</span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span id="local-6989586621679039524"></span><span class="hs-identifier">Strict.ST</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span class="hs-identifier">BASE</span><span class="hs-special">(</span><span id="local-6989586621679039531"></span><span>       </span><span class="hs-identifier">ST</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span class="hs-cpp">

#undef BASE
</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- Defaults for MonadBaseControl</span><span>
</span><span id="line-643"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- $MonadBaseControlDefaults</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- Note that by using the following default definitions it's easy to make a</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- monad transformer @T@ an instance of 'MonadBaseControl':</span><span>
</span><span id="line-649"></span><span class="hs-comment">--</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- instance MonadBaseControl b m =&gt; MonadBaseControl b (T m) where</span><span>
</span><span id="line-652"></span><span class="hs-comment">--     type StM (T m) a = 'ComposeSt' T m a</span><span>
</span><span id="line-653"></span><span class="hs-comment">--     liftBaseWith     = 'defaultLiftBaseWith'</span><span>
</span><span id="line-654"></span><span class="hs-comment">--     restoreM         = 'defaultRestoreM'</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-656"></span><span class="hs-comment">--</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- Defining an instance for a base monad @B@ is equally straightforward:</span><span>
</span><span id="line-658"></span><span class="hs-comment">--</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- instance MonadBaseControl B B where</span><span>
</span><span id="line-661"></span><span class="hs-comment">--     type StM B a   = a</span><span>
</span><span id="line-662"></span><span class="hs-comment">--     liftBaseWith f = f 'id'</span><span>
</span><span id="line-663"></span><span class="hs-comment">--     restoreM       = 'return'</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Handy type synonym that composes the monadic states of @t@ and @m@.</span><span>
</span><span id="line-667"></span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- It can be used to define the 'StM' for new 'MonadBaseControl' instances.</span><span>
</span><span id="line-669"></span><span class="hs-keyword">type</span><span> </span><span id="ComposeSt"><span class="annot"><a href="Control.Monad.Trans.Control.html#ComposeSt"><span class="hs-identifier hs-var">ComposeSt</span></a></span></span><span> </span><span id="local-6989586621679040137"><span class="annot"><a href="#local-6989586621679040137"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679040138"><span class="annot"><a href="#local-6989586621679040138"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679040139"><span class="annot"><a href="#local-6989586621679040139"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040137"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040139"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-comment">-- | A function like 'RunInBase' that runs a monad transformer @t@ in its base</span><span>
</span><span id="line-672"></span><span class="hs-comment">-- monad @b@. It is used in 'defaultLiftBaseWith'.</span><span>
</span><span id="line-673"></span><span class="hs-keyword">type</span><span> </span><span id="RunInBaseDefault"><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBaseDefault"><span class="hs-identifier hs-var">RunInBaseDefault</span></a></span></span><span> </span><span id="local-6989586621679040140"><span class="annot"><a href="#local-6989586621679040140"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679040141"><span class="annot"><a href="#local-6989586621679040141"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679040142"><span class="annot"><a href="#local-6989586621679040142"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679040143"><span class="annot"><a href="#local-6989586621679040143"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679040140"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679040142"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#ComposeSt"><span class="hs-identifier hs-type">ComposeSt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040140"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679040143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="hs-comment">-- | Default definition for the 'liftBaseWith' method.</span><span>
</span><span id="line-676"></span><span class="hs-comment">--</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- Note that it composes a 'liftWith' of @t@ with a 'liftBaseWith' of @m@ to</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- give a 'liftBaseWith' of @t m@:</span><span>
</span><span id="line-679"></span><span class="hs-comment">--</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- defaultLiftBaseWith = \\f -&gt; 'liftWith' $ \\run -&gt;</span><span>
</span><span id="line-682"></span><span class="hs-comment">--                               'liftBaseWith' $ \\runInBase -&gt;</span><span>
</span><span id="line-683"></span><span class="hs-comment">--                                 f $ runInBase . run</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-685"></span><span id="local-6989586621679039536"><span id="local-6989586621679039537"><span id="local-6989586621679039538"><span id="local-6989586621679039540"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftBaseWith"><span class="hs-identifier hs-type">defaultLiftBaseWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039536"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039537"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039538"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBaseDefault"><span class="hs-identifier hs-type">RunInBaseDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039536"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039538"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039537"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039537"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039540"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039536"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039538"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039540"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-687"></span><span id="defaultLiftBaseWith"><span class="annot"><span class="annottext">defaultLiftBaseWith :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (b :: * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, MonadBaseControl b m) =&gt;
(RunInBaseDefault t m b -&gt; b a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultLiftBaseWith"><span class="hs-identifier hs-var hs-var">defaultLiftBaseWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040152"><span class="annot"><span class="annottext">RunInBaseDefault t m b -&gt; b a
</span><a href="#local-6989586621679040152"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Run t -&gt; m a) -&gt; t m a
forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run t -&gt; m a) -&gt; t m a) -&gt; (Run t -&gt; m a) -&gt; t m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040153"><span class="annot"><span class="annottext">Run t
</span><a href="#local-6989586621679040153"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-688"></span><span>                              </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b a) -&gt; m a
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b a) -&gt; m a) -&gt; (RunInBase m b -&gt; b a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040154"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040154"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>                                </span><span class="annot"><span class="annottext">RunInBaseDefault t m b -&gt; b a
</span><a href="#local-6989586621679040152"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(RunInBaseDefault t m b -&gt; b a) -&gt; RunInBaseDefault t m b -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; b (StM m (StT t a))
RunInBase m b
</span><a href="#local-6989586621679040154"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; b (StM m (StT t a)))
-&gt; (t m a -&gt; m (StT t a)) -&gt; t m a -&gt; b (StM m (StT t a))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t m a -&gt; m (StT t a)
Run t
</span><a href="#local-6989586621679040153"><span class="hs-identifier hs-var">run</span></a></span><span>
</span><span id="line-690"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultLiftBaseWith"><span class="hs-pragma hs-type">defaultLiftBaseWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-comment">-- | Default definition for the 'restoreM' method.</span><span>
</span><span id="line-693"></span><span class="hs-comment">--</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- Note that: @defaultRestoreM = 'restoreT' . 'restoreM'@</span><span>
</span><span id="line-695"></span><span id="local-6989586621679039548"><span id="local-6989586621679039549"><span id="local-6989586621679039550"><span id="local-6989586621679039551"><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreM"><span class="hs-identifier hs-type">defaultRestoreM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039549"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039550"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#ComposeSt"><span class="hs-identifier hs-type">ComposeSt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039550"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039548"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039550"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039551"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-697"></span><span id="defaultRestoreM"><span class="annot"><span class="annottext">defaultRestoreM :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (b :: * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, MonadBaseControl b m) =&gt;
ComposeSt t m a -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#defaultRestoreM"><span class="hs-identifier hs-var hs-var">defaultRestoreM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT t a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; t m a)
-&gt; (StM m (StT t a) -&gt; m (StT t a)) -&gt; StM m (StT t a) -&gt; t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StM m (StT t a) -&gt; m (StT t a)
forall a. StM m a -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
StM m a -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#restoreM"><span class="hs-identifier hs-var">restoreM</span></a></span><span>
</span><span id="line-698"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#defaultRestoreM"><span class="hs-pragma hs-type">defaultRestoreM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- MonadBaseControl transformer instances</span><span>
</span><span id="line-703"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span class="hs-cpp">

#define BODY(T) {                         \
    type StM (T m) a = ComposeSt (T) m a; \
    liftBaseWith = defaultLiftBaseWith;   \
    restoreM     = defaultRestoreM;       \
    {-# INLINABLE liftBaseWith #-};       \
    {-# INLINABLE restoreM #-}}
</span><span class="hs-cpp">
#define TRANS(         T) \
  instance (     MonadBaseControl b m) =&gt; MonadBaseControl b (T m) where BODY(T)
</span><span class="hs-cpp">#define TRANS_CTX(CTX, T) \
  instance (CTX, MonadBaseControl b m) =&gt; MonadBaseControl b (T m) where BODY(T)
</span><span>
</span><span id="line-717"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039561"><span id="local-6989586621679039562"></span></span><span class="hs-identifier">IdentityT</span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039569"><span id="local-6989586621679039570"></span></span><span class="hs-identifier">MaybeT</span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039579"><span id="local-6989586621679039580"><span id="local-6989586621679039581"></span></span></span><span class="hs-identifier">ReaderT</span><span> </span><span class="hs-identifier">r</span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039590"><span id="local-6989586621679039591"><span id="local-6989586621679039592"></span></span></span><span class="hs-identifier">Strict.StateT</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039601"><span id="local-6989586621679039602"><span id="local-6989586621679039603"></span></span></span><span>       </span><span class="hs-identifier">StateT</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span id="local-6989586621679039612"><span id="local-6989586621679039613"><span id="local-6989586621679039614"></span></span></span><span class="hs-identifier">ExceptT</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="hs-identifier">TRANS_CTX</span><span id="local-6989586621679039623"><span id="local-6989586621679039624"><span id="local-6989586621679039625"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039623"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Strict.WriterT</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-725"></span><span class="hs-identifier">TRANS_CTX</span><span id="local-6989586621679039634"><span id="local-6989586621679039635"><span id="local-6989586621679039636"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039634"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">WriterT</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-726"></span><span class="hs-identifier">TRANS_CTX</span><span id="local-6989586621679039649"><span id="local-6989586621679039650"><span id="local-6989586621679039651"><span id="local-6989586621679039652"><span id="local-6989586621679039653"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039649"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Strict.RWST</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span class="annot"><a href="#local-6989586621679039650"><span class="hs-special hs-type">)</span></a></span></span></span></span></span></span><span>
</span><span id="line-727"></span><span class="hs-identifier">TRANS_CTX</span><span id="local-6989586621679039666"><span id="local-6989586621679039667"><span id="local-6989586621679039668"><span id="local-6989586621679039669"><span id="local-6989586621679039670"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679039666"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span>        </span><span class="hs-identifier">RWST</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span></span></span></span></span></span><span class="hs-cpp">

#if !(MIN_VERSION_transformers(0,6,0))
</span><span class="hs-identifier">TRANS</span><span class="hs-special">(</span><span class="hs-identifier">ListT</span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span class="hs-identifier">TRANS_CTX</span><span class="hs-special">(</span><span class="hs-identifier">Error</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">,</span><span>         </span><span class="hs-identifier">ErrorT</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#undef BODY
</span><span class="hs-cpp">#undef TRANS
</span><span class="hs-cpp">#undef TRANS_CTX
</span><span>
</span><span id="line-738"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-739"></span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-740"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="hs-comment">-- | An often used composition: @control f = 'liftBaseWith' f &gt;&gt;= 'restoreM'@</span><span>
</span><span id="line-743"></span><span class="hs-comment">--</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-745"></span><span class="hs-comment">--</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- liftedBracket :: MonadBaseControl IO m =&gt; m a -&gt; (a -&gt; m b) -&gt; (a -&gt; m c) -&gt; m c</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- liftedBracket acquire release action = control $ \\runInBase -&gt;</span><span>
</span><span id="line-749"></span><span class="hs-comment">--     bracket (runInBase acquire)</span><span>
</span><span id="line-750"></span><span class="hs-comment">--             (\\saved -&gt; runInBase (restoreM saved &gt;&gt;= release))</span><span>
</span><span id="line-751"></span><span class="hs-comment">--             (\\saved -&gt; runInBase (restoreM saved &gt;&gt;= action))</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-753"></span><span id="local-6989586621679039673"><span id="local-6989586621679039674"><span id="local-6989586621679039675"><span class="annot"><a href="Control.Monad.Trans.Control.html#control"><span class="hs-identifier hs-type">control</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#RunInBase"><span class="hs-identifier hs-type">RunInBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039673"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039675"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039675"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-754"></span><span id="control"><span class="annot"><span class="annottext">control :: forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b (StM m a)) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#control"><span class="hs-identifier hs-var hs-var">control</span></a></span></span><span> </span><span id="local-6989586621679040323"><span class="annot"><span class="annottext">RunInBase m b -&gt; b (StM m a)
</span><a href="#local-6989586621679040323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (StM m a)) -&gt; m (StM m a)
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">RunInBase m b -&gt; b (StM m a)
</span><a href="#local-6989586621679040323"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m (StM m a) -&gt; (StM m a -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">StM m a -&gt; m a
forall a. StM m a -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
StM m a -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#restoreM"><span class="hs-identifier hs-var">restoreM</span></a></span><span>
</span><span id="line-755"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#control"><span class="hs-pragma hs-type">control</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="hs-comment">-- | Lift a computation and restore the monadic state immediately:</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- @controlT f = 'liftWith' f &gt;&gt;= 'restoreT' . return@.</span><span>
</span><span id="line-759"></span><span id="local-6989586621679039681"><span id="local-6989586621679039682"><span id="local-6989586621679039683"><span class="annot"><a href="Control.Monad.Trans.Control.html#controlT"><span class="hs-identifier hs-type">controlT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039681"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039681"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039682"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039682"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#Run"><span class="hs-identifier hs-type">Run</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039681"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039682"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039681"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039683"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039681"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039682"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039683"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-761"></span><span id="controlT"><span class="annot"><span class="annottext">controlT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad (t m), Monad m) =&gt;
(Run t -&gt; m (StT t a)) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#controlT"><span class="hs-identifier hs-var hs-var">controlT</span></a></span></span><span> </span><span id="local-6989586621679040333"><span class="annot"><span class="annottext">Run t -&gt; m (StT t a)
</span><a href="#local-6989586621679040333"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Run t -&gt; m (StT t a)) -&gt; t m (StT t a)
forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">Run t -&gt; m (StT t a)
</span><a href="#local-6989586621679040333"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t m (StT t a) -&gt; (StT t a -&gt; t m a) -&gt; t m a
forall a b. t m a -&gt; (a -&gt; t m b) -&gt; t m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT t a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; t m a)
-&gt; (StT t a -&gt; m (StT t a)) -&gt; StT t a -&gt; t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StT t a -&gt; m (StT t a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-762"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#controlT"><span class="hs-pragma hs-type">controlT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">-- | Embed a transformer function as an function in the base monad returning a</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- mutated transformer state.</span><span>
</span><span id="line-766"></span><span id="local-6989586621679039688"><span id="local-6989586621679039689"><span id="local-6989586621679039690"><span id="local-6989586621679039691"><span class="annot"><a href="Control.Monad.Trans.Control.html#embed"><span class="hs-identifier hs-type">embed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039688"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039689"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039689"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039691"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039689"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039688"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039689"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039691"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-767"></span><span id="embed"><span class="annot"><span class="annottext">embed :: forall (b :: * -&gt; *) (m :: * -&gt; *) a c.
MonadBaseControl b m =&gt;
(a -&gt; m c) -&gt; m (a -&gt; b (StM m c))
</span><a href="Control.Monad.Trans.Control.html#embed"><span class="hs-identifier hs-var hs-var">embed</span></a></span></span><span> </span><span id="local-6989586621679040342"><span class="annot"><span class="annottext">a -&gt; m c
</span><a href="#local-6989586621679040342"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (a -&gt; b (StM m c))) -&gt; m (a -&gt; b (StM m c))
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b (a -&gt; b (StM m c))) -&gt; m (a -&gt; b (StM m c)))
-&gt; (RunInBase m b -&gt; b (a -&gt; b (StM m c))) -&gt; m (a -&gt; b (StM m c))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040343"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040343"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b (StM m c)) -&gt; b (a -&gt; b (StM m c))
forall a. a -&gt; b a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m c -&gt; b (StM m c)
RunInBase m b
</span><a href="#local-6989586621679040343"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">(m c -&gt; b (StM m c)) -&gt; (a -&gt; m c) -&gt; a -&gt; b (StM m c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m c
</span><a href="#local-6989586621679040342"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#embed"><span class="hs-pragma hs-type">embed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="hs-comment">-- | Performs the same function as 'embed', but discards transformer state</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- from the embedded function.</span><span>
</span><span id="line-772"></span><span id="local-6989586621679039696"><span id="local-6989586621679039697"><span id="local-6989586621679039698"><span class="annot"><a href="Control.Monad.Trans.Control.html#embed_"><span class="hs-identifier hs-type">embed_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039696"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039697"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039697"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039697"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039696"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-773"></span><span id="embed_"><span class="annot"><span class="annottext">embed_ :: forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(a -&gt; m ()) -&gt; m (a -&gt; b ())
</span><a href="Control.Monad.Trans.Control.html#embed_"><span class="hs-identifier hs-var hs-var">embed_</span></a></span></span><span> </span><span id="local-6989586621679040354"><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679040354"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (a -&gt; b ())) -&gt; m (a -&gt; b ())
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b (a -&gt; b ())) -&gt; m (a -&gt; b ()))
-&gt; (RunInBase m b -&gt; b (a -&gt; b ())) -&gt; m (a -&gt; b ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040355"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b ()) -&gt; b (a -&gt; b ())
forall a. a -&gt; b a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b (StM m ()) -&gt; b ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(b (StM m ()) -&gt; b ()) -&gt; (a -&gt; b (StM m ())) -&gt; a -&gt; b ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m () -&gt; b (StM m ())
RunInBase m b
</span><a href="#local-6989586621679040355"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; b (StM m ())) -&gt; (a -&gt; m ()) -&gt; a -&gt; b (StM m ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679040354"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#embed_"><span class="hs-pragma hs-type">embed_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-775"></span><span>
</span><span id="line-776"></span><span class="annot"><span class="hs-comment">-- | Capture the current state of a transformer</span></span><span>
</span><span id="line-777"></span><span id="local-6989586621679039705"><span id="local-6989586621679039706"><span class="annot"><a href="Control.Monad.Trans.Control.html#captureT"><span class="hs-identifier hs-type">captureT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039705"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039705"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039706"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039706"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039705"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039705"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-778"></span><span id="captureT"><span class="annot"><span class="annottext">captureT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
(MonadTransControl t, Monad (t m), Monad m) =&gt;
t m (StT t ())
</span><a href="Control.Monad.Trans.Control.html#captureT"><span class="hs-identifier hs-var hs-var">captureT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Run t -&gt; m (StT t ())) -&gt; t m (StT t ())
forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run t -&gt; m (StT t ())) -&gt; t m (StT t ()))
-&gt; (Run t -&gt; m (StT t ())) -&gt; t m (StT t ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040363"><span class="annot"><span class="annottext">Run t
</span><a href="#local-6989586621679040363"><span class="hs-identifier hs-var">runInM</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t m () -&gt; m (StT t ())
Run t
</span><a href="#local-6989586621679040363"><span class="hs-identifier hs-var">runInM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; t m ()
forall a. a -&gt; t m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#captureT"><span class="hs-pragma hs-type">captureT</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span class="annot"><span class="hs-comment">-- | Capture the current state above the base monad</span></span><span>
</span><span id="line-782"></span><span id="local-6989586621679039709"><span id="local-6989586621679039710"><span class="annot"><a href="Control.Monad.Trans.Control.html#captureM"><span class="hs-identifier hs-type">captureM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039709"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039710"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-783"></span><span id="captureM"><span class="annot"><span class="annottext">captureM :: forall (b :: * -&gt; *) (m :: * -&gt; *).
MonadBaseControl b m =&gt;
m (StM m ())
</span><a href="Control.Monad.Trans.Control.html#captureM"><span class="hs-identifier hs-var hs-var">captureM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (StM m ())) -&gt; m (StM m ())
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b (StM m ())) -&gt; m (StM m ()))
-&gt; (RunInBase m b -&gt; b (StM m ())) -&gt; m (StM m ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040369"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040369"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m () -&gt; b (StM m ())
RunInBase m b
</span><a href="#local-6989586621679040369"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#captureM"><span class="hs-pragma hs-type">captureM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span class="hs-comment">-- | @liftBaseOp@ is a particular application of 'liftBaseWith' that allows</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- lifting control operations of type:</span><span>
</span><span id="line-788"></span><span class="hs-comment">--</span><span>
</span><span id="line-789"></span><span class="hs-comment">-- @((a -&gt; b c) -&gt; b c)@</span><span>
</span><span id="line-790"></span><span class="hs-comment">--</span><span>
</span><span id="line-791"></span><span class="hs-comment">-- to:</span><span>
</span><span id="line-792"></span><span class="hs-comment">--</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- @('MonadBaseControl' b m =&gt; (a -&gt; m c) -&gt; m c)@</span><span>
</span><span id="line-794"></span><span class="hs-comment">--</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-796"></span><span class="hs-comment">--</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- @liftBaseOp alloca :: (Storable a, 'MonadBaseControl' 'IO' m) =&gt; (Ptr a -&gt; m c) -&gt; m c@</span><span>
</span><span id="line-798"></span><span id="local-6989586621679039713"><span id="local-6989586621679039714"><span id="local-6989586621679039715"><span id="local-6989586621679039716"><span id="local-6989586621679039717"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp"><span class="hs-identifier hs-type">liftBaseOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039713"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-799"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039713"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039716"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039713"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039717"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039715"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>        </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039716"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span>        </span><span class="annot"><a href="#local-6989586621679039714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039717"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-801"></span><span id="liftBaseOp"><span class="annot"><span class="annottext">liftBaseOp :: forall (b :: * -&gt; *) (m :: * -&gt; *) a c d.
MonadBaseControl b m =&gt;
((a -&gt; b (StM m c)) -&gt; b (StM m d)) -&gt; (a -&gt; m c) -&gt; m d
</span><a href="Control.Monad.Trans.Control.html#liftBaseOp"><span class="hs-identifier hs-var hs-var">liftBaseOp</span></a></span></span><span> </span><span id="local-6989586621679040372"><span class="annot"><span class="annottext">(a -&gt; b (StM m c)) -&gt; b (StM m d)
</span><a href="#local-6989586621679040372"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040373"><span class="annot"><span class="annottext">a -&gt; m c
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (StM m d)) -&gt; m d
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b (StM m a)) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#control"><span class="hs-identifier hs-var">control</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b (StM m d)) -&gt; m d)
-&gt; (RunInBase m b -&gt; b (StM m d)) -&gt; m d
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040374"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b (StM m c)) -&gt; b (StM m d)
</span><a href="#local-6989586621679040372"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b (StM m c)) -&gt; b (StM m d))
-&gt; (a -&gt; b (StM m c)) -&gt; b (StM m d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m c -&gt; b (StM m c)
RunInBase m b
</span><a href="#local-6989586621679040374"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">(m c -&gt; b (StM m c)) -&gt; (a -&gt; m c) -&gt; a -&gt; b (StM m c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m c
</span><a href="#local-6989586621679040373"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-802"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp"><span class="hs-pragma hs-type">liftBaseOp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span class="hs-comment">-- | @liftBaseOp_@ is a particular application of 'liftBaseWith' that allows</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- lifting control operations of type:</span><span>
</span><span id="line-806"></span><span class="hs-comment">--</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- @(b a -&gt; b a)@</span><span>
</span><span id="line-808"></span><span class="hs-comment">--</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- to:</span><span>
</span><span id="line-810"></span><span class="hs-comment">--</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- @('MonadBaseControl' b m =&gt; m a -&gt; m a)@</span><span>
</span><span id="line-812"></span><span class="hs-comment">--</span><span>
</span><span id="line-813"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-814"></span><span class="hs-comment">--</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- @liftBaseOp_ mask_ :: 'MonadBaseControl' 'IO' m =&gt; m a -&gt; m a@</span><span>
</span><span id="line-816"></span><span id="local-6989586621679039723"><span id="local-6989586621679039724"><span id="local-6989586621679039725"><span id="local-6989586621679039726"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp_"><span class="hs-identifier hs-type">liftBaseOp_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039723"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039724"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-817"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039723"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039724"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039723"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StM"><span class="hs-identifier hs-type">StM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039724"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039726"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span>       </span><span class="annot"><a href="#local-6989586621679039724"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039725"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>        </span><span class="annot"><a href="#local-6989586621679039724"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039726"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-819"></span><span id="liftBaseOp_"><span class="annot"><span class="annottext">liftBaseOp_ :: forall (b :: * -&gt; *) (m :: * -&gt; *) a c.
MonadBaseControl b m =&gt;
(b (StM m a) -&gt; b (StM m c)) -&gt; m a -&gt; m c
</span><a href="Control.Monad.Trans.Control.html#liftBaseOp_"><span class="hs-identifier hs-var hs-var">liftBaseOp_</span></a></span></span><span> </span><span id="local-6989586621679040377"><span class="annot"><span class="annottext">b (StM m a) -&gt; b (StM m c)
</span><a href="#local-6989586621679040377"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040378"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679040378"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b (StM m c)) -&gt; m c
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b (StM m a)) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#control"><span class="hs-identifier hs-var">control</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b (StM m c)) -&gt; m c)
-&gt; (RunInBase m b -&gt; b (StM m c)) -&gt; m c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040379"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040379"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b (StM m a) -&gt; b (StM m c)
</span><a href="#local-6989586621679040377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(b (StM m a) -&gt; b (StM m c)) -&gt; b (StM m a) -&gt; b (StM m c)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; b (StM m a)
RunInBase m b
</span><a href="#local-6989586621679040379"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679040378"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-820"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOp_"><span class="hs-pragma hs-type">liftBaseOp_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">-- | @liftBaseDiscard@ is a particular application of 'liftBaseWith' that allows</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- lifting control operations of type:</span><span>
</span><span id="line-824"></span><span class="hs-comment">--</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- @(b () -&gt; b a)@</span><span>
</span><span id="line-826"></span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- to:</span><span>
</span><span id="line-828"></span><span class="hs-comment">--</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- @('MonadBaseControl' b m =&gt; m () -&gt; m a)@</span><span>
</span><span id="line-830"></span><span class="hs-comment">--</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- Note that, while the argument computation @m ()@ has access to the captured</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- state, all its side-effects in @m@ are discarded. It is run only for its</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- side-effects in the base monad @b@.</span><span>
</span><span id="line-834"></span><span class="hs-comment">--</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-836"></span><span class="hs-comment">--</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- @liftBaseDiscard forkIO :: 'MonadBaseControl' 'IO' m =&gt; m () -&gt; m ThreadId@</span><span>
</span><span id="line-838"></span><span id="local-6989586621679039731"><span id="local-6989586621679039732"><span id="local-6989586621679039733"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseDiscard"><span class="hs-identifier hs-type">liftBaseDiscard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039731"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039732"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039731"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039731"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039733"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039732"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039732"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039733"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-839"></span><span id="liftBaseDiscard"><span class="annot"><span class="annottext">liftBaseDiscard :: forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(b () -&gt; b a) -&gt; m () -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseDiscard"><span class="hs-identifier hs-var hs-var">liftBaseDiscard</span></a></span></span><span> </span><span id="local-6989586621679040386"><span class="annot"><span class="annottext">b () -&gt; b a
</span><a href="#local-6989586621679040386"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040387"><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679040387"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b a) -&gt; m a
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b a) -&gt; m a) -&gt; (RunInBase m b -&gt; b a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040388"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040388"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b () -&gt; b a
</span><a href="#local-6989586621679040386"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(b () -&gt; b a) -&gt; b () -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b (StM m ()) -&gt; b ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(b (StM m ()) -&gt; b ()) -&gt; b (StM m ()) -&gt; b ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m () -&gt; b (StM m ())
RunInBase m b
</span><a href="#local-6989586621679040388"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679040387"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-840"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseDiscard"><span class="hs-pragma hs-type">liftBaseDiscard</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span class="hs-comment">-- | @liftBaseOpDiscard@ is a particular application of 'liftBaseWith' that allows</span><span>
</span><span id="line-843"></span><span class="hs-comment">-- lifting control operations of type:</span><span>
</span><span id="line-844"></span><span class="hs-comment">--</span><span>
</span><span id="line-845"></span><span class="hs-comment">-- @((a -&gt; b ()) -&gt; b c)@</span><span>
</span><span id="line-846"></span><span class="hs-comment">--</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- to:</span><span>
</span><span id="line-848"></span><span class="hs-comment">--</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- @('MonadBaseControl' b m =&gt; (a -&gt; m ()) -&gt; m c)@</span><span>
</span><span id="line-850"></span><span class="hs-comment">--</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- Note that, while the argument computation @m ()@ has access to the captured</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- state, all its side-effects in @m@ are discarded. It is run only for its</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- side-effects in the base monad @b@.</span><span>
</span><span id="line-854"></span><span class="hs-comment">--</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-856"></span><span class="hs-comment">--</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- @liftBaseDiscard (runServer addr port) :: 'MonadBaseControl' 'IO' m =&gt; m () -&gt; m ()@</span><span>
</span><span id="line-858"></span><span id="local-6989586621679039737"><span id="local-6989586621679039738"><span id="local-6989586621679039739"><span id="local-6989586621679039740"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOpDiscard"><span class="hs-identifier hs-type">liftBaseOpDiscard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039737"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039738"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-859"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039737"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039737"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039740"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039739"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039740"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-861"></span><span id="liftBaseOpDiscard"><span class="annot"><span class="annottext">liftBaseOpDiscard :: forall (b :: * -&gt; *) (m :: * -&gt; *) a c.
MonadBaseControl b m =&gt;
((a -&gt; b ()) -&gt; b c) -&gt; (a -&gt; m ()) -&gt; m c
</span><a href="Control.Monad.Trans.Control.html#liftBaseOpDiscard"><span class="hs-identifier hs-var hs-var">liftBaseOpDiscard</span></a></span></span><span> </span><span id="local-6989586621679040395"><span class="annot"><span class="annottext">(a -&gt; b ()) -&gt; b c
</span><a href="#local-6989586621679040395"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679040396"><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679040396"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RunInBase m b -&gt; b c) -&gt; m c
forall a. (RunInBase m b -&gt; b a) -&gt; m a
forall (b :: * -&gt; *) (m :: * -&gt; *) a.
MonadBaseControl b m =&gt;
(RunInBase m b -&gt; b a) -&gt; m a
</span><a href="Control.Monad.Trans.Control.html#liftBaseWith"><span class="hs-identifier hs-var">liftBaseWith</span></a></span><span> </span><span class="annot"><span class="annottext">((RunInBase m b -&gt; b c) -&gt; m c) -&gt; (RunInBase m b -&gt; b c) -&gt; m c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040397"><span class="annot"><span class="annottext">RunInBase m b
</span><a href="#local-6989586621679040397"><span class="hs-identifier hs-var">runInBase</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b ()) -&gt; b c
</span><a href="#local-6989586621679040395"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b ()) -&gt; b c) -&gt; (a -&gt; b ()) -&gt; b c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b (StM m ()) -&gt; b ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(b (StM m ()) -&gt; b ()) -&gt; (a -&gt; b (StM m ())) -&gt; a -&gt; b ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m () -&gt; b (StM m ())
RunInBase m b
</span><a href="#local-6989586621679040397"><span class="hs-identifier hs-var">runInBase</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; b (StM m ())) -&gt; (a -&gt; m ()) -&gt; a -&gt; b (StM m ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m ()
</span><a href="#local-6989586621679040396"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-862"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Control.Monad.Trans.Control.html#liftBaseOpDiscard"><span class="hs-pragma hs-type">liftBaseOpDiscard</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="annot"><span class="hs-comment">-- | Transform an action in @t m@ using a transformer that operates on the underlying monad @m@</span></span><span>
</span><span id="line-865"></span><span id="local-6989586621679039745"><span id="local-6989586621679039746"><span id="local-6989586621679039747"><span id="local-6989586621679039748"><span class="annot"><a href="Control.Monad.Trans.Control.html#liftThrough"><span class="hs-identifier hs-type">liftThrough</span></a></span><span>
</span><span id="line-866"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#MonadTransControl"><span class="hs-identifier hs-type">MonadTransControl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-867"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039747"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Trans.Control.html#StT"><span class="hs-identifier hs-type">StT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^</span><span>
</span><span id="line-868"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039747"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679039745"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039746"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679039748"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-869"></span><span id="liftThrough"><span class="annot"><span class="annottext">liftThrough :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
(MonadTransControl t, Monad (t m), Monad m) =&gt;
(m (StT t a) -&gt; m (StT t b)) -&gt; t m a -&gt; t m b
</span><a href="Control.Monad.Trans.Control.html#liftThrough"><span class="hs-identifier hs-var hs-var">liftThrough</span></a></span></span><span> </span><span id="local-6989586621679040408"><span class="annot"><span class="annottext">m (StT t a) -&gt; m (StT t b)
</span><a href="#local-6989586621679040408"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679040409"><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679040409"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-870"></span><span>  </span><span id="local-6989586621679040410"><span class="annot"><span class="annottext">StT t b
</span><a href="#local-6989586621679040410"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Run t -&gt; m (StT t b)) -&gt; t m (StT t b)
forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#liftWith"><span class="hs-identifier hs-var">liftWith</span></a></span><span> </span><span class="annot"><span class="annottext">((Run t -&gt; m (StT t b)) -&gt; t m (StT t b))
-&gt; (Run t -&gt; m (StT t b)) -&gt; t m (StT t b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040411"><span class="annot"><span class="annottext">Run t
</span><a href="#local-6989586621679040411"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-871"></span><span>    </span><span class="annot"><span class="annottext">m (StT t a) -&gt; m (StT t b)
</span><a href="#local-6989586621679040408"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; m (StT t b)) -&gt; m (StT t a) -&gt; m (StT t b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t m a -&gt; m (StT t a)
Run t
</span><a href="#local-6989586621679040411"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679040409"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><span class="annottext">m (StT t b) -&gt; t m b
forall (m :: * -&gt; *) a. Monad m =&gt; m (StT t a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><a href="Control.Monad.Trans.Control.html#restoreT"><span class="hs-identifier hs-var">restoreT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t b) -&gt; t m b) -&gt; m (StT t b) -&gt; t m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StT t b -&gt; m (StT t b)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">StT t b
</span><a href="#local-6989586621679040410"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-873"></span></pre></body></html>