<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# Language CPP, BangPatterns, MagicHash, ForeignFunctionInterface, UnliftedFFITypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module    : System.Random.TF.Gen</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright : (c) 2012-2013 Micha&#322; Pa&#322;ka</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License   : BSD3</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  : michal.palka@chalmers.se</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- This module provides the 'TFGen' generator and the alternative 'RandomGen' class.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--  'TFGen' also implements the standard 'System.Random.RandomGen' class.</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Random.TF.Gen</span><span>
</span><span id="line-15"></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier">TFGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#RandomGen"><span class="hs-identifier">RandomGen</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#seedTFGen"><span class="hs-identifier">seedTFGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toUpper</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isSpace</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Primitive.ByteArray</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span class="hs-cpp">

#if !MIN_VERSION_base(4,4,0)
</span><span class="hs-identifier">unsafeDupablePerformIO</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-33"></span><span class="hs-identifier">unsafeDupablePerformIO</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-36"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;skein.h Threefish_256_Process_Block&quot;</span></span><span>
</span><span id="line-37"></span><span>  </span><span id="threefish256EncryptBlock"><span class="annot"><a href="System.Random.TF.Gen.html#threefish256EncryptBlock"><span class="hs-identifier hs-var">threefish256EncryptBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-38"></span><span>    </span><span id="local-6989586621679055102"><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MutableByteArray#</span></span><span> </span><span class="annot"><a href="#local-6989586621679055102"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="System.Random.TF.Gen.html#createBlock256"><span class="hs-identifier hs-type">createBlock256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span>
</span><span id="line-41"></span><span id="createBlock256"><span class="annot"><span class="annottext">createBlock256 :: Word64 -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; IO ByteArray
</span><a href="System.Random.TF.Gen.html#createBlock256"><span class="hs-identifier hs-var hs-var">createBlock256</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679055259"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055259"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679055260"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055260"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679055261"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055261"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679055262"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055262"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679055263"><span class="annot"><span class="annottext">MutableByteArray RealWorld
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (MutableByteArray (PrimState IO))
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Int -&gt; m (MutableByteArray (PrimState m))
</span><span class="hs-identifier hs-var">newByteArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; Int -&gt; Word64 -&gt; IO ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055259"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; Int -&gt; Word64 -&gt; IO ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055260"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; Int -&gt; Word64 -&gt; IO ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055261"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; Int -&gt; Word64 -&gt; IO ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055262"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; IO ByteArray
forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m) -&gt; m ByteArray
</span><span class="hs-identifier hs-var">unsafeFreezeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055263"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="System.Random.TF.Gen.html#readBlock256"><span class="hs-identifier hs-type">readBlock256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span id="readBlock256"><span class="annot"><span class="annottext">readBlock256 :: ByteArray -&gt; (Word64, Word64, Word64, Word64)
</span><a href="System.Random.TF.Gen.html#readBlock256"><span class="hs-identifier hs-var hs-var">readBlock256</span></a></span></span><span> </span><span id="local-6989586621679055268"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055268"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word64
forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055268"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word64
forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055268"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word64
forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055268"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word64
forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055268"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | The generator type</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">data</span><span> </span><span id="TFGen"><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-var">TFGen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>  </span><span id="TFGen"><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-var">TFGen</span></a></span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="hs-comment">-- Key, four Word64s in host endian format</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>    </span><span class="hs-comment">-- Tree level</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>    </span><span class="hs-comment">-- Tree position bits</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>     </span><span class="hs-comment">-- Index in tree position bits</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>     </span><span class="hs-comment">-- Index in the block</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span>                 </span><span class="hs-comment">-- The block, eight Word32s in host endian</span><span>
</span><span id="line-65"></span><span>                              </span><span class="hs-comment">-- format (this field is lazy)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">newtype</span><span> </span><span id="Hex"><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-var">Hex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Hex"><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-var">Hex</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679055273"><span id="local-6989586621679055277"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-type">Hex</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679055285"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Hex -&gt; ShowS
</span><a href="#local-6989586621679055285"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-type">Hex</span></a></span><span> </span><span id="local-6989586621679055287"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055287"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">Word64 -&gt; ShowS
forall {a}. Integral a =&gt; a -&gt; ShowS
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">showHex'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055290"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="annottext">Word64 -&gt; ShowS
forall {a}. Integral a =&gt; a -&gt; ShowS
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">showHex'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055291"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">Word64 -&gt; ShowS
forall {a}. Integral a =&gt; a -&gt; ShowS
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">showHex'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055292"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">Word64 -&gt; ShowS
forall {a}. Integral a =&gt; a -&gt; ShowS
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var">showHex'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055293"><span class="hs-identifier hs-var">x4</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679055290"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055290"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055291"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055291"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055292"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055292"><span class="hs-identifier hs-var">x3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055293"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055293"><span class="hs-identifier hs-var">x4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; (Word64, Word64, Word64, Word64)
</span><a href="System.Random.TF.Gen.html#readBlock256"><span class="hs-identifier hs-var">readBlock256</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055287"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679055289"><span class="annot"><span class="annottext">showHex' :: a -&gt; ShowS
</span><a href="#local-6989586621679055289"><span class="hs-identifier hs-var hs-var">showHex'</span></a></span></span><span> </span><span id="local-6989586621679055311"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055311"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679055312"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055312"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679055313"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ShowS
forall {a}. Integral a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055311"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055312"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679055313"><span class="annot"><span class="annottext">pad :: ShowS
</span><a href="#local-6989586621679055313"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621679055317"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055317"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055319"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055317"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679055319"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679055319"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055317"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679055326"><span id="local-6989586621679055330"><span id="local-6989586621679055333"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-type">Hex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679055350"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS Hex
</span><a href="#local-6989586621679055350"><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Word64], String) -&gt; (Hex, String))
-&gt; [([Word64], String)] -&gt; [(Hex, String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055352"><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679055352"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055353"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055353"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray -&gt; Hex
</span><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-var">Hex</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteArray -&gt; Hex) -&gt; ByteArray -&gt; Hex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; ByteArray
forall {a}. (Num a, Prim a) =&gt; [a] -&gt; ByteArray
</span><a href="#local-6989586621679055354"><span class="hs-identifier hs-var">makeBA</span></a></span><span> </span><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679055352"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055353"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Word64], String)] -&gt; [(Hex, String)])
-&gt; (String -&gt; [([Word64], String)]) -&gt; ReadS Hex
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="annottext">(([Word64], String) -&gt; Bool)
-&gt; [([Word64], String)] -&gt; [([Word64], String)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055355"><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679055355"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word64] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679055355"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Word64], String)] -&gt; [([Word64], String)])
-&gt; (String -&gt; [([Word64], String)])
-&gt; String
-&gt; [([Word64], String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><span class="annottext">((Integer, String) -&gt; ([Word64], String))
-&gt; [(Integer, String)] -&gt; [([Word64], String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055357"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055357"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055358"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055358"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; [Word64]
</span><a href="#local-6989586621679055359"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055357"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055358"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Integer, String)] -&gt; [([Word64], String)])
-&gt; (String -&gt; [(Integer, String)])
-&gt; String
-&gt; [([Word64], String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Integer, String)]
forall a. (Eq a, Num a) =&gt; ReadS a
</span><span class="hs-identifier hs-var">readHex</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [(Integer, String)])
-&gt; ShowS -&gt; String -&gt; [(Integer, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679055354"><span class="annot"><span class="annottext">makeBA :: [a] -&gt; ByteArray
</span><a href="#local-6989586621679055354"><span class="hs-identifier hs-var hs-var">makeBA</span></a></span></span><span> </span><span id="local-6989586621679055378"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679055378"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteArray -&gt; ByteArray
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteArray -&gt; ByteArray) -&gt; IO ByteArray -&gt; ByteArray
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-87"></span><span>            </span><span id="local-6989586621679055380"><span class="annot"><span class="annottext">MutableByteArray RealWorld
</span><a href="#local-6989586621679055380"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (MutableByteArray (PrimState IO))
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Int -&gt; m (MutableByteArray (PrimState m))
</span><span class="hs-identifier hs-var">newByteArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-88"></span><span>            </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; Int -&gt; a -&gt; IO ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutableByteArray (PrimState m) -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055380"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055382"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055383"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055383"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055383"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055382"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055382"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Int] -&gt; [(a, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679055378"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>            </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; IO ByteArray
forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m) -&gt; m ByteArray
</span><span class="hs-identifier hs-var">unsafeFreezeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055380"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-90"></span><span>          </span><span class="annot"><a href="#local-6989586621679055359"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>          </span><span id="local-6989586621679055359"><span class="annot"><span class="annottext">toList :: Integer -&gt; [Word64]
</span><a href="#local-6989586621679055359"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span>          </span><span class="annot"><a href="#local-6989586621679055359"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span id="local-6989586621679055384"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055384"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055385"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; [Word64] -&gt; [Word64]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Word64]
</span><a href="#local-6989586621679055359"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055386"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-93"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055386"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055386"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055385"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055385"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679055384"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="TFGenR"><span class="annot"><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-var">TFGenR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TFGenR"><span class="annot"><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-var">TFGenR</span></a></span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-type">Hex</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055404"><span id="local-6989586621679055414"><span id="local-6989586621679055418"><span class="annot"><span class="annottext">Int -&gt; TFGenR -&gt; ShowS
[TFGenR] -&gt; ShowS
TFGenR -&gt; String
(Int -&gt; TFGenR -&gt; ShowS)
-&gt; (TFGenR -&gt; String) -&gt; ([TFGenR] -&gt; ShowS) -&gt; Show TFGenR
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; TFGenR -&gt; ShowS
showsPrec :: Int -&gt; TFGenR -&gt; ShowS
$cshow :: TFGenR -&gt; String
show :: TFGenR -&gt; String
$cshowList :: [TFGenR] -&gt; ShowS
showList :: [TFGenR] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055421"><span id="local-6989586621679055425"><span id="local-6989586621679055428"><span id="local-6989586621679055445"><span class="annot"><span class="annottext">ReadPrec [TFGenR]
ReadPrec TFGenR
Int -&gt; ReadS TFGenR
ReadS [TFGenR]
(Int -&gt; ReadS TFGenR)
-&gt; ReadS [TFGenR]
-&gt; ReadPrec TFGenR
-&gt; ReadPrec [TFGenR]
-&gt; Read TFGenR
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS TFGenR
readsPrec :: Int -&gt; ReadS TFGenR
$creadList :: ReadS [TFGenR]
readList :: ReadS [TFGenR]
$creadPrec :: ReadPrec TFGenR
readPrec :: ReadPrec TFGenR
$creadListPrec :: ReadPrec [TFGenR]
readListPrec :: ReadPrec [TFGenR]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="System.Random.TF.Gen.html#toTFGenR"><span class="hs-identifier hs-type">toTFGenR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-type">TFGenR</span></a></span><span>
</span><span id="line-99"></span><span id="toTFGenR"><span class="annot"><span class="annottext">toTFGenR :: TFGen -&gt; TFGenR
</span><a href="System.Random.TF.Gen.html#toTFGenR"><span class="hs-identifier hs-var hs-var">toTFGenR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span id="local-6989586621679055448"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055448"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679055449"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055449"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055450"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055450"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055451"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055451"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679055452"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055452"><span class="hs-identifier hs-var">blki</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hex -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; Int16 -&gt; TFGenR
</span><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-var">TFGenR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray -&gt; Hex
</span><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-var">Hex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055448"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055449"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055450"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055451"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055452"><span class="hs-identifier hs-var">blki</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="System.Random.TF.Gen.html#fromTFGenR"><span class="hs-identifier hs-type">fromTFGenR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-type">TFGenR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span>
</span><span id="line-102"></span><span id="fromTFGenR"><span class="annot"><span class="annottext">fromTFGenR :: TFGenR -&gt; Maybe TFGen
</span><a href="System.Random.TF.Gen.html#fromTFGenR"><span class="hs-identifier hs-var hs-var">fromTFGenR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGenR"><span class="hs-identifier hs-type">TFGenR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#Hex"><span class="hs-identifier hs-type">Hex</span></a></span><span> </span><span id="local-6989586621679055454"><span class="annot"><span class="annottext">k :: ByteArray
</span><a href="#local-6989586621679055454"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055456"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055456"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055457"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055457"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055458"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055458"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055459"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055459"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679055460"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055460"><span class="hs-identifier hs-var">blki</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055459"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055459"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055460"><span class="hs-identifier hs-var">blki</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055460"><span class="hs-identifier hs-var">blki</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">8</span></span><span>
</span><span id="line-104"></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; Maybe TFGen
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TFGen -&gt; Maybe TFGen) -&gt; TFGen -&gt; Maybe TFGen
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
-&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; Int16 -&gt; ByteArray -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-var">TFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055454"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055457"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055458"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055459"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055460"><span class="hs-identifier hs-var">blki</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055456"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055457"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int16 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055460"><span class="hs-identifier hs-var">blki</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055458"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TFGen
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679055466"><span id="local-6989586621679055470"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679055473"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; TFGen -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679055474"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055474"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679055475"><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055475"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TFGenR -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055474"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFGen -&gt; TFGenR
</span><a href="System.Random.TF.Gen.html#toTFGenR"><span class="hs-identifier hs-var">toTFGenR</span></a></span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055475"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679055478"><span id="local-6989586621679055482"><span id="local-6989586621679055485"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679055490"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS TFGen
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span id="local-6989586621679055491"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055491"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">((Maybe TFGen, String) -&gt; (TFGen, String))
-&gt; [(Maybe TFGen, String)] -&gt; [(TFGen, String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055492"><span class="annot"><span class="annottext">Maybe TFGen
</span><a href="#local-6989586621679055492"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055493"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055493"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TFGen -&gt; TFGen
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe TFGen
</span><a href="#local-6989586621679055492"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055493"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Maybe TFGen, String)] -&gt; [(TFGen, String)])
-&gt; (String -&gt; [(Maybe TFGen, String)]) -&gt; ReadS TFGen
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">((Maybe TFGen, String) -&gt; Bool)
-&gt; [(Maybe TFGen, String)] -&gt; [(Maybe TFGen, String)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055494"><span class="annot"><span class="annottext">Maybe TFGen
</span><a href="#local-6989586621679055494"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TFGen -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe TFGen
</span><a href="#local-6989586621679055494"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Maybe TFGen, String)] -&gt; [(Maybe TFGen, String)])
-&gt; (String -&gt; [(Maybe TFGen, String)])
-&gt; String
-&gt; [(Maybe TFGen, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">((TFGenR, String) -&gt; (Maybe TFGen, String))
-&gt; [(TFGenR, String)] -&gt; [(Maybe TFGen, String)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679055495"><span class="annot"><span class="annottext">TFGenR
</span><a href="#local-6989586621679055495"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055496"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055496"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFGenR -&gt; Maybe TFGen
</span><a href="System.Random.TF.Gen.html#fromTFGenR"><span class="hs-identifier hs-var">fromTFGenR</span></a></span><span> </span><span class="annot"><span class="annottext">TFGenR
</span><a href="#local-6989586621679055495"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679055496"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TFGenR, String)] -&gt; [(Maybe TFGen, String)])
-&gt; ReadS TFGenR -&gt; String -&gt; [(Maybe TFGen, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadS TFGenR
forall a. Read a =&gt; Int -&gt; ReadS a
</span><span class="hs-identifier hs-var">readsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055491"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-type">mash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span>
</span><span id="line-117"></span><span id="mash"><span class="annot"><span class="annottext">mash :: ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var hs-var">mash</span></a></span></span><span> </span><span id="local-6989586621679055497"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055497"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span id="local-6989586621679055498"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055498"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055499"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055499"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055500"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055500"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679055501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055501"><span class="hs-identifier hs-var">o32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- We use unsafeDupablePerformIO here because the cost</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- of locking in unsafePerformIO is much higher</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- than any gains it could bring.</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">IO ByteArray -&gt; ByteArray
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteArray -&gt; ByteArray) -&gt; IO ByteArray -&gt; ByteArray
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055502"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055502"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; IO ByteArray
</span><a href="System.Random.TF.Gen.html#createBlock256"><span class="hs-identifier hs-var">createBlock256</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055499"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055500"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-comment">-- Allocate array for cipher result</span><span>
</span><span id="line-124"></span><span>      </span><span id="local-6989586621679055503"><span class="annot"><span class="annottext">o :: MutableByteArray RealWorld
</span><a href="#local-6989586621679055503"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MutableByteArray</span></span><span> </span><span id="local-6989586621679055505"><span class="annot"><span class="annottext">MutableByteArray# RealWorld
</span><a href="#local-6989586621679055505"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (MutableByteArray (PrimState IO))
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Int -&gt; m (MutableByteArray (PrimState m))
</span><span class="hs-identifier hs-var">newByteArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">ByteArray#
-&gt; ByteArray# -&gt; MutableByteArray# RealWorld -&gt; Int -&gt; IO ()
forall s.
ByteArray# -&gt; ByteArray# -&gt; MutableByteArray# s -&gt; Int -&gt; IO ()
</span><a href="System.Random.TF.Gen.html#threefish256EncryptBlock"><span class="hs-identifier hs-var">threefish256EncryptBlock</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055497"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055502"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# RealWorld
</span><a href="#local-6989586621679055505"><span class="hs-identifier hs-var">o'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055501"><span class="hs-identifier hs-var">o32</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="annottext">MutableByteArray (PrimState IO) -&gt; IO ByteArray
forall (m :: * -&gt; *).
PrimMonad m =&gt;
MutableByteArray (PrimState m) -&gt; m ByteArray
</span><span class="hs-identifier hs-var">unsafeFreezeByteArray</span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray RealWorld
MutableByteArray (PrimState IO)
</span><a href="#local-6989586621679055503"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><a href="System.Random.TF.Gen.html#mash%27"><span class="hs-identifier hs-type">mash'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span>
</span><span id="line-129"></span><span id="mash%27"><span class="annot"><span class="annottext">mash' :: TFGen -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash%27"><span class="hs-identifier hs-var hs-var">mash'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055507"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055507"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055508"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055508"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055509"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055509"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055510"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055510"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679055511"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055511"><span class="hs-identifier hs-var">o32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055507"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055508"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055509"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055510"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055511"><span class="hs-identifier hs-var">o32</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-type">mkTFGen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span>
</span><span id="line-133"></span><span id="mkTFGen"><span class="annot"><span class="annottext">mkTFGen :: ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var hs-var">mkTFGen</span></a></span></span><span> </span><span id="local-6989586621679055513"><span class="annot"><span class="annottext">k :: ByteArray
</span><a href="#local-6989586621679055513"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055514"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055514"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055515"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055515"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055516"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055516"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055517"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055517"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="annottext">ByteArray
-&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; Int16 -&gt; ByteArray -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-var">TFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055513"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055515"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055516"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055517"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055514"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055515"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055516"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="System.Random.TF.Gen.html#extract"><span class="hs-identifier hs-type">extract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-137"></span><span id="extract"><span class="annot"><span class="annottext">extract :: ByteArray -&gt; Int -&gt; Word32
</span><a href="System.Random.TF.Gen.html#extract"><span class="hs-identifier hs-var hs-var">extract</span></a></span></span><span> </span><span id="local-6989586621679055519"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055519"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055520"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word32
forall a. Prim a =&gt; ByteArray -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">indexByteArray</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055519"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055520"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenNext"><span class="hs-pragma hs-type">tfGenNext</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenNext"><span class="hs-identifier hs-type">tfGenNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span id="tfGenNext"><span class="annot"><span class="annottext">tfGenNext :: TFGen -&gt; (Word32, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext"><span class="hs-identifier hs-var hs-var">tfGenNext</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span id="local-6989586621679055522"><span class="annot"><span class="annottext">k :: ByteArray
</span><a href="#local-6989586621679055522"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055523"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055523"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055524"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055524"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055525"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055525"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055526"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679055527"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055527"><span class="hs-identifier hs-var">blki</span></a></span></span><span> </span><span id="local-6989586621679055528"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055528"><span class="hs-identifier hs-var">blk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055529"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055527"><span class="hs-identifier hs-var">blki</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">7</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055524"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055522"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055524"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055525"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">64</span></span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055522"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">setBit</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055525"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; Int -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055523"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055525"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteArray
-&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; Int16 -&gt; ByteArray -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-var">TFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055522"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055524"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055525"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055526"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055527"><span class="hs-identifier hs-var">blki</span></a></span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055528"><span class="hs-identifier hs-var">blk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="#local-6989586621679055529"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679055529"><span class="annot"><span class="annottext">val :: Word32
</span><a href="#local-6989586621679055529"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int -&gt; Word32
</span><a href="System.Random.TF.Gen.html#extract"><span class="hs-identifier hs-var">extract</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055528"><span class="hs-identifier hs-var">blk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055527"><span class="hs-identifier hs-var">blki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenNext%27"><span class="hs-identifier hs-type">tfGenNext'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span id="tfGenNext%27"><span class="annot"><span class="annottext">tfGenNext' :: TFGen -&gt; (Int, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext%27"><span class="hs-identifier hs-var hs-var">tfGenNext'</span></a></span></span><span> </span><span id="local-6989586621679055534"><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055534"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- We force the result into StdGen's range</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055535"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483562</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055535"><span class="hs-identifier hs-var">val'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055536"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (Int, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext%27"><span class="hs-identifier hs-var">tfGenNext'</span></a></span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055536"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679055537"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055537"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055536"><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055536"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (Word32, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext"><span class="hs-identifier hs-var">tfGenNext</span></a></span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055534"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679055535"><span class="annot"><span class="annottext">val' :: Word32
</span><a href="#local-6989586621679055535"><span class="hs-identifier hs-var hs-var">val'</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x7FFFFFFF</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055537"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenSplit"><span class="hs-identifier hs-type">tfGenSplit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span id="tfGenSplit"><span class="annot"><span class="annottext">tfGenSplit :: TFGen -&gt; (TFGen, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenSplit"><span class="hs-identifier hs-var hs-var">tfGenSplit</span></a></span></span><span> </span><span id="local-6989586621679055542"><span class="annot"><span class="annottext">g :: TFGen
</span><a href="#local-6989586621679055542"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span id="local-6989586621679055543"><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055543"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679055544"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055544"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055545"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055545"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055546"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055546"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055546"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055547"><span class="hs-identifier hs-var">maxb</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055548"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055548"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1</span></span><span>   </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055543"><span class="hs-identifier hs-var">k</span></a></span><span>  </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055544"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055545"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055549"><span class="hs-identifier hs-var">bi'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055543"><span class="hs-identifier hs-var">k</span></a></span><span>  </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055544"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055550"><span class="hs-identifier hs-var">b''</span></a></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055549"><span class="hs-identifier hs-var">bi'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679055547"><span class="annot"><span class="annottext">maxb :: Int16
</span><a href="#local-6989586621679055547"><span class="hs-identifier hs-var hs-var">maxb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">64</span></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679055549"><span class="annot"><span class="annottext">bi' :: Int16
</span><a href="#local-6989586621679055549"><span class="hs-identifier hs-var hs-var">bi'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055546"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679055548"><span class="annot"><span class="annottext">k' :: ByteArray
</span><a href="#local-6989586621679055548"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash%27"><span class="hs-identifier hs-var">mash'</span></a></span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055542"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679055550"><span class="annot"><span class="annottext">b'' :: Word64
</span><a href="#local-6989586621679055550"><span class="hs-identifier hs-var hs-var">b''</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">setBit</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055545"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055546"><span class="hs-identifier hs-var">bi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679055560"><span id="local-6989586621679055564"><span id="local-6989586621679055567"><span id="local-6989586621679055570"><span id="local-6989586621679055573"><span id="local-6989586621679055576"><span id="local-6989586621679055579"><span class="annot"><span class="hs-identifier hs-type">R.RandomGen</span></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679055584"><span class="annot"><span class="annottext">next :: TFGen -&gt; (Int, TFGen)
</span><a href="#local-6989586621679055584"><span class="hs-identifier hs-var hs-var hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (Int, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext%27"><span class="hs-identifier hs-var">tfGenNext'</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- Current Random instances assume that the generator</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- must have this range.</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679055586"><span class="annot"><span class="annottext">genRange :: TFGen -&gt; (Int, Int)
</span><a href="#local-6989586621679055586"><span class="hs-identifier hs-var hs-var hs-var hs-var">genRange</span></a></span></span><span> </span><span class="annot"><span class="annottext">TFGen
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2147483562</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679055588"><span class="annot"><span class="annottext">split :: TFGen -&gt; (TFGen, TFGen)
</span><a href="#local-6989586621679055588"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (TFGen, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenSplit"><span class="hs-identifier hs-var">tfGenSplit</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><span class="hs-comment">-- | Create a generator from a random seed.</span></span><span>
</span><span id="line-183"></span><span class="annot"><a href="System.Random.TF.Gen.html#seedTFGen"><span class="hs-identifier hs-type">seedTFGen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span>
</span><span id="line-184"></span><span id="seedTFGen"><span class="annot"><span class="annottext">seedTFGen :: (Word64, Word64, Word64, Word64) -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#seedTFGen"><span class="hs-identifier hs-var hs-var">seedTFGen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679055590"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055590"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055591"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055591"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055592"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055592"><span class="hs-identifier hs-var">a3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679055593"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055593"><span class="hs-identifier hs-var">a4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO ByteArray -&gt; ByteArray
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteArray -&gt; ByteArray) -&gt; IO ByteArray -&gt; ByteArray
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; IO ByteArray
</span><a href="System.Random.TF.Gen.html#createBlock256"><span class="hs-identifier hs-var">createBlock256</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055590"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055591"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055592"><span class="hs-identifier hs-var">a3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055593"><span class="hs-identifier hs-var">a4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Alternative 'RandomGen' class with a modified 'next' operation, and added 'splitn'</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- and 'level' operations.</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- </span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Using the generator requires that no more than one operation is called</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- on the same generator state, as the implementation does not guarantee pseudorandomness</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- otherwise. As an exception, calling 'splitn' many times on the same generator state is</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- allowed as long as the \'bits\' argument is the same for all the calls.</span><span>
</span><span id="line-196"></span><span class="hs-keyword">class</span><span> </span><span id="RandomGen"><span class="annot"><a href="System.Random.TF.Gen.html#RandomGen"><span class="hs-identifier hs-var">RandomGen</span></a></span></span><span> </span><span id="local-6989586621679055113"><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- | 'next' returns a 'Word32' that appears to have been chosen uniformly at random, and a </span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">-- new generator state.</span><span>
</span><span id="line-199"></span><span>  </span><span id="next"><span class="annot"><a href="System.Random.TF.Gen.html#next"><span class="hs-identifier hs-type">next</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- | 'split' returns two derived generator states that appear to be independent pseudorandom</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- number generators.</span><span>
</span><span id="line-202"></span><span>  </span><span id="split"><span class="annot"><a href="System.Random.TF.Gen.html#split"><span class="hs-identifier hs-type">split</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">-- | 'splitn' is the n-way split operation used to create many derived generator states</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- in one go. Application of 'splitn' to two first arguments should be shared between</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-comment">-- different applications of the index argument to avoid unnecessary repeated computations.</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- The following code creates ten \'independent\' generator states. Number \'4\' comes</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">-- from the fact that at least</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">-- four bits are needed to encode ten different indices.</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">--    f :: RandomGen g =&gt; g -&gt; [g]</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-comment">--    f r = map (splitn r 4) [0..9]</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-215"></span><span>  </span><span id="splitn"><span class="annot"><a href="System.Random.TF.Gen.html#splitn"><span class="hs-identifier hs-type">splitn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Original generator state.</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-comment">-- ^ Number of bits that will be used to index the derived states.</span><span>
</span><span id="line-217"></span><span>              </span><span class="hs-comment">-- Must be between 0 and 32.</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-comment">-- ^ Index of the derived state. Call to @splitn r n i@ must</span><span>
</span><span id="line-219"></span><span>              </span><span class="hs-comment">-- satisfy @0 &lt;= i &lt; 2^n@.</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- | 'level' is a \'hint\' operation that may cause an iteration of work</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- of the generator be performed prematurely in order to</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">-- prevent the subsequent operations from being expensive. It is meant to be</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- called before a 'splitn' operation, which is expected to be evaluated</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- a very large number indices. Calling 'level' in such case might decrease</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- the total amount of work performed.</span><span>
</span><span id="line-227"></span><span>  </span><span id="level"><span class="annot"><a href="System.Random.TF.Gen.html#level"><span class="hs-identifier hs-type">level</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679055113"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenSplitN"><span class="hs-identifier hs-type">tfGenSplitN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span>
</span><span id="line-230"></span><span id="tfGenSplitN"><span class="annot"><span class="annottext">tfGenSplitN :: TFGen -&gt; Int -&gt; Word32 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#tfGenSplitN"><span class="hs-identifier hs-var hs-var">tfGenSplitN</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span id="local-6989586621679055599"><span class="annot"><span class="annottext">k :: ByteArray
</span><a href="#local-6989586621679055599"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055600"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055600"><span class="hs-identifier hs-var">ku</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055601"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055601"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055602"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055602"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055603"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055603"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055604"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word32 -&gt; TFGen
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tfGenSplitN called with nbits &lt; 0&quot;</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Word32 -&gt; TFGen
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tfGenSplitN called with nbits &gt; 32&quot;</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055607"><span class="hs-identifier hs-var">bi'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055608"><span class="hs-identifier hs-var">maxb</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679055609"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055609"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679055619"><span class="annot"><span class="annottext">k' :: ByteArray
</span><a href="#local-6989586621679055619"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055600"><span class="hs-identifier hs-var">ku</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055601"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055602"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word64) -&gt; Word32 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="#local-6989586621679055622"><span class="hs-identifier hs-var">clip</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055609"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055603"><span class="hs-identifier hs-var">bi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-235"></span><span>     </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055619"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftR</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word64) -&gt; Word32 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="#local-6989586621679055622"><span class="hs-identifier hs-var">clip</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055609"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055607"><span class="hs-identifier hs-var">bi'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055608"><span class="hs-identifier hs-var">maxb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055603"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055608"><span class="hs-identifier hs-var">maxb</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679055624"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055624"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>     </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055599"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055601"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055602"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word64) -&gt; Word32 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall {a}. (Bits a, Num a) =&gt; a -&gt; a
</span><a href="#local-6989586621679055622"><span class="hs-identifier hs-var">clip</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679055624"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055607"><span class="hs-identifier hs-var">bi'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055603"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679055607"><span class="annot"><span class="annottext">bi' :: Int
</span><a href="#local-6989586621679055607"><span class="hs-identifier hs-var hs-var">bi'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055603"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679055608"><span class="annot"><span class="annottext">maxb :: Int
</span><a href="#local-6989586621679055608"><span class="hs-identifier hs-var hs-var">maxb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679055622"><span class="annot"><span class="annottext">clip :: a -&gt; a
</span><a href="#local-6989586621679055622"><span class="hs-identifier hs-var hs-var">clip</span></a></span></span><span> </span><span id="local-6989586621679055638"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055638"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0xFFFFFFFF</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679055604"><span class="hs-identifier hs-var">nbits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679055638"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><a href="System.Random.TF.Gen.html#tfGenLevel"><span class="hs-identifier hs-type">tfGenLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span>
</span><span id="line-244"></span><span id="tfGenLevel"><span class="annot"><span class="annottext">tfGenLevel :: TFGen -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#tfGenLevel"><span class="hs-identifier hs-var hs-var">tfGenLevel</span></a></span></span><span> </span><span id="local-6989586621679055640"><span class="annot"><span class="annottext">g :: TFGen
</span><a href="#local-6989586621679055640"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span id="local-6989586621679055641"><span class="annot"><span class="annottext">k :: ByteArray
</span><a href="#local-6989586621679055641"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span id="local-6989586621679055642"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055642"><span class="hs-identifier hs-var">ku</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679055643"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055643"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679055644"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055644"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679055645"><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055645"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055645"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><a href="#local-6989586621679055646"><span class="hs-identifier hs-var">maxb</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Word64 -&gt; Word64 -&gt; Int16 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#mkTFGen"><span class="hs-identifier hs-var">mkTFGen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="#local-6989586621679055647"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen
</span><a href="#local-6989586621679055640"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679055646"><span class="annot"><span class="annottext">maxb :: Int16
</span><a href="#local-6989586621679055646"><span class="hs-identifier hs-var hs-var">maxb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">64</span></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679055647"><span class="annot"><span class="annottext">k' :: ByteArray
</span><a href="#local-6989586621679055647"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Word64 -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; ByteArray
</span><a href="System.Random.TF.Gen.html#mash"><span class="hs-identifier hs-var">mash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679055642"><span class="hs-identifier hs-var">ku</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055643"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679055644"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#RandomGen"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#TFGen"><span class="hs-identifier hs-type">TFGen</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.Random.TF.Gen.html#next"><span class="hs-pragma hs-type">next</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679055656"><span class="annot"><span class="annottext">next :: TFGen -&gt; (Word32, TFGen)
</span><a href="System.Random.TF.Gen.html#next"><span class="hs-identifier hs-var hs-var hs-var hs-var">next</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (Word32, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenNext"><span class="hs-identifier hs-var">tfGenNext</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679055657"><span class="annot"><span class="annottext">split :: TFGen -&gt; (TFGen, TFGen)
</span><a href="System.Random.TF.Gen.html#split"><span class="hs-identifier hs-var hs-var hs-var hs-var">split</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; (TFGen, TFGen)
</span><a href="System.Random.TF.Gen.html#tfGenSplit"><span class="hs-identifier hs-var">tfGenSplit</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679055658"><span class="annot"><span class="annottext">splitn :: TFGen -&gt; Int -&gt; Word32 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#splitn"><span class="hs-identifier hs-var hs-var hs-var hs-var">splitn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; Int -&gt; Word32 -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#tfGenSplitN"><span class="hs-identifier hs-var">tfGenSplitN</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679055659"><span class="annot"><span class="annottext">level :: TFGen -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#level"><span class="hs-identifier hs-var hs-var hs-var hs-var">level</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFGen -&gt; TFGen
</span><a href="System.Random.TF.Gen.html#tfGenLevel"><span class="hs-identifier hs-var">tfGenLevel</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span></pre></body></html>