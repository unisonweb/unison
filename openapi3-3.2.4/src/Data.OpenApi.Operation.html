<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module:      Data.OpenApi.Operation</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer:  Nickolay Kudasov &lt;nickolay@getshoptv.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability:   experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Helper traversals and functions for Swagger operations manipulations.</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- These might be useful when you already have Swagger specification</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- generated by something else.</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.OpenApi.Operation</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Operation traversals</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier">allOperations</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#operationsOf"><span class="hs-identifier">operationsOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Manipulation</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Tags</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#applyTags"><span class="hs-identifier">applyTags</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#applyTagsFor"><span class="hs-identifier">applyTagsFor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Responses</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponse"><span class="hs-identifier">setResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseWith"><span class="hs-identifier">setResponseWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseFor"><span class="hs-identifier">setResponseFor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseForWith"><span class="hs-identifier">setResponseForWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Paths</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#prependPath"><span class="hs-identifier">prependPath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Miscellaneous</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Data.OpenApi.Operation.html#declareResponse"><span class="hs-identifier">declareResponse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude.Compat</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data.Lens</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.Compat</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Media</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MediaType</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html"><span class="hs-identifier">Data.OpenApi.Declare</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html"><span class="hs-identifier">Data.OpenApi.Internal</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.OpenApi.Lens.html"><span class="hs-identifier">Data.OpenApi.Lens</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.OpenApi.Schema.html"><span class="hs-identifier">Data.OpenApi.Schema</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet.InsOrd</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHS</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Aeson</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Proxy</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Time</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.ByteString.Lazy.Char8 as BSL</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.HashMap.Strict.InsOrd as IOHM</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.OpenApi.Internal.Utils</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Prepend path piece to all operations of the spec.</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Leading and trailing slashes are trimmed/added automatically.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt;&gt;&gt; let api = (mempty :: OpenApi) &amp; paths .~ IOHM.fromList [(&quot;/info&quot;, mempty)]</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;&gt;&gt; BSL.putStrLn $ encodePretty $ prependPath &quot;user/{user_id}&quot; api ^. paths</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- {</span><span>
</span><span id="line-67"></span><span class="hs-comment">--     &quot;/user/{user_id}/info&quot;: {}</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Data.OpenApi.Operation.html#prependPath"><span class="hs-identifier hs-type">prependPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-70"></span><span id="prependPath"><span class="annot"><span class="annottext">prependPath :: [Char] -&gt; OpenApi -&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#prependPath"><span class="hs-identifier hs-var hs-var">prependPath</span></a></span></span><span> </span><span id="local-6989586621679943179"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943179"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap [Char] PathItem
 -&gt; Identity (InsOrdHashMap [Char] PathItem))
-&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasPaths s a =&gt; Lens' s a
Lens' OpenApi (InsOrdHashMap [Char] PathItem)
</span><a href="Data.OpenApi.Lens.html#paths"><span class="hs-identifier hs-var">paths</span></a></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap [Char] PathItem
  -&gt; Identity (InsOrdHashMap [Char] PathItem))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (InsOrdHashMap [Char] PathItem -&gt; InsOrdHashMap [Char] PathItem)
-&gt; OpenApi
-&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char])
-&gt; InsOrdHashMap [Char] PathItem -&gt; InsOrdHashMap [Char] PathItem
forall k' k v.
(Eq k', Hashable k') =&gt;
(k -&gt; k') -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k' v
</span><span class="hs-identifier hs-var">InsOrdHashMap.mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943179"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
</span><a href="#local-6989586621679943183"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679943189"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943189"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679943183"><span class="annot"><span class="annottext">&lt;/&gt; :: [Char] -&gt; [Char] -&gt; [Char]
</span><a href="#local-6989586621679943183"><span class="hs-operator hs-var hs-var">&lt;/&gt;</span></a></span></span><span> </span><span id="local-6989586621679943190"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943190"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621679943191"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943190"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621679943191"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943189"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span id="local-6989586621679943192"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943192"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="#local-6989586621679943191"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943189"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943192"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679943191"><span class="annot"><span class="annottext">trim :: [Char] -&gt; [Char]
</span><a href="#local-6989586621679943191"><span class="hs-identifier hs-var hs-var">trim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; [Char]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; [Char] -&gt; [Char]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhileEnd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- | All operations of a Swagger spec.</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier hs-type">allOperations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-80"></span><span id="allOperations"><span class="annot"><span class="annottext">allOperations :: Traversal' OpenApi Operation
</span><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier hs-var hs-var">allOperations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap [Char] PathItem
 -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; OpenApi -&gt; f OpenApi
forall s a. HasPaths s a =&gt; Lens' s a
Lens' OpenApi (InsOrdHashMap [Char] PathItem)
</span><a href="Data.OpenApi.Lens.html#paths"><span class="hs-identifier hs-var">paths</span></a></span><span class="annot"><span class="annottext">((InsOrdHashMap [Char] PathItem
  -&gt; f (InsOrdHashMap [Char] PathItem))
 -&gt; OpenApi -&gt; f OpenApi)
-&gt; ((Operation -&gt; f Operation)
    -&gt; InsOrdHashMap [Char] PathItem
    -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; (Operation -&gt; f Operation)
-&gt; OpenApi
-&gt; f OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PathItem -&gt; f PathItem)
-&gt; InsOrdHashMap [Char] PathItem
-&gt; f (InsOrdHashMap [Char] PathItem)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; InsOrdHashMap [Char] a -&gt; f (InsOrdHashMap [Char] b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((PathItem -&gt; f PathItem)
 -&gt; InsOrdHashMap [Char] PathItem
 -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; ((Operation -&gt; f Operation) -&gt; PathItem -&gt; f PathItem)
-&gt; (Operation -&gt; f Operation)
-&gt; InsOrdHashMap [Char] PathItem
-&gt; f (InsOrdHashMap [Char] PathItem)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Operation -&gt; f Operation) -&gt; PathItem -&gt; f PathItem
forall s a. (Data s, Typeable a) =&gt; Traversal' s a
Traversal' PathItem Operation
</span><span class="hs-identifier hs-var">template</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | @'operationsOf' sub@ will traverse only those operations</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- that are present in @sub@. Note that @'Operation'@ is determined</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- by both path and method.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt;&gt;&gt; let ok = (mempty :: Operation) &amp; at 200 ?~ &quot;OK&quot;</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;&gt;&gt; let api = (mempty :: OpenApi) &amp; paths .~ IOHM.fromList [(&quot;/user&quot;, mempty &amp; get ?~ ok &amp; post ?~ ok)]</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt;&gt;&gt; let sub = (mempty :: OpenApi) &amp; paths .~ IOHM.fromList [(&quot;/user&quot;, mempty &amp; get ?~ mempty)]</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt;&gt;&gt; BSL.putStrLn $ encodePretty api</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- {</span><span>
</span><span id="line-91"></span><span class="hs-comment">--     &quot;components&quot;: {},</span><span>
</span><span id="line-92"></span><span class="hs-comment">--     &quot;info&quot;: {</span><span>
</span><span id="line-93"></span><span class="hs-comment">--         &quot;title&quot;: &quot;&quot;,</span><span>
</span><span id="line-94"></span><span class="hs-comment">--         &quot;version&quot;: &quot;&quot;</span><span>
</span><span id="line-95"></span><span class="hs-comment">--     },</span><span>
</span><span id="line-96"></span><span class="hs-comment">--     &quot;openapi&quot;: &quot;3.0.0&quot;,</span><span>
</span><span id="line-97"></span><span class="hs-comment">--     &quot;paths&quot;: {</span><span>
</span><span id="line-98"></span><span class="hs-comment">--         &quot;/user&quot;: {</span><span>
</span><span id="line-99"></span><span class="hs-comment">--             &quot;get&quot;: {</span><span>
</span><span id="line-100"></span><span class="hs-comment">--                 &quot;responses&quot;: {</span><span>
</span><span id="line-101"></span><span class="hs-comment">--                     &quot;200&quot;: {</span><span>
</span><span id="line-102"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;OK&quot;</span><span>
</span><span id="line-103"></span><span class="hs-comment">--                     }</span><span>
</span><span id="line-104"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-105"></span><span class="hs-comment">--             },</span><span>
</span><span id="line-106"></span><span class="hs-comment">--             &quot;post&quot;: {</span><span>
</span><span id="line-107"></span><span class="hs-comment">--                 &quot;responses&quot;: {</span><span>
</span><span id="line-108"></span><span class="hs-comment">--                     &quot;200&quot;: {</span><span>
</span><span id="line-109"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;OK&quot;</span><span>
</span><span id="line-110"></span><span class="hs-comment">--                     }</span><span>
</span><span id="line-111"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-112"></span><span class="hs-comment">--             }</span><span>
</span><span id="line-113"></span><span class="hs-comment">--         }</span><span>
</span><span id="line-114"></span><span class="hs-comment">--     }</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;&gt;&gt; BSL.putStrLn $ encodePretty $ api &amp; operationsOf sub . at 404 ?~ &quot;Not found&quot;</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- {</span><span>
</span><span id="line-118"></span><span class="hs-comment">--     &quot;components&quot;: {},</span><span>
</span><span id="line-119"></span><span class="hs-comment">--     &quot;info&quot;: {</span><span>
</span><span id="line-120"></span><span class="hs-comment">--         &quot;title&quot;: &quot;&quot;,</span><span>
</span><span id="line-121"></span><span class="hs-comment">--         &quot;version&quot;: &quot;&quot;</span><span>
</span><span id="line-122"></span><span class="hs-comment">--     },</span><span>
</span><span id="line-123"></span><span class="hs-comment">--     &quot;openapi&quot;: &quot;3.0.0&quot;,</span><span>
</span><span id="line-124"></span><span class="hs-comment">--     &quot;paths&quot;: {</span><span>
</span><span id="line-125"></span><span class="hs-comment">--         &quot;/user&quot;: {</span><span>
</span><span id="line-126"></span><span class="hs-comment">--             &quot;get&quot;: {</span><span>
</span><span id="line-127"></span><span class="hs-comment">--                 &quot;responses&quot;: {</span><span>
</span><span id="line-128"></span><span class="hs-comment">--                     &quot;200&quot;: {</span><span>
</span><span id="line-129"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;OK&quot;</span><span>
</span><span id="line-130"></span><span class="hs-comment">--                     },</span><span>
</span><span id="line-131"></span><span class="hs-comment">--                     &quot;404&quot;: {</span><span>
</span><span id="line-132"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;Not found&quot;</span><span>
</span><span id="line-133"></span><span class="hs-comment">--                     }</span><span>
</span><span id="line-134"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-135"></span><span class="hs-comment">--             },</span><span>
</span><span id="line-136"></span><span class="hs-comment">--             &quot;post&quot;: {</span><span>
</span><span id="line-137"></span><span class="hs-comment">--                 &quot;responses&quot;: {</span><span>
</span><span id="line-138"></span><span class="hs-comment">--                     &quot;200&quot;: {</span><span>
</span><span id="line-139"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;OK&quot;</span><span>
</span><span id="line-140"></span><span class="hs-comment">--                     }</span><span>
</span><span id="line-141"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-142"></span><span class="hs-comment">--             }</span><span>
</span><span id="line-143"></span><span class="hs-comment">--         }</span><span>
</span><span id="line-144"></span><span class="hs-comment">--     }</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-146"></span><span class="annot"><a href="Data.OpenApi.Operation.html#operationsOf"><span class="hs-identifier hs-type">operationsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-147"></span><span id="operationsOf"><span class="annot"><span class="annottext">operationsOf :: OpenApi -&gt; Traversal' OpenApi Operation
</span><a href="Data.OpenApi.Operation.html#operationsOf"><span class="hs-identifier hs-var hs-var">operationsOf</span></a></span></span><span> </span><span id="local-6989586621679943227"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943227"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap [Char] PathItem
 -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; OpenApi -&gt; f OpenApi
forall s a. HasPaths s a =&gt; Lens' s a
Lens' OpenApi (InsOrdHashMap [Char] PathItem)
</span><a href="Data.OpenApi.Lens.html#paths"><span class="hs-identifier hs-var">paths</span></a></span><span class="annot"><span class="annottext">((InsOrdHashMap [Char] PathItem
  -&gt; f (InsOrdHashMap [Char] PathItem))
 -&gt; OpenApi -&gt; f OpenApi)
-&gt; ((Operation -&gt; f Operation)
    -&gt; InsOrdHashMap [Char] PathItem
    -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; (Operation -&gt; f Operation)
-&gt; OpenApi
-&gt; f OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Indexed [Char] PathItem (f PathItem)
-&gt; InsOrdHashMap [Char] PathItem
-&gt; f (InsOrdHashMap [Char] PathItem)
forall i (t :: * -&gt; *) a b.
TraversableWithIndex i t =&gt;
IndexedTraversal i (t a) (t b) a b
IndexedTraversal
  [Char]
  (InsOrdHashMap [Char] PathItem)
  (InsOrdHashMap [Char] PathItem)
  PathItem
  PathItem
</span><span class="hs-identifier hs-var">itraversed</span></span><span class="annot"><span class="annottext">(Indexed [Char] PathItem (f PathItem)
 -&gt; InsOrdHashMap [Char] PathItem
 -&gt; f (InsOrdHashMap [Char] PathItem))
-&gt; ((Operation -&gt; f Operation)
    -&gt; Indexed [Char] PathItem (f PathItem))
-&gt; (Operation -&gt; f Operation)
-&gt; InsOrdHashMap [Char] PathItem
-&gt; f (InsOrdHashMap [Char] PathItem)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(([Char], PathItem) -&gt; f ([Char], PathItem))
-&gt; Indexed [Char] PathItem (f PathItem)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><span class="hs-identifier hs-var">withIndex</span></span><span class="annot"><span class="annottext">((([Char], PathItem) -&gt; f ([Char], PathItem))
 -&gt; Indexed [Char] PathItem (f PathItem))
-&gt; ((Operation -&gt; f Operation)
    -&gt; ([Char], PathItem) -&gt; f ([Char], PathItem))
-&gt; (Operation -&gt; f Operation)
-&gt; Indexed [Char] PathItem (f PathItem)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Operation -&gt; f Operation)
-&gt; ([Char], PathItem) -&gt; f ([Char], PathItem)
Traversal' ([Char], PathItem) Operation
</span><a href="#local-6989586621679943230"><span class="hs-identifier hs-var">subops</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-comment">-- | Traverse operations that correspond to paths and methods of the sub API.</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621679943230"><span class="hs-identifier hs-type">subops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679943230"><span class="annot"><span class="annottext">subops :: Traversal' ([Char], PathItem) Operation
</span><a href="#local-6989586621679943230"><span class="hs-identifier hs-var hs-var">subops</span></a></span></span><span> </span><span id="local-6989586621679943241"><span class="annot"><span class="annottext">Operation -&gt; f Operation
</span><a href="#local-6989586621679943241"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679943242"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943242"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679943243"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943243"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; InsOrdHashMap [Char] PathItem -&gt; Maybe PathItem
forall k v. (Eq k, Hashable k) =&gt; k -&gt; InsOrdHashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">InsOrdHashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943242"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943227"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; Getting
     (InsOrdHashMap [Char] PathItem)
     OpenApi
     (InsOrdHashMap [Char] PathItem)
-&gt; InsOrdHashMap [Char] PathItem
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (InsOrdHashMap [Char] PathItem)
  OpenApi
  (InsOrdHashMap [Char] PathItem)
forall s a. HasPaths s a =&gt; Lens' s a
Lens' OpenApi (InsOrdHashMap [Char] PathItem)
</span><a href="Data.OpenApi.Lens.html#paths"><span class="hs-identifier hs-var">paths</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679943246"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943246"><span class="hs-identifier hs-var">subitem</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943242"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">(PathItem -&gt; ([Char], PathItem))
-&gt; f PathItem -&gt; f ([Char], PathItem)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; Traversal' PathItem Operation
</span><a href="#local-6989586621679943248"><span class="hs-identifier hs-var">methodsOf</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943246"><span class="hs-identifier hs-var">subitem</span></a></span><span> </span><span class="annot"><span class="annottext">Operation -&gt; f Operation
</span><a href="#local-6989586621679943241"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943243"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">Maybe PathItem
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Char], PathItem) -&gt; f ([Char], PathItem)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679943242"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943243"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- | Traverse operations that exist in a given @'PathItem'@</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- This is used to traverse only the operations that exist in sub API.</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="#local-6989586621679943248"><span class="hs-identifier hs-type">methodsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679943248"><span class="annot"><span class="annottext">methodsOf :: PathItem -&gt; Traversal' PathItem Operation
</span><a href="#local-6989586621679943248"><span class="hs-identifier hs-var hs-var">methodsOf</span></a></span></span><span> </span><span id="local-6989586621679943272"><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943272"><span class="hs-identifier hs-var">pathItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traversing
  (-&gt;) f PathItem PathItem (Maybe Operation) (Maybe Operation)
-&gt; LensLike f PathItem PathItem [Maybe Operation] [Maybe Operation]
forall (f :: * -&gt; *) s t a.
Functor f =&gt;
Traversing (-&gt;) f s t a a -&gt; LensLike f s t [a] [a]
</span><span class="hs-identifier hs-var">partsOf</span></span><span> </span><span class="annot"><span class="annottext">Traversing
  (-&gt;) f PathItem PathItem (Maybe Operation) (Maybe Operation)
forall s a. (Data s, Typeable a) =&gt; Traversal' s a
Traversal' PathItem (Maybe Operation)
</span><span class="hs-identifier hs-var">template</span></span><span> </span><span class="annot"><span class="annottext">LensLike f PathItem PathItem [Maybe Operation] [Maybe Operation]
-&gt; ((Operation -&gt; f Operation)
    -&gt; [Maybe Operation] -&gt; f [Maybe Operation])
-&gt; (Operation -&gt; f Operation)
-&gt; PathItem
-&gt; f PathItem
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Indexed Int (Maybe Operation) (f (Maybe Operation))
-&gt; [Maybe Operation] -&gt; f [Maybe Operation]
forall i (t :: * -&gt; *) a b.
TraversableWithIndex i t =&gt;
IndexedTraversal i (t a) (t b) a b
IndexedTraversal
  Int
  [Maybe Operation]
  [Maybe Operation]
  (Maybe Operation)
  (Maybe Operation)
</span><span class="hs-identifier hs-var">itraversed</span></span><span> </span><span class="annot"><span class="annottext">(Indexed Int (Maybe Operation) (f (Maybe Operation))
 -&gt; [Maybe Operation] -&gt; f [Maybe Operation])
-&gt; ((Operation -&gt; f Operation)
    -&gt; Indexed Int (Maybe Operation) (f (Maybe Operation)))
-&gt; (Operation -&gt; f Operation)
-&gt; [Maybe Operation]
-&gt; f [Maybe Operation]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool)
-&gt; Optical'
     (-&gt;) (Indexed Int) f (Maybe Operation) (Maybe Operation)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) a.
(Indexable i p, Applicative f) =&gt;
(i -&gt; Bool) -&gt; Optical' p (Indexed i) f a a
</span><span class="hs-identifier hs-var">indices</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679943276"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Optical' (-&gt;) (Indexed Int) f (Maybe Operation) (Maybe Operation)
-&gt; ((Operation -&gt; f Operation)
    -&gt; Maybe Operation -&gt; f (Maybe Operation))
-&gt; (Operation -&gt; f Operation)
-&gt; Indexed Int (Maybe Operation) (f (Maybe Operation))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; f Operation)
-&gt; Maybe Operation -&gt; f (Maybe Operation)
forall a b (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p a (f b) -&gt; p (Maybe a) (f (Maybe b))
</span><span class="hs-identifier hs-var">_Just</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679943286"><span class="annot"><span class="annottext">ops :: [Maybe Operation]
</span><a href="#local-6989586621679943286"><span class="hs-identifier hs-var hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathItem
</span><a href="#local-6989586621679943272"><span class="hs-identifier hs-var">pathItem</span></a></span><span> </span><span class="annot"><span class="annottext">PathItem
-&gt; Getting (Endo [Maybe Operation]) PathItem (Maybe Operation)
-&gt; [Maybe Operation]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><span class="hs-operator hs-var">^..</span></span><span> </span><span class="annot"><span class="annottext">Getting (Endo [Maybe Operation]) PathItem (Maybe Operation)
forall s a. (Data s, Typeable a) =&gt; Traversal' s a
Traversal' PathItem (Maybe Operation)
</span><span class="hs-identifier hs-var">template</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679943276"><span class="annot"><span class="annottext">ns :: [Int]
</span><a href="#local-6989586621679943276"><span class="hs-identifier hs-var hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Maybe Operation) -&gt; Maybe Int)
-&gt; [(Int, Maybe Operation)] -&gt; [Int]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Operation) -&gt; Int) -&gt; Maybe (Int, Operation) -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Int, Operation) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Int, Operation) -&gt; Maybe Int)
-&gt; ((Int, Maybe Operation) -&gt; Maybe (Int, Operation))
-&gt; (Int, Maybe Operation)
-&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Maybe Operation) -&gt; Maybe (Int, Operation)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; (Int, f a) -&gt; f (Int, a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, Maybe Operation)] -&gt; [Int])
-&gt; [(Int, Maybe Operation)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Maybe Operation] -&gt; [(Int, Maybe Operation)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Maybe Operation]
</span><a href="#local-6989586621679943286"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Apply tags to all operations and update the global list of tags.</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- 'applyTags' = 'applyTagsFor' 'allOperations'</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Data.OpenApi.Operation.html#applyTags"><span class="hs-identifier hs-type">applyTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.OpenApi.Internal.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-169"></span><span id="applyTags"><span class="annot"><span class="annottext">applyTags :: [Tag] -&gt; OpenApi -&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#applyTags"><span class="hs-identifier hs-var hs-var">applyTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traversal' OpenApi Operation -&gt; [Tag] -&gt; OpenApi -&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#applyTagsFor"><span class="hs-identifier hs-var">applyTagsFor</span></a></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; f Operation) -&gt; OpenApi -&gt; f OpenApi
Traversal' OpenApi Operation
</span><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier hs-var">allOperations</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Apply tags to a part of Swagger spec and update the global</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- list of tags.</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Data.OpenApi.Operation.html#applyTagsFor"><span class="hs-identifier hs-type">applyTagsFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.OpenApi.Internal.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-174"></span><span id="applyTagsFor"><span class="annot"><span class="annottext">applyTagsFor :: Traversal' OpenApi Operation -&gt; [Tag] -&gt; OpenApi -&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#applyTagsFor"><span class="hs-identifier hs-var hs-var">applyTagsFor</span></a></span></span><span> </span><span id="local-6989586621679943302"><span class="annot"><span class="annottext">Traversal' OpenApi Operation
</span><a href="#local-6989586621679943302"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679943303"><span class="annot"><span class="annottext">[Tag]
</span><a href="#local-6989586621679943303"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679943304"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943304"><span class="hs-identifier hs-var">swag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943304"><span class="hs-identifier hs-var">swag</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi
Traversal' OpenApi Operation
</span><a href="#local-6989586621679943302"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">((Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((InsOrdHashSet TagName -&gt; Identity (InsOrdHashSet TagName))
    -&gt; Operation -&gt; Identity Operation)
-&gt; (InsOrdHashSet TagName -&gt; Identity (InsOrdHashSet TagName))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashSet TagName -&gt; Identity (InsOrdHashSet TagName))
-&gt; Operation -&gt; Identity Operation
forall s a. HasTags s a =&gt; Lens' s a
Lens' Operation (InsOrdHashSet TagName)
</span><a href="Data.OpenApi.Lens.html#tags"><span class="hs-identifier hs-var">tags</span></a></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashSet TagName -&gt; Identity (InsOrdHashSet TagName))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (InsOrdHashSet TagName -&gt; InsOrdHashSet TagName)
-&gt; OpenApi
-&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashSet TagName
-&gt; InsOrdHashSet TagName -&gt; InsOrdHashSet TagName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TagName] -&gt; InsOrdHashSet TagName
forall k. (Eq k, Hashable k) =&gt; [k] -&gt; InsOrdHashSet k
</span><span class="hs-identifier hs-var">InsOrdHS.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tag -&gt; TagName) -&gt; [Tag] -&gt; [TagName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; TagName
</span><a href="Data.OpenApi.Internal.html#_tagName"><span class="hs-identifier hs-var">_tagName</span></a></span><span> </span><span class="annot"><span class="annottext">[Tag]
</span><a href="#local-6989586621679943303"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashSet Tag -&gt; Identity (InsOrdHashSet Tag))
-&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasTags s a =&gt; Lens' s a
Lens' OpenApi (InsOrdHashSet Tag)
</span><a href="Data.OpenApi.Lens.html#tags"><span class="hs-identifier hs-var">tags</span></a></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashSet Tag -&gt; Identity (InsOrdHashSet Tag))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (InsOrdHashSet Tag -&gt; InsOrdHashSet Tag) -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashSet Tag -&gt; InsOrdHashSet Tag -&gt; InsOrdHashSet Tag
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; InsOrdHashSet Tag
forall k. (Eq k, Hashable k) =&gt; [k] -&gt; InsOrdHashSet k
</span><span class="hs-identifier hs-var">InsOrdHS.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Tag]
</span><a href="#local-6989586621679943303"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Construct a response with @'Schema'@ while declaring all</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- necessary schema definitions.</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- FIXME doc</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;&gt;&gt; BSL.putStrLn $ encodePretty $ runDeclare (declareResponse &quot;application/json&quot; (Proxy :: Proxy Day)) mempty</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- [</span><span>
</span><span id="line-185"></span><span class="hs-comment">--     {</span><span>
</span><span id="line-186"></span><span class="hs-comment">--         &quot;Day&quot;: {</span><span>
</span><span id="line-187"></span><span class="hs-comment">--             &quot;example&quot;: &quot;2016-07-22&quot;,</span><span>
</span><span id="line-188"></span><span class="hs-comment">--             &quot;format&quot;: &quot;date&quot;,</span><span>
</span><span id="line-189"></span><span class="hs-comment">--             &quot;type&quot;: &quot;string&quot;</span><span>
</span><span id="line-190"></span><span class="hs-comment">--         }</span><span>
</span><span id="line-191"></span><span class="hs-comment">--     },</span><span>
</span><span id="line-192"></span><span class="hs-comment">--     {</span><span>
</span><span id="line-193"></span><span class="hs-comment">--         &quot;content&quot;: {</span><span>
</span><span id="line-194"></span><span class="hs-comment">--             &quot;application/json&quot;: {</span><span>
</span><span id="line-195"></span><span class="hs-comment">--                 &quot;schema&quot;: {</span><span>
</span><span id="line-196"></span><span class="hs-comment">--                     &quot;$ref&quot;: &quot;#/components/schemas/Day&quot;</span><span>
</span><span id="line-197"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-198"></span><span class="hs-comment">--             }</span><span>
</span><span id="line-199"></span><span class="hs-comment">--         },</span><span>
</span><span id="line-200"></span><span class="hs-comment">--         &quot;description&quot;: &quot;&quot;</span><span>
</span><span id="line-201"></span><span class="hs-comment">--     }</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- ]</span><span>
</span><span id="line-203"></span><span id="local-6989586621679943065"><span class="annot"><a href="Data.OpenApi.Operation.html#declareResponse"><span class="hs-identifier hs-type">declareResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.Schema.html#ToSchema"><span class="hs-identifier hs-type">ToSchema</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679943065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MediaType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679943065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html#Declare"><span class="hs-identifier hs-type">Declare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span></span><span>
</span><span id="line-204"></span><span id="declareResponse"><span class="annot"><span class="annottext">declareResponse :: forall a.
ToSchema a =&gt;
MediaType -&gt; Proxy a -&gt; Declare (Definitions Schema) Response
</span><a href="Data.OpenApi.Operation.html#declareResponse"><span class="hs-identifier hs-var hs-var">declareResponse</span></a></span></span><span> </span><span id="local-6989586621679943338"><span class="annot"><span class="annottext">MediaType
</span><a href="#local-6989586621679943338"><span class="hs-identifier hs-var">cType</span></a></span></span><span> </span><span id="local-6989586621679943339"><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679943339"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679943340"><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621679943340"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; Declare (Definitions Schema) (Referenced Schema)
forall a.
ToSchema a =&gt;
Proxy a -&gt; Declare (Definitions Schema) (Referenced Schema)
</span><a href="Data.OpenApi.Internal.Schema.html#declareSchemaRef"><span class="hs-identifier hs-var">declareSchemaRef</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679943339"><span class="hs-identifier hs-var">proxy</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="annottext">Response -&gt; Declare (Definitions Schema) Response
forall a. a -&gt; DeclareT (Definitions Schema) Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; (Response -&gt; Response) -&gt; Response
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap MediaType MediaTypeObject
 -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
-&gt; Response -&gt; Identity Response
forall s a. HasContent s a =&gt; Lens' s a
Lens' Response (InsOrdHashMap MediaType MediaTypeObject)
</span><a href="Data.OpenApi.Lens.html#content"><span class="hs-identifier hs-var">content</span></a></span><span class="annot"><span class="annottext">((InsOrdHashMap MediaType MediaTypeObject
  -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
 -&gt; Response -&gt; Identity Response)
-&gt; ((Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))
     -&gt; Identity
          (Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))))
    -&gt; InsOrdHashMap MediaType MediaTypeObject
    -&gt; Identity (InsOrdHashMap MediaType MediaTypeObject))
-&gt; (Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))
    -&gt; Identity
         (Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))))
-&gt; Response
-&gt; Identity Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (InsOrdHashMap MediaType MediaTypeObject)
-&gt; Lens'
     (InsOrdHashMap MediaType MediaTypeObject)
     (Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">MediaType
Index (InsOrdHashMap MediaType MediaTypeObject)
</span><a href="#local-6989586621679943338"><span class="hs-identifier hs-var">cType</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))
  -&gt; Identity
       (Maybe (IxValue (InsOrdHashMap MediaType MediaTypeObject))))
 -&gt; Response -&gt; Identity Response)
-&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
-&gt; Response
-&gt; Response
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxValue (InsOrdHashMap MediaType MediaTypeObject)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">IxValue (InsOrdHashMap MediaType MediaTypeObject)
-&gt; (IxValue (InsOrdHashMap MediaType MediaTypeObject)
    -&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject))
-&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
-&gt; Identity (IxValue (InsOrdHashMap MediaType MediaTypeObject))
forall s a. HasSchema s a =&gt; Lens' s a
Lens'
  (IxValue (InsOrdHashMap MediaType MediaTypeObject))
  (Maybe (Referenced Schema))
</span><a href="Data.OpenApi.Lens.html#schema"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
 -&gt; Identity (IxValue (InsOrdHashMap MediaType MediaTypeObject)))
-&gt; Referenced Schema
-&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
-&gt; IxValue (InsOrdHashMap MediaType MediaTypeObject)
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621679943340"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Set response for all operations.</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- This will also update global schema definitions.</span><span>
</span><span id="line-210"></span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- If the response already exists it will be overwritten.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- 'setResponse' = 'setResponseFor' 'allOperations'</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-218"></span><span class="hs-comment">--</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- &gt;&gt;&gt; let api = (mempty :: OpenApi) &amp; paths .~ IOHM.fromList [(&quot;/user&quot;, mempty &amp; get ?~ mempty)]</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- &gt;&gt;&gt; let res = declareResponse &quot;application/json&quot; (Proxy :: Proxy Day)</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- &gt;&gt;&gt; BSL.putStrLn $ encodePretty $ api &amp; setResponse 200 res</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- {</span><span>
</span><span id="line-223"></span><span class="hs-comment">--     &quot;components&quot;: {</span><span>
</span><span id="line-224"></span><span class="hs-comment">--         &quot;schemas&quot;: {</span><span>
</span><span id="line-225"></span><span class="hs-comment">--             &quot;Day&quot;: {</span><span>
</span><span id="line-226"></span><span class="hs-comment">--                 &quot;example&quot;: &quot;2016-07-22&quot;,</span><span>
</span><span id="line-227"></span><span class="hs-comment">--                 &quot;format&quot;: &quot;date&quot;,</span><span>
</span><span id="line-228"></span><span class="hs-comment">--                 &quot;type&quot;: &quot;string&quot;</span><span>
</span><span id="line-229"></span><span class="hs-comment">--             }</span><span>
</span><span id="line-230"></span><span class="hs-comment">--         }</span><span>
</span><span id="line-231"></span><span class="hs-comment">--     },</span><span>
</span><span id="line-232"></span><span class="hs-comment">--     &quot;info&quot;: {</span><span>
</span><span id="line-233"></span><span class="hs-comment">--         &quot;title&quot;: &quot;&quot;,</span><span>
</span><span id="line-234"></span><span class="hs-comment">--         &quot;version&quot;: &quot;&quot;</span><span>
</span><span id="line-235"></span><span class="hs-comment">--     },</span><span>
</span><span id="line-236"></span><span class="hs-comment">--     &quot;openapi&quot;: &quot;3.0.0&quot;,</span><span>
</span><span id="line-237"></span><span class="hs-comment">--     &quot;paths&quot;: {</span><span>
</span><span id="line-238"></span><span class="hs-comment">--         &quot;/user&quot;: {</span><span>
</span><span id="line-239"></span><span class="hs-comment">--             &quot;get&quot;: {</span><span>
</span><span id="line-240"></span><span class="hs-comment">--                 &quot;responses&quot;: {</span><span>
</span><span id="line-241"></span><span class="hs-comment">--                     &quot;200&quot;: {</span><span>
</span><span id="line-242"></span><span class="hs-comment">--                         &quot;content&quot;: {</span><span>
</span><span id="line-243"></span><span class="hs-comment">--                             &quot;application/json&quot;: {</span><span>
</span><span id="line-244"></span><span class="hs-comment">--                                 &quot;schema&quot;: {</span><span>
</span><span id="line-245"></span><span class="hs-comment">--                                     &quot;$ref&quot;: &quot;#/components/schemas/Day&quot;</span><span>
</span><span id="line-246"></span><span class="hs-comment">--                                 }</span><span>
</span><span id="line-247"></span><span class="hs-comment">--                             }</span><span>
</span><span id="line-248"></span><span class="hs-comment">--                         },</span><span>
</span><span id="line-249"></span><span class="hs-comment">--                         &quot;description&quot;: &quot;&quot;</span><span>
</span><span id="line-250"></span><span class="hs-comment">--                     }</span><span>
</span><span id="line-251"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-252"></span><span class="hs-comment">--             }</span><span>
</span><span id="line-253"></span><span class="hs-comment">--         }</span><span>
</span><span id="line-254"></span><span class="hs-comment">--     }</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- }</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- See also @'setResponseWith'@.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponse"><span class="hs-identifier hs-type">setResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#HttpStatusCode"><span class="hs-identifier hs-type">HttpStatusCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html#Declare"><span class="hs-identifier hs-type">Declare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-259"></span><span id="setResponse"><span class="annot"><span class="annottext">setResponse :: Int -&gt; Declare (Definitions Schema) Response -&gt; OpenApi -&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponse"><span class="hs-identifier hs-var hs-var">setResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traversal' OpenApi Operation
-&gt; Int
-&gt; Declare (Definitions Schema) Response
-&gt; OpenApi
-&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponseFor"><span class="hs-identifier hs-var">setResponseFor</span></a></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; f Operation) -&gt; OpenApi -&gt; f OpenApi
Traversal' OpenApi Operation
</span><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier hs-var">allOperations</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Set or update response for all operations.</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- This will also update global schema definitions.</span><span>
</span><span id="line-263"></span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- If the response already exists, but it can't be dereferenced (invalid @\$ref@),</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- then just the new response is used.</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- 'setResponseWith' = 'setResponseForWith' 'allOperations'</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- See also @'setResponse'@.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseWith"><span class="hs-identifier hs-type">setResponseWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#HttpStatusCode"><span class="hs-identifier hs-type">HttpStatusCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html#Declare"><span class="hs-identifier hs-type">Declare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-273"></span><span id="setResponseWith"><span class="annot"><span class="annottext">setResponseWith :: (Response -&gt; Response -&gt; Response)
-&gt; Int
-&gt; Declare (Definitions Schema) Response
-&gt; OpenApi
-&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponseWith"><span class="hs-identifier hs-var hs-var">setResponseWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traversal' OpenApi Operation
-&gt; (Response -&gt; Response -&gt; Response)
-&gt; Int
-&gt; Declare (Definitions Schema) Response
-&gt; OpenApi
-&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponseForWith"><span class="hs-identifier hs-var">setResponseForWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; f Operation) -&gt; OpenApi -&gt; f OpenApi
Traversal' OpenApi Operation
</span><a href="Data.OpenApi.Operation.html#allOperations"><span class="hs-identifier hs-var">allOperations</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Set response for specified operations.</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- This will also update global schema definitions.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- If the response already exists it will be overwritten.</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- See also @'setResponseForWith'@.</span><span>
</span><span id="line-281"></span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseFor"><span class="hs-identifier hs-type">setResponseFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#HttpStatusCode"><span class="hs-identifier hs-type">HttpStatusCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html#Declare"><span class="hs-identifier hs-type">Declare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-282"></span><span id="setResponseFor"><span class="annot"><span class="annottext">setResponseFor :: Traversal' OpenApi Operation
-&gt; Int
-&gt; Declare (Definitions Schema) Response
-&gt; OpenApi
-&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponseFor"><span class="hs-identifier hs-var hs-var">setResponseFor</span></a></span></span><span> </span><span id="local-6989586621679943351"><span class="annot"><span class="annottext">Traversal' OpenApi Operation
</span><a href="#local-6989586621679943351"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679943352"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679943352"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621679943353"><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
</span><a href="#local-6989586621679943353"><span class="hs-identifier hs-var">dres</span></a></span></span><span> </span><span id="local-6989586621679943354"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943354"><span class="hs-identifier hs-var">swag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943354"><span class="hs-identifier hs-var">swag</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; Identity Components) -&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasComponents s a =&gt; Lens' s a
Lens' OpenApi Components
</span><a href="Data.OpenApi.Lens.html#components"><span class="hs-identifier hs-var">components</span></a></span><span class="annot"><span class="annottext">((Components -&gt; Identity Components)
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Definitions Schema -&gt; Identity (Definitions Schema))
    -&gt; Components -&gt; Identity Components)
-&gt; (Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; Components -&gt; Identity Components
forall s a. HasSchemas s a =&gt; Lens' s a
Lens' Components (Definitions Schema)
</span><a href="Data.OpenApi.Lens.html#schemas"><span class="hs-identifier hs-var">schemas</span></a></span><span> </span><span class="annot"><span class="annottext">((Definitions Schema -&gt; Identity (Definitions Schema))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (Definitions Schema -&gt; Definitions Schema) -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definitions Schema -&gt; Definitions Schema -&gt; Definitions Schema
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621679943357"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi
Traversal' OpenApi Operation
</span><a href="#local-6989586621679943351"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">((Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Maybe (Referenced Response)
     -&gt; Identity (Maybe (Referenced Response)))
    -&gt; Operation -&gt; Identity Operation)
-&gt; (Maybe (Referenced Response)
    -&gt; Identity (Maybe (Referenced Response)))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Operation -&gt; Lens' Operation (Maybe (IxValue Operation))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">Int
Index Operation
</span><a href="#local-6989586621679943352"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced Response)
  -&gt; Identity (Maybe (Referenced Response)))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; Referenced Response -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Referenced Response
forall a. a -&gt; Referenced a
</span><a href="Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943359"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679943357"><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621679943357"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679943359"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943359"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
-&gt; Definitions Schema -&gt; (Definitions Schema, Response)
forall d a. Declare d a -&gt; d -&gt; (d, a)
</span><a href="Data.OpenApi.Declare.html#runDeclare"><span class="hs-identifier hs-var">runDeclare</span></a></span><span> </span><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
</span><a href="#local-6989586621679943353"><span class="hs-identifier hs-var">dres</span></a></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Set or update response for specified operations.</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- This will also update global schema definitions.</span><span>
</span><span id="line-290"></span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- If the response already exists, but it can't be dereferenced (invalid @\$ref@),</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- then just the new response is used.</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- See also @'setResponseFor'@.</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Data.OpenApi.Operation.html#setResponseForWith"><span class="hs-identifier hs-type">setResponseForWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Operation"><span class="hs-identifier hs-type">Operation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#HttpStatusCode"><span class="hs-identifier hs-type">HttpStatusCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Declare.html#Declare"><span class="hs-identifier hs-type">Declare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span><span>
</span><span id="line-296"></span><span id="setResponseForWith"><span class="annot"><span class="annottext">setResponseForWith :: Traversal' OpenApi Operation
-&gt; (Response -&gt; Response -&gt; Response)
-&gt; Int
-&gt; Declare (Definitions Schema) Response
-&gt; OpenApi
-&gt; OpenApi
</span><a href="Data.OpenApi.Operation.html#setResponseForWith"><span class="hs-identifier hs-var hs-var">setResponseForWith</span></a></span></span><span> </span><span id="local-6989586621679943364"><span class="annot"><span class="annottext">Traversal' OpenApi Operation
</span><a href="#local-6989586621679943364"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679943365"><span class="annot"><span class="annottext">Response -&gt; Response -&gt; Response
</span><a href="#local-6989586621679943365"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679943366"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679943366"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span id="local-6989586621679943367"><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
</span><a href="#local-6989586621679943367"><span class="hs-identifier hs-var">dres</span></a></span></span><span> </span><span id="local-6989586621679943368"><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943368"><span class="hs-identifier hs-var">swag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943368"><span class="hs-identifier hs-var">swag</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; Identity Components) -&gt; OpenApi -&gt; Identity OpenApi
forall s a. HasComponents s a =&gt; Lens' s a
Lens' OpenApi Components
</span><a href="Data.OpenApi.Lens.html#components"><span class="hs-identifier hs-var">components</span></a></span><span class="annot"><span class="annottext">((Components -&gt; Identity Components)
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Definitions Schema -&gt; Identity (Definitions Schema))
    -&gt; Components -&gt; Identity Components)
-&gt; (Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Definitions Schema -&gt; Identity (Definitions Schema))
-&gt; Components -&gt; Identity Components
forall s a. HasSchemas s a =&gt; Lens' s a
Lens' Components (Definitions Schema)
</span><a href="Data.OpenApi.Lens.html#schemas"><span class="hs-identifier hs-var">schemas</span></a></span><span> </span><span class="annot"><span class="annottext">((Definitions Schema -&gt; Identity (Definitions Schema))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (Definitions Schema -&gt; Definitions Schema) -&gt; OpenApi -&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definitions Schema -&gt; Definitions Schema -&gt; Definitions Schema
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621679943369"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><span class="annottext">OpenApi -&gt; (OpenApi -&gt; OpenApi) -&gt; OpenApi
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi
Traversal' OpenApi Operation
</span><a href="#local-6989586621679943364"><span class="hs-identifier hs-var">ops</span></a></span><span> </span><span class="annot"><span class="annottext">((Operation -&gt; Identity Operation) -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; ((Maybe (Referenced Response)
     -&gt; Identity (Maybe (Referenced Response)))
    -&gt; Operation -&gt; Identity Operation)
-&gt; (Maybe (Referenced Response)
    -&gt; Identity (Maybe (Referenced Response)))
-&gt; OpenApi
-&gt; Identity OpenApi
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Operation -&gt; Lens' Operation (Maybe (IxValue Operation))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">Int
Index Operation
</span><a href="#local-6989586621679943366"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced Response)
  -&gt; Identity (Maybe (Referenced Response)))
 -&gt; OpenApi -&gt; Identity OpenApi)
-&gt; (Maybe (Referenced Response) -&gt; Maybe (Referenced Response))
-&gt; OpenApi
-&gt; OpenApi
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Referenced Response -&gt; Maybe (Referenced Response)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Response -&gt; Maybe (Referenced Response))
-&gt; (Maybe (Referenced Response) -&gt; Referenced Response)
-&gt; Maybe (Referenced Response)
-&gt; Maybe (Referenced Response)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Referenced Response
forall a. a -&gt; Referenced a
</span><a href="Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">(Response -&gt; Referenced Response)
-&gt; (Maybe (Referenced Response) -&gt; Response)
-&gt; Maybe (Referenced Response)
-&gt; Referenced Response
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response) -&gt; Response
</span><a href="#local-6989586621679943370"><span class="hs-identifier hs-var">combine</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679943369"><span class="annot"><span class="annottext">Definitions Schema
</span><a href="#local-6989586621679943369"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679943374"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943374"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
-&gt; Definitions Schema -&gt; (Definitions Schema, Response)
forall d a. Declare d a -&gt; d -&gt; (d, a)
</span><a href="Data.OpenApi.Declare.html#runDeclare"><span class="hs-identifier hs-var">runDeclare</span></a></span><span> </span><span class="annot"><span class="annottext">Declare (Definitions Schema) Response
</span><a href="#local-6989586621679943367"><span class="hs-identifier hs-var">dres</span></a></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679943370"><span class="annot"><span class="annottext">combine :: Maybe (Referenced Response) -&gt; Response
</span><a href="#local-6989586621679943370"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span id="local-6989586621679943386"><span class="annot"><span class="annottext">TagName
</span><a href="#local-6989586621679943386"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OpenApi
</span><a href="#local-6989586621679943368"><span class="hs-identifier hs-var">swag</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApi
-&gt; Getting (Maybe Response) OpenApi (Maybe Response)
-&gt; Maybe Response
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">(Components -&gt; Const (Maybe Response) Components)
-&gt; OpenApi -&gt; Const (Maybe Response) OpenApi
forall s a. HasComponents s a =&gt; Lens' s a
Lens' OpenApi Components
</span><a href="Data.OpenApi.Lens.html#components"><span class="hs-identifier hs-var">components</span></a></span><span class="annot"><span class="annottext">((Components -&gt; Const (Maybe Response) Components)
 -&gt; OpenApi -&gt; Const (Maybe Response) OpenApi)
-&gt; ((Maybe Response -&gt; Const (Maybe Response) (Maybe Response))
    -&gt; Components -&gt; Const (Maybe Response) Components)
-&gt; Getting (Maybe Response) OpenApi (Maybe Response)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Definitions Response
 -&gt; Const (Maybe Response) (Definitions Response))
-&gt; Components -&gt; Const (Maybe Response) Components
forall s a. HasResponses s a =&gt; Lens' s a
Lens' Components (Definitions Response)
</span><a href="Data.OpenApi.Lens.html#responses"><span class="hs-identifier hs-var">responses</span></a></span><span class="annot"><span class="annottext">((Definitions Response
  -&gt; Const (Maybe Response) (Definitions Response))
 -&gt; Components -&gt; Const (Maybe Response) Components)
-&gt; ((Maybe Response -&gt; Const (Maybe Response) (Maybe Response))
    -&gt; Definitions Response
    -&gt; Const (Maybe Response) (Definitions Response))
-&gt; (Maybe Response -&gt; Const (Maybe Response) (Maybe Response))
-&gt; Components
-&gt; Const (Maybe Response) Components
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Definitions Response)
-&gt; Lens'
     (Definitions Response) (Maybe (IxValue (Definitions Response)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><span class="hs-identifier hs-var">at</span></span><span> </span><span class="annot"><span class="annottext">TagName
Index (Definitions Response)
</span><a href="#local-6989586621679943386"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679943388"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943388"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Response -&gt; Response -&gt; Response
</span><a href="#local-6989586621679943365"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943388"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943374"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">Maybe Response
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943374"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="hs-comment">-- response name can't be dereferenced, replacing with new response</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="#local-6989586621679943370"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span id="local-6989586621679943389"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943389"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response -&gt; Response -&gt; Response
</span><a href="#local-6989586621679943365"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943389"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943374"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621679943370"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621679943374"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-307"></span></pre></body></html>