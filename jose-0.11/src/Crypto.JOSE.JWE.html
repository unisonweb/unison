<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (C) 2015, 2016  Fraser Tweedale</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- you may not use this file except in compliance with the License.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- You may obtain a copy of the License at</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">--      http://www.apache.org/licenses/LICENSE-2.0</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Unless required by applicable law or agreed to in writing, software</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- See the License for the specific language governing permissions and</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- limitations under the License.</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.JOSE.JWE</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier">JWEHeader</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWE"><span class="hs-identifier">JWE</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bimap</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">views</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Cipher.AES</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Cipher.Types</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Data.Padding</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.MAC.HMAC</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.MaskGenFunction</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA.OAEP</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OAEP</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.AESKW.html"><span class="hs-identifier">Crypto.JOSE.AESKW</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html"><span class="hs-identifier">Crypto.JOSE.Error</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html"><span class="hs-identifier">Crypto.JOSE.Header</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html"><span class="hs-identifier">Crypto.JOSE.JWA.JWE</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html"><span class="hs-identifier">Crypto.JOSE.JWK</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html"><span class="hs-identifier">Crypto.JOSE.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.URI.html"><span class="hs-identifier">Crypto.JOSE.Types.URI</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.Internal.html"><span class="hs-identifier">Crypto.JOSE.Types.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#critInvalidNames"><span class="hs-identifier hs-type">critInvalidNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span id="critInvalidNames"><span class="annot"><span class="annottext">critInvalidNames :: [Text]
</span><a href="Crypto.JOSE.JWE.html#critInvalidNames"><span class="hs-identifier hs-var hs-var">critInvalidNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;alg&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;enc&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;zip&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jku&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jwk&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;kid&quot;</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5u&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5c&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;crit&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">newtype</span><span> </span><span id="CritParameters"><span class="annot"><a href="Crypto.JOSE.JWE.html#CritParameters"><span class="hs-identifier hs-var">CritParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CritParameters"><span class="annot"><a href="Crypto.JOSE.JWE.html#CritParameters"><span class="hs-identifier hs-var">CritParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679352163"><span id="local-6989586621679352169"><span class="annot"><span class="annottext">CritParameters -&gt; CritParameters -&gt; Bool
(CritParameters -&gt; CritParameters -&gt; Bool)
-&gt; (CritParameters -&gt; CritParameters -&gt; Bool) -&gt; Eq CritParameters
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CritParameters -&gt; CritParameters -&gt; Bool
== :: CritParameters -&gt; CritParameters -&gt; Bool
$c/= :: CritParameters -&gt; CritParameters -&gt; Bool
/= :: CritParameters -&gt; CritParameters -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679352183"><span id="local-6989586621679352190"><span id="local-6989586621679352194"><span class="annot"><span class="annottext">Int -&gt; CritParameters -&gt; ShowS
[CritParameters] -&gt; ShowS
CritParameters -&gt; String
(Int -&gt; CritParameters -&gt; ShowS)
-&gt; (CritParameters -&gt; String)
-&gt; ([CritParameters] -&gt; ShowS)
-&gt; Show CritParameters
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CritParameters -&gt; ShowS
showsPrec :: Int -&gt; CritParameters -&gt; ShowS
$cshow :: CritParameters -&gt; String
show :: CritParameters -&gt; String
$cshowList :: [CritParameters] -&gt; ShowS
showList :: [CritParameters] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="JWEHeader"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-var">JWEHeader</span></a></span></span><span> </span><span id="local-6989586621679351843"><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWEHeader"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-var">JWEHeader</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_jweAlg"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe AlgWithParams
</span><a href="Crypto.JOSE.JWE.html#_jweAlg"><span class="hs-identifier hs-var hs-var">_jweAlg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweEnc"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; HeaderParam p Enc
</span><a href="Crypto.JOSE.JWE.html#_jweEnc"><span class="hs-identifier hs-var hs-var">_jweEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#Enc"><span class="hs-identifier hs-type">Enc</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweZip"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe Text
</span><a href="Crypto.JOSE.JWE.html#_jweZip"><span class="hs-identifier hs-var hs-var">_jweZip</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>  </span><span class="hs-comment">-- protected header only  &quot;DEF&quot; (DEFLATE) defined</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweJku"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWE.html#_jweJku"><span class="hs-identifier hs-var hs-var">_jweJku</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.URI</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweJwk"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p JWK)
</span><a href="Crypto.JOSE.JWE.html#_jweJwk"><span class="hs-identifier hs-var hs-var">_jweJwk</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWK.html#JWK"><span class="hs-identifier hs-type">JWK</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweKid"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWE.html#_jweKid"><span class="hs-identifier hs-var hs-var">_jweKid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweX5u"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p URI)
</span><a href="Crypto.JOSE.JWE.html#_jweX5u"><span class="hs-identifier hs-var hs-var">_jweX5u</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.URI</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweX5c"><span class="annot"><span class="annottext">forall p.
JWEHeader p -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="Crypto.JOSE.JWE.html#_jweX5c"><span class="hs-identifier hs-var hs-var">_jweX5c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Types.SignedCertificate</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweX5t"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p Base64SHA1)
</span><a href="Crypto.JOSE.JWE.html#_jweX5t"><span class="hs-identifier hs-var hs-var">_jweX5t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64SHA1"><span class="hs-identifier hs-type">Types.Base64SHA1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweX5tS256"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p Base64SHA256)
</span><a href="Crypto.JOSE.JWE.html#_jweX5tS256"><span class="hs-identifier hs-var hs-var">_jweX5tS256</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64SHA256"><span class="hs-identifier hs-type">Types.Base64SHA256</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweTyp"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWE.html#_jweTyp"><span class="hs-identifier hs-var hs-var">_jweTyp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Content Type (of object)</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweCty"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (HeaderParam p Text)
</span><a href="Crypto.JOSE.JWE.html#_jweCty"><span class="hs-identifier hs-var hs-var">_jweCty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-type">HeaderParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351843"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Content Type (of payload)</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweCrit"><span class="annot"><span class="annottext">forall p. JWEHeader p -&gt; Maybe (NonEmpty Text)
</span><a href="Crypto.JOSE.JWE.html#_jweCrit"><span class="hs-identifier hs-var hs-var">_jweCrit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679352218"><span id="local-6989586621679352245"><span class="annot"><span class="annottext">JWEHeader p -&gt; JWEHeader p -&gt; Bool
(JWEHeader p -&gt; JWEHeader p -&gt; Bool)
-&gt; (JWEHeader p -&gt; JWEHeader p -&gt; Bool) -&gt; Eq (JWEHeader p)
forall p. Eq p =&gt; JWEHeader p -&gt; JWEHeader p -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall p. Eq p =&gt; JWEHeader p -&gt; JWEHeader p -&gt; Bool
== :: JWEHeader p -&gt; JWEHeader p -&gt; Bool
$c/= :: forall p. Eq p =&gt; JWEHeader p -&gt; JWEHeader p -&gt; Bool
/= :: JWEHeader p -&gt; JWEHeader p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679352269"><span id="local-6989586621679352297"><span id="local-6989586621679352301"><span class="annot"><span class="annottext">Int -&gt; JWEHeader p -&gt; ShowS
[JWEHeader p] -&gt; ShowS
JWEHeader p -&gt; String
(Int -&gt; JWEHeader p -&gt; ShowS)
-&gt; (JWEHeader p -&gt; String)
-&gt; ([JWEHeader p] -&gt; ShowS)
-&gt; Show (JWEHeader p)
forall p. Show p =&gt; Int -&gt; JWEHeader p -&gt; ShowS
forall p. Show p =&gt; [JWEHeader p] -&gt; ShowS
forall p. Show p =&gt; JWEHeader p -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall p. Show p =&gt; Int -&gt; JWEHeader p -&gt; ShowS
showsPrec :: Int -&gt; JWEHeader p -&gt; ShowS
$cshow :: forall p. Show p =&gt; JWEHeader p -&gt; String
show :: JWEHeader p -&gt; String
$cshowList :: forall p. Show p =&gt; [JWEHeader p] -&gt; ShowS
showList :: [JWEHeader p] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679351881"><span class="annot"><a href="Crypto.JOSE.JWE.html#newJWEHeader"><span class="hs-identifier hs-type">newJWEHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351881"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#Enc"><span class="hs-identifier hs-type">Enc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-type">JWEHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351881"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-86"></span><span id="newJWEHeader"><span class="annot"><span class="annottext">newJWEHeader :: forall p.
ProtectionIndicator p =&gt;
AlgWithParams -&gt; Enc -&gt; JWEHeader p
</span><a href="Crypto.JOSE.JWE.html#newJWEHeader"><span class="hs-identifier hs-var hs-var">newJWEHeader</span></a></span></span><span> </span><span id="local-6989586621679352322"><span class="annot"><span class="annottext">AlgWithParams
</span><a href="#local-6989586621679352322"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679352323"><span class="annot"><span class="annottext">Enc
</span><a href="#local-6989586621679352323"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">Maybe AlgWithParams
-&gt; HeaderParam p Enc
-&gt; Maybe Text
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWEHeader p
forall p.
Maybe AlgWithParams
-&gt; HeaderParam p Enc
-&gt; Maybe Text
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWEHeader p
</span><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-var">JWEHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams -&gt; Maybe AlgWithParams
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="#local-6989586621679352322"><span class="hs-identifier hs-var">alg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Enc -&gt; HeaderParam p Enc
forall p a. p -&gt; a -&gt; HeaderParam p a
</span><a href="Crypto.JOSE.Header.html#HeaderParam"><span class="hs-identifier hs-var">HeaderParam</span></a></span><span> </span><span class="annot"><span class="annottext">p
forall a. ProtectionIndicator a =&gt; a
</span><a href="Crypto.JOSE.Header.html#getProtected"><span class="hs-identifier hs-var">getProtected</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="#local-6989586621679352323"><span class="hs-identifier hs-var">enc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
forall {a}. Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679352326"><span class="annot"><span class="annottext">z :: Maybe a
</span><a href="#local-6989586621679352326"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679352329"><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-type">JWEHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679352422"><span class="annot"><span class="annottext">parseParamsFor :: forall (b :: * -&gt; *) p.
(HasParams b, ProtectionIndicator p) =&gt;
Proxy b -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (JWEHeader p)
</span><a href="#local-6989586621679352422"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseParamsFor</span></a></span></span><span> </span><span id="local-6989586621679352424"><span class="annot"><span class="annottext">Proxy b
</span><a href="#local-6989586621679352424"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span id="local-6989586621679352425"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span id="local-6989586621679352426"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AlgWithParams
-&gt; HeaderParam p Enc
-&gt; Maybe Text
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWEHeader p
forall p.
Maybe AlgWithParams
-&gt; HeaderParam p Enc
-&gt; Maybe Text
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p JWK)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p URI)
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p Base64SHA1)
-&gt; Maybe (HeaderParam p Base64SHA256)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (HeaderParam p Text)
-&gt; Maybe (NonEmpty Text)
-&gt; JWEHeader p
</span><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-var">JWEHeader</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">(Maybe AlgWithParams
 -&gt; HeaderParam p Enc
 -&gt; Maybe Text
 -&gt; Maybe (HeaderParam p URI)
 -&gt; Maybe (HeaderParam p JWK)
 -&gt; Maybe (HeaderParam p Text)
 -&gt; Maybe (HeaderParam p URI)
 -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
 -&gt; Maybe (HeaderParam p Base64SHA1)
 -&gt; Maybe (HeaderParam p Base64SHA256)
 -&gt; Maybe (HeaderParam p Text)
 -&gt; Maybe (HeaderParam p Text)
 -&gt; Maybe (NonEmpty Text)
 -&gt; JWEHeader p)
-&gt; Parser (Maybe AlgWithParams)
-&gt; Parser
     (HeaderParam p Enc
      -&gt; Maybe Text
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p JWK)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Maybe AlgWithParams)
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Maybe Object -&gt; Object
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Object
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Maybe Object -&gt; Object
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Object
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (HeaderParam p Enc
   -&gt; Maybe Text
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p JWK)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (HeaderParam p Enc)
-&gt; Parser
     (Maybe Text
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p JWK)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (HeaderParam p Enc)
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#headerRequired"><span class="hs-identifier hs-var">headerRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;enc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe Text
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p JWK)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe Text)
-&gt; Parser
     (Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p JWK)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe Text)
forall a.
FromJSON a =&gt;
Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe a)
</span><a href="Crypto.JOSE.Header.html#headerOptionalProtected"><span class="hs-identifier hs-var">headerOptionalProtected</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;zip&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p JWK)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p URI))
-&gt; Parser
     (Maybe (HeaderParam p JWK)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser URI)
-&gt; Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p URI))
forall p a.
ProtectionIndicator p =&gt;
(Value -&gt; Parser a)
-&gt; Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional%27"><span class="hs-identifier hs-var">headerOptional'</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser URI
</span><a href="Crypto.JOSE.Types.URI.html#uriFromJSON"><span class="hs-identifier hs-var">uriFromJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jku&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p JWK)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p JWK))
-&gt; Parser
     (Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p JWK))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;jwk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p Text))
-&gt; Parser
     (Maybe (HeaderParam p URI)
      -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p Text))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;kid&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p URI)
   -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p URI))
-&gt; Parser
     (Maybe (HeaderParam p (NonEmpty SignedCertificate))
      -&gt; Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser URI)
-&gt; Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p URI))
forall p a.
ProtectionIndicator p =&gt;
(Value -&gt; Parser a)
-&gt; Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional%27"><span class="hs-identifier hs-var">headerOptional'</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser URI
</span><a href="Crypto.JOSE.Types.URI.html#uriFromJSON"><span class="hs-identifier hs-var">uriFromJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5u&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p (NonEmpty SignedCertificate))
   -&gt; Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
-&gt; Parser
     (Maybe (HeaderParam p Base64SHA1)
      -&gt; Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (HeaderParam p (NonEmpty Base64X509))
 -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate)))
-&gt; Parser (Maybe (HeaderParam p (NonEmpty Base64X509)))
-&gt; Parser (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Maybe (HeaderParam p (NonEmpty Base64X509))
  -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate)))
 -&gt; Parser (Maybe (HeaderParam p (NonEmpty Base64X509)))
 -&gt; Parser (Maybe (HeaderParam p (NonEmpty SignedCertificate))))
-&gt; ((Base64X509 -&gt; SignedCertificate)
    -&gt; Maybe (HeaderParam p (NonEmpty Base64X509))
    -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate)))
-&gt; (Base64X509 -&gt; SignedCertificate)
-&gt; Parser (Maybe (HeaderParam p (NonEmpty Base64X509)))
-&gt; Parser (Maybe (HeaderParam p (NonEmpty SignedCertificate)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(HeaderParam p (NonEmpty Base64X509)
 -&gt; HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (HeaderParam p (NonEmpty Base64X509))
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((HeaderParam p (NonEmpty Base64X509)
  -&gt; HeaderParam p (NonEmpty SignedCertificate))
 -&gt; Maybe (HeaderParam p (NonEmpty Base64X509))
 -&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate)))
-&gt; ((Base64X509 -&gt; SignedCertificate)
    -&gt; HeaderParam p (NonEmpty Base64X509)
    -&gt; HeaderParam p (NonEmpty SignedCertificate))
-&gt; (Base64X509 -&gt; SignedCertificate)
-&gt; Maybe (HeaderParam p (NonEmpty Base64X509))
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Base64X509 -&gt; NonEmpty SignedCertificate)
-&gt; HeaderParam p (NonEmpty Base64X509)
-&gt; HeaderParam p (NonEmpty SignedCertificate)
forall a b. (a -&gt; b) -&gt; HeaderParam p a -&gt; HeaderParam p b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((NonEmpty Base64X509 -&gt; NonEmpty SignedCertificate)
 -&gt; HeaderParam p (NonEmpty Base64X509)
 -&gt; HeaderParam p (NonEmpty SignedCertificate))
-&gt; ((Base64X509 -&gt; SignedCertificate)
    -&gt; NonEmpty Base64X509 -&gt; NonEmpty SignedCertificate)
-&gt; (Base64X509 -&gt; SignedCertificate)
-&gt; HeaderParam p (NonEmpty Base64X509)
-&gt; HeaderParam p (NonEmpty SignedCertificate)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Base64X509 -&gt; SignedCertificate)
-&gt; NonEmpty Base64X509 -&gt; NonEmpty SignedCertificate
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64X509"><span class="hs-identifier hs-type">Types.Base64X509</span></a></span><span> </span><span id="local-6989586621679352437"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679352437"><span class="hs-identifier hs-var">cert</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679352437"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p (NonEmpty Base64X509)))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5c&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p Base64SHA1)
   -&gt; Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p Base64SHA1))
-&gt; Parser
     (Maybe (HeaderParam p Base64SHA256)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p Base64SHA1))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p Base64SHA256)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p Base64SHA256))
-&gt; Parser
     (Maybe (HeaderParam p Text)
      -&gt; Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text)
      -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p Base64SHA256))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p Text)
   -&gt; Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text)
   -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p Text))
-&gt; Parser
     (Maybe (HeaderParam p Text)
      -&gt; Maybe (NonEmpty Text) -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p Text))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Parser
  (Maybe (HeaderParam p Text)
   -&gt; Maybe (NonEmpty Text) -&gt; JWEHeader p)
-&gt; Parser (Maybe (HeaderParam p Text))
-&gt; Parser (Maybe (NonEmpty Text) -&gt; JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object
-&gt; Maybe Object
-&gt; Parser (Maybe (HeaderParam p Text))
forall a p.
(FromJSON a, ProtectionIndicator p) =&gt;
Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (HeaderParam p a))
</span><a href="Crypto.JOSE.Header.html#headerOptional"><span class="hs-identifier hs-var">headerOptional</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Parser (Maybe (NonEmpty Text) -&gt; JWEHeader p)
-&gt; Parser (Maybe (NonEmpty Text)) -&gt; Parser (JWEHeader p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe (NonEmpty Text))
forall a.
FromJSON a =&gt;
Text -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser (Maybe a)
</span><a href="Crypto.JOSE.Header.html#headerOptionalProtected"><span class="hs-identifier hs-var">headerOptionalProtected</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;crit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Parser (Maybe (NonEmpty Text))
-&gt; (Maybe (NonEmpty Text) -&gt; Parser (Maybe (NonEmpty Text)))
-&gt; Parser (Maybe (NonEmpty Text))
forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; [Text]
-&gt; Object
-&gt; Maybe (NonEmpty Text)
-&gt; Parser (Maybe (NonEmpty Text))
forall (t0 :: * -&gt; *) (t1 :: * -&gt; *) (t2 :: * -&gt; *) (t3 :: * -&gt; *)
       (m :: * -&gt; *).
(Foldable t0, Foldable t1, Traversable t2, Traversable t3,
 MonadFail m) =&gt;
t0 Text -&gt; t1 Text -&gt; Object -&gt; t2 (t3 Text) -&gt; m (t2 (t3 Text))
</span><a href="Crypto.JOSE.Header.html#parseCrit"><span class="hs-identifier hs-var">parseCrit</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="Crypto.JOSE.JWE.html#critInvalidNames"><span class="hs-identifier hs-var">critInvalidNames</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy b -&gt; [Text]
forall (a :: * -&gt; *). HasParams a =&gt; Proxy a -&gt; [Text]
</span><a href="Crypto.JOSE.Header.html#extensions"><span class="hs-identifier hs-var">extensions</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy b
</span><a href="#local-6989586621679352424"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Maybe Object -&gt; Object
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Object
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352425"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Maybe Object -&gt; Object
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Object
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352426"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679352642"><span class="annot"><span class="annottext">params :: forall p. ProtectionIndicator p =&gt; JWEHeader p -&gt; [(Bool, Pair)]
</span><a href="#local-6989586621679352642"><span class="hs-identifier hs-var hs-var hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWEHeader"><span class="hs-identifier hs-type">JWEHeader</span></a></span><span> </span><span id="local-6989586621679352644"><span class="annot"><span class="annottext">Maybe AlgWithParams
</span><a href="#local-6989586621679352644"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679352645"><span class="annot"><span class="annottext">HeaderParam p Enc
</span><a href="#local-6989586621679352645"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span id="local-6989586621679352646"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679352646"><span class="hs-identifier hs-var">zip'</span></a></span></span><span> </span><span id="local-6989586621679352647"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679352647"><span class="hs-identifier hs-var">jku</span></a></span></span><span> </span><span id="local-6989586621679352648"><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679352648"><span class="hs-identifier hs-var">jwk</span></a></span></span><span> </span><span id="local-6989586621679352649"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352649"><span class="hs-identifier hs-var">kid</span></a></span></span><span> </span><span id="local-6989586621679352650"><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679352650"><span class="hs-identifier hs-var">x5u</span></a></span></span><span> </span><span id="local-6989586621679352651"><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679352651"><span class="hs-identifier hs-var">x5c</span></a></span></span><span> </span><span id="local-6989586621679352652"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679352652"><span class="hs-identifier hs-var">x5t</span></a></span></span><span> </span><span id="local-6989586621679352653"><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679352653"><span class="hs-identifier hs-var">x5tS256</span></a></span></span><span> </span><span id="local-6989586621679352654"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352654"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span id="local-6989586621679352655"><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352655"><span class="hs-identifier hs-var">cty</span></a></span></span><span> </span><span id="local-6989586621679352656"><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679352656"><span class="hs-identifier hs-var">crit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">[Maybe (Bool, Pair)] -&gt; [(Bool, Pair)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, Pair)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Bool, Pair) -&gt; Maybe (Bool, Pair)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Enc) Bool -&gt; HeaderParam p Enc -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Enc) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Enc) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Enc
</span><a href="#local-6989586621679352645"><span class="hs-identifier hs-var">enc</span></a></span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;enc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Enc -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Enc (HeaderParam p Enc) Enc -&gt; HeaderParam p Enc -&gt; Enc
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Enc (HeaderParam p Enc) Enc
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Enc
</span><a href="#local-6989586621679352645"><span class="hs-identifier hs-var">enc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (Bool, Pair)) -&gt; Maybe Text -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352661"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679352661"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;zip&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679352661"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679352646"><span class="hs-identifier hs-var">zip'</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p URI -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p URI) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352662"><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352662"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p URI) Bool -&gt; HeaderParam p URI -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p URI) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p URI) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352662"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jku&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Const Value) (HeaderParam p URI) URI
-&gt; (URI -&gt; Value) -&gt; HeaderParam p URI -&gt; Value
forall s (m :: * -&gt; *) r a.
MonadReader s m =&gt;
LensLike' (Const r) s a -&gt; (a -&gt; r) -&gt; m r
</span><span class="hs-identifier hs-var">views</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Const Value) (HeaderParam p URI) URI
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Value
</span><a href="Crypto.JOSE.Types.URI.html#uriToJSON"><span class="hs-identifier hs-var">uriToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352662"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679352647"><span class="hs-identifier hs-var">jku</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p JWK -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p JWK) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352664"><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679352664"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p JWK) Bool -&gt; HeaderParam p JWK -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p JWK) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p JWK) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679352664"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;jwk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; JWK -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting JWK (HeaderParam p JWK) JWK -&gt; HeaderParam p JWK -&gt; JWK
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting JWK (HeaderParam p JWK) JWK
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p JWK
</span><a href="#local-6989586621679352664"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p JWK)
</span><a href="#local-6989586621679352648"><span class="hs-identifier hs-var">jwk</span></a></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p Text -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p Text) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352665"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352665"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
-&gt; HeaderParam p Text -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Text) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352665"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;kid&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
-&gt; HeaderParam p Text -&gt; Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352665"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352649"><span class="hs-identifier hs-var">kid</span></a></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p URI -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p URI) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352666"><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352666"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p URI) Bool -&gt; HeaderParam p URI -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p URI) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p URI) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352666"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5u&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Const Value) (HeaderParam p URI) URI
-&gt; (URI -&gt; Value) -&gt; HeaderParam p URI -&gt; Value
forall s (m :: * -&gt; *) r a.
MonadReader s m =&gt;
LensLike' (Const r) s a -&gt; (a -&gt; r) -&gt; m r
</span><span class="hs-identifier hs-var">views</span></span><span> </span><span class="annot"><span class="annottext">LensLike' (Const Value) (HeaderParam p URI) URI
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">URI -&gt; Value
</span><a href="Crypto.JOSE.Types.URI.html#uriToJSON"><span class="hs-identifier hs-var">uriToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p URI
</span><a href="#local-6989586621679352666"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p URI)
</span><a href="#local-6989586621679352650"><span class="hs-identifier hs-var">x5u</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p (NonEmpty SignedCertificate) -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p (NonEmpty SignedCertificate))
-&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352667"><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679352667"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p (NonEmpty SignedCertificate)) Bool
-&gt; HeaderParam p (NonEmpty SignedCertificate) -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p (NonEmpty SignedCertificate)) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p (NonEmpty SignedCertificate)) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679352667"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5c&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; NonEmpty Base64X509 -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">(SignedCertificate -&gt; Base64X509)
-&gt; NonEmpty SignedCertificate -&gt; NonEmpty Base64X509
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate -&gt; Base64X509
</span><a href="Crypto.JOSE.Types.html#Base64X509"><span class="hs-identifier hs-var">Types.Base64X509</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (NonEmpty SignedCertificate)
  (HeaderParam p (NonEmpty SignedCertificate))
  (NonEmpty SignedCertificate)
-&gt; HeaderParam p (NonEmpty SignedCertificate)
-&gt; NonEmpty SignedCertificate
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (NonEmpty SignedCertificate)
  (HeaderParam p (NonEmpty SignedCertificate))
  (NonEmpty SignedCertificate)
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p (NonEmpty SignedCertificate)
</span><a href="#local-6989586621679352667"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p (NonEmpty SignedCertificate))
</span><a href="#local-6989586621679352651"><span class="hs-identifier hs-var">x5c</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p Base64SHA1 -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p Base64SHA1) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352668"><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679352668"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Base64SHA1) Bool
-&gt; HeaderParam p Base64SHA1 -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Base64SHA1) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Base64SHA1) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679352668"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5t&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Base64SHA1 -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Base64SHA1 (HeaderParam p Base64SHA1) Base64SHA1
-&gt; HeaderParam p Base64SHA1 -&gt; Base64SHA1
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Base64SHA1 (HeaderParam p Base64SHA1) Base64SHA1
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA1
</span><a href="#local-6989586621679352668"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA1)
</span><a href="#local-6989586621679352652"><span class="hs-identifier hs-var">x5t</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p Base64SHA256 -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p Base64SHA256) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352669"><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679352669"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Base64SHA256) Bool
-&gt; HeaderParam p Base64SHA256 -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Base64SHA256) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Base64SHA256) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679352669"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;x5t#S256&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Base64SHA256 -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Base64SHA256 (HeaderParam p Base64SHA256) Base64SHA256
-&gt; HeaderParam p Base64SHA256 -&gt; Base64SHA256
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Base64SHA256 (HeaderParam p Base64SHA256) Base64SHA256
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Base64SHA256
</span><a href="#local-6989586621679352669"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Base64SHA256)
</span><a href="#local-6989586621679352653"><span class="hs-identifier hs-var">x5tS256</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p Text -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p Text) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352670"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352670"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
-&gt; HeaderParam p Text -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Text) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352670"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;typ&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
-&gt; HeaderParam p Text -&gt; Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352670"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352654"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(HeaderParam p Text -&gt; (Bool, Pair))
-&gt; Maybe (HeaderParam p Text) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352671"><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352671"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
-&gt; HeaderParam p Text -&gt; Bool
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Bool (HeaderParam p Text) Bool
forall p a. ProtectionIndicator p =&gt; Getter (HeaderParam p a) Bool
Getter (HeaderParam p Text) Bool
</span><a href="Crypto.JOSE.Header.html#isProtected"><span class="hs-identifier hs-var">isProtected</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352671"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;cty&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
-&gt; HeaderParam p Text -&gt; Text
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Text (HeaderParam p Text) Text
forall p a (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a) -&gt; HeaderParam p a -&gt; f (HeaderParam p a)
</span><a href="Crypto.JOSE.Header.html#param"><span class="hs-identifier hs-var">param</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderParam p Text
</span><a href="#local-6989586621679352671"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HeaderParam p Text)
</span><a href="#local-6989586621679352655"><span class="hs-identifier hs-var">cty</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(NonEmpty Text -&gt; (Bool, Pair))
-&gt; Maybe (NonEmpty Text) -&gt; Maybe (Bool, Pair)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679352672"><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679352672"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;crit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; NonEmpty Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621679352672"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty Text)
</span><a href="#local-6989586621679352656"><span class="hs-identifier hs-var">crit</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">data</span><span> </span><span id="JWERecipient"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-var">JWERecipient</span></a></span></span><span> </span><span id="local-6989586621679351975"><span class="annot"><a href="#local-6989586621679351975"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679351976"><span class="annot"><a href="#local-6989586621679351976"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWERecipient"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-var">JWERecipient</span></a></span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_jweHeader"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWERecipient a p -&gt; a p
</span><a href="Crypto.JOSE.JWE.html#_jweHeader"><span class="hs-identifier hs-var hs-var">_jweHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679351975"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351976"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweEncryptedKey"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWERecipient a p -&gt; Maybe Base64Octets
</span><a href="Crypto.JOSE.JWE.html#_jweEncryptedKey"><span class="hs-identifier hs-var hs-var">_jweEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ JWE Encrypted Key</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679351985"><span id="local-6989586621679351986"><span id="local-6989586621679352678"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-type">JWERecipient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351986"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621679352689"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (JWERecipient a p)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (JWERecipient a p))
-&gt; Value
-&gt; Parser (JWERecipient a p)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWE Recipient&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (JWERecipient a p))
 -&gt; Value -&gt; Parser (JWERecipient a p))
-&gt; (Object -&gt; Parser (JWERecipient a p))
-&gt; Value
-&gt; Parser (JWERecipient a p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679352691"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352691"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p
forall (a :: * -&gt; *) p.
a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p
</span><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-var">JWERecipient</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">(a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p)
-&gt; Parser (a p) -&gt; Parser (Maybe Base64Octets -&gt; JWERecipient a p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (a p)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-comment">-- o .:? &quot;header&quot;</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">Parser (Maybe Base64Octets -&gt; JWERecipient a p)
-&gt; Parser (Maybe Base64Octets) -&gt; Parser (JWERecipient a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352691"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Base64Octets)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;encrypted_key&quot;</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span id="local-6989586621679351992"><span id="local-6989586621679351993"><span class="annot"><a href="Crypto.JOSE.JWE.html#parseRecipient"><span class="hs-identifier hs-type">parseRecipient</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351993"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-type">JWERecipient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679351993"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-139"></span><span id="parseRecipient"><span class="annot"><span class="annottext">parseRecipient :: forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Maybe Object -&gt; Maybe Object -&gt; Value -&gt; Parser (JWERecipient a p)
</span><a href="Crypto.JOSE.JWE.html#parseRecipient"><span class="hs-identifier hs-var hs-var">parseRecipient</span></a></span></span><span> </span><span id="local-6989586621679352711"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352711"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span id="local-6989586621679352712"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352712"><span class="hs-identifier hs-var">hu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (JWERecipient a p))
-&gt; Value
-&gt; Parser (JWERecipient a p)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWE Recipient&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (JWERecipient a p))
 -&gt; Value -&gt; Parser (JWERecipient a p))
-&gt; (Object -&gt; Parser (JWERecipient a p))
-&gt; Value
-&gt; Parser (JWERecipient a p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679352713"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352713"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679352714"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352714"><span class="hs-identifier hs-var">hr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352713"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Object)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;header&quot;</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p
forall (a :: * -&gt; *) p.
a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p
</span><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-var">JWERecipient</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">(a p -&gt; Maybe Base64Octets -&gt; JWERecipient a p)
-&gt; Parser (a p) -&gt; Parser (Maybe Base64Octets -&gt; JWERecipient a p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object -&gt; Maybe Object -&gt; Parser (a p)
forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Maybe Object -&gt; Maybe Object -&gt; Parser (a p)
</span><a href="Crypto.JOSE.Header.html#parseParams"><span class="hs-identifier hs-var">parseParams</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352711"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352712"><span class="hs-identifier hs-var">hu</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object -&gt; Maybe Object -&gt; Maybe Object
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352714"><span class="hs-identifier hs-var">hr</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- TODO fail on key collision in (hr &lt;&gt; hu)</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">Parser (Maybe Base64Octets -&gt; JWERecipient a p)
-&gt; Parser (Maybe Base64Octets) -&gt; Parser (JWERecipient a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352713"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Base64Octets)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;encrypted_key&quot;</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- parseParamsFor :: HasParams b =&gt; Proxy b -&gt; Maybe Object -&gt; Maybe Object -&gt; Parser a</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">data</span><span> </span><span id="JWE"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWE"><span class="hs-identifier hs-var">JWE</span></a></span></span><span> </span><span id="local-6989586621679352000"><span class="annot"><a href="#local-6989586621679352000"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679352001"><span class="annot"><a href="#local-6989586621679352001"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JWE"><span class="annot"><a href="Crypto.JOSE.JWE.html#JWE"><span class="hs-identifier hs-var">JWE</span></a></span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_protectedRaw"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; Maybe Text
</span><a href="Crypto.JOSE.JWE.html#_protectedRaw"><span class="hs-identifier hs-var hs-var">_protectedRaw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Encoded protected header, if available</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweIv"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; Maybe Base64Octets
</span><a href="Crypto.JOSE.JWE.html#_jweIv"><span class="hs-identifier hs-var hs-var">_jweIv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ JWE Initialization Vector</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweAad"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; Maybe Base64Octets
</span><a href="Crypto.JOSE.JWE.html#_jweAad"><span class="hs-identifier hs-var hs-var">_jweAad</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ JWE AAD</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweCiphertext"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; Base64Octets
</span><a href="Crypto.JOSE.JWE.html#_jweCiphertext"><span class="hs-identifier hs-var hs-var">_jweCiphertext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ JWE Ciphertext</span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweTag"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; Maybe Base64Octets
</span><a href="Crypto.JOSE.JWE.html#_jweTag"><span class="hs-identifier hs-var hs-var">_jweTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ JWE Authentication Tag</span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_jweRecipients"><span class="annot"><span class="annottext">forall (a :: * -&gt; *) p. JWE a p -&gt; [JWERecipient a p]
</span><a href="Crypto.JOSE.JWE.html#_jweRecipients"><span class="hs-identifier hs-var hs-var">_jweRecipients</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWERecipient"><span class="hs-identifier hs-type">JWERecipient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352000"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352001"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679352017"><span id="local-6989586621679352018"><span id="local-6989586621679352727"><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Header.html#HasParams"><span class="hs-identifier hs-type">HasParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352017"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.JOSE.Header.html#ProtectionIndicator"><span class="hs-identifier hs-type">ProtectionIndicator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352018"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWE.html#JWE"><span class="hs-identifier hs-type">JWE</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352017"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679352018"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679352772"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (JWE a p)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Object -&gt; Parser (JWE a p)) -&gt; Value -&gt; Parser (JWE a p)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JWE JSON Serialization&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (JWE a p)) -&gt; Value -&gt; Parser (JWE a p))
-&gt; (Object -&gt; Parser (JWE a p)) -&gt; Value -&gt; Parser (JWE a p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679352773"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679352774"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679352774"><span class="hs-identifier hs-var">hpB64</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Value)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679352775"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352775"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Object)
-&gt; (Value -&gt; Parser (Maybe Object))
-&gt; Maybe Value
-&gt; Parser (Maybe Object)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Object -&gt; Parser (Maybe Object)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Object
forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser (Maybe Object))
-&gt; Value
-&gt; Parser (Maybe Object)
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withText</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base64url-encoded header params&quot;</span></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Parser (Maybe Object))
-&gt; Text -&gt; Parser (Maybe Object)
forall a. (ByteString -&gt; Parser a) -&gt; Text -&gt; Parser a
</span><a href="Crypto.JOSE.Types.Internal.html#parseB64Url"><span class="hs-identifier hs-var">Types.parseB64Url</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser (Maybe Object)
-&gt; (Maybe Object -&gt; Parser (Maybe Object))
-&gt; Maybe (Maybe Object)
-&gt; Parser (Maybe Object)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Parser (Maybe Object)
forall a. String -&gt; Parser a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;protected header contains invalid JSON&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>          </span><span class="annot"><span class="annottext">Maybe Object -&gt; Parser (Maybe Object)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe Object) -&gt; Parser (Maybe Object))
-&gt; (ByteString -&gt; Maybe (Maybe Object))
-&gt; ByteString
-&gt; Parser (Maybe Object)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Maybe Object)
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">decode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe (Maybe Object))
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Maybe (Maybe Object)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">L.fromStrict</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679352774"><span class="hs-identifier hs-var">hpB64</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679352781"><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352781"><span class="hs-identifier hs-var">hu</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Object)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;unprotected&quot;</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Maybe Base64Octets
-&gt; Maybe Base64Octets
-&gt; Base64Octets
-&gt; Maybe Base64Octets
-&gt; [JWERecipient a p]
-&gt; JWE a p
forall (a :: * -&gt; *) p.
Maybe Text
-&gt; Maybe Base64Octets
-&gt; Maybe Base64Octets
-&gt; Base64Octets
-&gt; Maybe Base64Octets
-&gt; [JWERecipient a p]
-&gt; JWE a p
</span><a href="Crypto.JOSE.JWE.html#JWE"><span class="hs-identifier hs-var">JWE</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">(Maybe Text
 -&gt; Maybe Base64Octets
 -&gt; Maybe Base64Octets
 -&gt; Base64Octets
 -&gt; Maybe Base64Octets
 -&gt; [JWERecipient a p]
 -&gt; JWE a p)
-&gt; Parser (Maybe Text)
-&gt; Parser
     (Maybe Base64Octets
      -&gt; Maybe Base64Octets
      -&gt; Base64Octets
      -&gt; Maybe Base64Octets
      -&gt; [JWERecipient a p]
      -&gt; JWE a p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Parser Text -&gt; Parser (Maybe Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Text
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;protected&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- raw protected header</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">Parser
  (Maybe Base64Octets
   -&gt; Maybe Base64Octets
   -&gt; Base64Octets
   -&gt; Maybe Base64Octets
   -&gt; [JWERecipient a p]
   -&gt; JWE a p)
-&gt; Parser (Maybe Base64Octets)
-&gt; Parser
     (Maybe Base64Octets
      -&gt; Base64Octets
      -&gt; Maybe Base64Octets
      -&gt; [JWERecipient a p]
      -&gt; JWE a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Base64Octets)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;iv&quot;</span></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">Parser
  (Maybe Base64Octets
   -&gt; Base64Octets
   -&gt; Maybe Base64Octets
   -&gt; [JWERecipient a p]
   -&gt; JWE a p)
-&gt; Parser (Maybe Base64Octets)
-&gt; Parser
     (Base64Octets
      -&gt; Maybe Base64Octets -&gt; [JWERecipient a p] -&gt; JWE a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Base64Octets)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;aad&quot;</span></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Parser
  (Base64Octets
   -&gt; Maybe Base64Octets -&gt; [JWERecipient a p] -&gt; JWE a p)
-&gt; Parser Base64Octets
-&gt; Parser (Maybe Base64Octets -&gt; [JWERecipient a p] -&gt; JWE a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Base64Octets
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;ciphertext&quot;</span></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Parser (Maybe Base64Octets -&gt; [JWERecipient a p] -&gt; JWE a p)
-&gt; Parser (Maybe Base64Octets)
-&gt; Parser ([JWERecipient a p] -&gt; JWE a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Base64Octets)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;tag&quot;</span></span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">Parser ([JWERecipient a p] -&gt; JWE a p)
-&gt; Parser [JWERecipient a p] -&gt; Parser (JWE a p)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679352773"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser [Value]
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;recipients&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser [Value]
-&gt; ([Value] -&gt; Parser [JWERecipient a p])
-&gt; Parser [JWERecipient a p]
forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser (JWERecipient a p))
-&gt; [Value] -&gt; Parser [JWERecipient a p]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Object -&gt; Maybe Object -&gt; Value -&gt; Parser (JWERecipient a p)
forall (a :: * -&gt; *) p.
(HasParams a, ProtectionIndicator p) =&gt;
Maybe Object -&gt; Maybe Object -&gt; Value -&gt; Parser (JWERecipient a p)
</span><a href="Crypto.JOSE.JWE.html#parseRecipient"><span class="hs-identifier hs-var">parseRecipient</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352775"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679352781"><span class="hs-identifier hs-var">hu</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- TODO flattened serialization</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679352038"><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-type">wrap</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679352038"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ message (key to wrap)</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352038"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-183"></span><span id="wrap"><span class="annot"><span class="annottext">wrap :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
AlgWithParams
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
</span><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679352839"><span class="annot"><span class="annottext">alg :: AlgWithParams
</span><a href="#local-6989586621679352839"><span class="hs-identifier hs-var">alg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#RSA_OAEP"><span class="hs-identifier hs-var">RSA_OAEP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#RSAKeyMaterial"><span class="hs-identifier hs-type">RSAKeyMaterial</span></a></span><span> </span><span id="local-6989586621679352842"><span class="annot"><span class="annottext">RSAKeyParameters
</span><a href="#local-6989586621679352842"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352843"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352843"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Error)
-&gt; (ByteString -&gt; (AlgWithParams, ByteString))
-&gt; Either Error ByteString
-&gt; Either Error (AlgWithParams, ByteString)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Either a c -&gt; Either b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Error
</span><a href="Crypto.JOSE.Error.html#RSAError"><span class="hs-identifier hs-var">RSAError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="#local-6989586621679352839"><span class="hs-identifier hs-var">alg</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString
 -&gt; Either Error (AlgWithParams, ByteString))
-&gt; m (Either Error ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">OAEPParams SHA1 ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hash (m :: * -&gt; *).
(HashAlgorithm hash, MonadRandom m) =&gt;
OAEPParams hash ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">OAEP.encrypt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA1
-&gt; MaskGenAlgorithm ByteString ByteString
-&gt; Maybe ByteString
-&gt; OAEPParams SHA1 ByteString ByteString
forall hash seed output.
hash
-&gt; MaskGenAlgorithm seed output
-&gt; Maybe ByteString
-&gt; OAEPParams hash seed output
</span><span class="hs-identifier hs-var">OAEP.OAEPParams</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">SHA1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA1 -&gt; MaskGenAlgorithm ByteString ByteString
forall seed output hashAlg.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hashAlg) =&gt;
hashAlg -&gt; seed -&gt; Int -&gt; output
</span><span class="hs-identifier hs-var">mgf1</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">SHA1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RSAKeyParameters -&gt; PublicKey
</span><a href="Crypto.JOSE.JWA.JWK.html#rsaPublicKey"><span class="hs-identifier hs-var">rsaPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">RSAKeyParameters
</span><a href="#local-6989586621679352842"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352843"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#RSA_OAEP"><span class="hs-identifier hs-var">RSA_OAEP</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error (AlgWithParams, ByteString))
-&gt; Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmMismatch"><span class="hs-identifier hs-var">AlgorithmMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot use RSA_OAEP with non-RSA key&quot;</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span id="local-6989586621679352851"><span class="annot"><span class="annottext">alg :: AlgWithParams
</span><a href="#local-6989586621679352851"><span class="hs-identifier hs-var">alg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#RSA_OAEP_256"><span class="hs-identifier hs-var">RSA_OAEP_256</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#RSAKeyMaterial"><span class="hs-identifier hs-type">RSAKeyMaterial</span></a></span><span> </span><span id="local-6989586621679352853"><span class="annot"><span class="annottext">RSAKeyParameters
</span><a href="#local-6989586621679352853"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352854"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352854"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Error)
-&gt; (ByteString -&gt; (AlgWithParams, ByteString))
-&gt; Either Error ByteString
-&gt; Either Error (AlgWithParams, ByteString)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Either a c -&gt; Either b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Error
</span><a href="Crypto.JOSE.Error.html#RSAError"><span class="hs-identifier hs-var">RSAError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="#local-6989586621679352851"><span class="hs-identifier hs-var">alg</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either Error ByteString
 -&gt; Either Error (AlgWithParams, ByteString))
-&gt; m (Either Error ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">OAEPParams SHA256 ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; m (Either Error ByteString)
forall hash (m :: * -&gt; *).
(HashAlgorithm hash, MonadRandom m) =&gt;
OAEPParams hash ByteString ByteString
-&gt; PublicKey -&gt; ByteString -&gt; m (Either Error ByteString)
</span><span class="hs-identifier hs-var">OAEP.encrypt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256
-&gt; MaskGenAlgorithm ByteString ByteString
-&gt; Maybe ByteString
-&gt; OAEPParams SHA256 ByteString ByteString
forall hash seed output.
hash
-&gt; MaskGenAlgorithm seed output
-&gt; Maybe ByteString
-&gt; OAEPParams hash seed output
</span><span class="hs-identifier hs-var">OAEP.OAEPParams</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHA256 -&gt; MaskGenAlgorithm ByteString ByteString
forall seed output hashAlg.
(ByteArrayAccess seed, ByteArray output, HashAlgorithm hashAlg) =&gt;
hashAlg -&gt; seed -&gt; Int -&gt; output
</span><span class="hs-identifier hs-var">mgf1</span></span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall {a}. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RSAKeyParameters -&gt; PublicKey
</span><a href="Crypto.JOSE.JWA.JWK.html#rsaPublicKey"><span class="hs-identifier hs-var">rsaPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">RSAKeyParameters
</span><a href="#local-6989586621679352853"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352854"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#RSA_OAEP_256"><span class="hs-identifier hs-var">RSA_OAEP_256</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error (AlgWithParams, ByteString))
-&gt; Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmMismatch"><span class="hs-identifier hs-var">AlgorithmMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot use RSA_OAEP_256 with non-RSA key&quot;</span></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A128KW"><span class="hs-identifier hs-var">A128KW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyMaterial"><span class="hs-identifier hs-type">OctKeyMaterial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyParameters"><span class="hs-identifier hs-type">OctKeyParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679352860"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352860"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352861"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352861"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A128KW"><span class="hs-identifier hs-var">A128KW</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (AlgWithParams, ByteString))
-&gt; Either Error ByteString
-&gt; Either Error (AlgWithParams, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable AES128 -&gt; ByteString -&gt; Either Error ByteString
forall cipher.
BlockCipher128 cipher =&gt;
CryptoFailable cipher -&gt; ByteString -&gt; Either Error ByteString
</span><a href="Crypto.JOSE.JWE.html#wrapAESKW"><span class="hs-identifier hs-var">wrapAESKW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable AES128
forall cipher key.
(Cipher cipher, ByteArray key) =&gt;
key -&gt; CryptoFailable cipher
forall key. ByteArray key =&gt; key -&gt; CryptoFailable AES128
</span><span class="hs-identifier hs-var">cipherInit</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352860"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES128</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352861"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A192KW"><span class="hs-identifier hs-var">A192KW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyMaterial"><span class="hs-identifier hs-type">OctKeyMaterial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyParameters"><span class="hs-identifier hs-type">OctKeyParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679352865"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352865"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352866"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352866"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A192KW"><span class="hs-identifier hs-var">A192KW</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (AlgWithParams, ByteString))
-&gt; Either Error ByteString
-&gt; Either Error (AlgWithParams, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable AES192 -&gt; ByteString -&gt; Either Error ByteString
forall cipher.
BlockCipher128 cipher =&gt;
CryptoFailable cipher -&gt; ByteString -&gt; Either Error ByteString
</span><a href="Crypto.JOSE.JWE.html#wrapAESKW"><span class="hs-identifier hs-var">wrapAESKW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable AES192
forall cipher key.
(Cipher cipher, ByteArray key) =&gt;
key -&gt; CryptoFailable cipher
forall key. ByteArray key =&gt; key -&gt; CryptoFailable AES192
</span><span class="hs-identifier hs-var">cipherInit</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352865"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES192</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352866"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A256KW"><span class="hs-identifier hs-var">A256KW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyMaterial"><span class="hs-identifier hs-type">OctKeyMaterial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyParameters"><span class="hs-identifier hs-type">OctKeyParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679352868"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352868"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352869"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352869"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A256KW"><span class="hs-identifier hs-var">A256KW</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (AlgWithParams, ByteString))
-&gt; Either Error ByteString
-&gt; Either Error (AlgWithParams, ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable AES256 -&gt; ByteString -&gt; Either Error ByteString
forall cipher.
BlockCipher128 cipher =&gt;
CryptoFailable cipher -&gt; ByteString -&gt; Either Error ByteString
</span><a href="Crypto.JOSE.JWE.html#wrapAESKW"><span class="hs-identifier hs-var">wrapAESKW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable AES256
forall cipher key.
(Cipher cipher, ByteArray key) =&gt;
key -&gt; CryptoFailable cipher
forall key. ByteArray key =&gt; key -&gt; CryptoFailable AES256
</span><span class="hs-identifier hs-var">cipherInit</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352868"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352869"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#A128GCMKW"><span class="hs-identifier hs-type">A128GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352871"><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352871"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352872"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352872"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
</span><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-var">wrapAESGCM</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A128GCMKW"><span class="hs-identifier hs-var">A128GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A128GCM"><span class="hs-identifier hs-var">A128GCM</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352871"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352872"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#A192GCMKW"><span class="hs-identifier hs-type">A192GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352876"><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352876"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352877"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352877"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
</span><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-var">wrapAESGCM</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A192GCMKW"><span class="hs-identifier hs-var">A192GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A192GCM"><span class="hs-identifier hs-var">A192GCM</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352876"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352877"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#A256GCMKW"><span class="hs-identifier hs-type">A256GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352880"><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352880"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352881"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352881"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
</span><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-var">wrapAESGCM</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><a href="Crypto.JOSE.JWA.JWE.html#A256GCMKW"><span class="hs-identifier hs-var">A256GCMKW</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A256GCM"><span class="hs-identifier hs-var">A256GCM</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><a href="#local-6989586621679352880"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352881"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">AlgWithParams
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmNotImplemented"><span class="hs-identifier hs-var">AlgorithmNotImplemented</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679352079"><span class="annot"><a href="Crypto.JOSE.JWE.html#wrapAESKW"><span class="hs-identifier hs-type">wrapAESKW</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BlockCipher128</span></span><span> </span><span class="annot"><a href="#local-6989586621679352079"><span class="hs-identifier hs-type">cipher</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><a href="#local-6989586621679352079"><span class="hs-identifier hs-type">cipher</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ plaintext key (to be encrypted)</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ encrypted key</span></span><span>
</span><span id="line-205"></span><span id="wrapAESKW"><span class="annot"><span class="annottext">wrapAESKW :: forall cipher.
BlockCipher128 cipher =&gt;
CryptoFailable cipher -&gt; ByteString -&gt; Either Error ByteString
</span><a href="Crypto.JOSE.JWE.html#wrapAESKW"><span class="hs-identifier hs-var hs-var">wrapAESKW</span></a></span></span><span> </span><span id="local-6989586621679352888"><span class="annot"><span class="annottext">CryptoFailable cipher
</span><a href="#local-6989586621679352888"><span class="hs-identifier hs-var">cipher</span></a></span></span><span> </span><span id="local-6989586621679352889"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352889"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CryptoFailable cipher
</span><a href="#local-6989586621679352888"><span class="hs-identifier hs-var">cipher</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span id="local-6989586621679352891"><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679352891"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CryptoError -&gt; Error
</span><a href="Crypto.JOSE.Error.html#CryptoError"><span class="hs-identifier hs-var">CryptoError</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679352891"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679352894"><span class="annot"><span class="annottext">cipher
</span><a href="#local-6989586621679352894"><span class="hs-identifier hs-var">cipher'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either Error ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">cipher -&gt; ByteString -&gt; ByteString
forall m c cipher.
(ByteArrayAccess m, ByteArray c, BlockCipher128 cipher) =&gt;
cipher -&gt; m -&gt; c
</span><a href="Crypto.JOSE.AESKW.html#aesKeyWrap"><span class="hs-identifier hs-var">aesKeyWrap</span></a></span><span> </span><span class="annot"><span class="annottext">cipher
</span><a href="#local-6989586621679352894"><span class="hs-identifier hs-var">cipher'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352889"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621679352083"><span class="annot"><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-type">wrapAESGCM</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679352083"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AESGCMParameters"><span class="hs-identifier hs-type">AESGCMParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#Enc"><span class="hs-identifier hs-type">Enc</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#KeyMaterial"><span class="hs-identifier hs-type">KeyMaterial</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352083"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#AlgWithParams"><span class="hs-identifier hs-type">AlgWithParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span id="wrapAESGCM"><span class="annot"><span class="annottext">wrapAESGCM :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
(AESGCMParameters -&gt; AlgWithParams)
-&gt; Enc
-&gt; KeyMaterial
-&gt; ByteString
-&gt; m (Either Error (AlgWithParams, ByteString))
</span><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-var hs-var">wrapAESGCM</span></a></span></span><span> </span><span id="local-6989586621679352906"><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><a href="#local-6989586621679352906"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679352907"><span class="annot"><span class="annottext">Enc
</span><a href="#local-6989586621679352907"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyMaterial"><span class="hs-identifier hs-type">OctKeyMaterial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.JWA.JWK.html#OctKeyParameters"><span class="hs-identifier hs-type">OctKeyParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-type">Types.Base64Octets</span></a></span><span> </span><span id="local-6989586621679352908"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352908"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679352909"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352909"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">((ByteString, ByteString, ByteString)
 -&gt; (AlgWithParams, ByteString))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; Either Error (AlgWithParams, ByteString)
forall a b. (a -&gt; b) -&gt; Either Error a -&gt; Either Error b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679352910"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352910"><span class="hs-identifier hs-var">iv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679352911"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352911"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679352912"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352912"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><a href="#local-6989586621679352906"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base64Octets -&gt; Base64Octets -&gt; AESGCMParameters
</span><a href="Crypto.JOSE.JWA.JWE.html#AESGCMParameters"><span class="hs-identifier hs-var">AESGCMParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Base64Octets
</span><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-var">Types.Base64Octets</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352910"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Base64Octets
</span><a href="Crypto.JOSE.Types.html#Base64Octets"><span class="hs-identifier hs-var">Types.Base64Octets</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352911"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352912"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; Either Error (AlgWithParams, ByteString))
-&gt; m (Either Error (ByteString, ByteString, ByteString))
-&gt; m (Either Error (AlgWithParams, ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Enc
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Enc
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="#local-6989586621679352907"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352908"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352909"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#wrapAESGCM"><span class="hs-identifier hs-var">wrapAESGCM</span></a></span><span> </span><span class="annot"><span class="annottext">AESGCMParameters -&gt; AlgWithParams
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Enc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">KeyMaterial
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (AlgWithParams, ByteString)
 -&gt; m (Either Error (AlgWithParams, ByteString)))
-&gt; Either Error (AlgWithParams, ByteString)
-&gt; m (Either Error (AlgWithParams, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error (AlgWithParams, ByteString))
-&gt; Error -&gt; Either Error (AlgWithParams, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmMismatch"><span class="hs-identifier hs-var">AlgorithmMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot use AESGCMKW with non-Oct key&quot;</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679352090"><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-type">encrypt</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679352090"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.JOSE.JWA.JWE.html#Enc"><span class="hs-identifier hs-type">Enc</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ key</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ message</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ AAD</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-228"></span><span id="encrypt"><span class="annot"><span class="annottext">encrypt :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
Enc
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var hs-var">encrypt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A128CBC_HS256"><span class="hs-identifier hs-var">A128CBC_HS256</span></a></span><span> </span><span id="local-6989586621679352970"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352970"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352971"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352971"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352972"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352972"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352970"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES128
-&gt; SHA256
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e h (m :: * -&gt; *).
(BlockCipher e, HashAlgorithm h, MonadRandom m) =&gt;
e
-&gt; h
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_cbcHmacEnc"><span class="hs-identifier hs-var">_cbcHmacEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES128
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES128</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SHA256
</span><span class="hs-identifier hs-var">SHA256</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352970"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352971"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352972"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A192CBC_HS384"><span class="hs-identifier hs-var">A192CBC_HS384</span></a></span><span> </span><span id="local-6989586621679352977"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352977"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352978"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352978"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352979"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352979"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352977"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES192
-&gt; SHA384
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e h (m :: * -&gt; *).
(BlockCipher e, HashAlgorithm h, MonadRandom m) =&gt;
e
-&gt; h
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_cbcHmacEnc"><span class="hs-identifier hs-var">_cbcHmacEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES192
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES192</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SHA384
</span><span class="hs-identifier hs-var">SHA384</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352977"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352978"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352979"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A256CBC_HS512"><span class="hs-identifier hs-var">A256CBC_HS512</span></a></span><span> </span><span id="local-6989586621679352982"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352982"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352983"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352983"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352984"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352984"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352982"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES256
-&gt; SHA512
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e h (m :: * -&gt; *).
(BlockCipher e, HashAlgorithm h, MonadRandom m) =&gt;
e
-&gt; h
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_cbcHmacEnc"><span class="hs-identifier hs-var">_cbcHmacEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES256
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SHA512
</span><span class="hs-identifier hs-var">SHA512</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352982"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352983"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352984"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A128GCM"><span class="hs-identifier hs-var">A128GCM</span></a></span><span> </span><span id="local-6989586621679352986"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352986"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352987"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352987"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352988"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352988"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352986"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES128
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e (m :: * -&gt; *).
(BlockCipher e, MonadRandom m) =&gt;
e
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_gcmEnc"><span class="hs-identifier hs-var">_gcmEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES128
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES128</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352986"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352987"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352988"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A192GCM"><span class="hs-identifier hs-var">A192GCM</span></a></span><span> </span><span id="local-6989586621679352990"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352990"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352991"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352991"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352992"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352992"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352990"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES192
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e (m :: * -&gt; *).
(BlockCipher e, MonadRandom m) =&gt;
e
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_gcmEnc"><span class="hs-identifier hs-var">_gcmEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES192
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES192</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352990"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352991"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352992"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-243"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">Enc
</span><a href="Crypto.JOSE.JWA.JWE.html#A256GCM"><span class="hs-identifier hs-var">A256GCM</span></a></span><span> </span><span id="local-6989586621679352993"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352993"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679352994"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352994"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679352995"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352995"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352993"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AES256
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall e (m :: * -&gt; *).
(BlockCipher e, MonadRandom m) =&gt;
e
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_gcmEnc"><span class="hs-identifier hs-var">_gcmEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AES256
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AES256</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352993"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352994"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679352995"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#KeySizeTooSmall"><span class="hs-identifier hs-var">KeySizeTooSmall</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#_cbcHmacEnc"><span class="hs-identifier hs-type">_cbcHmacEnc</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679352095"><span class="annot"><a href="#local-6989586621679352095"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679352096"><span class="annot"><a href="#local-6989586621679352096"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679352097"><span class="annot"><a href="#local-6989586621679352097"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockCipher</span></span><span> </span><span class="annot"><a href="#local-6989586621679352095"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashAlgorithm</span></span><span> </span><span class="annot"><a href="#local-6989586621679352096"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679352097"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352095"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352096"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ key</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ message</span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ additional authenticated data</span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352097"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ IV, cipertext and MAC</span></span><span>
</span><span id="line-255"></span><span id="_cbcHmacEnc"><span class="annot"><span class="annottext">_cbcHmacEnc :: forall e h (m :: * -&gt; *).
(BlockCipher e, HashAlgorithm h, MonadRandom m) =&gt;
e
-&gt; h
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_cbcHmacEnc"><span class="hs-identifier hs-var hs-var">_cbcHmacEnc</span></a></span></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">h
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679353013"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353013"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679353014"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353014"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679353015"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353015"><span class="hs-identifier hs-var">aad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679353019"><span class="annot"><span class="annottext">kLen :: Int
</span><a href="#local-6989586621679353019"><span class="hs-identifier hs-var hs-var">kLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353013"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679353021"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353021"><span class="hs-identifier hs-var">eKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353022"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353022"><span class="hs-identifier hs-var">mKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353019"><span class="hs-identifier hs-var">kLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353013"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679353029"><span class="annot"><span class="annottext">aadLen :: ByteString
</span><a href="#local-6989586621679353029"><span class="hs-identifier hs-var hs-var">aadLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.reverse</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Int) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, Maybe Int) -&gt; ByteString)
-&gt; (ByteString, Maybe Int) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Int -&gt; Maybe (Word8, Int)) -&gt; Int -&gt; (ByteString, Maybe Int)
forall a.
Int -&gt; (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; (ByteString, Maybe a)
</span><span class="hs-identifier hs-var">B.unfoldrN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679353033"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8, Int) -&gt; Maybe (Word8, Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353033"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353015"><span class="hs-identifier hs-var">aad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable e
forall cipher key.
(Cipher cipher, ByteArray key) =&gt;
key -&gt; CryptoFailable cipher
forall key. ByteArray key =&gt; key -&gt; CryptoFailable e
</span><span class="hs-identifier hs-var">cipherInit</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353021"><span class="hs-identifier hs-var">eKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmNotImplemented"><span class="hs-identifier hs-var">AlgorithmNotImplemented</span></a></span><span> </span><span class="hs-comment">-- FIXME</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679353034"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353034"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679352095"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621679353035"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353035"><span class="hs-identifier hs-var">iv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m ByteString
forall byteArray. ByteArray byteArray =&gt; Int -&gt; m byteArray
forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><span class="hs-identifier hs-var">getRandomBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (IV e)
forall b c. (ByteArrayAccess b, BlockCipher c) =&gt; b -&gt; Maybe (IV c)
</span><span class="hs-identifier hs-var">makeIV</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353035"><span class="hs-identifier hs-var">iv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Maybe (IV e)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CryptoError -&gt; Error
</span><a href="Crypto.JOSE.Error.html#CryptoError"><span class="hs-identifier hs-var">CryptoError</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier hs-var">CryptoError_IvSizeInvalid</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679353039"><span class="annot"><span class="annottext">IV e
</span><a href="#local-6989586621679353039"><span class="hs-identifier hs-var">iv'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353043"><span class="annot"><span class="annottext">m' :: ByteString
</span><a href="#local-6989586621679353043"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; ByteString -&gt; ByteString
forall byteArray.
ByteArray byteArray =&gt;
Format -&gt; byteArray -&gt; byteArray
</span><span class="hs-identifier hs-var">pad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Format
</span><span class="hs-identifier hs-var">PKCS7</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Int
forall cipher. BlockCipher cipher =&gt; cipher -&gt; Int
</span><span class="hs-identifier hs-var">blockSize</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353034"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353014"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-268"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353050"><span class="annot"><span class="annottext">c :: ByteString
</span><a href="#local-6989586621679353050"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; IV e -&gt; ByteString -&gt; ByteString
forall cipher ba.
(BlockCipher cipher, ByteArray ba) =&gt;
cipher -&gt; IV cipher -&gt; ba -&gt; ba
forall ba. ByteArray ba =&gt; e -&gt; IV e -&gt; ba -&gt; ba
</span><span class="hs-identifier hs-var">cbcEncrypt</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353034"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IV e
</span><a href="#local-6989586621679353039"><span class="hs-identifier hs-var">iv'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353043"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353052"><span class="annot"><span class="annottext">hmacInput :: ByteString
</span><a href="#local-6989586621679353052"><span class="hs-identifier hs-var hs-var">hmacInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353015"><span class="hs-identifier hs-var">aad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353035"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353050"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353029"><span class="hs-identifier hs-var">aadLen</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353073"><span class="annot"><span class="annottext">tag :: ByteString
</span><a href="#local-6989586621679353073"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View (HMAC h) -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">BA.convert</span></span><span> </span><span class="annot"><span class="annottext">(View (HMAC h) -&gt; ByteString) -&gt; View (HMAC h) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HMAC h -&gt; Int -&gt; View (HMAC h)
forall bytes. ByteArrayAccess bytes =&gt; bytes -&gt; Int -&gt; View bytes
</span><span class="hs-identifier hs-var">BA.takeView</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HMAC h
forall key message a.
(ByteArrayAccess key, ByteArrayAccess message, HashAlgorithm a) =&gt;
key -&gt; message -&gt; HMAC a
</span><span class="hs-identifier hs-var">hmac</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353022"><span class="hs-identifier hs-var">mKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353052"><span class="hs-identifier hs-var">hmacInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HMAC</span></span><span> </span><span class="annot"><a href="#local-6989586621679352096"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679353019"><span class="hs-identifier hs-var">kLen</span></a></span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString, ByteString)
-&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353035"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353050"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353073"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Crypto.JOSE.JWE.html#_gcmEnc"><span class="hs-identifier hs-type">_gcmEnc</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679352098"><span class="annot"><a href="#local-6989586621679352098"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679352099"><span class="annot"><a href="#local-6989586621679352099"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BlockCipher</span></span><span> </span><span class="annot"><a href="#local-6989586621679352098"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679352099"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352098"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ key</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ message</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ additional authenticated data</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679352099"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.JOSE.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ IV, tag and ciphertext</span></span><span>
</span><span id="line-280"></span><span id="_gcmEnc"><span class="annot"><span class="annottext">_gcmEnc :: forall e (m :: * -&gt; *).
(BlockCipher e, MonadRandom m) =&gt;
e
-&gt; ByteString
-&gt; ByteString
-&gt; ByteString
-&gt; m (Either Error (ByteString, ByteString, ByteString))
</span><a href="Crypto.JOSE.JWE.html#_gcmEnc"><span class="hs-identifier hs-var hs-var">_gcmEnc</span></a></span></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679353091"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353091"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679353092"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353092"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679353093"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353093"><span class="hs-identifier hs-var">aad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679353094"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353094"><span class="hs-identifier hs-var">iv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m ByteString
forall byteArray. ByteArray byteArray =&gt; Int -&gt; m byteArray
forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><span class="hs-identifier hs-var">getRandomBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable e
forall cipher key.
(Cipher cipher, ByteArray key) =&gt;
key -&gt; CryptoFailable cipher
forall key. ByteArray key =&gt; key -&gt; CryptoFailable e
</span><span class="hs-identifier hs-var">cipherInit</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353091"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmNotImplemented"><span class="hs-identifier hs-var">AlgorithmNotImplemented</span></a></span><span> </span><span class="hs-comment">-- FIXME</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679353095"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353095"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679352098"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AEADMode -&gt; e -&gt; ByteString -&gt; CryptoFailable (AEAD e)
forall cipher iv.
(BlockCipher cipher, ByteArrayAccess iv) =&gt;
AEADMode -&gt; cipher -&gt; iv -&gt; CryptoFailable (AEAD cipher)
forall iv.
ByteArrayAccess iv =&gt;
AEADMode -&gt; e -&gt; iv -&gt; CryptoFailable (AEAD e)
</span><span class="hs-identifier hs-var">aeadInit</span></span><span> </span><span class="annot"><span class="annottext">AEADMode
</span><span class="hs-identifier hs-var">AEAD_GCM</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353095"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353094"><span class="hs-identifier hs-var">iv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="Crypto.JOSE.Error.html#AlgorithmNotImplemented"><span class="hs-identifier hs-var">AlgorithmNotImplemented</span></a></span><span> </span><span class="hs-comment">-- FIXME</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679353098"><span class="annot"><span class="annottext">AEAD e
</span><a href="#local-6989586621679353098"><span class="hs-identifier hs-var">aead</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353102"><span class="annot"><span class="annottext">m' :: ByteString
</span><a href="#local-6989586621679353102"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format -&gt; ByteString -&gt; ByteString
forall byteArray.
ByteArray byteArray =&gt;
Format -&gt; byteArray -&gt; byteArray
</span><span class="hs-identifier hs-var">pad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Format
</span><span class="hs-identifier hs-var">PKCS7</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Format) -&gt; Int -&gt; Format
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Int
forall cipher. BlockCipher cipher =&gt; cipher -&gt; Int
</span><span class="hs-identifier hs-var">blockSize</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679353095"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353092"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679353105"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353105"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679353106"><span class="annot"><span class="annottext">AEAD e
</span><a href="#local-6989586621679353106"><span class="hs-identifier hs-var">aeadFinal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AEAD e -&gt; ByteString -&gt; (ByteString, AEAD e)
forall ba cipher.
ByteArray ba =&gt;
AEAD cipher -&gt; ba -&gt; (ba, AEAD cipher)
</span><span class="hs-identifier hs-var">aeadEncrypt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AEAD e -&gt; ByteString -&gt; AEAD e
forall aad cipher.
ByteArrayAccess aad =&gt;
AEAD cipher -&gt; aad -&gt; AEAD cipher
</span><span class="hs-identifier hs-var">aeadAppendHeader</span></span><span> </span><span class="annot"><span class="annottext">AEAD e
</span><a href="#local-6989586621679353098"><span class="hs-identifier hs-var">aead</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353093"><span class="hs-identifier hs-var">aad</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353102"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679353118"><span class="annot"><span class="annottext">tag :: ByteString
</span><a href="#local-6989586621679353118"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
forall a. ByteArray a =&gt; [Word8] -&gt; a
</span><span class="hs-identifier hs-var">BA.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AuthTag -&gt; [Word8]
forall a. ByteArrayAccess a =&gt; a -&gt; [Word8]
</span><span class="hs-identifier hs-var">BA.unpack</span></span><span> </span><span class="annot"><span class="annottext">(AuthTag -&gt; [Word8]) -&gt; AuthTag -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AEAD e -&gt; Int -&gt; AuthTag
forall cipher. AEAD cipher -&gt; Int -&gt; AuthTag
</span><span class="hs-identifier hs-var">aeadFinalize</span></span><span> </span><span class="annot"><span class="annottext">AEAD e
</span><a href="#local-6989586621679353106"><span class="hs-identifier hs-var">aeadFinal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either Error (ByteString, ByteString, ByteString)
 -&gt; m (Either Error (ByteString, ByteString, ByteString)))
-&gt; Either Error (ByteString, ByteString, ByteString)
-&gt; m (Either Error (ByteString, ByteString, ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString, ByteString)
-&gt; Either Error (ByteString, ByteString, ByteString)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353094"><span class="hs-identifier hs-var">iv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353118"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679353105"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span></pre></body></html>