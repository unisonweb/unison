<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.Store.PKCS8</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Private-Key Information Syntax, aka PKCS #8.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Presents an API similar to &quot;Data.X509.Memory&quot; and &quot;Data.X509.File&quot; but</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- allows to write private keys and provides support for password-based</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- encryption.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Functions to read a private key return an object wrapped in the</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- 'OptProtected' data type.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Functions related to public keys, certificates and CRLs are available from</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &quot;Crypto.Store.X509&quot;.</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Store.PKCS8</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#readKeyFile"><span class="hs-identifier">readKeyFile</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#readKeyFileFromMemory"><span class="hs-identifier">readKeyFileFromMemory</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#pemToKey"><span class="hs-identifier">pemToKey</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeKeyFile"><span class="hs-identifier">writeKeyFile</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeKeyFileToMemory"><span class="hs-identifier">writeKeyFileToMemory</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier">keyToPEM</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFile"><span class="hs-identifier">writeEncryptedKeyFile</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFileToMemory"><span class="hs-identifier">writeEncryptedKeyFileToMemory</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#encryptKeyToPEM"><span class="hs-identifier">encryptKeyToPEM</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Serialization formats</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier">PrivateKeyFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier">FormattedKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Password-based protection</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier">ProtectionPassword</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#emptyNotTerminated"><span class="hs-identifier">emptyNotTerminated</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#fromProtectionPassword"><span class="hs-identifier">fromProtectionPassword</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#toProtectionPassword"><span class="hs-identifier">toProtectionPassword</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier">OptProtected</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#recover"><span class="hs-identifier">recover</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#recoverA"><span class="hs-identifier">recoverA</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reading and writing PEM files</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PEM.html#readPEMs"><span class="hs-identifier">readPEMs</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.PEM.html#writePEMs"><span class="hs-identifier">writePEMs</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Types</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BinaryEncoding</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BitArray</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Encoding</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">convert</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X509</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Number.Serialize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">i2osp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">i2ospOf_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">os2ip</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Curve25519</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X25519</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Curve448</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X448</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.DSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DSA</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.ECC.ECDSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ECDSA</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed448</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed448</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.RSA</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RSA</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html"><span class="hs-identifier">Crypto.Store.ASN1.Generate</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html"><span class="hs-identifier">Crypto.Store.ASN1.Parse</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html"><span class="hs-identifier">Crypto.Store.CMS.Attribute</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html"><span class="hs-identifier">Crypto.Store.CMS.Util</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.Error.html"><span class="hs-identifier">Crypto.Store.Error</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.PEM.html"><span class="hs-identifier">Crypto.Store.PEM</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.html"><span class="hs-identifier">Crypto.Store.PKCS5</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.EC.html"><span class="hs-identifier">Crypto.Store.PKCS8.EC</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.Util.html"><span class="hs-identifier">Crypto.Store.Util</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- | Data type for objects that are possibly protected with a password.</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="OptProtected"><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-var">OptProtected</span></a></span></span><span> </span><span id="local-6989586621679155139"><span class="annot"><a href="#local-6989586621679155139"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Unprotected"><span class="annot"><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679155139"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-83"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ Value is unprotected</span></span><span>
</span><span id="line-84"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="Protected"><span class="annot"><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-var">Protected</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155139"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ Value is protected with a password</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155444"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679155449"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; OptProtected a -&gt; OptProtected b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679155450"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155450"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-type">Unprotected</span></a></span><span> </span><span id="local-6989586621679155451"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155451"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; OptProtected b
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155450"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155451"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679155452"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155452"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-type">Protected</span></a></span><span> </span><span id="local-6989586621679155453"><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155453"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProtectionPassword -&gt; Either StoreError b) -&gt; OptProtected b
forall a.
(ProtectionPassword -&gt; Either StoreError a) -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-var">Protected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Either StoreError a -&gt; Either StoreError b
forall a b. (a -&gt; b) -&gt; Either StoreError a -&gt; Either StoreError b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155452"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Either StoreError a -&gt; Either StoreError b)
-&gt; (ProtectionPassword -&gt; Either StoreError a)
-&gt; ProtectionPassword
-&gt; Either StoreError b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155453"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><span class="hs-comment">-- | Try to recover an 'OptProtected' content using the specified password.</span></span><span>
</span><span id="line-92"></span><span id="local-6989586621679155144"><span class="annot"><a href="Crypto.Store.PKCS8.html#recover"><span class="hs-identifier hs-type">recover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155144"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-93"></span><span id="recover"><span class="annot"><span class="annottext">recover :: forall a.
ProtectionPassword -&gt; OptProtected a -&gt; Either StoreError a
</span><a href="Crypto.Store.PKCS8.html#recover"><span class="hs-identifier hs-var hs-var">recover</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-type">Unprotected</span></a></span><span> </span><span id="local-6989586621679155455"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155455"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either StoreError a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155455"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#recover"><span class="hs-identifier hs-var">recover</span></a></span><span> </span><span id="local-6989586621679155456"><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155456"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-type">Protected</span></a></span><span> </span><span id="local-6989586621679155457"><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155457"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155457"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155456"><span class="hs-identifier hs-var">pwd</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Try to recover an 'OptProtected' content in an applicative context.  The</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- applicative password is used if necessary.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt; import qualified Data.ByteString as B</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt; import           Crypto.Store.PKCS8</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt; [encryptedKey] &lt;- readKeyFile &quot;privkey.pem&quot;</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt; let askForPassword = putStr &quot;Please enter password: &quot; &gt;&gt; B.getLine</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt; result &lt;- recoverA (toProtectionPassword &lt;$&gt; askForPassword) encryptedKey</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &gt; case result of</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt;     Left err  -&gt; putStrLn $ &quot;Unable to recover key: &quot; ++ show err</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;     Right key -&gt; print key</span><span>
</span><span id="line-108"></span><span id="local-6989586621679155148"><span id="local-6989586621679155149"><span class="annot"><a href="Crypto.Store.PKCS8.html#recoverA"><span class="hs-identifier hs-type">recoverA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679155148"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-109"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span>
</span><span id="line-110"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155149"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-111"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155148"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-112"></span><span id="recoverA"><span class="annot"><span class="annottext">recoverA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
f ProtectionPassword -&gt; OptProtected a -&gt; f (Either StoreError a)
</span><a href="Crypto.Store.PKCS8.html#recoverA"><span class="hs-identifier hs-var hs-var">recoverA</span></a></span></span><span> </span><span class="annot"><span class="annottext">f ProtectionPassword
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-type">Unprotected</span></a></span><span> </span><span id="local-6989586621679155463"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155463"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError a -&gt; f (Either StoreError a)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either StoreError a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155463"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#recoverA"><span class="hs-identifier hs-var">recoverA</span></a></span><span> </span><span id="local-6989586621679155464"><span class="annot"><span class="annottext">f ProtectionPassword
</span><a href="#local-6989586621679155464"><span class="hs-identifier hs-var">get</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-type">Protected</span></a></span><span> </span><span id="local-6989586621679155465"><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155465"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProtectionPassword -&gt; Either StoreError a)
-&gt; f ProtectionPassword -&gt; f (Either StoreError a)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword -&gt; Either StoreError a
</span><a href="#local-6989586621679155465"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f ProtectionPassword
</span><a href="#local-6989586621679155464"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Reading from PEM format</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">-- | Read private keys from a PEM file.</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#readKeyFile"><span class="hs-identifier hs-type">readKeyFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span id="readKeyFile"><span class="annot"><span class="annottext">readKeyFile :: FilePath -&gt; IO [OptProtected PrivKey]
</span><a href="Crypto.Store.PKCS8.html#readKeyFile"><span class="hs-identifier hs-var hs-var">readKeyFile</span></a></span></span><span> </span><span id="local-6989586621679155466"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155466"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PEM] -&gt; [OptProtected PrivKey]
</span><a href="Crypto.Store.PKCS8.html#accumulate"><span class="hs-identifier hs-var">accumulate</span></a></span><span> </span><span class="annot"><span class="annottext">([PEM] -&gt; [OptProtected PrivKey])
-&gt; IO [PEM] -&gt; IO [OptProtected PrivKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [PEM]
</span><a href="Crypto.Store.PEM.html#readPEMs"><span class="hs-identifier hs-var">readPEMs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155466"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">-- | Read private keys from a bytearray in PEM format.</span></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#readKeyFileFromMemory"><span class="hs-identifier hs-type">readKeyFileFromMemory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span id="readKeyFileFromMemory"><span class="annot"><span class="annottext">readKeyFileFromMemory :: ByteString -&gt; [OptProtected PrivKey]
</span><a href="Crypto.Store.PKCS8.html#readKeyFileFromMemory"><span class="hs-identifier hs-var hs-var">readKeyFileFromMemory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [OptProtected PrivKey])
-&gt; ([PEM] -&gt; [OptProtected PrivKey])
-&gt; Either FilePath [PEM]
-&gt; [OptProtected PrivKey]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[OptProtected PrivKey] -&gt; FilePath -&gt; [OptProtected PrivKey]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PEM] -&gt; [OptProtected PrivKey]
</span><a href="Crypto.Store.PKCS8.html#accumulate"><span class="hs-identifier hs-var">accumulate</span></a></span><span> </span><span class="annot"><span class="annottext">(Either FilePath [PEM] -&gt; [OptProtected PrivKey])
-&gt; (ByteString -&gt; Either FilePath [PEM])
-&gt; ByteString
-&gt; [OptProtected PrivKey]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either FilePath [PEM]
</span><span class="hs-identifier hs-var">pemParseBS</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#accumulate"><span class="hs-identifier hs-type">accumulate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span id="accumulate"><span class="annot"><span class="annottext">accumulate :: [PEM] -&gt; [OptProtected PrivKey]
</span><a href="Crypto.Store.PKCS8.html#accumulate"><span class="hs-identifier hs-var hs-var">accumulate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (OptProtected PrivKey)] -&gt; [OptProtected PrivKey]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe (OptProtected PrivKey)] -&gt; [OptProtected PrivKey])
-&gt; ([PEM] -&gt; [Maybe (OptProtected PrivKey)])
-&gt; [PEM]
-&gt; [OptProtected PrivKey]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PEM
 -&gt; [Maybe (OptProtected PrivKey)]
 -&gt; [Maybe (OptProtected PrivKey)])
-&gt; [Maybe (OptProtected PrivKey)]
-&gt; [PEM]
-&gt; [Maybe (OptProtected PrivKey)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Maybe (OptProtected PrivKey)]
 -&gt; PEM -&gt; [Maybe (OptProtected PrivKey)])
-&gt; PEM
-&gt; [Maybe (OptProtected PrivKey)]
-&gt; [Maybe (OptProtected PrivKey)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (OptProtected PrivKey)]
-&gt; PEM -&gt; [Maybe (OptProtected PrivKey)]
</span><a href="Crypto.Store.PKCS8.html#pemToKey"><span class="hs-identifier hs-var">pemToKey</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | Read a private key from a 'PEM' element and add it to the accumulator list.</span></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#pemToKey"><span class="hs-identifier hs-type">pemToKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#OptProtected"><span class="hs-identifier hs-type">OptProtected</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span id="pemToKey"><span class="annot"><span class="annottext">pemToKey :: [Maybe (OptProtected PrivKey)]
-&gt; PEM -&gt; [Maybe (OptProtected PrivKey)]
</span><a href="Crypto.Store.PKCS8.html#pemToKey"><span class="hs-identifier hs-var hs-var">pemToKey</span></a></span></span><span> </span><span id="local-6989586621679155476"><span class="annot"><span class="annottext">[Maybe (OptProtected PrivKey)]
</span><a href="#local-6989586621679155476"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679155477"><span class="annot"><span class="annottext">PEM
</span><a href="#local-6989586621679155477"><span class="hs-identifier hs-var">pem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PEM -&gt; ByteString
</span><span class="hs-identifier hs-var">pemContent</span></span><span> </span><span class="annot"><span class="annottext">PEM
</span><a href="#local-6989586621679155477"><span class="hs-identifier hs-var">pem</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Maybe (OptProtected PrivKey)]
</span><a href="#local-6989586621679155476"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679155481"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679155481"><span class="hs-identifier hs-var">asn1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (OptProtected PrivKey)
-&gt; [ASN1] -&gt; Maybe (OptProtected PrivKey)
forall {a}. ParseASN1 () a -&gt; [ASN1] -&gt; Maybe a
</span><a href="#local-6989586621679155482"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 () (OptProtected PrivKey)
</span><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ParseASN1 () (OptProtected PrivKey))
-&gt; FilePath -&gt; ParseASN1 () (OptProtected PrivKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PEM -&gt; FilePath
</span><span class="hs-identifier hs-var">pemName</span></span><span> </span><span class="annot"><span class="annottext">PEM
</span><a href="#local-6989586621679155477"><span class="hs-identifier hs-var">pem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679155481"><span class="hs-identifier hs-var">asn1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (OptProtected PrivKey)
-&gt; [Maybe (OptProtected PrivKey)] -&gt; [Maybe (OptProtected PrivKey)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (OptProtected PrivKey)]
</span><a href="#local-6989586621679155476"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679155482"><span class="annot"><span class="annottext">run :: ParseASN1 () a -&gt; [ASN1] -&gt; Maybe a
</span><a href="#local-6989586621679155482"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679155485"><span class="annot"><span class="annottext">ParseASN1 () a
</span><a href="#local-6989586621679155485"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe a)
-&gt; (a -&gt; Maybe a) -&gt; Either FilePath a -&gt; Maybe a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a -&gt; FilePath -&gt; Maybe a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Either FilePath a -&gt; Maybe a)
-&gt; ([ASN1] -&gt; Either FilePath a) -&gt; [ASN1] -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath a
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath a
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1"><span class="hs-identifier hs-var">runParseASN1</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () a
</span><a href="#local-6989586621679155485"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679155503"><span class="annot"><span class="annottext">allTypes :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155503"><span class="hs-identifier hs-var hs-var">allTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivKey -&gt; PrivKey
forall a. FormattedKey a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-var">unFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(FormattedKey PrivKey -&gt; PrivKey)
-&gt; ParseASN1 () (FormattedKey PrivKey) -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679155514"><span class="annot"><span class="annottext">rsa :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155514"><span class="hs-identifier hs-var hs-var">rsa</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyRSA</span></span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey)
-&gt; (FormattedKey PrivateKey -&gt; PrivateKey)
-&gt; FormattedKey PrivateKey
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivateKey -&gt; PrivateKey
forall a. FormattedKey a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-var">unFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(FormattedKey PrivateKey -&gt; PrivKey)
-&gt; ParseASN1 () (FormattedKey PrivateKey) -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivateKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679155524"><span class="annot"><span class="annottext">dsa :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155524"><span class="hs-identifier hs-var hs-var">dsa</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyDSA</span></span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey)
-&gt; (FormattedKey KeyPair -&gt; PrivateKey)
-&gt; FormattedKey KeyPair
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KeyPair -&gt; PrivateKey
</span><span class="hs-identifier hs-var">DSA.toPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">(KeyPair -&gt; PrivateKey)
-&gt; (FormattedKey KeyPair -&gt; KeyPair)
-&gt; FormattedKey KeyPair
-&gt; PrivateKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FormattedKey KeyPair -&gt; KeyPair
forall a. FormattedKey a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-var">unFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(FormattedKey KeyPair -&gt; PrivKey)
-&gt; ParseASN1 () (FormattedKey KeyPair) -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey KeyPair)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679155535"><span class="annot"><span class="annottext">ecdsa :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155535"><span class="hs-identifier hs-var hs-var">ecdsa</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEC</span></span><span> </span><span class="annot"><span class="annottext">(PrivKeyEC -&gt; PrivKey)
-&gt; (FormattedKey PrivKeyEC -&gt; PrivKeyEC)
-&gt; FormattedKey PrivKeyEC
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivKeyEC -&gt; PrivKeyEC
forall a. FormattedKey a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-var">unFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(FormattedKey PrivKeyEC -&gt; PrivKey)
-&gt; ParseASN1 () (FormattedKey PrivKeyEC) -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKeyEC)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679155542"><span class="annot"><span class="annottext">x25519 :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155542"><span class="hs-identifier hs-var hs-var">x25519</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyX25519</span></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey)
-&gt; ParseASN1 () SecretKey -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () SecretKey
forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var">parseModern</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679155550"><span class="annot"><span class="annottext">x448 :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155550"><span class="hs-identifier hs-var hs-var">x448</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyX448</span></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey)
-&gt; ParseASN1 () SecretKey -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () SecretKey
forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var">parseModern</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679155557"><span class="annot"><span class="annottext">ed25519 :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155557"><span class="hs-identifier hs-var hs-var">ed25519</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEd25519</span></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey)
-&gt; ParseASN1 () SecretKey -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () SecretKey
forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var">parseModern</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679155564"><span class="annot"><span class="annottext">ed448 :: ParseASN1 () PrivKey
</span><a href="#local-6989586621679155564"><span class="hs-identifier hs-var hs-var">ed448</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEd448</span></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey)
-&gt; ParseASN1 () SecretKey -&gt; ParseASN1 () PrivKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () SecretKey
forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var">parseModern</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679155571"><span class="annot"><span class="annottext">encrypted :: ParseASN1 () (ProtectionPassword -&gt; Either StoreError PrivKey)
</span><a href="#local-6989586621679155571"><span class="hs-identifier hs-var hs-var">encrypted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProtectionPassword -&gt; Either StoreError ByteString)
-&gt; ProtectionPassword -&gt; Either StoreError PrivKey
forall {t}.
(t -&gt; Either StoreError ByteString)
-&gt; t -&gt; Either StoreError PrivKey
</span><a href="#local-6989586621679155572"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">((ProtectionPassword -&gt; Either StoreError ByteString)
 -&gt; ProtectionPassword -&gt; Either StoreError PrivKey)
-&gt; (PKCS5 -&gt; ProtectionPassword -&gt; Either StoreError ByteString)
-&gt; PKCS5
-&gt; ProtectionPassword
-&gt; Either StoreError PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PKCS5 -&gt; ProtectionPassword -&gt; Either StoreError ByteString
</span><a href="Crypto.Store.PKCS5.html#decrypt"><span class="hs-identifier hs-var">decrypt</span></a></span><span> </span><span class="annot"><span class="annottext">(PKCS5 -&gt; ProtectionPassword -&gt; Either StoreError PrivKey)
-&gt; ParseASN1 () PKCS5
-&gt; ParseASN1 () (ProtectionPassword -&gt; Either StoreError PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PKCS5
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679155483"><span class="annot"><span class="annottext">getParser :: FilePath -&gt; ParseASN1 () (OptProtected PrivKey)
</span><a href="#local-6989586621679155483"><span class="hs-identifier hs-var hs-var">getParser</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PRIVATE KEY&quot;</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155503"><span class="hs-identifier hs-var">allTypes</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;RSA PRIVATE KEY&quot;</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155514"><span class="hs-identifier hs-var">rsa</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;DSA PRIVATE KEY&quot;</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155524"><span class="hs-identifier hs-var">dsa</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;EC PRIVATE KEY&quot;</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155535"><span class="hs-identifier hs-var">ecdsa</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X25519 PRIVATE KEY&quot;</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155542"><span class="hs-identifier hs-var">x25519</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X448 PRIVATE KEY&quot;</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155550"><span class="hs-identifier hs-var">x448</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ED25519 PRIVATE KEY&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155557"><span class="hs-identifier hs-var">ed25519</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ED448 PRIVATE KEY&quot;</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; OptProtected PrivKey
forall a. a -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Unprotected"><span class="hs-identifier hs-var">Unprotected</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () PrivKey -&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155564"><span class="hs-identifier hs-var">ed448</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ENCRYPTED PRIVATE KEY&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProtectionPassword -&gt; Either StoreError PrivKey)
-&gt; OptProtected PrivKey
forall a.
(ProtectionPassword -&gt; Either StoreError a) -&gt; OptProtected a
</span><a href="Crypto.Store.PKCS8.html#Protected"><span class="hs-identifier hs-var">Protected</span></a></span><span>   </span><span class="annot"><span class="annottext">((ProtectionPassword -&gt; Either StoreError PrivKey)
 -&gt; OptProtected PrivKey)
-&gt; ParseASN1 () (ProtectionPassword -&gt; Either StoreError PrivKey)
-&gt; ParseASN1 () (OptProtected PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (ProtectionPassword -&gt; Either StoreError PrivKey)
</span><a href="#local-6989586621679155571"><span class="hs-identifier hs-var">encrypted</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><a href="#local-6989586621679155483"><span class="hs-identifier hs-var">getParser</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (OptProtected PrivKey)
forall a. ParseASN1 () a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679155572"><span class="annot"><span class="annottext">inner :: (t -&gt; Either StoreError ByteString)
-&gt; t -&gt; Either StoreError PrivKey
</span><a href="#local-6989586621679155572"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span id="local-6989586621679155591"><span class="annot"><span class="annottext">t -&gt; Either StoreError ByteString
</span><a href="#local-6989586621679155591"><span class="hs-identifier hs-var">decfn</span></a></span></span><span> </span><span id="local-6989586621679155592"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679155592"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679155593"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155593"><span class="hs-identifier hs-var">decrypted</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t -&gt; Either StoreError ByteString
</span><a href="#local-6989586621679155591"><span class="hs-identifier hs-var">decfn</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679155592"><span class="hs-identifier hs-var">pwd</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span id="local-6989586621679155594"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679155594"><span class="hs-identifier hs-var">asn1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ASN1Error -&gt; StoreError)
-&gt; Either ASN1Error [ASN1] -&gt; Either StoreError [ASN1]
forall a b c. (a -&gt; b) -&gt; Either a c -&gt; Either b c
</span><a href="Crypto.Store.Util.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; StoreError
</span><a href="Crypto.Store.Error.html#DecodingError"><span class="hs-identifier hs-var">DecodingError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ASN1Error [ASN1] -&gt; Either StoreError [ASN1])
-&gt; Either ASN1Error [ASN1] -&gt; Either StoreError [ASN1]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155593"><span class="hs-identifier hs-var">decrypted</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey -&gt; [ASN1] -&gt; Maybe PrivKey
forall {a}. ParseASN1 () a -&gt; [ASN1] -&gt; Maybe a
</span><a href="#local-6989586621679155482"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivKey
</span><a href="#local-6989586621679155503"><span class="hs-identifier hs-var">allTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679155594"><span class="hs-identifier hs-var">asn1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">Maybe PrivKey
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError PrivKey
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; StoreError
</span><a href="Crypto.Store.Error.html#ParseFailure"><span class="hs-identifier hs-var">ParseFailure</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No key parsed after decryption&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679155598"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155598"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; Either StoreError PrivKey
forall a. a -&gt; Either StoreError a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155598"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Writing to PEM format</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><span class="hs-comment">-- | Write unencrypted private keys to a PEM file.</span></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeKeyFile"><span class="hs-identifier hs-type">writeKeyFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier hs-type">PrivateKeyFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span id="writeKeyFile"><span class="annot"><span class="annottext">writeKeyFile :: PrivateKeyFormat -&gt; FilePath -&gt; [PrivKey] -&gt; IO ()
</span><a href="Crypto.Store.PKCS8.html#writeKeyFile"><span class="hs-identifier hs-var hs-var">writeKeyFile</span></a></span></span><span> </span><span id="local-6989586621679155599"><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155599"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621679155600"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155600"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [PEM] -&gt; IO ()
</span><a href="Crypto.Store.PEM.html#writePEMs"><span class="hs-identifier hs-var">writePEMs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155600"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">([PEM] -&gt; IO ()) -&gt; ([PrivKey] -&gt; [PEM]) -&gt; [PrivKey] -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; PEM) -&gt; [PrivKey] -&gt; [PEM]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier hs-var">keyToPEM</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155599"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><span class="hs-comment">-- | Write unencrypted private keys to a bytearray in PEM format.</span></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeKeyFileToMemory"><span class="hs-identifier hs-type">writeKeyFileToMemory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier hs-type">PrivateKeyFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-176"></span><span id="writeKeyFileToMemory"><span class="annot"><span class="annottext">writeKeyFileToMemory :: PrivateKeyFormat -&gt; [PrivKey] -&gt; ByteString
</span><a href="Crypto.Store.PKCS8.html#writeKeyFileToMemory"><span class="hs-identifier hs-var hs-var">writeKeyFileToMemory</span></a></span></span><span> </span><span id="local-6989586621679155601"><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155601"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PEM] -&gt; ByteString
</span><a href="Crypto.Store.PEM.html#pemsWriteBS"><span class="hs-identifier hs-var">pemsWriteBS</span></a></span><span> </span><span class="annot"><span class="annottext">([PEM] -&gt; ByteString)
-&gt; ([PrivKey] -&gt; [PEM]) -&gt; [PrivKey] -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; PEM) -&gt; [PrivKey] -&gt; [PEM]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier hs-var">keyToPEM</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155601"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Write a PKCS #8 encrypted private key to a PEM file.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- If multiple keys need to be stored in the same file, use functions</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- 'encryptKeyToPEM' and 'writePEMs'.</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Fresh 'EncryptionScheme' parameters should be generated for each key to</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- encrypt.</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFile"><span class="hs-identifier hs-type">writeEncryptedKeyFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-186"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.html#EncryptionScheme"><span class="hs-identifier hs-type">EncryptionScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span>
</span><span id="line-187"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span id="writeEncryptedKeyFile"><span class="annot"><span class="annottext">writeEncryptedKeyFile :: FilePath
-&gt; EncryptionScheme
-&gt; ProtectionPassword
-&gt; PrivKey
-&gt; IO (Either StoreError ())
</span><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFile"><span class="hs-identifier hs-var hs-var">writeEncryptedKeyFile</span></a></span></span><span> </span><span id="local-6989586621679155603"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155603"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679155604"><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155604"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679155605"><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155605"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span id="local-6989586621679155606"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155606"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679155607"><span class="annot"><span class="annottext">pem :: Either StoreError PEM
</span><a href="#local-6989586621679155607"><span class="hs-identifier hs-var hs-var">pem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
-&gt; ProtectionPassword -&gt; PrivKey -&gt; Either StoreError PEM
</span><a href="Crypto.Store.PKCS8.html#encryptKeyToPEM"><span class="hs-identifier hs-var">encryptKeyToPEM</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155604"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155605"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155606"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-190"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(StoreError -&gt; IO (Either StoreError ()))
-&gt; (PEM -&gt; IO (Either StoreError ()))
-&gt; Either StoreError PEM
-&gt; IO (Either StoreError ())
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either StoreError () -&gt; IO (Either StoreError ())
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either StoreError () -&gt; IO (Either StoreError ()))
-&gt; (StoreError -&gt; Either StoreError ())
-&gt; StoreError
-&gt; IO (Either StoreError ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() -&gt; Either StoreError ()) -&gt; IO () -&gt; IO (Either StoreError ())
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either StoreError ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO (Either StoreError ()))
-&gt; (PEM -&gt; IO ()) -&gt; PEM -&gt; IO (Either StoreError ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [PEM] -&gt; IO ()
</span><a href="Crypto.Store.PEM.html#writePEMs"><span class="hs-identifier hs-var">writePEMs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155603"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">([PEM] -&gt; IO ()) -&gt; (PEM -&gt; [PEM]) -&gt; PEM -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PEM -&gt; [PEM] -&gt; [PEM]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either StoreError PEM
</span><a href="#local-6989586621679155607"><span class="hs-identifier hs-var">pem</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Write a PKCS #8 encrypted private key to a bytearray in PEM format.</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- If multiple keys need to be stored in the same bytearray, use functions</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- 'encryptKeyToPEM' and 'pemWriteBS' or 'pemWriteLBS'.</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- Fresh 'EncryptionScheme' parameters should be generated for each key to</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- encrypt.</span><span>
</span><span id="line-199"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFileToMemory"><span class="hs-identifier hs-type">writeEncryptedKeyFileToMemory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.html#EncryptionScheme"><span class="hs-identifier hs-type">EncryptionScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span>
</span><span id="line-200"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-201"></span><span id="writeEncryptedKeyFileToMemory"><span class="annot"><span class="annottext">writeEncryptedKeyFileToMemory :: EncryptionScheme
-&gt; ProtectionPassword -&gt; PrivKey -&gt; Either StoreError ByteString
</span><a href="Crypto.Store.PKCS8.html#writeEncryptedKeyFileToMemory"><span class="hs-identifier hs-var hs-var">writeEncryptedKeyFileToMemory</span></a></span></span><span> </span><span id="local-6989586621679155610"><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155610"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679155611"><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155611"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span id="local-6989586621679155612"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155612"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">PEM -&gt; ByteString
</span><span class="hs-identifier hs-var">pemWriteBS</span></span><span> </span><span class="annot"><span class="annottext">(PEM -&gt; ByteString)
-&gt; Either StoreError PEM -&gt; Either StoreError ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
-&gt; ProtectionPassword -&gt; PrivKey -&gt; Either StoreError PEM
</span><a href="Crypto.Store.PKCS8.html#encryptKeyToPEM"><span class="hs-identifier hs-var">encryptKeyToPEM</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155610"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155611"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155612"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><span class="hs-comment">-- | Generate an unencrypted PEM for a private key.</span></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier hs-type">keyToPEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier hs-type">PrivateKeyFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span>
</span><span id="line-206"></span><span id="keyToPEM"><span class="annot"><span class="annottext">keyToPEM :: PrivateKeyFormat -&gt; PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier hs-var hs-var">keyToPEM</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#TraditionalFormat"><span class="hs-identifier hs-var">TraditionalFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToTraditionalPEM"><span class="hs-identifier hs-var">keyToTraditionalPEM</span></a></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#keyToPEM"><span class="hs-identifier hs-var">keyToPEM</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#PKCS8Format"><span class="hs-identifier hs-var">PKCS8Format</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToModernPEM"><span class="hs-identifier hs-var">keyToModernPEM</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#keyToTraditionalPEM"><span class="hs-identifier hs-type">keyToTraditionalPEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span>
</span><span id="line-210"></span><span id="keyToTraditionalPEM"><span class="annot"><span class="annottext">keyToTraditionalPEM :: PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToTraditionalPEM"><span class="hs-identifier hs-var hs-var">keyToTraditionalPEM</span></a></span></span><span> </span><span id="local-6989586621679155617"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155617"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#mkPEM"><span class="hs-identifier hs-var">mkPEM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155619"><span class="hs-identifier hs-var">typeTag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; PRIVATE KEY&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1PS -&gt; ByteString
</span><a href="Crypto.Store.ASN1.Generate.html#encodeASN1S"><span class="hs-identifier hs-var">encodeASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1PS
</span><a href="#local-6989586621679155621"><span class="hs-identifier hs-var">asn1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155619"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155619"><span class="hs-identifier hs-var">typeTag</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679155621"><span class="annot"><span class="annottext">ASN1PS
</span><a href="#local-6989586621679155621"><span class="hs-identifier hs-var">asn1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; (FilePath, ASN1PS)
forall e. ASN1Elem e =&gt; PrivKey -&gt; (FilePath, ASN1Stream e)
</span><a href="Crypto.Store.PKCS8.html#traditionalPrivKeyASN1S"><span class="hs-identifier hs-var">traditionalPrivKeyASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155617"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679155233"><span class="annot"><a href="Crypto.Store.PKCS8.html#traditionalPrivKeyASN1S"><span class="hs-identifier hs-type">traditionalPrivKeyASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155233"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155233"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span id="traditionalPrivKeyASN1S"><span class="annot"><span class="annottext">traditionalPrivKeyASN1S :: forall e. ASN1Elem e =&gt; PrivKey -&gt; (FilePath, ASN1Stream e)
</span><a href="Crypto.Store.PKCS8.html#traditionalPrivKeyASN1S"><span class="hs-identifier hs-var hs-var">traditionalPrivKeyASN1S</span></a></span></span><span> </span><span id="local-6989586621679155639"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155639"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155639"><span class="hs-identifier hs-var">privKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyRSA</span></span><span> </span><span id="local-6989586621679155640"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155640"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;RSA&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; ASN1Stream e
forall {e} {a}.
ProduceASN1Object e (Traditional a) =&gt;
a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155641"><span class="hs-identifier hs-var">traditional</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155640"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyDSA</span></span><span> </span><span id="local-6989586621679155642"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155642"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;DSA&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeyPair -&gt; ASN1Stream e
forall {e} {a}.
ProduceASN1Object e (Traditional a) =&gt;
a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155641"><span class="hs-identifier hs-var">traditional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; KeyPair
</span><a href="Crypto.Store.PKCS8.html#dsaPrivToPair"><span class="hs-identifier hs-var">dsaPrivToPair</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155642"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span>  </span><span id="local-6989586621679155644"><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679155644"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;EC&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; ASN1Stream e
forall {e} {a}.
ProduceASN1Object e (Traditional a) =&gt;
a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155641"><span class="hs-identifier hs-var">traditional</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679155644"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyX25519</span></span><span>  </span><span id="local-6989586621679155645"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X25519&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">tradModern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155645"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyX448</span></span><span>    </span><span id="local-6989586621679155647"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155647"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X448&quot;</span></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">tradModern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155647"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEd25519</span></span><span> </span><span id="local-6989586621679155648"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155648"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ED25519&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">tradModern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155648"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEd448</span></span><span>   </span><span id="local-6989586621679155649"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155649"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ED448&quot;</span></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var">tradModern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155649"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679155641"><span class="annot"><span class="annottext">traditional :: a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155641"><span class="hs-identifier hs-var hs-var">traditional</span></a></span></span><span> </span><span id="local-6989586621679155652"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155652"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traditional a -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Traditional a
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155652"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679155646"><span class="annot"><span class="annottext">tradModern :: a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155646"><span class="hs-identifier hs-var hs-var">tradModern</span></a></span></span><span> </span><span id="local-6989586621679155657"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155657"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modern a -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; a -&gt; Modern a
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155657"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#keyToModernPEM"><span class="hs-identifier hs-type">keyToModernPEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span>
</span><span id="line-229"></span><span id="keyToModernPEM"><span class="annot"><span class="annottext">keyToModernPEM :: PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToModernPEM"><span class="hs-identifier hs-var hs-var">keyToModernPEM</span></a></span></span><span> </span><span id="local-6989586621679155659"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155659"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#mkPEM"><span class="hs-identifier hs-var">mkPEM</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PRIVATE KEY&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1PS -&gt; ByteString
</span><a href="Crypto.Store.ASN1.Generate.html#encodeASN1S"><span class="hs-identifier hs-var">encodeASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1PS
</span><a href="#local-6989586621679155660"><span class="hs-identifier hs-var">asn1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155660"><span class="annot"><span class="annottext">asn1 :: ASN1PS
</span><a href="#local-6989586621679155660"><span class="hs-identifier hs-var hs-var">asn1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; PrivKey -&gt; ASN1PS
forall e. ASN1Elem e =&gt; [Attribute] -&gt; PrivKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#modernPrivKeyASN1S"><span class="hs-identifier hs-var">modernPrivKeyASN1S</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155659"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621679155252"><span class="annot"><a href="Crypto.Store.PKCS8.html#modernPrivKeyASN1S"><span class="hs-identifier hs-type">modernPrivKeyASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155252"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155252"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-233"></span><span id="modernPrivKeyASN1S"><span class="annot"><span class="annottext">modernPrivKeyASN1S :: forall e. ASN1Elem e =&gt; [Attribute] -&gt; PrivKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#modernPrivKeyASN1S"><span class="hs-identifier hs-var hs-var">modernPrivKeyASN1S</span></a></span></span><span> </span><span id="local-6989586621679155674"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155674"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679155675"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155675"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155675"><span class="hs-identifier hs-var">privKey</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyRSA</span></span><span> </span><span id="local-6989586621679155676"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155676"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155676"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyDSA</span></span><span> </span><span id="local-6989586621679155678"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155678"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyPair -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; KeyPair
</span><a href="Crypto.Store.PKCS8.html#dsaPrivToPair"><span class="hs-identifier hs-var">dsaPrivToPair</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155678"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span>  </span><span id="local-6989586621679155679"><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679155679"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679155679"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyX25519</span></span><span>  </span><span id="local-6989586621679155680"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155680"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155680"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyX448</span></span><span>    </span><span id="local-6989586621679155681"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155681"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155681"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEd25519</span></span><span> </span><span id="local-6989586621679155682"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155682"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155682"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEd448</span></span><span>   </span><span id="local-6989586621679155683"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155683"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall {e} {a}. ProduceASN1Object e (Modern a) =&gt; a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679155683"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679155677"><span class="annot"><span class="annottext">modern :: a -&gt; ASN1Stream e
</span><a href="#local-6989586621679155677"><span class="hs-identifier hs-var hs-var">modern</span></a></span></span><span> </span><span id="local-6989586621679155686"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155686"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modern a -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; a -&gt; Modern a
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155674"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155686"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Generate a PKCS #8 encrypted PEM for a private key.</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Fresh 'EncryptionScheme' parameters should be generated for each key to</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- encrypt.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#encryptKeyToPEM"><span class="hs-identifier hs-type">encryptKeyToPEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.html#EncryptionScheme"><span class="hs-identifier hs-type">EncryptionScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS5.PBES1.html#ProtectionPassword"><span class="hs-identifier hs-type">ProtectionPassword</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span>
</span><span id="line-251"></span><span id="encryptKeyToPEM"><span class="annot"><span class="annottext">encryptKeyToPEM :: EncryptionScheme
-&gt; ProtectionPassword -&gt; PrivKey -&gt; Either StoreError PEM
</span><a href="Crypto.Store.PKCS8.html#encryptKeyToPEM"><span class="hs-identifier hs-var hs-var">encryptKeyToPEM</span></a></span></span><span> </span><span id="local-6989586621679155687"><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155687"><span class="hs-identifier hs-var">alg</span></a></span></span><span> </span><span id="local-6989586621679155688"><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155688"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span id="local-6989586621679155689"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155689"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PKCS5 -&gt; PEM
forall {obj}. ProduceASN1Object ASN1P obj =&gt; obj -&gt; PEM
</span><a href="#local-6989586621679155690"><span class="hs-identifier hs-var">toPEM</span></a></span><span> </span><span class="annot"><span class="annottext">(PKCS5 -&gt; PEM) -&gt; Either StoreError PKCS5 -&gt; Either StoreError PEM
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
-&gt; ProtectionPassword -&gt; ByteString -&gt; Either StoreError PKCS5
</span><a href="Crypto.Store.PKCS5.html#encrypt"><span class="hs-identifier hs-var">encrypt</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptionScheme
</span><a href="#local-6989586621679155687"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ProtectionPassword
</span><a href="#local-6989586621679155688"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155692"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155692"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679155692"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PEM -&gt; ByteString
</span><span class="hs-identifier hs-var">pemContent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivKey -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#keyToModernPEM"><span class="hs-identifier hs-var">keyToModernPEM</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155689"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>        </span><span id="local-6989586621679155690"><span class="annot"><span class="annottext">toPEM :: obj -&gt; PEM
</span><a href="#local-6989586621679155690"><span class="hs-identifier hs-var hs-var">toPEM</span></a></span></span><span> </span><span id="local-6989586621679155695"><span class="annot"><span class="annottext">obj
</span><a href="#local-6989586621679155695"><span class="hs-identifier hs-var">pkcs8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#mkPEM"><span class="hs-identifier hs-var">mkPEM</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ENCRYPTED PRIVATE KEY&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">obj -&gt; ByteString
forall obj. ProduceASN1Object ASN1P obj =&gt; obj -&gt; ByteString
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">obj
</span><a href="#local-6989586621679155695"><span class="hs-identifier hs-var">pkcs8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#mkPEM"><span class="hs-identifier hs-type">mkPEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span>
</span><span id="line-256"></span><span id="mkPEM"><span class="annot"><span class="annottext">mkPEM :: FilePath -&gt; ByteString -&gt; PEM
</span><a href="Crypto.Store.PKCS8.html#mkPEM"><span class="hs-identifier hs-var hs-var">mkPEM</span></a></span></span><span> </span><span id="local-6989586621679155697"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155697"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679155698"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155698"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PEM</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pemName :: FilePath
</span><span class="hs-identifier hs-var">pemName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679155697"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pemHeader :: [(FilePath, ByteString)]
</span><span class="hs-identifier hs-var">pemHeader</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pemContent :: ByteString
</span><span class="hs-identifier hs-var">pemContent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155698"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Private key formats: traditional (SSLeay compatible) and modern (PKCS #8)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Private-key serialization format.</span><span>
</span><span id="line-262"></span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- Encryption in traditional format is not supported currently.</span><span>
</span><span id="line-264"></span><span class="hs-keyword">data</span><span> </span><span id="PrivateKeyFormat"><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier hs-var">PrivateKeyFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TraditionalFormat"><span class="annot"><a href="Crypto.Store.PKCS8.html#TraditionalFormat"><span class="hs-identifier hs-var">TraditionalFormat</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ SSLeay compatible</span></span><span>
</span><span id="line-265"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span id="PKCS8Format"><span class="annot"><a href="Crypto.Store.PKCS8.html#PKCS8Format"><span class="hs-identifier hs-var">PKCS8Format</span></a></span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ PKCS #8</span></span><span>
</span><span id="line-266"></span><span>                      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155701"><span id="local-6989586621679155703"><span id="local-6989586621679155707"><span class="annot"><span class="annottext">Int -&gt; PrivateKeyFormat -&gt; FilePath -&gt; FilePath
[PrivateKeyFormat] -&gt; FilePath -&gt; FilePath
PrivateKeyFormat -&gt; FilePath
(Int -&gt; PrivateKeyFormat -&gt; FilePath -&gt; FilePath)
-&gt; (PrivateKeyFormat -&gt; FilePath)
-&gt; ([PrivateKeyFormat] -&gt; FilePath -&gt; FilePath)
-&gt; Show PrivateKeyFormat
forall a.
(Int -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
$cshowsPrec :: Int -&gt; PrivateKeyFormat -&gt; FilePath -&gt; FilePath
showsPrec :: Int -&gt; PrivateKeyFormat -&gt; FilePath -&gt; FilePath
$cshow :: PrivateKeyFormat -&gt; FilePath
show :: PrivateKeyFormat -&gt; FilePath
$cshowList :: [PrivateKeyFormat] -&gt; FilePath -&gt; FilePath
showList :: [PrivateKeyFormat] -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679155711"><span id="local-6989586621679155713"><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool
(PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool)
-&gt; (PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool)
-&gt; Eq PrivateKeyFormat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool
== :: PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool
$c/= :: PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool
/= :: PrivateKeyFormat -&gt; PrivateKeyFormat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">newtype</span><span> </span><span id="Traditional"><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span></span><span> </span><span id="local-6989586621679155249"><span class="annot"><a href="#local-6989586621679155249"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Traditional"><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unTraditional"><span class="annot"><span class="annottext">forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var hs-var">unTraditional</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679155249"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621679155264"><span id="local-6989586621679155265"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseTraditional"><span class="hs-identifier hs-type">parseTraditional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155264"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155264"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155265"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-271"></span><span id="parseTraditional"><span class="annot"><span class="annottext">parseTraditional :: forall e a. ParseASN1Object e (Traditional a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseTraditional"><span class="hs-identifier hs-var hs-var">parseTraditional</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traditional a -&gt; a
forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var">unTraditional</span></a></span><span> </span><span class="annot"><span class="annottext">(Traditional a -&gt; a)
-&gt; ParseASN1 e (Traditional a) -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional a)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">data</span><span> </span><span id="Modern"><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span></span><span> </span><span id="local-6989586621679155251"><span class="annot"><a href="#local-6989586621679155251"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Modern"><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679155251"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155724"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679155727"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679155728"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155728"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679155729"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155729"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679155730"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155730"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; b -&gt; Modern b
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155729"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155728"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155730"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621679155207"><span id="local-6989586621679155208"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-type">parseModern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155207"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155208"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155207"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155208"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-279"></span><span id="parseModern"><span class="annot"><span class="annottext">parseModern :: forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var hs-var">parseModern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modern a -&gt; a
forall {a}. Modern a -&gt; a
</span><a href="#local-6989586621679155734"><span class="hs-identifier hs-var">unModern</span></a></span><span> </span><span class="annot"><span class="annottext">(Modern a -&gt; a) -&gt; ParseASN1 e (Modern a) -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern a)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155734"><span class="annot"><span class="annottext">unModern :: Modern a -&gt; a
</span><a href="#local-6989586621679155734"><span class="hs-identifier hs-var hs-var">unModern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679155735"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155735"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155735"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | A key associated with format.  Allows to implement 'ASN1Object' instances.</span></span><span>
</span><span id="line-283"></span><span class="hs-keyword">data</span><span> </span><span id="FormattedKey"><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-var">FormattedKey</span></a></span></span><span> </span><span id="local-6989586621679155279"><span class="annot"><a href="#local-6989586621679155279"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FormattedKey"><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-var">FormattedKey</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#PrivateKeyFormat"><span class="hs-identifier hs-type">PrivateKeyFormat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155279"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679155739"><span id="local-6989586621679155745"><span id="local-6989586621679155749"><span class="annot"><span class="annottext">Int -&gt; FormattedKey a -&gt; FilePath -&gt; FilePath
[FormattedKey a] -&gt; FilePath -&gt; FilePath
FormattedKey a -&gt; FilePath
(Int -&gt; FormattedKey a -&gt; FilePath -&gt; FilePath)
-&gt; (FormattedKey a -&gt; FilePath)
-&gt; ([FormattedKey a] -&gt; FilePath -&gt; FilePath)
-&gt; Show (FormattedKey a)
forall a. Show a =&gt; Int -&gt; FormattedKey a -&gt; FilePath -&gt; FilePath
forall a. Show a =&gt; [FormattedKey a] -&gt; FilePath -&gt; FilePath
forall a. Show a =&gt; FormattedKey a -&gt; FilePath
forall a.
(Int -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FormattedKey a -&gt; FilePath -&gt; FilePath
showsPrec :: Int -&gt; FormattedKey a -&gt; FilePath -&gt; FilePath
$cshow :: forall a. Show a =&gt; FormattedKey a -&gt; FilePath
show :: FormattedKey a -&gt; FilePath
$cshowList :: forall a. Show a =&gt; [FormattedKey a] -&gt; FilePath -&gt; FilePath
showList :: [FormattedKey a] -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679155753"><span id="local-6989586621679155757"><span class="annot"><span class="annottext">FormattedKey a -&gt; FormattedKey a -&gt; Bool
(FormattedKey a -&gt; FormattedKey a -&gt; Bool)
-&gt; (FormattedKey a -&gt; FormattedKey a -&gt; Bool)
-&gt; Eq (FormattedKey a)
forall a. Eq a =&gt; FormattedKey a -&gt; FormattedKey a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; FormattedKey a -&gt; FormattedKey a -&gt; Bool
== :: FormattedKey a -&gt; FormattedKey a -&gt; Bool
$c/= :: forall a. Eq a =&gt; FormattedKey a -&gt; FormattedKey a -&gt; Bool
/= :: FormattedKey a -&gt; FormattedKey a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155762"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679155765"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; FormattedKey a -&gt; FormattedKey b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679155766"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155766"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span id="local-6989586621679155767"><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155767"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621679155768"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155768"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; b -&gt; FormattedKey b
forall a. PrivateKeyFormat -&gt; a -&gt; FormattedKey a
</span><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-var">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="#local-6989586621679155767"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679155766"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155768"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155282"><span id="local-6989586621679155283"><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155282"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155282"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155282"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155283"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621679155776"><span class="annot"><span class="annottext">asn1s :: FormattedKey a -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#TraditionalFormat"><span class="hs-identifier hs-var">TraditionalFormat</span></a></span><span> </span><span id="local-6989586621679155777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155777"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Traditional a -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Traditional a
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155777"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#PKCS8Format"><span class="hs-identifier hs-var">PKCS8Format</span></a></span><span> </span><span id="local-6989586621679155778"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155778"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modern a -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; a -&gt; Modern a
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155778"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155190"><span id="local-6989586621679155191"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155190"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155190"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155190"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155190"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679155791"><span class="annot"><span class="annottext">parse :: ParseASN1 e (FormattedKey a)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; FormattedKey a
forall {a}. a -&gt; FormattedKey a
</span><a href="#local-6989586621679155792"><span class="hs-identifier hs-var">modern</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; FormattedKey a)
-&gt; ParseASN1 e a -&gt; ParseASN1 e (FormattedKey a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e a
forall e a. ParseASN1Object e (Modern a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseModern"><span class="hs-identifier hs-var">parseModern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (FormattedKey a)
-&gt; ParseASN1 e (FormattedKey a) -&gt; ParseASN1 e (FormattedKey a)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; FormattedKey a
forall {a}. a -&gt; FormattedKey a
</span><a href="#local-6989586621679155794"><span class="hs-identifier hs-var">traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; FormattedKey a)
-&gt; ParseASN1 e a -&gt; ParseASN1 e (FormattedKey a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e a
forall e a. ParseASN1Object e (Traditional a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseTraditional"><span class="hs-identifier hs-var">parseTraditional</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>        </span><span id="local-6989586621679155794"><span class="annot"><span class="annottext">traditional :: a -&gt; FormattedKey a
</span><a href="#local-6989586621679155794"><span class="hs-identifier hs-var hs-var">traditional</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; a -&gt; FormattedKey a
forall a. PrivateKeyFormat -&gt; a -&gt; FormattedKey a
</span><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-var">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#TraditionalFormat"><span class="hs-identifier hs-var">TraditionalFormat</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621679155792"><span class="annot"><span class="annottext">modern :: a -&gt; FormattedKey a
</span><a href="#local-6989586621679155792"><span class="hs-identifier hs-var hs-var">modern</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat -&gt; a -&gt; FormattedKey a
forall a. PrivateKeyFormat -&gt; a -&gt; FormattedKey a
</span><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-var">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><a href="Crypto.Store.PKCS8.html#PKCS8Format"><span class="hs-identifier hs-var">PKCS8Format</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span id="local-6989586621679155192"><span class="annot"><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-type">unFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155192"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155192"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-300"></span><span id="unFormat"><span class="annot"><span class="annottext">unFormat :: forall a. FormattedKey a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unFormat"><span class="hs-identifier hs-var hs-var">unFormat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKeyFormat
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679155795"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155795"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679155795"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- Private Keys</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679155807"><span class="annot"><span class="annottext">toASN1 :: FormattedKey PrivKey -&gt; ASN1S
</span><a href="#local-6989586621679155807"><span class="hs-identifier hs-var hs-var hs-var hs-var">toASN1</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivKey -&gt; ASN1S
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679155813"><span class="annot"><span class="annottext">fromASN1 :: [ASN1] -&gt; Either FilePath (FormattedKey PrivKey, [ASN1])
</span><a href="#local-6989586621679155813"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromASN1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKey)
-&gt; [ASN1] -&gt; Either FilePath (FormattedKey PrivKey, [ASN1])
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath (a, [ASN1])
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1State"><span class="hs-identifier hs-var">runParseASN1State</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155293"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155293"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155293"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679155819"><span class="annot"><span class="annottext">asn1s :: Traditional PrivKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span id="local-6989586621679155820"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155820"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, ASN1Stream e) -&gt; ASN1Stream e
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, ASN1Stream e) -&gt; ASN1Stream e)
-&gt; (FilePath, ASN1Stream e) -&gt; ASN1Stream e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; (FilePath, ASN1Stream e)
forall e. ASN1Elem e =&gt; PrivKey -&gt; (FilePath, ASN1Stream e)
</span><a href="Crypto.Store.PKCS8.html#traditionalPrivKeyASN1S"><span class="hs-identifier hs-var">traditionalPrivKeyASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155820"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155188"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155188"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155188"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621679155830"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Traditional PrivKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155831"><span class="hs-identifier hs-var">rsa</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155832"><span class="hs-identifier hs-var">dsa</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155833"><span class="hs-identifier hs-var">ecdsa</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>        </span><span id="local-6989586621679155831"><span class="annot"><span class="annottext">rsa :: ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155831"><span class="hs-identifier hs-var hs-var">rsa</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; Traditional PrivKey
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; Traditional PrivKey)
-&gt; (Traditional PrivateKey -&gt; PrivKey)
-&gt; Traditional PrivateKey
-&gt; Traditional PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyRSA</span></span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey)
-&gt; (Traditional PrivateKey -&gt; PrivateKey)
-&gt; Traditional PrivateKey
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Traditional PrivateKey -&gt; PrivateKey
forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var">unTraditional</span></a></span><span> </span><span class="annot"><span class="annottext">(Traditional PrivateKey -&gt; Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivateKey)
-&gt; ParseASN1 e (Traditional PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivateKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-316"></span><span>        </span><span id="local-6989586621679155832"><span class="annot"><span class="annottext">dsa :: ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155832"><span class="hs-identifier hs-var hs-var">dsa</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; Traditional PrivKey
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; Traditional PrivKey)
-&gt; (Traditional KeyPair -&gt; PrivKey)
-&gt; Traditional KeyPair
-&gt; Traditional PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyDSA</span></span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey)
-&gt; (Traditional KeyPair -&gt; PrivateKey)
-&gt; Traditional KeyPair
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KeyPair -&gt; PrivateKey
</span><span class="hs-identifier hs-var">DSA.toPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">(KeyPair -&gt; PrivateKey)
-&gt; (Traditional KeyPair -&gt; KeyPair)
-&gt; Traditional KeyPair
-&gt; PrivateKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Traditional KeyPair -&gt; KeyPair
forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var">unTraditional</span></a></span><span> </span><span class="annot"><span class="annottext">(Traditional KeyPair -&gt; Traditional PrivKey)
-&gt; ParseASN1 e (Traditional KeyPair)
-&gt; ParseASN1 e (Traditional PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional KeyPair)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621679155833"><span class="annot"><span class="annottext">ecdsa :: ParseASN1 e (Traditional PrivKey)
</span><a href="#local-6989586621679155833"><span class="hs-identifier hs-var hs-var">ecdsa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKey -&gt; Traditional PrivKey
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKey -&gt; Traditional PrivKey)
-&gt; (Traditional PrivKeyEC -&gt; PrivKey)
-&gt; Traditional PrivKeyEC
-&gt; Traditional PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEC</span></span><span> </span><span class="annot"><span class="annottext">(PrivKeyEC -&gt; PrivKey)
-&gt; (Traditional PrivKeyEC -&gt; PrivKeyEC)
-&gt; Traditional PrivKeyEC
-&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Traditional PrivKeyEC -&gt; PrivKeyEC
forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var">unTraditional</span></a></span><span> </span><span class="annot"><span class="annottext">(Traditional PrivKeyEC -&gt; Traditional PrivKey)
-&gt; ParseASN1 e (Traditional PrivKeyEC)
-&gt; ParseASN1 e (Traditional PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Traditional PrivKeyEC)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155294"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155294"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155294"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679155849"><span class="annot"><span class="annottext">asn1s :: Modern PrivKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679155850"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155850"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679155851"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155851"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute] -&gt; PrivKey -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; [Attribute] -&gt; PrivKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#modernPrivKeyASN1S"><span class="hs-identifier hs-var">modernPrivKeyASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155850"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679155851"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155189"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155189"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155189"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679155863"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern PrivKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155864"><span class="hs-identifier hs-var">rsa</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155865"><span class="hs-identifier hs-var">dsa</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155866"><span class="hs-identifier hs-var">ecdsa</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155867"><span class="hs-identifier hs-var">x25519</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155868"><span class="hs-identifier hs-var">x448</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155869"><span class="hs-identifier hs-var">ed25519</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKey) -&gt; ParseASN1 e (Modern PrivKey)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155870"><span class="hs-identifier hs-var">ed448</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>        </span><span id="local-6989586621679155864"><span class="annot"><span class="annottext">rsa :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155864"><span class="hs-identifier hs-var hs-var">rsa</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey) -&gt; Modern PrivateKey -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyRSA</span></span><span>  </span><span class="annot"><span class="annottext">(Modern PrivateKey -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivateKey) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivateKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span id="local-6989586621679155865"><span class="annot"><span class="annottext">dsa :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155865"><span class="hs-identifier hs-var hs-var">dsa</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(KeyPair -&gt; PrivKey) -&gt; Modern KeyPair -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyDSA</span></span><span> </span><span class="annot"><span class="annottext">(PrivateKey -&gt; PrivKey)
-&gt; (KeyPair -&gt; PrivateKey) -&gt; KeyPair -&gt; PrivKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KeyPair -&gt; PrivateKey
</span><span class="hs-identifier hs-var">DSA.toPrivateKey</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Modern KeyPair -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern KeyPair) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern KeyPair)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-327"></span><span>        </span><span id="local-6989586621679155866"><span class="annot"><span class="annottext">ecdsa :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155866"><span class="hs-identifier hs-var hs-var">ecdsa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrivKeyEC -&gt; PrivKey) -&gt; Modern PrivKeyEC -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEC</span></span><span> </span><span class="annot"><span class="annottext">(Modern PrivKeyEC -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern PrivKeyEC) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern PrivKeyEC)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621679155867"><span class="annot"><span class="annottext">x25519 :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155867"><span class="hs-identifier hs-var hs-var">x25519</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey) -&gt; Modern SecretKey -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyX25519</span></span><span> </span><span class="annot"><span class="annottext">(Modern SecretKey -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern SecretKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621679155868"><span class="annot"><span class="annottext">x448 :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155868"><span class="hs-identifier hs-var hs-var">x448</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey) -&gt; Modern SecretKey -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyX448</span></span><span> </span><span class="annot"><span class="annottext">(Modern SecretKey -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern SecretKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621679155869"><span class="annot"><span class="annottext">ed25519 :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155869"><span class="hs-identifier hs-var hs-var">ed25519</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey) -&gt; Modern SecretKey -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEd25519</span></span><span> </span><span class="annot"><span class="annottext">(Modern SecretKey -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern SecretKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-331"></span><span>        </span><span id="local-6989586621679155870"><span class="annot"><span class="annottext">ed448 :: ParseASN1 e (Modern PrivKey)
</span><a href="#local-6989586621679155870"><span class="hs-identifier hs-var hs-var">ed448</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; PrivKey) -&gt; Modern SecretKey -&gt; Modern PrivKey
forall a b. (a -&gt; b) -&gt; Modern a -&gt; Modern b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; PrivKey
</span><span class="hs-identifier hs-var">X509.PrivKeyEd448</span></span><span> </span><span class="annot"><span class="annottext">(Modern SecretKey -&gt; Modern PrivKey)
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Modern SecretKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span id="local-6989586621679155303"><span class="annot"><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-type">skipVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155303"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155303"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-334"></span><span id="skipVersion"><span class="annot"><span class="annottext">skipVersion :: forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var hs-var">skipVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679155924"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679155924"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679155924"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679155924"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e ()
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: parsed invalid version: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679155924"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621679155930"><span class="annot"><a href="Crypto.Store.PKCS8.html#skipPublicKey"><span class="hs-identifier hs-type">skipPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155930"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155930"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-340"></span><span id="skipPublicKey"><span class="annot"><span class="annottext">skipPublicKey :: forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipPublicKey"><span class="hs-identifier hs-var hs-var">skipPublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Maybe ByteString) -&gt; ParseASN1 e ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; ParseASN1 e a -&gt; ParseASN1 e b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ByteString
</span><a href="#local-6989586621679155938"><span class="hs-identifier hs-var">parseTaggedPrimitive</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Maybe ByteString)
-&gt; ParseASN1 e (Maybe ByteString) -&gt; ParseASN1 e (Maybe ByteString)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; ParseASN1 e (Maybe ByteString)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679155938"><span class="annot"><span class="annottext">parseTaggedPrimitive :: ParseASN1 e ByteString
</span><a href="#local-6989586621679155938"><span class="hs-identifier hs-var hs-var">parseTaggedPrimitive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679155949"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155949"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ParseASN1 e ByteString
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155949"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679155316"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-type">parseAttrKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155316"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155316"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-344"></span><span id="parseAttrKeys"><span class="annot"><span class="annottext">parseAttrKeys :: forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var hs-var">parseAttrKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679155961"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155961"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679155962"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155962"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e [Attribute]
forall e.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e [Attribute]
</span><a href="Crypto.Store.CMS.Attribute.html#parseAttributes"><span class="hs-identifier hs-var">parseAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipPublicKey"><span class="hs-identifier hs-var">skipPublicKey</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">([Attribute], ByteString) -&gt; ParseASN1 e ([Attribute], ByteString)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679155962"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679155961"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- RSA</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679155973"><span class="annot"><span class="annottext">toASN1 :: FormattedKey PrivateKey -&gt; ASN1S
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toASN1</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivateKey -&gt; ASN1S
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679155978"><span class="annot"><span class="annottext">fromASN1 :: [ASN1] -&gt; Either FilePath (FormattedKey PrivateKey, [ASN1])
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromASN1</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivateKey)
-&gt; [ASN1] -&gt; Either FilePath (FormattedKey PrivateKey, [ASN1])
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath (a, [ASN1])
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1State"><span class="hs-identifier hs-var">runParseASN1State</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivateKey)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155238"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155238"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155238"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679155982"><span class="annot"><span class="annottext">asn1s :: Traditional PrivateKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span id="local-6989586621679155983"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155986"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155987"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155988"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155989"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155990"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155991"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155992"><span class="hs-identifier hs-var">pexp1</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155993"><span class="hs-identifier hs-var">pexp2</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679155994"><span class="hs-identifier hs-var">pcoef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>        </span><span id="local-6989586621679155995"><span class="annot"><span class="annottext">pubKey :: PublicKey
</span><a href="#local-6989586621679155995"><span class="hs-identifier hs-var hs-var">pubKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; PublicKey
</span><span class="hs-identifier hs-var">RSA.private_pub</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621679155986"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679155986"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-364"></span><span>        </span><span id="local-6989586621679155987"><span class="annot"><span class="annottext">n :: ASN1Stream e
</span><a href="#local-6989586621679155987"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PublicKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.public_n</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679155995"><span class="hs-identifier hs-var">pubKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>        </span><span id="local-6989586621679155988"><span class="annot"><span class="annottext">e :: ASN1Stream e
</span><a href="#local-6989586621679155988"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PublicKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.public_e</span></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679155995"><span class="hs-identifier hs-var">pubKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>        </span><span id="local-6989586621679155989"><span class="annot"><span class="annottext">d :: ASN1Stream e
</span><a href="#local-6989586621679155989"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_d</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>        </span><span id="local-6989586621679155990"><span class="annot"><span class="annottext">p1 :: ASN1Stream e
</span><a href="#local-6989586621679155990"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_p</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>        </span><span id="local-6989586621679155991"><span class="annot"><span class="annottext">p2 :: ASN1Stream e
</span><a href="#local-6989586621679155991"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_q</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>        </span><span id="local-6989586621679155992"><span class="annot"><span class="annottext">pexp1 :: ASN1Stream e
</span><a href="#local-6989586621679155992"><span class="hs-identifier hs-var hs-var">pexp1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_dP</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679155993"><span class="annot"><span class="annottext">pexp2 :: ASN1Stream e
</span><a href="#local-6989586621679155993"><span class="hs-identifier hs-var hs-var">pexp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_dQ</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621679155994"><span class="annot"><span class="annottext">pcoef :: ASN1Stream e
</span><a href="#local-6989586621679155994"><span class="hs-identifier hs-var hs-var">pcoef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">RSA.private_qinv</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679155983"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155196"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155196"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155196"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679156050"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Traditional PrivateKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Traditional PrivateKey)
-&gt; ParseASN1 e (Traditional PrivateKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Traditional PrivateKey)
 -&gt; ParseASN1 e (Traditional PrivateKey))
-&gt; ParseASN1 e (Traditional PrivateKey)
-&gt; ParseASN1 e (Traditional PrivateKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156052"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156052"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156053"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156053"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156054"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156054"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156055"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156055"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156056"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156056"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156057"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156057"><span class="hs-identifier hs-var">pexp1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156058"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156058"><span class="hs-identifier hs-var">pexp2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156059"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156059"><span class="hs-identifier hs-var">pcoef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679156060"><span class="annot"><span class="annottext">pubKey :: PublicKey
</span><a href="#local-6989586621679156060"><span class="hs-identifier hs-var hs-var">pubKey</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PublicKey</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">public_size :: Int
</span><a href="#local-6989586621679156062"><span class="hs-identifier hs-var">RSA.public_size</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><span class="hs-identifier hs-var">numBytes</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156052"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-385"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">public_n :: Integer
</span><span class="hs-identifier hs-var">RSA.public_n</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156052"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-386"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">public_e :: Integer
</span><span class="hs-identifier hs-var">RSA.public_e</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156053"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-387"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621679156064"><span class="annot"><span class="annottext">privKey :: PrivateKey
</span><a href="#local-6989586621679156064"><span class="hs-identifier hs-var hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">private_pub :: PublicKey
</span><span class="hs-identifier hs-var">RSA.private_pub</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679156060"><span class="hs-identifier hs-var">pubKey</span></a></span><span>
</span><span id="line-389"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_d :: Integer
</span><span class="hs-identifier hs-var">RSA.private_d</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156054"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-390"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_p :: Integer
</span><span class="hs-identifier hs-var">RSA.private_p</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156055"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-391"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_q :: Integer
</span><span class="hs-identifier hs-var">RSA.private_q</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156056"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-392"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_dP :: Integer
</span><span class="hs-identifier hs-var">RSA.private_dP</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156057"><span class="hs-identifier hs-var">pexp1</span></a></span><span>
</span><span id="line-393"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_dQ :: Integer
</span><span class="hs-identifier hs-var">RSA.private_dQ</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156058"><span class="hs-identifier hs-var">pexp2</span></a></span><span>
</span><span id="line-394"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">private_qinv :: Integer
</span><span class="hs-identifier hs-var">RSA.private_qinv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156059"><span class="hs-identifier hs-var">pcoef</span></a></span><span>
</span><span id="line-395"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">Traditional PrivateKey -&gt; ParseASN1 e (Traditional PrivateKey)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateKey -&gt; Traditional PrivateKey
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156064"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155256"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155256"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155256"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>    </span><span id="local-6989586621679156069"><span class="annot"><span class="annottext">asn1s :: Modern PrivateKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156070"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156070"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156071"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156071"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156072"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156073"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156074"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156075"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>        </span><span id="local-6989586621679156072"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156072"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-403"></span><span>        </span><span id="local-6989586621679156073"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156073"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156079"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
forall e. ASN1Elem e =&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gNull"><span class="hs-identifier hs-var">gNull</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>        </span><span id="local-6989586621679156079"><span class="annot"><span class="annottext">oid :: ASN1Stream e
</span><a href="#local-6989586621679156079"><span class="hs-identifier hs-var hs-var">oid</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">113549</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>        </span><span id="local-6989586621679156074"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156074"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Traditional PrivateKey -&gt; ByteString
forall obj. ProduceASN1Object ASN1P obj =&gt; obj -&gt; ByteString
</span><a href="Crypto.Store.CMS.Util.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">(Traditional PrivateKey -&gt; ByteString)
-&gt; Traditional PrivateKey -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; Traditional PrivateKey
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156071"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>        </span><span id="local-6989586621679156075"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156075"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156070"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155197"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155197"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155197"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RSA.PrivateKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679156122"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern PrivateKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern PrivateKey)
-&gt; ParseASN1 e (Modern PrivateKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern PrivateKey)
 -&gt; ParseASN1 e (Modern PrivateKey))
-&gt; ParseASN1 e (Modern PrivateKey)
-&gt; ParseASN1 e (Modern PrivateKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">ASN1
</span><span class="hs-identifier hs-var">Null</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e ASN1 -&gt; ParseASN1 e ASN1
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e ASN1 -&gt; ParseASN1 e ASN1)
-&gt; ParseASN1 e ASN1 -&gt; ParseASN1 e ASN1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">113549</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-413"></span><span>                    </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156125"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156125"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156126"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156126"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679156128"><span class="annot"><span class="annottext">inner :: Either ASN1Error [ASN1]
</span><a href="#local-6989586621679156128"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156126"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-416"></span><span>            </span><span id="local-6989586621679156131"><span class="annot"><span class="annottext">strError :: ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156131"><span class="hs-identifier hs-var hs-var">strError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Either FilePath b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Either FilePath b)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; Either FilePath b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error decoding inner RSA: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(ASN1Error -&gt; Either FilePath PrivateKey)
-&gt; ([ASN1] -&gt; Either FilePath PrivateKey)
-&gt; Either ASN1Error [ASN1]
-&gt; Either FilePath PrivateKey
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; Either FilePath PrivateKey
forall {b}. ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156131"><span class="hs-identifier hs-var">strError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseASN1 () PrivateKey -&gt; [ASN1] -&gt; Either FilePath PrivateKey
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath a
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1"><span class="hs-identifier hs-var">runParseASN1</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () PrivateKey
forall e a. ParseASN1Object e (Traditional a) =&gt; ParseASN1 e a
</span><a href="Crypto.Store.PKCS8.html#parseTraditional"><span class="hs-identifier hs-var">parseTraditional</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either ASN1Error [ASN1]
</span><a href="#local-6989586621679156128"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-418"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679156132"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156132"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e (Modern PrivateKey)
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error parsing inner RSA: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156132"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679156133"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156133"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modern PrivateKey -&gt; ParseASN1 e (Modern PrivateKey)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; PrivateKey -&gt; Modern PrivateKey
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156125"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156133"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- DSA</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621679156141"><span class="annot"><span class="annottext">toASN1 :: FormattedKey KeyPair -&gt; ASN1S
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toASN1</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormattedKey KeyPair -&gt; ASN1S
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621679156146"><span class="annot"><span class="annottext">fromASN1 :: [ASN1] -&gt; Either FilePath (FormattedKey KeyPair, [ASN1])
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromASN1</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey KeyPair)
-&gt; [ASN1] -&gt; Either FilePath (FormattedKey KeyPair, [ASN1])
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath (a, [ASN1])
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1State"><span class="hs-identifier hs-var">runParseASN1State</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey KeyPair)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155237"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155237"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155237"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679156151"><span class="annot"><span class="annottext">asn1s :: Traditional KeyPair -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span> </span><span id="local-6989586621679156153"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156153"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679156154"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156154"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679156155"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156155"><span class="hs-identifier hs-var">priv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156156"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Params -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#pqgASN1S"><span class="hs-identifier hs-var">pqgASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156153"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156158"><span class="hs-identifier hs-var">pub'</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156159"><span class="hs-identifier hs-var">priv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>        </span><span id="local-6989586621679156156"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156156"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-433"></span><span>        </span><span id="local-6989586621679156158"><span class="annot"><span class="annottext">pub' :: ASN1Stream e
</span><a href="#local-6989586621679156158"><span class="hs-identifier hs-var hs-var">pub'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156154"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-434"></span><span>        </span><span id="local-6989586621679156159"><span class="annot"><span class="annottext">priv' :: ASN1Stream e
</span><a href="#local-6989586621679156159"><span class="hs-identifier hs-var hs-var">priv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156155"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155199"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155199"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155199"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679156182"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Traditional KeyPair)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Traditional KeyPair)
-&gt; ParseASN1 e (Traditional KeyPair)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Traditional KeyPair)
 -&gt; ParseASN1 e (Traditional KeyPair))
-&gt; ParseASN1 e (Traditional KeyPair)
-&gt; ParseASN1 e (Traditional KeyPair)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679156183"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156183"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e Params
forall e. Monoid e =&gt; ParseASN1 e Params
</span><a href="Crypto.Store.PKCS8.html#parsePQG"><span class="hs-identifier hs-var">parsePQG</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156185"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156185"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156186"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156186"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="annottext">Traditional KeyPair -&gt; ParseASN1 e (Traditional KeyPair)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyPair -&gt; Traditional KeyPair
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyPair -&gt; Traditional KeyPair) -&gt; KeyPair -&gt; Traditional KeyPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; Integer -&gt; Integer -&gt; KeyPair
</span><span class="hs-identifier hs-var">DSA.KeyPair</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156183"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156185"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156186"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155255"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155255"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155255"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679156190"><span class="annot"><span class="annottext">asn1s :: Modern KeyPair -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156191"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156191"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span> </span><span id="local-6989586621679156192"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156192"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679156193"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156193"><span class="hs-identifier hs-var">priv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156194"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156195"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156196"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156197"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621679156194"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156194"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-449"></span><span>        </span><span id="local-6989586621679156195"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156195"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156200"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156201"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>        </span><span id="local-6989586621679156200"><span class="annot"><span class="annottext">oid :: ASN1Stream e
</span><a href="#local-6989586621679156200"><span class="hs-identifier hs-var hs-var">oid</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10040</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-451"></span><span>        </span><span id="local-6989586621679156201"><span class="annot"><span class="annottext">pr :: ASN1Stream e
</span><a href="#local-6989586621679156201"><span class="hs-identifier hs-var hs-var">pr</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Params -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#pqgASN1S"><span class="hs-identifier hs-var">pqgASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156192"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>        </span><span id="local-6989586621679156196"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156196"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1PS -&gt; ByteString
</span><a href="Crypto.Store.ASN1.Generate.html#encodeASN1S"><span class="hs-identifier hs-var">encodeASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">(ASN1PS -&gt; ByteString) -&gt; ASN1PS -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1PS
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156193"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621679156197"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156197"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156191"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155200"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155200"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155200"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679156239"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern KeyPair)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern KeyPair) -&gt; ParseASN1 e (Modern KeyPair)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern KeyPair) -&gt; ParseASN1 e (Modern KeyPair))
-&gt; ParseASN1 e (Modern KeyPair) -&gt; ParseASN1 e (Modern KeyPair)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-458"></span><span>        </span><span id="local-6989586621679156240"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156240"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e Params -&gt; ParseASN1 e Params
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e Params -&gt; ParseASN1 e Params)
-&gt; ParseASN1 e Params -&gt; ParseASN1 e Params
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10040</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-460"></span><span>                      </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e Params -&gt; ParseASN1 e Params
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e Params
forall e. Monoid e =&gt; ParseASN1 e Params
</span><a href="Crypto.Store.PKCS8.html#parsePQG"><span class="hs-identifier hs-var">parsePQG</span></a></span><span>
</span><span id="line-461"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156241"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156241"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156242"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156242"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-462"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156242"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-463"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156243"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156243"><span class="hs-identifier hs-var">priv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679156244"><span class="annot"><span class="annottext">pub :: Integer
</span><a href="#local-6989586621679156244"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Integer -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.calculatePublic</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156240"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156243"><span class="hs-identifier hs-var">priv</span></a></span><span>
</span><span id="line-465"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Modern KeyPair -&gt; ParseASN1 e (Modern KeyPair)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; KeyPair -&gt; Modern KeyPair
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156241"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyPair -&gt; Modern KeyPair) -&gt; KeyPair -&gt; Modern KeyPair
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; Integer -&gt; Integer -&gt; KeyPair
</span><span class="hs-identifier hs-var">DSA.KeyPair</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156240"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156244"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156243"><span class="hs-identifier hs-var">priv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e (Modern KeyPair)
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: invalid format when parsing inner DSA&quot;</span></span><span>
</span><span id="line-467"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679156246"><span class="annot"><span class="annottext">ASN1Error
</span><a href="#local-6989586621679156246"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e (Modern KeyPair)
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error parsing inner DSA: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error
</span><a href="#local-6989586621679156246"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span id="local-6989586621679155337"><span class="annot"><a href="Crypto.Store.PKCS8.html#pqgASN1S"><span class="hs-identifier hs-type">pqgASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155337"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155337"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-470"></span><span id="pqgASN1S"><span class="annot"><span class="annottext">pqgASN1S :: forall e. ASN1Elem e =&gt; Params -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#pqgASN1S"><span class="hs-identifier hs-var hs-var">pqgASN1S</span></a></span></span><span> </span><span id="local-6989586621679156248"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156248"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156249"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156250"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156251"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679156249"><span class="annot"><span class="annottext">p :: ASN1Stream e
</span><a href="#local-6989586621679156249"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.params_p</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156248"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>        </span><span id="local-6989586621679156250"><span class="annot"><span class="annottext">q :: ASN1Stream e
</span><a href="#local-6989586621679156250"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.params_q</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156248"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>        </span><span id="local-6989586621679156251"><span class="annot"><span class="annottext">g :: ASN1Stream e
</span><a href="#local-6989586621679156251"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.params_g</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156248"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span id="local-6989586621679155339"><span class="annot"><a href="Crypto.Store.PKCS8.html#parsePQG"><span class="hs-identifier hs-type">parsePQG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155339"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155339"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.Params</span></span></span><span>
</span><span id="line-476"></span><span id="parsePQG"><span class="annot"><span class="annottext">parsePQG :: forall e. Monoid e =&gt; ParseASN1 e Params
</span><a href="Crypto.Store.PKCS8.html#parsePQG"><span class="hs-identifier hs-var hs-var">parsePQG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156269"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156269"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156270"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156270"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156271"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156271"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><span class="annottext">Params -&gt; ParseASN1 e Params
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.Params</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">params_p :: Integer
</span><span class="hs-identifier hs-var">DSA.params_p</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156269"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-481"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">params_q :: Integer
</span><span class="hs-identifier hs-var">DSA.params_q</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156270"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-482"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">params_g :: Integer
</span><span class="hs-identifier hs-var">DSA.params_g</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156271"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-483"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#dsaPrivToPair"><span class="hs-identifier hs-type">dsaPrivToPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.PrivateKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DSA.KeyPair</span></span><span>
</span><span id="line-486"></span><span id="dsaPrivToPair"><span class="annot"><span class="annottext">dsaPrivToPair :: PrivateKey -&gt; KeyPair
</span><a href="Crypto.Store.PKCS8.html#dsaPrivToPair"><span class="hs-identifier hs-var hs-var">dsaPrivToPair</span></a></span></span><span> </span><span id="local-6989586621679156273"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156273"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Integer -&gt; Integer -&gt; KeyPair
</span><span class="hs-identifier hs-var">DSA.KeyPair</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156274"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156275"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156276"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679156275"><span class="annot"><span class="annottext">pub :: Integer
</span><a href="#local-6989586621679156275"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Integer -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.calculatePublic</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679156274"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156276"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621679156274"><span class="annot"><span class="annottext">params :: Params
</span><a href="#local-6989586621679156274"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; Params
</span><span class="hs-identifier hs-var">DSA.private_params</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156273"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span id="local-6989586621679156276"><span class="annot"><span class="annottext">x :: Integer
</span><a href="#local-6989586621679156276"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; Integer
</span><span class="hs-identifier hs-var">DSA.private_x</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679156273"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- ECDSA</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#FormattedKey"><span class="hs-identifier hs-type">FormattedKey</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679156286"><span class="annot"><span class="annottext">toASN1 :: FormattedKey PrivKeyEC -&gt; ASN1S
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toASN1</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormattedKey PrivKeyEC -&gt; ASN1S
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679156291"><span class="annot"><span class="annottext">fromASN1 :: [ASN1] -&gt; Either FilePath (FormattedKey PrivKeyEC, [ASN1])
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromASN1</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKeyEC)
-&gt; [ASN1] -&gt; Either FilePath (FormattedKey PrivKeyEC, [ASN1])
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath (a, [ASN1])
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1State"><span class="hs-identifier hs-var">runParseASN1State</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () (FormattedKey PrivKeyEC)
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155236"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155236"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155236"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621679156295"><span class="annot"><span class="annottext">asn1s :: Traditional PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PrivKeyEC -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Bool -&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEcdsaASN1S"><span class="hs-identifier hs-var">innerEcdsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">(PrivKeyEC -&gt; ASN1Stream e)
-&gt; (Traditional PrivKeyEC -&gt; PrivKeyEC)
-&gt; Traditional PrivKeyEC
-&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Traditional PrivKeyEC -&gt; PrivKeyEC
forall a. Traditional a -&gt; a
</span><a href="Crypto.Store.PKCS8.html#unTraditional"><span class="hs-identifier hs-var">unTraditional</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155203"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155203"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155203"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-type">Traditional</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>    </span><span id="local-6989586621679156303"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Traditional PrivKeyEC)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; Traditional PrivKeyEC
forall a. a -&gt; Traditional a
</span><a href="Crypto.Store.PKCS8.html#Traditional"><span class="hs-identifier hs-var">Traditional</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivKeyEC -&gt; Traditional PrivKeyEC)
-&gt; ParseASN1 e PrivKeyEC -&gt; ParseASN1 e (Traditional PrivKeyEC)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e PrivKeyEC
forall e.
Monoid e =&gt;
Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e PrivKeyEC
</span><a href="Crypto.Store.PKCS8.html#parseInnerEcdsa"><span class="hs-identifier hs-var">parseInnerEcdsa</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155254"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155254"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155254"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679156308"><span class="annot"><span class="annottext">asn1s :: Modern PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156309"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156309"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156310"><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156310"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156311"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156312"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156313"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156314"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>        </span><span id="local-6989586621679156311"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156311"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-508"></span><span>        </span><span id="local-6989586621679156312"><span class="annot"><span class="annottext">f :: ASN1Stream e
</span><a href="#local-6989586621679156312"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156318"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#curveFnASN1S"><span class="hs-identifier hs-var">curveFnASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156310"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>        </span><span id="local-6989586621679156318"><span class="annot"><span class="annottext">oid :: ASN1Stream e
</span><a href="#local-6989586621679156318"><span class="hs-identifier hs-var hs-var">oid</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10045</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-510"></span><span>        </span><span id="local-6989586621679156313"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156313"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1PS -&gt; ByteString
</span><a href="Crypto.Store.ASN1.Generate.html#encodeASN1S"><span class="hs-identifier hs-var">encodeASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1PS
</span><a href="#local-6989586621679156322"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>        </span><span id="local-6989586621679156322"><span class="annot"><span class="annottext">inner :: ASN1PS
</span><a href="#local-6989586621679156322"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PrivKeyEC -&gt; ASN1PS
forall e. ASN1Elem e =&gt; Bool -&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEcdsaASN1S"><span class="hs-identifier hs-var">innerEcdsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156310"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-512"></span><span>        </span><span id="local-6989586621679156314"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156314"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156309"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155204"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155204"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155204"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621679156354"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern PrivKeyEC)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern PrivKeyEC) -&gt; ParseASN1 e (Modern PrivKeyEC)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern PrivKeyEC) -&gt; ParseASN1 e (Modern PrivKeyEC))
-&gt; ParseASN1 e (Modern PrivKeyEC) -&gt; ParseASN1 e (Modern PrivKeyEC)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-516"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-517"></span><span>        </span><span id="local-6989586621679156355"><span class="annot"><span class="annottext">Integer -&gt; PrivKeyEC
</span><a href="#local-6989586621679156355"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Integer -&gt; PrivKeyEC)
 -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC))
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10045</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-519"></span><span>            </span><span class="annot"><span class="annottext">ParseASN1 e (Integer -&gt; PrivKeyEC)
forall e. Monoid e =&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="Crypto.Store.PKCS8.html#parseCurveFn"><span class="hs-identifier hs-var">parseCurveFn</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156357"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156357"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156358"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156358"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679156360"><span class="annot"><span class="annottext">inner :: Either ASN1Error [ASN1]
</span><a href="#local-6989586621679156360"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156358"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-522"></span><span>            </span><span id="local-6989586621679156362"><span class="annot"><span class="annottext">strError :: ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156362"><span class="hs-identifier hs-var hs-var">strError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Either FilePath b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Either FilePath b)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; Either FilePath b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error decoding inner EC: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(ASN1Error -&gt; Either FilePath PrivKeyEC)
-&gt; ([ASN1] -&gt; Either FilePath PrivKeyEC)
-&gt; Either ASN1Error [ASN1]
-&gt; Either FilePath PrivKeyEC
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; Either FilePath PrivKeyEC
forall {b}. ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156362"><span class="hs-identifier hs-var">strError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseASN1 () PrivKeyEC -&gt; [ASN1] -&gt; Either FilePath PrivKeyEC
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath a
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1"><span class="hs-identifier hs-var">runParseASN1</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 () PrivKeyEC -&gt; [ASN1] -&gt; Either FilePath PrivKeyEC)
-&gt; ParseASN1 () PrivKeyEC -&gt; [ASN1] -&gt; Either FilePath PrivKeyEC
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 () PrivKeyEC
forall e.
Monoid e =&gt;
Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e PrivKeyEC
</span><a href="Crypto.Store.PKCS8.html#parseInnerEcdsa"><span class="hs-identifier hs-var">parseInnerEcdsa</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 () PrivKeyEC)
-&gt; Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 () PrivKeyEC
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; PrivKeyEC) -&gt; Maybe (Integer -&gt; PrivKeyEC)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PrivKeyEC
</span><a href="#local-6989586621679156355"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either ASN1Error [ASN1]
</span><a href="#local-6989586621679156360"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-524"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679156363"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156363"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e (Modern PrivKeyEC)
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error parsing inner EC: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156363"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679156364"><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156364"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modern PrivKeyEC -&gt; ParseASN1 e (Modern PrivKeyEC)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; PrivKeyEC -&gt; Modern PrivKeyEC
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156357"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156364"><span class="hs-identifier hs-var">privKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span id="local-6989586621679155345"><span class="annot"><a href="Crypto.Store.PKCS8.html#innerEcdsaASN1S"><span class="hs-identifier hs-type">innerEcdsaASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155345"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155345"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-528"></span><span id="innerEcdsaASN1S"><span class="annot"><span class="annottext">innerEcdsaASN1S :: forall e. ASN1Elem e =&gt; Bool -&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEcdsaASN1S"><span class="hs-identifier hs-var hs-var">innerEcdsaASN1S</span></a></span></span><span> </span><span id="local-6989586621679156368"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679156368"><span class="hs-identifier hs-var">addC</span></a></span></span><span> </span><span id="local-6989586621679156369"><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156369"><span class="hs-identifier hs-var">k</span></a></span></span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679156368"><span class="hs-identifier hs-var">addC</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156370"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156371"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156372"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156373"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156370"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156371"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156373"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>    </span><span id="local-6989586621679156376"><span class="annot"><span class="annottext">curve :: Curve
</span><a href="#local-6989586621679156376"><span class="hs-identifier hs-var hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Curve -&gt; Maybe Curve -&gt; Curve
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Curve
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: invalid EC parameters&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivKeyEC -&gt; Maybe Curve
</span><span class="hs-identifier hs-var">ecPrivKeyCurve</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679156380"><span class="annot"><span class="annottext">bytes :: Int
</span><a href="#local-6989586621679156380"><span class="hs-identifier hs-var hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Curve -&gt; Int
</span><a href="Crypto.Store.PKCS8.EC.html#curveOrderBytes"><span class="hs-identifier hs-var">curveOrderBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Curve
</span><a href="#local-6989586621679156376"><span class="hs-identifier hs-var">curve</span></a></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621679156370"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156370"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679156371"><span class="annot"><span class="annottext">ds :: ASN1Stream e
</span><a href="#local-6989586621679156371"><span class="hs-identifier hs-var hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ByteString
forall ba. ByteArray ba =&gt; Int -&gt; Integer -&gt; ba
</span><span class="hs-identifier hs-var">i2ospOf_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679156380"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivKeyEC -&gt; Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_priv</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span id="local-6989586621679156372"><span class="annot"><span class="annottext">c0 :: ASN1Stream e
</span><a href="#local-6989586621679156372"><span class="hs-identifier hs-var hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivKeyEC -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#curveFnASN1S"><span class="hs-identifier hs-var">curveFnASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679156373"><span class="annot"><span class="annottext">c1 :: ASN1Stream e
</span><a href="#local-6989586621679156373"><span class="hs-identifier hs-var hs-var">c1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156390"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span>    </span><span id="local-6989586621679156390"><span class="annot"><span class="annottext">pub :: ASN1Stream e
</span><a href="#local-6989586621679156390"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; BitArray -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gBitString"><span class="hs-identifier hs-var">gBitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; BitArray
</span><span class="hs-identifier hs-var">toBitArray</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156394"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">X509.SerializedPoint</span></span><span> </span><span id="local-6989586621679156394"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156394"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Curve -&gt; Integer -&gt; SerializedPoint
</span><a href="Crypto.Store.PKCS8.EC.html#getSerializedPoint"><span class="hs-identifier hs-var">getSerializedPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Curve
</span><a href="#local-6989586621679156376"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivKeyEC -&gt; Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_priv</span></span><span> </span><span class="annot"><span class="annottext">PrivKeyEC
</span><a href="#local-6989586621679156369"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span id="local-6989586621679155347"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseInnerEcdsa"><span class="hs-identifier hs-type">parseInnerEcdsa</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155347"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-544"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ECDSA.PrivateNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155347"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span></span><span>
</span><span id="line-546"></span><span id="parseInnerEcdsa"><span class="annot"><span class="annottext">parseInnerEcdsa :: forall e.
Monoid e =&gt;
Maybe (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e PrivKeyEC
</span><a href="Crypto.Store.PKCS8.html#parseInnerEcdsa"><span class="hs-identifier hs-var hs-var">parseInnerEcdsa</span></a></span></span><span> </span><span id="local-6989586621679156417"><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156417"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e PrivKeyEC -&gt; ParseASN1 e PrivKeyEC
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e PrivKeyEC -&gt; ParseASN1 e PrivKeyEC)
-&gt; ParseASN1 e PrivKeyEC -&gt; ParseASN1 e PrivKeyEC
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679156418"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156418"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679156421"><span class="annot"><span class="annottext">d :: Integer
</span><a href="#local-6989586621679156421"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156418"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679156422"><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156422"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Maybe (Integer -&gt; PrivKeyEC))
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Integer -&gt; PrivKeyEC)
forall e. Monoid e =&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="Crypto.Store.PKCS8.html#parseCurveFn"><span class="hs-identifier hs-var">parseCurveFn</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><span class="annottext">Maybe BitArray
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e BitArray -&gt; ParseASN1 e (Maybe BitArray)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e BitArray
</span><a href="#local-6989586621679156424"><span class="hs-identifier hs-var">parsePK</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156417"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
-&gt; Maybe (Integer -&gt; PrivKeyEC) -&gt; Maybe (Integer -&gt; PrivKeyEC)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156422"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; PrivKeyEC)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e PrivKeyEC
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: no curve found in EC private key&quot;</span></span><span>
</span><span id="line-554"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679156425"><span class="annot"><span class="annottext">Integer -&gt; PrivKeyEC
</span><a href="#local-6989586621679156425"><span class="hs-identifier hs-var">getKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrivKeyEC -&gt; ParseASN1 e PrivKeyEC
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; PrivKeyEC
</span><a href="#local-6989586621679156425"><span class="hs-identifier hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156421"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679156424"><span class="annot"><span class="annottext">parsePK :: ParseASN1 e BitArray
</span><a href="#local-6989586621679156424"><span class="hs-identifier hs-var hs-var">parsePK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BitString</span></span><span> </span><span id="local-6989586621679156432"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679156432"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ParseASN1 e BitArray
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679156432"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span id="local-6989586621679155349"><span class="annot"><a href="Crypto.Store.PKCS8.html#curveFnASN1S"><span class="hs-identifier hs-type">curveFnASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155349"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155349"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-559"></span><span id="curveFnASN1S"><span class="annot"><span class="annottext">curveFnASN1S :: forall e. ASN1Elem e =&gt; PrivKeyEC -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#curveFnASN1S"><span class="hs-identifier hs-var hs-var">curveFnASN1S</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC_Named</span></span><span class="hs-special">{</span><span id="local-6989586621679156437"><span id="local-6989586621679156438"><span class="annot"><span class="annottext">Integer
CurveName
privkeyEC_priv :: PrivKeyEC -&gt; Integer
privkeyEC_name :: CurveName
privkeyEC_priv :: Integer
privkeyEC_name :: PrivKeyEC -&gt; CurveName
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurveName -&gt; OID
</span><a href="Crypto.Store.PKCS8.EC.html#curveNameOID"><span class="hs-identifier hs-var">curveNameOID</span></a></span><span> </span><span class="annot"><span class="annottext">CurveName
</span><a href="#local-6989586621679156437"><span class="hs-identifier hs-var">privkeyEC_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span class="annot"><a href="Crypto.Store.PKCS8.html#curveFnASN1S"><span class="hs-identifier hs-var">curveFnASN1S</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC_Prime</span></span><span class="hs-special">{</span><span id="local-6989586621679156442"><span id="local-6989586621679156443"><span id="local-6989586621679156444"><span id="local-6989586621679156445"><span id="local-6989586621679156446"><span id="local-6989586621679156447"><span id="local-6989586621679156448"><span id="local-6989586621679156449"><span class="annot"><span class="annottext">Integer
SerializedPoint
privkeyEC_priv :: PrivKeyEC -&gt; Integer
privkeyEC_priv :: Integer
privkeyEC_a :: Integer
privkeyEC_b :: Integer
privkeyEC_prime :: Integer
privkeyEC_generator :: SerializedPoint
privkeyEC_order :: Integer
privkeyEC_cofactor :: Integer
privkeyEC_seed :: Integer
privkeyEC_a :: PrivKeyEC -&gt; Integer
privkeyEC_b :: PrivKeyEC -&gt; Integer
privkeyEC_prime :: PrivKeyEC -&gt; Integer
privkeyEC_generator :: PrivKeyEC -&gt; SerializedPoint
privkeyEC_order :: PrivKeyEC -&gt; Integer
privkeyEC_cofactor :: PrivKeyEC -&gt; Integer
privkeyEC_seed :: PrivKeyEC -&gt; Integer
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156457"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156458"><span class="hs-identifier hs-var">prime</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156459"><span class="hs-identifier hs-var">abSeed</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156460"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156461"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156462"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">X509.SerializedPoint</span></span><span> </span><span id="local-6989586621679156463"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156463"><span class="hs-identifier hs-var">generator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SerializedPoint
</span><a href="#local-6989586621679156446"><span class="hs-identifier hs-var">privkeyEC_generator</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679156464"><span class="annot"><span class="annottext">bytes :: Int
</span><a href="#local-6989586621679156464"><span class="hs-identifier hs-var hs-var">bytes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
</span><span class="hs-identifier hs-var">numBytes</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156445"><span class="hs-identifier hs-var">privkeyEC_prime</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621679156457"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156457"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span>    </span><span id="local-6989586621679156458"><span class="annot"><span class="annottext">prime :: ASN1Stream e
</span><a href="#local-6989586621679156458"><span class="hs-identifier hs-var hs-var">prime</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156467"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156468"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>    </span><span id="local-6989586621679156467"><span class="annot"><span class="annottext">oid :: ASN1Stream e
</span><a href="#local-6989586621679156467"><span class="hs-identifier hs-var hs-var">oid</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10045</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621679156468"><span class="annot"><span class="annottext">p :: ASN1Stream e
</span><a href="#local-6989586621679156468"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156445"><span class="hs-identifier hs-var">privkeyEC_prime</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679156459"><span class="annot"><span class="annottext">abSeed :: ASN1Stream e
</span><a href="#local-6989586621679156459"><span class="hs-identifier hs-var hs-var">abSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156472"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156473"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156474"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621679156472"><span class="annot"><span class="annottext">a :: ASN1Stream e
</span><a href="#local-6989586621679156472"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ByteString
forall ba. ByteArray ba =&gt; Int -&gt; Integer -&gt; ba
</span><span class="hs-identifier hs-var">i2ospOf_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679156464"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156443"><span class="hs-identifier hs-var">privkeyEC_a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>    </span><span id="local-6989586621679156473"><span class="annot"><span class="annottext">b :: ASN1Stream e
</span><a href="#local-6989586621679156473"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ByteString
forall ba. ByteArray ba =&gt; Int -&gt; Integer -&gt; ba
</span><span class="hs-identifier hs-var">i2ospOf_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679156464"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156444"><span class="hs-identifier hs-var">privkeyEC_b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621679156474"><span class="annot"><span class="annottext">seed :: ASN1Stream e
</span><a href="#local-6989586621679156474"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156449"><span class="hs-identifier hs-var">privkeyEC_seed</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-576"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; BitArray -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gBitString"><span class="hs-identifier hs-var">gBitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; BitArray
</span><span class="hs-identifier hs-var">toBitArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; ByteString
forall ba. ByteArray ba =&gt; Integer -&gt; ba
</span><span class="hs-identifier hs-var">i2osp</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156449"><span class="hs-identifier hs-var">privkeyEC_seed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621679156460"><span class="annot"><span class="annottext">gen :: ASN1Stream e
</span><a href="#local-6989586621679156460"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156463"><span class="hs-identifier hs-var">generator</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621679156461"><span class="annot"><span class="annottext">o :: ASN1Stream e
</span><a href="#local-6989586621679156461"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156447"><span class="hs-identifier hs-var">privkeyEC_order</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621679156462"><span class="annot"><span class="annottext">c :: ASN1Stream e
</span><a href="#local-6989586621679156462"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156448"><span class="hs-identifier hs-var">privkeyEC_cofactor</span></a></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span id="local-6989586621679155351"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseCurveFn"><span class="hs-identifier hs-type">parseCurveFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155351"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155351"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ECDSA.PrivateNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-584"></span><span id="parseCurveFn"><span class="annot"><span class="annottext">parseCurveFn :: forall e. Monoid e =&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="Crypto.Store.PKCS8.html#parseCurveFn"><span class="hs-identifier hs-var hs-var">parseCurveFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156492"><span class="hs-identifier hs-var">parseNamedCurve</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156493"><span class="hs-identifier hs-var">parsePrimeCurve</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621679156492"><span class="annot"><span class="annottext">parseNamedCurve :: ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156492"><span class="hs-identifier hs-var hs-var">parseNamedCurve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span id="local-6989586621679156502"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679156502"><span class="hs-identifier hs-var">oid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-588"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OID -&gt; Maybe CurveName
</span><span class="hs-identifier hs-var">lookupCurveNameByOID</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679156502"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679156504"><span class="annot"><span class="annottext">CurveName
</span><a href="#local-6989586621679156504"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC))
-&gt; (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679156505"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156505"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-590"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC_Named</span></span><span>
</span><span id="line-591"></span><span>                                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">privkeyEC_name :: CurveName
</span><span class="hs-identifier hs-var">X509.privkeyEC_name</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CurveName
</span><a href="#local-6989586621679156504"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-592"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_priv :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_priv</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156505"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-593"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-594"></span><span>            </span><span class="annot"><span class="annottext">Maybe CurveName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: unknown EC curve with OID &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">OID -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679156502"><span class="hs-identifier hs-var">oid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621679156493"><span class="annot"><span class="annottext">parsePrimeCurve :: ParseASN1 e (Integer -&gt; PrivKeyEC)
</span><a href="#local-6989586621679156493"><span class="hs-identifier hs-var hs-var">parsePrimeCurve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Integer -&gt; PrivKeyEC)
 -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC))
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
-&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-598"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-599"></span><span>            </span><span id="local-6989586621679156556"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156556"><span class="hs-identifier hs-var">prime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e Integer -&gt; ParseASN1 e Integer
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e Integer -&gt; ParseASN1 e Integer)
-&gt; ParseASN1 e Integer -&gt; ParseASN1 e Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-600"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10045</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-601"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156557"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156557"><span class="hs-identifier hs-var">prime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-602"></span><span>                </span><span class="annot"><span class="annottext">Integer -&gt; ParseASN1 e Integer
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156557"><span class="hs-identifier hs-var">prime</span></a></span><span>
</span><span id="line-603"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679156558"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156558"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156559"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156559"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156560"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156560"><span class="hs-identifier hs-var">seed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (ByteString, ByteString, Integer)
-&gt; ParseASN1 e (ByteString, ByteString, Integer)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (ByteString, ByteString, Integer)
 -&gt; ParseASN1 e (ByteString, ByteString, Integer))
-&gt; ParseASN1 e (ByteString, ByteString, Integer)
-&gt; ParseASN1 e (ByteString, ByteString, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679156561"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156561"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-605"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679156562"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156562"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-606"></span><span>                </span><span id="local-6989586621679156563"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156563"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e Integer
</span><a href="#local-6989586621679156564"><span class="hs-identifier hs-var">parseOptionalSeed</span></a></span><span>
</span><span id="line-607"></span><span>                </span><span class="annot"><span class="annottext">(ByteString, ByteString, Integer)
-&gt; ParseASN1 e (ByteString, ByteString, Integer)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156561"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156562"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156563"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679156565"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156565"><span class="hs-identifier hs-var">generator</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-609"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156566"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156566"><span class="hs-identifier hs-var">order</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-610"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679156567"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156567"><span class="hs-identifier hs-var">cofactor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-611"></span><span>            </span><span class="annot"><span class="annottext">(Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC))
-&gt; (Integer -&gt; PrivKeyEC) -&gt; ParseASN1 e (Integer -&gt; PrivKeyEC)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679156568"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156568"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-612"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">X509.PrivKeyEC_Prime</span></span><span>
</span><span id="line-613"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">privkeyEC_priv :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_priv</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156568"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-614"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_a :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_a</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156558"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-615"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_b :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_b</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156559"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-616"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_prime :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_prime</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156556"><span class="hs-identifier hs-var">prime</span></a></span><span>
</span><span id="line-617"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_generator :: SerializedPoint
</span><span class="hs-identifier hs-var">X509.privkeyEC_generator</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; SerializedPoint
</span><span class="hs-identifier hs-var">X509.SerializedPoint</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156565"><span class="hs-identifier hs-var">generator</span></a></span><span>
</span><span id="line-618"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_order :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_order</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156566"><span class="hs-identifier hs-var">order</span></a></span><span>
</span><span id="line-619"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_cofactor :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_cofactor</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156567"><span class="hs-identifier hs-var">cofactor</span></a></span><span>
</span><span id="line-620"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">privkeyEC_seed :: Integer
</span><span class="hs-identifier hs-var">X509.privkeyEC_seed</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679156560"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-621"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621679156564"><span class="annot"><span class="annottext">parseOptionalSeed :: ParseASN1 e Integer
</span><a href="#local-6989586621679156564"><span class="hs-identifier hs-var hs-var">parseOptionalSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621679156578"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679156578"><span class="hs-identifier hs-var">seedAvail</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e Bool
forall e. ParseASN1 e Bool
</span><a href="Crypto.Store.ASN1.Parse.html#hasNext"><span class="hs-identifier hs-var">hasNext</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679156578"><span class="hs-identifier hs-var">seedAvail</span></a></span><span>
</span><span id="line-626"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BitString</span></span><span> </span><span id="local-6989586621679156580"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679156580"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-627"></span><span>                    </span><span class="annot"><span class="annottext">Integer -&gt; ParseASN1 e Integer
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Integer) -&gt; ByteString -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ByteString
</span><span class="hs-identifier hs-var">bitArrayGetData</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679156580"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ParseASN1 e Integer
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-comment">-- X25519, X448, Ed25519, Ed448</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155242"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155242"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155242"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X25519.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621679156585"><span class="annot"><span class="annottext">asn1s :: Modern SecretKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156586"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156586"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156587"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156587"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156588"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156589"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156590"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156591"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-636"></span><span>        </span><span id="local-6989586621679156588"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156588"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-637"></span><span>        </span><span id="local-6989586621679156589"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156589"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">110</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>        </span><span id="local-6989586621679156590"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156590"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall e key.
(ASN1Elem e, ByteArrayAccess key) =&gt;
key -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-var">innerEddsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156587"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679156591"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156591"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156586"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155206"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155206"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155206"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X25519.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-642"></span><span>    </span><span id="local-6989586621679156626"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern SecretKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey))
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">110</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseASN1 e ()
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-645"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156627"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156627"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156628"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156628"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; SecretKey -&gt; Modern SecretKey
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156627"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Modern SecretKey)
-&gt; ParseASN1 e SecretKey -&gt; ParseASN1 e (Modern SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; (ByteString -&gt; CryptoFailable SecretKey)
-&gt; ByteString
-&gt; ParseASN1 e SecretKey
forall e key.
Monoid e =&gt;
FilePath
-&gt; (ByteString -&gt; CryptoFailable key)
-&gt; ByteString
-&gt; ParseASN1 e key
</span><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-var">parseInnerEddsa</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X25519&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable SecretKey
forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable SecretKey
</span><span class="hs-identifier hs-var">X25519.secretKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156628"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155241"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155241"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155241"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X448.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621679156634"><span class="annot"><span class="annottext">asn1s :: Modern SecretKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156635"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156635"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156636"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156636"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156637"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156638"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156639"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156640"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-651"></span><span>        </span><span id="local-6989586621679156637"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156637"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-652"></span><span>        </span><span id="local-6989586621679156638"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156638"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">111</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621679156639"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156639"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall e key.
(ASN1Elem e, ByteArrayAccess key) =&gt;
key -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-var">innerEddsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156636"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span id="local-6989586621679156640"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156640"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156635"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155210"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155210"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155210"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">X448.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679156674"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern SecretKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey))
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">111</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseASN1 e ()
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-660"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156675"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156675"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156676"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156676"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-661"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; SecretKey -&gt; Modern SecretKey
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156675"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Modern SecretKey)
-&gt; ParseASN1 e SecretKey -&gt; ParseASN1 e (Modern SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; (ByteString -&gt; CryptoFailable SecretKey)
-&gt; ByteString
-&gt; ParseASN1 e SecretKey
forall e key.
Monoid e =&gt;
FilePath
-&gt; (ByteString -&gt; CryptoFailable key)
-&gt; ByteString
-&gt; ParseASN1 e key
</span><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-var">parseInnerEddsa</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;X448&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable SecretKey
forall bs. ByteArrayAccess bs =&gt; bs -&gt; CryptoFailable SecretKey
</span><span class="hs-identifier hs-var">X448.secretKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156676"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155240"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155240"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155240"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679156681"><span class="annot"><span class="annottext">asn1s :: Modern SecretKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156682"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156682"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156683"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156683"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156684"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156685"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156686"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156687"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-666"></span><span>        </span><span id="local-6989586621679156684"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156684"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-667"></span><span>        </span><span id="local-6989586621679156685"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156685"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">112</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>        </span><span id="local-6989586621679156686"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156686"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall e key.
(ASN1Elem e, ByteArrayAccess key) =&gt;
key -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-var">innerEddsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156683"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span id="local-6989586621679156687"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156687"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156682"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155212"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155212"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155212"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679156721"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern SecretKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey))
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-673"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-674"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">112</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseASN1 e ()
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-675"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156722"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156722"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156723"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156723"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; SecretKey -&gt; Modern SecretKey
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156722"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Modern SecretKey)
-&gt; ParseASN1 e SecretKey -&gt; ParseASN1 e (Modern SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; (ByteString -&gt; CryptoFailable SecretKey)
-&gt; ByteString
-&gt; ParseASN1 e SecretKey
forall e key.
Monoid e =&gt;
FilePath
-&gt; (ByteString -&gt; CryptoFailable key)
-&gt; ByteString
-&gt; ParseASN1 e key
</span><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-var">parseInnerEddsa</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Ed25519&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable SecretKey
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable SecretKey
</span><span class="hs-identifier hs-var">Ed25519.secretKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156723"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155239"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155239"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155239"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed448.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-679"></span><span>    </span><span id="local-6989586621679156728"><span class="annot"><span class="annottext">asn1s :: Modern SecretKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span id="local-6989586621679156729"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156729"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679156730"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156730"><span class="hs-identifier hs-var">privKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156731"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156732"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156733"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679156734"><span class="hs-identifier hs-var">att</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-681"></span><span>        </span><span id="local-6989586621679156731"><span class="annot"><span class="annottext">v :: ASN1Stream e
</span><a href="#local-6989586621679156731"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-682"></span><span>        </span><span id="local-6989586621679156732"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679156732"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">113</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621679156733"><span class="annot"><span class="annottext">bs :: ASN1Stream e
</span><a href="#local-6989586621679156733"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SecretKey -&gt; ASN1Stream e
forall e key.
(ASN1Elem e, ByteArrayAccess key) =&gt;
key -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-var">innerEddsaASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621679156730"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-684"></span><span>        </span><span id="local-6989586621679156734"><span class="annot"><span class="annottext">att :: ASN1Stream e
</span><a href="#local-6989586621679156734"><span class="hs-identifier hs-var hs-var">att</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156729"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679155214"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155214"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155214"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-type">Modern</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed448.SecretKey</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>    </span><span id="local-6989586621679156768"><span class="annot"><span class="annottext">parse :: ParseASN1 e (Modern SecretKey)
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey))
-&gt; ParseASN1 e (Modern SecretKey) -&gt; ParseASN1 e (Modern SecretKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-688"></span><span>        </span><span class="annot"><span class="annottext">ParseASN1 e ()
forall e. Monoid e =&gt; ParseASN1 e ()
</span><a href="Crypto.Store.PKCS8.html#skipVersion"><span class="hs-identifier hs-var">skipVersion</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">101</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">113</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseASN1 e ()
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679156769"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156769"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679156770"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156770"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ([Attribute], ByteString)
forall e. Monoid e =&gt; ParseASN1 e ([Attribute], ByteString)
</span><a href="Crypto.Store.PKCS8.html#parseAttrKeys"><span class="hs-identifier hs-var">parseAttrKeys</span></a></span><span>
</span><span id="line-691"></span><span>        </span><span class="annot"><span class="annottext">[Attribute] -&gt; SecretKey -&gt; Modern SecretKey
forall a. [Attribute] -&gt; a -&gt; Modern a
</span><a href="Crypto.Store.PKCS8.html#Modern"><span class="hs-identifier hs-var">Modern</span></a></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679156769"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(SecretKey -&gt; Modern SecretKey)
-&gt; ParseASN1 e SecretKey -&gt; ParseASN1 e (Modern SecretKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; (ByteString -&gt; CryptoFailable SecretKey)
-&gt; ByteString
-&gt; ParseASN1 e SecretKey
forall e key.
Monoid e =&gt;
FilePath
-&gt; (ByteString -&gt; CryptoFailable key)
-&gt; ByteString
-&gt; ParseASN1 e key
</span><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-var">parseInnerEddsa</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Ed448&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable SecretKey
forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable SecretKey
</span><span class="hs-identifier hs-var">Ed448.secretKey</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156770"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span id="local-6989586621679155378"><span id="local-6989586621679155379"><span class="annot"><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-type">innerEddsaASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155378"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679155379"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679155379"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155378"><span class="hs-identifier hs-type">e</span></a></span></span></span><span>
</span><span id="line-694"></span><span id="innerEddsaASN1S"><span class="annot"><span class="annottext">innerEddsaASN1S :: forall e key.
(ASN1Elem e, ByteArrayAccess key) =&gt;
key -&gt; ASN1Stream e
</span><a href="Crypto.Store.PKCS8.html#innerEddsaASN1S"><span class="hs-identifier hs-var hs-var">innerEddsaASN1S</span></a></span></span><span> </span><span id="local-6989586621679156775"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156775"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1PS -&gt; ByteString
</span><a href="Crypto.Store.ASN1.Generate.html#encodeASN1S"><span class="hs-identifier hs-var">encodeASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1PS
</span><a href="#local-6989586621679156776"><span class="hs-identifier hs-var">inner</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679156776"><span class="annot"><span class="annottext">inner :: ASN1PS
</span><a href="#local-6989586621679156776"><span class="hs-identifier hs-var hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1PS
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">convert</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156775"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span id="local-6989586621679155382"><span id="local-6989586621679155383"><span class="annot"><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-type">parseInnerEddsa</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679155382"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-698"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-699"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailable</span></span><span> </span><span class="annot"><a href="#local-6989586621679155383"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-701"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155382"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679155383"><span class="hs-identifier hs-type">key</span></a></span></span></span><span>
</span><span id="line-702"></span><span id="parseInnerEddsa"><span class="annot"><span class="annottext">parseInnerEddsa :: forall e key.
Monoid e =&gt;
FilePath
-&gt; (ByteString -&gt; CryptoFailable key)
-&gt; ByteString
-&gt; ParseASN1 e key
</span><a href="Crypto.Store.PKCS8.html#parseInnerEddsa"><span class="hs-identifier hs-var hs-var">parseInnerEddsa</span></a></span></span><span> </span><span id="local-6989586621679156783"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156783"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679156784"><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable key
</span><a href="#local-6989586621679156784"><span class="hs-identifier hs-var">buildKey</span></a></span></span><span> </span><span id="local-6989586621679156785"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156785"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(ASN1Error -&gt; Either FilePath key)
-&gt; ([ASN1] -&gt; Either FilePath key)
-&gt; Either ASN1Error [ASN1]
-&gt; Either FilePath key
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; Either FilePath key
forall {b}. ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156786"><span class="hs-identifier hs-var">strError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseASN1 () key -&gt; [ASN1] -&gt; Either FilePath key
forall a. ParseASN1 () a -&gt; [ASN1] -&gt; Either FilePath a
</span><a href="Crypto.Store.ASN1.Parse.html#runParseASN1"><span class="hs-identifier hs-var">runParseASN1</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 () key
</span><a href="#local-6989586621679156787"><span class="hs-identifier hs-var">parser</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BER -&gt; ByteString -&gt; Either ASN1Error [ASN1]
forall a.
ASN1Decoding a =&gt;
a -&gt; ByteString -&gt; Either ASN1Error [ASN1]
</span><span class="hs-identifier hs-var">decodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">BER
</span><span class="hs-identifier hs-var">BER</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156785"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-704"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679156788"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156788"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 e key
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error parsing inner &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156783"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156788"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679156789"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156789"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key -&gt; ParseASN1 e key
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156789"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621679156790"><span class="annot"><span class="annottext">innerMsg :: FilePath
</span><a href="#local-6989586621679156790"><span class="hs-identifier hs-var hs-var">innerMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: error decoding inner &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156783"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679156786"><span class="annot"><span class="annottext">strError :: ASN1Error -&gt; Either FilePath b
</span><a href="#local-6989586621679156786"><span class="hs-identifier hs-var hs-var">strError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Either FilePath b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Either FilePath b)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; Either FilePath b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156790"><span class="hs-identifier hs-var">innerMsg</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (ASN1Error -&gt; FilePath) -&gt; ASN1Error -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Error -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-709"></span><span>    </span><span id="local-6989586621679156787"><span class="annot"><span class="annottext">parser :: ParseASN1 () key
</span><a href="#local-6989586621679156787"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-710"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679156797"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156797"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 () ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-711"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; CryptoFailable key
</span><a href="#local-6989586621679156784"><span class="hs-identifier hs-var">buildKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679156797"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">CryptoPassed</span></span><span> </span><span id="local-6989586621679156799"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156799"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key -&gt; ParseASN1 () key
forall a. a -&gt; ParseASN1 () a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679156799"><span class="hs-identifier hs-var">privKey</span></a></span><span>
</span><span id="line-713"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">CryptoFailed</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>                </span><span class="annot"><span class="annottext">FilePath -&gt; ParseASN1 () key
forall e a. FilePath -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PKCS8: parsed invalid &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679156783"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; secret key&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span></pre></body></html>