<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Crypto.Store.CMS.Enveloped</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Store.CMS.Enveloped</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier">EncryptedKey</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#UserKeyingMaterial"><span class="hs-identifier">UserKeyingMaterial</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier">RecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier">EnvelopedData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier">ProducerOfRI</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier">ConsumerOfRI</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Key Transport recipients</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier">KTRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier">RecipientIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier">IssuerAndSerialNumber</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyTransRecipient"><span class="hs-identifier">forKeyTransRecipient</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyTrans"><span class="hs-identifier">withRecipientKeyTrans</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Key Agreement recipients</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier">KARecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier">OriginatorIdentifierOrKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier">OriginatorPublicKey</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier">RecipientEncryptedKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier">KeyAgreeRecipientIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyAgreeRecipient"><span class="hs-identifier">forKeyAgreeRecipient</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyAgree"><span class="hs-identifier">withRecipientKeyAgree</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Key Encryption Key recipients</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyEncryptionKey"><span class="hs-identifier">KeyEncryptionKey</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier">KEKRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier">KeyIdentifier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier">OtherKeyAttribute</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyRecipient"><span class="hs-identifier">forKeyRecipient</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKey"><span class="hs-identifier">withRecipientKey</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Password recipients</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#Password"><span class="hs-identifier">Password</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier">PasswordRecipientInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forPasswordRecipient"><span class="hs-identifier">forPasswordRecipient</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientPassword"><span class="hs-identifier">withRecipientPassword</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BitArray</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Types</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Time.Types</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadRandom</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html"><span class="hs-identifier">Crypto.Store.ASN1.Generate</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html"><span class="hs-identifier">Crypto.Store.ASN1.Parse</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html"><span class="hs-identifier">Crypto.Store.CMS.Algorithms</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html"><span class="hs-identifier">Crypto.Store.CMS.Attribute</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html"><span class="hs-identifier">Crypto.Store.CMS.Encrypted</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html"><span class="hs-identifier">Crypto.Store.CMS.OriginatorInfo</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html"><span class="hs-identifier">Crypto.Store.CMS.Type</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html"><span class="hs-identifier">Crypto.Store.CMS.Util</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Store.Error.html"><span class="hs-identifier">Crypto.Store.Error</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><span class="hs-comment">-- | Encrypted key.</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">type</span><span> </span><span id="EncryptedKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-var">EncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">-- | User keying material.</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="UserKeyingMaterial"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#UserKeyingMaterial"><span class="hs-identifier hs-var">UserKeyingMaterial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Key used for key encryption.</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">type</span><span> </span><span id="KeyEncryptionKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyEncryptionKey"><span class="hs-identifier hs-var">KeyEncryptionKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | A password stored as a sequence of UTF-8 bytes.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- Some key-derivation functions add restrictions to what characters</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- are supported.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Beware: 'Data.String.fromString' truncates multi-byte characters.</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- If the string may contain non-ASCII characters, prefer instead</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- @'Crypto.Store.PKCS5.fromProtectionPassword' . 'Data.String.fromString'@.</span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="Password"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#Password"><span class="hs-identifier hs-var">Password</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">-- | Union type related to identification of the recipient.</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">data</span><span> </span><span id="RecipientIdentifier"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier hs-var">RecipientIdentifier</span></a></span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="RecipientIASN"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIASN"><span class="hs-identifier hs-var">RecipientIASN</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Issuer and Serial Number</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RecipientSKI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientSKI"><span class="hs-identifier hs-var">RecipientSKI</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Subject Key Identifier</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157069"><span id="local-6989586621679157078"><span id="local-6989586621679157082"><span class="annot"><span class="annottext">Int -&gt; RecipientIdentifier -&gt; ShowS
[RecipientIdentifier] -&gt; ShowS
RecipientIdentifier -&gt; String
(Int -&gt; RecipientIdentifier -&gt; ShowS)
-&gt; (RecipientIdentifier -&gt; String)
-&gt; ([RecipientIdentifier] -&gt; ShowS)
-&gt; Show RecipientIdentifier
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RecipientIdentifier -&gt; ShowS
showsPrec :: Int -&gt; RecipientIdentifier -&gt; ShowS
$cshow :: RecipientIdentifier -&gt; String
show :: RecipientIdentifier -&gt; String
$cshowList :: [RecipientIdentifier] -&gt; ShowS
showList :: [RecipientIdentifier] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157086"><span id="local-6989586621679157092"><span class="annot"><span class="annottext">RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool
(RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool)
-&gt; (RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool)
-&gt; Eq RecipientIdentifier
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool
== :: RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool
$c/= :: RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool
/= :: RecipientIdentifier -&gt; RecipientIdentifier -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156813"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156813"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156813"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier hs-type">RecipientIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679157104"><span class="annot"><span class="annottext">asn1s :: RecipientIdentifier -&gt; ASN1Stream e
</span><a href="#local-6989586621679157104"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIASN"><span class="hs-identifier hs-type">RecipientIASN</span></a></span><span> </span><span id="local-6989586621679157106"><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157106"><span class="hs-identifier hs-var">iasn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157106"><span class="hs-identifier hs-var">iasn</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientSKI"><span class="hs-identifier hs-type">RecipientSKI</span></a></span><span>  </span><span id="local-6989586621679157107"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157107"><span class="hs-identifier hs-var">ski</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157107"><span class="hs-identifier hs-var">ski</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156825"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156825"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156825"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier hs-type">RecipientIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679157122"><span class="annot"><span class="annottext">parse :: ParseASN1 e RecipientIdentifier
</span><a href="#local-6989586621679157122"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientIdentifier
</span><a href="#local-6989586621679157124"><span class="hs-identifier hs-var">parseIASN</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientIdentifier
-&gt; ParseASN1 e RecipientIdentifier
-&gt; ParseASN1 e RecipientIdentifier
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientIdentifier
</span><a href="#local-6989586621679157126"><span class="hs-identifier hs-var">parseSKI</span></a></span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679157124"><span class="annot"><span class="annottext">parseIASN :: ParseASN1 e RecipientIdentifier
</span><a href="#local-6989586621679157124"><span class="hs-identifier hs-var hs-var">parseIASN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#RecipientIASN"><span class="hs-identifier hs-var">RecipientIASN</span></a></span><span> </span><span class="annot"><span class="annottext">(IssuerAndSerialNumber -&gt; RecipientIdentifier)
-&gt; ParseASN1 e IssuerAndSerialNumber
-&gt; ParseASN1 e RecipientIdentifier
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e IssuerAndSerialNumber
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span id="local-6989586621679157126"><span class="annot"><span class="annottext">parseSKI :: ParseASN1 e RecipientIdentifier
</span><a href="#local-6989586621679157126"><span class="hs-identifier hs-var hs-var">parseSKI</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#RecipientSKI"><span class="hs-identifier hs-var">RecipientSKI</span></a></span><span>  </span><span class="annot"><span class="annottext">(ByteString -&gt; RecipientIdentifier)
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e RecipientIdentifier
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-105"></span><span>                </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e ByteString
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ByteString
forall e. Monoid e =&gt; ParseASN1 e ByteString
</span><a href="Crypto.Store.CMS.Util.html#parseOctetStringPrim"><span class="hs-identifier hs-var">parseOctetStringPrim</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#getKTVersion"><span class="hs-identifier hs-type">getKTVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier hs-type">RecipientIdentifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-108"></span><span id="getKTVersion"><span class="annot"><span class="annottext">getKTVersion :: RecipientIdentifier -&gt; Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#getKTVersion"><span class="hs-identifier hs-var hs-var">getKTVersion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIASN"><span class="hs-identifier hs-type">RecipientIASN</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#getKTVersion"><span class="hs-identifier hs-var">getKTVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientSKI"><span class="hs-identifier hs-type">RecipientSKI</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- | Identification of a certificate using the issuer DN and serial number.</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="IssuerAndSerialNumber"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-var">IssuerAndSerialNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IssuerAndSerialNumber"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-var">IssuerAndSerialNumber</span></a></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="iasnIssuer"><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; DistinguishedName
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnIssuer"><span class="hs-identifier hs-var hs-var">iasnIssuer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DistinguishedName</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Distinguished name of the certificate issuer</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="iasnSerial"><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnSerial"><span class="hs-identifier hs-var hs-var">iasnSerial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Issuer-specific certificate serial number</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157145"><span id="local-6989586621679157152"><span id="local-6989586621679157155"><span class="annot"><span class="annottext">Int -&gt; IssuerAndSerialNumber -&gt; ShowS
[IssuerAndSerialNumber] -&gt; ShowS
IssuerAndSerialNumber -&gt; String
(Int -&gt; IssuerAndSerialNumber -&gt; ShowS)
-&gt; (IssuerAndSerialNumber -&gt; String)
-&gt; ([IssuerAndSerialNumber] -&gt; ShowS)
-&gt; Show IssuerAndSerialNumber
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; IssuerAndSerialNumber -&gt; ShowS
showsPrec :: Int -&gt; IssuerAndSerialNumber -&gt; ShowS
$cshow :: IssuerAndSerialNumber -&gt; String
show :: IssuerAndSerialNumber -&gt; String
$cshowList :: [IssuerAndSerialNumber] -&gt; ShowS
showList :: [IssuerAndSerialNumber] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157158"><span id="local-6989586621679157163"><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool
(IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool)
-&gt; (IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool)
-&gt; Eq IssuerAndSerialNumber
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool
== :: IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool
$c/= :: IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool
/= :: IssuerAndSerialNumber -&gt; IssuerAndSerialNumber -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156814"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156814"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156814"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679157171"><span class="annot"><span class="annottext">asn1s :: IssuerAndSerialNumber -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157172"><span id="local-6989586621679157173"><span class="annot"><span class="annottext">Integer
DistinguishedName
iasnIssuer :: IssuerAndSerialNumber -&gt; DistinguishedName
iasnSerial :: IssuerAndSerialNumber -&gt; Integer
iasnIssuer :: DistinguishedName
iasnSerial :: Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnIssuer"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DistinguishedName -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">DistinguishedName
</span><a href="#local-6989586621679157172"><span class="hs-identifier hs-var">iasnIssuer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157173"><span class="hs-identifier hs-var">iasnSerial</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156831"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156831"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156831"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679157191"><span class="annot"><span class="annottext">parse :: ParseASN1 e IssuerAndSerialNumber
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e IssuerAndSerialNumber
-&gt; ParseASN1 e IssuerAndSerialNumber
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e IssuerAndSerialNumber
 -&gt; ParseASN1 e IssuerAndSerialNumber)
-&gt; ParseASN1 e IssuerAndSerialNumber
-&gt; ParseASN1 e IssuerAndSerialNumber
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679157192"><span class="annot"><span class="annottext">DistinguishedName
</span><a href="#local-6989586621679157192"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e DistinguishedName
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679157194"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157194"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; ParseASN1 e IssuerAndSerialNumber
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">iasnIssuer :: DistinguishedName
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnIssuer"><span class="hs-identifier hs-var">iasnIssuer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistinguishedName
</span><a href="#local-6989586621679157192"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-129"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">iasnSerial :: Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnSerial"><span class="hs-identifier hs-var">iasnSerial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157194"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-130"></span><span>                                     </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#idEcPublicKey"><span class="hs-identifier hs-type">idEcPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span>
</span><span id="line-133"></span><span id="idEcPublicKey"><span class="annot"><span class="annottext">idEcPublicKey :: OID
</span><a href="Crypto.Store.CMS.Enveloped.html#idEcPublicKey"><span class="hs-identifier hs-var hs-var">idEcPublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">840</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10045</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Originator public key used for key-agreement.  Contrary to 'PubKey' the</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- domain parameters are not used and may be left empty.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">data</span><span> </span><span id="OriginatorPublicKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier hs-var">OriginatorPublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OriginatorPublicKeyEC"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKeyEC"><span class="hs-identifier hs-var">OriginatorPublicKeyEC</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BitArray</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157199"><span id="local-6989586621679157207"><span id="local-6989586621679157211"><span class="annot"><span class="annottext">Int -&gt; OriginatorPublicKey -&gt; ShowS
[OriginatorPublicKey] -&gt; ShowS
OriginatorPublicKey -&gt; String
(Int -&gt; OriginatorPublicKey -&gt; ShowS)
-&gt; (OriginatorPublicKey -&gt; String)
-&gt; ([OriginatorPublicKey] -&gt; ShowS)
-&gt; Show OriginatorPublicKey
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; OriginatorPublicKey -&gt; ShowS
showsPrec :: Int -&gt; OriginatorPublicKey -&gt; ShowS
$cshow :: OriginatorPublicKey -&gt; String
show :: OriginatorPublicKey -&gt; String
$cshowList :: [OriginatorPublicKey] -&gt; ShowS
showList :: [OriginatorPublicKey] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157215"><span id="local-6989586621679157222"><span class="annot"><span class="annottext">OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool
(OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool)
-&gt; (OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool)
-&gt; Eq OriginatorPublicKey
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool
== :: OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool
$c/= :: OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool
/= :: OriginatorPublicKey -&gt; OriginatorPublicKey -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679156861"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#originatorPublicKeyASN1S"><span class="hs-identifier hs-type">originatorPublicKeyASN1S</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156861"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-141"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1ConstructionType</span></span><span>
</span><span id="line-142"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier hs-type">OriginatorPublicKey</span></a></span><span>
</span><span id="line-143"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Stream"><span class="hs-identifier hs-type">ASN1Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156861"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-144"></span><span id="originatorPublicKeyASN1S"><span class="annot"><span class="annottext">originatorPublicKeyASN1S :: forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; OriginatorPublicKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Enveloped.html#originatorPublicKeyASN1S"><span class="hs-identifier hs-var hs-var">originatorPublicKeyASN1S</span></a></span></span><span> </span><span id="local-6989586621679157230"><span class="annot"><span class="annottext">ASN1ConstructionType
</span><a href="#local-6989586621679157230"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKeyEC"><span class="hs-identifier hs-type">OriginatorPublicKeyEC</span></a></span><span> </span><span id="local-6989586621679157231"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157231"><span class="hs-identifier hs-var">asn1</span></a></span></span><span> </span><span id="local-6989586621679157232"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679157232"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><a href="#local-6989586621679157230"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157233"><span class="hs-identifier hs-var">alg</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; BitArray -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gBitString"><span class="hs-identifier hs-var">gBitString</span></a></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679157232"><span class="hs-identifier hs-var">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679157233"><span class="annot"><span class="annottext">alg :: ASN1Stream e
</span><a href="#local-6989586621679157233"><span class="hs-identifier hs-var hs-var">alg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="Crypto.Store.CMS.Enveloped.html#idEcPublicKey"><span class="hs-identifier hs-var">idEcPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ASN1] -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; [ASN1] -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gMany"><span class="hs-identifier hs-var">gMany</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157231"><span class="hs-identifier hs-var">asn1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679156865"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#parseOriginatorPublicKey"><span class="hs-identifier hs-type">parseOriginatorPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156865"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-150"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ASN1ConstructionType</span></span><span>
</span><span id="line-151"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Parse.html#ParseASN1"><span class="hs-identifier hs-type">ParseASN1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156865"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier hs-type">OriginatorPublicKey</span></a></span></span><span>
</span><span id="line-152"></span><span id="parseOriginatorPublicKey"><span class="annot"><span class="annottext">parseOriginatorPublicKey :: forall e.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e OriginatorPublicKey
</span><a href="Crypto.Store.CMS.Enveloped.html#parseOriginatorPublicKey"><span class="hs-identifier hs-var hs-var">parseOriginatorPublicKey</span></a></span></span><span> </span><span id="local-6989586621679157256"><span class="annot"><span class="annottext">ASN1ConstructionType
</span><a href="#local-6989586621679157256"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e OriginatorPublicKey
-&gt; ParseASN1 e OriginatorPublicKey
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><a href="#local-6989586621679157256"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e OriginatorPublicKey
 -&gt; ParseASN1 e OriginatorPublicKey)
-&gt; ParseASN1 e OriginatorPublicKey
-&gt; ParseASN1 e OriginatorPublicKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>        </span><span id="local-6989586621679157257"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157257"><span class="hs-identifier hs-var">asn1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e [ASN1] -&gt; ParseASN1 e [ASN1]
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e [ASN1] -&gt; ParseASN1 e [ASN1])
-&gt; ParseASN1 e [ASN1] -&gt; ParseASN1 e [ASN1]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span id="local-6989586621679157259"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679157259"><span class="hs-identifier hs-var">oid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-156"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; ParseASN1 e ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679157259"><span class="hs-identifier hs-var">oid</span></a></span><span> </span><span class="annot"><span class="annottext">OID -&gt; OID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="Crypto.Store.CMS.Enveloped.html#idEcPublicKey"><span class="hs-identifier hs-var">idEcPublicKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                    </span><span class="annot"><span class="annottext">ParseASN1 e ASN1 -&gt; ParseASN1 e [ASN1]
forall e a. ParseASN1 e a -&gt; ParseASN1 e [a]
</span><a href="Crypto.Store.ASN1.Parse.html#getMany"><span class="hs-identifier hs-var">getMany</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">BitString</span></span><span> </span><span id="local-6989586621679157262"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679157262"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">OriginatorPublicKey -&gt; ParseASN1 e OriginatorPublicKey
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ASN1] -&gt; BitArray -&gt; OriginatorPublicKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKeyEC"><span class="hs-identifier hs-var">OriginatorPublicKeyEC</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157257"><span class="hs-identifier hs-var">asn1</span></a></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679157262"><span class="hs-identifier hs-var">ba</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | Union type related to identification of the originator.</span></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span> </span><span id="OriginatorIdentifierOrKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier hs-var">OriginatorIdentifierOrKey</span></a></span></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="OriginatorIASN"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIASN"><span class="hs-identifier hs-var">OriginatorIASN</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Issuer and Serial Number</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OriginatorSKI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorSKI"><span class="hs-identifier hs-var">OriginatorSKI</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Subject Key Identifier</span></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OriginatorPublic"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublic"><span class="hs-identifier hs-var">OriginatorPublic</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKey"><span class="hs-identifier hs-type">OriginatorPublicKey</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Anonymous public key</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157267"><span id="local-6989586621679157275"><span id="local-6989586621679157279"><span class="annot"><span class="annottext">Int -&gt; OriginatorIdentifierOrKey -&gt; ShowS
[OriginatorIdentifierOrKey] -&gt; ShowS
OriginatorIdentifierOrKey -&gt; String
(Int -&gt; OriginatorIdentifierOrKey -&gt; ShowS)
-&gt; (OriginatorIdentifierOrKey -&gt; String)
-&gt; ([OriginatorIdentifierOrKey] -&gt; ShowS)
-&gt; Show OriginatorIdentifierOrKey
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; OriginatorIdentifierOrKey -&gt; ShowS
showsPrec :: Int -&gt; OriginatorIdentifierOrKey -&gt; ShowS
$cshow :: OriginatorIdentifierOrKey -&gt; String
show :: OriginatorIdentifierOrKey -&gt; String
$cshowList :: [OriginatorIdentifierOrKey] -&gt; ShowS
showList :: [OriginatorIdentifierOrKey] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157282"><span id="local-6989586621679157287"><span class="annot"><span class="annottext">OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool
(OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool)
-&gt; (OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool)
-&gt; Eq OriginatorIdentifierOrKey
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool
== :: OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool
$c/= :: OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool
/= :: OriginatorIdentifierOrKey -&gt; OriginatorIdentifierOrKey -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156872"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156872"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156872"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier hs-type">OriginatorIdentifierOrKey</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679157297"><span class="annot"><span class="annottext">asn1s :: OriginatorIdentifierOrKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIASN"><span class="hs-identifier hs-type">OriginatorIASN</span></a></span><span> </span><span id="local-6989586621679157298"><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157298"><span class="hs-identifier hs-var">iasn</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157298"><span class="hs-identifier hs-var">iasn</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorSKI"><span class="hs-identifier hs-type">OriginatorSKI</span></a></span><span>  </span><span id="local-6989586621679157299"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157299"><span class="hs-identifier hs-var">ski</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157299"><span class="hs-identifier hs-var">ski</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublic"><span class="hs-identifier hs-type">OriginatorPublic</span></a></span><span> </span><span id="local-6989586621679157300"><span class="annot"><span class="annottext">OriginatorPublicKey
</span><a href="#local-6989586621679157300"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; OriginatorPublicKey -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; OriginatorPublicKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Enveloped.html#originatorPublicKeyASN1S"><span class="hs-identifier hs-var">originatorPublicKeyASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey
</span><a href="#local-6989586621679157300"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156874"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156874"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156874"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier hs-type">OriginatorIdentifierOrKey</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679157309"><span class="annot"><span class="annottext">parse :: ParseASN1 e OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157310"><span class="hs-identifier hs-var">parseIASN</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157311"><span class="hs-identifier hs-var">parseSKI</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157312"><span class="hs-identifier hs-var">parsePublic</span></a></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679157310"><span class="annot"><span class="annottext">parseIASN :: ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157310"><span class="hs-identifier hs-var hs-var">parseIASN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIASN"><span class="hs-identifier hs-var">OriginatorIASN</span></a></span><span> </span><span class="annot"><span class="annottext">(IssuerAndSerialNumber -&gt; OriginatorIdentifierOrKey)
-&gt; ParseASN1 e IssuerAndSerialNumber
-&gt; ParseASN1 e OriginatorIdentifierOrKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e IssuerAndSerialNumber
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-178"></span><span>            </span><span id="local-6989586621679157311"><span class="annot"><span class="annottext">parseSKI :: ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157311"><span class="hs-identifier hs-var hs-var">parseSKI</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorSKI"><span class="hs-identifier hs-var">OriginatorSKI</span></a></span><span>  </span><span class="annot"><span class="annottext">(ByteString -&gt; OriginatorIdentifierOrKey)
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e OriginatorIdentifierOrKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-179"></span><span>                </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e ByteString
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ByteString
forall e. Monoid e =&gt; ParseASN1 e ByteString
</span><a href="Crypto.Store.CMS.Util.html#parseOctetStringPrim"><span class="hs-identifier hs-var">parseOctetStringPrim</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span id="local-6989586621679157312"><span class="annot"><span class="annottext">parsePublic :: ParseASN1 e OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157312"><span class="hs-identifier hs-var hs-var">parsePublic</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey -&gt; OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublic"><span class="hs-identifier hs-var">OriginatorPublic</span></a></span><span> </span><span class="annot"><span class="annottext">(OriginatorPublicKey -&gt; OriginatorIdentifierOrKey)
-&gt; ParseASN1 e OriginatorPublicKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-181"></span><span>                </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e OriginatorPublicKey
forall e.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e OriginatorPublicKey
</span><a href="Crypto.Store.CMS.Enveloped.html#parseOriginatorPublicKey"><span class="hs-identifier hs-var">parseOriginatorPublicKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | Union type related to identification of a key-agreement recipient.</span></span><span>
</span><span id="line-184"></span><span class="hs-keyword">data</span><span> </span><span id="KeyAgreeRecipientIdentifier"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier hs-var">KeyAgreeRecipientIdentifier</span></a></span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="KeyAgreeRecipientIASN"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIASN"><span class="hs-identifier hs-var">KeyAgreeRecipientIASN</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-type">IssuerAndSerialNumber</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Issuer and Serial Number</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="KeyAgreeRecipientKI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientKI"><span class="hs-identifier hs-var">KeyAgreeRecipientKI</span></a></span></span><span>   </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Key identifier</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157327"><span id="local-6989586621679157334"><span id="local-6989586621679157338"><span class="annot"><span class="annottext">Int -&gt; KeyAgreeRecipientIdentifier -&gt; ShowS
[KeyAgreeRecipientIdentifier] -&gt; ShowS
KeyAgreeRecipientIdentifier -&gt; String
(Int -&gt; KeyAgreeRecipientIdentifier -&gt; ShowS)
-&gt; (KeyAgreeRecipientIdentifier -&gt; String)
-&gt; ([KeyAgreeRecipientIdentifier] -&gt; ShowS)
-&gt; Show KeyAgreeRecipientIdentifier
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KeyAgreeRecipientIdentifier -&gt; ShowS
showsPrec :: Int -&gt; KeyAgreeRecipientIdentifier -&gt; ShowS
$cshow :: KeyAgreeRecipientIdentifier -&gt; String
show :: KeyAgreeRecipientIdentifier -&gt; String
$cshowList :: [KeyAgreeRecipientIdentifier] -&gt; ShowS
showList :: [KeyAgreeRecipientIdentifier] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157341"><span id="local-6989586621679157346"><span class="annot"><span class="annottext">KeyAgreeRecipientIdentifier -&gt; KeyAgreeRecipientIdentifier -&gt; Bool
(KeyAgreeRecipientIdentifier
 -&gt; KeyAgreeRecipientIdentifier -&gt; Bool)
-&gt; (KeyAgreeRecipientIdentifier
    -&gt; KeyAgreeRecipientIdentifier -&gt; Bool)
-&gt; Eq KeyAgreeRecipientIdentifier
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: KeyAgreeRecipientIdentifier -&gt; KeyAgreeRecipientIdentifier -&gt; Bool
== :: KeyAgreeRecipientIdentifier -&gt; KeyAgreeRecipientIdentifier -&gt; Bool
$c/= :: KeyAgreeRecipientIdentifier -&gt; KeyAgreeRecipientIdentifier -&gt; Bool
/= :: KeyAgreeRecipientIdentifier -&gt; KeyAgreeRecipientIdentifier -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156878"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156878"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156878"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier hs-type">KeyAgreeRecipientIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679157356"><span class="annot"><span class="annottext">asn1s :: KeyAgreeRecipientIdentifier -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIASN"><span class="hs-identifier hs-type">KeyAgreeRecipientIASN</span></a></span><span> </span><span id="local-6989586621679157357"><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157357"><span class="hs-identifier hs-var">iasn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157357"><span class="hs-identifier hs-var">iasn</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientKI"><span class="hs-identifier hs-type">KeyAgreeRecipientKI</span></a></span><span>   </span><span id="local-6989586621679157358"><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157358"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyIdentifier -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157358"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156881"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156881"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156881"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier hs-type">KeyAgreeRecipientIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679157366"><span class="annot"><span class="annottext">parse :: ParseASN1 e KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157367"><span class="hs-identifier hs-var">parseIASN</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyAgreeRecipientIdentifier
-&gt; ParseASN1 e KeyAgreeRecipientIdentifier
-&gt; ParseASN1 e KeyAgreeRecipientIdentifier
forall a. ParseASN1 e a -&gt; ParseASN1 e a -&gt; ParseASN1 e a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157368"><span class="hs-identifier hs-var">parseKI</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679157367"><span class="annot"><span class="annottext">parseIASN :: ParseASN1 e KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157367"><span class="hs-identifier hs-var hs-var">parseIASN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIASN"><span class="hs-identifier hs-var">KeyAgreeRecipientIASN</span></a></span><span> </span><span class="annot"><span class="annottext">(IssuerAndSerialNumber -&gt; KeyAgreeRecipientIdentifier)
-&gt; ParseASN1 e IssuerAndSerialNumber
-&gt; ParseASN1 e KeyAgreeRecipientIdentifier
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e IssuerAndSerialNumber
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-197"></span><span>            </span><span id="local-6989586621679157368"><span class="annot"><span class="annottext">parseKI :: ParseASN1 e KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157368"><span class="hs-identifier hs-var hs-var">parseKI</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyIdentifier -&gt; KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientKI"><span class="hs-identifier hs-var">KeyAgreeRecipientKI</span></a></span><span>   </span><span class="annot"><span class="annottext">(KeyIdentifier -&gt; KeyAgreeRecipientIdentifier)
-&gt; ParseASN1 e KeyIdentifier
-&gt; ParseASN1 e KeyAgreeRecipientIdentifier
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-198"></span><span>                </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e KeyIdentifier -&gt; ParseASN1 e KeyIdentifier
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyIdentifier
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">-- | Encrypted key for a recipient in a key-agreement RI.</span></span><span>
</span><span id="line-201"></span><span class="hs-keyword">data</span><span> </span><span id="RecipientEncryptedKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-var">RecipientEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RecipientEncryptedKey"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-var">RecipientEncryptedKey</span></a></span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="rekRid"><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#rekRid"><span class="hs-identifier hs-var hs-var">rekRid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIdentifier"><span class="hs-identifier hs-type">KeyAgreeRecipientIdentifier</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ identifier of recipient</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="rekEncryptedKey"><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#rekEncryptedKey"><span class="hs-identifier hs-var hs-var">rekEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ encrypted content-encryption key</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157382"><span id="local-6989586621679157387"><span id="local-6989586621679157391"><span class="annot"><span class="annottext">Int -&gt; RecipientEncryptedKey -&gt; ShowS
[RecipientEncryptedKey] -&gt; ShowS
RecipientEncryptedKey -&gt; String
(Int -&gt; RecipientEncryptedKey -&gt; ShowS)
-&gt; (RecipientEncryptedKey -&gt; String)
-&gt; ([RecipientEncryptedKey] -&gt; ShowS)
-&gt; Show RecipientEncryptedKey
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RecipientEncryptedKey -&gt; ShowS
showsPrec :: Int -&gt; RecipientEncryptedKey -&gt; ShowS
$cshow :: RecipientEncryptedKey -&gt; String
show :: RecipientEncryptedKey -&gt; String
$cshowList :: [RecipientEncryptedKey] -&gt; ShowS
showList :: [RecipientEncryptedKey] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157394"><span id="local-6989586621679157398"><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool
(RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool)
-&gt; (RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool)
-&gt; Eq RecipientEncryptedKey
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool
== :: RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool
$c/= :: RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool
/= :: RecipientEncryptedKey -&gt; RecipientEncryptedKey -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156885"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156885"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156885"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679157405"><span class="annot"><span class="annottext">asn1s :: RecipientEncryptedKey -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157406"><span id="local-6989586621679157407"><span class="annot"><span class="annottext">ByteString
KeyAgreeRecipientIdentifier
rekRid :: RecipientEncryptedKey -&gt; KeyAgreeRecipientIdentifier
rekEncryptedKey :: RecipientEncryptedKey -&gt; ByteString
rekRid :: KeyAgreeRecipientIdentifier
rekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#rekRid"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157408"><span class="hs-identifier hs-var">rid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157409"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679157408"><span class="annot"><span class="annottext">rid :: ASN1Stream e
</span><a href="#local-6989586621679157408"><span class="hs-identifier hs-var hs-var">rid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyAgreeRecipientIdentifier -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157406"><span class="hs-identifier hs-var">rekRid</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span id="local-6989586621679157409"><span class="annot"><span class="annottext">ek :: ASN1Stream e
</span><a href="#local-6989586621679157409"><span class="hs-identifier hs-var hs-var">ek</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157407"><span class="hs-identifier hs-var">rekEncryptedKey</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156887"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156887"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156887"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679157425"><span class="annot"><span class="annottext">parse :: ParseASN1 e RecipientEncryptedKey
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e RecipientEncryptedKey
-&gt; ParseASN1 e RecipientEncryptedKey
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e RecipientEncryptedKey
 -&gt; ParseASN1 e RecipientEncryptedKey)
-&gt; ParseASN1 e RecipientEncryptedKey
-&gt; ParseASN1 e RecipientEncryptedKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679157426"><span class="annot"><span class="annottext">KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157426"><span class="hs-identifier hs-var">rid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyAgreeRecipientIdentifier
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157428"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157428"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; ParseASN1 e RecipientEncryptedKey
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rekRid :: KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#rekRid"><span class="hs-identifier hs-var">rekRid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyAgreeRecipientIdentifier
</span><a href="#local-6989586621679157426"><span class="hs-identifier hs-var">rid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#rekEncryptedKey"><span class="hs-identifier hs-var">rekEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157428"><span class="hs-identifier hs-var">ek</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#findRecipientEncryptedKey"><span class="hs-identifier hs-type">findRecipientEncryptedKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedCertificate</span></span><span>
</span><span id="line-219"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-221"></span><span id="findRecipientEncryptedKey"><span class="annot"><span class="annottext">findRecipientEncryptedKey :: SignedCertificate -&gt; [RecipientEncryptedKey] -&gt; Maybe ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#findRecipientEncryptedKey"><span class="hs-identifier hs-var hs-var">findRecipientEncryptedKey</span></a></span></span><span> </span><span id="local-6989586621679157430"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679157430"><span class="hs-identifier hs-var">cert</span></a></span></span><span> </span><span id="local-6989586621679157431"><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679157431"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#rekEncryptedKey"><span class="hs-identifier hs-var">rekEncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">(RecipientEncryptedKey -&gt; ByteString)
-&gt; Maybe RecipientEncryptedKey -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RecipientEncryptedKey -&gt; Bool)
-&gt; [RecipientEncryptedKey] -&gt; Maybe RecipientEncryptedKey
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; Bool
</span><a href="#local-6989586621679157432"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679157431"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621679157442"><span class="annot"><span class="annottext">c :: Certificate
</span><a href="#local-6989586621679157442"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signed Certificate -&gt; Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; Signed a -&gt; a
</span><span class="hs-identifier hs-var">signedObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedCertificate -&gt; Signed Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; SignedExact a -&gt; Signed a
</span><span class="hs-identifier hs-var">getSigned</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679157430"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679157449"><span class="annot"><span class="annottext">matchIASN :: IssuerAndSerialNumber -&gt; Bool
</span><a href="#local-6989586621679157449"><span class="hs-identifier hs-var hs-var">matchIASN</span></a></span></span><span> </span><span id="local-6989586621679157450"><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157450"><span class="hs-identifier hs-var">iasn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; DistinguishedName
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnIssuer"><span class="hs-identifier hs-var">iasnIssuer</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157450"><span class="hs-identifier hs-var">iasn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#iasnSerial"><span class="hs-identifier hs-var">iasnSerial</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157450"><span class="hs-identifier hs-var">iasn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DistinguishedName, Integer)
-&gt; (DistinguishedName, Integer) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; DistinguishedName
</span><span class="hs-identifier hs-var">certIssuerDN</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679157442"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Certificate -&gt; Integer
</span><span class="hs-identifier hs-var">certSerial</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679157442"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679157456"><span class="annot"><span class="annottext">matchSKI :: ByteString -&gt; Bool
</span><a href="#local-6989586621679157456"><span class="hs-identifier hs-var hs-var">matchSKI</span></a></span></span><span> </span><span id="local-6989586621679157457"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157457"><span class="hs-identifier hs-var">ski</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Extensions -&gt; Maybe ExtSubjectKeyId
forall a. Extension a =&gt; Extensions -&gt; Maybe a
</span><span class="hs-identifier hs-var">extensionGet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; Extensions
</span><span class="hs-identifier hs-var">certExtensions</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679157442"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExtSubjectKeyId</span></span><span> </span><span id="local-6989586621679157461"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157461"><span class="hs-identifier hs-var">idBs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157461"><span class="hs-identifier hs-var">idBs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157457"><span class="hs-identifier hs-var">ski</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="annottext">Maybe ExtSubjectKeyId
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679157432"><span class="annot"><span class="annottext">fn :: RecipientEncryptedKey -&gt; Bool
</span><a href="#local-6989586621679157432"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679157462"><span class="annot"><span class="annottext">RecipientEncryptedKey
</span><a href="#local-6989586621679157462"><span class="hs-identifier hs-var">rek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RecipientEncryptedKey -&gt; KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#rekRid"><span class="hs-identifier hs-var">rekRid</span></a></span><span> </span><span class="annot"><span class="annottext">RecipientEncryptedKey
</span><a href="#local-6989586621679157462"><span class="hs-identifier hs-var">rek</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>                 </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIASN"><span class="hs-identifier hs-type">KeyAgreeRecipientIASN</span></a></span><span> </span><span id="local-6989586621679157463"><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157463"><span class="hs-identifier hs-var">iasn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; Bool
</span><a href="#local-6989586621679157449"><span class="hs-identifier hs-var">matchIASN</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679157463"><span class="hs-identifier hs-var">iasn</span></a></span><span>
</span><span id="line-232"></span><span>                 </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientKI"><span class="hs-identifier hs-type">KeyAgreeRecipientKI</span></a></span><span>   </span><span id="local-6989586621679157464"><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157464"><span class="hs-identifier hs-var">ki</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="#local-6989586621679157456"><span class="hs-identifier hs-var">matchSKI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyIdentifier -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#keyIdentifier"><span class="hs-identifier hs-var">keyIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157464"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><span class="hs-comment">-- | Additional information in a 'KeyIdentifier'.</span></span><span>
</span><span id="line-235"></span><span class="hs-keyword">data</span><span> </span><span id="OtherKeyAttribute"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-var">OtherKeyAttribute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OtherKeyAttribute"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-var">OtherKeyAttribute</span></a></span></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="keyAttrId"><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; OID
</span><a href="Crypto.Store.CMS.Enveloped.html#keyAttrId"><span class="hs-identifier hs-var hs-var">keyAttrId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ attribute identifier</span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="keyAttr"><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; [ASN1]
</span><a href="Crypto.Store.CMS.Enveloped.html#keyAttr"><span class="hs-identifier hs-var hs-var">keyAttr</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ attribute value</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157471"><span id="local-6989586621679157478"><span id="local-6989586621679157482"><span class="annot"><span class="annottext">Int -&gt; OtherKeyAttribute -&gt; ShowS
[OtherKeyAttribute] -&gt; ShowS
OtherKeyAttribute -&gt; String
(Int -&gt; OtherKeyAttribute -&gt; ShowS)
-&gt; (OtherKeyAttribute -&gt; String)
-&gt; ([OtherKeyAttribute] -&gt; ShowS)
-&gt; Show OtherKeyAttribute
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; OtherKeyAttribute -&gt; ShowS
showsPrec :: Int -&gt; OtherKeyAttribute -&gt; ShowS
$cshow :: OtherKeyAttribute -&gt; String
show :: OtherKeyAttribute -&gt; String
$cshowList :: [OtherKeyAttribute] -&gt; ShowS
showList :: [OtherKeyAttribute] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157485"><span id="local-6989586621679157490"><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool
(OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool)
-&gt; (OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool)
-&gt; Eq OtherKeyAttribute
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool
== :: OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool
$c/= :: OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool
/= :: OtherKeyAttribute -&gt; OtherKeyAttribute -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156905"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156905"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156905"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-type">OtherKeyAttribute</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679157497"><span class="annot"><span class="annottext">asn1s :: OtherKeyAttribute -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-type">OtherKeyAttribute</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157498"><span id="local-6989586621679157499"><span class="annot"><span class="annottext">OID
[ASN1]
keyAttrId :: OtherKeyAttribute -&gt; OID
keyAttr :: OtherKeyAttribute -&gt; [ASN1]
keyAttrId :: OID
keyAttr :: [ASN1]
</span><a href="Crypto.Store.CMS.Enveloped.html#keyAttrId"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157500"><span class="hs-identifier hs-var">attrId</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157501"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679157500"><span class="annot"><span class="annottext">attrId :: ASN1Stream e
</span><a href="#local-6989586621679157500"><span class="hs-identifier hs-var hs-var">attrId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; OID -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOID"><span class="hs-identifier hs-var">gOID</span></a></span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679157498"><span class="hs-identifier hs-var">keyAttrId</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span id="local-6989586621679157501"><span class="annot"><span class="annottext">attr :: ASN1Stream e
</span><a href="#local-6989586621679157501"><span class="hs-identifier hs-var hs-var">attr</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ASN1] -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; [ASN1] -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gMany"><span class="hs-identifier hs-var">gMany</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157499"><span class="hs-identifier hs-var">keyAttr</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156907"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156907"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156907"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-type">OtherKeyAttribute</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679157516"><span class="annot"><span class="annottext">parse :: ParseASN1 e OtherKeyAttribute
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e OtherKeyAttribute -&gt; ParseASN1 e OtherKeyAttribute
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e OtherKeyAttribute -&gt; ParseASN1 e OtherKeyAttribute)
-&gt; ParseASN1 e OtherKeyAttribute -&gt; ParseASN1 e OtherKeyAttribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">OID</span></span><span> </span><span id="local-6989586621679157517"><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679157517"><span class="hs-identifier hs-var">attrId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-249"></span><span>        </span><span id="local-6989586621679157518"><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157518"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1 -&gt; ParseASN1 e [ASN1]
forall e a. ParseASN1 e a -&gt; ParseASN1 e [a]
</span><a href="Crypto.Store.ASN1.Parse.html#getMany"><span class="hs-identifier hs-var">getMany</span></a></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; ParseASN1 e OtherKeyAttribute
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-type">OtherKeyAttribute</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">keyAttrId :: OID
</span><a href="Crypto.Store.CMS.Enveloped.html#keyAttrId"><span class="hs-identifier hs-var">keyAttrId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OID
</span><a href="#local-6989586621679157517"><span class="hs-identifier hs-var">attrId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">keyAttr :: [ASN1]
</span><a href="Crypto.Store.CMS.Enveloped.html#keyAttr"><span class="hs-identifier hs-var">keyAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><a href="#local-6989586621679157518"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><span class="hs-comment">-- | Key identifier and optional attributes.</span></span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span id="KeyIdentifier"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-var">KeyIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KeyIdentifier"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-var">KeyIdentifier</span></a></span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="keyIdentifier"><span class="annot"><span class="annottext">KeyIdentifier -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#keyIdentifier"><span class="hs-identifier hs-var hs-var">keyIdentifier</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ identifier of the key</span></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="keyDate"><span class="annot"><span class="annottext">KeyIdentifier -&gt; Maybe DateTime
</span><a href="Crypto.Store.CMS.Enveloped.html#keyDate"><span class="hs-identifier hs-var hs-var">keyDate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DateTime</span></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ optional timestamp</span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="keyOther"><span class="annot"><span class="annottext">KeyIdentifier -&gt; Maybe OtherKeyAttribute
</span><a href="Crypto.Store.CMS.Enveloped.html#keyOther"><span class="hs-identifier hs-var hs-var">keyOther</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OtherKeyAttribute"><span class="hs-identifier hs-type">OtherKeyAttribute</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ optional information</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157522"><span id="local-6989586621679157531"><span id="local-6989586621679157534"><span class="annot"><span class="annottext">Int -&gt; KeyIdentifier -&gt; ShowS
[KeyIdentifier] -&gt; ShowS
KeyIdentifier -&gt; String
(Int -&gt; KeyIdentifier -&gt; ShowS)
-&gt; (KeyIdentifier -&gt; String)
-&gt; ([KeyIdentifier] -&gt; ShowS)
-&gt; Show KeyIdentifier
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KeyIdentifier -&gt; ShowS
showsPrec :: Int -&gt; KeyIdentifier -&gt; ShowS
$cshow :: KeyIdentifier -&gt; String
show :: KeyIdentifier -&gt; String
$cshowList :: [KeyIdentifier] -&gt; ShowS
showList :: [KeyIdentifier] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157538"><span id="local-6989586621679157546"><span class="annot"><span class="annottext">KeyIdentifier -&gt; KeyIdentifier -&gt; Bool
(KeyIdentifier -&gt; KeyIdentifier -&gt; Bool)
-&gt; (KeyIdentifier -&gt; KeyIdentifier -&gt; Bool) -&gt; Eq KeyIdentifier
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: KeyIdentifier -&gt; KeyIdentifier -&gt; Bool
== :: KeyIdentifier -&gt; KeyIdentifier -&gt; Bool
$c/= :: KeyIdentifier -&gt; KeyIdentifier -&gt; Bool
/= :: KeyIdentifier -&gt; KeyIdentifier -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156879"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156879"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156879"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679157552"><span class="annot"><span class="annottext">asn1s :: KeyIdentifier -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157553"><span id="local-6989586621679157554"><span id="local-6989586621679157555"><span class="annot"><span class="annottext">Maybe DateTime
Maybe OtherKeyAttribute
ByteString
keyIdentifier :: KeyIdentifier -&gt; ByteString
keyDate :: KeyIdentifier -&gt; Maybe DateTime
keyOther :: KeyIdentifier -&gt; Maybe OtherKeyAttribute
keyIdentifier :: ByteString
keyDate :: Maybe DateTime
keyOther :: Maybe OtherKeyAttribute
</span><a href="Crypto.Store.CMS.Enveloped.html#keyIdentifier"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157556"><span class="hs-identifier hs-var">keyId</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157557"><span class="hs-identifier hs-var">date</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157558"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>        </span><span id="local-6989586621679157556"><span class="annot"><span class="annottext">keyId :: ASN1Stream e
</span><a href="#local-6989586621679157556"><span class="hs-identifier hs-var hs-var">keyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157553"><span class="hs-identifier hs-var">keyIdentifier</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679157557"><span class="annot"><span class="annottext">date :: ASN1Stream e
</span><a href="#local-6989586621679157557"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DateTime -&gt; (DateTime -&gt; ASN1Stream e) -&gt; ASN1Stream e
forall a e. Maybe a -&gt; (a -&gt; ASN1Stream e) -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#optASN1S"><span class="hs-identifier hs-var">optASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DateTime
</span><a href="#local-6989586621679157554"><span class="hs-identifier hs-var">keyDate</span></a></span><span> </span><span class="annot"><span class="annottext">((DateTime -&gt; ASN1Stream e) -&gt; ASN1Stream e)
-&gt; (DateTime -&gt; ASN1Stream e) -&gt; ASN1Stream e
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679157562"><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679157562"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASN1TimeType -&gt; DateTime -&gt; Maybe TimezoneOffset -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1TimeType -&gt; DateTime -&gt; Maybe TimezoneOffset -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gASN1Time"><span class="hs-identifier hs-var">gASN1Time</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1TimeType
</span><span class="hs-identifier hs-var">TimeGeneralized</span></span><span> </span><span class="annot"><span class="annottext">DateTime
</span><a href="#local-6989586621679157562"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TimezoneOffset
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-265"></span><span>        </span><span id="local-6989586621679157558"><span class="annot"><span class="annottext">other :: ASN1Stream e
</span><a href="#local-6989586621679157558"><span class="hs-identifier hs-var hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe OtherKeyAttribute
-&gt; (OtherKeyAttribute -&gt; ASN1Stream e) -&gt; ASN1Stream e
forall a e. Maybe a -&gt; (a -&gt; ASN1Stream e) -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#optASN1S"><span class="hs-identifier hs-var">optASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OtherKeyAttribute
</span><a href="#local-6989586621679157555"><span class="hs-identifier hs-var">keyOther</span></a></span><span> </span><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156882"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156882"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156882"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679157583"><span class="annot"><span class="annottext">parse :: ParseASN1 e KeyIdentifier
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e KeyIdentifier -&gt; ParseASN1 e KeyIdentifier
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e KeyIdentifier -&gt; ParseASN1 e KeyIdentifier)
-&gt; ParseASN1 e KeyIdentifier -&gt; ParseASN1 e KeyIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157584"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157584"><span class="hs-identifier hs-var">keyId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679157585"><span class="annot"><span class="annottext">Maybe DateTime
</span><a href="#local-6989586621679157585"><span class="hs-identifier hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ASN1 -&gt; Maybe DateTime) -&gt; ParseASN1 e (Maybe DateTime)
forall e a. Monoid e =&gt; (ASN1 -&gt; Maybe a) -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#getNextMaybe"><span class="hs-identifier hs-var">getNextMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1 -&gt; Maybe DateTime
</span><a href="Crypto.Store.CMS.Util.html#dateTimeOrNothing"><span class="hs-identifier hs-var">dateTimeOrNothing</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621679157588"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679157588"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e Bool
forall e. ParseASN1 e Bool
</span><a href="Crypto.Store.ASN1.Parse.html#hasNext"><span class="hs-identifier hs-var">hasNext</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621679157590"><span class="annot"><span class="annottext">Maybe OtherKeyAttribute
</span><a href="#local-6989586621679157590"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679157588"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">OtherKeyAttribute -&gt; Maybe OtherKeyAttribute
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(OtherKeyAttribute -&gt; Maybe OtherKeyAttribute)
-&gt; ParseASN1 e OtherKeyAttribute
-&gt; ParseASN1 e (Maybe OtherKeyAttribute)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OtherKeyAttribute
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe OtherKeyAttribute -&gt; ParseASN1 e (Maybe OtherKeyAttribute)
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe OtherKeyAttribute
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">KeyIdentifier -&gt; ParseASN1 e KeyIdentifier
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">keyIdentifier :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#keyIdentifier"><span class="hs-identifier hs-var">keyIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157584"><span class="hs-identifier hs-var">keyId</span></a></span><span>
</span><span id="line-274"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">keyDate :: Maybe DateTime
</span><a href="Crypto.Store.CMS.Enveloped.html#keyDate"><span class="hs-identifier hs-var">keyDate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DateTime
</span><a href="#local-6989586621679157585"><span class="hs-identifier hs-var">date</span></a></span><span>
</span><span id="line-275"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">keyOther :: Maybe OtherKeyAttribute
</span><a href="Crypto.Store.CMS.Enveloped.html#keyOther"><span class="hs-identifier hs-var">keyOther</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe OtherKeyAttribute
</span><a href="#local-6989586621679157590"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-276"></span><span>                             </span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><span class="hs-comment">-- | Recipient using key transport.</span></span><span>
</span><span id="line-279"></span><span class="hs-keyword">data</span><span> </span><span id="KTRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-var">KTRecipientInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KTRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-var">KTRecipientInfo</span></a></span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="ktRid"><span class="annot"><span class="annottext">KTRecipientInfo -&gt; RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-identifier hs-var hs-var">ktRid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientIdentifier"><span class="hs-identifier hs-type">RecipientIdentifier</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ identifier of recipient</span></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ktKeyTransportParams"><span class="annot"><span class="annottext">KTRecipientInfo -&gt; KeyTransportParams
</span><a href="Crypto.Store.CMS.Enveloped.html#ktKeyTransportParams"><span class="hs-identifier hs-var hs-var">ktKeyTransportParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyTransportParams"><span class="hs-identifier hs-type">KeyTransportParams</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ key transport algorithm</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ktEncryptedKey"><span class="annot"><span class="annottext">KTRecipientInfo -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#ktEncryptedKey"><span class="hs-identifier hs-var hs-var">ktEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ encrypted content-encryption key</span></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157596"><span id="local-6989586621679157603"><span id="local-6989586621679157607"><span class="annot"><span class="annottext">Int -&gt; KTRecipientInfo -&gt; ShowS
[KTRecipientInfo] -&gt; ShowS
KTRecipientInfo -&gt; String
(Int -&gt; KTRecipientInfo -&gt; ShowS)
-&gt; (KTRecipientInfo -&gt; String)
-&gt; ([KTRecipientInfo] -&gt; ShowS)
-&gt; Show KTRecipientInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KTRecipientInfo -&gt; ShowS
showsPrec :: Int -&gt; KTRecipientInfo -&gt; ShowS
$cshow :: KTRecipientInfo -&gt; String
show :: KTRecipientInfo -&gt; String
$cshowList :: [KTRecipientInfo] -&gt; ShowS
showList :: [KTRecipientInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157610"><span id="local-6989586621679157616"><span class="annot"><span class="annottext">KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool
(KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool)
-&gt; (KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool)
-&gt; Eq KTRecipientInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool
== :: KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool
$c/= :: KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool
/= :: KTRecipientInfo -&gt; KTRecipientInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- | Recipient using key agreement.</span></span><span>
</span><span id="line-287"></span><span class="hs-keyword">data</span><span> </span><span id="KARecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-var">KARecipientInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KARecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-var">KARecipientInfo</span></a></span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="kaOriginator"><span class="annot"><span class="annottext">KARecipientInfo -&gt; OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#kaOriginator"><span class="hs-identifier hs-var hs-var">kaOriginator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorIdentifierOrKey"><span class="hs-identifier hs-type">OriginatorIdentifierOrKey</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ identifier of orginator or anonymous key</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kaUkm"><span class="annot"><span class="annottext">KARecipientInfo -&gt; Maybe ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kaUkm"><span class="hs-identifier hs-var hs-var">kaUkm</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#UserKeyingMaterial"><span class="hs-identifier hs-type">UserKeyingMaterial</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ user keying material</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kaKeyAgreementParams"><span class="annot"><span class="annottext">KARecipientInfo -&gt; KeyAgreementParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kaKeyAgreementParams"><span class="hs-identifier hs-var hs-var">kaKeyAgreementParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyAgreementParams"><span class="hs-identifier hs-type">KeyAgreementParams</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ key agreement algorithm</span></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kaRecipientEncryptedKeys"><span class="annot"><span class="annottext">KARecipientInfo -&gt; [RecipientEncryptedKey]
</span><a href="Crypto.Store.CMS.Enveloped.html#kaRecipientEncryptedKeys"><span class="hs-identifier hs-var hs-var">kaRecipientEncryptedKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ encrypted content-encryption key for one or multiple recipients</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157625"><span id="local-6989586621679157635"><span id="local-6989586621679157639"><span class="annot"><span class="annottext">Int -&gt; KARecipientInfo -&gt; ShowS
[KARecipientInfo] -&gt; ShowS
KARecipientInfo -&gt; String
(Int -&gt; KARecipientInfo -&gt; ShowS)
-&gt; (KARecipientInfo -&gt; String)
-&gt; ([KARecipientInfo] -&gt; ShowS)
-&gt; Show KARecipientInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KARecipientInfo -&gt; ShowS
showsPrec :: Int -&gt; KARecipientInfo -&gt; ShowS
$cshow :: KARecipientInfo -&gt; String
show :: KARecipientInfo -&gt; String
$cshowList :: [KARecipientInfo] -&gt; ShowS
showList :: [KARecipientInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157642"><span id="local-6989586621679157651"><span class="annot"><span class="annottext">KARecipientInfo -&gt; KARecipientInfo -&gt; Bool
(KARecipientInfo -&gt; KARecipientInfo -&gt; Bool)
-&gt; (KARecipientInfo -&gt; KARecipientInfo -&gt; Bool)
-&gt; Eq KARecipientInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: KARecipientInfo -&gt; KARecipientInfo -&gt; Bool
== :: KARecipientInfo -&gt; KARecipientInfo -&gt; Bool
$c/= :: KARecipientInfo -&gt; KARecipientInfo -&gt; Bool
/= :: KARecipientInfo -&gt; KARecipientInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><span class="hs-comment">-- | Recipient using key encryption.</span></span><span>
</span><span id="line-296"></span><span class="hs-keyword">data</span><span> </span><span id="KEKRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-var">KEKRecipientInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KEKRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-var">KEKRecipientInfo</span></a></span></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="kekId"><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; KeyIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#kekId"><span class="hs-identifier hs-var hs-var">kekId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span><span>                        </span><span class="annot"><span class="hs-comment">-- ^ identifier of key encryption key</span></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kekKeyEncryptionParams"><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kekKeyEncryptionParams"><span class="hs-identifier hs-var hs-var">kekKeyEncryptionParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyEncryptionParams"><span class="hs-identifier hs-type">KeyEncryptionParams</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ key encryption algorithm</span></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kekEncryptedKey"><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kekEncryptedKey"><span class="hs-identifier hs-var hs-var">kekEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ encrypted content-encryption key</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157659"><span id="local-6989586621679157666"><span id="local-6989586621679157670"><span class="annot"><span class="annottext">Int -&gt; KEKRecipientInfo -&gt; ShowS
[KEKRecipientInfo] -&gt; ShowS
KEKRecipientInfo -&gt; String
(Int -&gt; KEKRecipientInfo -&gt; ShowS)
-&gt; (KEKRecipientInfo -&gt; String)
-&gt; ([KEKRecipientInfo] -&gt; ShowS)
-&gt; Show KEKRecipientInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KEKRecipientInfo -&gt; ShowS
showsPrec :: Int -&gt; KEKRecipientInfo -&gt; ShowS
$cshow :: KEKRecipientInfo -&gt; String
show :: KEKRecipientInfo -&gt; String
$cshowList :: [KEKRecipientInfo] -&gt; ShowS
showList :: [KEKRecipientInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157673"><span id="local-6989586621679157679"><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool
(KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool)
-&gt; (KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool)
-&gt; Eq KEKRecipientInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool
== :: KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool
$c/= :: KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool
/= :: KEKRecipientInfo -&gt; KEKRecipientInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">-- | Recipient using password-based protection.</span></span><span>
</span><span id="line-304"></span><span class="hs-keyword">data</span><span> </span><span id="PasswordRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-var">PasswordRecipientInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PasswordRecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-var">PasswordRecipientInfo</span></a></span></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="priKeyDerivationFunc"><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; KeyDerivationFunc
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyDerivationFunc"><span class="hs-identifier hs-var hs-var">priKeyDerivationFunc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyDerivationFunc"><span class="hs-identifier hs-type">KeyDerivationFunc</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ function to derive key</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="priKeyEncryptionParams"><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyEncryptionParams"><span class="hs-identifier hs-var hs-var">priKeyEncryptionParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyEncryptionParams"><span class="hs-identifier hs-type">KeyEncryptionParams</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ key encryption algorithm</span></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="priEncryptedKey"><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#priEncryptedKey"><span class="hs-identifier hs-var hs-var">priEncryptedKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ encrypted content-encryption key</span></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157687"><span id="local-6989586621679157694"><span id="local-6989586621679157698"><span class="annot"><span class="annottext">Int -&gt; PasswordRecipientInfo -&gt; ShowS
[PasswordRecipientInfo] -&gt; ShowS
PasswordRecipientInfo -&gt; String
(Int -&gt; PasswordRecipientInfo -&gt; ShowS)
-&gt; (PasswordRecipientInfo -&gt; String)
-&gt; ([PasswordRecipientInfo] -&gt; ShowS)
-&gt; Show PasswordRecipientInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; PasswordRecipientInfo -&gt; ShowS
showsPrec :: Int -&gt; PasswordRecipientInfo -&gt; ShowS
$cshow :: PasswordRecipientInfo -&gt; String
show :: PasswordRecipientInfo -&gt; String
$cshowList :: [PasswordRecipientInfo] -&gt; ShowS
showList :: [PasswordRecipientInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157701"><span id="local-6989586621679157707"><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool
(PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool)
-&gt; (PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool)
-&gt; Eq PasswordRecipientInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool
== :: PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool
$c/= :: PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool
/= :: PasswordRecipientInfo -&gt; PasswordRecipientInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Information for a recipient of an 'EnvelopedData'.  An element contains</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- the content-encryption key in encrypted form.</span><span>
</span><span id="line-313"></span><span class="hs-keyword">data</span><span> </span><span id="RecipientInfo"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-var">RecipientInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KTRI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-var">KTRI</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-type">KTRecipientInfo</span></a></span><span>
</span><span id="line-314"></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Recipient using key transport</span></span><span>
</span><span id="line-315"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="KARI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-var">KARI</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-type">KARecipientInfo</span></a></span><span>
</span><span id="line-316"></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Recipient using key agreement</span></span><span>
</span><span id="line-317"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="KEKRI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-var">KEKRI</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-type">KEKRecipientInfo</span></a></span><span>
</span><span id="line-318"></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Recipient using key encryption</span></span><span>
</span><span id="line-319"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="PasswordRI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-var">PasswordRI</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-type">PasswordRecipientInfo</span></a></span><span>
</span><span id="line-320"></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Recipient using password-based protection</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157716"><span id="local-6989586621679157726"><span id="local-6989586621679157730"><span class="annot"><span class="annottext">Int -&gt; RecipientInfo -&gt; ShowS
[RecipientInfo] -&gt; ShowS
RecipientInfo -&gt; String
(Int -&gt; RecipientInfo -&gt; ShowS)
-&gt; (RecipientInfo -&gt; String)
-&gt; ([RecipientInfo] -&gt; ShowS)
-&gt; Show RecipientInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RecipientInfo -&gt; ShowS
showsPrec :: Int -&gt; RecipientInfo -&gt; ShowS
$cshow :: RecipientInfo -&gt; String
show :: RecipientInfo -&gt; String
$cshowList :: [RecipientInfo] -&gt; ShowS
showList :: [RecipientInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679157733"><span id="local-6989586621679157739"><span class="annot"><span class="annottext">RecipientInfo -&gt; RecipientInfo -&gt; Bool
(RecipientInfo -&gt; RecipientInfo -&gt; Bool)
-&gt; (RecipientInfo -&gt; RecipientInfo -&gt; Bool) -&gt; Eq RecipientInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RecipientInfo -&gt; RecipientInfo -&gt; Bool
== :: RecipientInfo -&gt; RecipientInfo -&gt; Bool
$c/= :: RecipientInfo -&gt; RecipientInfo -&gt; Bool
/= :: RecipientInfo -&gt; RecipientInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156932"><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1Elem"><span class="hs-identifier hs-type">ASN1Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156932"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156932"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679157749"><span class="annot"><span class="annottext">asn1s :: RecipientInfo -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-type">KTRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-type">KTRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157750"><span id="local-6989586621679157751"><span id="local-6989586621679157752"><span class="annot"><span class="annottext">ByteString
KeyTransportParams
RecipientIdentifier
ktRid :: KTRecipientInfo -&gt; RecipientIdentifier
ktKeyTransportParams :: KTRecipientInfo -&gt; KeyTransportParams
ktEncryptedKey :: KTRecipientInfo -&gt; ByteString
ktRid :: RecipientIdentifier
ktKeyTransportParams :: KeyTransportParams
ktEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157753"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157754"><span class="hs-identifier hs-var">rid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157755"><span class="hs-identifier hs-var">ktp</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157756"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>        </span><span id="local-6989586621679157753"><span class="annot"><span class="annottext">ver :: ASN1Stream e
</span><a href="#local-6989586621679157753"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecipientIdentifier -&gt; Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#getKTVersion"><span class="hs-identifier hs-var">getKTVersion</span></a></span><span> </span><span class="annot"><span class="annottext">RecipientIdentifier
</span><a href="#local-6989586621679157750"><span class="hs-identifier hs-var">ktRid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621679157754"><span class="annot"><span class="annottext">rid :: ASN1Stream e
</span><a href="#local-6989586621679157754"><span class="hs-identifier hs-var hs-var">rid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecipientIdentifier -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">RecipientIdentifier
</span><a href="#local-6989586621679157750"><span class="hs-identifier hs-var">ktRid</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621679157755"><span class="annot"><span class="annottext">ktp :: ASN1Stream e
</span><a href="#local-6989586621679157755"><span class="hs-identifier hs-var hs-var">ktp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; KeyTransportParams -&gt; ASN1Stream e
forall e param.
(ASN1Elem e, AlgorithmId param, OIDable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; param -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#algorithmASN1S"><span class="hs-identifier hs-var">algorithmASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679157751"><span class="hs-identifier hs-var">ktKeyTransportParams</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621679157756"><span class="annot"><span class="annottext">ek :: ASN1Stream e
</span><a href="#local-6989586621679157756"><span class="hs-identifier hs-var hs-var">ek</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157752"><span class="hs-identifier hs-var">ktEncryptedKey</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-type">KARI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-type">KARecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157768"><span id="local-6989586621679157769"><span id="local-6989586621679157770"><span id="local-6989586621679157771"><span class="annot"><span class="annottext">[RecipientEncryptedKey]
Maybe ByteString
KeyAgreementParams
OriginatorIdentifierOrKey
kaOriginator :: KARecipientInfo -&gt; OriginatorIdentifierOrKey
kaUkm :: KARecipientInfo -&gt; Maybe ByteString
kaKeyAgreementParams :: KARecipientInfo -&gt; KeyAgreementParams
kaRecipientEncryptedKeys :: KARecipientInfo -&gt; [RecipientEncryptedKey]
kaOriginator :: OriginatorIdentifierOrKey
kaUkm :: Maybe ByteString
kaKeyAgreementParams :: KeyAgreementParams
kaRecipientEncryptedKeys :: [RecipientEncryptedKey]
</span><a href="Crypto.Store.CMS.Enveloped.html#kaOriginator"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157772"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157773"><span class="hs-identifier hs-var">ori</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157774"><span class="hs-identifier hs-var">ukm</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157775"><span class="hs-identifier hs-var">kap</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157776"><span class="hs-identifier hs-var">reks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621679157772"><span class="annot"><span class="annottext">ver :: ASN1Stream e
</span><a href="#local-6989586621679157772"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621679157773"><span class="annot"><span class="annottext">ori :: ASN1Stream e
</span><a href="#local-6989586621679157773"><span class="hs-identifier hs-var hs-var">ori</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OriginatorIdentifierOrKey -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157768"><span class="hs-identifier hs-var">kaOriginator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>        </span><span id="local-6989586621679157775"><span class="annot"><span class="annottext">kap :: ASN1Stream e
</span><a href="#local-6989586621679157775"><span class="hs-identifier hs-var hs-var">kap</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; KeyAgreementParams -&gt; ASN1Stream e
forall e param.
(ASN1Elem e, AlgorithmId param, OIDable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; param -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#algorithmASN1S"><span class="hs-identifier hs-var">algorithmASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679157770"><span class="hs-identifier hs-var">kaKeyAgreementParams</span></a></span><span>
</span><span id="line-338"></span><span>        </span><span id="local-6989586621679157776"><span class="annot"><span class="annottext">reks :: ASN1Stream e
</span><a href="#local-6989586621679157776"><span class="hs-identifier hs-var hs-var">reks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RecipientEncryptedKey] -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679157771"><span class="hs-identifier hs-var">kaRecipientEncryptedKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>        </span><span id="local-6989586621679157774"><span class="annot"><span class="annottext">ukm :: ASN1Stream e
</span><a href="#local-6989586621679157774"><span class="hs-identifier hs-var hs-var">ukm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679157769"><span class="hs-identifier hs-var">kaUkm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>                  </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-342"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679157793"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157793"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157793"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-type">KEKRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-type">KEKRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157794"><span id="local-6989586621679157795"><span id="local-6989586621679157796"><span class="annot"><span class="annottext">ByteString
KeyEncryptionParams
KeyIdentifier
kekId :: KEKRecipientInfo -&gt; KeyIdentifier
kekKeyEncryptionParams :: KEKRecipientInfo -&gt; KeyEncryptionParams
kekEncryptedKey :: KEKRecipientInfo -&gt; ByteString
kekId :: KeyIdentifier
kekKeyEncryptionParams :: KeyEncryptionParams
kekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kekId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157797"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157798"><span class="hs-identifier hs-var">kid</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157799"><span class="hs-identifier hs-var">kep</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157800"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679157797"><span class="annot"><span class="annottext">ver :: ASN1Stream e
</span><a href="#local-6989586621679157797"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span>
</span><span id="line-348"></span><span>        </span><span id="local-6989586621679157798"><span class="annot"><span class="annottext">kid :: ASN1Stream e
</span><a href="#local-6989586621679157798"><span class="hs-identifier hs-var hs-var">kid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyIdentifier -&gt; ASN1Stream e
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157794"><span class="hs-identifier hs-var">kekId</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span id="local-6989586621679157799"><span class="annot"><span class="annottext">kep :: ASN1Stream e
</span><a href="#local-6989586621679157799"><span class="hs-identifier hs-var hs-var">kep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; KeyEncryptionParams -&gt; ASN1Stream e
forall e param.
(ASN1Elem e, AlgorithmId param, OIDable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; param -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#algorithmASN1S"><span class="hs-identifier hs-var">algorithmASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157795"><span class="hs-identifier hs-var">kekKeyEncryptionParams</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span id="local-6989586621679157800"><span class="annot"><span class="annottext">ek :: ASN1Stream e
</span><a href="#local-6989586621679157800"><span class="hs-identifier hs-var hs-var">ek</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157796"><span class="hs-identifier hs-var">kekEncryptedKey</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-type">PasswordRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-type">PasswordRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679157811"><span id="local-6989586621679157812"><span id="local-6989586621679157813"><span class="annot"><span class="annottext">ByteString
KeyEncryptionParams
KeyDerivationFunc
priKeyDerivationFunc :: PasswordRecipientInfo -&gt; KeyDerivationFunc
priKeyEncryptionParams :: PasswordRecipientInfo -&gt; KeyEncryptionParams
priEncryptedKey :: PasswordRecipientInfo -&gt; ByteString
priKeyDerivationFunc :: KeyDerivationFunc
priKeyEncryptionParams :: KeyEncryptionParams
priEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyDerivationFunc"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157814"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157815"><span class="hs-identifier hs-var">kdf</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157816"><span class="hs-identifier hs-var">kep</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e -&gt; ASN1Stream e -&gt; ASN1Stream e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream e
</span><a href="#local-6989586621679157817"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>        </span><span id="local-6989586621679157814"><span class="annot"><span class="annottext">ver :: ASN1Stream e
</span><a href="#local-6989586621679157814"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-356"></span><span>        </span><span id="local-6989586621679157815"><span class="annot"><span class="annottext">kdf :: ASN1Stream e
</span><a href="#local-6989586621679157815"><span class="hs-identifier hs-var hs-var">kdf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; KeyDerivationFunc -&gt; ASN1Stream e
forall e param.
(ASN1Elem e, AlgorithmId param, OIDable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; param -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#algorithmASN1S"><span class="hs-identifier hs-var">algorithmASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679157811"><span class="hs-identifier hs-var">priKeyDerivationFunc</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span id="local-6989586621679157816"><span class="annot"><span class="annottext">kep :: ASN1Stream e
</span><a href="#local-6989586621679157816"><span class="hs-identifier hs-var hs-var">kep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; KeyEncryptionParams -&gt; ASN1Stream e
forall e param.
(ASN1Elem e, AlgorithmId param, OIDable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; param -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#algorithmASN1S"><span class="hs-identifier hs-var">algorithmASN1S</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157812"><span class="hs-identifier hs-var">priKeyEncryptionParams</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span id="local-6989586621679157817"><span class="annot"><span class="annottext">ek :: ASN1Stream e
</span><a href="#local-6989586621679157817"><span class="hs-identifier hs-var hs-var">ek</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ASN1Stream e
forall e. ASN1Elem e =&gt; ByteString -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gOctetString"><span class="hs-identifier hs-var">gOctetString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157813"><span class="hs-identifier hs-var">priEncryptedKey</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679156946"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679156946"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156946"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>    </span><span id="local-6989586621679157845"><span class="annot"><span class="annottext">parse :: ParseASN1 e RecipientInfo
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621679157846"><span class="annot"><span class="annottext">Maybe RecipientInfo
</span><a href="#local-6989586621679157846"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e RecipientInfo -&gt; ParseASN1 e (Maybe RecipientInfo)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157848"><span class="hs-identifier hs-var">parseKT</span></a></span><span>
</span><span id="line-363"></span><span>             </span><span class="annot"><span class="annottext">ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (Maybe a) -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="Crypto.Store.CMS.Util.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e RecipientInfo -&gt; ParseASN1 e (Maybe RecipientInfo)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157850"><span class="hs-identifier hs-var">parseKA</span></a></span><span>
</span><span id="line-364"></span><span>             </span><span class="annot"><span class="annottext">ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (Maybe a) -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="Crypto.Store.CMS.Util.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e RecipientInfo -&gt; ParseASN1 e (Maybe RecipientInfo)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157851"><span class="hs-identifier hs-var">parseKEK</span></a></span><span>
</span><span id="line-365"></span><span>             </span><span class="annot"><span class="annottext">ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
-&gt; ParseASN1 e (Maybe RecipientInfo)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (Maybe a) -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="Crypto.Store.CMS.Util.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e RecipientInfo -&gt; ParseASN1 e (Maybe RecipientInfo)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157852"><span class="hs-identifier hs-var">parsePassword</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe RecipientInfo
</span><a href="#local-6989586621679157846"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679157853"><span class="annot"><span class="annottext">RecipientInfo
</span><a href="#local-6989586621679157853"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RecipientInfo -&gt; ParseASN1 e RecipientInfo
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo
</span><a href="#local-6989586621679157853"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="annottext">Maybe RecipientInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ParseASN1 e RecipientInfo
forall e a. String -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RecipientInfo: unable to parse&quot;</span></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679157848"><span class="annot"><span class="annottext">parseKT :: ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157848"><span class="hs-identifier hs-var hs-var">parseKT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KTRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-var">KTRI</span></a></span><span> </span><span class="annot"><span class="annottext">(KTRecipientInfo -&gt; RecipientInfo)
-&gt; ParseASN1 e KTRecipientInfo -&gt; ParseASN1 e RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679157880"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157880"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-372"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157880"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; OID -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e () -&gt; ParseASN1 e ())
-&gt; ParseASN1 e () -&gt; ParseASN1 e ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-373"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; ParseASN1 e ()
forall e a. String -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RecipientInfo: parsed invalid KT version: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679157880"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>            </span><span id="local-6989586621679157884"><span class="annot"><span class="annottext">RecipientIdentifier
</span><a href="#local-6989586621679157884"><span class="hs-identifier hs-var">rid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e RecipientIdentifier
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-375"></span><span>            </span><span id="local-6989586621679157885"><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679157885"><span class="hs-identifier hs-var">ktp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e KeyTransportParams
forall e param.
(Monoid e, AlgorithmId param, OIDNameable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; ParseASN1 e param
</span><a href="Crypto.Store.CMS.Util.html#parseAlgorithm"><span class="hs-identifier hs-var">parseAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span>
</span><span id="line-376"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157887"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157887"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-377"></span><span>            </span><span class="annot"><span class="annottext">KTRecipientInfo -&gt; ParseASN1 e KTRecipientInfo
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-type">KTRecipientInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ktRid :: RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-identifier hs-var">ktRid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecipientIdentifier
</span><a href="#local-6989586621679157884"><span class="hs-identifier hs-var">rid</span></a></span><span>
</span><span id="line-378"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ktKeyTransportParams :: KeyTransportParams
</span><a href="Crypto.Store.CMS.Enveloped.html#ktKeyTransportParams"><span class="hs-identifier hs-var">ktKeyTransportParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679157885"><span class="hs-identifier hs-var">ktp</span></a></span><span>
</span><span id="line-379"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ktEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#ktEncryptedKey"><span class="hs-identifier hs-var">ktEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157887"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-380"></span><span>                                   </span><span class="hs-special">}</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>        </span><span id="local-6989586621679157850"><span class="annot"><span class="annottext">parseKA :: ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157850"><span class="hs-identifier hs-var hs-var">parseKA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KARecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-var">KARI</span></a></span><span> </span><span class="annot"><span class="annottext">(KARecipientInfo -&gt; RecipientInfo)
-&gt; ParseASN1 e KARecipientInfo -&gt; ParseASN1 e RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span id="local-6989586621679157916"><span class="annot"><span class="annottext">OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157916"><span class="hs-identifier hs-var">ori</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e OriginatorIdentifierOrKey
-&gt; ParseASN1 e OriginatorIdentifierOrKey
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e OriginatorIdentifierOrKey
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-385"></span><span>            </span><span id="local-6989586621679157917"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679157917"><span class="hs-identifier hs-var">ukm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e (Maybe ByteString)
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e (Maybe a)
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainerMaybe"><span class="hs-identifier hs-var">onNextContainerMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParseASN1 e ByteString -&gt; ParseASN1 e (Maybe ByteString))
-&gt; ParseASN1 e ByteString -&gt; ParseASN1 e (Maybe ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-386"></span><span>                       </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157918"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157918"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ParseASN1 e ByteString
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157918"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-387"></span><span>            </span><span id="local-6989586621679157919"><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679157919"><span class="hs-identifier hs-var">kap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e KeyAgreementParams
forall e param.
(Monoid e, AlgorithmId param, OIDNameable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; ParseASN1 e param
</span><a href="Crypto.Store.CMS.Util.html#parseAlgorithm"><span class="hs-identifier hs-var">parseAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621679157920"><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679157920"><span class="hs-identifier hs-var">reks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 e [RecipientEncryptedKey]
-&gt; ParseASN1 e [RecipientEncryptedKey]
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 e [RecipientEncryptedKey]
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">KARecipientInfo -&gt; ParseASN1 e KARecipientInfo
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-type">KARecipientInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kaOriginator :: OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#kaOriginator"><span class="hs-identifier hs-var">kaOriginator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorIdentifierOrKey
</span><a href="#local-6989586621679157916"><span class="hs-identifier hs-var">ori</span></a></span><span>
</span><span id="line-390"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaUkm :: Maybe ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kaUkm"><span class="hs-identifier hs-var">kaUkm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679157917"><span class="hs-identifier hs-var">ukm</span></a></span><span>
</span><span id="line-391"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaKeyAgreementParams :: KeyAgreementParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kaKeyAgreementParams"><span class="hs-identifier hs-var">kaKeyAgreementParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679157919"><span class="hs-identifier hs-var">kap</span></a></span><span>
</span><span id="line-392"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaRecipientEncryptedKeys :: [RecipientEncryptedKey]
</span><a href="Crypto.Store.CMS.Enveloped.html#kaRecipientEncryptedKeys"><span class="hs-identifier hs-var">kaRecipientEncryptedKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679157920"><span class="hs-identifier hs-var">reks</span></a></span><span>
</span><span id="line-393"></span><span>                                   </span><span class="hs-special">}</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>        </span><span id="local-6989586621679157851"><span class="annot"><span class="annottext">parseKEK :: ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157851"><span class="hs-identifier hs-var hs-var">parseKEK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-var">KEKRI</span></a></span><span> </span><span class="annot"><span class="annottext">(KEKRecipientInfo -&gt; RecipientInfo)
-&gt; ParseASN1 e KEKRecipientInfo -&gt; ParseASN1 e RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-397"></span><span>            </span><span id="local-6989586621679157940"><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157940"><span class="hs-identifier hs-var">kid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e KeyIdentifier
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-398"></span><span>            </span><span id="local-6989586621679157941"><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157941"><span class="hs-identifier hs-var">kep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e KeyEncryptionParams
forall e param.
(Monoid e, AlgorithmId param, OIDNameable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; ParseASN1 e param
</span><a href="Crypto.Store.CMS.Util.html#parseAlgorithm"><span class="hs-identifier hs-var">parseAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span>
</span><span id="line-399"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157942"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157942"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-400"></span><span>            </span><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; ParseASN1 e KEKRecipientInfo
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-type">KEKRecipientInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kekId :: KeyIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#kekId"><span class="hs-identifier hs-var">kekId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679157940"><span class="hs-identifier hs-var">kid</span></a></span><span>
</span><span id="line-401"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kekKeyEncryptionParams :: KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kekKeyEncryptionParams"><span class="hs-identifier hs-var">kekKeyEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157941"><span class="hs-identifier hs-var">kep</span></a></span><span>
</span><span id="line-402"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kekEncryptedKey"><span class="hs-identifier hs-var">kekEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157942"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-403"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>        </span><span id="local-6989586621679157852"><span class="annot"><span class="annottext">parsePassword :: ParseASN1 e RecipientInfo
</span><a href="#local-6989586621679157852"><span class="hs-identifier hs-var hs-var">parsePassword</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-var">PasswordRI</span></a></span><span> </span><span class="annot"><span class="annottext">(PasswordRecipientInfo -&gt; RecipientInfo)
-&gt; ParseASN1 e PasswordRecipientInfo -&gt; ParseASN1 e RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-407"></span><span>            </span><span id="local-6989586621679157965"><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679157965"><span class="hs-identifier hs-var">kdf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e KeyDerivationFunc
forall e param.
(Monoid e, AlgorithmId param, OIDNameable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; ParseASN1 e param
</span><a href="Crypto.Store.CMS.Util.html#parseAlgorithm"><span class="hs-identifier hs-var">parseAlgorithm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>            </span><span id="local-6989586621679157966"><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157966"><span class="hs-identifier hs-var">kep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 e KeyEncryptionParams
forall e param.
(Monoid e, AlgorithmId param, OIDNameable (AlgorithmType param)) =&gt;
ASN1ConstructionType -&gt; ParseASN1 e param
</span><a href="Crypto.Store.CMS.Util.html#parseAlgorithm"><span class="hs-identifier hs-var">parseAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span>
</span><span id="line-409"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">OctetString</span></span><span> </span><span id="local-6989586621679157967"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157967"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 e ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-410"></span><span>            </span><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; ParseASN1 e PasswordRecipientInfo
forall a. a -&gt; ParseASN1 e a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-type">PasswordRecipientInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">priKeyDerivationFunc :: KeyDerivationFunc
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyDerivationFunc"><span class="hs-identifier hs-var">priKeyDerivationFunc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679157965"><span class="hs-identifier hs-var">kdf</span></a></span><span>
</span><span id="line-411"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">priKeyEncryptionParams :: KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyEncryptionParams"><span class="hs-identifier hs-var">priKeyEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679157966"><span class="hs-identifier hs-var">kep</span></a></span><span>
</span><span id="line-412"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">priEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#priEncryptedKey"><span class="hs-identifier hs-var">priEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679157967"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-413"></span><span>                                         </span><span class="hs-special">}</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-type">isVersion0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-416"></span><span id="isVersion0"><span class="annot"><span class="annottext">isVersion0 :: RecipientInfo -&gt; Bool
</span><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-var hs-var">isVersion0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-type">KTRI</span></a></span><span> </span><span id="local-6989586621679157969"><span class="annot"><span class="annottext">KTRecipientInfo
</span><a href="#local-6989586621679157969"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecipientIdentifier -&gt; Integer
</span><a href="Crypto.Store.CMS.Enveloped.html#getKTVersion"><span class="hs-identifier hs-var">getKTVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KTRecipientInfo -&gt; RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-identifier hs-var">ktRid</span></a></span><span> </span><span class="annot"><span class="annottext">KTRecipientInfo
</span><a href="#local-6989586621679157969"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-var">isVersion0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-type">KARI</span></a></span><span> </span><span class="annot"><span class="annottext">KARecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>      </span><span class="hs-comment">-- because version is always 3</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-var">isVersion0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-type">KEKRI</span></a></span><span> </span><span class="annot"><span class="annottext">KEKRecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>      </span><span class="hs-comment">-- because version is always 4</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-var">isVersion0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-type">PasswordRI</span></a></span><span> </span><span class="annot"><span class="annottext">PasswordRecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>       </span><span class="hs-comment">-- because version is always 0</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-type">isPwriOri</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-422"></span><span id="isPwriOri"><span class="annot"><span class="annottext">isPwriOri :: RecipientInfo -&gt; Bool
</span><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-var hs-var">isPwriOri</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-type">KTRI</span></a></span><span> </span><span class="annot"><span class="annottext">KTRecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-var">isPwriOri</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-type">KARI</span></a></span><span> </span><span class="annot"><span class="annottext">KARecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-var">isPwriOri</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-type">KEKRI</span></a></span><span> </span><span class="annot"><span class="annottext">KEKRecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-var">isPwriOri</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-type">PasswordRI</span></a></span><span> </span><span class="annot"><span class="annottext">PasswordRecipientInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><span class="hs-comment">-- | Enveloped content information.</span></span><span>
</span><span id="line-428"></span><span class="hs-keyword">data</span><span> </span><span id="EnvelopedData"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-var">EnvelopedData</span></a></span></span><span> </span><span id="local-6989586621679156963"><span class="annot"><a href="#local-6989586621679156963"><span class="hs-identifier hs-type">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EnvelopedData"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-var">EnvelopedData</span></a></span></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="evOriginatorInfo"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; OriginatorInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#evOriginatorInfo"><span class="hs-identifier hs-var hs-var">evOriginatorInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.OriginatorInfo.html#OriginatorInfo"><span class="hs-identifier hs-type">OriginatorInfo</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Optional information about the originator</span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="evRecipientInfos"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; [RecipientInfo]
</span><a href="Crypto.Store.CMS.Enveloped.html#evRecipientInfos"><span class="hs-identifier hs-var hs-var">evRecipientInfos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Information for recipients, allowing to decrypt the content</span></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="evContentType"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; ContentType
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentType"><span class="hs-identifier hs-var hs-var">evContentType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Type.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Inner content type</span></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="evContentEncryptionParams"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; ContentEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentEncryptionParams"><span class="hs-identifier hs-var hs-var">evContentEncryptionParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#ContentEncryptionParams"><span class="hs-identifier hs-type">ContentEncryptionParams</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Encryption algorithm</span></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="evEncryptedContent"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; content
</span><a href="Crypto.Store.CMS.Enveloped.html#evEncryptedContent"><span class="hs-identifier hs-var hs-var">evEncryptedContent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679156963"><span class="hs-identifier hs-type">content</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Encrypted content info</span></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="evUnprotectedAttrs"><span class="annot"><span class="annottext">forall content. EnvelopedData content -&gt; [Attribute]
</span><a href="Crypto.Store.CMS.Enveloped.html#evUnprotectedAttrs"><span class="hs-identifier hs-var hs-var">evUnprotectedAttrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Crypto.Store.CMS.Attribute.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Optional unprotected attributes</span></span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679157979"><span id="local-6989586621679157993"><span id="local-6989586621679157997"><span class="annot"><span class="annottext">Int -&gt; EnvelopedData content -&gt; ShowS
[EnvelopedData content] -&gt; ShowS
EnvelopedData content -&gt; String
(Int -&gt; EnvelopedData content -&gt; ShowS)
-&gt; (EnvelopedData content -&gt; String)
-&gt; ([EnvelopedData content] -&gt; ShowS)
-&gt; Show (EnvelopedData content)
forall content.
Show content =&gt;
Int -&gt; EnvelopedData content -&gt; ShowS
forall content. Show content =&gt; [EnvelopedData content] -&gt; ShowS
forall content. Show content =&gt; EnvelopedData content -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall content.
Show content =&gt;
Int -&gt; EnvelopedData content -&gt; ShowS
showsPrec :: Int -&gt; EnvelopedData content -&gt; ShowS
$cshow :: forall content. Show content =&gt; EnvelopedData content -&gt; String
show :: EnvelopedData content -&gt; String
$cshowList :: forall content. Show content =&gt; [EnvelopedData content] -&gt; ShowS
showList :: [EnvelopedData content] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679158002"><span id="local-6989586621679158015"><span class="annot"><span class="annottext">EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
(EnvelopedData content -&gt; EnvelopedData content -&gt; Bool)
-&gt; (EnvelopedData content -&gt; EnvelopedData content -&gt; Bool)
-&gt; Eq (EnvelopedData content)
forall content.
Eq content =&gt;
EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall content.
Eq content =&gt;
EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
== :: EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
$c/= :: forall content.
Eq content =&gt;
EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
/= :: EnvelopedData content -&gt; EnvelopedData content -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ProduceASN1Object"><span class="hs-identifier hs-type">ProduceASN1Object</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.ASN1.Generate.html#ASN1P"><span class="hs-identifier hs-type">ASN1P</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Type.html#Encap"><span class="hs-identifier hs-type">Encap</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679158024"><span class="annot"><span class="annottext">asn1s :: EnvelopedData (Encap ByteString) -&gt; ASN1Stream ASN1P
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var hs-var hs-var hs-var">asn1s</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span class="hs-special">{</span><span id="local-6989586621679158025"><span id="local-6989586621679158026"><span id="local-6989586621679158027"><span id="local-6989586621679158028"><span id="local-6989586621679158029"><span id="local-6989586621679158030"><span class="annot"><span class="annottext">[Attribute]
[RecipientInfo]
Encap ByteString
ContentType
OriginatorInfo
ContentEncryptionParams
evOriginatorInfo :: forall content. EnvelopedData content -&gt; OriginatorInfo
evRecipientInfos :: forall content. EnvelopedData content -&gt; [RecipientInfo]
evContentType :: forall content. EnvelopedData content -&gt; ContentType
evContentEncryptionParams :: forall content. EnvelopedData content -&gt; ContentEncryptionParams
evEncryptedContent :: forall content. EnvelopedData content -&gt; content
evUnprotectedAttrs :: forall content. EnvelopedData content -&gt; [Attribute]
evOriginatorInfo :: OriginatorInfo
evRecipientInfos :: [RecipientInfo]
evContentType :: ContentType
evContentEncryptionParams :: ContentEncryptionParams
evEncryptedContent :: Encap ByteString
evUnprotectedAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Enveloped.html#evOriginatorInfo"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Stream ASN1P
</span><a href="#local-6989586621679158031"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P
</span><a href="#local-6989586621679158032"><span class="hs-identifier hs-var">oi</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P
</span><a href="#local-6989586621679158033"><span class="hs-identifier hs-var">ris</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P
</span><a href="#local-6989586621679158034"><span class="hs-identifier hs-var">eci</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P
</span><a href="#local-6989586621679158035"><span class="hs-identifier hs-var">ua</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621679158031"><span class="annot"><span class="annottext">ver :: ASN1Stream ASN1P
</span><a href="#local-6989586621679158031"><span class="hs-identifier hs-var hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ASN1Stream ASN1P
forall e. ASN1Elem e =&gt; Integer -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#gIntVal"><span class="hs-identifier hs-var">gIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679158037"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span id="local-6989586621679158033"><span class="annot"><span class="annottext">ris :: ASN1Stream ASN1P
</span><a href="#local-6989586621679158033"><span class="hs-identifier hs-var hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ASN1Stream ASN1P -&gt; ASN1Stream ASN1P
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; ASN1Stream e -&gt; ASN1Stream e
</span><a href="Crypto.Store.ASN1.Generate.html#asn1Container"><span class="hs-identifier hs-var">asn1Container</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RecipientInfo] -&gt; ASN1Stream ASN1P
forall e obj. ProduceASN1Object e obj =&gt; obj -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Util.html#asn1s"><span class="hs-identifier hs-var">asn1s</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679158026"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>        </span><span id="local-6989586621679158034"><span class="annot"><span class="annottext">eci :: ASN1Stream ASN1P
</span><a href="#local-6989586621679158034"><span class="hs-identifier hs-var hs-var">eci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ContentType, ContentEncryptionParams, Encap ByteString)
-&gt; ASN1Stream ASN1P
forall e alg.
(ASN1Elem e, ProduceASN1Object e alg) =&gt;
(ContentType, alg, Encap ByteString) -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Encrypted.html#encryptedContentInfoASN1S"><span class="hs-identifier hs-var">encryptedContentInfoASN1S</span></a></span><span>
</span><span id="line-451"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679158027"><span class="hs-identifier hs-var">evContentType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679158028"><span class="hs-identifier hs-var">evContentEncryptionParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Encap ByteString
</span><a href="#local-6989586621679158029"><span class="hs-identifier hs-var">evEncryptedContent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>        </span><span id="local-6989586621679158035"><span class="annot"><span class="annottext">ua :: ASN1Stream ASN1P
</span><a href="#local-6989586621679158035"><span class="hs-identifier hs-var hs-var">ua</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream ASN1P
forall e.
ASN1Elem e =&gt;
ASN1ConstructionType -&gt; [Attribute] -&gt; ASN1Stream e
</span><a href="Crypto.Store.CMS.Attribute.html#attributesASN1S"><span class="hs-identifier hs-var">attributesASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679158030"><span class="hs-identifier hs-var">evUnprotectedAttrs</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621679158032"><span class="annot"><span class="annottext">oi :: ASN1Stream ASN1P
</span><a href="#local-6989586621679158032"><span class="hs-identifier hs-var hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158025"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo -&gt; OriginatorInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1Stream ASN1P
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-455"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; OriginatorInfo -&gt; ASN1Stream ASN1P
</span><a href="Crypto.Store.CMS.OriginatorInfo.html#originatorInfoASN1S"><span class="hs-identifier hs-var">originatorInfoASN1S</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158025"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>        </span><span id="local-6989586621679158037"><span class="annot"><span class="annottext">v :: Integer
</span><a href="#local-6989586621679158037"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo -&gt; Bool
forall a. HasChoiceOther a =&gt; a -&gt; Bool
</span><a href="Crypto.Store.CMS.OriginatorInfo.html#hasChoiceOther"><span class="hs-identifier hs-var">hasChoiceOther</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158025"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span>
</span><span id="line-458"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(RecipientInfo -&gt; Bool) -&gt; [RecipientInfo] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo -&gt; Bool
</span><a href="Crypto.Store.CMS.Enveloped.html#isPwriOri"><span class="hs-identifier hs-var">isPwriOri</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679158026"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-459"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158025"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo -&gt; OriginatorInfo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-460"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Attribute] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679158030"><span class="hs-identifier hs-var">evUnprotectedAttrs</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-461"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(RecipientInfo -&gt; Bool) -&gt; [RecipientInfo] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo -&gt; Bool
</span><a href="Crypto.Store.CMS.Enveloped.html#isVersion0"><span class="hs-identifier hs-var">isVersion0</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679158026"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-462"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Util.html#ParseASN1Object"><span class="hs-identifier hs-type">ParseASN1Object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ASN1Event</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Type.html#Encap"><span class="hs-identifier hs-type">Encap</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#EncryptedContent"><span class="hs-identifier hs-type">EncryptedContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679158100"><span class="annot"><span class="annottext">parse :: ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var hs-var hs-var hs-var">parse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>        </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
-&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Sequence</span></span><span> </span><span class="annot"><span class="annottext">(ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
 -&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString)))
-&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
-&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">IntVal</span></span><span> </span><span id="local-6989586621679158101"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679158101"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1 [ASN1Event] ASN1
forall e. Monoid e =&gt; ParseASN1 e ASN1
</span><a href="Crypto.Store.ASN1.Parse.html#getNext"><span class="hs-identifier hs-var">getNext</span></a></span><span>
</span><span id="line-468"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; ParseASN1 [ASN1Event] () -&gt; ParseASN1 [ASN1Event] ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679158101"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParseASN1 [ASN1Event] () -&gt; ParseASN1 [ASN1Event] ())
-&gt; ParseASN1 [ASN1Event] () -&gt; ParseASN1 [ASN1Event] ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-469"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; ParseASN1 [ASN1Event] ()
forall e a. String -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#throwParseError"><span class="hs-identifier hs-var">throwParseError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EnvelopedData: parsed invalid version: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679158101"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>            </span><span id="local-6989586621679158103"><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158103"><span class="hs-identifier hs-var">oi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 [ASN1Event] OriginatorInfo
</span><a href="Crypto.Store.CMS.OriginatorInfo.html#parseOriginatorInfo"><span class="hs-identifier hs-var">parseOriginatorInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParseASN1 [ASN1Event] OriginatorInfo
-&gt; ParseASN1 [ASN1Event] OriginatorInfo
-&gt; ParseASN1 [ASN1Event] OriginatorInfo
forall a.
ParseASN1 [ASN1Event] a
-&gt; ParseASN1 [ASN1Event] a -&gt; ParseASN1 [ASN1Event] a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo -&gt; ParseASN1 [ASN1Event] OriginatorInfo
forall a. a -&gt; ParseASN1 [ASN1Event] a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-471"></span><span>            </span><span id="local-6989586621679158105"><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679158105"><span class="hs-identifier hs-var">ris</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
-&gt; ParseASN1 [ASN1Event] [RecipientInfo]
-&gt; ParseASN1 [ASN1Event] [RecipientInfo]
forall e a.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e a -&gt; ParseASN1 e a
</span><a href="Crypto.Store.ASN1.Parse.html#onNextContainer"><span class="hs-identifier hs-var">onNextContainer</span></a></span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType
</span><span class="hs-identifier hs-var">Set</span></span><span> </span><span class="annot"><span class="annottext">ParseASN1 [ASN1Event] [RecipientInfo]
forall e obj. ParseASN1Object e obj =&gt; ParseASN1 e obj
</span><a href="Crypto.Store.CMS.Util.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679158106"><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679158106"><span class="hs-identifier hs-var">ct</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158107"><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679158107"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158108"><span class="annot"><span class="annottext">Encap ByteString
</span><a href="#local-6989586621679158108"><span class="hs-identifier hs-var">ec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParseASN1
  [ASN1Event]
  (ContentType, ContentEncryptionParams, Encap ByteString)
forall e alg.
ParseASN1Object e alg =&gt;
ParseASN1 e (ContentType, alg, Encap ByteString)
</span><a href="Crypto.Store.CMS.Encrypted.html#parseEncryptedContentInfo"><span class="hs-identifier hs-var">parseEncryptedContentInfo</span></a></span><span>
</span><span id="line-473"></span><span>            </span><span id="local-6989586621679158110"><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679158110"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ASN1ConstructionType -&gt; ParseASN1 [ASN1Event] [Attribute]
forall e.
Monoid e =&gt;
ASN1ConstructionType -&gt; ParseASN1 e [Attribute]
</span><a href="Crypto.Store.CMS.Attribute.html#parseAttributes"><span class="hs-identifier hs-var">parseAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASN1Class -&gt; Int -&gt; ASN1ConstructionType
</span><span class="hs-identifier hs-var">Container</span></span><span> </span><span class="annot"><span class="annottext">ASN1Class
</span><span class="hs-identifier hs-var">Context</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>            </span><span class="annot"><span class="annottext">EnvelopedData (Encap ByteString)
-&gt; ParseASN1 [ASN1Event] (EnvelopedData (Encap ByteString))
forall a. a -&gt; ParseASN1 [ASN1Event] a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EnvelopedData"><span class="hs-identifier hs-type">EnvelopedData</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">evOriginatorInfo :: OriginatorInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#evOriginatorInfo"><span class="hs-identifier hs-var">evOriginatorInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorInfo
</span><a href="#local-6989586621679158103"><span class="hs-identifier hs-var">oi</span></a></span><span>
</span><span id="line-475"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evRecipientInfos :: [RecipientInfo]
</span><a href="Crypto.Store.CMS.Enveloped.html#evRecipientInfos"><span class="hs-identifier hs-var">evRecipientInfos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RecipientInfo]
</span><a href="#local-6989586621679158105"><span class="hs-identifier hs-var">ris</span></a></span><span>
</span><span id="line-476"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evContentType :: ContentType
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentType"><span class="hs-identifier hs-var">evContentType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679158106"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-477"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evContentEncryptionParams :: ContentEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#evContentEncryptionParams"><span class="hs-identifier hs-var">evContentEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContentEncryptionParams
</span><a href="#local-6989586621679158107"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-478"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evEncryptedContent :: Encap ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#evEncryptedContent"><span class="hs-identifier hs-var">evEncryptedContent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encap ByteString
</span><a href="#local-6989586621679158108"><span class="hs-identifier hs-var">ec</span></a></span><span>
</span><span id="line-479"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">evUnprotectedAttrs :: [Attribute]
</span><a href="Crypto.Store.CMS.Enveloped.html#evUnprotectedAttrs"><span class="hs-identifier hs-var">evUnprotectedAttrs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Attribute]
</span><a href="#local-6989586621679158110"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-480"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="annot"><span class="hs-comment">-- | Function able to produce a 'RecipientInfo'.</span></span><span>
</span><span id="line-483"></span><span class="hs-keyword">type</span><span> </span><span id="ProducerOfRI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-var">ProducerOfRI</span></a></span></span><span> </span><span id="local-6989586621679158112"><span class="annot"><a href="#local-6989586621679158112"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158112"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><span class="hs-comment">-- | Function able to consume a 'RecipientInfo'.</span></span><span>
</span><span id="line-486"></span><span class="hs-keyword">type</span><span> </span><span id="ConsumerOfRI"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-var">ConsumerOfRI</span></a></span></span><span> </span><span id="local-6989586621679158114"><span class="annot"><a href="#local-6989586621679158114"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientInfo"><span class="hs-identifier hs-type">RecipientInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Crypto.Store.Error.html#StoreError"><span class="hs-identifier hs-type">StoreError</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Encrypted.html#ContentEncryptionKey"><span class="hs-identifier hs-type">ContentEncryptionKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | Generate a Key Transport recipient from a certificate and</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- desired algorithm.  The recipient will contain certificate identifier.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- This function can be used as parameter to 'Crypto.Store.CMS.envelopData'.</span><span>
</span><span id="line-492"></span><span id="local-6989586621679156998"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyTransRecipient"><span class="hs-identifier hs-type">forKeyTransRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679156998"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-493"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedCertificate</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyTransportParams"><span class="hs-identifier hs-type">KeyTransportParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679156998"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-494"></span><span id="forKeyTransRecipient"><span class="annot"><span class="annottext">forKeyTransRecipient :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
SignedCertificate -&gt; KeyTransportParams -&gt; ProducerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#forKeyTransRecipient"><span class="hs-identifier hs-var hs-var">forKeyTransRecipient</span></a></span></span><span> </span><span id="local-6989586621679158123"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158123"><span class="hs-identifier hs-var">cert</span></a></span></span><span> </span><span id="local-6989586621679158124"><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679158124"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679158125"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158125"><span class="hs-identifier hs-var">inkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679158126"><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158126"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
-&gt; PubKey -&gt; ByteString -&gt; m (Either StoreError ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
KeyTransportParams
-&gt; PubKey -&gt; ByteString -&gt; m (Either StoreError ByteString)
</span><a href="Crypto.Store.CMS.Algorithms.html#transportEncrypt"><span class="hs-identifier hs-var">transportEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679158124"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; PubKey
</span><span class="hs-identifier hs-var">certPubKey</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158129"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158125"><span class="hs-identifier hs-var">inkey</span></a></span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KTRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-var">KTRI</span></a></span><span> </span><span class="annot"><span class="annottext">(KTRecipientInfo -&gt; RecipientInfo)
-&gt; (ByteString -&gt; KTRecipientInfo) -&gt; ByteString -&gt; RecipientInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; KTRecipientInfo
</span><a href="#local-6989586621679158130"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RecipientInfo)
-&gt; Either StoreError ByteString -&gt; Either StoreError RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158126"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>    </span><span id="local-6989586621679158129"><span class="annot"><span class="annottext">obj :: Certificate
</span><a href="#local-6989586621679158129"><span class="hs-identifier hs-var hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signed Certificate -&gt; Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; Signed a -&gt; a
</span><span class="hs-identifier hs-var">signedObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedCertificate -&gt; Signed Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; SignedExact a -&gt; Signed a
</span><span class="hs-identifier hs-var">getSigned</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158123"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621679158137"><span class="annot"><span class="annottext">isn :: IssuerAndSerialNumber
</span><a href="#local-6989586621679158137"><span class="hs-identifier hs-var hs-var">isn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; Integer -&gt; IssuerAndSerialNumber
</span><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-var">IssuerAndSerialNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; DistinguishedName
</span><span class="hs-identifier hs-var">certIssuerDN</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158129"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; Integer
</span><span class="hs-identifier hs-var">certSerial</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158129"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621679158130"><span class="annot"><span class="annottext">build :: ByteString -&gt; KTRecipientInfo
</span><a href="#local-6989586621679158130"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679158138"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158138"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-type">KTRecipientInfo</span></a></span><span>
</span><span id="line-502"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ktRid :: RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-identifier hs-var">ktRid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; RecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#RecipientIASN"><span class="hs-identifier hs-var">RecipientIASN</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679158137"><span class="hs-identifier hs-var">isn</span></a></span><span>
</span><span id="line-503"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ktKeyTransportParams :: KeyTransportParams
</span><a href="Crypto.Store.CMS.Enveloped.html#ktKeyTransportParams"><span class="hs-identifier hs-var">ktKeyTransportParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679158124"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-504"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ktEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#ktEncryptedKey"><span class="hs-identifier hs-var">ktEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158138"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-505"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- | Use a Key Transport recipient, knowing the private key.</span><span>
</span><span id="line-508"></span><span class="hs-comment">--</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- This function can be used as parameter to</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- 'Crypto.Store.CMS.openEnvelopedData'.</span><span>
</span><span id="line-511"></span><span id="local-6989586621679157007"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyTrans"><span class="hs-identifier hs-type">withRecipientKeyTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679157007"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157007"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-512"></span><span id="withRecipientKeyTrans"><span class="annot"><span class="annottext">withRecipientKeyTrans :: forall (m :: * -&gt; *). MonadRandom m =&gt; PrivKey -&gt; ConsumerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyTrans"><span class="hs-identifier hs-var hs-var">withRecipientKeyTrans</span></a></span></span><span> </span><span id="local-6989586621679158145"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679158145"><span class="hs-identifier hs-var">privKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRI"><span class="hs-identifier hs-type">KTRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KTRecipientInfo"><span class="hs-identifier hs-type">KTRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679158146"><span id="local-6989586621679158147"><span id="local-6989586621679158148"><span class="annot"><span class="annottext">ByteString
KeyTransportParams
RecipientIdentifier
ktRid :: KTRecipientInfo -&gt; RecipientIdentifier
ktKeyTransportParams :: KTRecipientInfo -&gt; KeyTransportParams
ktEncryptedKey :: KTRecipientInfo -&gt; ByteString
ktRid :: RecipientIdentifier
ktKeyTransportParams :: KeyTransportParams
ktEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#ktRid"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">KeyTransportParams
-&gt; PrivKey -&gt; ByteString -&gt; m (Either StoreError ByteString)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
KeyTransportParams
-&gt; PrivKey -&gt; ByteString -&gt; m (Either StoreError ByteString)
</span><a href="Crypto.Store.CMS.Algorithms.html#transportDecrypt"><span class="hs-identifier hs-var">transportDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">KeyTransportParams
</span><a href="#local-6989586621679158147"><span class="hs-identifier hs-var">ktKeyTransportParams</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679158145"><span class="hs-identifier hs-var">privKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158148"><span class="hs-identifier hs-var">ktEncryptedKey</span></a></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyTrans"><span class="hs-identifier hs-var">withRecipientKeyTrans</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; m (Either StoreError ByteString)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#RecipientTypeMismatch"><span class="hs-identifier hs-var">RecipientTypeMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | Generate a Key Agreement recipient from a certificate and</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- desired algorithm.  The recipient info will contain an ephemeral public key.</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- This function can be used as parameter to 'Crypto.Store.CMS.envelopData'.</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- To avoid decreasing the security strength, Key Encryption parameters should</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- use a key size equal or greater than the content encryption key.</span><span>
</span><span id="line-523"></span><span id="local-6989586621679157016"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyAgreeRecipient"><span class="hs-identifier hs-type">forKeyAgreeRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679157016"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-524"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedCertificate</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyAgreementParams"><span class="hs-identifier hs-type">KeyAgreementParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157016"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-525"></span><span id="forKeyAgreeRecipient"><span class="annot"><span class="annottext">forKeyAgreeRecipient :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
SignedCertificate -&gt; KeyAgreementParams -&gt; ProducerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#forKeyAgreeRecipient"><span class="hs-identifier hs-var hs-var">forKeyAgreeRecipient</span></a></span></span><span> </span><span id="local-6989586621679158162"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158162"><span class="hs-identifier hs-var">cert</span></a></span></span><span> </span><span id="local-6989586621679158163"><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679158163"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679158164"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158164"><span class="hs-identifier hs-var">inkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>    </span><span id="local-6989586621679158165"><span class="annot"><span class="annottext">Either StoreError ECDHPair
</span><a href="#local-6989586621679158165"><span class="hs-identifier hs-var">ephemeral</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PubKey -&gt; m (Either StoreError ECDHPair)
forall (m :: * -&gt; *).
MonadRandom m =&gt;
PubKey -&gt; m (Either StoreError ECDHPair)
</span><a href="Crypto.Store.CMS.Algorithms.html#ecdhGenerate"><span class="hs-identifier hs-var">ecdhGenerate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; PubKey
</span><span class="hs-identifier hs-var">certPubKey</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158167"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either StoreError ECDHPair
</span><a href="#local-6989586621679158165"><span class="hs-identifier hs-var">ephemeral</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-528"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679158168"><span class="annot"><span class="annottext">ECDHPair
</span><a href="#local-6989586621679158168"><span class="hs-identifier hs-var">pair</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158169"><span class="annot"><span class="annottext">pt :: ByteString
</span><a href="#local-6989586621679158169"><span class="hs-identifier hs-var hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ECDHPair -&gt; ByteString
</span><a href="Crypto.Store.CMS.Algorithms.html#ecdhPublic"><span class="hs-identifier hs-var">ecdhPublic</span></a></span><span> </span><span class="annot"><span class="annottext">ECDHPair
</span><a href="#local-6989586621679158168"><span class="hs-identifier hs-var">pair</span></a></span><span>
</span><span id="line-530"></span><span>                </span><span id="local-6989586621679158171"><span class="annot"><span class="annottext">aPub :: OriginatorPublicKey
</span><a href="#local-6989586621679158171"><span class="hs-identifier hs-var hs-var">aPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ASN1] -&gt; BitArray -&gt; OriginatorPublicKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKeyEC"><span class="hs-identifier hs-var">OriginatorPublicKeyEC</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; BitArray
</span><span class="hs-identifier hs-var">toBitArray</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158169"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>            </span><span id="local-6989586621679158173"><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158173"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
-&gt; Maybe ByteString
-&gt; ECDHPair
-&gt; ByteString
-&gt; m (Either StoreError ByteString)
forall (m :: * -&gt; *) ba.
(MonadRandom m, ByteArray ba) =&gt;
KeyAgreementParams
-&gt; Maybe ByteString -&gt; ECDHPair -&gt; ba -&gt; m (Either StoreError ba)
</span><a href="Crypto.Store.CMS.Algorithms.html#ecdhEncrypt"><span class="hs-identifier hs-var">ecdhEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679158163"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ECDHPair
</span><a href="#local-6989586621679158168"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158164"><span class="hs-identifier hs-var">inkey</span></a></span><span>
</span><span id="line-532"></span><span>            </span><span class="annot"><span class="annottext">Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KARecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-var">KARI</span></a></span><span> </span><span class="annot"><span class="annottext">(KARecipientInfo -&gt; RecipientInfo)
-&gt; (ByteString -&gt; KARecipientInfo) -&gt; ByteString -&gt; RecipientInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey -&gt; ByteString -&gt; KARecipientInfo
</span><a href="#local-6989586621679158175"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey
</span><a href="#local-6989586621679158171"><span class="hs-identifier hs-var">aPub</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RecipientInfo)
-&gt; Either StoreError ByteString -&gt; Either StoreError RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158173"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679158176"><span class="annot"><span class="annottext">StoreError
</span><a href="#local-6989586621679158176"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either StoreError RecipientInfo
 -&gt; m (Either StoreError RecipientInfo))
-&gt; Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError RecipientInfo
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="#local-6989586621679158176"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621679158167"><span class="annot"><span class="annottext">obj :: Certificate
</span><a href="#local-6989586621679158167"><span class="hs-identifier hs-var hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signed Certificate -&gt; Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; Signed a -&gt; a
</span><span class="hs-identifier hs-var">signedObject</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignedCertificate -&gt; Signed Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; SignedExact a -&gt; Signed a
</span><span class="hs-identifier hs-var">getSigned</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158162"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679158183"><span class="annot"><span class="annottext">isn :: IssuerAndSerialNumber
</span><a href="#local-6989586621679158183"><span class="hs-identifier hs-var hs-var">isn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; Integer -&gt; IssuerAndSerialNumber
</span><a href="Crypto.Store.CMS.Enveloped.html#IssuerAndSerialNumber"><span class="hs-identifier hs-var">IssuerAndSerialNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; DistinguishedName
</span><span class="hs-identifier hs-var">certIssuerDN</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158167"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certificate -&gt; Integer
</span><span class="hs-identifier hs-var">certSerial</span></span><span> </span><span class="annot"><span class="annottext">Certificate
</span><a href="#local-6989586621679158167"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679158184"><span class="annot"><span class="annottext">makeREK :: ByteString -&gt; RecipientEncryptedKey
</span><a href="#local-6989586621679158184"><span class="hs-identifier hs-var hs-var">makeREK</span></a></span></span><span> </span><span id="local-6989586621679158185"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158185"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#RecipientEncryptedKey"><span class="hs-identifier hs-type">RecipientEncryptedKey</span></a></span><span>
</span><span id="line-539"></span><span>                     </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rekRid :: KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#rekRid"><span class="hs-identifier hs-var">rekRid</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber -&gt; KeyAgreeRecipientIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#KeyAgreeRecipientIASN"><span class="hs-identifier hs-var">KeyAgreeRecipientIASN</span></a></span><span> </span><span class="annot"><span class="annottext">IssuerAndSerialNumber
</span><a href="#local-6989586621679158183"><span class="hs-identifier hs-var">isn</span></a></span><span>
</span><span id="line-540"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#rekEncryptedKey"><span class="hs-identifier hs-var">rekEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158185"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-541"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621679158175"><span class="annot"><span class="annottext">build :: OriginatorPublicKey -&gt; ByteString -&gt; KARecipientInfo
</span><a href="#local-6989586621679158175"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679158186"><span class="annot"><span class="annottext">OriginatorPublicKey
</span><a href="#local-6989586621679158186"><span class="hs-identifier hs-var">aPub</span></a></span></span><span> </span><span id="local-6989586621679158187"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158187"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>        </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-type">KARecipientInfo</span></a></span><span>
</span><span id="line-545"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kaOriginator :: OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#kaOriginator"><span class="hs-identifier hs-var">kaOriginator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey -&gt; OriginatorIdentifierOrKey
</span><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublic"><span class="hs-identifier hs-var">OriginatorPublic</span></a></span><span> </span><span class="annot"><span class="annottext">OriginatorPublicKey
</span><a href="#local-6989586621679158186"><span class="hs-identifier hs-var">aPub</span></a></span><span>
</span><span id="line-546"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaUkm :: Maybe ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kaUkm"><span class="hs-identifier hs-var">kaUkm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-547"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaKeyAgreementParams :: KeyAgreementParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kaKeyAgreementParams"><span class="hs-identifier hs-var">kaKeyAgreementParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679158163"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-548"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kaRecipientEncryptedKeys :: [RecipientEncryptedKey]
</span><a href="Crypto.Store.CMS.Enveloped.html#kaRecipientEncryptedKeys"><span class="hs-identifier hs-var">kaRecipientEncryptedKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RecipientEncryptedKey
</span><a href="#local-6989586621679158184"><span class="hs-identifier hs-var">makeREK</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158187"><span class="hs-identifier hs-var">ek</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-549"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- | Use a Key Agreement recipient, knowing the recipient private key.  The</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- recipient certificate is also required to locate which encrypted key to use.</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- This function can be used as parameter to</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- 'Crypto.Store.CMS.openEnvelopedData'.</span><span>
</span><span id="line-556"></span><span id="local-6989586621679157023"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyAgree"><span class="hs-identifier hs-type">withRecipientKeyAgree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679157023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SignedCertificate</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157023"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-557"></span><span id="withRecipientKeyAgree"><span class="annot"><span class="annottext">withRecipientKeyAgree :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
PrivKey -&gt; SignedCertificate -&gt; ConsumerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyAgree"><span class="hs-identifier hs-var hs-var">withRecipientKeyAgree</span></a></span></span><span> </span><span id="local-6989586621679158196"><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679158196"><span class="hs-identifier hs-var">priv</span></a></span></span><span> </span><span id="local-6989586621679158197"><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158197"><span class="hs-identifier hs-var">cert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARI"><span class="hs-identifier hs-type">KARI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KARecipientInfo"><span class="hs-identifier hs-type">KARecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679158198"><span id="local-6989586621679158199"><span id="local-6989586621679158200"><span id="local-6989586621679158201"><span class="annot"><span class="annottext">[RecipientEncryptedKey]
Maybe ByteString
KeyAgreementParams
OriginatorIdentifierOrKey
kaOriginator :: KARecipientInfo -&gt; OriginatorIdentifierOrKey
kaUkm :: KARecipientInfo -&gt; Maybe ByteString
kaKeyAgreementParams :: KARecipientInfo -&gt; KeyAgreementParams
kaRecipientEncryptedKeys :: KARecipientInfo -&gt; [RecipientEncryptedKey]
kaOriginator :: OriginatorIdentifierOrKey
kaUkm :: Maybe ByteString
kaKeyAgreementParams :: KeyAgreementParams
kaRecipientEncryptedKeys :: [RecipientEncryptedKey]
</span><a href="Crypto.Store.CMS.Enveloped.html#kaOriginator"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OriginatorIdentifierOrKey
</span><a href="#local-6989586621679158198"><span class="hs-identifier hs-var">kaOriginator</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-559"></span><span>        </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublic"><span class="hs-identifier hs-type">OriginatorPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#OriginatorPublicKeyEC"><span class="hs-identifier hs-type">OriginatorPublicKeyEC</span></a></span><span> </span><span class="annot"><span class="annottext">[ASN1]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679158202"><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679158202"><span class="hs-identifier hs-var">ba</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-560"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SignedCertificate -&gt; [RecipientEncryptedKey] -&gt; Maybe ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#findRecipientEncryptedKey"><span class="hs-identifier hs-var">findRecipientEncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><a href="#local-6989586621679158197"><span class="hs-identifier hs-var">cert</span></a></span><span> </span><span class="annot"><span class="annottext">[RecipientEncryptedKey]
</span><a href="#local-6989586621679158201"><span class="hs-identifier hs-var">kaRecipientEncryptedKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-561"></span><span>                </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; m (Either StoreError ByteString)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#RecipientKeyNotFound"><span class="hs-identifier hs-var">RecipientKeyNotFound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679158204"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158204"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-563"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158205"><span class="annot"><span class="annottext">pub :: ByteString
</span><a href="#local-6989586621679158205"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BitArray -&gt; ByteString
</span><span class="hs-identifier hs-var">bitArrayGetData</span></span><span> </span><span class="annot"><span class="annottext">BitArray
</span><a href="#local-6989586621679158202"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-564"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; m (Either StoreError ByteString)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyAgreementParams
-&gt; Maybe ByteString
-&gt; PrivKey
-&gt; ByteString
-&gt; ByteString
-&gt; Either StoreError ByteString
forall ba.
ByteArray ba =&gt;
KeyAgreementParams
-&gt; Maybe ByteString
-&gt; PrivKey
-&gt; ByteString
-&gt; ba
-&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#ecdhDecrypt"><span class="hs-identifier hs-var">ecdhDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">KeyAgreementParams
</span><a href="#local-6989586621679158200"><span class="hs-identifier hs-var">kaKeyAgreementParams</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679158199"><span class="hs-identifier hs-var">kaUkm</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><a href="#local-6989586621679158196"><span class="hs-identifier hs-var">priv</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158205"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158204"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>        </span><span class="annot"><span class="annottext">OriginatorIdentifierOrKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; m (Either StoreError ByteString)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#UnsupportedOriginatorFormat"><span class="hs-identifier hs-var">UnsupportedOriginatorFormat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKeyAgree"><span class="hs-identifier hs-var">withRecipientKeyAgree</span></a></span><span> </span><span class="annot"><span class="annottext">PrivKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; m (Either StoreError ByteString)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#RecipientTypeMismatch"><span class="hs-identifier hs-var">RecipientTypeMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-comment">-- | Generate a Key Encryption Key recipient from a key encryption key and</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- desired algorithm.  The recipient may identify the KEK that was used with</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- the supplied identifier.</span><span>
</span><span id="line-571"></span><span class="hs-comment">--</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- This function can be used as parameter to 'Crypto.Store.CMS.envelopData'.</span><span>
</span><span id="line-573"></span><span class="hs-comment">--</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- To avoid decreasing the security strength, Key Encryption parameters should</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- use a key size equal or greater than the content encryption key.</span><span>
</span><span id="line-576"></span><span id="local-6989586621679157026"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forKeyRecipient"><span class="hs-identifier hs-type">forKeyRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679157026"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-577"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyEncryptionKey"><span class="hs-identifier hs-type">KeyEncryptionKey</span></a></span><span>
</span><span id="line-578"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyIdentifier"><span class="hs-identifier hs-type">KeyIdentifier</span></a></span><span>
</span><span id="line-579"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyEncryptionParams"><span class="hs-identifier hs-type">KeyEncryptionParams</span></a></span><span>
</span><span id="line-580"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157026"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-581"></span><span id="forKeyRecipient"><span class="annot"><span class="annottext">forKeyRecipient :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
ByteString
-&gt; KeyIdentifier -&gt; KeyEncryptionParams -&gt; ProducerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#forKeyRecipient"><span class="hs-identifier hs-var hs-var">forKeyRecipient</span></a></span></span><span> </span><span id="local-6989586621679158217"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158217"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679158218"><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679158218"><span class="hs-identifier hs-var">kid</span></a></span></span><span> </span><span id="local-6989586621679158219"><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158219"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679158220"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158220"><span class="hs-identifier hs-var">inkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679158221"><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158221"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; KeyEncryptionParams
-&gt; ByteString
-&gt; m (Either StoreError ByteString)
forall (m :: * -&gt; *) kek ba.
(MonadRandom m, ByteArray kek, ByteArray ba) =&gt;
kek -&gt; KeyEncryptionParams -&gt; ba -&gt; m (Either StoreError ba)
</span><a href="Crypto.Store.CMS.Algorithms.html#keyEncrypt"><span class="hs-identifier hs-var">keyEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158217"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158219"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158220"><span class="hs-identifier hs-var">inkey</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KEKRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-var">KEKRI</span></a></span><span> </span><span class="annot"><span class="annottext">(KEKRecipientInfo -&gt; RecipientInfo)
-&gt; (ByteString -&gt; KEKRecipientInfo) -&gt; ByteString -&gt; RecipientInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; KEKRecipientInfo
</span><a href="#local-6989586621679158223"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RecipientInfo)
-&gt; Either StoreError ByteString -&gt; Either StoreError RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158221"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621679158223"><span class="annot"><span class="annottext">build :: ByteString -&gt; KEKRecipientInfo
</span><a href="#local-6989586621679158223"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679158224"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158224"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-type">KEKRecipientInfo</span></a></span><span>
</span><span id="line-586"></span><span>                   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kekId :: KeyIdentifier
</span><a href="Crypto.Store.CMS.Enveloped.html#kekId"><span class="hs-identifier hs-var">kekId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyIdentifier
</span><a href="#local-6989586621679158218"><span class="hs-identifier hs-var">kid</span></a></span><span>
</span><span id="line-587"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kekKeyEncryptionParams :: KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#kekKeyEncryptionParams"><span class="hs-identifier hs-var">kekKeyEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158219"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-588"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">kekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kekEncryptedKey"><span class="hs-identifier hs-var">kekEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158224"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-589"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-comment">-- | Use a Key Encryption Key recipient, knowing the key encryption key.</span><span>
</span><span id="line-592"></span><span class="hs-comment">--</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- This function can be used as parameter to</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- 'Crypto.Store.CMS.openEnvelopedData'.</span><span>
</span><span id="line-595"></span><span id="local-6989586621679157031"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKey"><span class="hs-identifier hs-type">withRecipientKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679157031"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KeyEncryptionKey"><span class="hs-identifier hs-type">KeyEncryptionKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157031"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-596"></span><span id="withRecipientKey"><span class="annot"><span class="annottext">withRecipientKey :: forall (f :: * -&gt; *). Applicative f =&gt; ByteString -&gt; ConsumerOfRI f
</span><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKey"><span class="hs-identifier hs-var hs-var">withRecipientKey</span></a></span></span><span> </span><span id="local-6989586621679158230"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158230"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRI"><span class="hs-identifier hs-type">KEKRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#KEKRecipientInfo"><span class="hs-identifier hs-type">KEKRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679158231"><span id="local-6989586621679158232"><span id="local-6989586621679158233"><span class="annot"><span class="annottext">ByteString
KeyEncryptionParams
KeyIdentifier
kekId :: KEKRecipientInfo -&gt; KeyIdentifier
kekKeyEncryptionParams :: KEKRecipientInfo -&gt; KeyEncryptionParams
kekEncryptedKey :: KEKRecipientInfo -&gt; ByteString
kekId :: KeyIdentifier
kekKeyEncryptionParams :: KeyEncryptionParams
kekEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#kekId"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; f (Either StoreError ByteString)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
-&gt; KeyEncryptionParams
-&gt; ByteString
-&gt; Either StoreError ByteString
forall kek ba.
(ByteArray kek, ByteArray ba) =&gt;
kek -&gt; KeyEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#keyDecrypt"><span class="hs-identifier hs-var">keyDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158230"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158232"><span class="hs-identifier hs-var">kekKeyEncryptionParams</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158233"><span class="hs-identifier hs-var">kekEncryptedKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientKey"><span class="hs-identifier hs-var">withRecipientKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; f (Either StoreError ByteString)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#RecipientTypeMismatch"><span class="hs-identifier hs-var">RecipientTypeMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- | Generate a password recipient from a password.</span><span>
</span><span id="line-601"></span><span class="hs-comment">--</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- This function can be used as parameter to 'Crypto.Store.CMS.envelopData'.</span><span>
</span><span id="line-603"></span><span id="local-6989586621679157035"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#forPasswordRecipient"><span class="hs-identifier hs-type">forPasswordRecipient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679157035"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-604"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#Password"><span class="hs-identifier hs-type">Password</span></a></span><span>
</span><span id="line-605"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyDerivationFunc"><span class="hs-identifier hs-type">KeyDerivationFunc</span></a></span><span>
</span><span id="line-606"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Algorithms.html#KeyEncryptionParams"><span class="hs-identifier hs-type">KeyEncryptionParams</span></a></span><span>
</span><span id="line-607"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ProducerOfRI"><span class="hs-identifier hs-type">ProducerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679157035"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-608"></span><span id="forPasswordRecipient"><span class="annot"><span class="annottext">forPasswordRecipient :: forall (m :: * -&gt; *).
MonadRandom m =&gt;
ByteString
-&gt; KeyDerivationFunc -&gt; KeyEncryptionParams -&gt; ProducerOfRI m
</span><a href="Crypto.Store.CMS.Enveloped.html#forPasswordRecipient"><span class="hs-identifier hs-var hs-var">forPasswordRecipient</span></a></span></span><span> </span><span id="local-6989586621679158243"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158243"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span id="local-6989586621679158244"><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158244"><span class="hs-identifier hs-var">kdf</span></a></span></span><span> </span><span id="local-6989586621679158245"><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158245"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679158246"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158246"><span class="hs-identifier hs-var">inkey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>    </span><span id="local-6989586621679158247"><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158247"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; KeyEncryptionParams
-&gt; ByteString
-&gt; m (Either StoreError ByteString)
forall (m :: * -&gt; *) kek ba.
(MonadRandom m, ByteArray kek, ByteArray ba) =&gt;
kek -&gt; KeyEncryptionParams -&gt; ba -&gt; m (Either StoreError ba)
</span><a href="Crypto.Store.CMS.Algorithms.html#keyEncrypt"><span class="hs-identifier hs-var">keyEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158248"><span class="hs-identifier hs-var">derived</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158245"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158246"><span class="hs-identifier hs-var">inkey</span></a></span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError RecipientInfo
-&gt; m (Either StoreError RecipientInfo)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PasswordRecipientInfo -&gt; RecipientInfo
</span><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-var">PasswordRI</span></a></span><span> </span><span class="annot"><span class="annottext">(PasswordRecipientInfo -&gt; RecipientInfo)
-&gt; (ByteString -&gt; PasswordRecipientInfo)
-&gt; ByteString
-&gt; RecipientInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PasswordRecipientInfo
</span><a href="#local-6989586621679158249"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RecipientInfo)
-&gt; Either StoreError ByteString -&gt; Either StoreError RecipientInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString
</span><a href="#local-6989586621679158247"><span class="hs-identifier hs-var">ek</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679158248"><span class="annot"><span class="annottext">derived :: ByteString
</span><a href="#local-6989586621679158248"><span class="hs-identifier hs-var hs-var">derived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc -&gt; Int -&gt; ByteString -&gt; ByteString
forall password out.
(ByteArrayAccess password, ByteArray out) =&gt;
KeyDerivationFunc -&gt; Int -&gt; password -&gt; out
</span><a href="Crypto.Store.CMS.Algorithms.html#kdfDerive"><span class="hs-identifier hs-var">kdfDerive</span></a></span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158244"><span class="hs-identifier hs-var">kdf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158254"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158243"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span id="local-6989586621679158254"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679158254"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyEncryptionParams -&gt; Int
forall params. HasKeySize params =&gt; params -&gt; Int
</span><a href="Crypto.Store.CMS.Algorithms.html#getMaximumKeySize"><span class="hs-identifier hs-var">getMaximumKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158245"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyDerivationFunc -&gt; Maybe Int
</span><a href="Crypto.Store.CMS.Algorithms.html#kdfKeyLength"><span class="hs-identifier hs-var">kdfKeyLength</span></a></span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158244"><span class="hs-identifier hs-var">kdf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>    </span><span id="local-6989586621679158249"><span class="annot"><span class="annottext">build :: ByteString -&gt; PasswordRecipientInfo
</span><a href="#local-6989586621679158249"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679158259"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158259"><span class="hs-identifier hs-var">ek</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-type">PasswordRecipientInfo</span></a></span><span>
</span><span id="line-615"></span><span>                   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">priKeyDerivationFunc :: KeyDerivationFunc
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyDerivationFunc"><span class="hs-identifier hs-var">priKeyDerivationFunc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158244"><span class="hs-identifier hs-var">kdf</span></a></span><span>
</span><span id="line-616"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">priKeyEncryptionParams :: KeyEncryptionParams
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyEncryptionParams"><span class="hs-identifier hs-var">priKeyEncryptionParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158245"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-617"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">priEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#priEncryptedKey"><span class="hs-identifier hs-var">priEncryptedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158259"><span class="hs-identifier hs-var">ek</span></a></span><span>
</span><span id="line-618"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-comment">-- | Use a password recipient, knowing the password.</span><span>
</span><span id="line-621"></span><span class="hs-comment">--</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- This function can be used as parameter to</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- 'Crypto.Store.CMS.openEnvelopedData'.</span><span>
</span><span id="line-624"></span><span id="local-6989586621679158260"><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientPassword"><span class="hs-identifier hs-type">withRecipientPassword</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679158260"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#Password"><span class="hs-identifier hs-type">Password</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#ConsumerOfRI"><span class="hs-identifier hs-type">ConsumerOfRI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158260"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-625"></span><span id="withRecipientPassword"><span class="annot"><span class="annottext">withRecipientPassword :: forall (f :: * -&gt; *). Applicative f =&gt; ByteString -&gt; ConsumerOfRI f
</span><a href="Crypto.Store.CMS.Enveloped.html#withRecipientPassword"><span class="hs-identifier hs-var hs-var">withRecipientPassword</span></a></span></span><span> </span><span id="local-6989586621679158266"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158266"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRI"><span class="hs-identifier hs-type">PasswordRI</span></a></span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#PasswordRecipientInfo"><span class="hs-identifier hs-type">PasswordRecipientInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679158267"><span id="local-6989586621679158268"><span id="local-6989586621679158269"><span class="annot"><span class="annottext">ByteString
KeyEncryptionParams
KeyDerivationFunc
priKeyDerivationFunc :: PasswordRecipientInfo -&gt; KeyDerivationFunc
priKeyEncryptionParams :: PasswordRecipientInfo -&gt; KeyEncryptionParams
priEncryptedKey :: PasswordRecipientInfo -&gt; ByteString
priKeyDerivationFunc :: KeyDerivationFunc
priKeyEncryptionParams :: KeyEncryptionParams
priEncryptedKey :: ByteString
</span><a href="Crypto.Store.CMS.Enveloped.html#priKeyDerivationFunc"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-626"></span><span>    </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; f (Either StoreError ByteString)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
-&gt; KeyEncryptionParams
-&gt; ByteString
-&gt; Either StoreError ByteString
forall kek ba.
(ByteArray kek, ByteArray ba) =&gt;
kek -&gt; KeyEncryptionParams -&gt; ba -&gt; Either StoreError ba
</span><a href="Crypto.Store.CMS.Algorithms.html#keyDecrypt"><span class="hs-identifier hs-var">keyDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158270"><span class="hs-identifier hs-var">derived</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158268"><span class="hs-identifier hs-var">priKeyEncryptionParams</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158269"><span class="hs-identifier hs-var">priEncryptedKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621679158270"><span class="annot"><span class="annottext">derived :: ByteString
</span><a href="#local-6989586621679158270"><span class="hs-identifier hs-var hs-var">derived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc -&gt; Int -&gt; ByteString -&gt; ByteString
forall password out.
(ByteArrayAccess password, ByteArray out) =&gt;
KeyDerivationFunc -&gt; Int -&gt; password -&gt; out
</span><a href="Crypto.Store.CMS.Algorithms.html#kdfDerive"><span class="hs-identifier hs-var">kdfDerive</span></a></span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158267"><span class="hs-identifier hs-var">priKeyDerivationFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158273"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158266"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679158273"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679158273"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyEncryptionParams -&gt; Int
forall params. HasKeySize params =&gt; params -&gt; Int
</span><a href="Crypto.Store.CMS.Algorithms.html#getMaximumKeySize"><span class="hs-identifier hs-var">getMaximumKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">KeyEncryptionParams
</span><a href="#local-6989586621679158268"><span class="hs-identifier hs-var">priKeyEncryptionParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyDerivationFunc -&gt; Maybe Int
</span><a href="Crypto.Store.CMS.Algorithms.html#kdfKeyLength"><span class="hs-identifier hs-var">kdfKeyLength</span></a></span><span> </span><span class="annot"><span class="annottext">KeyDerivationFunc
</span><a href="#local-6989586621679158267"><span class="hs-identifier hs-var">priKeyDerivationFunc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span class="annot"><a href="Crypto.Store.CMS.Enveloped.html#withRecipientPassword"><span class="hs-identifier hs-var">withRecipientPassword</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RecipientInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either StoreError ByteString -&gt; f (Either StoreError ByteString)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StoreError -&gt; Either StoreError ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">StoreError
</span><a href="Crypto.Store.Error.html#RecipientTypeMismatch"><span class="hs-identifier hs-var">RecipientTypeMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span></pre></body></html>