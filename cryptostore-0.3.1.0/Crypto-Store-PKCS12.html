<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Crypto.Store.PKCS12</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cryptostore-0.3.1.0: Serialization of cryptographic data types</span><ul class="links" id="page-menu"><li><a href="src/Crypto.Store.PKCS12.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>unknown</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Crypto.Store.PKCS12</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">PKCS #12 privacy</a></li><li><a href="#g:2">PKCS #12 contents and bags</a></li><li><a href="#g:3">PKCS #12 attributes</a></li><li><a href="#g:4">Credentials</a></li><li><a href="#g:5">Password-based protection</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Personal Information Exchange Syntax, aka PKCS #12.</p><p>Only password integrity mode and password privacy modes are supported.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:IntegrityParams">IntegrityParams</a> = (<a href="Crypto-Store-CMS.html#t:DigestAlgorithm" title="Crypto.Store.CMS">DigestAlgorithm</a>, <a href="Crypto-Store-PKCS5.html#t:PBEParameter" title="Crypto.Store.PKCS5">PBEParameter</a>)</li><li class="src short"><a href="#v:readP12File">readP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a>))</li><li class="src short"><a href="#v:readP12FileFromMemory">readP12FileFromMemory</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a>)</li><li class="src short"><a href="#v:writeP12File">writeP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:IntegrityParams" title="Crypto.Store.PKCS12">IntegrityParams</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> ())</li><li class="src short"><a href="#v:writeP12FileToMemory">writeP12FileToMemory</a> :: <a href="Crypto-Store-PKCS12.html#t:IntegrityParams" title="Crypto.Store.PKCS12">IntegrityParams</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:writeUnprotectedP12File">writeUnprotectedP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:writeUnprotectedP12FileToMemory">writeUnprotectedP12FileToMemory</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:PKCS12">PKCS12</a></li><li class="src short"><a href="#v:unPKCS12">unPKCS12</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>]</li><li class="src short"><a href="#v:unPKCS12-39-">unPKCS12'</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>]</li><li class="src short"><a href="#v:unencrypted">unencrypted</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></li><li class="src short"><a href="#v:encrypted">encrypted</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:SafeContents">SafeContents</a> = <a href="#v:SafeContents">SafeContents</a> {<ul class="subs"><li><a href="#v:unSafeContents">unSafeContents</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeBag" title="Crypto.Store.PKCS12">SafeBag</a>]</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:SafeBag">SafeBag</a> = <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Bag">Bag</a> info = <a href="#v:Bag">Bag</a> {<ul class="subs"><li><a href="#v:bagInfo">bagInfo</a> :: info</li><li><a href="#v:bagAttributes">bagAttributes</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:SafeInfo">SafeInfo</a><ul class="subs"><li>= <a href="#v:KeyBag">KeyBag</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)</li><li>| <a href="#v:PKCS8ShroudedKeyBag">PKCS8ShroudedKeyBag</a> <a href="Crypto-Store-PKCS5.html#t:PKCS5" title="Crypto.Store.PKCS5">PKCS5</a></li><li>| <a href="#v:CertBag">CertBag</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a>)</li><li>| <a href="#v:CRLBag">CRLBag</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a>)</li><li>| <a href="#v:SecretBag">SecretBag</a> [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]</li><li>| <a href="#v:SafeContentsBag">SafeContentsBag</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a></li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:CertInfo">CertInfo</a> = <a href="#v:CertX509">CertX509</a> <a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:CRLInfo">CRLInfo</a> = <a href="#v:CRLX509">CRLX509</a> <a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Attribute">Attribute</a> = <a href="#v:Attribute">Attribute</a> {<ul class="subs"><li><a href="#v:attrType">attrType</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a></li><li><a href="#v:attrValues">attrValues</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]</li></ul>}</li><li class="src short"><a href="#v:getSafeKeys">getSafeKeys</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>]</li><li class="src short"><a href="#v:getAllSafeKeys">getAllSafeKeys</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>]</li><li class="src short"><a href="#v:getSafeX509Certs">getSafeX509Certs</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a>]</li><li class="src short"><a href="#v:getAllSafeX509Certs">getAllSafeX509Certs</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a>]</li><li class="src short"><a href="#v:getSafeX509CRLs">getSafeX509CRLs</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a>]</li><li class="src short"><a href="#v:getAllSafeX509CRLs">getAllSafeX509CRLs</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a>]</li><li class="src short"><a href="#v:findAttribute">findAttribute</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]</li><li class="src short"><a href="#v:setAttribute">setAttribute</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</li><li class="src short"><a href="#v:filterAttributes">filterAttributes</a> :: (<a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</li><li class="src short"><a href="#v:getFriendlyName">getFriendlyName</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li class="src short"><a href="#v:setFriendlyName">setFriendlyName</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</li><li class="src short"><a href="#v:getLocalKeyId">getLocalKeyId</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:setLocalKeyId">setLocalKeyId</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</li><li class="src short"><a href="#v:fromCredential">fromCredential</a> :: <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></li><li class="src short"><a href="#v:fromNamedCredential">fromNamedCredential</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></li><li class="src short"><a href="#v:toCredential">toCredential</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> (<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>))</li><li class="src short"><a href="#v:toNamedCredential">toNamedCredential</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> (<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>))</li><li class="src short"><span class="keyword">type</span> <a href="#t:Password">Password</a> = <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:OptAuthenticated">OptAuthenticated</a> a<ul class="subs"><li>= <a href="#v:Unauthenticated">Unauthenticated</a> a</li><li>| <a href="#v:Authenticated">Authenticated</a> (<a href="Crypto-Store-PKCS12.html#t:Password" title="Crypto.Store.PKCS12">Password</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a>, a))</li></ul></li><li class="src short"><a href="#v:recoverAuthenticated">recoverAuthenticated</a> :: <a href="Crypto-Store-PKCS12.html#t:Password" title="Crypto.Store.PKCS12">Password</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a>, a)</li><li class="src short"><span class="keyword">data</span> <a href="#t:ProtectionPassword">ProtectionPassword</a></li><li class="src short"><a href="#v:emptyNotTerminated">emptyNotTerminated</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></li><li class="src short"><a href="#v:fromProtectionPassword">fromProtectionPassword</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:toProtectionPassword">toProtectionPassword</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:OptProtected">OptProtected</a> a<ul class="subs"><li>= <a href="#v:Unprotected">Unprotected</a> a</li><li>| <a href="#v:Protected">Protected</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</li></ul></li><li class="src short"><a href="#v:recover">recover</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a</li><li class="src short"><a href="#v:recoverA">recoverA</a> :: <a href="../base-4.18.2.1/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> f =&gt; f <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a -&gt; f (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:IntegrityParams" class="def">IntegrityParams</a> = (<a href="Crypto-Store-CMS.html#t:DigestAlgorithm" title="Crypto.Store.CMS">DigestAlgorithm</a>, <a href="Crypto-Store-PKCS5.html#t:PBEParameter" title="Crypto.Store.PKCS5">PBEParameter</a>) <a href="src/Crypto.Store.PKCS12.html#IntegrityParams" class="link">Source</a> <a href="#t:IntegrityParams" class="selflink">#</a></p><div class="doc"><p>Parameters used for password integrity mode.</p></div></div><div class="top"><p class="src"><a id="v:readP12File" class="def">readP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a>)) <a href="src/Crypto.Store.PKCS12.html#readP12File" class="link">Source</a> <a href="#v:readP12File" class="selflink">#</a></p><div class="doc"><p>Read a PKCS #12 file from disk.</p></div></div><div class="top"><p class="src"><a id="v:readP12FileFromMemory" class="def">readP12FileFromMemory</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a>) <a href="src/Crypto.Store.PKCS12.html#readP12FileFromMemory" class="link">Source</a> <a href="#v:readP12FileFromMemory" class="selflink">#</a></p><div class="doc"><p>Read a PKCS #12 file from a bytearray in BER format.</p></div></div><div class="top"><p class="src"><a id="v:writeP12File" class="def">writeP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:IntegrityParams" title="Crypto.Store.PKCS12">IntegrityParams</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> ()) <a href="src/Crypto.Store.PKCS12.html#writeP12File" class="link">Source</a> <a href="#v:writeP12File" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #12 file to disk.</p></div></div><div class="top"><p class="src"><a id="v:writeP12FileToMemory" class="def">writeP12FileToMemory</a> :: <a href="Crypto-Store-PKCS12.html#t:IntegrityParams" title="Crypto.Store.PKCS12">IntegrityParams</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS12.html#writeP12FileToMemory" class="link">Source</a> <a href="#v:writeP12FileToMemory" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #12 file to a bytearray in DER format.</p></div></div><div class="top"><p class="src"><a id="v:writeUnprotectedP12File" class="def">writeUnprotectedP12File</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Crypto.Store.PKCS12.html#writeUnprotectedP12File" class="link">Source</a> <a href="#v:writeUnprotectedP12File" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #12 file without integrity protection to disk.</p></div></div><div class="top"><p class="src"><a id="v:writeUnprotectedP12FileToMemory" class="def">writeUnprotectedP12FileToMemory</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS12.html#writeUnprotectedP12FileToMemory" class="link">Source</a> <a href="#v:writeUnprotectedP12FileToMemory" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #12 file without integrity protection to a bytearray in DER
 format.</p></div></div><a href="#g:1" id="g:1"><h1>PKCS #12 privacy</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PKCS12" class="def">PKCS12</a> <a href="src/Crypto.Store.PKCS12.html#PKCS12" class="link">Source</a> <a href="#t:PKCS12" class="selflink">#</a></p><div class="doc"><p>PKCS #12 privacy wrapper, adding optional encryption to <code><a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a></code>.
 ASN.1 equivalent is <code>AuthenticatedSafe</code>.</p><p>The semigroup interface allows to combine multiple pieces encrypted
 separately but they should all derive from the same password to be readable
 by <code><a href="Crypto-Store-PKCS12.html#v:unPKCS12" title="Crypto.Store.PKCS12">unPKCS12</a></code> and most other software.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:PKCS12">Instances</h4><details id="i:PKCS12" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PKCS12:Semigroup:1"></span> <a href="../base-4.18.2.1/Prelude.html#t:Semigroup" title="Prelude">Semigroup</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></span> <a href="src/Crypto.Store.PKCS12.html#line-276" class="link">Source</a> <a href="#t:PKCS12" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PKCS12:Semigroup:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-60--62-">(&lt;&gt;)</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="#v:-60--62-" class="selflink">#</a></p><p class="src"><a href="#v:sconcat">sconcat</a> :: <a href="../base-4.18.2.1/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="#v:sconcat" class="selflink">#</a></p><p class="src"><a href="#v:stimes">stimes</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integral" title="Prelude">Integral</a> b =&gt; b -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="#v:stimes" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PKCS12:Show:2"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></span> <a href="src/Crypto.Store.PKCS12.html#line-274" class="link">Source</a> <a href="#t:PKCS12" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PKCS12:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PKCS12:Eq:3"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></span> <a href="src/Crypto.Store.PKCS12.html#line-274" class="link">Source</a> <a href="#t:PKCS12" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PKCS12:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:unPKCS12" class="def">unPKCS12</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] <a href="src/Crypto.Store.PKCS12.html#unPKCS12" class="link">Source</a> <a href="#v:unPKCS12" class="selflink">#</a></p><div class="doc"><p>Read the contents of a PKCS #12.  The same privacy password will be used
 for all content elements.</p><p>This convenience function returns a <code><a href="Crypto-Store-PKCS12.html#v:Protected" title="Crypto.Store.PKCS12">Protected</a></code> value as soon as one element
 at least is encrypted.  This does not mean all elements were actually
 protected in the input.  If detailed view is required then function
 <code><a href="Crypto-Store-PKCS12.html#v:unPKCS12-39-" title="Crypto.Store.PKCS12">unPKCS12'</a></code> is also available.</p></div></div><div class="top"><p class="src"><a id="v:unPKCS12-39-" class="def">unPKCS12'</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] <a href="src/Crypto.Store.PKCS12.html#unPKCS12%27" class="link">Source</a> <a href="#v:unPKCS12-39-" class="selflink">#</a></p><div class="doc"><p>Read the contents of a PKCS #12.</p></div></div><div class="top"><p class="src"><a id="v:unencrypted" class="def">unencrypted</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="src/Crypto.Store.PKCS12.html#unencrypted" class="link">Source</a> <a href="#v:unencrypted" class="selflink">#</a></p><div class="doc"><p>Build a PKCS #12 without encryption.  Usage scenario is when private keys
 are already encrypted with <code><a href="Crypto-Store-PKCS12.html#v:PKCS8ShroudedKeyBag" title="Crypto.Store.PKCS12">PKCS8ShroudedKeyBag</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:encrypted" class="def">encrypted</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="src/Crypto.Store.PKCS12.html#encrypted" class="link">Source</a> <a href="#v:encrypted" class="selflink">#</a></p><div class="doc"><p>Build a PKCS #12 encrypted with the specified scheme and password.</p></div></div><a href="#g:2" id="g:2"><h1>PKCS #12 contents and bags</h1></a><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:SafeContents" class="def">SafeContents</a> <a href="src/Crypto.Store.PKCS12.html#SafeContents" class="link">Source</a> <a href="#t:SafeContents" class="selflink">#</a></p><div class="doc"><p>Content objects stored in a PKCS #12.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SafeContents" class="def">SafeContents</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:unSafeContents" class="def">unSafeContents</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeBag" title="Crypto.Store.PKCS12">SafeBag</a>]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SafeContents">Instances</h4><details id="i:SafeContents" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SafeContents:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a></span> <a href="src/Crypto.Store.PKCS12.html#line-494" class="link">Source</a> <a href="#t:SafeContents" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SafeContents:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SafeContents:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a></span> <a href="src/Crypto.Store.PKCS12.html#line-494" class="link">Source</a> <a href="#t:SafeContents" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SafeContents:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:SafeBag" class="def">SafeBag</a> = <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> <a href="src/Crypto.Store.PKCS12.html#SafeBag" class="link">Source</a> <a href="#t:SafeBag" class="selflink">#</a></p><div class="doc"><p>Main bag type in a PKCS #12.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Bag" class="def">Bag</a> info <a href="src/Crypto.Store.PKCS12.html#Bag" class="link">Source</a> <a href="#t:Bag" class="selflink">#</a></p><div class="doc"><p>Polymorphic PKCS #12 bag parameterized by the payload data type.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Bag" class="def">Bag</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:bagInfo" class="def">bagInfo</a> :: info</dfn><div class="doc"><p>bag payload</p></div></li><li><dfn class="src"><a id="v:bagAttributes" class="def">bagAttributes</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>]</dfn><div class="doc"><p>attributes providing additional information</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Bag">Instances</h4><details id="i:Bag" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Bag:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> info =&gt; <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info)</span> <a href="src/Crypto.Store.PKCS12.html#line-355" class="link">Source</a> <a href="#t:Bag" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Bag:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Bag:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> info =&gt; <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info)</span> <a href="src/Crypto.Store.PKCS12.html#line-355" class="link">Source</a> <a href="#t:Bag" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Bag:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> info -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SafeInfo" class="def">SafeInfo</a> <a href="src/Crypto.Store.PKCS12.html#SafeInfo" class="link">Source</a> <a href="#t:SafeInfo" class="selflink">#</a></p><div class="doc"><p>Main bag payload in PKCS #12 contents.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:KeyBag" class="def">KeyBag</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)</td><td class="doc"><p>unencrypted private key</p></td></tr><tr><td class="src"><a id="v:PKCS8ShroudedKeyBag" class="def">PKCS8ShroudedKeyBag</a> <a href="Crypto-Store-PKCS5.html#t:PKCS5" title="Crypto.Store.PKCS5">PKCS5</a></td><td class="doc"><p>encrypted private key</p></td></tr><tr><td class="src"><a id="v:CertBag" class="def">CertBag</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a>)</td><td class="doc"><p>certificate</p></td></tr><tr><td class="src"><a id="v:CRLBag" class="def">CRLBag</a> (<a href="Crypto-Store-PKCS12.html#t:Bag" title="Crypto.Store.PKCS12">Bag</a> <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a>)</td><td class="doc"><p>CRL</p></td></tr><tr><td class="src"><a id="v:SecretBag" class="def">SecretBag</a> [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]</td><td class="doc"><p>arbitrary secret</p></td></tr><tr><td class="src"><a id="v:SafeContentsBag" class="def">SafeContentsBag</a> <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a></td><td class="doc"><p>safe contents embeded recursively</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SafeInfo">Instances</h4><details id="i:SafeInfo" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SafeInfo:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-462" class="link">Source</a> <a href="#t:SafeInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SafeInfo:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SafeInfo:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-462" class="link">Source</a> <a href="#t:SafeInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SafeInfo:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:SafeInfo" title="Crypto.Store.PKCS12">SafeInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:CertInfo" class="def">CertInfo</a> <a href="src/Crypto.Store.PKCS12.html#CertInfo" class="link">Source</a> <a href="#t:CertInfo" class="selflink">#</a></p><div class="doc"><p>Certificate bags.  Only X.509 certificates are supported.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CertX509" class="def">CertX509</a> <a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CertInfo">Instances</h4><details id="i:CertInfo" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CertInfo:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-397" class="link">Source</a> <a href="#t:CertInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CertInfo:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CertInfo:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-397" class="link">Source</a> <a href="#t:CertInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CertInfo:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CertInfo" title="Crypto.Store.PKCS12">CertInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:CRLInfo" class="def">CRLInfo</a> <a href="src/Crypto.Store.PKCS12.html#CRLInfo" class="link">Source</a> <a href="#t:CRLInfo" class="selflink">#</a></p><div class="doc"><p>CRL bags.  Only X.509 CRLs are supported.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CRLX509" class="def">CRLX509</a> <a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CRLInfo">Instances</h4><details id="i:CRLInfo" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CRLInfo:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-418" class="link">Source</a> <a href="#t:CRLInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CRLInfo:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CRLInfo:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a></span> <a href="src/Crypto.Store.PKCS12.html#line-418" class="link">Source</a> <a href="#t:CRLInfo" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CRLInfo:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:CRLInfo" title="Crypto.Store.PKCS12">CRLInfo</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Attribute" class="def">Attribute</a> <a href="src/Crypto.Store.CMS.Attribute.html#Attribute" class="link">Source</a> <a href="#t:Attribute" class="selflink">#</a></p><div class="doc"><p>An attribute extending the parent structure with arbitrary data.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Attribute" class="def">Attribute</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:attrType" class="def">attrType</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a></dfn><div class="doc"><p>Attribute type</p></div></li><li><dfn class="src"><a id="v:attrValues" class="def">attrValues</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]</dfn><div class="doc"><p>Attribute values</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Attribute">Instances</h4><details id="i:Attribute" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Attribute:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a></span> <a href="src/Crypto.Store.CMS.Attribute.html#line-52" class="link">Source</a> <a href="#t:Attribute" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Attribute:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-CMS-Attribute.html">Crypto.Store.CMS.Attribute</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Attribute:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a></span> <a href="src/Crypto.Store.CMS.Attribute.html#line-52" class="link">Source</a> <a href="#t:Attribute" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Attribute:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-CMS-Attribute.html">Crypto.Store.CMS.Attribute</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:getSafeKeys" class="def">getSafeKeys</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] <a href="src/Crypto.Store.PKCS12.html#getSafeKeys" class="link">Source</a> <a href="#v:getSafeKeys" class="selflink">#</a></p><div class="doc"><p>Return all private keys contained in the safe contents.</p></div></div><div class="top"><p class="src"><a id="v:getAllSafeKeys" class="def">getAllSafeKeys</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] <a href="src/Crypto.Store.PKCS12.html#getAllSafeKeys" class="link">Source</a> <a href="#v:getAllSafeKeys" class="selflink">#</a></p><div class="doc"><p>Return all private keys contained in the safe content list.  All shrouded
 private keys must derive from the same password.</p><p>This convenience function returns a <code><a href="Crypto-Store-PKCS12.html#v:Protected" title="Crypto.Store.PKCS12">Protected</a></code> value as soon as one key at
 least is encrypted.  This does not mean all keys were actually protected in
 the input.  If detailed view is required then function <code><a href="Crypto-Store-PKCS12.html#v:getSafeKeys" title="Crypto.Store.PKCS12">getSafeKeys</a></code> is
 available.</p></div></div><div class="top"><p class="src"><a id="v:getSafeX509Certs" class="def">getSafeX509Certs</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a>] <a href="src/Crypto.Store.PKCS12.html#getSafeX509Certs" class="link">Source</a> <a href="#v:getSafeX509Certs" class="selflink">#</a></p><div class="doc"><p>Return all X.509 certificates contained in the safe contents.</p></div></div><div class="top"><p class="src"><a id="v:getAllSafeX509Certs" class="def">getAllSafeX509Certs</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCertificate" title="Data.X509">SignedCertificate</a>] <a href="src/Crypto.Store.PKCS12.html#getAllSafeX509Certs" class="link">Source</a> <a href="#v:getAllSafeX509Certs" class="selflink">#</a></p><div class="doc"><p>Return all X.509 certificates contained in the safe content list.</p></div></div><div class="top"><p class="src"><a id="v:getSafeX509CRLs" class="def">getSafeX509CRLs</a> :: <a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a>] <a href="src/Crypto.Store.PKCS12.html#getSafeX509CRLs" class="link">Source</a> <a href="#v:getSafeX509CRLs" class="selflink">#</a></p><div class="doc"><p>Return all X.509 CRLs contained in the safe contents.</p></div></div><div class="top"><p class="src"><a id="v:getAllSafeX509CRLs" class="def">getAllSafeX509CRLs</a> :: [<a href="Crypto-Store-PKCS12.html#t:SafeContents" title="Crypto.Store.PKCS12">SafeContents</a>] -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:SignedCRL" title="Data.X509">SignedCRL</a>] <a href="src/Crypto.Store.PKCS12.html#getAllSafeX509CRLs" class="link">Source</a> <a href="#v:getAllSafeX509CRLs" class="selflink">#</a></p><div class="doc"><p>Return all X.509 CRLs contained in the safe content list.</p></div></div><a href="#g:3" id="g:3"><h1>PKCS #12 attributes</h1></a><div class="top"><p class="src"><a id="v:findAttribute" class="def">findAttribute</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] <a href="src/Crypto.Store.CMS.Attribute.html#findAttribute" class="link">Source</a> <a href="#v:findAttribute" class="selflink">#</a></p><div class="doc"><p>Return the values for the first attribute with the specified type.</p></div></div><div class="top"><p class="src"><a id="v:setAttribute" class="def">setAttribute</a> :: <a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] <a href="src/Crypto.Store.CMS.Attribute.html#setAttribute" class="link">Source</a> <a href="#v:setAttribute" class="selflink">#</a></p><div class="doc"><p>Add or replace an attribute in a list of attributes.</p></div></div><div class="top"><p class="src"><a id="v:filterAttributes" class="def">filterAttributes</a> :: (<a href="../asn1-types-0.3.4/Data-ASN1-OID.html#t:OID" title="Data.ASN1.OID">OID</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] <a href="src/Crypto.Store.CMS.Attribute.html#filterAttributes" class="link">Source</a> <a href="#v:filterAttributes" class="selflink">#</a></p><div class="doc"><p>Filter a list of attributes based on a predicate applied to attribute type.</p></div></div><div class="top"><p class="src"><a id="v:getFriendlyName" class="def">getFriendlyName</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="src/Crypto.Store.PKCS12.html#getFriendlyName" class="link">Source</a> <a href="#v:getFriendlyName" class="selflink">#</a></p><div class="doc"><p>Return the value of the <code>friendlyName</code> attribute.</p></div></div><div class="top"><p class="src"><a id="v:setFriendlyName" class="def">setFriendlyName</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] <a href="src/Crypto.Store.PKCS12.html#setFriendlyName" class="link">Source</a> <a href="#v:setFriendlyName" class="selflink">#</a></p><div class="doc"><p>Add or replace the <code>friendlyName</code> attribute in a list of attributes.</p></div></div><div class="top"><p class="src"><a id="v:getLocalKeyId" class="def">getLocalKeyId</a> :: [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS12.html#getLocalKeyId" class="link">Source</a> <a href="#v:getLocalKeyId" class="selflink">#</a></p><div class="doc"><p>Return the value of the <code>localKeyId</code> attribute.</p></div></div><div class="top"><p class="src"><a id="v:setLocalKeyId" class="def">setLocalKeyId</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] -&gt; [<a href="Crypto-Store-PKCS12.html#t:Attribute" title="Crypto.Store.PKCS12">Attribute</a>] <a href="src/Crypto.Store.PKCS12.html#setLocalKeyId" class="link">Source</a> <a href="#v:setLocalKeyId" class="selflink">#</a></p><div class="doc"><p>Add or replace the <code>localKeyId</code> attribute in a list of attributes.</p></div></div><a href="#g:4" id="g:4"><h1>Credentials</h1></a><div class="top"><p class="src"><a id="v:fromCredential" class="def">fromCredential</a> :: <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="src/Crypto.Store.PKCS12.html#fromCredential" class="link">Source</a> <a href="#v:fromCredential" class="selflink">#</a></p><div class="doc"><p>Build a <code><a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></code> value containing a private key and certificate chain.
 Distinct encryption is applied for both.  Encrypting the certificate chain is
 optional.</p><p>Note: advice is to always generate fresh and independent <code><a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a></code>
 values so that the salt is not reused twice in the encryption process.</p></div></div><div class="top"><p class="src"><a id="v:fromNamedCredential" class="def">fromNamedCredential</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> <a href="src/Crypto.Store.PKCS12.html#fromNamedCredential" class="link">Source</a> <a href="#v:fromNamedCredential" class="selflink">#</a></p><div class="doc"><p>Build a <code><a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></code> value containing a private key and certificate chain
 identified with the specified friendly name.  Distinct encryption is applied
 for private key and certificates.  Encrypting the certificate chain is
 optional.</p><p>Note: advice is to always generate fresh and independent <code><a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a></code>
 values so that the salt is not reused twice in the encryption process.</p></div></div><div class="top"><p class="src"><a id="v:toCredential" class="def">toCredential</a> :: <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> (<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)) <a href="src/Crypto.Store.PKCS12.html#toCredential" class="link">Source</a> <a href="#v:toCredential" class="selflink">#</a></p><div class="doc"><p>Extract the private key and certificate chain from a <code><a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></code> value.  A
 credential is returned when the structure contains exactly one private key
 and at least one X.509 certificate.</p></div></div><div class="top"><p class="src"><a id="v:toNamedCredential" class="def">toNamedCredential</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> (<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a>, <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)) <a href="src/Crypto.Store.PKCS12.html#toNamedCredential" class="link">Source</a> <a href="#v:toNamedCredential" class="selflink">#</a></p><div class="doc"><p>Extract a private key and certificate chain with the specified friendly
 name from a <code><a href="Crypto-Store-PKCS12.html#t:PKCS12" title="Crypto.Store.PKCS12">PKCS12</a></code> value.  A credential is returned when the structure
 contains exactly one private key and one X.509 certificate with the name.</p></div></div><a href="#g:5" id="g:5"><h1>Password-based protection</h1></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Password" class="def">Password</a> = <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.CMS.Enveloped.html#Password" class="link">Source</a> <a href="#t:Password" class="selflink">#</a></p><div class="doc"><p>A password stored as a sequence of UTF-8 bytes.</p><p>Some key-derivation functions add restrictions to what characters
 are supported.</p><p>Beware: <code><a href="../base-4.18.2.1/Data-String.html#v:fromString" title="Data.String">fromString</a></code> truncates multi-byte characters.
 If the string may contain non-ASCII characters, prefer instead
 <code><code><a href="Crypto-Store-PKCS5.html#v:fromProtectionPassword" title="Crypto.Store.PKCS5">fromProtectionPassword</a></code> . <code><a href="../base-4.18.2.1/Data-String.html#v:fromString" title="Data.String">fromString</a></code></code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OptAuthenticated" class="def">OptAuthenticated</a> a <a href="src/Crypto.Store.PKCS12.html#OptAuthenticated" class="link">Source</a> <a href="#t:OptAuthenticated" class="selflink">#</a></p><div class="doc"><p>Data type for objects that are possibly authenticated with a password.</p><p>Content is verified and retrieved by providing a <code><a href="Crypto-Store-PKCS12.html#t:Password" title="Crypto.Store.PKCS12">Password</a></code> value.  When
 verification is successful, a value of type <code><a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></code> is also
 returned and this value can be fed to an inner decryption layer that needs
 the same password (usual case for PKCS #12).</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Unauthenticated" class="def">Unauthenticated</a> a</td><td class="doc"><p>Value is not authenticated</p></td></tr><tr><td class="src"><a id="v:Authenticated" class="def">Authenticated</a> (<a href="Crypto-Store-PKCS12.html#t:Password" title="Crypto.Store.PKCS12">Password</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a>, a))</td><td class="doc"><p>Value is authenticated with a password</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OptAuthenticated">Instances</h4><details id="i:OptAuthenticated" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OptAuthenticated:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a></span> <a href="src/Crypto.Store.PKCS12.html#line-113" class="link">Source</a> <a href="#t:OptAuthenticated" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OptAuthenticated:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS12.html">Crypto.Store.PKCS12</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> a -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> b -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:recoverAuthenticated" class="def">recoverAuthenticated</a> :: <a href="Crypto-Store-PKCS12.html#t:Password" title="Crypto.Store.PKCS12">Password</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a>, a) <a href="src/Crypto.Store.PKCS12.html#recoverAuthenticated" class="link">Source</a> <a href="#v:recoverAuthenticated" class="selflink">#</a></p><div class="doc"><p>Try to recover an <code><a href="Crypto-Store-PKCS12.html#t:OptAuthenticated" title="Crypto.Store.PKCS12">OptAuthenticated</a></code> content using the specified password.</p><p>When successful, the content is returned, as well as the password converted
 to type <code><a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></code>.  This password value can then be fed to the
 inner decryption layer when both passwords are known to be same (usual case
 for PKCS #12).</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ProtectionPassword" class="def">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#ProtectionPassword" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></p><div class="doc"><p>A password stored as a sequence of UTF-8 bytes.</p><p>Some key-derivation functions add restrictions to what characters
 are supported.</p><p>The data type provides a special value <code><a href="Crypto-Store-PKCS12.html#v:emptyNotTerminated" title="Crypto.Store.PKCS12">emptyNotTerminated</a></code> that is used
 as alternate representation of empty passwords on some systems and that
 produces encryption results different than an empty bytearray.</p><p>Conversion to/from a regular sequence of bytes is possible with functions
 <code><a href="Crypto-Store-PKCS12.html#v:toProtectionPassword" title="Crypto.Store.PKCS12">toProtectionPassword</a></code> and <code><a href="Crypto-Store-PKCS12.html#v:fromProtectionPassword" title="Crypto.Store.PKCS12">fromProtectionPassword</a></code>.</p><p>Beware: the <code><a href="../base-4.18.2.1/Data-String.html#v:fromString" title="Data.String">fromString</a></code> implementation correctly handles multi-byte
 characters, so here is not equivalent to the <code><a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code> counterpart.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ProtectionPassword">Instances</h4><details id="i:ProtectionPassword" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:IsString:1"></span> <a href="../base-4.18.2.1/Data-String.html#t:IsString" title="Data.String">IsString</a> <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-80" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:IsString:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fromString">fromString</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> <a href="#v:fromString" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:Show:2"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-75" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:Eq:3"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-73" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:ByteArrayAccess:4"></span> <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-83" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:ByteArrayAccess:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:length">length</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:length" class="selflink">#</a></p><p class="src"><a href="#v:withByteArray">withByteArray</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; (<a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="#v:withByteArray" class="selflink">#</a></p><p class="src"><a href="#v:copyByteArrayToPtr">copyByteArrayToPtr</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="#v:copyByteArrayToPtr" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:emptyNotTerminated" class="def">emptyNotTerminated</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#emptyNotTerminated" class="link">Source</a> <a href="#v:emptyNotTerminated" class="selflink">#</a></p><div class="doc"><p>A value denoting an empty password, but having a special encoding when
 deriving a symmetric key on some systems, like the certificate export
 wizard on Windows.</p><p>This value is different from <code><code><a href="Crypto-Store-PKCS12.html#v:toProtectionPassword" title="Crypto.Store.PKCS12">toProtectionPassword</a></code> &quot;&quot;</code> and can be tried
 when decrypting content with a password known to be empty.</p></div></div><div class="top"><p class="src"><a id="v:fromProtectionPassword" class="def">fromProtectionPassword</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#fromProtectionPassword" class="link">Source</a> <a href="#v:fromProtectionPassword" class="selflink">#</a></p><div class="doc"><p>Extract the UTF-8 bytes in a password value.</p></div></div><div class="top"><p class="src"><a id="v:toProtectionPassword" class="def">toProtectionPassword</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#toProtectionPassword" class="link">Source</a> <a href="#v:toProtectionPassword" class="selflink">#</a></p><div class="doc"><p>Build a password value from a sequence of UTF-8 bytes.</p><p>When the password is empty, the special value <code><a href="Crypto-Store-PKCS12.html#v:emptyNotTerminated" title="Crypto.Store.PKCS12">emptyNotTerminated</a></code> may
 be tried as well.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OptProtected" class="def">OptProtected</a> a <a href="src/Crypto.Store.PKCS8.html#OptProtected" class="link">Source</a> <a href="#t:OptProtected" class="selflink">#</a></p><div class="doc"><p>Data type for objects that are possibly protected with a password.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Unprotected" class="def">Unprotected</a> a</td><td class="doc"><p>Value is unprotected</p></td></tr><tr><td class="src"><a id="v:Protected" class="def">Protected</a> (<a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</td><td class="doc"><p>Value is protected with a password</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OptProtected">Instances</h4><details id="i:OptProtected" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OptProtected:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a></span> <a href="src/Crypto.Store.PKCS8.html#line-87" class="link">Source</a> <a href="#t:OptProtected" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OptProtected:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> b -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:recover" class="def">recover</a> :: <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a <a href="src/Crypto.Store.PKCS8.html#recover" class="link">Source</a> <a href="#v:recover" class="selflink">#</a></p><div class="doc"><p>Try to recover an <code><a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a></code> content using the specified password.</p></div></div><div class="top"><p class="src"><a id="v:recoverA" class="def">recoverA</a> :: <a href="../base-4.18.2.1/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> f =&gt; f <a href="Crypto-Store-PKCS12.html#t:ProtectionPassword" title="Crypto.Store.PKCS12">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a> a -&gt; f (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a) <a href="src/Crypto.Store.PKCS8.html#recoverA" class="link">Source</a> <a href="#v:recoverA" class="selflink">#</a></p><div class="doc"><p>Try to recover an <code><a href="Crypto-Store-PKCS12.html#t:OptProtected" title="Crypto.Store.PKCS12">OptProtected</a></code> content in an applicative context.  The
 applicative password is used if necessary.</p><pre>import qualified Data.ByteString as B
import           Crypto.Store.PKCS8

[encryptedKey] &lt;- readKeyFile &quot;privkey.pem&quot;
let askForPassword = putStr &quot;Please enter password: &quot; &gt;&gt; B.getLine
result &lt;- recoverA (toProtectionPassword &lt;$&gt; askForPassword) encryptedKey
case result of
    Left err  -&gt; putStrLn $ &quot;Unable to recover key: &quot; ++ show err
    Right key -&gt; print key</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>