<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Crypto.Store.PKCS8</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cryptostore-0.3.1.0: Serialization of cryptographic data types</span><ul class="links" id="page-menu"><li><a href="src/Crypto.Store.PKCS8.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>unknown</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Crypto.Store.PKCS8</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Serialization formats</a></li><li><a href="#g:2">Password-based protection</a></li><li><a href="#g:3">Reading and writing PEM files</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Private-Key Information Syntax, aka PKCS #8.</p><p>Presents an API similar to <a href="../x509-store-1.6.9/Data-X509-Memory.html">Data.X509.Memory</a> and <a href="../x509-store-1.6.9/Data-X509-File.html">Data.X509.File</a> but
 allows to write private keys and provides support for password-based
 encryption.</p><p>Functions to read a private key return an object wrapped in the
 <code><a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a></code> data type.</p><p>Functions related to public keys, certificates and CRLs are available from
 <a href="Crypto-Store-X509.html">Crypto.Store.X509</a>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:readKeyFile">readKeyFile</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>]</li><li class="src short"><a href="#v:readKeyFileFromMemory">readKeyFileFromMemory</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; [<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>]</li><li class="src short"><a href="#v:pemToKey">pemToKey</a> :: [<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)] -&gt; <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a> -&gt; [<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)]</li><li class="src short"><a href="#v:writeKeyFile">writeKeyFile</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:writeKeyFileToMemory">writeKeyFileToMemory</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:keyToPEM">keyToPEM</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a></li><li class="src short"><a href="#v:writeEncryptedKeyFile">writeEncryptedKeyFile</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> ())</li><li class="src short"><a href="#v:writeEncryptedKeyFileToMemory">writeEncryptedKeyFileToMemory</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:encryptKeyToPEM">encryptKeyToPEM</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:PrivateKeyFormat">PrivateKeyFormat</a><ul class="subs"><li>= <a href="#v:TraditionalFormat">TraditionalFormat</a></li><li>| <a href="#v:PKCS8Format">PKCS8Format</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:FormattedKey">FormattedKey</a> a = <a href="#v:FormattedKey">FormattedKey</a> <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> a</li><li class="src short"><span class="keyword">data</span> <a href="#t:ProtectionPassword">ProtectionPassword</a></li><li class="src short"><a href="#v:emptyNotTerminated">emptyNotTerminated</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></li><li class="src short"><a href="#v:fromProtectionPassword">fromProtectionPassword</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:toProtectionPassword">toProtectionPassword</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:OptProtected">OptProtected</a> a<ul class="subs"><li>= <a href="#v:Unprotected">Unprotected</a> a</li><li>| <a href="#v:Protected">Protected</a> (<a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</li></ul></li><li class="src short"><a href="#v:recover">recover</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a</li><li class="src short"><a href="#v:recoverA">recoverA</a> :: <a href="../base-4.18.2.1/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> f =&gt; f <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a -&gt; f (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</li><li class="src short"><a href="#v:readPEMs">readPEMs</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a>]</li><li class="src short"><a href="#v:writePEMs">writePEMs</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; [<a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a>] -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:readKeyFile" class="def">readKeyFile</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] <a href="src/Crypto.Store.PKCS8.html#readKeyFile" class="link">Source</a> <a href="#v:readKeyFile" class="selflink">#</a></p><div class="doc"><p>Read private keys from a PEM file.</p></div></div><div class="top"><p class="src"><a id="v:readKeyFileFromMemory" class="def">readKeyFileFromMemory</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; [<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] <a href="src/Crypto.Store.PKCS8.html#readKeyFileFromMemory" class="link">Source</a> <a href="#v:readKeyFileFromMemory" class="selflink">#</a></p><div class="doc"><p>Read private keys from a bytearray in PEM format.</p></div></div><div class="top"><p class="src"><a id="v:pemToKey" class="def">pemToKey</a> :: [<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)] -&gt; <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a> -&gt; [<a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> (<a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)] <a href="src/Crypto.Store.PKCS8.html#pemToKey" class="link">Source</a> <a href="#v:pemToKey" class="selflink">#</a></p><div class="doc"><p>Read a private key from a <code><a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a></code> element and add it to the accumulator list.</p></div></div><div class="top"><p class="src"><a id="v:writeKeyFile" class="def">writeKeyFile</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Crypto.Store.PKCS8.html#writeKeyFile" class="link">Source</a> <a href="#v:writeKeyFile" class="selflink">#</a></p><div class="doc"><p>Write unencrypted private keys to a PEM file.</p></div></div><div class="top"><p class="src"><a id="v:writeKeyFileToMemory" class="def">writeKeyFileToMemory</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; [<a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>] -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS8.html#writeKeyFileToMemory" class="link">Source</a> <a href="#v:writeKeyFileToMemory" class="selflink">#</a></p><div class="doc"><p>Write unencrypted private keys to a bytearray in PEM format.</p></div></div><div class="top"><p class="src"><a id="v:keyToPEM" class="def">keyToPEM</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a> <a href="src/Crypto.Store.PKCS8.html#keyToPEM" class="link">Source</a> <a href="#v:keyToPEM" class="selflink">#</a></p><div class="doc"><p>Generate an unencrypted PEM for a private key.</p></div></div><div class="top"><p class="src"><a id="v:writeEncryptedKeyFile" class="def">writeEncryptedKeyFile</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> ()) <a href="src/Crypto.Store.PKCS8.html#writeEncryptedKeyFile" class="link">Source</a> <a href="#v:writeEncryptedKeyFile" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #8 encrypted private key to a PEM file.</p><p>If multiple keys need to be stored in the same file, use functions
 <code><a href="Crypto-Store-PKCS8.html#v:encryptKeyToPEM" title="Crypto.Store.PKCS8">encryptKeyToPEM</a></code> and <code><a href="Crypto-Store-PKCS8.html#v:writePEMs" title="Crypto.Store.PKCS8">writePEMs</a></code>.</p><p>Fresh <code><a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a></code> parameters should be generated for each key to
 encrypt.</p></div></div><div class="top"><p class="src"><a id="v:writeEncryptedKeyFileToMemory" class="def">writeEncryptedKeyFileToMemory</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS8.html#writeEncryptedKeyFileToMemory" class="link">Source</a> <a href="#v:writeEncryptedKeyFileToMemory" class="selflink">#</a></p><div class="doc"><p>Write a PKCS #8 encrypted private key to a bytearray in PEM format.</p><p>If multiple keys need to be stored in the same bytearray, use functions
 <code><a href="Crypto-Store-PKCS8.html#v:encryptKeyToPEM" title="Crypto.Store.PKCS8">encryptKeyToPEM</a></code> and <code><a href="../pem-0.2.4/Data-PEM.html#v:pemWriteBS" title="Data.PEM">pemWriteBS</a></code> or <code><a href="../pem-0.2.4/Data-PEM.html#v:pemWriteLBS" title="Data.PEM">pemWriteLBS</a></code>.</p><p>Fresh <code><a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a></code> parameters should be generated for each key to
 encrypt.</p></div></div><div class="top"><p class="src"><a id="v:encryptKeyToPEM" class="def">encryptKeyToPEM</a> :: <a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> <a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a> <a href="src/Crypto.Store.PKCS8.html#encryptKeyToPEM" class="link">Source</a> <a href="#v:encryptKeyToPEM" class="selflink">#</a></p><div class="doc"><p>Generate a PKCS #8 encrypted PEM for a private key.</p><p>Fresh <code><a href="Crypto-Store-PKCS5.html#t:EncryptionScheme" title="Crypto.Store.PKCS5">EncryptionScheme</a></code> parameters should be generated for each key to
 encrypt.</p></div></div><a href="#g:1" id="g:1"><h1>Serialization formats</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PrivateKeyFormat" class="def">PrivateKeyFormat</a> <a href="src/Crypto.Store.PKCS8.html#PrivateKeyFormat" class="link">Source</a> <a href="#t:PrivateKeyFormat" class="selflink">#</a></p><div class="doc"><p>Private-key serialization format.</p><p>Encryption in traditional format is not supported currently.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TraditionalFormat" class="def">TraditionalFormat</a></td><td class="doc"><p>SSLeay compatible</p></td></tr><tr><td class="src"><a id="v:PKCS8Format" class="def">PKCS8Format</a></td><td class="doc"><p>PKCS #8</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:PrivateKeyFormat">Instances</h4><details id="i:PrivateKeyFormat" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PrivateKeyFormat:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a></span> <a href="src/Crypto.Store.PKCS8.html#line-266" class="link">Source</a> <a href="#t:PrivateKeyFormat" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PrivateKeyFormat:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:PrivateKeyFormat:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a></span> <a href="src/Crypto.Store.PKCS8.html#line-266" class="link">Source</a> <a href="#t:PrivateKeyFormat" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:PrivateKeyFormat:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FormattedKey" class="def">FormattedKey</a> a <a href="src/Crypto.Store.PKCS8.html#FormattedKey" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></p><div class="doc"><p>A key associated with format.  Allows to implement <code><a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a></code> instances.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:FormattedKey" class="def">FormattedKey</a> <a href="Crypto-Store-PKCS8.html#t:PrivateKeyFormat" title="Crypto.Store.PKCS8">PrivateKeyFormat</a> a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:FormattedKey">Instances</h4><details id="i:FormattedKey" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a></span> <a href="src/Crypto.Store.PKCS8.html#line-286" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> b -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:ASN1Object:2"></span> <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-DSA.html#t:KeyPair" title="Crypto.PubKey.DSA">KeyPair</a>)</span> <a href="src/Crypto.Store.PKCS8.html#line-424" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:ASN1Object:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toASN1">toASN1</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-DSA.html#t:KeyPair" title="Crypto.PubKey.DSA">KeyPair</a> -&gt; <a href="../asn1-types-0.3.4/Data-ASN1-Types.html#t:ASN1S" title="Data.ASN1.Types">ASN1S</a> <a href="#v:toASN1" class="selflink">#</a></p><p class="src"><a href="#v:fromASN1">fromASN1</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-DSA.html#t:KeyPair" title="Crypto.PubKey.DSA">KeyPair</a>, [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]) <a href="#v:fromASN1" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:ASN1Object:3"></span> <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-RSA-Types.html#t:PrivateKey" title="Crypto.PubKey.RSA.Types">PrivateKey</a>)</span> <a href="src/Crypto.Store.PKCS8.html#line-353" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:ASN1Object:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toASN1">toASN1</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-RSA-Types.html#t:PrivateKey" title="Crypto.PubKey.RSA.Types">PrivateKey</a> -&gt; <a href="../asn1-types-0.3.4/Data-ASN1-Types.html#t:ASN1S" title="Data.ASN1.Types">ASN1S</a> <a href="#v:toASN1" class="selflink">#</a></p><p class="src"><a href="#v:fromASN1">fromASN1</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../cryptonite-0.30/Crypto-PubKey-RSA-Types.html#t:PrivateKey" title="Crypto.PubKey.RSA.Types">PrivateKey</a>, [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]) <a href="#v:fromASN1" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:ASN1Object:4"></span> <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>)</span> <a href="src/Crypto.Store.PKCS8.html#line-305" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:ASN1Object:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toASN1">toASN1</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a> -&gt; <a href="../asn1-types-0.3.4/Data-ASN1-Types.html#t:ASN1S" title="Data.ASN1.Types">ASN1S</a> <a href="#v:toASN1" class="selflink">#</a></p><p class="src"><a href="#v:fromASN1">fromASN1</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKey" title="Data.X509">PrivKey</a>, [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]) <a href="#v:fromASN1" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:ASN1Object:5"></span> <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKeyEC" title="Data.X509">PrivKeyEC</a>)</span> <a href="src/Crypto.Store.PKCS8.html#line-494" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:ASN1Object:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toASN1">toASN1</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKeyEC" title="Data.X509">PrivKeyEC</a> -&gt; <a href="../asn1-types-0.3.4/Data-ASN1-Types.html#t:ASN1S" title="Data.ASN1.Types">ASN1S</a> <a href="#v:toASN1" class="selflink">#</a></p><p class="src"><a href="#v:fromASN1">fromASN1</a> :: [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>] -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> <a href="../x509-1.7.7/Data-X509.html#t:PrivKeyEC" title="Data.X509">PrivKeyEC</a>, [<a href="../asn1-encoding-0.9.6/Data-ASN1-Prim.html#t:ASN1" title="Data.ASN1.Prim">ASN1</a>]) <a href="#v:fromASN1" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:Show:6"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> a =&gt; <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a)</span> <a href="src/Crypto.Store.PKCS8.html#line-284" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:Show:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FormattedKey:Eq:7"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a =&gt; <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> (<a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a)</span> <a href="src/Crypto.Store.PKCS8.html#line-284" class="link">Source</a> <a href="#t:FormattedKey" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FormattedKey:Eq:7"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="Crypto-Store-PKCS8.html#t:FormattedKey" title="Crypto.Store.PKCS8">FormattedKey</a> a -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Password-based protection</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ProtectionPassword" class="def">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#ProtectionPassword" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></p><div class="doc"><p>A password stored as a sequence of UTF-8 bytes.</p><p>Some key-derivation functions add restrictions to what characters
 are supported.</p><p>The data type provides a special value <code><a href="Crypto-Store-PKCS8.html#v:emptyNotTerminated" title="Crypto.Store.PKCS8">emptyNotTerminated</a></code> that is used
 as alternate representation of empty passwords on some systems and that
 produces encryption results different than an empty bytearray.</p><p>Conversion to/from a regular sequence of bytes is possible with functions
 <code><a href="Crypto-Store-PKCS8.html#v:toProtectionPassword" title="Crypto.Store.PKCS8">toProtectionPassword</a></code> and <code><a href="Crypto-Store-PKCS8.html#v:fromProtectionPassword" title="Crypto.Store.PKCS8">fromProtectionPassword</a></code>.</p><p>Beware: the <code><a href="../base-4.18.2.1/Data-String.html#v:fromString" title="Data.String">fromString</a></code> implementation correctly handles multi-byte
 characters, so here is not equivalent to the <code><a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code> counterpart.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ProtectionPassword">Instances</h4><details id="i:ProtectionPassword" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:IsString:1"></span> <a href="../base-4.18.2.1/Data-String.html#t:IsString" title="Data.String">IsString</a> <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-80" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:IsString:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fromString">fromString</a> :: <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> <a href="#v:fromString" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:Show:2"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-75" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:Eq:3"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-73" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ProtectionPassword:ByteArrayAccess:4"></span> <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a></span> <a href="src/Crypto.Store.PKCS5.PBES1.html#line-83" class="link">Source</a> <a href="#t:ProtectionPassword" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ProtectionPassword:ByteArrayAccess:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS5-PBES1.html">Crypto.Store.PKCS5.PBES1</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:length">length</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:length" class="selflink">#</a></p><p class="src"><a href="#v:withByteArray">withByteArray</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; (<a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="#v:withByteArray" class="selflink">#</a></p><p class="src"><a href="#v:copyByteArrayToPtr">copyByteArrayToPtr</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="#v:copyByteArrayToPtr" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:emptyNotTerminated" class="def">emptyNotTerminated</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#emptyNotTerminated" class="link">Source</a> <a href="#v:emptyNotTerminated" class="selflink">#</a></p><div class="doc"><p>A value denoting an empty password, but having a special encoding when
 deriving a symmetric key on some systems, like the certificate export
 wizard on Windows.</p><p>This value is different from <code><code><a href="Crypto-Store-PKCS8.html#v:toProtectionPassword" title="Crypto.Store.PKCS8">toProtectionPassword</a></code> &quot;&quot;</code> and can be tried
 when decrypting content with a password known to be empty.</p></div></div><div class="top"><p class="src"><a id="v:fromProtectionPassword" class="def">fromProtectionPassword</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#fromProtectionPassword" class="link">Source</a> <a href="#v:fromProtectionPassword" class="selflink">#</a></p><div class="doc"><p>Extract the UTF-8 bytes in a password value.</p></div></div><div class="top"><p class="src"><a id="v:toProtectionPassword" class="def">toProtectionPassword</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> <a href="src/Crypto.Store.PKCS5.PBES1.html#toProtectionPassword" class="link">Source</a> <a href="#v:toProtectionPassword" class="selflink">#</a></p><div class="doc"><p>Build a password value from a sequence of UTF-8 bytes.</p><p>When the password is empty, the special value <code><a href="Crypto-Store-PKCS8.html#v:emptyNotTerminated" title="Crypto.Store.PKCS8">emptyNotTerminated</a></code> may
 be tried as well.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:OptProtected" class="def">OptProtected</a> a <a href="src/Crypto.Store.PKCS8.html#OptProtected" class="link">Source</a> <a href="#t:OptProtected" class="selflink">#</a></p><div class="doc"><p>Data type for objects that are possibly protected with a password.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Unprotected" class="def">Unprotected</a> a</td><td class="doc"><p>Value is unprotected</p></td></tr><tr><td class="src"><a id="v:Protected" class="def">Protected</a> (<a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a)</td><td class="doc"><p>Value is protected with a password</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:OptProtected">Instances</h4><details id="i:OptProtected" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:OptProtected:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a></span> <a href="src/Crypto.Store.PKCS8.html#line-87" class="link">Source</a> <a href="#t:OptProtected" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:OptProtected:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Store-PKCS8.html">Crypto.Store.PKCS8</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> b -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:recover" class="def">recover</a> :: <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a <a href="src/Crypto.Store.PKCS8.html#recover" class="link">Source</a> <a href="#v:recover" class="selflink">#</a></p><div class="doc"><p>Try to recover an <code><a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a></code> content using the specified password.</p></div></div><div class="top"><p class="src"><a id="v:recoverA" class="def">recoverA</a> :: <a href="../base-4.18.2.1/Control-Applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> f =&gt; f <a href="Crypto-Store-PKCS8.html#t:ProtectionPassword" title="Crypto.Store.PKCS8">ProtectionPassword</a> -&gt; <a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a> a -&gt; f (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Crypto-Store-Error.html#t:StoreError" title="Crypto.Store.Error">StoreError</a> a) <a href="src/Crypto.Store.PKCS8.html#recoverA" class="link">Source</a> <a href="#v:recoverA" class="selflink">#</a></p><div class="doc"><p>Try to recover an <code><a href="Crypto-Store-PKCS8.html#t:OptProtected" title="Crypto.Store.PKCS8">OptProtected</a></code> content in an applicative context.  The
 applicative password is used if necessary.</p><pre>import qualified Data.ByteString as B
import           Crypto.Store.PKCS8

[encryptedKey] &lt;- readKeyFile &quot;privkey.pem&quot;
let askForPassword = putStr &quot;Please enter password: &quot; &gt;&gt; B.getLine
result &lt;- recoverA (toProtectionPassword &lt;$&gt; askForPassword) encryptedKey
case result of
    Left err  -&gt; putStrLn $ &quot;Unable to recover key: &quot; ++ show err
    Right key -&gt; print key</pre></div></div><a href="#g:3" id="g:3"><h1>Reading and writing PEM files</h1></a><div class="top"><p class="src"><a id="v:readPEMs" class="def">readPEMs</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a>] <a href="src/Crypto.Store.PEM.html#readPEMs" class="link">Source</a> <a href="#v:readPEMs" class="selflink">#</a></p><div class="doc"><p>Read a PEM file from disk.</p></div></div><div class="top"><p class="src"><a id="v:writePEMs" class="def">writePEMs</a> :: <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; [<a href="../pem-0.2.4/Data-PEM.html#t:PEM" title="Data.PEM">PEM</a>] -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Crypto.Store.PEM.html#writePEMs" class="link">Source</a> <a href="#v:writePEMs" class="selflink">#</a></p><div class="doc"><p>Write a PEM file to disk.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>