<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span class="hs-cpp">

#include &lt;ghcplatform.h&gt;
</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Process.Posix</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="System.Process.Posix.html#mkProcessHandle"><span class="hs-identifier">mkProcessHandle</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#translateInternal"><span class="hs-identifier">translateInternal</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#createProcess_Internal"><span class="hs-identifier">createProcess_Internal</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#withCEnvironment"><span class="hs-identifier">withCEnvironment</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#closePHANDLE"><span class="hs-identifier">closePHANDLE</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#startDelegateControlC"><span class="hs-identifier">startDelegateControlC</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#endDelegateControlC"><span class="hs-identifier">endDelegateControlC</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#stopDelegateControlC"><span class="hs-identifier">stopDelegateControlC</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#isDefaultSignal"><span class="hs-identifier">isDefaultSignal</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#ignoreSignal"><span class="hs-identifier">ignoreSignal</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#defaultSignal"><span class="hs-identifier">defaultSignal</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Internals.html#c_execvpe/System.Posix.Process.Internals.html#c_execvpe"><span class="hs-identifier">c_execvpe</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Internals.html#pPrPr_disableITimers/System.Posix.Process.Internals.html#pPrPr_disableITimers"><span class="hs-identifier">pPrPr_disableITimers</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#createPipeInternal"><span class="hs-identifier">createPipeInternal</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#createPipeInternalFd"><span class="hs-identifier">createPipeInternalFd</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#interruptProcessGroupOfInternal"><span class="hs-identifier">interruptProcessGroupOfInternal</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#runInteractiveProcess_lock"><span class="hs-identifier">runInteractiveProcess_lock</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Concurrent.html#/Control.Concurrent.html"><span class="hs-identifier">Control.Concurrent</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Exception.html#/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Bits.html#/Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.C.html#/Foreign.C.html"><span class="hs-identifier">Foreign.C</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.Marshal.html#/Foreign.Marshal.html"><span class="hs-identifier">Foreign.Marshal</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.Ptr.html#/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.Storable.html#/Foreign.Storable.html"><span class="hs-identifier">Foreign.Storable</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.IO.Unsafe.html#/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Char.html#/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.IO.html#/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Internals.html#/System.Posix.Process.Internals.html"><span class="hs-identifier">System.Posix.Process.Internals</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Internals.html#pPrPr_disableITimers/System.Posix.Process.Internals.html#pPrPr_disableITimers"><span class="hs-identifier">pPrPr_disableITimers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Internals.html#c_execvpe/System.Posix.Process.Internals.html#c_execvpe"><span class="hs-identifier">c_execvpe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Types.html#/System.Posix.Types.html"><span class="hs-identifier">System.Posix.Types</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#/System.Posix.Internals.html"><span class="hs-identifier">System.Posix.Internals</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.Exception.html#/GHC.IO.Exception.html"><span class="hs-identifier">GHC.IO.Exception</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#/System.Posix.Signals.html"><span class="hs-identifier">System.Posix.Signals</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Sig</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.IO.html#/System.Posix.IO.html"><span class="hs-identifier">System.Posix.IO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Posix</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.html#/System.Posix.Process.html"><span class="hs-identifier">System.Posix.Process</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Process.Common.html#getProcessGroupIDOf/System.Posix.Process.Common.html#getProcessGroupIDOf"><span class="hs-identifier">getProcessGroupIDOf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Process.Common.html"><span class="hs-identifier">System.Process.Common</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Process.Common.html#mb_delegate_ctlc"><span class="hs-identifier">mb_delegate_ctlc</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if defined(wasm32_HOST_ARCH)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Error</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#include &quot;HsProcessConfig.h&quot;
</span><span class="hs-cpp">#include &quot;processFlags.h&quot;
</span><span>
</span><span id="line-56"></span><span class="annot"><a href="System.Process.Posix.html#mkProcessHandle"><span class="hs-identifier hs-type">mkProcessHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Process.Common.html#PHANDLE"><span class="hs-identifier hs-type">PHANDLE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Process.Common.html#ProcessHandle"><span class="hs-identifier hs-type">ProcessHandle</span></a></span><span>
</span><span id="line-57"></span><span id="mkProcessHandle"><span class="annot"><span class="annottext">mkProcessHandle :: PHANDLE -&gt; Bool -&gt; IO ProcessHandle
</span><a href="System.Process.Posix.html#mkProcessHandle"><span class="hs-identifier hs-var hs-var">mkProcessHandle</span></a></span></span><span> </span><span id="local-6989586621679040870"><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679040870"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679040871"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040871"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679040872"><span class="annot"><span class="annottext">MVar ProcessHandle__
</span><a href="#local-6989586621679040872"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProcessHandle__ -&gt; IO (MVar ProcessHandle__)
forall a. a -&gt; IO (MVar a)
</span><a href="../../base-4.18.2.1/src/GHC.MVar.html#newMVar/GHC.MVar.html#newMVar"><span class="hs-identifier hs-var">newMVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PHANDLE -&gt; ProcessHandle__
</span><a href="System.Process.Common.html#OpenHandle"><span class="hs-identifier hs-var">OpenHandle</span></a></span><span> </span><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679040870"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679040875"><span class="annot"><span class="annottext">MVar ()
</span><a href="#local-6989586621679040875"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO (MVar ())
forall a. a -&gt; IO (MVar a)
</span><a href="../../base-4.18.2.1/src/GHC.MVar.html#newMVar/GHC.MVar.html#newMVar"><span class="hs-identifier hs-var">newMVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">ProcessHandle -&gt; IO ProcessHandle
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MVar ProcessHandle__ -&gt; Bool -&gt; MVar () -&gt; ProcessHandle
</span><a href="System.Process.Common.html#ProcessHandle"><span class="hs-identifier hs-var">ProcessHandle</span></a></span><span> </span><span class="annot"><span class="annottext">MVar ProcessHandle__
</span><a href="#local-6989586621679040872"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040871"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span><span> </span><span class="annot"><span class="annottext">MVar ()
</span><a href="#local-6989586621679040875"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="System.Process.Posix.html#closePHANDLE"><span class="hs-identifier hs-type">closePHANDLE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Process.Common.html#PHANDLE"><span class="hs-identifier hs-type">PHANDLE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span id="closePHANDLE"><span class="annot"><span class="annottext">closePHANDLE :: PHANDLE -&gt; IO ()
</span><a href="System.Process.Posix.html#closePHANDLE"><span class="hs-identifier hs-var hs-var">closePHANDLE</span></a></span></span><span> </span><span class="annot"><span class="annottext">PHANDLE
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- commandToProcess</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><span class="hs-comment">{- | Turns a shell command into a raw command.  Usually this involves
     wrapping it in an invocation of the shell.

   There's a difference in the signature of commandToProcess between
   the Windows and Unix versions.  On Unix, exec takes a list of strings,
   and we want to pass our command to /bin/sh as a single argument.

   On Windows, CreateProcess takes a single string for the command,
   which is later decomposed by cmd.exe.  In this case, we just want
   to prepend @\&quot;c:\WINDOWS\CMD.EXE \/c\&quot;@ to our command line.  The
   command-line translation that we normally do for arguments on
   Windows isn't required (or desirable) here.
-}</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="System.Process.Posix.html#commandToProcess"><span class="hs-identifier hs-type">commandToProcess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Process.Common.html#CmdSpec"><span class="hs-identifier hs-type">CmdSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="commandToProcess"><span class="annot"><span class="annottext">commandToProcess :: CmdSpec -&gt; (FilePath, [FilePath])
</span><a href="System.Process.Posix.html#commandToProcess"><span class="hs-identifier hs-var hs-var">commandToProcess</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Process.Common.html#ShellCommand"><span class="hs-identifier hs-type">ShellCommand</span></a></span><span> </span><span id="local-6989586621679040879"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040879"><span class="hs-identifier hs-var">string</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/bin/sh&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-c&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040879"><span class="hs-identifier hs-var">string</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="annot"><a href="System.Process.Posix.html#commandToProcess"><span class="hs-identifier hs-var">commandToProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Process.Common.html#RawCommand"><span class="hs-identifier hs-type">RawCommand</span></a></span><span> </span><span id="local-6989586621679040881"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040881"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679040882"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679040882"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040881"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679040882"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="System.Process.Posix.html#translateInternal"><span class="hs-identifier hs-type">translateInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-87"></span><span id="translateInternal"><span class="annot"><span class="annottext">translateInternal :: FilePath -&gt; FilePath
</span><a href="System.Process.Posix.html#translateInternal"><span class="hs-identifier hs-var hs-var">translateInternal</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;''&quot;</span></span><span>
</span><span id="line-88"></span><span class="annot"><a href="System.Process.Posix.html#translateInternal"><span class="hs-identifier hs-var">translateInternal</span></a></span><span> </span><span id="local-6989586621679040883"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040883"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-89"></span><span>   </span><span class="hs-comment">-- goodChar is a pessimistic predicate, such that if an argument is</span><span>
</span><span id="line-90"></span><span>   </span><span class="hs-comment">-- non-empty and only contains goodChars, then there is no need to</span><span>
</span><span id="line-91"></span><span>   </span><span class="hs-comment">-- do any quoting or escaping</span><span>
</span><span id="line-92"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#all/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679040885"><span class="hs-identifier hs-var">goodChar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040883"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040883"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-93"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621679040887"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;'&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040883"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679040887"><span class="annot"><span class="annottext">escape :: Char -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621679040887"><span class="hs-identifier hs-var hs-var">escape</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Show.html#showString/GHC.Show.html#showString"><span class="hs-identifier hs-var">showString</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;'\\''&quot;</span></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><a href="#local-6989586621679040887"><span class="hs-identifier hs-var">escape</span></a></span><span> </span><span id="local-6989586621679040889"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040889"><span class="hs-identifier hs-var">c</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
</span><a href="../../base-4.18.2.1/src/GHC.Show.html#showChar/GHC.Show.html#showChar"><span class="hs-identifier hs-var">showChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040889"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span id="local-6989586621679040885"><span class="annot"><span class="annottext">goodChar :: Char -&gt; Bool
</span><a href="#local-6989586621679040885"><span class="hs-identifier hs-var hs-var">goodChar</span></a></span></span><span> </span><span id="local-6989586621679040894"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040894"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="../../base-4.18.2.1/src/GHC.Unicode.html#isAlphaNum/GHC.Unicode.html#isAlphaNum"><span class="hs-identifier hs-var">isAlphaNum</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040894"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679040894"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#elem/Data.Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-_.,/&quot;</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- Utils</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679040721"><span class="annot"><a href="System.Process.Posix.html#withCEnvironment"><span class="hs-identifier hs-type">withCEnvironment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Foreign.html#CString/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679040721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679040721"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-102"></span><span id="withCEnvironment"><span class="annot"><span class="annottext">withCEnvironment :: forall a. [(FilePath, FilePath)] -&gt; (Ptr CString -&gt; IO a) -&gt; IO a
</span><a href="System.Process.Posix.html#withCEnvironment"><span class="hs-identifier hs-var hs-var">withCEnvironment</span></a></span></span><span> </span><span id="local-6989586621679040899"><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679040899"><span class="hs-identifier hs-var">envir</span></a></span></span><span> </span><span id="local-6989586621679040900"><span class="annot"><span class="annottext">Ptr CString -&gt; IO a
</span><a href="#local-6989586621679040900"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040901"><span class="annot"><span class="annottext">env' :: [FilePath]
</span><a href="#local-6989586621679040901"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; [(FilePath, FilePath)] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679040902"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040902"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679040903"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040903"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040902"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040903"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621679040899"><span class="hs-identifier hs-var">envir</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; (CString -&gt; IO a) -&gt; IO a)
-&gt; [FilePath] -&gt; ([CString] -&gt; IO a) -&gt; IO a
forall a b res.
(a -&gt; (b -&gt; res) -&gt; res) -&gt; [a] -&gt; ([b] -&gt; res) -&gt; res
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#withMany/Foreign.Marshal.Utils.html#withMany"><span class="hs-identifier hs-var">withMany</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (CString -&gt; IO a) -&gt; IO a
forall a. FilePath -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#withFilePath/System.Posix.Internals.html#withFilePath"><span class="hs-identifier hs-var">withFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679040901"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679040906"><span class="annot"><span class="annottext">[CString]
</span><a href="#local-6989586621679040906"><span class="hs-identifier hs-var">pEnv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CString -&gt; [CString] -&gt; (Ptr CString -&gt; IO a) -&gt; IO a
forall a b. Storable a =&gt; a -&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Array.html#withArray0/Foreign.Marshal.Array.html#withArray0"><span class="hs-identifier hs-var">withArray0</span></a></span><span> </span><span class="annot"><span class="annottext">CString
forall a. Ptr a
</span><a href="../../base-4.18.2.1/src/GHC.Ptr.html#nullPtr/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[CString]
</span><a href="#local-6989586621679040906"><span class="hs-identifier hs-var">pEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CString -&gt; IO a
</span><a href="#local-6989586621679040900"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- POSIX runProcess with signal handling in the child</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><a href="System.Process.Posix.html#createProcess_Internal"><span class="hs-identifier hs-type">createProcess_Internal</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Process.Common.html#CreateProcess"><span class="hs-identifier hs-type">CreateProcess</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Process.Common.html#ProcRetHandles"><span class="hs-identifier hs-type">ProcRetHandles</span></a></span><span>
</span><span id="line-113"></span><span id="createProcess_Internal"><span class="annot"><span class="annottext">createProcess_Internal :: FilePath -&gt; CreateProcess -&gt; IO ProcRetHandles
</span><a href="System.Process.Posix.html#createProcess_Internal"><span class="hs-identifier hs-var hs-var">createProcess_Internal</span></a></span></span><span> </span><span id="local-6989586621679040909"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040909"><span class="hs-identifier hs-var">fun</span></a></span></span><span>
</span><span id="line-114"></span><span>                   </span><span class="annot"><a href="System.Process.Common.html#CreateProcess"><span class="hs-identifier hs-type">CreateProcess</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cmdspec :: CreateProcess -&gt; CmdSpec
</span><a href="System.Process.Common.html#cmdspec"><span class="hs-identifier hs-var">cmdspec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040912"><span class="annot"><span class="annottext">CmdSpec
</span><a href="#local-6989586621679040912"><span class="hs-identifier hs-var">cmdsp</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>                                  </span><span class="annot"><span class="annottext">cwd :: CreateProcess -&gt; Maybe FilePath
</span><a href="System.Process.Common.html#cwd"><span class="hs-identifier hs-var">cwd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040914"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679040914"><span class="hs-identifier hs-var">mb_cwd</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>                                  </span><span class="annot"><span class="annottext">env :: CreateProcess -&gt; Maybe [(FilePath, FilePath)]
</span><a href="System.Process.Common.html#env"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040916"><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
</span><a href="#local-6989586621679040916"><span class="hs-identifier hs-var">mb_env</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>                                  </span><span class="annot"><span class="annottext">std_in :: CreateProcess -&gt; StdStream
</span><a href="System.Process.Common.html#std_in"><span class="hs-identifier hs-var">std_in</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040918"><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040918"><span class="hs-identifier hs-var">mb_stdin</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>                                  </span><span class="annot"><span class="annottext">std_out :: CreateProcess -&gt; StdStream
</span><a href="System.Process.Common.html#std_out"><span class="hs-identifier hs-var">std_out</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040920"><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040920"><span class="hs-identifier hs-var">mb_stdout</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>                                  </span><span class="annot"><span class="annottext">std_err :: CreateProcess -&gt; StdStream
</span><a href="System.Process.Common.html#std_err"><span class="hs-identifier hs-var">std_err</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040922"><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040922"><span class="hs-identifier hs-var">mb_stderr</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>                                  </span><span class="annot"><span class="annottext">close_fds :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#close_fds"><span class="hs-identifier hs-var">close_fds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040924"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040924"><span class="hs-identifier hs-var">mb_close_fds</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>                                  </span><span class="annot"><span class="annottext">create_group :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#create_group"><span class="hs-identifier hs-var">create_group</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040926"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040926"><span class="hs-identifier hs-var">mb_create_group</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>                                  </span><span class="annot"><span class="annottext">delegate_ctlc :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#delegate_ctlc"><span class="hs-identifier hs-var">delegate_ctlc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040928"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040928"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>                                  </span><span class="annot"><span class="annottext">detach_console :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#detach_console"><span class="hs-identifier hs-var">detach_console</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040930"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040930"><span class="hs-identifier hs-var">mb_detach_console</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>                                  </span><span class="annot"><span class="annottext">create_new_console :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#create_new_console"><span class="hs-identifier hs-var">create_new_console</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040932"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040932"><span class="hs-identifier hs-var">mb_create_new_console</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>                                  </span><span class="annot"><span class="annottext">new_session :: CreateProcess -&gt; Bool
</span><a href="System.Process.Common.html#new_session"><span class="hs-identifier hs-var">new_session</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040934"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040934"><span class="hs-identifier hs-var">mb_new_session</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>                                  </span><span class="annot"><span class="annottext">child_group :: CreateProcess -&gt; Maybe GroupID
</span><a href="System.Process.Common.html#child_group"><span class="hs-identifier hs-var">child_group</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040936"><span class="annot"><span class="annottext">Maybe GroupID
</span><a href="#local-6989586621679040936"><span class="hs-identifier hs-var">mb_child_group</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>                                  </span><span class="annot"><span class="annottext">child_user :: CreateProcess -&gt; Maybe UserID
</span><a href="System.Process.Common.html#child_user"><span class="hs-identifier hs-var">child_user</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679040938"><span class="annot"><span class="annottext">Maybe UserID
</span><a href="#local-6989586621679040938"><span class="hs-identifier hs-var">mb_child_user</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-128"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679040939"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040939"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679040940"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679040940"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmdSpec -&gt; (FilePath, [FilePath])
</span><a href="System.Process.Posix.html#commandToProcess"><span class="hs-identifier hs-var">commandToProcess</span></a></span><span> </span><span class="annot"><span class="annottext">CmdSpec
</span><a href="#local-6989586621679040912"><span class="hs-identifier hs-var">cmdsp</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; IO ProcRetHandles -&gt; IO ProcRetHandles
forall a. FilePath -&gt; IO a -&gt; IO a
</span><a href="System.Process.Common.html#withFilePathException"><span class="hs-identifier hs-var">withFilePathException</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040939"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ProcRetHandles -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-131"></span><span>   </span><span class="annot"><span class="annottext">(Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Alloc.html#alloca/Foreign.Marshal.Alloc.html#alloca"><span class="hs-identifier hs-var">alloca</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679040943"><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040943"><span class="hs-identifier hs-var">pfdStdInput</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>   </span><span class="annot"><span class="annottext">(Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Alloc.html#alloca/Foreign.Marshal.Alloc.html#alloca"><span class="hs-identifier hs-var">alloca</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679040944"><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040944"><span class="hs-identifier hs-var">pfdStdOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>   </span><span class="annot"><span class="annottext">(Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Alloc.html#alloca/Foreign.Marshal.Alloc.html#alloca"><span class="hs-identifier hs-var">alloca</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr FD -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679040945"><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040945"><span class="hs-identifier hs-var">pfdStdError</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>   </span><span class="annot"><span class="annottext">(Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Alloc.html#alloca/Foreign.Marshal.Alloc.html#alloca"><span class="hs-identifier hs-var">alloca</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679040946"><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040946"><span class="hs-identifier hs-var">pFailedDoing</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>   </span><span class="annot"><span class="annottext">([(FilePath, FilePath)]
 -&gt; (Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; Maybe [(FilePath, FilePath)]
-&gt; (Ptr CString -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b c.
(a -&gt; (Ptr b -&gt; IO c) -&gt; IO c)
-&gt; Maybe a -&gt; (Ptr b -&gt; IO c) -&gt; IO c
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#maybeWith/Foreign.Marshal.Utils.html#maybeWith"><span class="hs-identifier hs-var">maybeWith</span></a></span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
-&gt; (Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a. [(FilePath, FilePath)] -&gt; (Ptr CString -&gt; IO a) -&gt; IO a
</span><a href="System.Process.Posix.html#withCEnvironment"><span class="hs-identifier hs-var">withCEnvironment</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
</span><a href="#local-6989586621679040916"><span class="hs-identifier hs-var">mb_env</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040948"><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040948"><span class="hs-identifier hs-var">pEnv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>   </span><span class="annot"><span class="annottext">(FilePath -&gt; (CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; Maybe FilePath
-&gt; (CString -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b c.
(a -&gt; (Ptr b -&gt; IO c) -&gt; IO c)
-&gt; Maybe a -&gt; (Ptr b -&gt; IO c) -&gt; IO c
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#maybeWith/Foreign.Marshal.Utils.html#maybeWith"><span class="hs-identifier hs-var">maybeWith</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a. FilePath -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#withFilePath/System.Posix.Internals.html#withFilePath"><span class="hs-identifier hs-var">withFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679040914"><span class="hs-identifier hs-var">mb_cwd</span></a></span><span> </span><span class="annot"><span class="annottext">((CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040949"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040949"><span class="hs-identifier hs-var">pWorkDir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>   </span><span class="annot"><span class="annottext">(GroupID
 -&gt; (Ptr GroupID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; Maybe GroupID
-&gt; (Ptr GroupID -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b c.
(a -&gt; (Ptr b -&gt; IO c) -&gt; IO c)
-&gt; Maybe a -&gt; (Ptr b -&gt; IO c) -&gt; IO c
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#maybeWith/Foreign.Marshal.Utils.html#maybeWith"><span class="hs-identifier hs-var">maybeWith</span></a></span><span> </span><span class="annot"><span class="annottext">GroupID -&gt; (Ptr GroupID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#with/Foreign.Marshal.Utils.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe GroupID
</span><a href="#local-6989586621679040936"><span class="hs-identifier hs-var">mb_child_group</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr GroupID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr GroupID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040951"><span class="annot"><span class="annottext">Ptr GroupID
</span><a href="#local-6989586621679040951"><span class="hs-identifier hs-var">pChildGroup</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-138"></span><span>   </span><span class="annot"><span class="annottext">(UserID -&gt; (Ptr UserID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; Maybe UserID
-&gt; (Ptr UserID -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b c.
(a -&gt; (Ptr b -&gt; IO c) -&gt; IO c)
-&gt; Maybe a -&gt; (Ptr b -&gt; IO c) -&gt; IO c
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#maybeWith/Foreign.Marshal.Utils.html#maybeWith"><span class="hs-identifier hs-var">maybeWith</span></a></span><span> </span><span class="annot"><span class="annottext">UserID -&gt; (Ptr UserID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. Storable a =&gt; a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#with/Foreign.Marshal.Utils.html#with"><span class="hs-identifier hs-var">with</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserID
</span><a href="#local-6989586621679040938"><span class="hs-identifier hs-var">mb_child_user</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr UserID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr UserID -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040952"><span class="annot"><span class="annottext">Ptr UserID
</span><a href="#local-6989586621679040952"><span class="hs-identifier hs-var">pChildUser</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>   </span><span class="annot"><span class="annottext">(FilePath -&gt; (CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; [FilePath]
-&gt; ([CString] -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b res.
(a -&gt; (b -&gt; res) -&gt; res) -&gt; [a] -&gt; ([b] -&gt; res) -&gt; res
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Utils.html#withMany/Foreign.Marshal.Utils.html#withMany"><span class="hs-identifier hs-var">withMany</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a. FilePath -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#withFilePath/System.Posix.Internals.html#withFilePath"><span class="hs-identifier hs-var">withFilePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040939"><span class="hs-identifier hs-var">cmd</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679040940"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([CString] -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; ([CString] -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040953"><span class="annot"><span class="annottext">[CString]
</span><a href="#local-6989586621679040953"><span class="hs-identifier hs-var">cstrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>   </span><span class="annot"><span class="annottext">CString
-&gt; [CString]
-&gt; (Ptr CString -&gt; IO ProcRetHandles)
-&gt; IO ProcRetHandles
forall a b. Storable a =&gt; a -&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Foreign.Marshal.Array.html#withArray0/Foreign.Marshal.Array.html#withArray0"><span class="hs-identifier hs-var">withArray0</span></a></span><span> </span><span class="annot"><span class="annottext">CString
forall a. Ptr a
</span><a href="../../base-4.18.2.1/src/GHC.Ptr.html#nullPtr/GHC.Ptr.html#nullPtr"><span class="hs-identifier hs-var">nullPtr</span></a></span><span> </span><span class="annot"><span class="annottext">[CString]
</span><a href="#local-6989586621679040953"><span class="hs-identifier hs-var">cstrs</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles)
-&gt; (Ptr CString -&gt; IO ProcRetHandles) -&gt; IO ProcRetHandles
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679040954"><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040954"><span class="hs-identifier hs-var">pargs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>     </span><span id="local-6989586621679040955"><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040955"><span class="hs-identifier hs-var">fdin</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FD -&gt; StdStream -&gt; IO FD
</span><a href="System.Process.Common.html#mbFd"><span class="hs-identifier hs-var">mbFd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040909"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="System.Process.Common.html#fd_stdin"><span class="hs-identifier hs-var">fd_stdin</span></a></span><span>  </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040918"><span class="hs-identifier hs-var">mb_stdin</span></a></span><span>
</span><span id="line-143"></span><span>     </span><span id="local-6989586621679040958"><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040958"><span class="hs-identifier hs-var">fdout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FD -&gt; StdStream -&gt; IO FD
</span><a href="System.Process.Common.html#mbFd"><span class="hs-identifier hs-var">mbFd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040909"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="System.Process.Common.html#fd_stdout"><span class="hs-identifier hs-var">fd_stdout</span></a></span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040920"><span class="hs-identifier hs-var">mb_stdout</span></a></span><span>
</span><span id="line-144"></span><span>     </span><span id="local-6989586621679040960"><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040960"><span class="hs-identifier hs-var">fderr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FD -&gt; StdStream -&gt; IO FD
</span><a href="System.Process.Common.html#mbFd"><span class="hs-identifier hs-var">mbFd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040909"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="System.Process.Common.html#fd_stderr"><span class="hs-identifier hs-var">fd_stderr</span></a></span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040922"><span class="hs-identifier hs-var">mb_stderr</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040928"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span><span>
</span><span id="line-147"></span><span>       </span><span class="annot"><span class="annottext">IO ()
</span><a href="System.Process.Posix.html#startDelegateControlC"><span class="hs-identifier hs-var">startDelegateControlC</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679040984"><span class="annot"><span class="annottext">flags :: FD
</span><a href="#local-6989586621679040984"><span class="hs-identifier hs-var hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040924"><span class="hs-identifier hs-var">mb_close_fds</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RUN_PROCESS_IN_CLOSE_FDS</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>                  </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; FD
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%7C./GHC.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040926"><span class="hs-identifier hs-var">mb_create_group</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RUN_PROCESS_IN_NEW_GROUP</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                  </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; FD
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%7C./GHC.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040930"><span class="hs-identifier hs-var">mb_detach_console</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RUN_PROCESS_DETACHED</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                  </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; FD
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%7C./GHC.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040932"><span class="hs-identifier hs-var">mb_create_new_console</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RUN_PROCESS_NEW_CONSOLE</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                  </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; FD
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%7C./GHC.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040934"><span class="hs-identifier hs-var">mb_new_session</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RUN_PROCESS_NEW_SESSION</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>                  </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; FD
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%7C./GHC.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040928"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">RESET_INT_QUIT_HANDLERS</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>     </span><span class="hs-comment">-- See the comment on runInteractiveProcess_lock</span><span>
</span><span id="line-157"></span><span>     </span><span id="local-6989586621679040986"><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679040986"><span class="hs-identifier hs-var">proc_handle</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MVar () -&gt; (() -&gt; IO PHANDLE) -&gt; IO PHANDLE
forall a b. MVar a -&gt; (a -&gt; IO b) -&gt; IO b
</span><a href="../../base-4.18.2.1/src/Control.Concurrent.MVar.html#withMVar/Control.Concurrent.MVar.html#withMVar"><span class="hs-identifier hs-var">withMVar</span></a></span><span> </span><span class="annot"><span class="annottext">MVar ()
</span><a href="System.Process.Posix.html#runInteractiveProcess_lock"><span class="hs-identifier hs-var">runInteractiveProcess_lock</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; IO PHANDLE) -&gt; IO PHANDLE)
-&gt; (() -&gt; IO PHANDLE) -&gt; IO PHANDLE
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>                         </span><span class="annot"><span class="annottext">Ptr CString
-&gt; CString
-&gt; Ptr CString
-&gt; FD
-&gt; FD
-&gt; FD
-&gt; Ptr FD
-&gt; Ptr FD
-&gt; Ptr FD
-&gt; Ptr GroupID
-&gt; Ptr UserID
-&gt; FD
-&gt; Ptr CString
-&gt; IO PHANDLE
</span><a href="System.Process.Posix.html#c_runInteractiveProcess"><span class="hs-identifier hs-var">c_runInteractiveProcess</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040954"><span class="hs-identifier hs-var">pargs</span></a></span><span> </span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040949"><span class="hs-identifier hs-var">pWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040948"><span class="hs-identifier hs-var">pEnv</span></a></span><span>
</span><span id="line-159"></span><span>                                </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040955"><span class="hs-identifier hs-var">fdin</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040958"><span class="hs-identifier hs-var">fdout</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040960"><span class="hs-identifier hs-var">fderr</span></a></span><span>
</span><span id="line-160"></span><span>                                </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040943"><span class="hs-identifier hs-var">pfdStdInput</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040944"><span class="hs-identifier hs-var">pfdStdOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040945"><span class="hs-identifier hs-var">pfdStdError</span></a></span><span>
</span><span id="line-161"></span><span>                                </span><span class="annot"><span class="annottext">Ptr GroupID
</span><a href="#local-6989586621679040951"><span class="hs-identifier hs-var">pChildGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr UserID
</span><a href="#local-6989586621679040952"><span class="hs-identifier hs-var">pChildUser</span></a></span><span>
</span><span id="line-162"></span><span>                                </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679040984"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-163"></span><span>                                </span><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040946"><span class="hs-identifier hs-var">pFailedDoing</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679040986"><span class="hs-identifier hs-var">proc_handle</span></a></span><span> </span><span class="annot"><span class="annottext">PHANDLE -&gt; PHANDLE -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">PHANDLE
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>         </span><span id="local-6989586621679040989"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040989"><span class="hs-identifier hs-var">cFailedDoing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CString -&gt; IO CString
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><a href="../../base-4.18.2.1/src/Foreign.Storable.html#peek/Foreign.Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CString
</span><a href="#local-6989586621679040946"><span class="hs-identifier hs-var">pFailedDoing</span></a></span><span>
</span><span id="line-167"></span><span>         </span><span id="local-6989586621679040991"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040991"><span class="hs-identifier hs-var">failedDoing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CString -&gt; IO FilePath
</span><a href="../../base-4.18.2.1/src/Foreign.C.String.html#peekCString/Foreign.C.String.html#peekCString"><span class="hs-identifier hs-var">peekCString</span></a></span><span> </span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679040989"><span class="hs-identifier hs-var">cFailedDoing</span></a></span><span>
</span><span id="line-168"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040928"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span><span>
</span><span id="line-169"></span><span>           </span><span class="annot"><span class="annottext">IO ()
</span><a href="System.Process.Posix.html#stopDelegateControlC"><span class="hs-identifier hs-var">stopDelegateControlC</span></a></span><span>
</span><span id="line-170"></span><span>         </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="../../base-4.18.2.1/src/Foreign.C.Error.html#throwErrno/Foreign.C.Error.html#throwErrno"><span class="hs-identifier hs-var">throwErrno</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040909"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679040991"><span class="hs-identifier hs-var">failedDoing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>     </span><span id="local-6989586621679040994"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040994"><span class="hs-identifier hs-var">hndStdInput</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StdStream -&gt; Ptr FD -&gt; IOMode -&gt; IO (Maybe Handle)
</span><a href="System.Process.Common.html#mbPipe"><span class="hs-identifier hs-var">mbPipe</span></a></span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040918"><span class="hs-identifier hs-var">mb_stdin</span></a></span><span>  </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040943"><span class="hs-identifier hs-var">pfdStdInput</span></a></span><span>  </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.18.2.1/src/GHC.IO.IOMode.html#WriteMode/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span>
</span><span id="line-173"></span><span>     </span><span id="local-6989586621679040997"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040997"><span class="hs-identifier hs-var">hndStdOutput</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StdStream -&gt; Ptr FD -&gt; IOMode -&gt; IO (Maybe Handle)
</span><a href="System.Process.Common.html#mbPipe"><span class="hs-identifier hs-var">mbPipe</span></a></span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040920"><span class="hs-identifier hs-var">mb_stdout</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040944"><span class="hs-identifier hs-var">pfdStdOutput</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.18.2.1/src/GHC.IO.IOMode.html#ReadMode/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>
</span><span id="line-174"></span><span>     </span><span id="local-6989586621679040999"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040999"><span class="hs-identifier hs-var">hndStdError</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StdStream -&gt; Ptr FD -&gt; IOMode -&gt; IO (Maybe Handle)
</span><a href="System.Process.Common.html#mbPipe"><span class="hs-identifier hs-var">mbPipe</span></a></span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="#local-6989586621679040922"><span class="hs-identifier hs-var">mb_stderr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr FD
</span><a href="#local-6989586621679040945"><span class="hs-identifier hs-var">pfdStdError</span></a></span><span>  </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../base-4.18.2.1/src/GHC.IO.IOMode.html#ReadMode/GHC.IO.IOMode.html#ReadMode"><span class="hs-identifier hs-var">ReadMode</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>     </span><span id="local-6989586621679041000"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679041000"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PHANDLE -&gt; Bool -&gt; IO ProcessHandle
</span><a href="System.Process.Posix.html#mkProcessHandle"><span class="hs-identifier hs-var">mkProcessHandle</span></a></span><span> </span><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679040986"><span class="hs-identifier hs-var">proc_handle</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679040928"><span class="hs-identifier hs-var">mb_delegate_ctlc</span></a></span><span>
</span><span id="line-177"></span><span>     </span><span class="annot"><span class="annottext">ProcRetHandles -&gt; IO ProcRetHandles
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><a href="System.Process.Common.html#ProcRetHandles"><span class="hs-identifier hs-type">ProcRetHandles</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hStdInput :: Maybe Handle
</span><a href="#local-6989586621679041002"><span class="hs-identifier hs-var">hStdInput</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040994"><span class="hs-identifier hs-var">hndStdInput</span></a></span><span>
</span><span id="line-178"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hStdOutput :: Maybe Handle
</span><a href="#local-6989586621679041003"><span class="hs-identifier hs-var">hStdOutput</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040997"><span class="hs-identifier hs-var">hndStdOutput</span></a></span><span>
</span><span id="line-179"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hStdError :: Maybe Handle
</span><a href="#local-6989586621679041004"><span class="hs-identifier hs-var">hStdError</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679040999"><span class="hs-identifier hs-var">hndStdError</span></a></span><span>
</span><span id="line-180"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">procHandle :: ProcessHandle
</span><a href="#local-6989586621679041005"><span class="hs-identifier hs-var">procHandle</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679041000"><span class="hs-identifier hs-var">ph</span></a></span><span>
</span><span id="line-181"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="System.Process.Posix.html#runInteractiveProcess_lock"><span class="hs-pragma hs-type">runInteractiveProcess_lock</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | 'runInteractiveProcess' blocks signals around the fork().</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- Since blocking/unblocking of signals is a global state operation, we need to</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- ensure mutual exclusion of calls to 'runInteractiveProcess'.</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- This lock is exported so that other libraries which also need to fork()</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- (and also need to make the same global state changes) can protect their changes</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- with the same lock.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- See https://github.com/haskell/process/pull/154.</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- @since 1.6.6.0</span><span>
</span><span id="line-193"></span><span class="annot"><a href="System.Process.Posix.html#runInteractiveProcess_lock"><span class="hs-identifier hs-type">runInteractiveProcess_lock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.MVar.html#MVar/GHC.MVar.html#MVar"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="runInteractiveProcess_lock"><span class="annot"><span class="annottext">runInteractiveProcess_lock :: MVar ()
</span><a href="System.Process.Posix.html#runInteractiveProcess_lock"><span class="hs-identifier hs-var hs-var">runInteractiveProcess_lock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (MVar ()) -&gt; MVar ()
forall a. IO a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (MVar ()) -&gt; MVar ()) -&gt; IO (MVar ()) -&gt; MVar ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO (MVar ())
forall a. a -&gt; IO (MVar a)
</span><a href="../../base-4.18.2.1/src/GHC.MVar.html#newMVar/GHC.MVar.html#newMVar"><span class="hs-identifier hs-var">newMVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- ----------------------------------------------------------------------------</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- Delegated control-C handling on Unix</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- See ticket https://ghc.haskell.org/trac/ghc/ticket/2301</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- and http://www.cons.org/cracauer/sigint.html</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- While running an interactive console process like ghci or a shell, we want</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- to let that process handle Ctl-C keyboard interrupts how it sees fit.</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- So that means we need to ignore the SIGINT/SIGQUIT Unix signals while we're</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- running such programs. And then if/when they do terminate, we need to check</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- if they terminated due to SIGINT/SIGQUIT and if so then we behave as if we</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- got the Ctl-C then, by throwing the UserInterrupt exception.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- If we run multiple programs like this concurrently then we have to be</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- careful to avoid messing up the signal handlers. We keep a count and only</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- restore when the last one has finished.</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="System.Process.Posix.html#runInteractiveProcess_delegate_ctlc"><span class="hs-pragma hs-type">runInteractiveProcess_delegate_ctlc</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-214"></span><span class="annot"><a href="System.Process.Posix.html#runInteractiveProcess_delegate_ctlc"><span class="hs-identifier hs-type">runInteractiveProcess_delegate_ctlc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.MVar.html#MVar/GHC.MVar.html#MVar"><span class="hs-identifier hs-type">MVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Maybe/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#Handler/System.Posix.Signals.html#Handler"><span class="hs-identifier hs-type">Sig.Handler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#Handler/System.Posix.Signals.html#Handler"><span class="hs-identifier hs-type">Sig.Handler</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span id="runInteractiveProcess_delegate_ctlc"><span class="annot"><span class="annottext">runInteractiveProcess_delegate_ctlc :: MVar (Maybe (Int, Handler, Handler))
</span><a href="System.Process.Posix.html#runInteractiveProcess_delegate_ctlc"><span class="hs-identifier hs-var hs-var">runInteractiveProcess_delegate_ctlc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (MVar (Maybe (Int, Handler, Handler)))
-&gt; MVar (Maybe (Int, Handler, Handler))
forall a. IO a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.IO.Unsafe.html#unsafePerformIO/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (MVar (Maybe (Int, Handler, Handler)))
 -&gt; MVar (Maybe (Int, Handler, Handler)))
-&gt; IO (MVar (Maybe (Int, Handler, Handler)))
-&gt; MVar (Maybe (Int, Handler, Handler))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
-&gt; IO (MVar (Maybe (Int, Handler, Handler)))
forall a. a -&gt; IO (MVar a)
</span><a href="../../base-4.18.2.1/src/GHC.MVar.html#newMVar/GHC.MVar.html#newMVar"><span class="hs-identifier hs-var">newMVar</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="annot"><a href="System.Process.Posix.html#startDelegateControlC"><span class="hs-identifier hs-type">startDelegateControlC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span id="startDelegateControlC"><span class="annot"><span class="annottext">startDelegateControlC :: IO ()
</span><a href="System.Process.Posix.html#startDelegateControlC"><span class="hs-identifier hs-var hs-var">startDelegateControlC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">MVar (Maybe (Int, Handler, Handler))
-&gt; (Maybe (Int, Handler, Handler)
    -&gt; IO (Maybe (Int, Handler, Handler)))
-&gt; IO ()
forall a. MVar a -&gt; (a -&gt; IO a) -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/Control.Concurrent.MVar.html#modifyMVar_/Control.Concurrent.MVar.html#modifyMVar_"><span class="hs-identifier hs-var">modifyMVar_</span></a></span><span> </span><span class="annot"><span class="annottext">MVar (Maybe (Int, Handler, Handler))
</span><a href="System.Process.Posix.html#runInteractiveProcess_delegate_ctlc"><span class="hs-identifier hs-var">runInteractiveProcess_delegate_ctlc</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Int, Handler, Handler)
  -&gt; IO (Maybe (Int, Handler, Handler)))
 -&gt; IO ())
-&gt; (Maybe (Int, Handler, Handler)
    -&gt; IO (Maybe (Int, Handler, Handler)))
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679041009"><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="#local-6989586621679041009"><span class="hs-identifier hs-var">delegating</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="#local-6989586621679041009"><span class="hs-identifier hs-var">delegating</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-comment">-- We're going to ignore ^C in the parent while there are any</span><span>
</span><span id="line-223"></span><span>          </span><span class="hs-comment">-- processes using ^C delegation.</span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-comment">-- If another thread runs another process without using</span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-comment">-- delegation while we're doing this then it will inherit the</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-comment">-- ignore ^C status.</span><span>
</span><span id="line-228"></span><span>          </span><span id="local-6989586621679041010"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041010"><span class="hs-identifier hs-var">old_int</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FD -&gt; Handler -&gt; Maybe SignalSet -&gt; IO Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#installHandler/System.Posix.Signals.html#installHandler"><span class="hs-identifier hs-var">installHandler</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigINT/System.Posix.Signals.html#sigINT"><span class="hs-identifier hs-var">sigINT</span></a></span><span>  </span><span class="annot"><span class="annottext">Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#Ignore/System.Posix.Signals.html#Ignore"><span class="hs-identifier hs-var">Ignore</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SignalSet
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-229"></span><span>          </span><span id="local-6989586621679041014"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041014"><span class="hs-identifier hs-var">old_quit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FD -&gt; Handler -&gt; Maybe SignalSet -&gt; IO Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#installHandler/System.Posix.Signals.html#installHandler"><span class="hs-identifier hs-var">installHandler</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigQUIT/System.Posix.Signals.html#sigQUIT"><span class="hs-identifier hs-var">sigQUIT</span></a></span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#Ignore/System.Posix.Signals.html#Ignore"><span class="hs-identifier hs-var">Ignore</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SignalSet
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler) -&gt; IO (Maybe (Int, Handler, Handler))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Handler, Handler) -&gt; Maybe (Int, Handler, Handler)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041010"><span class="hs-identifier hs-var">old_int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041014"><span class="hs-identifier hs-var">old_quit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041016"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041016"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041017"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041017"><span class="hs-identifier hs-var">old_int</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041018"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041018"><span class="hs-identifier hs-var">old_quit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-comment">-- If we're already doing it, just increment the count</span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041021"><span class="annot"><span class="annottext">count' :: Int
</span><a href="#local-6989586621679041021"><span class="hs-identifier hs-var hs-var">count'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041016"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler) -&gt; IO (Maybe (Int, Handler, Handler))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Handler, Handler) -&gt; Maybe (Int, Handler, Handler)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041021"><span class="hs-identifier hs-var">count'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041017"><span class="hs-identifier hs-var">old_int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041018"><span class="hs-identifier hs-var">old_quit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="annot"><a href="System.Process.Posix.html#stopDelegateControlC"><span class="hs-identifier hs-type">stopDelegateControlC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span id="stopDelegateControlC"><span class="annot"><span class="annottext">stopDelegateControlC :: IO ()
</span><a href="System.Process.Posix.html#stopDelegateControlC"><span class="hs-identifier hs-var hs-var">stopDelegateControlC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">MVar (Maybe (Int, Handler, Handler))
-&gt; (Maybe (Int, Handler, Handler)
    -&gt; IO (Maybe (Int, Handler, Handler)))
-&gt; IO ()
forall a. MVar a -&gt; (a -&gt; IO a) -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/Control.Concurrent.MVar.html#modifyMVar_/Control.Concurrent.MVar.html#modifyMVar_"><span class="hs-identifier hs-var">modifyMVar_</span></a></span><span> </span><span class="annot"><span class="annottext">MVar (Maybe (Int, Handler, Handler))
</span><a href="System.Process.Posix.html#runInteractiveProcess_delegate_ctlc"><span class="hs-identifier hs-var">runInteractiveProcess_delegate_ctlc</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Int, Handler, Handler)
  -&gt; IO (Maybe (Int, Handler, Handler)))
 -&gt; IO ())
-&gt; (Maybe (Int, Handler, Handler)
    -&gt; IO (Maybe (Int, Handler, Handler)))
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679041023"><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="#local-6989586621679041023"><span class="hs-identifier hs-var">delegating</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="#local-6989586621679041023"><span class="hs-identifier hs-var">delegating</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041024"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041024"><span class="hs-identifier hs-var">old_int</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041025"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041025"><span class="hs-identifier hs-var">old_quit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>          </span><span class="hs-comment">-- Last process, so restore the old signal handlers</span><span>
</span><span id="line-243"></span><span>          </span><span class="annot"><span class="annottext">Handler
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FD -&gt; Handler -&gt; Maybe SignalSet -&gt; IO Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#installHandler/System.Posix.Signals.html#installHandler"><span class="hs-identifier hs-var">installHandler</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigINT/System.Posix.Signals.html#sigINT"><span class="hs-identifier hs-var">sigINT</span></a></span><span>  </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041024"><span class="hs-identifier hs-var">old_int</span></a></span><span>  </span><span class="annot"><span class="annottext">Maybe SignalSet
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-244"></span><span>          </span><span class="annot"><span class="annottext">Handler
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FD -&gt; Handler -&gt; Maybe SignalSet -&gt; IO Handler
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#installHandler/System.Posix.Signals.html#installHandler"><span class="hs-identifier hs-var">installHandler</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigQUIT/System.Posix.Signals.html#sigQUIT"><span class="hs-identifier hs-var">sigQUIT</span></a></span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041025"><span class="hs-identifier hs-var">old_quit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SignalSet
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-245"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler) -&gt; IO (Maybe (Int, Handler, Handler))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041026"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041027"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041027"><span class="hs-identifier hs-var">old_int</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041028"><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041028"><span class="hs-identifier hs-var">old_quit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>          </span><span class="hs-comment">-- Not the last, just decrement the count</span><span>
</span><span id="line-249"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679041031"><span class="annot"><span class="annottext">count' :: Int
</span><a href="#local-6989586621679041031"><span class="hs-identifier hs-var hs-var">count'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041026"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-250"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler) -&gt; IO (Maybe (Int, Handler, Handler))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Handler, Handler) -&gt; Maybe (Int, Handler, Handler)
forall a. a -&gt; Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Just/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041031"><span class="hs-identifier hs-var">count'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041027"><span class="hs-identifier hs-var">old_int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handler
</span><a href="#local-6989586621679041028"><span class="hs-identifier hs-var">old_quit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler) -&gt; IO (Maybe (Int, Handler, Handler))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Handler, Handler)
forall a. Maybe a
</span><a href="../../base-4.18.2.1/src/GHC.Maybe.html#Nothing/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-comment">-- should be impossible</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="System.Process.Posix.html#endDelegateControlC"><span class="hs-identifier hs-type">endDelegateControlC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.Exception.html#ExitCode/GHC.IO.Exception.html#ExitCode"><span class="hs-identifier hs-type">ExitCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span id="endDelegateControlC"><span class="annot"><span class="annottext">endDelegateControlC :: ExitCode -&gt; IO ()
</span><a href="System.Process.Posix.html#endDelegateControlC"><span class="hs-identifier hs-var hs-var">endDelegateControlC</span></a></span></span><span> </span><span id="local-6989586621679041032"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679041032"><span class="hs-identifier hs-var">exitCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">IO ()
</span><a href="System.Process.Posix.html#stopDelegateControlC"><span class="hs-identifier hs-var">stopDelegateControlC</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- And if the process did die due to SIGINT or SIGQUIT then</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- we throw our equivalent exception here (synchronously).</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- An alternative design would be to throw to the main thread, as the</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- normal signal handler does. But since we can be sync here, we do so.</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- It allows the code locally to catch it and do something.</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679041032"><span class="hs-identifier hs-var">exitCode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.Exception.html#ExitFailure/GHC.IO.Exception.html#ExitFailure"><span class="hs-identifier hs-type">ExitFailure</span></a></span><span> </span><span id="local-6989586621679041034"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041034"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall {p}. Integral p =&gt; p -&gt; Bool
</span><a href="#local-6989586621679041035"><span class="hs-identifier hs-var">isSigIntQuit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679041034"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AsyncException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="../../base-4.18.2.1/src/GHC.IO.html#throwIO/GHC.IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">AsyncException
</span><a href="../../base-4.18.2.1/src/GHC.IO.Exception.html#UserInterrupt/GHC.IO.Exception.html#UserInterrupt"><span class="hs-identifier hs-var">UserInterrupt</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier">_</span></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679041035"><span class="annot"><span class="annottext">isSigIntQuit :: p -&gt; Bool
</span><a href="#local-6989586621679041035"><span class="hs-identifier hs-var hs-var">isSigIntQuit</span></a></span></span><span> </span><span id="local-6989586621679041051"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679041051"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041052"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigINT/System.Posix.Signals.html#sigINT"><span class="hs-identifier hs-var">sigINT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041052"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">FD -&gt; FD -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigQUIT/System.Posix.Signals.html#sigQUIT"><span class="hs-identifier hs-var">sigQUIT</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621679041052"><span class="annot"><span class="annottext">sig :: FD
</span><a href="#local-6989586621679041052"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; FD
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679041051"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if defined(wasm32_HOST_ARCH)
</span><span>
</span><span id="line-274"></span><span class="hs-identifier">c_runInteractiveProcess</span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-glyph">::</span><span>  </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CString</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CString</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CString</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">FD</span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CGid</span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CUid</span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CInt</span><span>                         </span><span class="hs-comment">-- flags</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CString</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">PHANDLE</span><span>
</span><span id="line-289"></span><span class="hs-identifier">c_runInteractiveProcess</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ioError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ioeSetLocation</span><span> </span><span class="hs-identifier">unsupportedOperation</span><span> </span><span class="hs-string">&quot;runInteractiveProcess&quot;</span><span class="hs-special">)</span><span class="hs-cpp">

#else
</span><span>
</span><span id="line-293"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;runInteractiveProcess&quot;</span></span><span>
</span><span id="line-294"></span><span>  </span><span id="c_runInteractiveProcess"><span class="annot"><a href="System.Process.Posix.html#c_runInteractiveProcess"><span class="hs-identifier hs-var">c_runInteractiveProcess</span></a></span></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Foreign.html#CString/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Foreign.html#CString/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Foreign.html#CString/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Types.html#CGid/System.Posix.Types.html#CGid"><span class="hs-identifier hs-type">CGid</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Types.html#CUid/System.Posix.Types.html#CUid"><span class="hs-identifier hs-type">CUid</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.C.Types.html#CInt/Foreign.C.Types.html#CInt"><span class="hs-identifier hs-type">CInt</span></a></span><span>                         </span><span class="hs-comment">-- flags</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Foreign.html#CString/GHC.Foreign.html#CString"><span class="hs-identifier hs-type">CString</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Process.Common.html#PHANDLE"><span class="hs-identifier hs-type">PHANDLE</span></a></span><span class="hs-cpp">

#endif
</span><span>
</span><span id="line-312"></span><span class="annot"><a href="System.Process.Posix.html#ignoreSignal"><span class="hs-identifier hs-type">ignoreSignal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Process.Posix.html#defaultSignal"><span class="hs-identifier hs-type">defaultSignal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.C.Types.html#CLong/Foreign.C.Types.html#CLong"><span class="hs-identifier hs-type">CLong</span></a></span><span>
</span><span id="line-313"></span><span id="ignoreSignal"><span class="annot"><span class="annottext">ignoreSignal :: CLong
</span><a href="System.Process.Posix.html#ignoreSignal"><span class="hs-identifier hs-var hs-var">ignoreSignal</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CONST_SIG_IGN</span><span>
</span><span id="line-314"></span><span id="defaultSignal"><span class="annot"><span class="annottext">defaultSignal :: CLong
</span><a href="System.Process.Posix.html#defaultSignal"><span class="hs-identifier hs-var hs-var">defaultSignal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">CONST_SIG_DFL</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="System.Process.Posix.html#isDefaultSignal"><span class="hs-identifier hs-type">isDefaultSignal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.C.Types.html#CLong/Foreign.C.Types.html#CLong"><span class="hs-identifier hs-type">CLong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-317"></span><span id="isDefaultSignal"><span class="annot"><span class="annottext">isDefaultSignal :: CLong -&gt; Bool
</span><a href="System.Process.Posix.html#isDefaultSignal"><span class="hs-identifier hs-var hs-var">isDefaultSignal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLong -&gt; CLong -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CLong
</span><a href="System.Process.Posix.html#defaultSignal"><span class="hs-identifier hs-var">defaultSignal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="System.Process.Posix.html#createPipeInternal"><span class="hs-identifier hs-type">createPipeInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span id="createPipeInternal"><span class="annot"><span class="annottext">createPipeInternal :: IO (Handle, Handle)
</span><a href="System.Process.Posix.html#createPipeInternal"><span class="hs-identifier hs-var hs-var">createPipeInternal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679041064"><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679041064"><span class="hs-identifier hs-var">readfd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679041065"><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679041065"><span class="hs-identifier hs-var">writefd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Fd, Fd)
</span><a href="../../unix-2.8.4.0/src/System.Posix.IO.Common.html#createPipe/System.Posix.IO.Common.html#createPipe"><span class="hs-identifier hs-var">Posix.createPipe</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679041067"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679041067"><span class="hs-identifier hs-var">readh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fd -&gt; IO Handle
</span><a href="../../unix-2.8.4.0/src/System.Posix.IO.Common.html#fdToHandle/System.Posix.IO.Common.html#fdToHandle"><span class="hs-identifier hs-var">Posix.fdToHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679041064"><span class="hs-identifier hs-var">readfd</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679041069"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679041069"><span class="hs-identifier hs-var">writeh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fd -&gt; IO Handle
</span><a href="../../unix-2.8.4.0/src/System.Posix.IO.Common.html#fdToHandle/System.Posix.IO.Common.html#fdToHandle"><span class="hs-identifier hs-var">Posix.fdToHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679041065"><span class="hs-identifier hs-var">writefd</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">(Handle, Handle) -&gt; IO (Handle, Handle)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679041067"><span class="hs-identifier hs-var">readh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679041069"><span class="hs-identifier hs-var">writeh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="System.Process.Posix.html#createPipeInternalFd"><span class="hs-identifier hs-type">createPipeInternalFd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Internals.html#FD/System.Posix.Internals.html#FD"><span class="hs-identifier hs-type">FD</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span id="createPipeInternalFd"><span class="annot"><span class="annottext">createPipeInternalFd :: IO (FD, FD)
</span><a href="System.Process.Posix.html#createPipeInternalFd"><span class="hs-identifier hs-var hs-var">createPipeInternalFd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Types.html#Fd/System.Posix.Types.html#Fd"><span class="hs-identifier hs-type">Fd</span></a></span><span> </span><span id="local-6989586621679041071"><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041071"><span class="hs-identifier hs-var">readfd</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/System.Posix.Types.html#Fd/System.Posix.Types.html#Fd"><span class="hs-identifier hs-type">Fd</span></a></span><span> </span><span id="local-6989586621679041072"><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041072"><span class="hs-identifier hs-var">writefd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Fd, Fd)
</span><a href="../../unix-2.8.4.0/src/System.Posix.IO.Common.html#createPipe/System.Posix.IO.Common.html#createPipe"><span class="hs-identifier hs-var">Posix.createPipe</span></a></span><span>
</span><span id="line-329"></span><span>   </span><span class="annot"><span class="annottext">(FD, FD) -&gt; IO (FD, FD)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041071"><span class="hs-identifier hs-var">readfd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="#local-6989586621679041072"><span class="hs-identifier hs-var">writefd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><a href="System.Process.Posix.html#interruptProcessGroupOfInternal"><span class="hs-identifier hs-type">interruptProcessGroupOfInternal</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Process.Common.html#ProcessHandle"><span class="hs-identifier hs-type">ProcessHandle</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ A process in the process group</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span id="interruptProcessGroupOfInternal"><span class="annot"><span class="annottext">interruptProcessGroupOfInternal :: ProcessHandle -&gt; IO ()
</span><a href="System.Process.Posix.html#interruptProcessGroupOfInternal"><span class="hs-identifier hs-var hs-var">interruptProcessGroupOfInternal</span></a></span></span><span> </span><span id="local-6989586621679041073"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679041073"><span class="hs-identifier hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">ProcessHandle -&gt; (ProcessHandle__ -&gt; IO ()) -&gt; IO ()
forall a. ProcessHandle -&gt; (ProcessHandle__ -&gt; IO a) -&gt; IO a
</span><a href="System.Process.Common.html#withProcessHandle"><span class="hs-identifier hs-var">withProcessHandle</span></a></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679041073"><span class="hs-identifier hs-var">ph</span></a></span><span> </span><span class="annot"><span class="annottext">((ProcessHandle__ -&gt; IO ()) -&gt; IO ())
-&gt; (ProcessHandle__ -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679041075"><span class="annot"><span class="annottext">ProcessHandle__
</span><a href="#local-6989586621679041075"><span class="hs-identifier hs-var">p_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProcessHandle__
</span><a href="#local-6989586621679041075"><span class="hs-identifier hs-var">p_</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><a href="System.Process.Common.html#OpenExtHandle"><span class="hs-identifier hs-type">OpenExtHandle</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><a href="System.Process.Common.html#ClosedHandle"><span class="hs-identifier hs-type">ClosedHandle</span></a></span><span>  </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>            </span><span class="annot"><a href="System.Process.Common.html#OpenHandle"><span class="hs-identifier hs-type">OpenHandle</span></a></span><span>    </span><span id="local-6989586621679041078"><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679041078"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>                </span><span id="local-6989586621679041079"><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679041079"><span class="hs-identifier hs-var">pgid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PHANDLE -&gt; IO PHANDLE
</span><a href="../../unix-2.8.4.0/src/System.Posix.Process.Common.html#getProcessGroupIDOf/System.Posix.Process.Common.html#getProcessGroupIDOf"><span class="hs-identifier hs-var">getProcessGroupIDOf</span></a></span><span> </span><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679041078"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-341"></span><span>                </span><span class="annot"><span class="annottext">FD -&gt; PHANDLE -&gt; IO ()
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#signalProcessGroup/System.Posix.Signals.html#signalProcessGroup"><span class="hs-identifier hs-var">signalProcessGroup</span></a></span><span> </span><span class="annot"><span class="annottext">FD
</span><a href="../../unix-2.8.4.0/src/System.Posix.Signals.html#sigINT/System.Posix.Signals.html#sigINT"><span class="hs-identifier hs-var">sigINT</span></a></span><span> </span><span class="annot"><span class="annottext">PHANDLE
</span><a href="#local-6989586621679041079"><span class="hs-identifier hs-var">pgid</span></a></span><span>
</span><span id="line-342"></span></pre></body></html>