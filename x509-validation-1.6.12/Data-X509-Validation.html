<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.X509.Validation</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">x509-validation-1.6.12: X.509 Certificate and CRL validation</span><ul class="links" id="page-menu"><li><a href="src/Data.X509.Validation.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Vincent Hanquez &lt;vincent@snarc.org&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>unknown</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.X509.Validation</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Failed validation types</a></li><li><a href="#g:2">Validation configuration types</a></li><li><a href="#g:3">Validation</a></li><li><a href="#g:4">Cache</a></li><li><a href="#g:5">Cache for validation</a></li><li><a href="#g:6">Simple instances of cache mechanism</a></li><li><a href="#g:7">Signature verification</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>X.509 Certificate checks and validations routines</p><p>Follows RFC5280 / RFC6818</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:ServiceID">ServiceID</a> = (<a href="Data-X509-Validation.html#t:HostName" title="Data.X509.Validation">HostName</a>, <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</li><li class="src short"><span class="keyword">type</span> <a href="#t:HostName">HostName</a> = <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Fingerprint">Fingerprint</a> = <a href="#v:Fingerprint">Fingerprint</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:FailedReason">FailedReason</a><ul class="subs"><li>= <a href="#v:UnknownCriticalExtension">UnknownCriticalExtension</a></li><li>| <a href="#v:Expired">Expired</a></li><li>| <a href="#v:InFuture">InFuture</a></li><li>| <a href="#v:SelfSigned">SelfSigned</a></li><li>| <a href="#v:UnknownCA">UnknownCA</a></li><li>| <a href="#v:NotAllowedToSign">NotAllowedToSign</a></li><li>| <a href="#v:NotAnAuthority">NotAnAuthority</a></li><li>| <a href="#v:AuthorityTooDeep">AuthorityTooDeep</a></li><li>| <a href="#v:NoCommonName">NoCommonName</a></li><li>| <a href="#v:InvalidName">InvalidName</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li>| <a href="#v:NameMismatch">NameMismatch</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li>| <a href="#v:InvalidWildcard">InvalidWildcard</a></li><li>| <a href="#v:LeafKeyUsageNotAllowed">LeafKeyUsageNotAllowed</a></li><li>| <a href="#v:LeafKeyPurposeNotAllowed">LeafKeyPurposeNotAllowed</a></li><li>| <a href="#v:LeafNotV3">LeafNotV3</a></li><li>| <a href="#v:EmptyChain">EmptyChain</a></li><li>| <a href="#v:CacheSaysNo">CacheSaysNo</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li>| <a href="#v:InvalidSignature">InvalidSignature</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SignatureFailure">SignatureFailure</a><ul class="subs"><li>= <a href="#v:SignatureInvalid">SignatureInvalid</a></li><li>| <a href="#v:SignaturePubkeyMismatch">SignaturePubkeyMismatch</a></li><li>| <a href="#v:SignatureUnimplemented">SignatureUnimplemented</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationChecks">ValidationChecks</a> = <a href="#v:ValidationChecks">ValidationChecks</a> {<ul class="subs"><li><a href="#v:checkTimeValidity">checkTimeValidity</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:checkAtTime">checkAtTime</a> :: <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a></li><li><a href="#v:checkStrictOrdering">checkStrictOrdering</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:checkCAConstraints">checkCAConstraints</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:checkExhaustive">checkExhaustive</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:checkLeafV3">checkLeafV3</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:checkLeafKeyUsage">checkLeafKeyUsage</a> :: [<a href="../x509-1.7.7/Data-X509.html#t:ExtKeyUsageFlag" title="Data.X509">ExtKeyUsageFlag</a>]</li><li><a href="#v:checkLeafKeyPurpose">checkLeafKeyPurpose</a> :: [<a href="../x509-1.7.7/Data-X509.html#t:ExtKeyUsagePurpose" title="Data.X509">ExtKeyUsagePurpose</a>]</li><li><a href="#v:checkFQHN">checkFQHN</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationHooks">ValidationHooks</a> = <a href="#v:ValidationHooks">ValidationHooks</a> {<ul class="subs"><li><a href="#v:hookMatchSubjectIssuer">hookMatchSubjectIssuer</a> :: <a href="../x509-1.7.7/Data-X509.html#t:DistinguishedName" title="Data.X509">DistinguishedName</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li><a href="#v:hookValidateTime">hookValidateTime</a> :: <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li><li><a href="#v:hookValidateName">hookValidateName</a> :: <a href="Data-X509-Validation.html#t:HostName" title="Data.X509.Validation">HostName</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li><li><a href="#v:hookFilterReason">hookFilterReason</a> :: [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>] -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li></ul>}</li><li class="src short"><a href="#v:defaultChecks">defaultChecks</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></li><li class="src short"><a href="#v:defaultHooks">defaultHooks</a> :: <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a></li><li class="src short"><a href="#v:validate">validate</a> :: <a href="../x509-1.7.7/Data-X509.html#t:HashALG" title="Data.X509">HashALG</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a> -&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li><li class="src short"><a href="#v:validatePure">validatePure</a> :: <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a> -&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li><li class="src short"><a href="#v:validateDefault">validateDefault</a> :: <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a> -&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</li><li class="src short"><a href="#v:getFingerprint">getFingerprint</a> :: (<a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> a) =&gt; <a href="../x509-1.7.7/Data-X509.html#t:SignedExact" title="Data.X509">SignedExact</a> a -&gt; <a href="../x509-1.7.7/Data-X509.html#t:HashALG" title="Data.X509">HashALG</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationCacheResult">ValidationCacheResult</a><ul class="subs"><li>= <a href="#v:ValidationCachePass">ValidationCachePass</a></li><li>| <a href="#v:ValidationCacheDenied">ValidationCacheDenied</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></li><li>| <a href="#v:ValidationCacheUnknown">ValidationCacheUnknown</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:ValidationCacheQueryCallback">ValidationCacheQueryCallback</a> = <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:ValidationCacheAddCallback">ValidationCacheAddCallback</a> = <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:ValidationCache">ValidationCache</a> = <a href="#v:ValidationCache">ValidationCache</a> {<ul class="subs"><li><a href="#v:cacheQuery">cacheQuery</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheQueryCallback" title="Data.X509.Validation">ValidationCacheQueryCallback</a></li><li><a href="#v:cacheAdd">cacheAdd</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheAddCallback" title="Data.X509.Validation">ValidationCacheAddCallback</a></li></ul>}</li><li class="src short"><a href="#v:exceptionValidationCache">exceptionValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a>)] -&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></li><li class="src short"><a href="#v:tofuValidationCache">tofuValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a>)] -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></li><li class="src short"><a href="#v:verifySignedSignature">verifySignedSignature</a> :: (<a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> a) =&gt; <a href="../x509-1.7.7/Data-X509.html#t:SignedExact" title="Data.X509">SignedExact</a> a -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PubKey" title="Data.X509">PubKey</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a></li><li class="src short"><a href="#v:verifySignature">verifySignature</a> :: <a href="../x509-1.7.7/Data-X509.html#t:SignatureALG" title="Data.X509">SignatureALG</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PubKey" title="Data.X509">PubKey</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:SignatureVerification">SignatureVerification</a><ul class="subs"><li>= <a href="#v:SignaturePass">SignaturePass</a></li><li>| <a href="#v:SignatureFailed">SignatureFailed</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SignatureFailure">SignatureFailure</a><ul class="subs"><li>= <a href="#v:SignatureInvalid">SignatureInvalid</a></li><li>| <a href="#v:SignaturePubkeyMismatch">SignaturePubkeyMismatch</a></li><li>| <a href="#v:SignatureUnimplemented">SignatureUnimplemented</a></li></ul></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ServiceID" class="def">ServiceID</a> = (<a href="Data-X509-Validation.html#t:HostName" title="Data.X509.Validation">HostName</a>, <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>) <a href="src/Data.X509.Validation.Types.html#ServiceID" class="link">Source</a> <a href="#t:ServiceID" class="selflink">#</a></p><div class="doc"><p>identification of the connection consisting of the
 fully qualified host name (e.g. www.example.com) and
 an optional suffix.</p><p>The suffix is not used by the validation process, but
 is used by the optional cache to identity certificate per service
 on a specific host. For example, one might have a different
 certificate on 2 differents ports (443 and 995) for the same host.</p><p>for TCP connection, it's recommended to use: :port, or :service for the suffix.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:HostName" class="def">HostName</a> = <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="src/Data.X509.Validation.Types.html#HostName" class="link">Source</a> <a href="#t:HostName" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:Fingerprint" class="def">Fingerprint</a> <a href="src/Data.X509.Validation.Fingerprint.html#Fingerprint" class="link">Source</a> <a href="#t:Fingerprint" class="selflink">#</a></p><div class="doc"><p>Fingerprint of a certificate</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Fingerprint" class="def">Fingerprint</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Fingerprint">Instances</h4><details id="i:Fingerprint" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Fingerprint:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></span> <a href="src/Data.X509.Validation.Fingerprint.html#line-22" class="link">Source</a> <a href="#t:Fingerprint" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Fingerprint:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Fingerprint.html">Data.X509.Validation.Fingerprint</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Fingerprint:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></span> <a href="src/Data.X509.Validation.Fingerprint.html#line-22" class="link">Source</a> <a href="#t:Fingerprint" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Fingerprint:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Fingerprint.html">Data.X509.Validation.Fingerprint</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Fingerprint:ByteArrayAccess:3"></span> <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></span> <a href="src/Data.X509.Validation.Fingerprint.html#line-22" class="link">Source</a> <a href="#t:Fingerprint" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Fingerprint:ByteArrayAccess:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Fingerprint.html">Data.X509.Validation.Fingerprint</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:length">length</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:length" class="selflink">#</a></p><p class="src"><a href="#v:withByteArray">withByteArray</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; (<a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="#v:withByteArray" class="selflink">#</a></p><p class="src"><a href="#v:copyByteArrayToPtr">copyByteArrayToPtr</a> :: <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a> -&gt; <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="#v:copyByteArrayToPtr" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:1" id="g:1"><h1>Failed validation types</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FailedReason" class="def">FailedReason</a> <a href="src/Data.X509.Validation.html#FailedReason" class="link">Source</a> <a href="#t:FailedReason" class="selflink">#</a></p><div class="doc"><p>Possible reason of certificate and chain failure.</p><p>The values <code><a href="Data-X509-Validation.html#v:InvalidName" title="Data.X509.Validation">InvalidName</a></code> and <code><a href="Data-X509-Validation.html#v:InvalidWildcard" title="Data.X509.Validation">InvalidWildcard</a></code> are internal-only and are
 never returned by the validation functions.  <code><a href="Data-X509-Validation.html#v:NameMismatch" title="Data.X509.Validation">NameMismatch</a></code> is returned
 instead.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:UnknownCriticalExtension" class="def">UnknownCriticalExtension</a></td><td class="doc"><p>certificate contains an unknown critical extension</p></td></tr><tr><td class="src"><a id="v:Expired" class="def">Expired</a></td><td class="doc"><p>validity ends before checking time</p></td></tr><tr><td class="src"><a id="v:InFuture" class="def">InFuture</a></td><td class="doc"><p>validity starts after checking time</p></td></tr><tr><td class="src"><a id="v:SelfSigned" class="def">SelfSigned</a></td><td class="doc"><p>certificate is self signed</p></td></tr><tr><td class="src"><a id="v:UnknownCA" class="def">UnknownCA</a></td><td class="doc"><p>unknown Certificate Authority (CA)</p></td></tr><tr><td class="src"><a id="v:NotAllowedToSign" class="def">NotAllowedToSign</a></td><td class="doc"><p>certificate is not allowed to sign</p></td></tr><tr><td class="src"><a id="v:NotAnAuthority" class="def">NotAnAuthority</a></td><td class="doc"><p>not a CA</p></td></tr><tr><td class="src"><a id="v:AuthorityTooDeep" class="def">AuthorityTooDeep</a></td><td class="doc"><p>Violation of the optional Basic constraint's path length</p></td></tr><tr><td class="src"><a id="v:NoCommonName" class="def">NoCommonName</a></td><td class="doc"><p>Certificate doesn't have any common name (CN)</p></td></tr><tr><td class="src"><a id="v:InvalidName" class="def">InvalidName</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>Invalid name in certificate</p></td></tr><tr><td class="src"><a id="v:NameMismatch" class="def">NameMismatch</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>connection name and certificate do not match</p></td></tr><tr><td class="src"><a id="v:InvalidWildcard" class="def">InvalidWildcard</a></td><td class="doc"><p>invalid wildcard in certificate</p></td></tr><tr><td class="src"><a id="v:LeafKeyUsageNotAllowed" class="def">LeafKeyUsageNotAllowed</a></td><td class="doc"><p>the requested key usage is not compatible with the leaf certificate's key usage</p></td></tr><tr><td class="src"><a id="v:LeafKeyPurposeNotAllowed" class="def">LeafKeyPurposeNotAllowed</a></td><td class="doc"><p>the requested key purpose is not compatible with the leaf certificate's extended key usage</p></td></tr><tr><td class="src"><a id="v:LeafNotV3" class="def">LeafNotV3</a></td><td class="doc"><p>Only authorized an X509.V3 certificate as leaf certificate.</p></td></tr><tr><td class="src"><a id="v:EmptyChain" class="def">EmptyChain</a></td><td class="doc"><p>empty chain of certificate</p></td></tr><tr><td class="src"><a id="v:CacheSaysNo" class="def">CacheSaysNo</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>the cache explicitely denied this certificate</p></td></tr><tr><td class="src"><a id="v:InvalidSignature" class="def">InvalidSignature</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></td><td class="doc"><p>signature failed</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:FailedReason">Instances</h4><details id="i:FailedReason" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FailedReason:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a></span> <a href="src/Data.X509.Validation.html#line-75" class="link">Source</a> <a href="#t:FailedReason" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FailedReason:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FailedReason:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a></span> <a href="src/Data.X509.Validation.html#line-75" class="link">Source</a> <a href="#t:FailedReason" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FailedReason:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SignatureFailure" class="def">SignatureFailure</a> <a href="src/Data.X509.Validation.Signature.html#SignatureFailure" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></p><div class="doc"><p>Various failure possible during signature checking</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SignatureInvalid" class="def">SignatureInvalid</a></td><td class="doc"><p>signature doesn't verify</p></td></tr><tr><td class="src"><a id="v:SignaturePubkeyMismatch" class="def">SignaturePubkeyMismatch</a></td><td class="doc"><p>algorithm and public key mismatch, cannot proceed</p></td></tr><tr><td class="src"><a id="v:SignatureUnimplemented" class="def">SignatureUnimplemented</a></td><td class="doc"><p>unimplemented signature algorithm</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SignatureFailure">Instances</h4><details id="i:SignatureFailure" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureFailure:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></span> <a href="src/Data.X509.Validation.Signature.html#line-52" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureFailure:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureFailure:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></span> <a href="src/Data.X509.Validation.Signature.html#line-52" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureFailure:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Validation configuration types</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ValidationChecks" class="def">ValidationChecks</a> <a href="src/Data.X509.Validation.html#ValidationChecks" class="link">Source</a> <a href="#t:ValidationChecks" class="selflink">#</a></p><div class="doc"><p>A set of checks to activate or parametrize to perform on certificates.</p><p>It's recommended to use <code><a href="Data-X509-Validation.html#v:defaultChecks" title="Data.X509.Validation">defaultChecks</a></code> to create the structure,
 to better cope with future changes or expansion of the structure.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ValidationChecks" class="def">ValidationChecks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:checkTimeValidity" class="def">checkTimeValidity</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>check time validity of every certificate in the chain.
 the make sure that current time is between each validity bounds
 in the certificate</p></div></li><li><dfn class="src"><a id="v:checkAtTime" class="def">checkAtTime</a> :: <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a></dfn><div class="doc"><p>The time when the validity check happens. When set to Nothing,
 the current time will be used</p></div></li><li><dfn class="src"><a id="v:checkStrictOrdering" class="def">checkStrictOrdering</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>Check that no certificate is included that shouldn't be included.
 unfortunately despite the specification violation, a lots of
 real world server serves useless and usually old certificates
 that are not relevant to the certificate sent, in their chain.</p></div></li><li><dfn class="src"><a id="v:checkCAConstraints" class="def">checkCAConstraints</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>Check that signing certificate got the CA basic constraint.
 this is absolutely not recommended to turn it off.</p></div></li><li><dfn class="src"><a id="v:checkExhaustive" class="def">checkExhaustive</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>Check the whole certificate chain without stopping at the first failure.
 Allow gathering a exhaustive list of failure reasons. if this is
 turn off, it's absolutely not safe to ignore a failed reason even it doesn't look serious
 (e.g. Expired) as other more serious checks would not have been performed.</p></div></li><li><dfn class="src"><a id="v:checkLeafV3" class="def">checkLeafV3</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>Check that the leaf certificate is version 3. If disable, version 2 certificate
 is authorized in leaf position and key usage cannot be checked.</p></div></li><li><dfn class="src"><a id="v:checkLeafKeyUsage" class="def">checkLeafKeyUsage</a> :: [<a href="../x509-1.7.7/Data-X509.html#t:ExtKeyUsageFlag" title="Data.X509">ExtKeyUsageFlag</a>]</dfn><div class="doc"><p>Check that the leaf certificate is authorized to be used for certain usage.
 If set to empty list no check are performed, otherwise all the flags is the list
 need to exists in the key usage extension. If the extension is not present,
 the check will pass and behave as if the certificate key is not restricted to
 any specific usage.</p></div></li><li><dfn class="src"><a id="v:checkLeafKeyPurpose" class="def">checkLeafKeyPurpose</a> :: [<a href="../x509-1.7.7/Data-X509.html#t:ExtKeyUsagePurpose" title="Data.X509">ExtKeyUsagePurpose</a>]</dfn><div class="doc"><p>Check that the leaf certificate is authorized to be used for certain purpose.
 If set to empty list no check are performed, otherwise all the flags is the list
 need to exists in the extended key usage extension if present. If the extension is not
 present, then the check will pass and behave as if the certificate is not restricted
 to any specific purpose.</p></div></li><li><dfn class="src"><a id="v:checkFQHN" class="def">checkFQHN</a> :: <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>Check the top certificate names matching the fully qualified hostname (FQHN).
 it's not recommended to turn this check off, if no other name checks are performed.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ValidationChecks">Instances</h4><details id="i:ValidationChecks" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationChecks:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></span> <a href="src/Data.X509.Validation.html#line-121" class="link">Source</a> <a href="#t:ValidationChecks" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationChecks:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationChecks:Default:2"></span> <a href="../data-default-class-0.1.2.0/Data-Default-Class.html#t:Default" title="Data.Default.Class">Default</a> <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></span> <a href="src/Data.X509.Validation.html#line-161" class="link">Source</a> <a href="#t:ValidationChecks" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationChecks:Default:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:def">def</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> <a href="#v:def" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationChecks:Eq:3"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></span> <a href="src/Data.X509.Validation.html#line-121" class="link">Source</a> <a href="#t:ValidationChecks" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationChecks:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ValidationHooks" class="def">ValidationHooks</a> <a href="src/Data.X509.Validation.html#ValidationHooks" class="link">Source</a> <a href="#t:ValidationHooks" class="selflink">#</a></p><div class="doc"><p>A set of hooks to manipulate the way the verification works.</p><p>BEWARE, it's easy to change behavior leading to compromised security.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ValidationHooks" class="def">ValidationHooks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:hookMatchSubjectIssuer" class="def">hookMatchSubjectIssuer</a> :: <a href="../x509-1.7.7/Data-X509.html#t:DistinguishedName" title="Data.X509">DistinguishedName</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></dfn><div class="doc"><p>check whether a given issuer <code><a href="../x509-1.7.7/Data-X509.html#t:DistinguishedName" title="Data.X509">DistinguishedName</a></code> matches the subject
 <code><a href="../x509-1.7.7/Data-X509.html#t:DistinguishedName" title="Data.X509">DistinguishedName</a></code> of a candidate issuer certificate.</p></div></li><li><dfn class="src"><a id="v:hookValidateTime" class="def">hookValidateTime</a> :: <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</dfn><div class="doc"><p>check whether the certificate in the second argument is valid at the
 time provided in the first argument.  Return an empty list for success
 or else one or more failure reasons.</p></div></li><li><dfn class="src"><a id="v:hookValidateName" class="def">hookValidateName</a> :: <a href="Data-X509-Validation.html#t:HostName" title="Data.X509.Validation">HostName</a> -&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a> -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</dfn><div class="doc"><p>validate the certificate leaf name with the DNS named used to connect</p></div></li><li><dfn class="src"><a id="v:hookFilterReason" class="def">hookFilterReason</a> :: [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>] -&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</dfn><div class="doc"><p>user filter to modify the list of failure reasons</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ValidationHooks">Instances</h4><details id="i:ValidationHooks" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationHooks:Default:1"></span> <a href="../data-default-class-0.1.2.0/Data-Default-Class.html#t:Default" title="Data.Default.Class">Default</a> <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a></span> <a href="src/Data.X509.Validation.html#line-173" class="link">Source</a> <a href="#t:ValidationHooks" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationHooks:Default:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation.html">Data.X509.Validation</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:def">def</a> :: <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a> <a href="#v:def" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:defaultChecks" class="def">defaultChecks</a> :: <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a> <a href="src/Data.X509.Validation.html#defaultChecks" class="link">Source</a> <a href="#v:defaultChecks" class="selflink">#</a></p><div class="doc"><p>Default checks to perform</p><p>The default checks are:
 * Each certificate time is valid
 * CA constraints is enforced for signing certificate
 * Leaf certificate is X.509 v3
 * Check that the FQHN match</p></div></div><div class="top"><p class="src"><a id="v:defaultHooks" class="def">defaultHooks</a> :: <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a> <a href="src/Data.X509.Validation.html#defaultHooks" class="link">Source</a> <a href="#v:defaultHooks" class="selflink">#</a></p><div class="doc"><p>Default hooks in the validation process</p></div></div><a href="#g:3" id="g:3"><h1>Validation</h1></a><div class="top"><p class="src"><a id="v:validate" class="def">validate</a> <a href="src/Data.X509.Validation.html#validate" class="link">Source</a> <a href="#v:validate" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../x509-1.7.7/Data-X509.html#t:HashALG" title="Data.X509">HashALG</a></td><td class="doc"><p>the hash algorithm we want to use for hashing the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a></td><td class="doc"><p>Hooks to use</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></td><td class="doc"><p>Checks to do</p></td></tr><tr><td class="src">-&gt; <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a></td><td class="doc"><p>The trusted certificate store for CA</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></td><td class="doc"><p>the validation cache callbacks</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a></td><td class="doc"><p>identification of the connection</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a></td><td class="doc"><p>the certificate chain we want to validate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</td><td class="doc"><p>the return failed reasons (empty list is no failure)</p></td></tr></table></div><div class="doc"><p>X509 validation</p><p>the function first interrogate the cache and if the validation fail,
 proper verification is done. If the verification pass, the
 add to cache callback is called.</p></div></div><div class="top"><p class="src"><a id="v:validatePure" class="def">validatePure</a> <a href="src/Data.X509.Validation.html#validatePure" class="link">Source</a> <a href="#v:validatePure" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../hourglass-0.2.12/Time-Types.html#t:DateTime" title="Time.Types">DateTime</a></td><td class="doc"><p>The time for which to check validity for</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationHooks" title="Data.X509.Validation">ValidationHooks</a></td><td class="doc"><p>Hooks to use</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationChecks" title="Data.X509.Validation">ValidationChecks</a></td><td class="doc"><p>Checks to do</p></td></tr><tr><td class="src">-&gt; <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a></td><td class="doc"><p>The trusted certificate store for CA</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a></td><td class="doc"><p>Identification of the connection</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a></td><td class="doc"><p>The certificate chain we want to validate</p></td></tr><tr><td class="src">-&gt; [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</td><td class="doc"><p>the return failed reasons (empty list is no failure)</p></td></tr></table></div><div class="doc"><p>Validate a certificate chain with explicit pure parameters</p></div></div><div class="top"><p class="src"><a id="v:validateDefault" class="def">validateDefault</a> <a href="src/Data.X509.Validation.html#validateDefault" class="link">Source</a> <a href="#v:validateDefault" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../x509-store-1.6.9/Data-X509-CertificateStore.html#t:CertificateStore" title="Data.X509.CertificateStore">CertificateStore</a></td><td class="doc"><p>The trusted certificate store for CA</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></td><td class="doc"><p>the validation cache callbacks</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a></td><td class="doc"><p>identification of the connection</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:CertificateChain" title="Data.X509">CertificateChain</a></td><td class="doc"><p>the certificate chain we want to validate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> [<a href="Data-X509-Validation.html#t:FailedReason" title="Data.X509.Validation">FailedReason</a>]</td><td class="doc"><p>the return failed reasons (empty list is no failure)</p></td></tr></table></div><div class="doc"><p>Validate using the default hooks and checks and the SHA256 mechanism as hashing mechanism</p></div></div><div class="top"><p class="src"><a id="v:getFingerprint" class="def">getFingerprint</a> <a href="src/Data.X509.Validation.Fingerprint.html#getFingerprint" class="link">Source</a> <a href="#v:getFingerprint" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../x509-1.7.7/Data-X509.html#t:SignedExact" title="Data.X509">SignedExact</a> a</td><td class="doc"><p>object to fingerprint</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:HashALG" title="Data.X509">HashALG</a></td><td class="doc"><p>algorithm to compute the fingerprint</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></td><td class="doc"><p>fingerprint in binary form</p></td></tr></table></div><div class="doc"><p>Get the fingerprint of the whole signed object
 using the hashing algorithm specified</p></div></div><a href="#g:4" id="g:4"><h1>Cache</h1></a><a href="#g:5" id="g:5"><h1>Cache for validation</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ValidationCacheResult" class="def">ValidationCacheResult</a> <a href="src/Data.X509.Validation.Cache.html#ValidationCacheResult" class="link">Source</a> <a href="#t:ValidationCacheResult" class="selflink">#</a></p><div class="doc"><p>The result of a cache query</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ValidationCachePass" class="def">ValidationCachePass</a></td><td class="doc"><p>cache allow this fingerprint to go through</p></td></tr><tr><td class="src"><a id="v:ValidationCacheDenied" class="def">ValidationCacheDenied</a> <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>cache denied this fingerprint for further validation</p></td></tr><tr><td class="src"><a id="v:ValidationCacheUnknown" class="def">ValidationCacheUnknown</a></td><td class="doc"><p>unknown fingerprint in cache</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ValidationCacheResult">Instances</h4><details id="i:ValidationCacheResult" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationCacheResult:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a></span> <a href="src/Data.X509.Validation.Cache.html#line-35" class="link">Source</a> <a href="#t:ValidationCacheResult" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationCacheResult:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Cache.html">Data.X509.Validation.Cache</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationCacheResult:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a></span> <a href="src/Data.X509.Validation.Cache.html#line-35" class="link">Source</a> <a href="#t:ValidationCacheResult" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationCacheResult:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Cache.html">Data.X509.Validation.Cache</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ValidationCacheQueryCallback" class="def">ValidationCacheQueryCallback</a> <a href="src/Data.X509.Validation.Cache.html#ValidationCacheQueryCallback" class="link">Source</a> <a href="#t:ValidationCacheQueryCallback" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&nbsp;= <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a></td><td class="doc"><p>connection's identification</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></td><td class="doc"><p>fingerprint of the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a></td><td class="doc"><p>leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCacheResult" title="Data.X509.Validation">ValidationCacheResult</a></td><td class="doc"><p>return if the operation is succesful or not</p></td></tr></table></div><div class="doc"><p>Validation cache query callback type</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ValidationCacheAddCallback" class="def">ValidationCacheAddCallback</a> <a href="src/Data.X509.Validation.Cache.html#ValidationCacheAddCallback" class="link">Source</a> <a href="#t:ValidationCacheAddCallback" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">&nbsp;= <a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a></td><td class="doc"><p>connection's identification</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a></td><td class="doc"><p>fingerprint of the leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:Certificate" title="Data.X509">Certificate</a></td><td class="doc"><p>leaf certificate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Validation cache callback type</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ValidationCache" class="def">ValidationCache</a> <a href="src/Data.X509.Validation.Cache.html#ValidationCache" class="link">Source</a> <a href="#t:ValidationCache" class="selflink">#</a></p><div class="doc"><p>All the callbacks needed for querying and adding to the cache.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ValidationCache" class="def">ValidationCache</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:cacheQuery" class="def">cacheQuery</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheQueryCallback" title="Data.X509.Validation">ValidationCacheQueryCallback</a></dfn><div class="doc"><p>cache querying callback</p></div></li><li><dfn class="src"><a id="v:cacheAdd" class="def">cacheAdd</a> :: <a href="Data-X509-Validation.html#t:ValidationCacheAddCallback" title="Data.X509.Validation">ValidationCacheAddCallback</a></dfn><div class="doc"><p>cache adding callback</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ValidationCache">Instances</h4><details id="i:ValidationCache" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ValidationCache:Default:1"></span> <a href="../data-default-class-0.1.2.0/Data-Default-Class.html#t:Default" title="Data.Default.Class">Default</a> <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></span> <a href="src/Data.X509.Validation.Cache.html#line-55" class="link">Source</a> <a href="#t:ValidationCache" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ValidationCache:Default:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Cache.html">Data.X509.Validation.Cache</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:def">def</a> :: <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a> <a href="#v:def" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:6" id="g:6"><h1>Simple instances of cache mechanism</h1></a><div class="top"><p class="src"><a id="v:exceptionValidationCache" class="def">exceptionValidationCache</a> :: [(<a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a>)] -&gt; <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a> <a href="src/Data.X509.Validation.Cache.html#exceptionValidationCache" class="link">Source</a> <a href="#v:exceptionValidationCache" class="selflink">#</a></p><div class="doc"><p>create a simple constant cache that list exceptions to the certification
 validation. Typically this is use to allow self-signed certificates for
 specific use, with out-of-bounds user checks.</p><p>No fingerprints will be added after the instance is created.</p><p>The underlying structure for the check is kept as a list, as
 usually the exception list will be short, but when the list go above
 a dozen exceptions it's recommended to use another cache mechanism with
 a faster lookup mechanism (hashtable, map, etc).</p><p>Note that only one fingerprint is allowed per ServiceID, for other use,
 another cache mechanism need to be use.</p></div></div><div class="top"><p class="src"><a id="v:tofuValidationCache" class="def">tofuValidationCache</a> <a href="src/Data.X509.Validation.Cache.html#tofuValidationCache" class="link">Source</a> <a href="#v:tofuValidationCache" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="Data-X509-Validation.html#t:ServiceID" title="Data.X509.Validation">ServiceID</a>, <a href="Data-X509-Validation.html#t:Fingerprint" title="Data.X509.Validation">Fingerprint</a>)]</td><td class="doc"><p>a list of exceptions</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Data-X509-Validation.html#t:ValidationCache" title="Data.X509.Validation">ValidationCache</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Trust on first use (TOFU) cache with an optional list of exceptions</p><p>this is similar to the exceptionCache, except that after
 each succesfull validation it does add the fingerprint
 to the database. This prevent any further modification of the
 fingerprint for the remaining</p></div></div><a href="#g:7" id="g:7"><h1>Signature verification</h1></a><div class="top"><p class="src"><a id="v:verifySignedSignature" class="def">verifySignedSignature</a> :: (<a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> a, <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> a, <a href="../asn1-encoding-0.9.6/Data-ASN1-Object.html#t:ASN1Object" title="Data.ASN1.Object">ASN1Object</a> a) =&gt; <a href="../x509-1.7.7/Data-X509.html#t:SignedExact" title="Data.X509">SignedExact</a> a -&gt; <a href="../x509-1.7.7/Data-X509.html#t:PubKey" title="Data.X509">PubKey</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> <a href="src/Data.X509.Validation.Signature.html#verifySignedSignature" class="link">Source</a> <a href="#v:verifySignedSignature" class="selflink">#</a></p><div class="doc"><p>Verify a Signed object against a specified public key</p></div></div><div class="top"><p class="src"><a id="v:verifySignature" class="def">verifySignature</a> <a href="src/Data.X509.Validation.Signature.html#verifySignature" class="link">Source</a> <a href="#v:verifySignature" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../x509-1.7.7/Data-X509.html#t:SignatureALG" title="Data.X509">SignatureALG</a></td><td class="doc"><p>Signature algorithm used</p></td></tr><tr><td class="src">-&gt; <a href="../x509-1.7.7/Data-X509.html#t:PubKey" title="Data.X509">PubKey</a></td><td class="doc"><p>Public key to use for verify</p></td></tr><tr><td class="src">-&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Certificate data that need to be verified</p></td></tr><tr><td class="src">-&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Signature to verify</p></td></tr><tr><td class="src">-&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>verify signature using parameter</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SignatureVerification" class="def">SignatureVerification</a> <a href="src/Data.X509.Validation.Signature.html#SignatureVerification" class="link">Source</a> <a href="#t:SignatureVerification" class="selflink">#</a></p><div class="doc"><p>A set of possible return from signature verification.</p><p>When SignatureFailed is return, the signature shouldn't be
 accepted.</p><p>Other values are only useful to differentiate the failure
 reason, but are all equivalent to failure.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SignaturePass" class="def">SignaturePass</a></td><td class="doc"><p>verification succeeded</p></td></tr><tr><td class="src"><a id="v:SignatureFailed" class="def">SignatureFailed</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></td><td class="doc"><p>verification failed</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SignatureVerification">Instances</h4><details id="i:SignatureVerification" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureVerification:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a></span> <a href="src/Data.X509.Validation.Signature.html#line-45" class="link">Source</a> <a href="#t:SignatureVerification" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureVerification:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureVerification:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a></span> <a href="src/Data.X509.Validation.Signature.html#line-45" class="link">Source</a> <a href="#t:SignatureVerification" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureVerification:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureVerification" title="Data.X509.Validation">SignatureVerification</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SignatureFailure" class="def">SignatureFailure</a> <a href="src/Data.X509.Validation.Signature.html#SignatureFailure" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></p><div class="doc"><p>Various failure possible during signature checking</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SignatureInvalid" class="def">SignatureInvalid</a></td><td class="doc"><p>signature doesn't verify</p></td></tr><tr><td class="src"><a id="v:SignaturePubkeyMismatch" class="def">SignaturePubkeyMismatch</a></td><td class="doc"><p>algorithm and public key mismatch, cannot proceed</p></td></tr><tr><td class="src"><a id="v:SignatureUnimplemented" class="def">SignatureUnimplemented</a></td><td class="doc"><p>unimplemented signature algorithm</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SignatureFailure">Instances</h4><details id="i:SignatureFailure" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureFailure:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></span> <a href="src/Data.X509.Validation.Signature.html#line-52" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureFailure:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SignatureFailure:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a></span> <a href="src/Data.X509.Validation.Signature.html#line-52" class="link">Source</a> <a href="#t:SignatureFailure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SignatureFailure:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-X509-Validation-Signature.html">Data.X509.Validation.Signature</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="Data-X509-Validation.html#t:SignatureFailure" title="Data.X509.Validation">SignatureFailure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>