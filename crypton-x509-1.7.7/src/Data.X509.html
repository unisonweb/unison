<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Data.X509</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Read/Write X509 Certificate, CRL and their signed equivalents.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Follows RFC5280 / RFC6818</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.X509</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-15"></span><span>      </span><span class="annot"><a href="Data.X509.html#SignedCertificate"><span class="hs-identifier">SignedCertificate</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#SignedCRL"><span class="hs-identifier">SignedCRL</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Cert.html#Certificate"><span class="hs-identifier">Certificate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PublicKey.html#PubKey"><span class="hs-identifier">PubKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PublicKey.html#PubKeyEC"><span class="hs-identifier">PubKeyEC</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PublicKey.html#SerializedPoint"><span class="hs-identifier">SerializedPoint</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PrivateKey.html#PrivKey"><span class="hs-identifier">PrivKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PrivateKey.html#PrivKeyEC"><span class="hs-identifier">PrivKeyEC</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PublicKey.html#pubkeyToAlg"><span class="hs-identifier">pubkeyToAlg</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.PrivateKey.html#privkeyToAlg"><span class="hs-identifier">privkeyToAlg</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.X509.AlgorithmIdentifier.html"><span class="hs-identifier">Data.X509.AlgorithmIdentifier</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.X509.Ext.html"><span class="hs-identifier">Data.X509.Ext</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html"><span class="hs-identifier">Data.X509.ExtensionRaw</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Certificate Revocation List (CRL)</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.X509.CRL.html"><span class="hs-identifier">Data.X509.CRL</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Naming</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier">DistinguishedName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#DnElement"><span class="hs-identifier">DnElement</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ASN1CharacterString</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#getDnElement"><span class="hs-identifier">getDnElement</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Certificate Chain</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.X509.CertificateChain.html"><span class="hs-identifier">Data.X509.CertificateChain</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Signed types and marshalling</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#Signed"><span class="hs-identifier">Signed</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#SignedExact"><span class="hs-identifier">SignedExact</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#getSigned"><span class="hs-identifier">getSigned</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#getSignedData"><span class="hs-identifier">getSignedData</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#objectToSignedExact"><span class="hs-identifier">objectToSignedExact</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#objectToSignedExactF"><span class="hs-identifier">objectToSignedExactF</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#encodeSignedObject"><span class="hs-identifier">encodeSignedObject</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#decodeSignedObject"><span class="hs-identifier">decodeSignedObject</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parametrized Signed accessor</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#getCertificate"><span class="hs-identifier">getCertificate</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#getCRL"><span class="hs-identifier">getCRL</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#decodeSignedCertificate"><span class="hs-identifier">decodeSignedCertificate</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#decodeSignedCRL"><span class="hs-identifier">decodeSignedCRL</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Hash distinguished names related function</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#hashDN"><span class="hs-identifier">hashDN</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.X509.html#hashDN_old"><span class="hs-identifier">hashDN_old</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Types</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.Encoding</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ASN1.BinaryEncoding</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.Cert.html"><span class="hs-identifier">Data.X509.Cert</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.Ext.html"><span class="hs-identifier">Data.X509.Ext</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.ExtensionRaw.html"><span class="hs-identifier">Data.X509.ExtensionRaw</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.CRL.html"><span class="hs-identifier">Data.X509.CRL</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.CertificateChain.html"><span class="hs-identifier">Data.X509.CertificateChain</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html"><span class="hs-identifier">Data.X509.DistinguishedName</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.Signed.html"><span class="hs-identifier">Data.X509.Signed</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.PublicKey.html"><span class="hs-identifier">Data.X509.PublicKey</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.PrivateKey.html"><span class="hs-identifier">Data.X509.PrivateKey</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.X509.AlgorithmIdentifier.html"><span class="hs-identifier">Data.X509.AlgorithmIdentifier</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Hash</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | A Signed Certificate</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">type</span><span> </span><span id="SignedCertificate"><span class="annot"><a href="Data.X509.html#SignedCertificate"><span class="hs-identifier hs-var">SignedCertificate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#SignedExact"><span class="hs-identifier hs-type">SignedExact</span></a></span><span> </span><span class="annot"><a href="Data.X509.Cert.html#Certificate"><span class="hs-identifier hs-type">Certificate</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | A Signed CRL</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span id="SignedCRL"><span class="annot"><a href="Data.X509.html#SignedCRL"><span class="hs-identifier hs-var">SignedCRL</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.X509.Signed.html#SignedExact"><span class="hs-identifier hs-type">SignedExact</span></a></span><span> </span><span class="annot"><a href="Data.X509.CRL.html#CRL"><span class="hs-identifier hs-type">CRL</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">-- | Get the Certificate associated to a SignedCertificate</span></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Data.X509.html#getCertificate"><span class="hs-identifier hs-type">getCertificate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.html#SignedCertificate"><span class="hs-identifier hs-type">SignedCertificate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X509.Cert.html#Certificate"><span class="hs-identifier hs-type">Certificate</span></a></span><span>
</span><span id="line-91"></span><span id="getCertificate"><span class="annot"><span class="annottext">getCertificate :: SignedCertificate -&gt; Certificate
</span><a href="Data.X509.html#getCertificate"><span class="hs-identifier hs-var hs-var">getCertificate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signed Certificate -&gt; Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; Signed a -&gt; a
</span><a href="Data.X509.Signed.html#signedObject"><span class="hs-identifier hs-var">signedObject</span></a></span><span> </span><span class="annot"><span class="annottext">(Signed Certificate -&gt; Certificate)
-&gt; (SignedCertificate -&gt; Signed Certificate)
-&gt; SignedCertificate
-&gt; Certificate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SignedCertificate -&gt; Signed Certificate
forall a. (Show a, Eq a, ASN1Object a) =&gt; SignedExact a -&gt; Signed a
</span><a href="Data.X509.Signed.html#getSigned"><span class="hs-identifier hs-var">getSigned</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><span class="hs-comment">-- | Get the CRL associated to a SignedCRL</span></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Data.X509.html#getCRL"><span class="hs-identifier hs-type">getCRL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.html#SignedCRL"><span class="hs-identifier hs-type">SignedCRL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.X509.CRL.html#CRL"><span class="hs-identifier hs-type">CRL</span></a></span><span>
</span><span id="line-95"></span><span id="getCRL"><span class="annot"><span class="annottext">getCRL :: SignedCRL -&gt; CRL
</span><a href="Data.X509.html#getCRL"><span class="hs-identifier hs-var hs-var">getCRL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Signed CRL -&gt; CRL
forall a. (Show a, Eq a, ASN1Object a) =&gt; Signed a -&gt; a
</span><a href="Data.X509.Signed.html#signedObject"><span class="hs-identifier hs-var">signedObject</span></a></span><span> </span><span class="annot"><span class="annottext">(Signed CRL -&gt; CRL)
-&gt; (SignedCRL -&gt; Signed CRL) -&gt; SignedCRL -&gt; CRL
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SignedCRL -&gt; Signed CRL
forall a. (Show a, Eq a, ASN1Object a) =&gt; SignedExact a -&gt; Signed a
</span><a href="Data.X509.Signed.html#getSigned"><span class="hs-identifier hs-var">getSigned</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><span class="hs-comment">-- | Try to decode a bytestring to a SignedCertificate</span></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Data.X509.html#decodeSignedCertificate"><span class="hs-identifier hs-type">decodeSignedCertificate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.X509.html#SignedCertificate"><span class="hs-identifier hs-type">SignedCertificate</span></a></span><span>
</span><span id="line-99"></span><span id="decodeSignedCertificate"><span class="annot"><span class="annottext">decodeSignedCertificate :: ByteString -&gt; Either String SignedCertificate
</span><a href="Data.X509.html#decodeSignedCertificate"><span class="hs-identifier hs-var hs-var">decodeSignedCertificate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String SignedCertificate
forall a.
(Show a, Eq a, ASN1Object a) =&gt;
ByteString -&gt; Either String (SignedExact a)
</span><a href="Data.X509.Signed.html#decodeSignedObject"><span class="hs-identifier hs-var">decodeSignedObject</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><span class="hs-comment">-- | Try to decode a bytestring to a SignedCRL</span></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Data.X509.html#decodeSignedCRL"><span class="hs-identifier hs-type">decodeSignedCRL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.X509.html#SignedCRL"><span class="hs-identifier hs-type">SignedCRL</span></a></span><span>
</span><span id="line-103"></span><span id="decodeSignedCRL"><span class="annot"><span class="annottext">decodeSignedCRL :: ByteString -&gt; Either String SignedCRL
</span><a href="Data.X509.html#decodeSignedCRL"><span class="hs-identifier hs-var hs-var">decodeSignedCRL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String SignedCRL
forall a.
(Show a, Eq a, ASN1Object a) =&gt;
ByteString -&gt; Either String (SignedExact a)
</span><a href="Data.X509.Signed.html#decodeSignedObject"><span class="hs-identifier hs-var">decodeSignedObject</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Make an OpenSSL style hash of distinguished name</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- OpenSSL algorithm is odd, and has been replicated here somewhat.</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- only lower the case of ascii character.</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Data.X509.html#hashDN"><span class="hs-identifier hs-type">hashDN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier hs-type">DistinguishedName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-110"></span><span id="hashDN"><span class="annot"><span class="annottext">hashDN :: DistinguishedName -&gt; ByteString
</span><a href="Data.X509.html#hashDN"><span class="hs-identifier hs-var hs-var">hashDN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest SHA1 -&gt; ByteString
forall a. Digest a -&gt; ByteString
</span><a href="Data.X509.html#shorten"><span class="hs-identifier hs-var">shorten</span></a></span><span> </span><span class="annot"><span class="annottext">(Digest SHA1 -&gt; ByteString)
-&gt; (DistinguishedName -&gt; Digest SHA1)
-&gt; DistinguishedName
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SHA1 -&gt; ByteString -&gt; Digest SHA1
forall ba alg.
(ByteArrayAccess ba, HashAlgorithm alg) =&gt;
alg -&gt; ba -&gt; Digest alg
</span><span class="hs-identifier hs-var">hashWith</span></span><span> </span><span class="annot"><span class="annottext">SHA1
</span><span class="hs-identifier hs-var">SHA1</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Digest SHA1)
-&gt; (DistinguishedName -&gt; ByteString)
-&gt; DistinguishedName
-&gt; Digest SHA1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DER -&gt; [ASN1] -&gt; ByteString
forall a. ASN1Encoding a =&gt; a -&gt; [ASN1] -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">DER
</span><span class="hs-identifier hs-var">DER</span></span><span> </span><span class="annot"><span class="annottext">([ASN1] -&gt; ByteString)
-&gt; (DistinguishedName -&gt; [ASN1]) -&gt; DistinguishedName -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DistinguishedNameInner -&gt; [ASN1] -&gt; [ASN1])
-&gt; [ASN1] -&gt; DistinguishedNameInner -&gt; [ASN1]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedNameInner -&gt; [ASN1] -&gt; [ASN1]
forall a. ASN1Object a =&gt; a -&gt; [ASN1] -&gt; [ASN1]
</span><span class="hs-identifier hs-var">toASN1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(DistinguishedNameInner -&gt; [ASN1])
-&gt; (DistinguishedName -&gt; DistinguishedNameInner)
-&gt; DistinguishedName
-&gt; [ASN1]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; DistinguishedNameInner
</span><a href="Data.X509.DistinguishedName.html#DistinguishedNameInner"><span class="hs-identifier hs-var">DistinguishedNameInner</span></a></span><span> </span><span class="annot"><span class="annottext">(DistinguishedName -&gt; DistinguishedNameInner)
-&gt; (DistinguishedName -&gt; DistinguishedName)
-&gt; DistinguishedName
-&gt; DistinguishedNameInner
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; DistinguishedName
</span><a href="#local-6989586621679083261"><span class="hs-identifier hs-var">dnLowerUTF8</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679083261"><span class="annot"><span class="annottext">dnLowerUTF8 :: DistinguishedName -&gt; DistinguishedName
</span><a href="#local-6989586621679083261"><span class="hs-identifier hs-var hs-var">dnLowerUTF8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier hs-type">DistinguishedName</span></a></span><span> </span><span id="local-6989586621679083265"><span class="annot"><span class="annottext">[(OID, ASN1CharacterString)]
</span><a href="#local-6989586621679083265"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(OID, ASN1CharacterString)] -&gt; DistinguishedName
</span><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier hs-var">DistinguishedName</span></a></span><span> </span><span class="annot"><span class="annottext">([(OID, ASN1CharacterString)] -&gt; DistinguishedName)
-&gt; [(OID, ASN1CharacterString)] -&gt; DistinguishedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((OID, ASN1CharacterString) -&gt; (OID, ASN1CharacterString))
-&gt; [(OID, ASN1CharacterString)] -&gt; [(OID, ASN1CharacterString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ASN1CharacterString -&gt; ASN1CharacterString)
-&gt; (OID, ASN1CharacterString) -&gt; (OID, ASN1CharacterString)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">ASN1CharacterString -&gt; ASN1CharacterString
</span><a href="#local-6989586621679083266"><span class="hs-identifier hs-var">toLowerUTF8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(OID, ASN1CharacterString)]
</span><a href="#local-6989586621679083265"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-112"></span><span>          </span><span id="local-6989586621679083266"><span class="annot"><span class="annottext">toLowerUTF8 :: ASN1CharacterString -&gt; ASN1CharacterString
</span><a href="#local-6989586621679083266"><span class="hs-identifier hs-var hs-var">toLowerUTF8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ASN1CharacterString</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679083268"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679083268"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding -&gt; ByteString -&gt; ASN1CharacterString
</span><span class="hs-identifier hs-var">ASN1CharacterString</span></span><span> </span><span class="annot"><span class="annottext">ASN1StringEncoding
</span><span class="hs-identifier hs-var">UTF8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.map</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="#local-6989586621679083271"><span class="hs-identifier hs-var">asciiToLower</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679083268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>          </span><span id="local-6989586621679083271"><span class="annot"><span class="annottext">asciiToLower :: Word8 -&gt; Word8
</span><a href="#local-6989586621679083271"><span class="hs-identifier hs-var hs-var">asciiToLower</span></a></span></span><span> </span><span id="local-6989586621679083297"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083297"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083297"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083298"><span class="hs-identifier hs-var">w8A</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083297"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083301"><span class="hs-identifier hs-var">w8Z</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083297"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679083297"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-116"></span><span>          </span><span id="local-6989586621679083298"><span class="annot"><span class="annottext">w8A :: Word8
</span><a href="#local-6989586621679083298"><span class="hs-identifier hs-var hs-var">w8A</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span>
</span><span id="line-117"></span><span>          </span><span id="local-6989586621679083301"><span class="annot"><span class="annottext">w8Z :: Word8
</span><a href="#local-6989586621679083301"><span class="hs-identifier hs-var hs-var">w8Z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; Int -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><span class="hs-comment">-- | Create an openssl style old hash of distinguished name</span></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Data.X509.html#hashDN_old"><span class="hs-identifier hs-type">hashDN_old</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.X509.DistinguishedName.html#DistinguishedName"><span class="hs-identifier hs-type">DistinguishedName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-121"></span><span id="hashDN_old"><span class="annot"><span class="annottext">hashDN_old :: DistinguishedName -&gt; ByteString
</span><a href="Data.X509.html#hashDN_old"><span class="hs-identifier hs-var hs-var">hashDN_old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest MD5 -&gt; ByteString
forall a. Digest a -&gt; ByteString
</span><a href="Data.X509.html#shorten"><span class="hs-identifier hs-var">shorten</span></a></span><span> </span><span class="annot"><span class="annottext">(Digest MD5 -&gt; ByteString)
-&gt; (DistinguishedName -&gt; Digest MD5)
-&gt; DistinguishedName
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MD5 -&gt; ByteString -&gt; Digest MD5
forall ba alg.
(ByteArrayAccess ba, HashAlgorithm alg) =&gt;
alg -&gt; ba -&gt; Digest alg
</span><span class="hs-identifier hs-var">hashWith</span></span><span> </span><span class="annot"><span class="annottext">MD5
</span><span class="hs-identifier hs-var">MD5</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Digest MD5)
-&gt; (DistinguishedName -&gt; ByteString)
-&gt; DistinguishedName
-&gt; Digest MD5
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DER -&gt; [ASN1] -&gt; ByteString
forall a. ASN1Encoding a =&gt; a -&gt; [ASN1] -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeASN1'</span></span><span> </span><span class="annot"><span class="annottext">DER
</span><span class="hs-identifier hs-var">DER</span></span><span> </span><span class="annot"><span class="annottext">([ASN1] -&gt; ByteString)
-&gt; (DistinguishedName -&gt; [ASN1]) -&gt; DistinguishedName -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DistinguishedName -&gt; [ASN1] -&gt; [ASN1])
-&gt; [ASN1] -&gt; DistinguishedName -&gt; [ASN1]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; [ASN1] -&gt; [ASN1]
forall a. ASN1Object a =&gt; a -&gt; [ASN1] -&gt; [ASN1]
</span><span class="hs-identifier hs-var">toASN1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679083160"><span class="annot"><a href="Data.X509.html#shorten"><span class="hs-identifier hs-type">shorten</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Digest</span></span><span> </span><span class="annot"><a href="#local-6989586621679083160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span></span><span>
</span><span id="line-124"></span><span id="shorten"><span class="annot"><span class="annottext">shorten :: forall a. Digest a -&gt; ByteString
</span><a href="Data.X509.html#shorten"><span class="hs-identifier hs-var hs-var">shorten</span></a></span></span><span> </span><span id="local-6989586621679083315"><span class="annot"><span class="annottext">Digest a
</span><a href="#local-6989586621679083315"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; [Int] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
</span><a href="#local-6989586621679083317"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679083317"><span class="annot"><span class="annottext">i :: Int -&gt; Word8
</span><a href="#local-6989586621679083317"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679083320"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679083320"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest a -&gt; Int -&gt; Word8
forall a. ByteArrayAccess a =&gt; a -&gt; Int -&gt; Word8
</span><span class="hs-identifier hs-var">BA.index</span></span><span> </span><span class="annot"><span class="annottext">Digest a
</span><a href="#local-6989586621679083315"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679083320"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-126"></span></pre></body></html>