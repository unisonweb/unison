<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Numeral.Render</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Rendering numerals</span></span><span>
</span><span id="line-5"></span><span>      </span><span class="annot"><a href="Text.Numeral.Render.html#render"><span class="hs-identifier">render</span></a></span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Representation of numerals</span></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier">Repr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#ScaleRepr"><span class="hs-identifier">ScaleRepr</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#defaultRepr"><span class="hs-identifier">defaultRepr</span></a></span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Context of expressions</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier">Ctx</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#posIndex"><span class="hs-identifier">posIndex</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#isOutside"><span class="hs-identifier">isOutside</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Imports</span><span>
</span><span id="line-19"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;this&quot;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html"><span class="hs-identifier">Text.Numeral.Exp</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier">Exp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier">Side</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier">L</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#R"><span class="hs-identifier">R</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;this&quot;</span><span> </span><span class="annot"><a href="Text.Numeral.Grammar.html"><span class="hs-identifier">Text.Numeral.Grammar</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Text.Numeral.Grammar.html#Inflection"><span class="hs-identifier">Inflection</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- Rendering numerals</span><span>
</span><span id="line-28"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Renders an expression to a 'Text' value according to a certain</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- representation and inflection.</span><span>
</span><span id="line-32"></span><span class="annot"><a href="Text.Numeral.Render.html#render"><span class="hs-identifier hs-type">render</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-type">Repr</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Representation.</span></span><span>
</span><span id="line-33"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Grammar.html#Inflection"><span class="hs-identifier hs-type">Inflection</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Initial inflection.</span></span><span>
</span><span id="line-34"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The expression to render.</span></span><span>
</span><span id="line-35"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-36"></span><span id="render"><span class="annot"><span class="annottext">render :: Repr -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="Text.Numeral.Render.html#render"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-type">Repr</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679099883"><span id="local-6989586621679099884"><span id="local-6989586621679099885"><span id="local-6989586621679099886"><span id="local-6989586621679099887"><span id="local-6989586621679099888"><span id="local-6989586621679099889"><span id="local-6989586621679099890"><span id="local-6989586621679099891"><span id="local-6989586621679099892"><span id="local-6989586621679099893"><span id="local-6989586621679099894"><span id="local-6989586621679099895"><span class="annot"><span class="annottext">Maybe Text
Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
Maybe (Exp -&gt; Ctx Exp -&gt; Text)
Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
ScaleRepr
reprUnknown :: Maybe Text
reprValue :: Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
reprNeg :: Maybe (Exp -&gt; Ctx Exp -&gt; Text)
reprAdd :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprMul :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprSub :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprFrac :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprScale :: ScaleRepr
reprNegCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
reprAddCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprMulCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprSubCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprFracCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprUnknown :: Repr -&gt; Maybe Text
reprValue :: Repr -&gt; Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
reprNeg :: Repr -&gt; Maybe (Exp -&gt; Ctx Exp -&gt; Text)
reprAdd :: Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprMul :: Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprSub :: Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprFrac :: Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
reprScale :: Repr -&gt; ScaleRepr
reprNegCombine :: Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
reprAddCombine :: Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprMulCombine :: Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprSubCombine :: Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
reprFracCombine :: Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099883"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
forall a. Ctx a
</span><a href="Text.Numeral.Render.html#CtxEmpty"><span class="hs-identifier hs-var">CtxEmpty</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>      </span><span id="local-6989586621679099909"><span class="annot"><span class="annottext">go :: Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Inflection
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Exp
</span><a href="Text.Numeral.Exp.html#Unknown"><span class="hs-identifier hs-var">Unknown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679099883"><span class="hs-identifier hs-var">reprUnknown</span></a></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099934"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099934"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099935"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099935"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621679099937"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099937"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ctx Exp -&gt; Text) -&gt; Ctx Exp -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099934"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ctx Exp -&gt; Text) -&gt; Text)
-&gt; Maybe (Ctx Exp -&gt; Text) -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099884"><span class="hs-identifier hs-var">reprValue</span></a></span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099935"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099937"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099939"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099939"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099940"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099940"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Neg"><span class="hs-identifier hs-type">Neg</span></a></span><span> </span><span id="local-6989586621679099942"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099942"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679099943"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099943"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ctx Exp -&gt; Ctx Exp
forall a. Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxNeg"><span class="hs-identifier hs-var">CtxNeg</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099939"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099940"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099942"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-41"></span><span>                              </span><span id="local-6989586621679099945"><span class="annot"><span class="annottext">Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099945"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099885"><span class="hs-identifier hs-var">reprNeg</span></a></span><span>
</span><span id="line-42"></span><span>                              </span><span id="local-6989586621679099946"><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099946"><span class="hs-identifier hs-var">rnc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099891"><span class="hs-identifier hs-var">reprNegCombine</span></a></span><span>
</span><span id="line-43"></span><span>                              </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099946"><span class="hs-identifier hs-var">rnc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099945"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099942"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099939"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099943"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099942"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-44"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099947"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099947"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099948"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099948"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621679099950"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099950"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679099951"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099951"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679099952"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099952"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxAdd"><span class="hs-identifier hs-var">CtxAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099951"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099947"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099948"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099950"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-45"></span><span>                                </span><span id="local-6989586621679099954"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099954"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxAdd"><span class="hs-identifier hs-var">CtxAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099950"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099947"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099948"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099951"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-46"></span><span>                                </span><span id="local-6989586621679099955"><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099955"><span class="hs-identifier hs-var">ra</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099886"><span class="hs-identifier hs-var">reprAdd</span></a></span><span>
</span><span id="line-47"></span><span>                                </span><span id="local-6989586621679099956"><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099956"><span class="hs-identifier hs-var">rac</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099892"><span class="hs-identifier hs-var">reprAddCombine</span></a></span><span>
</span><span id="line-48"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099956"><span class="hs-identifier hs-var">rac</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099955"><span class="hs-identifier hs-var">ra</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099950"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099951"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099947"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099952"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099950"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099954"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099951"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099957"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099957"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099958"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099958"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Mul"><span class="hs-identifier hs-type">Mul</span></a></span><span> </span><span id="local-6989586621679099960"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099960"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679099961"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099961"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679099962"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099962"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxMul"><span class="hs-identifier hs-var">CtxMul</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099961"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099957"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099958"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099960"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-50"></span><span>                                </span><span id="local-6989586621679099964"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099964"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxMul"><span class="hs-identifier hs-var">CtxMul</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099960"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099957"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099958"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099961"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-51"></span><span>                                </span><span id="local-6989586621679099965"><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099965"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099887"><span class="hs-identifier hs-var">reprMul</span></a></span><span>
</span><span id="line-52"></span><span>                                </span><span id="local-6989586621679099966"><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099966"><span class="hs-identifier hs-var">rmc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099893"><span class="hs-identifier hs-var">reprMulCombine</span></a></span><span>
</span><span id="line-53"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099966"><span class="hs-identifier hs-var">rmc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099965"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099960"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099961"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099957"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099962"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099960"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099964"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099961"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-54"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099967"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099967"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099968"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099968"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span id="local-6989586621679099970"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099970"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679099971"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099971"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679099972"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099972"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxSub"><span class="hs-identifier hs-var">CtxSub</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099971"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099967"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099968"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099970"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-55"></span><span>                                </span><span id="local-6989586621679099974"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099974"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxSub"><span class="hs-identifier hs-var">CtxSub</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099970"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099967"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099968"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099971"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-56"></span><span>                                </span><span id="local-6989586621679099975"><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099975"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099888"><span class="hs-identifier hs-var">reprSub</span></a></span><span>
</span><span id="line-57"></span><span>                                </span><span id="local-6989586621679099976"><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099976"><span class="hs-identifier hs-var">rsc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099894"><span class="hs-identifier hs-var">reprSubCombine</span></a></span><span>
</span><span id="line-58"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099976"><span class="hs-identifier hs-var">rsc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099975"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099970"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099971"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099967"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099972"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099970"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099974"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099971"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099977"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099977"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099978"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099978"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Frac"><span class="hs-identifier hs-type">Frac</span></a></span><span> </span><span id="local-6989586621679099980"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099980"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679099981"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099981"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679099982"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099982"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxFrac"><span class="hs-identifier hs-var">CtxFrac</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099981"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099977"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099978"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099980"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-60"></span><span>                                 </span><span id="local-6989586621679099984"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099984"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Side -&gt; Exp -&gt; Ctx Exp -&gt; Ctx Exp
forall a. Side -&gt; a -&gt; Ctx a -&gt; Ctx a
</span><a href="Text.Numeral.Render.html#CtxFrac"><span class="hs-identifier hs-var">CtxFrac</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099980"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099977"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099978"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099981"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-61"></span><span>                                 </span><span id="local-6989586621679099985"><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099985"><span class="hs-identifier hs-var">rf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="#local-6989586621679099889"><span class="hs-identifier hs-var">reprFrac</span></a></span><span>
</span><span id="line-62"></span><span>                                 </span><span id="local-6989586621679099986"><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099986"><span class="hs-identifier hs-var">rfc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="#local-6989586621679099895"><span class="hs-identifier hs-var">reprFracCombine</span></a></span><span>
</span><span id="line-63"></span><span>                                 </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text
</span><a href="#local-6989586621679099986"><span class="hs-identifier hs-var">rfc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text
</span><a href="#local-6989586621679099985"><span class="hs-identifier hs-var">rf</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099980"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099981"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099977"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099982"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099980"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679099984"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099981"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099987"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099987"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099988"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099988"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Scale"><span class="hs-identifier hs-type">Scale</span></a></span><span> </span><span id="local-6989586621679099990"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099990"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679099991"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099991"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679099992"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099992"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScaleRepr
</span><a href="#local-6989586621679099890"><span class="hs-identifier hs-var">reprScale</span></a></span><span> </span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099988"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099990"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679099991"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099992"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099987"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099993"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099993"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679099994"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099994"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#ChangeCase"><span class="hs-identifier hs-type">ChangeCase</span></a></span><span>   </span><span id="local-6989586621679099996"><span class="annot"><span class="annottext">Maybe Case
</span><a href="#local-6989586621679099996"><span class="hs-identifier hs-var">mbCase</span></a></span></span><span>   </span><span id="local-6989586621679099997"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099997"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099993"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679099994"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Text.Numeral.Grammar.html#iCase"><span class="hs-identifier hs-var">iCase</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679099996"><span class="hs-identifier hs-type">mbCase</span></a></span><span>  </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679099997"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-66"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679099999"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099999"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679100000"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679100000"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#ChangeGender"><span class="hs-identifier hs-type">ChangeGender</span></a></span><span> </span><span id="local-6989586621679100002"><span class="annot"><span class="annottext">Maybe Gender
</span><a href="#local-6989586621679100002"><span class="hs-identifier hs-var">mbGender</span></a></span></span><span> </span><span id="local-6989586621679100003"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679100003"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679099999"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679100000"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Text.Numeral.Grammar.html#iGender"><span class="hs-identifier hs-var">iGender</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679100002"><span class="hs-identifier hs-type">mbGender</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679100003"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100005"><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679100005"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679100006"><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679100006"><span class="hs-identifier hs-var">inf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#ChangeNumber"><span class="hs-identifier hs-type">ChangeNumber</span></a></span><span> </span><span id="local-6989586621679100008"><span class="annot"><span class="annottext">Maybe Number
</span><a href="#local-6989586621679100008"><span class="hs-identifier hs-var">mbNumber</span></a></span></span><span> </span><span id="local-6989586621679100009"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679100009"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx Exp -&gt; Inflection -&gt; Exp -&gt; Maybe Text
</span><a href="#local-6989586621679099909"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><a href="#local-6989586621679100005"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Inflection
</span><a href="#local-6989586621679100006"><span class="hs-identifier hs-var">inf</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Text.Numeral.Grammar.html#iNumber"><span class="hs-identifier hs-var">iNumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679100008"><span class="hs-identifier hs-type">mbNumber</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679100009"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- Representation of numerals</span><span>
</span><span id="line-72"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | A representation for numerals.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- A 'Repr' contains all the information on how to render an</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- 'Exp'ression to a 'Text' value.</span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="Repr"><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-var">Repr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>    </span><span id="Repr"><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-var">Repr</span></a></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-comment">-- | Representation for unknown values.</span></span><span>
</span><span id="line-81"></span><span>      </span><span id="reprUnknown"><span class="annot"><span class="annottext">Repr -&gt; Maybe Text
</span><a href="Text.Numeral.Render.html#reprUnknown"><span class="hs-identifier hs-var hs-var">reprUnknown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- | Renders a literal value. Not necessarily defined for every</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-comment">-- value.</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprValue"><span class="annot"><span class="annottext">Repr -&gt; Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprValue"><span class="hs-identifier hs-var hs-var">reprValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Grammar.html#Inflection"><span class="hs-identifier hs-type">Inflection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-comment">-- | Renders a negation. This concerns the negation itself, not</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- the thing being negated.</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprNeg"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprNeg"><span class="hs-identifier hs-var hs-var">reprNeg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-comment">-- | Renders an addition. This concerns the addition itself, not</span><span>
</span><span id="line-89"></span><span>      </span><span class="hs-comment">-- the things being added. For example: In \&quot;one hundred and</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- eighty\&quot; this function would be responsible for rendering the</span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-comment">-- \&quot;and\&quot;.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprAdd"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprAdd"><span class="hs-identifier hs-var hs-var">reprAdd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-comment">-- | Renders a multiplication. This concerns the multiplication</span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-comment">-- itself, not the things being multiplied.</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprMul"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprMul"><span class="hs-identifier hs-var hs-var">reprMul</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-comment">-- | Renders a subtraction. This concerns the subtraction</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-comment">-- itself, not the things being subtracted.</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprSub"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprSub"><span class="hs-identifier hs-var hs-var">reprSub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-comment">-- | Renders a fraction. This concerns the fraction itself, not</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-comment">-- the numerator or the denominator.</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprFrac"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprFrac"><span class="hs-identifier hs-var hs-var">reprFrac</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Renders a step in a scale of large values.</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprScale"><span class="annot"><span class="annottext">Repr -&gt; ScaleRepr
</span><a href="Text.Numeral.Render.html#reprScale"><span class="hs-identifier hs-var hs-var">reprScale</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#ScaleRepr"><span class="hs-identifier hs-type">ScaleRepr</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-comment">-- | Combines a negation and the thing being negated. For</span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-comment">-- example: this would combine \&quot;minus\&quot; and \&quot;three\&quot; into</span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-comment">-- \&quot;minus three\&quot;.</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprNegCombine"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprNegCombine"><span class="hs-identifier hs-var hs-var">reprNegCombine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Combines an addition and the things being added.</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprAddCombine"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprAddCombine"><span class="hs-identifier hs-var hs-var">reprAddCombine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Combines a multiplication and the things being multiplied.</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprMulCombine"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprMulCombine"><span class="hs-identifier hs-var hs-var">reprMulCombine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Combines a subtraction and the things being subtracted.</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprSubCombine"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprSubCombine"><span class="hs-identifier hs-var hs-var">reprSubCombine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Combines a fraction and the numerator and denominator.</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="reprFracCombine"><span class="annot"><span class="annottext">Repr -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprFracCombine"><span class="hs-identifier hs-var hs-var">reprFracCombine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Function that renders the representation of a step in a scale of</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- large values. The value represented by the step is 10 ^ (rank *</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- base + offset).</span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span id="ScaleRepr"><span class="annot"><a href="Text.Numeral.Render.html#ScaleRepr"><span class="hs-identifier hs-var">ScaleRepr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Numeral.Grammar.html#Inflection"><span class="hs-identifier hs-type">Inflection</span></a></span><span>
</span><span id="line-122"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Base.</span></span><span>
</span><span id="line-123"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Offset.</span></span><span>
</span><span id="line-124"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Rank.</span></span><span>
</span><span id="line-125"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Rank context.</span></span><span>
</span><span id="line-126"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | The default representation.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Only the combining functions are defined. The rest are either</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- 'Nothing' or always produce 'Nothing'.</span><span>
</span><span id="line-132"></span><span class="annot"><a href="Text.Numeral.Render.html#defaultRepr"><span class="hs-identifier hs-type">defaultRepr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-type">Repr</span></a></span><span>
</span><span id="line-133"></span><span id="defaultRepr"><span class="annot"><span class="annottext">defaultRepr :: Repr
</span><a href="Text.Numeral.Render.html#defaultRepr"><span class="hs-identifier hs-var hs-var">defaultRepr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="Text.Numeral.Render.html#Repr"><span class="hs-identifier hs-type">Repr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">reprUnknown :: Maybe Text
</span><a href="Text.Numeral.Render.html#reprUnknown"><span class="hs-identifier hs-var">reprUnknown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-135"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprValue :: Inflection -&gt; Integer -&gt; Maybe (Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprValue"><span class="hs-identifier hs-var">reprValue</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Inflection
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-136"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprNeg :: Maybe (Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprNeg"><span class="hs-identifier hs-var">reprNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-137"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprAdd :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprAdd"><span class="hs-identifier hs-var">reprAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprMul :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprMul"><span class="hs-identifier hs-var">reprMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-139"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprSub :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprSub"><span class="hs-identifier hs-var">reprSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-140"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprFrac :: Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprFrac"><span class="hs-identifier hs-var">reprFrac</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp -&gt; Exp -&gt; Ctx Exp -&gt; Text)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-141"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprScale :: ScaleRepr
</span><a href="Text.Numeral.Render.html#reprScale"><span class="hs-identifier hs-var">reprScale</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Inflection
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ctx Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprNegCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprNegCombine"><span class="hs-identifier hs-var">reprNegCombine</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Text -&gt; Exp -&gt; Text)
 -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text))
-&gt; (Text -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679100011"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100011"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679100012"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100012"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100011"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100012"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-143"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprAddCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprAddCombine"><span class="hs-identifier hs-var">reprAddCombine</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
 -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text))
-&gt; (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679100013"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100013"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679100014"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100014"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100015"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100015"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100014"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100013"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100015"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-144"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprMulCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprMulCombine"><span class="hs-identifier hs-var">reprMulCombine</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
 -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text))
-&gt; (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679100016"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100016"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679100017"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100017"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100018"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100018"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100017"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100016"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100018"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-145"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprSubCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprSubCombine"><span class="hs-identifier hs-var">reprSubCombine</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
 -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text))
-&gt; (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679100019"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100019"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679100020"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100021"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100021"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100020"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100019"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100021"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-146"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reprFracCombine :: Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
</span><a href="Text.Numeral.Render.html#reprFracCombine"><span class="hs-identifier hs-var">reprFracCombine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
 -&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text))
-&gt; (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
-&gt; Maybe (Text -&gt; Text -&gt; Exp -&gt; Text -&gt; Exp -&gt; Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679100022"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100022"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679100023"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100023"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100024"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100024"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100023"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100022"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679100024"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-147"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- Context of expressions</span><span>
</span><span id="line-152"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | A context in which an 'Exp'ression appears.</span></span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="Ctx"><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-var">Ctx</span></a></span></span><span> </span><span id="local-6989586621679099837"><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-156"></span><span>     </span><span class="annot"><span class="hs-comment">-- | The empty context. Used for top level expressions.</span></span><span>
</span><span id="line-157"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="CtxEmpty"><span class="annot"><a href="Text.Numeral.Render.html#CtxEmpty"><span class="hs-identifier hs-var">CtxEmpty</span></a></span></span><span>
</span><span id="line-158"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Negation context.</span></span><span>
</span><span id="line-159"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxNeg"><span class="annot"><a href="Text.Numeral.Render.html#CtxNeg"><span class="hs-identifier hs-var">CtxNeg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Addition context.</span></span><span>
</span><span id="line-161"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxAdd"><span class="annot"><a href="Text.Numeral.Render.html#CtxAdd"><span class="hs-identifier hs-var">CtxAdd</span></a></span></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Multiplication context.</span></span><span>
</span><span id="line-163"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxMul"><span class="annot"><a href="Text.Numeral.Render.html#CtxMul"><span class="hs-identifier hs-var">CtxMul</span></a></span></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Subtraction context.</span></span><span>
</span><span id="line-165"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxSub"><span class="annot"><a href="Text.Numeral.Render.html#CtxSub"><span class="hs-identifier hs-var">CtxSub</span></a></span></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Fraction context.</span></span><span>
</span><span id="line-167"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxFrac"><span class="annot"><a href="Text.Numeral.Render.html#CtxFrac"><span class="hs-identifier hs-var">CtxFrac</span></a></span></span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>     </span><span class="annot"><span class="hs-comment">-- | Scale context.</span></span><span>
</span><span id="line-169"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="CtxScale"><span class="annot"><a href="Text.Numeral.Render.html#CtxScale"><span class="hs-identifier hs-var">CtxScale</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099837"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100028"><span id="local-6989586621679100046"><span class="annot"><span class="annottext">Ctx a -&gt; Ctx a -&gt; Bool
(Ctx a -&gt; Ctx a -&gt; Bool) -&gt; (Ctx a -&gt; Ctx a -&gt; Bool) -&gt; Eq (Ctx a)
forall a. Eq a =&gt; Ctx a -&gt; Ctx a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Ctx a -&gt; Ctx a -&gt; Bool
== :: Ctx a -&gt; Ctx a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Ctx a -&gt; Ctx a -&gt; Bool
/= :: Ctx a -&gt; Ctx a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100051"><span id="local-6989586621679100076"><span id="local-6989586621679100079"><span class="annot"><span class="annottext">Int -&gt; Ctx a -&gt; ShowS
[Ctx a] -&gt; ShowS
Ctx a -&gt; String
(Int -&gt; Ctx a -&gt; ShowS)
-&gt; (Ctx a -&gt; String) -&gt; ([Ctx a] -&gt; ShowS) -&gt; Show (Ctx a)
forall a. Show a =&gt; Int -&gt; Ctx a -&gt; ShowS
forall a. Show a =&gt; [Ctx a] -&gt; ShowS
forall a. Show a =&gt; Ctx a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Ctx a -&gt; ShowS
showsPrec :: Int -&gt; Ctx a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Ctx a -&gt; String
show :: Ctx a -&gt; String
$cshowList :: forall a. Show a =&gt; [Ctx a] -&gt; ShowS
showList :: [Ctx a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621679099857"><span class="annot"><a href="Text.Numeral.Render.html#posIndex"><span class="hs-identifier hs-type">posIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099857"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-173"></span><span id="posIndex"><span class="annot"><span class="annottext">posIndex :: forall a. Ctx a -&gt; Integer
</span><a href="Text.Numeral.Render.html#posIndex"><span class="hs-identifier hs-var hs-var">posIndex</span></a></span></span><span> </span><span id="local-6989586621679100082"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100082"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100082"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>      </span><span id="local-6989586621679099859"><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679100083"><span class="annot"><span class="annottext">go :: forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679100105"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100105"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="Text.Numeral.Render.html#CtxEmpty"><span class="hs-identifier hs-var">CtxEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100105"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100106"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100106"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxNeg"><span class="hs-identifier hs-type">CtxNeg</span></a></span><span> </span><span id="local-6989586621679100107"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100107"><span class="hs-identifier hs-var">nc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100106"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100107"><span class="hs-identifier hs-var">nc</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100108"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100108"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxAdd"><span class="hs-identifier hs-type">CtxAdd</span></a></span><span>  </span><span id="local-6989586621679100109"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100109"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100110"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100110"><span class="hs-identifier hs-var">ac</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100108"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100109"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100110"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100112"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100112"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxMul"><span class="hs-identifier hs-type">CtxMul</span></a></span><span>  </span><span id="local-6989586621679100113"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100113"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100114"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100114"><span class="hs-identifier hs-var">mc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100112"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100113"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100114"><span class="hs-identifier hs-var">mc</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100115"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100115"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxSub"><span class="hs-identifier hs-type">CtxSub</span></a></span><span>  </span><span id="local-6989586621679100116"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100116"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100117"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100117"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100115"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100116"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100117"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100118"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100118"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxFrac"><span class="hs-identifier hs-type">CtxFrac</span></a></span><span> </span><span id="local-6989586621679100119"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100119"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100120"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100120"><span class="hs-identifier hs-var">fc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100118"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100119"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="Text.Numeral.Exp.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100120"><span class="hs-identifier hs-var">fc</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679100121"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100121"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxScale"><span class="hs-identifier hs-type">CtxScale</span></a></span><span>  </span><span id="local-6989586621679100122"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100122"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ctx a -&gt; Integer
forall a. Integer -&gt; Ctx a -&gt; Integer
</span><a href="#local-6989586621679100083"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679100121"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100122"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Checks whether a context is completely on the outside of an</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- expression, either left or right.</span><span>
</span><span id="line-186"></span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Given the following expression:</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- 'Add' ('Lit' 1000) ('Add' ('Mul' ('Lit' 2) ('Lit' 100)) ('Add' ('Lit' 4) ('Mul' ('Lit' 3) ('Lit' 10))))</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- On the left we have @'Lit' 1000@ and on the right @'Lit' 10@.</span><span>
</span><span id="line-194"></span><span id="local-6989586621679099862"><span class="annot"><a href="Text.Numeral.Render.html#isOutside"><span class="hs-identifier hs-type">isOutside</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Exp.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-195"></span><span id="isOutside"><span class="annot"><span class="annottext">isOutside :: forall a. Side -&gt; Ctx a -&gt; Bool
</span><a href="Text.Numeral.Render.html#isOutside"><span class="hs-identifier hs-var hs-var">isOutside</span></a></span></span><span> </span><span id="local-6989586621679100123"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100123"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679100124"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100124"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100124"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>      </span><span id="local-6989586621679099864"><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Numeral.Render.html#Ctx"><span class="hs-identifier hs-type">Ctx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-198"></span><span>      </span><span id="local-6989586621679100125"><span class="annot"><span class="annottext">go :: forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="Text.Numeral.Render.html#CtxEmpty"><span class="hs-identifier hs-var">CtxEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxNeg"><span class="hs-identifier hs-type">CtxNeg</span></a></span><span> </span><span id="local-6989586621679100130"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100130"><span class="hs-identifier hs-var">nc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100130"><span class="hs-identifier hs-var">nc</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxAdd"><span class="hs-identifier hs-type">CtxAdd</span></a></span><span>  </span><span id="local-6989586621679100131"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100131"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100132"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100132"><span class="hs-identifier hs-var">ac</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100131"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100123"><span class="hs-identifier hs-var">s</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100132"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-201"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxMul"><span class="hs-identifier hs-type">CtxMul</span></a></span><span>  </span><span id="local-6989586621679100133"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100133"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100134"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100134"><span class="hs-identifier hs-var">mc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100133"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100123"><span class="hs-identifier hs-var">s</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100134"><span class="hs-identifier hs-var">mc</span></a></span><span>
</span><span id="line-203"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxSub"><span class="hs-identifier hs-type">CtxSub</span></a></span><span>  </span><span id="local-6989586621679100135"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100135"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100136"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100136"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100135"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100123"><span class="hs-identifier hs-var">s</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100136"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-205"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxFrac"><span class="hs-identifier hs-type">CtxFrac</span></a></span><span> </span><span id="local-6989586621679100137"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100137"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100138"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100138"><span class="hs-identifier hs-var">fc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100137"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679100123"><span class="hs-identifier hs-var">s</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100138"><span class="hs-identifier hs-var">fc</span></a></span><span>
</span><span id="line-207"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Numeral.Render.html#CtxScale"><span class="hs-identifier hs-type">CtxScale</span></a></span><span>  </span><span id="local-6989586621679100139"><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100139"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ctx a -&gt; Bool
forall a. Ctx a -&gt; Bool
</span><a href="#local-6989586621679100125"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ctx a
</span><a href="#local-6989586621679100139"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-209"></span></pre></body></html>