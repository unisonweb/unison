<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Web.Cookie</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Server to client</span></span><span>
</span><span id="line-5"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Data type</span></span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier">SetCookie</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieName"><span class="hs-identifier">setCookieName</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieValue"><span class="hs-identifier">setCookieValue</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookiePath"><span class="hs-identifier">setCookiePath</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieExpires"><span class="hs-identifier">setCookieExpires</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieMaxAge"><span class="hs-identifier">setCookieMaxAge</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieDomain"><span class="hs-identifier">setCookieDomain</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieHttpOnly"><span class="hs-identifier">setCookieHttpOnly</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieSecure"><span class="hs-identifier">setCookieSecure</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#setCookieSameSite"><span class="hs-identifier">setCookieSameSite</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier">SameSiteOption</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#sameSiteLax"><span class="hs-identifier">sameSiteLax</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#sameSiteStrict"><span class="hs-identifier">sameSiteStrict</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#sameSiteNone"><span class="hs-identifier">sameSiteNone</span></a></span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Functions</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#parseSetCookie"><span class="hs-identifier">parseSetCookie</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#renderSetCookie"><span class="hs-identifier">renderSetCookie</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#renderSetCookieBS"><span class="hs-identifier">renderSetCookieBS</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#defaultSetCookie"><span class="hs-identifier">defaultSetCookie</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Client to server</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#Cookies"><span class="hs-identifier">Cookies</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#parseCookies"><span class="hs-identifier">parseCookies</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#renderCookies"><span class="hs-identifier">renderCookies</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#renderCookiesBS"><span class="hs-identifier">renderCookiesBS</span></a></span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** UTF8 Version</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#CookiesText"><span class="hs-identifier">CookiesText</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#parseCookiesText"><span class="hs-identifier">parseCookiesText</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#renderCookiesText"><span class="hs-identifier">renderCookiesText</span></a></span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Expires field</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#expiresFormat"><span class="hs-identifier">expiresFormat</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#formatCookieExpires"><span class="hs-identifier">formatCookieExpires</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Cookie.html#parseCookieExpires"><span class="hs-identifier">parseCookieExpires</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S8</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isDigit</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Builder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">byteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">char8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toLazyByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder.Extra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">byteStringCopy</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !(MIN_VERSION_base(4,8,0))
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mempty</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mappend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">mconcat</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">numerator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">denominator</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toGregorian</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromGregorian</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseTimeM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">secondsToDiffTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeUtf8Builder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decodeUtf8With</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lenientDecode</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rnf</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><span class="hs-comment">-- | Textual cookies. Functions assume UTF8 encoding.</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span id="CookiesText"><span class="annot"><a href="Web.Cookie.html#CookiesText"><span class="hs-identifier hs-var">CookiesText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Web.Cookie.html#parseCookiesText"><span class="hs-identifier hs-type">parseCookiesText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Cookie.html#CookiesText"><span class="hs-identifier hs-type">CookiesText</span></a></span><span>
</span><span id="line-66"></span><span id="parseCookiesText"><span class="annot"><span class="annottext">parseCookiesText :: ByteString -&gt; CookiesText
</span><a href="Web.Cookie.html#parseCookiesText"><span class="hs-identifier hs-var hs-var">parseCookiesText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; (Text, Text))
-&gt; [(ByteString, ByteString)] -&gt; CookiesText
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679046546"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ByteString -&gt; Text) -&gt; (ByteString, ByteString) -&gt; (Text, Text)
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="#local-6989586621679046546"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; CookiesText)
-&gt; (ByteString -&gt; [(ByteString, ByteString)])
-&gt; ByteString
-&gt; CookiesText
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><a href="Web.Cookie.html#parseCookies"><span class="hs-identifier hs-var">parseCookies</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679046546"><span class="annot"><span class="annottext">go :: ByteString -&gt; Text
</span><a href="#local-6989586621679046546"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Web.Cookie.html#renderCookiesText"><span class="hs-identifier hs-type">renderCookiesText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#CookiesText"><span class="hs-identifier hs-type">CookiesText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-72"></span><span id="renderCookiesText"><span class="annot"><span class="annottext">renderCookiesText :: CookiesText -&gt; Builder
</span><a href="Web.Cookie.html#renderCookiesText"><span class="hs-identifier hs-var hs-var">renderCookiesText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CookieBuilder] -&gt; Builder
</span><a href="Web.Cookie.html#renderCookiesBuilder"><span class="hs-identifier hs-var">renderCookiesBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">([CookieBuilder] -&gt; Builder)
-&gt; (CookiesText -&gt; [CookieBuilder]) -&gt; CookiesText -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Text, Text) -&gt; CookieBuilder) -&gt; CookiesText -&gt; [CookieBuilder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">encodeUtf8Builder</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder)
-&gt; (Text -&gt; Builder) -&gt; (Text, Text) -&gt; CookieBuilder
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">encodeUtf8Builder</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="Cookies"><span class="annot"><a href="Web.Cookie.html#Cookies"><span class="hs-identifier hs-var">Cookies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | Decode the value of a \&quot;Cookie\&quot; request header into key/value pairs.</span></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Web.Cookie.html#parseCookies"><span class="hs-identifier hs-type">parseCookies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Cookie.html#Cookies"><span class="hs-identifier hs-type">Cookies</span></a></span><span>
</span><span id="line-78"></span><span id="parseCookies"><span class="annot"><span class="annottext">parseCookies :: ByteString -&gt; [(ByteString, ByteString)]
</span><a href="Web.Cookie.html#parseCookies"><span class="hs-identifier hs-var hs-var">parseCookies</span></a></span></span><span> </span><span id="local-6989586621679046549"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046549"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">S.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046549"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046553"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046553"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046554"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046554"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#breakDiscard"><span class="hs-identifier hs-var">breakDiscard</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">59</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046549"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- semicolon</span><span>
</span><span id="line-82"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#parseCookie"><span class="hs-identifier hs-var">parseCookie</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046553"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><a href="Web.Cookie.html#parseCookies"><span class="hs-identifier hs-var">parseCookies</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046554"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Web.Cookie.html#parseCookie"><span class="hs-identifier hs-type">parseCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span id="parseCookie"><span class="annot"><span class="annottext">parseCookie :: ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#parseCookie"><span class="hs-identifier hs-var hs-var">parseCookie</span></a></span></span><span> </span><span id="local-6989586621679046557"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046557"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046559"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046559"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046560"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046560"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#breakDiscard"><span class="hs-identifier hs-var">breakDiscard</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">61</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046557"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- equals sign</span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679046564"><span class="annot"><span class="annottext">key' :: ByteString
</span><a href="#local-6989586621679046564"><span class="hs-identifier hs-var hs-var">key'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">S.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046559"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-comment">-- space</span><span>
</span><span id="line-88"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046564"><span class="hs-identifier hs-var">key'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046560"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Web.Cookie.html#breakDiscard"><span class="hs-identifier hs-type">breakDiscard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span id="breakDiscard"><span class="annot"><span class="annottext">breakDiscard :: Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#breakDiscard"><span class="hs-identifier hs-var hs-var">breakDiscard</span></a></span></span><span> </span><span id="local-6989586621679046566"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679046566"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679046567"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046567"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046569"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046569"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046570"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046570"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">S.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679046566"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046567"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-93"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046569"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">S.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046570"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">type</span><span> </span><span id="CookieBuilder"><span class="annot"><a href="Web.Cookie.html#CookieBuilder"><span class="hs-identifier hs-var">CookieBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Web.Cookie.html#renderCookiesBuilder"><span class="hs-identifier hs-type">renderCookiesBuilder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Web.Cookie.html#CookieBuilder"><span class="hs-identifier hs-type">CookieBuilder</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-98"></span><span id="renderCookiesBuilder"><span class="annot"><span class="annottext">renderCookiesBuilder :: [CookieBuilder] -&gt; Builder
</span><a href="Web.Cookie.html#renderCookiesBuilder"><span class="hs-identifier hs-var hs-var">renderCookiesBuilder</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Web.Cookie.html#renderCookiesBuilder"><span class="hs-identifier hs-var">renderCookiesBuilder</span></a></span><span> </span><span id="local-6989586621679046573"><span class="annot"><span class="annottext">[CookieBuilder]
</span><a href="#local-6989586621679046573"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">(Builder -&gt; Builder -&gt; Builder) -&gt; [Builder] -&gt; Builder
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
</span><a href="#local-6989586621679046575"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([Builder] -&gt; Builder) -&gt; [Builder] -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CookieBuilder -&gt; Builder) -&gt; [CookieBuilder] -&gt; [Builder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CookieBuilder -&gt; Builder
</span><a href="Web.Cookie.html#renderCookie"><span class="hs-identifier hs-var">renderCookie</span></a></span><span> </span><span class="annot"><span class="annottext">[CookieBuilder]
</span><a href="#local-6989586621679046573"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679046575"><span class="annot"><span class="annottext">go :: Builder -&gt; Builder -&gt; Builder
</span><a href="#local-6989586621679046575"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679046579"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046579"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679046580"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046580"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046579"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">char8</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">';'</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046580"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Web.Cookie.html#renderCookie"><span class="hs-identifier hs-type">renderCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#CookieBuilder"><span class="hs-identifier hs-type">CookieBuilder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-105"></span><span id="renderCookie"><span class="annot"><span class="annottext">renderCookie :: CookieBuilder -&gt; Builder
</span><a href="Web.Cookie.html#renderCookie"><span class="hs-identifier hs-var hs-var">renderCookie</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046581"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046581"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046582"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046582"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046581"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">char8</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679046582"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Web.Cookie.html#renderCookies"><span class="hs-identifier hs-type">renderCookies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#Cookies"><span class="hs-identifier hs-type">Cookies</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-108"></span><span id="renderCookies"><span class="annot"><span class="annottext">renderCookies :: [(ByteString, ByteString)] -&gt; Builder
</span><a href="Web.Cookie.html#renderCookies"><span class="hs-identifier hs-var hs-var">renderCookies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CookieBuilder] -&gt; Builder
</span><a href="Web.Cookie.html#renderCookiesBuilder"><span class="hs-identifier hs-var">renderCookiesBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">([CookieBuilder] -&gt; Builder)
-&gt; ([(ByteString, ByteString)] -&gt; [CookieBuilder])
-&gt; [(ByteString, ByteString)]
-&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; CookieBuilder)
-&gt; [(ByteString, ByteString)] -&gt; [CookieBuilder]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Builder)
-&gt; (ByteString -&gt; Builder)
-&gt; (ByteString, ByteString)
-&gt; CookieBuilder
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | @since 0.4.6</span></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Web.Cookie.html#renderCookiesBS"><span class="hs-identifier hs-type">renderCookiesBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#Cookies"><span class="hs-identifier hs-type">Cookies</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span>
</span><span id="line-112"></span><span id="renderCookiesBS"><span class="annot"><span class="annottext">renderCookiesBS :: [(ByteString, ByteString)] -&gt; ByteString
</span><a href="Web.Cookie.html#renderCookiesBS"><span class="hs-identifier hs-var hs-var">renderCookiesBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">L.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; ([(ByteString, ByteString)] -&gt; ByteString)
-&gt; [(ByteString, ByteString)]
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">toLazyByteString</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString)
-&gt; ([(ByteString, ByteString)] -&gt; Builder)
-&gt; [(ByteString, ByteString)]
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Builder
</span><a href="Web.Cookie.html#renderCookies"><span class="hs-identifier hs-var">renderCookies</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Data type representing the key-value pair to use for a cookie, as well as configuration options for it.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- ==== Creating a SetCookie</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- 'SetCookie' does not export a constructor; instead, use 'defaultSetCookie' and override values (see &lt;http://www.yesodweb.com/book/settings-types&gt; for details):</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- import Web.Cookie</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- :set -XOverloadedStrings</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- let cookie = 'defaultSetCookie' { 'setCookieName' = &quot;cookieName&quot;, 'setCookieValue' = &quot;cookieValue&quot; }</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- ==== Cookie Configuration</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- Cookies have several configuration options; a brief summary of each option is given below. For more information, see &lt;http://tools.ietf.org/html/rfc6265#section-4.1.2 RFC 6265&gt; or &lt;https://en.wikipedia.org/wiki/HTTP_cookie#Cookie_attributes Wikipedia&gt;.</span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="SetCookie"><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-var">SetCookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SetCookie"><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-var">SetCookie</span></a></span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="setCookieName"><span class="annot"><span class="annottext">SetCookie -&gt; ByteString
</span><a href="Web.Cookie.html#setCookieName"><span class="hs-identifier hs-var hs-var">setCookieName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The name of the cookie. Default value: @&quot;name&quot;@</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieValue"><span class="annot"><span class="annottext">SetCookie -&gt; ByteString
</span><a href="Web.Cookie.html#setCookieValue"><span class="hs-identifier hs-var hs-var">setCookieValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The value of the cookie. Default value: @&quot;value&quot;@</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookiePath"><span class="annot"><span class="annottext">SetCookie -&gt; Maybe ByteString
</span><a href="Web.Cookie.html#setCookiePath"><span class="hs-identifier hs-var hs-var">setCookiePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The URL path for which the cookie should be sent. Default value: @Nothing@ (The browser defaults to the path of the request that sets the cookie).</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieExpires"><span class="annot"><span class="annottext">SetCookie -&gt; Maybe UTCTime
</span><a href="Web.Cookie.html#setCookieExpires"><span class="hs-identifier hs-var hs-var">setCookieExpires</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The time at which to expire the cookie. Default value: @Nothing@ (The browser will default to expiring a cookie when the browser is closed).</span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieMaxAge"><span class="annot"><span class="annottext">SetCookie -&gt; Maybe DiffTime
</span><a href="Web.Cookie.html#setCookieMaxAge"><span class="hs-identifier hs-var hs-var">setCookieMaxAge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The maximum time to keep the cookie, in seconds. Default value: @Nothing@ (The browser defaults to expiring a cookie when the browser is closed).</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieDomain"><span class="annot"><span class="annottext">SetCookie -&gt; Maybe ByteString
</span><a href="Web.Cookie.html#setCookieDomain"><span class="hs-identifier hs-var hs-var">setCookieDomain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The domain for which the cookie should be sent. Default value: @Nothing@ (The browser defaults to the current domain).</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieHttpOnly"><span class="annot"><span class="annottext">SetCookie -&gt; Bool
</span><a href="Web.Cookie.html#setCookieHttpOnly"><span class="hs-identifier hs-var hs-var">setCookieHttpOnly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Marks the cookie as &quot;HTTP only&quot;, i.e. not accessible from Javascript. Default value: @False@</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieSecure"><span class="annot"><span class="annottext">SetCookie -&gt; Bool
</span><a href="Web.Cookie.html#setCookieSecure"><span class="hs-identifier hs-var hs-var">setCookieSecure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Instructs the browser to only send the cookie over HTTPS. Default value: @False@</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="setCookieSameSite"><span class="annot"><span class="annottext">SetCookie -&gt; Maybe SameSiteOption
</span><a href="Web.Cookie.html#setCookieSameSite"><span class="hs-identifier hs-var hs-var">setCookieSameSite</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-type">SameSiteOption</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The &quot;same site&quot; policy of the cookie, i.e. whether it should be sent with cross-site requests. Default value: @Nothing@</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046586"><span id="local-6989586621679046602"><span class="annot"><span class="annottext">SetCookie -&gt; SetCookie -&gt; Bool
(SetCookie -&gt; SetCookie -&gt; Bool)
-&gt; (SetCookie -&gt; SetCookie -&gt; Bool) -&gt; Eq SetCookie
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SetCookie -&gt; SetCookie -&gt; Bool
== :: SetCookie -&gt; SetCookie -&gt; Bool
$c/= :: SetCookie -&gt; SetCookie -&gt; Bool
/= :: SetCookie -&gt; SetCookie -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046610"><span id="local-6989586621679046629"><span id="local-6989586621679046633"><span class="annot"><span class="annottext">Int -&gt; SetCookie -&gt; ShowS
[SetCookie] -&gt; ShowS
SetCookie -&gt; String
(Int -&gt; SetCookie -&gt; ShowS)
-&gt; (SetCookie -&gt; String)
-&gt; ([SetCookie] -&gt; ShowS)
-&gt; Show SetCookie
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SetCookie -&gt; ShowS
showsPrec :: Int -&gt; SetCookie -&gt; ShowS
$cshow :: SetCookie -&gt; String
show :: SetCookie -&gt; String
$cshowList :: [SetCookie] -&gt; ShowS
showList :: [SetCookie] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><span class="hs-comment">-- | Data type representing the options for a &lt;https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-4.1 SameSite cookie&gt;</span></span><span>
</span><span id="line-143"></span><span class="hs-keyword">data</span><span> </span><span id="SameSiteOption"><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-var">SameSiteOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Lax"><span class="annot"><a href="Web.Cookie.html#Lax"><span class="hs-identifier hs-var">Lax</span></a></span></span><span>
</span><span id="line-144"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="Strict"><span class="annot"><a href="Web.Cookie.html#Strict"><span class="hs-identifier hs-var">Strict</span></a></span></span><span>
</span><span id="line-145"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="None"><span class="annot"><a href="Web.Cookie.html#None"><span class="hs-identifier hs-var">None</span></a></span></span><span>
</span><span id="line-146"></span><span>                    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679046643"><span id="local-6989586621679046645"><span id="local-6989586621679046648"><span class="annot"><span class="annottext">Int -&gt; SameSiteOption -&gt; ShowS
[SameSiteOption] -&gt; ShowS
SameSiteOption -&gt; String
(Int -&gt; SameSiteOption -&gt; ShowS)
-&gt; (SameSiteOption -&gt; String)
-&gt; ([SameSiteOption] -&gt; ShowS)
-&gt; Show SameSiteOption
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SameSiteOption -&gt; ShowS
showsPrec :: Int -&gt; SameSiteOption -&gt; ShowS
$cshow :: SameSiteOption -&gt; String
show :: SameSiteOption -&gt; String
$cshowList :: [SameSiteOption] -&gt; ShowS
showList :: [SameSiteOption] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046651"><span id="local-6989586621679046653"><span class="annot"><span class="annottext">SameSiteOption -&gt; SameSiteOption -&gt; Bool
(SameSiteOption -&gt; SameSiteOption -&gt; Bool)
-&gt; (SameSiteOption -&gt; SameSiteOption -&gt; Bool) -&gt; Eq SameSiteOption
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SameSiteOption -&gt; SameSiteOption -&gt; Bool
== :: SameSiteOption -&gt; SameSiteOption -&gt; Bool
$c/= :: SameSiteOption -&gt; SameSiteOption -&gt; Bool
/= :: SameSiteOption -&gt; SameSiteOption -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-type">SameSiteOption</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679046658"><span class="annot"><span class="annottext">rnf :: SameSiteOption -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span id="local-6989586621679046659"><span class="annot"><span class="annottext">SameSiteOption
</span><a href="#local-6989586621679046659"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="#local-6989586621679046659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SameSiteOption -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | Directs the browser to send the cookie for &lt;https://tools.ietf.org/html/rfc7231#section-4.2.1 safe requests&gt; (e.g. @GET@), but not for unsafe ones (e.g. @POST@)</span></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Web.Cookie.html#sameSiteLax"><span class="hs-identifier hs-type">sameSiteLax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-type">SameSiteOption</span></a></span><span>
</span><span id="line-153"></span><span id="sameSiteLax"><span class="annot"><span class="annottext">sameSiteLax :: SameSiteOption
</span><a href="Web.Cookie.html#sameSiteLax"><span class="hs-identifier hs-var hs-var">sameSiteLax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Lax"><span class="hs-identifier hs-var">Lax</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><span class="hs-comment">-- | Directs the browser to not send the cookie for /any/ cross-site request, including e.g. a user clicking a link in their email to open a page on your site.</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Web.Cookie.html#sameSiteStrict"><span class="hs-identifier hs-type">sameSiteStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-type">SameSiteOption</span></a></span><span>
</span><span id="line-157"></span><span id="sameSiteStrict"><span class="annot"><span class="annottext">sameSiteStrict :: SameSiteOption
</span><a href="Web.Cookie.html#sameSiteStrict"><span class="hs-identifier hs-var hs-var">sameSiteStrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Strict"><span class="hs-identifier hs-var">Strict</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- Directs the browser to send the cookie for cross-site requests.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- @since 0.4.5</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Web.Cookie.html#sameSiteNone"><span class="hs-identifier hs-type">sameSiteNone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SameSiteOption"><span class="hs-identifier hs-type">SameSiteOption</span></a></span><span>
</span><span id="line-164"></span><span id="sameSiteNone"><span class="annot"><span class="annottext">sameSiteNone :: SameSiteOption
</span><a href="Web.Cookie.html#sameSiteNone"><span class="hs-identifier hs-var hs-var">sameSiteNone</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679046674"><span class="annot"><span class="annottext">rnf :: SetCookie -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span> </span><span id="local-6989586621679046675"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046675"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679046676"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046676"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679046677"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679046677"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679046678"><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679046678"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679046679"><span class="annot"><span class="annottext">Maybe DiffTime
</span><a href="#local-6989586621679046679"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679046680"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679046680"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679046681"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679046681"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679046682"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679046682"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679046683"><span class="annot"><span class="annottext">Maybe SameSiteOption
</span><a href="#local-6989586621679046683"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046675"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046676"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; ()
forall {a}. Maybe a -&gt; ()
</span><a href="#local-6989586621679046684"><span class="hs-identifier hs-var">rnfMBS</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679046677"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Maybe UTCTime -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><a href="#local-6989586621679046678"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Maybe DiffTime -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
</span><a href="#local-6989586621679046679"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; ()
forall {a}. Maybe a -&gt; ()
</span><a href="#local-6989586621679046684"><span class="hs-identifier hs-var">rnfMBS</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679046680"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679046681"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679046682"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">Maybe SameSiteOption -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Maybe SameSiteOption
</span><a href="#local-6989586621679046683"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-comment">-- For backwards compatibility</span><span>
</span><span id="line-179"></span><span>        </span><span id="local-6989586621679046684"><span class="annot"><span class="annottext">rnfMBS :: Maybe a -&gt; ()
</span><a href="#local-6989586621679046684"><span class="hs-identifier hs-var hs-var">rnfMBS</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="#local-6989586621679046684"><span class="hs-identifier hs-var">rnfMBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679046685"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679046685"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679046685"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><span class="hs-comment">-- | @'def' = 'defaultSetCookie'@</span></span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679046689"><span class="annot"><span class="annottext">def :: SetCookie
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="Web.Cookie.html#defaultSetCookie"><span class="hs-identifier hs-var">defaultSetCookie</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | A minimal 'SetCookie'. All fields are 'Nothing' or 'False' except @'setCookieName' = &quot;name&quot;@ and @'setCookieValue' = &quot;value&quot;@. You need this to construct a 'SetCookie', because it does not export a constructor. Equivalently, you may use 'def'.</span><span>
</span><span id="line-187"></span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- @since 0.4.2.2</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Web.Cookie.html#defaultSetCookie"><span class="hs-identifier hs-type">defaultSetCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span>
</span><span id="line-190"></span><span id="defaultSetCookie"><span class="annot"><span class="annottext">defaultSetCookie :: SetCookie
</span><a href="Web.Cookie.html#defaultSetCookie"><span class="hs-identifier hs-var hs-var">defaultSetCookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">setCookieName :: ByteString
</span><a href="Web.Cookie.html#setCookieName"><span class="hs-identifier hs-var">setCookieName</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;name&quot;</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieValue :: ByteString
</span><a href="Web.Cookie.html#setCookieValue"><span class="hs-identifier hs-var">setCookieValue</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookiePath :: Maybe ByteString
</span><a href="Web.Cookie.html#setCookiePath"><span class="hs-identifier hs-var">setCookiePath</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieExpires :: Maybe UTCTime
</span><a href="Web.Cookie.html#setCookieExpires"><span class="hs-identifier hs-var">setCookieExpires</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe UTCTime
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieMaxAge :: Maybe DiffTime
</span><a href="Web.Cookie.html#setCookieMaxAge"><span class="hs-identifier hs-var">setCookieMaxAge</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieDomain :: Maybe ByteString
</span><a href="Web.Cookie.html#setCookieDomain"><span class="hs-identifier hs-var">setCookieDomain</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieHttpOnly :: Bool
</span><a href="Web.Cookie.html#setCookieHttpOnly"><span class="hs-identifier hs-var">setCookieHttpOnly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieSecure :: Bool
</span><a href="Web.Cookie.html#setCookieSecure"><span class="hs-identifier hs-var">setCookieSecure</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieSameSite :: Maybe SameSiteOption
</span><a href="Web.Cookie.html#setCookieSameSite"><span class="hs-identifier hs-var">setCookieSameSite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SameSiteOption
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Web.Cookie.html#renderSetCookie"><span class="hs-identifier hs-type">renderSetCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Builder</span></span><span>
</span><span id="line-203"></span><span id="renderSetCookie"><span class="annot"><span class="annottext">renderSetCookie :: SetCookie -&gt; Builder
</span><a href="Web.Cookie.html#renderSetCookie"><span class="hs-identifier hs-var hs-var">renderSetCookie</span></a></span></span><span> </span><span id="local-6989586621679046690"><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetCookie -&gt; ByteString
</span><a href="Web.Cookie.html#setCookieName"><span class="hs-identifier hs-var">setCookieName</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">char8</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SetCookie -&gt; ByteString
</span><a href="Web.Cookie.html#setCookieValue"><span class="hs-identifier hs-var">setCookieValue</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Maybe ByteString
</span><a href="Web.Cookie.html#setCookiePath"><span class="hs-identifier hs-var">setCookiePath</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679046691"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046691"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Path=&quot;</span></span><span>
</span><span id="line-210"></span><span>                     </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046691"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Maybe UTCTime
</span><a href="Web.Cookie.html#setCookieExpires"><span class="hs-identifier hs-var">setCookieExpires</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Maybe UTCTime
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679046692"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679046692"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Expires=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span>
</span><span id="line-214"></span><span>                  </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; ByteString
</span><a href="Web.Cookie.html#formatCookieExpires"><span class="hs-identifier hs-var">formatCookieExpires</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679046692"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Maybe DiffTime
</span><a href="Web.Cookie.html#setCookieMaxAge"><span class="hs-identifier hs-var">setCookieMaxAge</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Maybe DiffTime
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679046693"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046693"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Max-Age=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span>
</span><span id="line-218"></span><span>                   </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiffTime -&gt; ByteString
</span><a href="Web.Cookie.html#formatCookieMaxAge"><span class="hs-identifier hs-var">formatCookieMaxAge</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046693"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Maybe ByteString
</span><a href="Web.Cookie.html#setCookieDomain"><span class="hs-identifier hs-var">setCookieDomain</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679046695"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046695"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Domain=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span>
</span><span id="line-222"></span><span>                  </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046695"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Bool
</span><a href="Web.Cookie.html#setCookieHttpOnly"><span class="hs-identifier hs-var">setCookieHttpOnly</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; HttpOnly&quot;</span></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Bool
</span><a href="Web.Cookie.html#setCookieSecure"><span class="hs-identifier hs-var">setCookieSecure</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; Secure&quot;</span></span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Maybe SameSiteOption
</span><a href="Web.Cookie.html#setCookieSameSite"><span class="hs-identifier hs-var">setCookieSameSite</span></a></span><span> </span><span class="annot"><span class="annottext">SetCookie
</span><a href="#local-6989586621679046690"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Maybe SameSiteOption
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Lax"><span class="hs-identifier hs-var">Lax</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; SameSite=Lax&quot;</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Strict"><span class="hs-identifier hs-var">Strict</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; SameSite=Strict&quot;</span></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">byteStringCopy</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;; SameSite=None&quot;</span></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><span class="hs-comment">-- | @since 0.4.6</span></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Web.Cookie.html#renderSetCookieBS"><span class="hs-identifier hs-type">renderSetCookieBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span>
</span><span id="line-238"></span><span id="renderSetCookieBS"><span class="annot"><span class="annottext">renderSetCookieBS :: SetCookie -&gt; ByteString
</span><a href="Web.Cookie.html#renderSetCookieBS"><span class="hs-identifier hs-var hs-var">renderSetCookieBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">L.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (SetCookie -&gt; ByteString) -&gt; SetCookie -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">toLazyByteString</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString)
-&gt; (SetCookie -&gt; Builder) -&gt; SetCookie -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SetCookie -&gt; Builder
</span><a href="Web.Cookie.html#renderSetCookie"><span class="hs-identifier hs-var">renderSetCookie</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><a href="Web.Cookie.html#parseSetCookie"><span class="hs-identifier hs-type">parseSetCookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span>
</span><span id="line-241"></span><span id="parseSetCookie"><span class="annot"><span class="annottext">parseSetCookie :: ByteString -&gt; SetCookie
</span><a href="Web.Cookie.html#parseSetCookie"><span class="hs-identifier hs-var hs-var">parseSetCookie</span></a></span></span><span> </span><span id="local-6989586621679046696"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046696"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Web.Cookie.html#SetCookie"><span class="hs-identifier hs-type">SetCookie</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">setCookieName :: ByteString
</span><a href="Web.Cookie.html#setCookieName"><span class="hs-identifier hs-var">setCookieName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046697"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieValue :: ByteString
</span><a href="Web.Cookie.html#setCookieValue"><span class="hs-identifier hs-var">setCookieValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046698"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookiePath :: Maybe ByteString
</span><a href="Web.Cookie.html#setCookiePath"><span class="hs-identifier hs-var">setCookiePath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;path&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieExpires :: Maybe UTCTime
</span><a href="Web.Cookie.html#setCookieExpires"><span class="hs-identifier hs-var">setCookieExpires</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;expires&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; (ByteString -&gt; Maybe UTCTime) -&gt; Maybe UTCTime
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe UTCTime
</span><a href="Web.Cookie.html#parseCookieExpires"><span class="hs-identifier hs-var">parseCookieExpires</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieMaxAge :: Maybe DiffTime
</span><a href="Web.Cookie.html#setCookieMaxAge"><span class="hs-identifier hs-var">setCookieMaxAge</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;max-age&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
-&gt; (ByteString -&gt; Maybe DiffTime) -&gt; Maybe DiffTime
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe DiffTime
</span><a href="Web.Cookie.html#parseCookieMaxAge"><span class="hs-identifier hs-var">parseCookieMaxAge</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieDomain :: Maybe ByteString
</span><a href="Web.Cookie.html#setCookieDomain"><span class="hs-identifier hs-var">setCookieDomain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;domain&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieHttpOnly :: Bool
</span><a href="Web.Cookie.html#setCookieHttpOnly"><span class="hs-identifier hs-var">setCookieHttpOnly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Bool) -&gt; Maybe ByteString -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;httponly&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieSecure :: Bool
</span><a href="Web.Cookie.html#setCookieSecure"><span class="hs-identifier hs-var">setCookieSecure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Bool) -&gt; Maybe ByteString -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;secure&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">setCookieSameSite :: Maybe SameSiteOption
</span><a href="Web.Cookie.html#setCookieSameSite"><span class="hs-identifier hs-var">setCookieSameSite</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;samesite&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var">flags</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Lax&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SameSiteOption -&gt; Maybe SameSiteOption
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Lax"><span class="hs-identifier hs-var">Lax</span></a></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Strict&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SameSiteOption -&gt; Maybe SameSiteOption
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#Strict"><span class="hs-identifier hs-var">Strict</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;None&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SameSiteOption -&gt; Maybe SameSiteOption
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SameSiteOption
</span><a href="Web.Cookie.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SameSiteOption
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679046703"><span class="annot"><span class="annottext">pairs :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679046703"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; [ByteString] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679046704"><span class="hs-identifier hs-var">parsePair</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; (ByteString -&gt; ByteString)
-&gt; ByteString
-&gt; (ByteString, ByteString)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679046705"><span class="hs-identifier hs-var">dropSpace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [(ByteString, ByteString)])
-&gt; [ByteString] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">S.split</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">59</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046696"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">S8.empty</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- 59 = semicolon</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679046697"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046697"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046698"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046698"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; (ByteString, ByteString)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046703"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679046700"><span class="annot"><span class="annottext">flags :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679046700"><span class="hs-identifier hs-var hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; (ByteString, ByteString))
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679046703"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679046704"><span class="annot"><span class="annottext">parsePair :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679046704"><span class="hs-identifier hs-var hs-var">parsePair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Web.Cookie.html#breakDiscard"><span class="hs-identifier hs-var">breakDiscard</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">61</span></span><span> </span><span class="hs-comment">-- equals sign</span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679046705"><span class="annot"><span class="annottext">dropSpace :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679046705"><span class="hs-identifier hs-var hs-var">dropSpace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">S.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- space</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Web.Cookie.html#expiresFormat"><span class="hs-identifier hs-type">expiresFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-266"></span><span id="expiresFormat"><span class="annot"><span class="annottext">expiresFormat :: String
</span><a href="Web.Cookie.html#expiresFormat"><span class="hs-identifier hs-var hs-var">expiresFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%a, %d-%b-%Y %X GMT&quot;</span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><span class="hs-comment">-- | Format a 'UTCTime' for a cookie.</span></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Web.Cookie.html#formatCookieExpires"><span class="hs-identifier hs-type">formatCookieExpires</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span>
</span><span id="line-270"></span><span id="formatCookieExpires"><span class="annot"><span class="annottext">formatCookieExpires :: UTCTime -&gt; ByteString
</span><a href="Web.Cookie.html#formatCookieExpires"><span class="hs-identifier hs-var hs-var">formatCookieExpires</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString)
-&gt; (UTCTime -&gt; String) -&gt; UTCTime -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; UTCTime -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Web.Cookie.html#expiresFormat"><span class="hs-identifier hs-var">expiresFormat</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Web.Cookie.html#parseCookieExpires"><span class="hs-identifier hs-type">parseCookieExpires</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-274"></span><span id="parseCookieExpires"><span class="annot"><span class="annottext">parseCookieExpires :: ByteString -&gt; Maybe UTCTime
</span><a href="Web.Cookie.html#parseCookieExpires"><span class="hs-identifier hs-var hs-var">parseCookieExpires</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">(UTCTime -&gt; UTCTime) -&gt; Maybe UTCTime -&gt; Maybe UTCTime
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime
</span><a href="#local-6989586621679046720"><span class="hs-identifier hs-var">fuzzYear</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe UTCTime -&gt; Maybe UTCTime)
-&gt; (ByteString -&gt; Maybe UTCTime) -&gt; ByteString -&gt; Maybe UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; Maybe UTCTime
forall (m :: * -&gt; *) t.
(MonadFail m, ParseTime t) =&gt;
Bool -&gt; TimeLocale -&gt; String -&gt; String -&gt; m t
</span><span class="hs-identifier hs-var">parseTimeM</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Web.Cookie.html#expiresFormat"><span class="hs-identifier hs-var">expiresFormat</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe UTCTime)
-&gt; (ByteString -&gt; String) -&gt; ByteString -&gt; Maybe UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- See: https://github.com/snoyberg/cookie/issues/5</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679046720"><span class="annot"><span class="annottext">fuzzYear :: UTCTime -&gt; UTCTime
</span><a href="#local-6989586621679046720"><span class="hs-identifier hs-var hs-var">fuzzYear</span></a></span></span><span> </span><span id="local-6989586621679046732"><span class="annot"><span class="annottext">orig :: UTCTime
</span><a href="#local-6989586621679046732"><span class="hs-identifier hs-var">orig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span id="local-6989586621679046733"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679046733"><span class="hs-identifier hs-var">day</span></a></span></span><span> </span><span id="local-6989586621679046734"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046734"><span class="hs-identifier hs-var">diff</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">70</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">99</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; UTCTime
</span><a href="#local-6989586621679046738"><span class="hs-identifier hs-var">addYear</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1900</span></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">69</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; UTCTime
</span><a href="#local-6989586621679046738"><span class="hs-identifier hs-var">addYear</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2000</span></span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679046732"><span class="hs-identifier hs-var">orig</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679046735"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046739"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679046739"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679046740"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679046740"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day -&gt; (Integer, Int, Int)
</span><span class="hs-identifier hs-var">toGregorian</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679046733"><span class="hs-identifier hs-var">day</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679046738"><span class="annot"><span class="annottext">addYear :: Integer -&gt; UTCTime
</span><a href="#local-6989586621679046738"><span class="hs-identifier hs-var hs-var">addYear</span></a></span></span><span> </span><span id="local-6989586621679046742"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046742"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day -&gt; DiffTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">UTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Int -&gt; Day
</span><span class="hs-identifier hs-var">fromGregorian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046735"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046742"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679046739"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679046740"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046734"><span class="hs-identifier hs-var">diff</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- | Format a 'DiffTime' for a cookie.</span></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Web.Cookie.html#formatCookieMaxAge"><span class="hs-identifier hs-type">formatCookieMaxAge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span>
</span><span id="line-288"></span><span id="formatCookieMaxAge"><span class="annot"><span class="annottext">formatCookieMaxAge :: DiffTime -&gt; ByteString
</span><a href="Web.Cookie.html#formatCookieMaxAge"><span class="hs-identifier hs-var hs-var">formatCookieMaxAge</span></a></span></span><span> </span><span id="local-6989586621679046744"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046744"><span class="hs-identifier hs-var">difftime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">S8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046746"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679046748"><span class="hs-identifier hs-var">denom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679046751"><span class="annot"><span class="annottext">rational :: Rational
</span><a href="#local-6989586621679046751"><span class="hs-identifier hs-var hs-var">rational</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621679046744"><span class="hs-identifier hs-var">difftime</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679046746"><span class="annot"><span class="annottext">num :: Integer
</span><a href="#local-6989586621679046746"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679046751"><span class="hs-identifier hs-var">rational</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span id="local-6989586621679046748"><span class="annot"><span class="annottext">denom :: Integer
</span><a href="#local-6989586621679046748"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679046751"><span class="hs-identifier hs-var">rational</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="Web.Cookie.html#parseCookieMaxAge"><span class="hs-identifier hs-type">parseCookieMaxAge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span>
</span><span id="line-294"></span><span id="parseCookieMaxAge"><span class="annot"><span class="annottext">parseCookieMaxAge :: ByteString -&gt; Maybe DiffTime
</span><a href="Web.Cookie.html#parseCookieMaxAge"><span class="hs-identifier hs-var hs-var">parseCookieMaxAge</span></a></span></span><span> </span><span id="local-6989586621679046752"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046752"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679046754"><span class="hs-identifier hs-var">unpacked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Maybe DiffTime
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Maybe DiffTime) -&gt; DiffTime -&gt; Maybe DiffTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; DiffTime
</span><span class="hs-identifier hs-var">secondsToDiffTime</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; DiffTime) -&gt; Integer -&gt; DiffTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Integer
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679046754"><span class="hs-identifier hs-var">unpacked</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DiffTime
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679046754"><span class="annot"><span class="annottext">unpacked :: String
</span><a href="#local-6989586621679046754"><span class="hs-identifier hs-var hs-var">unpacked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">S8.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679046752"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-298"></span></pre></body></html>