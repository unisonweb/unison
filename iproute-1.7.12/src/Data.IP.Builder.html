<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NoStrict #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.IP.Builder</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * 'P.BoundedPrim' 'B.Builder's for general, IPv4 and IPv6 addresses.</span></span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="Data.IP.Builder.html#ipBuilder"><span class="hs-identifier">ipBuilder</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#ipv4Builder"><span class="hs-identifier">ipv4Builder</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#ipv6Builder"><span class="hs-identifier">ipv6Builder</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder.Prim</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder.Prim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&gt;$&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;*&lt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Word</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.IP.Addr.html"><span class="hs-identifier">Data.IP.Addr</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">------------ IP builders</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#ipBuilder"><span class="hs-pragma hs-type">ipBuilder</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-27"></span><span class="annot"><span class="hs-comment">-- | 'P.BoundedPrim' bytestring 'B.Builder' for general 'IP' addresses.</span></span><span>
</span><span id="line-28"></span><span class="annot"><a href="Data.IP.Builder.html#ipBuilder"><span class="hs-identifier hs-type">ipBuilder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IP"><span class="hs-identifier hs-type">IP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.Builder</span></span><span>
</span><span id="line-29"></span><span id="ipBuilder"><span class="annot"><span class="annottext">ipBuilder :: IP -&gt; Builder
</span><a href="Data.IP.Builder.html#ipBuilder"><span class="hs-identifier hs-var hs-var">ipBuilder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span> </span><span id="local-6989586621679071485"><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679071485"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; Builder
</span><a href="Data.IP.Builder.html#ipv4Builder"><span class="hs-identifier hs-var">ipv4Builder</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679071485"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Data.IP.Builder.html#ipBuilder"><span class="hs-identifier hs-var">ipBuilder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span> </span><span id="local-6989586621679071487"><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679071487"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv6 -&gt; Builder
</span><a href="Data.IP.Builder.html#ipv6Builder"><span class="hs-identifier hs-var">ipv6Builder</span></a></span><span> </span><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679071487"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#ipv4Builder"><span class="hs-pragma hs-type">ipv4Builder</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- | 'P.BoundedPrim' bytestring 'B.Builder' for 'IPv4' addresses.</span></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Data.IP.Builder.html#ipv4Builder"><span class="hs-identifier hs-type">ipv4Builder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.Builder</span></span><span>
</span><span id="line-35"></span><span id="ipv4Builder"><span class="annot"><span class="annottext">ipv4Builder :: IPv4 -&gt; Builder
</span><a href="Data.IP.Builder.html#ipv4Builder"><span class="hs-identifier hs-var hs-var">ipv4Builder</span></a></span></span><span> </span><span id="local-6989586621679071488"><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679071488"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32 -&gt; Word32 -&gt; Builder
forall a. BoundedPrim a -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">P.primBounded</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
</span><a href="Data.IP.Builder.html#ipv4Bounded"><span class="hs-identifier hs-var">ipv4Bounded</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Builder) -&gt; Word32 -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; Word32
</span><a href="Data.IP.Addr.html#fromIPv4w"><span class="hs-identifier hs-var">fromIPv4w</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679071488"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#ipv6Builder"><span class="hs-pragma hs-type">ipv6Builder</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-38"></span><span class="annot"><span class="hs-comment">-- | 'P.BoundedPrim' bytestring 'B.Builder' for 'IPv6' addresses.</span></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Data.IP.Builder.html#ipv6Builder"><span class="hs-identifier hs-type">ipv6Builder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.Builder</span></span><span>
</span><span id="line-40"></span><span id="ipv6Builder"><span class="annot"><span class="annottext">ipv6Builder :: IPv6 -&gt; Builder
</span><a href="Data.IP.Builder.html#ipv6Builder"><span class="hs-identifier hs-var hs-var">ipv6Builder</span></a></span></span><span> </span><span id="local-6989586621679071493"><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679071493"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundedPrim (Word32, Word32, Word32, Word32)
-&gt; (Word32, Word32, Word32, Word32) -&gt; Builder
forall a. BoundedPrim a -&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">P.primBounded</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim (Word32, Word32, Word32, Word32)
</span><a href="Data.IP.Builder.html#ipv6Bounded"><span class="hs-identifier hs-var">ipv6Bounded</span></a></span><span> </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32) -&gt; Builder)
-&gt; (Word32, Word32, Word32, Word32) -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">IPv6 -&gt; (Word32, Word32, Word32, Word32)
</span><a href="Data.IP.Addr.html#fromIPv6w"><span class="hs-identifier hs-var">fromIPv6w</span></a></span><span> </span><span class="annot"><span class="annottext">IPv6
</span><a href="#local-6989586621679071493"><span class="hs-identifier hs-var">addr</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">------------ Builder utilities</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Convert fixed to bounded for fusion</span><span>
</span><span id="line-45"></span><span id="local-6989586621679071409"><span class="annot"><a href="Data.IP.Builder.html#toB"><span class="hs-identifier hs-type">toB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.FixedPrim</span></span><span> </span><span class="annot"><a href="#local-6989586621679071409"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="annot"><a href="#local-6989586621679071409"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-46"></span><span id="toB"><span class="annot"><span class="annottext">toB :: forall a. FixedPrim a -&gt; BoundedPrim a
</span><a href="Data.IP.Builder.html#toB"><span class="hs-identifier hs-var hs-var">toB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedPrim a -&gt; BoundedPrim a
forall a. FixedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.liftFixedToBounded</span></span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#toB"><span class="hs-pragma hs-type">toB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Data.IP.Builder.html#ipv4Bounded"><span class="hs-identifier hs-type">ipv4Bounded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-50"></span><span id="ipv4Bounded"><span class="annot"><span class="annottext">ipv4Bounded :: BoundedPrim Word32
</span><a href="Data.IP.Builder.html#ipv4Bounded"><span class="hs-identifier hs-var hs-var">ipv4Bounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">Word32 -&gt; (((Word8, ()), (Word8, ())), ((Word8, ()), Word8))
</span><a href="#local-6989586621679071498"><span class="hs-identifier hs-var">quads</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; (((Word8, ()), (Word8, ())), ((Word8, ()), Word8)))
-&gt; BoundedPrim (((Word8, ()), (Word8, ())), ((Word8, ()), Word8))
-&gt; BoundedPrim Word32
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word8
</span><span class="hs-identifier hs-var">P.word8Dec</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word8 -&gt; BoundedPrim () -&gt; BoundedPrim (Word8, ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071500"><span class="hs-identifier hs-var">dotsep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim (Word8, ())
-&gt; BoundedPrim (Word8, ())
-&gt; BoundedPrim ((Word8, ()), (Word8, ()))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word8
</span><span class="hs-identifier hs-var">P.word8Dec</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word8 -&gt; BoundedPrim () -&gt; BoundedPrim (Word8, ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071500"><span class="hs-identifier hs-var">dotsep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>          </span><span class="annot"><span class="annottext">BoundedPrim ((Word8, ()), (Word8, ()))
-&gt; BoundedPrim ((Word8, ()), Word8)
-&gt; BoundedPrim (((Word8, ()), (Word8, ())), ((Word8, ()), Word8))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word8
</span><span class="hs-identifier hs-var">P.word8Dec</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word8 -&gt; BoundedPrim () -&gt; BoundedPrim (Word8, ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071500"><span class="hs-identifier hs-var">dotsep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim (Word8, ())
-&gt; BoundedPrim Word8 -&gt; BoundedPrim ((Word8, ()), Word8)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word8
</span><span class="hs-identifier hs-var">P.word8Dec</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679071498"><span class="annot"><span class="annottext">quads :: Word32 -&gt; (((Word8, ()), (Word8, ())), ((Word8, ()), Word8))
</span><a href="#local-6989586621679071498"><span class="hs-identifier hs-var hs-var">quads</span></a></span></span><span> </span><span id="local-6989586621679071501"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071501"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word32 -&gt; (Word8, ())
</span><a href="#local-6989586621679071502"><span class="hs-identifier hs-var">qdot</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0o30#</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071501"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word32 -&gt; (Word8, ())
</span><a href="#local-6989586621679071502"><span class="hs-identifier hs-var">qdot</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0o20#</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071501"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word32 -&gt; (Word8, ())
</span><a href="#local-6989586621679071502"><span class="hs-identifier hs-var">qdot</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0o10#</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071501"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word8
</span><a href="#local-6989586621679071503"><span class="hs-identifier hs-var">qfin</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071501"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071498"><span class="hs-pragma hs-type">quads</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621679071502"><span class="annot"><span class="annottext">qdot :: Int# -&gt; Word32 -&gt; (Word8, ())
</span><a href="#local-6989586621679071502"><span class="hs-identifier hs-var hs-var">qdot</span></a></span></span><span> </span><span id="local-6989586621679071504"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071504"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071506"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071506"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8# -&gt; Word8
</span><span class="hs-identifier hs-var">W8#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word8#
</span><a href="Data.IP.Builder.html#wordToWord8Compat%23"><span class="hs-identifier hs-var">wordToWord8Compat#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071506"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><span class="hs-operator hs-var">`uncheckedShiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071504"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xff##</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071502"><span class="hs-pragma hs-type">qdot</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679071503"><span class="annot"><span class="annottext">qfin :: Word32 -&gt; Word8
</span><a href="#local-6989586621679071503"><span class="hs-identifier hs-var hs-var">qfin</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071510"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071510"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word8
</span><span class="hs-identifier hs-var">W8#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word8#
</span><a href="Data.IP.Builder.html#wordToWord8Compat%23"><span class="hs-identifier hs-var">wordToWord8Compat#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071510"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xff##</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071503"><span class="hs-pragma hs-type">qfin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679071500"><span class="annot"><span class="annottext">dotsep :: BoundedPrim b
</span><a href="#local-6989586621679071500"><span class="hs-identifier hs-var hs-var">dotsep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; b -&gt; Word8
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x2e</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Word8) -&gt; BoundedPrim Word8 -&gt; BoundedPrim b
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">FixedPrim Word8 -&gt; BoundedPrim Word8
forall a. FixedPrim a -&gt; BoundedPrim a
</span><a href="Data.IP.Builder.html#toB"><span class="hs-identifier hs-var">toB</span></a></span><span> </span><span class="annot"><span class="annottext">FixedPrim Word8
</span><span class="hs-identifier hs-var">P.word8</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | For each 32-bit chunk of an IPv6 address, encode its display format in the</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- presentation form of the address, based on its location relative to the</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &quot;best gap&quot;, i.e. the left-most longest run of zeros. The &quot;hi&quot; (H) and/or</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &quot;lo&quot; (L) 16 bits may be accompanied by colons (C) on the left and/or right.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="FF"><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-var">FF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CHL"><span class="annot"><a href="Data.IP.Builder.html#CHL"><span class="hs-identifier hs-var">CHL</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ :&lt;h&gt;:&lt;l&gt;</span></span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="HL"><span class="annot"><a href="Data.IP.Builder.html#HL"><span class="hs-identifier hs-var">HL</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^  &lt;h&gt;:&lt;l&gt;</span></span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="NOP"><span class="annot"><a href="Data.IP.Builder.html#NOP"><span class="hs-identifier hs-var">NOP</span></a></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^  nop</span></span><span>
</span><span id="line-70"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="COL"><span class="annot"><a href="Data.IP.Builder.html#COL"><span class="hs-identifier hs-var">COL</span></a></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ :</span></span><span>
</span><span id="line-71"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="CC"><span class="annot"><a href="Data.IP.Builder.html#CC"><span class="hs-identifier hs-var">CC</span></a></span></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ :   :</span></span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="CLO"><span class="annot"><a href="Data.IP.Builder.html#CLO"><span class="hs-identifier hs-var">CLO</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^     :&lt;l&gt;</span></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="CHC"><span class="annot"><a href="Data.IP.Builder.html#CHC"><span class="hs-identifier hs-var">CHC</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ :&lt;h&gt;:</span></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="HC"><span class="annot"><a href="Data.IP.Builder.html#HC"><span class="hs-identifier hs-var">HC</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^  &lt;h&gt;:</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Build an IPv6 address in conformance with</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- [RFC5952](http://tools.ietf.org/html/rfc5952 RFC 5952).</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Data.IP.Builder.html#ipv6Bounded"><span class="hs-identifier hs-type">ipv6Bounded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="ipv6Bounded"><span class="annot"><span class="annottext">ipv6Bounded :: BoundedPrim (Word32, Word32, Word32, Word32)
</span><a href="Data.IP.Builder.html#ipv6Bounded"><span class="hs-identifier hs-var hs-var">ipv6Bounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32) -&gt; Bool)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="annot"><span class="annottext">(Word32, Word32, Word32, Word32) -&gt; Bool
</span><a href="#local-6989586621679071525"><span class="hs-identifier hs-var">generalCase</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Word32, Word32, Word32, Word32) -&gt; ((FF, FF), (FF, FF))
</span><a href="#local-6989586621679071526"><span class="hs-identifier hs-var">genFields</span></a></span><span> </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32) -&gt; ((FF, FF), (FF, FF)))
-&gt; BoundedPrim ((FF, FF), (FF, FF))
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ((FF, FF), (FF, FF))
</span><a href="#local-6989586621679071527"><span class="hs-identifier hs-var">output128</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32) -&gt; Bool)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="annot"><span class="annottext">(Word32, Word32, Word32, Word32) -&gt; Bool
</span><a href="#local-6989586621679071528"><span class="hs-identifier hs-var">v4mapped</span></a></span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Word32, Word32, Word32, Word32)
-&gt; ((Word32, Word32), (Word32, Word32))
forall {a} {b} {a} {b}. (a, b, a, b) -&gt; ((a, b), (a, b))
</span><a href="#local-6989586621679071529"><span class="hs-identifier hs-var">pairPair</span></a></span><span> </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32)
 -&gt; ((Word32, Word32), (Word32, Word32)))
-&gt; BoundedPrim ((Word32, Word32), (Word32, Word32))
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
-&gt; BoundedPrim Word32 -&gt; BoundedPrim (Word32, Word32)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                     </span><span class="annot"><span class="annottext">BoundedPrim (Word32, Word32)
-&gt; BoundedPrim (Word32, Word32)
-&gt; BoundedPrim ((Word32, Word32), (Word32, Word32))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071531"><span class="hs-identifier hs-var">ffff</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
-&gt; BoundedPrim Word32 -&gt; BoundedPrim (Word32, Word32)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; ((), Word32)
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; ((), Word32))
-&gt; BoundedPrim ((), Word32) -&gt; BoundedPrim Word32
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim Word32 -&gt; BoundedPrim ((), Word32)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
</span><a href="Data.IP.Builder.html#ipv4Bounded"><span class="hs-identifier hs-var">ipv4Bounded</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Word32, Word32, Word32, Word32)
-&gt; ((Word32, Word32), (Word32, Word32))
forall {a} {b} {a} {b}. (a, b, a, b) -&gt; ((a, b), (a, b))
</span><a href="#local-6989586621679071529"><span class="hs-identifier hs-var">pairPair</span></a></span><span> </span><span class="annot"><span class="annottext">((Word32, Word32, Word32, Word32)
 -&gt; ((Word32, Word32), (Word32, Word32)))
-&gt; BoundedPrim ((Word32, Word32), (Word32, Word32))
-&gt; BoundedPrim (Word32, Word32, Word32, Word32)
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><span class="hs-identifier hs-var">P.emptyB</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
-&gt; BoundedPrim Word32 -&gt; BoundedPrim (Word32, Word32)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim (Word32, Word32)
-&gt; BoundedPrim (Word32, Word32)
-&gt; BoundedPrim ((Word32, Word32), (Word32, Word32))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim Word32
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
-&gt; BoundedPrim Word32 -&gt; BoundedPrim (Word32, Word32)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word32
</span><a href="Data.IP.Builder.html#ipv4Bounded"><span class="hs-identifier hs-var">ipv4Bounded</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- The boundedPrim switches and predicates need to be inlined for best</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- performance, gaining a factor of ~2 in throughput in tests.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071527"><span class="hs-pragma hs-type">output128</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071534"><span class="hs-pragma hs-type">output64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071525"><span class="hs-pragma hs-type">generalCase</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071528"><span class="hs-pragma hs-type">v4mapped</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071535"><span class="hs-pragma hs-type">output32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="#local-6989586621679071525"><span class="hs-identifier hs-type">generalCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679071525"><span class="annot"><span class="annottext">generalCase :: (Word32, Word32, Word32, Word32) -&gt; Bool
</span><a href="#local-6989586621679071525"><span class="hs-identifier hs-var hs-var">generalCase</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071536"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071536"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071537"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071537"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071538"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071538"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071539"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071539"><span class="hs-identifier hs-var">w3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071536"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071537"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071538"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xffff</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071538"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071539"><span class="hs-identifier hs-var">w3</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xffff</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="#local-6989586621679071528"><span class="hs-identifier hs-type">v4mapped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679071528"><span class="annot"><span class="annottext">v4mapped :: (Word32, Word32, Word32, Word32) -&gt; Bool
</span><a href="#local-6989586621679071528"><span class="hs-identifier hs-var hs-var">v4mapped</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071544"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071544"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071545"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071545"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071546"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071546"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071544"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071545"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071546"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xffff</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- BoundedPrim for the full 128-bit IPv6 address given as</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- a pair of pairs of FF values, which encode the</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- output format of each of the 32-bit chunks.</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="#local-6989586621679071527"><span class="hs-identifier hs-type">output128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-type">FF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-type">FF</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-type">FF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-type">FF</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679071527"><span class="annot"><span class="annottext">output128 :: BoundedPrim ((FF, FF), (FF, FF))
</span><a href="#local-6989586621679071527"><span class="hs-identifier hs-var hs-var">output128</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundedPrim (FF, FF)
</span><a href="#local-6989586621679071534"><span class="hs-identifier hs-var">output64</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim (FF, FF)
-&gt; BoundedPrim (FF, FF) -&gt; BoundedPrim ((FF, FF), (FF, FF))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim (FF, FF)
</span><a href="#local-6989586621679071534"><span class="hs-identifier hs-var">output64</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679071534"><span class="annot"><span class="annottext">output64 :: BoundedPrim (FF, FF)
</span><a href="#local-6989586621679071534"><span class="hs-identifier hs-var hs-var">output64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071535"><span class="hs-identifier hs-var">output32</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim (FF, FF)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071535"><span class="hs-identifier hs-var">output32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- And finally the per-word case-work.</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="#local-6989586621679071535"><span class="hs-identifier hs-type">output32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="annot"><a href="Data.IP.Builder.html#FF"><span class="hs-identifier hs-type">FF</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679071535"><span class="annot"><span class="annottext">output32 :: BoundedPrim FF
</span><a href="#local-6989586621679071535"><span class="hs-identifier hs-var hs-var">output32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CHL"><span class="hs-identifier hs-type">CHL</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071548"><span class="hs-identifier hs-var">build_CHL</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- :hi:lo</span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#HL"><span class="hs-identifier hs-type">HL</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071549"><span class="hs-identifier hs-var">build_HL</span></a></span><span>  </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">--  hi:lo</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#NOP"><span class="hs-identifier hs-var">NOP</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071550"><span class="hs-identifier hs-var">build_NOP</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#COL"><span class="hs-identifier hs-var">COL</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071551"><span class="hs-identifier hs-var">build_COL</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- :</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#CC"><span class="hs-identifier hs-var">CC</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071552"><span class="hs-identifier hs-var">build_CC</span></a></span><span>  </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- :  :</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CLO"><span class="hs-identifier hs-type">CLO</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071553"><span class="hs-identifier hs-var">build_CLO</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">--    :lo</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">(FF -&gt; Bool) -&gt; BoundedPrim FF -&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a.
(a -&gt; Bool) -&gt; BoundedPrim a -&gt; BoundedPrim a -&gt; BoundedPrim a
</span><span class="hs-identifier hs-var">P.condB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CHC"><span class="hs-identifier hs-type">CHC</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071554"><span class="hs-identifier hs-var">build_CHC</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundedPrim FF -&gt; BoundedPrim FF)
-&gt; BoundedPrim FF -&gt; BoundedPrim FF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-comment">-- :hi:</span><span>
</span><span id="line-124"></span><span>                                                      </span><span class="annot"><span class="annottext">BoundedPrim FF
</span><a href="#local-6989586621679071555"><span class="hs-identifier hs-var">build_HC</span></a></span><span>    </span><span class="hs-comment">--  hi:</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- encoders for the eight field format (FF) cases.</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679071548"><span class="annot"><span class="annottext">build_CHL :: BoundedPrim FF
</span><a href="#local-6989586621679071548"><span class="hs-identifier hs-var hs-var">build_CHL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CHL"><span class="hs-identifier hs-type">CHL</span></a></span><span> </span><span id="local-6989586621679071562"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071562"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ((), Word16)
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071563"><span class="hs-identifier hs-var">hi16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071562"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ((), Word16)
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071564"><span class="hs-identifier hs-var">lo16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071562"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                         </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(((), Word16), ((), Word16))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                </span><span class="annot"><span class="annottext">(FF -&gt; (((), Word16), ((), Word16)))
-&gt; BoundedPrim (((), Word16), ((), Word16)) -&gt; BoundedPrim FF
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim Word16 -&gt; BoundedPrim ((), Word16)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                </span><span class="annot"><span class="annottext">BoundedPrim ((), Word16)
-&gt; BoundedPrim ((), Word16)
-&gt; BoundedPrim (((), Word16), ((), Word16))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim Word16 -&gt; BoundedPrim ((), Word16)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679071549"><span class="annot"><span class="annottext">build_HL :: BoundedPrim FF
</span><a href="#local-6989586621679071549"><span class="hs-identifier hs-var hs-var">build_HL</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#HL"><span class="hs-identifier hs-type">HL</span></a></span><span>  </span><span id="local-6989586621679071572"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071572"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071563"><span class="hs-identifier hs-var">hi16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071572"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ((), Word16)
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071564"><span class="hs-identifier hs-var">lo16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071572"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                         </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word16, ((), Word16))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                </span><span class="annot"><span class="annottext">(FF -&gt; (Word16, ((), Word16)))
-&gt; BoundedPrim (Word16, ((), Word16)) -&gt; BoundedPrim FF
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
-&gt; BoundedPrim ((), Word16) -&gt; BoundedPrim (Word16, ((), Word16))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim Word16 -&gt; BoundedPrim ((), Word16)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679071550"><span class="annot"><span class="annottext">build_NOP :: BoundedPrim a
</span><a href="#local-6989586621679071550"><span class="hs-identifier hs-var hs-var">build_NOP</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundedPrim a
forall {b}. BoundedPrim b
</span><span class="hs-identifier hs-var">P.emptyB</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679071551"><span class="annot"><span class="annottext">build_COL :: BoundedPrim b
</span><a href="#local-6989586621679071551"><span class="hs-identifier hs-var hs-var">build_COL</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; b -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; ()) -&gt; BoundedPrim () -&gt; BoundedPrim b
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679071552"><span class="annot"><span class="annottext">build_CC :: BoundedPrim b
</span><a href="#local-6989586621679071552"><span class="hs-identifier hs-var hs-var">build_CC</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((), ()) -&gt; b -&gt; ((), ())
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; ((), ())) -&gt; BoundedPrim ((), ()) -&gt; BoundedPrim b
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim () -&gt; BoundedPrim ((), ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679071553"><span class="annot"><span class="annottext">build_CLO :: BoundedPrim FF
</span><a href="#local-6989586621679071553"><span class="hs-identifier hs-var hs-var">build_CLO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CLO"><span class="hs-identifier hs-type">CLO</span></a></span><span> </span><span id="local-6989586621679071580"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071580"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ((), Word16)
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071564"><span class="hs-identifier hs-var">lo16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071580"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                         </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((), Word16)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                </span><span class="annot"><span class="annottext">(FF -&gt; ((), Word16)) -&gt; BoundedPrim ((), Word16) -&gt; BoundedPrim FF
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; BoundedPrim Word16 -&gt; BoundedPrim ((), Word16)
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679071554"><span class="annot"><span class="annottext">build_CHC :: BoundedPrim FF
</span><a href="#local-6989586621679071554"><span class="hs-identifier hs-var hs-var">build_CHC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#CHC"><span class="hs-identifier hs-type">CHC</span></a></span><span> </span><span id="local-6989586621679071586"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071586"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word16, ()) -&gt; ((), (Word16, ()))
forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var">fstUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; (Word16, ())
forall a. a -&gt; (a, ())
</span><a href="#local-6989586621679071587"><span class="hs-identifier hs-var">sndUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071563"><span class="hs-identifier hs-var">hi16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071586"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>                         </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((), (Word16, ()))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                </span><span class="annot"><span class="annottext">(FF -&gt; ((), (Word16, ())))
-&gt; BoundedPrim ((), (Word16, ())) -&gt; BoundedPrim FF
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
-&gt; BoundedPrim (Word16, ()) -&gt; BoundedPrim ((), (Word16, ()))
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16 -&gt; BoundedPrim () -&gt; BoundedPrim (Word16, ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679071555"><span class="annot"><span class="annottext">build_HC :: BoundedPrim FF
</span><a href="#local-6989586621679071555"><span class="hs-identifier hs-var hs-var">build_HC</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#HC"><span class="hs-identifier hs-type">HC</span></a></span><span>  </span><span id="local-6989586621679071592"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071592"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; (Word16, ())
forall a. a -&gt; (a, ())
</span><a href="#local-6989586621679071587"><span class="hs-identifier hs-var">sndUnit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word16
</span><a href="#local-6989586621679071563"><span class="hs-identifier hs-var">hi16</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071592"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                         </span><span class="annot"><span class="annottext">FF
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word16, ())
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                </span><span class="annot"><span class="annottext">(FF -&gt; (Word16, ())) -&gt; BoundedPrim (Word16, ()) -&gt; BoundedPrim FF
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16
</span><span class="hs-identifier hs-var">P.word16Hex</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim Word16 -&gt; BoundedPrim () -&gt; BoundedPrim (Word16, ())
forall (f :: * -&gt; *) a b. Monoidal f =&gt; f a -&gt; f b -&gt; f (a, b)
</span><span class="hs-operator hs-var">&gt;*&lt;</span></span><span> </span><span class="annot"><span class="annottext">BoundedPrim ()
forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var">colsep</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- static encoders</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679071593"><span class="annot"><a href="#local-6989586621679071530"><span class="hs-identifier hs-type">colsep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="annot"><a href="#local-6989586621679071593"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679071530"><span class="annot"><span class="annottext">colsep :: forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071530"><span class="hs-identifier hs-var hs-var">colsep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedPrim a -&gt; BoundedPrim a
forall a. FixedPrim a -&gt; BoundedPrim a
</span><a href="Data.IP.Builder.html#toB"><span class="hs-identifier hs-var">toB</span></a></span><span> </span><span class="annot"><span class="annottext">(FixedPrim a -&gt; BoundedPrim a) -&gt; FixedPrim a -&gt; BoundedPrim a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; Word8
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x3a</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Word8) -&gt; FixedPrim Word8 -&gt; FixedPrim a
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">FixedPrim Word8
</span><span class="hs-identifier hs-var">P.word8</span></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679071597"><span class="annot"><a href="#local-6989586621679071531"><span class="hs-identifier hs-type">ffff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">P.BoundedPrim</span></span><span> </span><span class="annot"><a href="#local-6989586621679071597"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679071531"><span class="annot"><span class="annottext">ffff :: forall {b}. BoundedPrim b
</span><a href="#local-6989586621679071531"><span class="hs-identifier hs-var hs-var">ffff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FixedPrim a -&gt; BoundedPrim a
forall a. FixedPrim a -&gt; BoundedPrim a
</span><a href="Data.IP.Builder.html#toB"><span class="hs-identifier hs-var">toB</span></a></span><span> </span><span class="annot"><span class="annottext">(FixedPrim a -&gt; BoundedPrim a) -&gt; FixedPrim a -&gt; BoundedPrim a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; a -&gt; Word16
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0xffff</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Word16) -&gt; FixedPrim Word16 -&gt; FixedPrim a
forall (f :: * -&gt; *) b a. Contravariant f =&gt; (b -&gt; a) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&gt;$&lt;</span></span><span> </span><span class="annot"><span class="annottext">FixedPrim Word16
</span><span class="hs-identifier hs-var">P.word16HexFixed</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- | Helpers</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="#local-6989586621679071563"><span class="hs-identifier hs-type">hi16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679071564"><span class="hs-identifier hs-type">lo16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679071563"><span class="annot"><span class="annottext">hi16 :: Word32 -&gt; Word16
</span><a href="#local-6989586621679071563"><span class="hs-identifier hs-var hs-var">hi16</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071602"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071602"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16# -&gt; Word16
</span><span class="hs-identifier hs-var">W16#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word16#
</span><a href="Data.IP.Builder.html#wordToWord16Compat%23"><span class="hs-identifier hs-var">wordToWord16Compat#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071602"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><span class="hs-operator hs-var">`uncheckedShiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">16#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679071564"><span class="annot"><span class="annottext">lo16 :: Word32 -&gt; Word16
</span><a href="#local-6989586621679071564"><span class="hs-identifier hs-var hs-var">lo16</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071605"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071605"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16# -&gt; Word16
</span><span class="hs-identifier hs-var">W16#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word16#
</span><a href="Data.IP.Builder.html#wordToWord16Compat%23"><span class="hs-identifier hs-var">wordToWord16Compat#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071605"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff##</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679071427"><span class="annot"><a href="#local-6989586621679071532"><span class="hs-identifier hs-type">fstUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679071427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679071532"><span class="annot"><span class="annottext">fstUnit :: forall a. a -&gt; ((), a)
</span><a href="#local-6989586621679071532"><span class="hs-identifier hs-var hs-var">fstUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679071436"><span class="annot"><a href="#local-6989586621679071587"><span class="hs-identifier hs-type">sndUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679071436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679071436"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679071587"><span class="annot"><span class="annottext">sndUnit :: forall a. a -&gt; (a, ())
</span><a href="#local-6989586621679071587"><span class="hs-identifier hs-var hs-var">sndUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679071529"><span class="annot"><span class="annottext">pairPair :: (a, b, a, b) -&gt; ((a, b), (a, b))
</span><a href="#local-6989586621679071529"><span class="hs-identifier hs-var hs-var">pairPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071606"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071606"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071607"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071607"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071608"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071608"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071609"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071609"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071606"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071607"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679071608"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679071609"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-comment">-- Construct fields decorated with output format details</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679071526"><span class="annot"><span class="annottext">genFields :: (Word32, Word32, Word32, Word32) -&gt; ((FF, FF), (FF, FF))
</span><a href="#local-6989586621679071526"><span class="hs-identifier hs-var hs-var">genFields</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679071610"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071610"><span class="hs-identifier hs-var">w0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071611"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071611"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071612"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071612"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679071613"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071613"><span class="hs-identifier hs-var">w3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679071614"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071614"><span class="hs-identifier hs-var">gapStart</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679071615"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071615"><span class="hs-identifier hs-var">gapEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (Int, Int)
</span><a href="Data.IP.Builder.html#bestgap"><span class="hs-identifier hs-var">bestgap</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071610"><span class="hs-identifier hs-var">w0</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071611"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071612"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071613"><span class="hs-identifier hs-var">w3</span></a></span><span>
</span><span id="line-179"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621679071617"><span class="annot"><span class="annottext">f0 :: FF
</span><a href="#local-6989586621679071617"><span class="hs-identifier hs-var hs-var">f0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071618"><span class="hs-identifier hs-var">makeF0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071614"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071615"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071610"><span class="hs-identifier hs-var">w0</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621679071619"><span class="annot"><span class="annottext">f1 :: FF
</span><a href="#local-6989586621679071619"><span class="hs-identifier hs-var hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int# -&gt; Int# -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071620"><span class="hs-identifier hs-var">makeF12</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071614"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071615"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071611"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621679071621"><span class="annot"><span class="annottext">f2 :: FF
</span><a href="#local-6989586621679071621"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int# -&gt; Int# -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071620"><span class="hs-identifier hs-var">makeF12</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071614"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071615"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">4#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">5#</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071612"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-glyph">!</span><span id="local-6989586621679071622"><span class="annot"><span class="annottext">f3 :: FF
</span><a href="#local-6989586621679071622"><span class="hs-identifier hs-var hs-var">f3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071623"><span class="hs-identifier hs-var">makeF3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071614"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679071615"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071613"><span class="hs-identifier hs-var">w3</span></a></span><span>
</span><span id="line-183"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FF
</span><a href="#local-6989586621679071617"><span class="hs-identifier hs-var">f0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="#local-6989586621679071619"><span class="hs-identifier hs-var">f1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FF
</span><a href="#local-6989586621679071621"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="#local-6989586621679071622"><span class="hs-identifier hs-var">f3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679071618"><span class="annot"><span class="annottext">makeF0 :: Int -&gt; Int -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071618"><span class="hs-identifier hs-var hs-var">makeF0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071624"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071624"><span class="hs-identifier hs-var">gapStart</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071625"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071625"><span class="hs-identifier hs-var">gapEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679071626"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071626"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071625"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`orI#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071624"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&gt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#HL"><span class="hs-identifier hs-var">HL</span></a></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071626"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071624"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>              </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#COL"><span class="hs-identifier hs-var">COL</span></a></span><span>
</span><span id="line-190"></span><span>              </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#HC"><span class="hs-identifier hs-var">HC</span></a></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071626"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071618"><span class="hs-pragma hs-type">makeF0</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679071620"><span class="annot"><span class="annottext">makeF12 :: Int -&gt; Int -&gt; Int# -&gt; Int# -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071620"><span class="hs-identifier hs-var hs-var">makeF12</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071627"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071627"><span class="hs-identifier hs-var">gapStart</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071628"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071628"><span class="hs-identifier hs-var">gapEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679071629"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071629"><span class="hs-identifier hs-var">il</span></a></span></span><span> </span><span id="local-6989586621679071630"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071630"><span class="hs-identifier hs-var">ir</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679071631"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071631"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071628"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071629"><span class="hs-identifier hs-var">il</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`orI#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071627"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&gt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071630"><span class="hs-identifier hs-var">ir</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#CHL"><span class="hs-identifier hs-var">CHL</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071631"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071627"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&gt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071629"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-197"></span><span>             </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071627"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071629"><span class="hs-identifier hs-var">il</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#COL"><span class="hs-identifier hs-var">COL</span></a></span><span>
</span><span id="line-199"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#CHC"><span class="hs-identifier hs-var">CHC</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071631"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-200"></span><span>             </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071628"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071630"><span class="hs-identifier hs-var">ir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-201"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#NOP"><span class="hs-identifier hs-var">NOP</span></a></span><span>
</span><span id="line-202"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#CLO"><span class="hs-identifier hs-var">CLO</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071631"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071620"><span class="hs-pragma hs-type">makeF12</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621679071623"><span class="annot"><span class="annottext">makeF3 :: Int -&gt; Int -&gt; Word32 -&gt; FF
</span><a href="#local-6989586621679071623"><span class="hs-identifier hs-var hs-var">makeF3</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071632"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071632"><span class="hs-identifier hs-var">gapStart</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">I#</span></span><span> </span><span id="local-6989586621679071633"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071633"><span class="hs-identifier hs-var">gapEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679071634"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071634"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071633"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;=#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#CHL"><span class="hs-identifier hs-var">CHL</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071634"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071632"><span class="hs-identifier hs-var">gapStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-209"></span><span>             </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071633"><span class="hs-identifier hs-var">gapEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">==#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#COL"><span class="hs-identifier hs-var">COL</span></a></span><span>
</span><span id="line-211"></span><span>                   </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; FF
</span><a href="Data.IP.Builder.html#CLO"><span class="hs-identifier hs-var">CLO</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679071634"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-212"></span><span>             </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FF
</span><a href="Data.IP.Builder.html#CC"><span class="hs-identifier hs-var">CC</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679071623"><span class="hs-pragma hs-type">makeF3</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Unrolled and inlined calculation of the first longest</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- run (gap) of 16-bit aligned zeros in the input address.</span><span>
</span><span id="line-217"></span><span class="hs-comment">--</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Data.IP.Builder.html#bestgap"><span class="hs-identifier hs-type">bestgap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="bestgap"><span class="annot"><span class="annottext">bestgap :: Word32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (Int, Int)
</span><a href="Data.IP.Builder.html#bestgap"><span class="hs-identifier hs-var hs-var">bestgap</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071635"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071635"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071636"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071636"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071637"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071637"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W32#</span></span><span> </span><span id="local-6989586621679071638"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071638"><span class="hs-identifier hs-var">a3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">Int# -&gt; (Int, Int)
</span><a href="#local-6989586621679071639"><span class="hs-identifier hs-var">finalGap</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff##</span></span><span>     </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071638"><span class="hs-identifier hs-var">a3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff0000##</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071638"><span class="hs-identifier hs-var">a3</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff##</span></span><span>     </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071637"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff0000##</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071637"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff##</span></span><span>     </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071636"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff0000##</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071636"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var">updateGap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff##</span></span><span>     </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071635"><span class="hs-identifier hs-var">a0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="#local-6989586621679071641"><span class="hs-identifier hs-var">initGap</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xffff0000##</span></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><span class="hs-operator hs-var">`and#`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var">word32ToWordCompat#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679071635"><span class="hs-identifier hs-var">a0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- The state after the first input word is always i' = 7,</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- but if the input word is zero, then also g=z=1 and e'=7.</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="#local-6989586621679071641"><span class="hs-identifier hs-type">initGap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679071641"><span class="annot"><span class="annottext">initGap :: Word# -&gt; Int#
</span><a href="#local-6989586621679071641"><span class="hs-identifier hs-var hs-var">initGap</span></a></span></span><span> </span><span id="local-6989586621679071642"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679071642"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679071642"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x1717#</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x0707#</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- Update the nibbles of g|e'|z|i' based on the next input</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">-- word.  We always decrement i', reset z on non-zero input,</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-comment">-- otherwise increment z and check for a new best gap, if so</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-comment">-- we replace g|e' with z|i'.</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="#local-6989586621679071640"><span class="hs-identifier hs-type">updateGap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679071640"><span class="annot"><span class="annottext">updateGap :: Word# -&gt; Int# -&gt; Int#
</span><a href="#local-6989586621679071640"><span class="hs-identifier hs-var hs-var">updateGap</span></a></span></span><span> </span><span id="local-6989586621679071643"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679071643"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679071644"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071644"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679071643"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><span class="hs-operator hs-var">`neWord#`</span></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071644"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">+#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xffff#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`andI#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xff0f#</span></span><span>  </span><span class="hs-comment">-- g, e, 0, --i</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071645"><span class="annot"><span class="annottext">old :: Int#
</span><a href="#local-6989586621679071645"><span class="hs-identifier hs-var hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071644"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">+#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xf#</span></span><span>             </span><span class="hs-comment">-- ++z, --i</span><span>
</span><span id="line-244"></span><span>                  </span><span id="local-6989586621679071646"><span class="annot"><span class="annottext">zi :: Int#
</span><a href="#local-6989586621679071646"><span class="hs-identifier hs-var hs-var">zi</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071645"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`andI#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xff#</span></span><span>
</span><span id="line-245"></span><span>                  </span><span id="local-6989586621679071647"><span class="annot"><span class="annottext">new :: Int#
</span><a href="#local-6989586621679071647"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071646"><span class="hs-identifier hs-var">zi</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`orI#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071646"><span class="hs-identifier hs-var">zi</span></a></span><span>
</span><span id="line-246"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071647"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&gt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071645"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-247"></span><span>                  </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071647"><span class="hs-identifier hs-var">new</span></a></span><span>            </span><span class="hs-comment">-- z, i, z, i</span><span>
</span><span id="line-248"></span><span>                  </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071645"><span class="hs-identifier hs-var">old</span></a></span><span>            </span><span class="hs-comment">-- g, e, z, i</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">-- Extract gap start and end from the nibbles of g|e'|z|i'</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- where g is the gap width and e' is 8 minus its end.</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="#local-6989586621679071639"><span class="hs-identifier hs-type">finalGap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679071639"><span class="annot"><span class="annottext">finalGap :: Int# -&gt; (Int, Int)
</span><a href="#local-6989586621679071639"><span class="hs-identifier hs-var hs-var">finalGap</span></a></span></span><span> </span><span id="local-6989586621679071648"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071648"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071649"><span class="annot"><span class="annottext">g :: Int#
</span><a href="#local-6989586621679071649"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071648"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">12#</span></span><span>
</span><span id="line-255"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071649"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">&lt;#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679071650"><span class="annot"><span class="annottext">e :: Int#
</span><a href="#local-6989586621679071650"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">-#</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071648"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">`andI#`</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xf#</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>                      </span><span id="local-6989586621679071651"><span class="annot"><span class="annottext">s :: Int#
</span><a href="#local-6989586621679071651"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071650"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><span class="hs-operator hs-var">-#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071649"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-259"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071651"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><span class="hs-identifier hs-var">I#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679071650"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.IP.Builder.html#bestgap"><span class="hs-pragma hs-type">bestgap</span></a></span><span> </span><span class="hs-pragma">#-}</span><span class="hs-cpp">

#if MIN_VERSION_base(4,16,0)
</span><span class="annot"><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-type">word32ToWordCompat#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span>
</span><span id="line-264"></span><span id="word32ToWordCompat%23"><span class="annot"><span class="annottext">word32ToWordCompat# :: Word32# -&gt; Word#
</span><a href="Data.IP.Builder.html#word32ToWordCompat%23"><span class="hs-identifier hs-var hs-var">word32ToWordCompat#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><span class="hs-identifier hs-var">word32ToWord#</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Data.IP.Builder.html#wordToWord8Compat%23"><span class="hs-identifier hs-type">wordToWord8Compat#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8#</span></span><span>
</span><span id="line-267"></span><span id="wordToWord8Compat%23"><span class="annot"><span class="annottext">wordToWord8Compat# :: Word# -&gt; Word8#
</span><a href="Data.IP.Builder.html#wordToWord8Compat%23"><span class="hs-identifier hs-var hs-var">wordToWord8Compat#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word8#
</span><span class="hs-identifier hs-var">wordToWord8#</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Data.IP.Builder.html#wordToWord16Compat%23"><span class="hs-identifier hs-type">wordToWord16Compat#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16#</span></span><span>
</span><span id="line-270"></span><span id="wordToWord16Compat%23"><span class="annot"><span class="annottext">wordToWord16Compat# :: Word# -&gt; Word16#
</span><a href="Data.IP.Builder.html#wordToWord16Compat%23"><span class="hs-identifier hs-var hs-var">wordToWord16Compat#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word16#
</span><span class="hs-identifier hs-var">wordToWord16#</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">word32ToWordCompat#</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word#</span><span>
</span><span id="line-273"></span><span class="hs-identifier">word32ToWordCompat#</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-identifier">wordToWord8Compat#</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word#</span><span>
</span><span id="line-276"></span><span class="hs-identifier">wordToWord8Compat#</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-identifier">wordToWord16Compat#</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word#</span><span>
</span><span id="line-279"></span><span class="hs-identifier">wordToWord16Compat#</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span class="hs-cpp">
#endif
</span></pre></body></html>