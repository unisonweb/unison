<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.IP.Op</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Addr.html"><span class="hs-identifier">Data.IP.Addr</span></a></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Mask.html"><span class="hs-identifier">Data.IP.Mask</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.IP.Range.html"><span class="hs-identifier">Data.IP.Range</span></a></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="annot"><span class="hs-comment">{-|

&gt;&gt;&gt; toIPv4 [127,0,2,1] `masked` intToMask 7
126.0.0.0
-}</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Addr"><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-var">Addr</span></a></span></span><span> </span><span id="local-6989586621679072411"><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-comment">{-|
      The 'masked' function takes an 'Addr' and a contiguous
      mask and returned a masked 'Addr'.
    -}</span><span>
</span><span id="line-20"></span><span>    </span><span id="masked"><span class="annot"><a href="Data.IP.Op.html#masked"><span class="hs-identifier hs-type">masked</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-comment">{-|

      The 'intToMask' function takes an 'Int' representing the number of bits to
      be set in the returned contiguous mask. When this integer is positive the
      bits will be starting from the MSB and from the LSB otherwise.

      &gt;&gt;&gt; intToMask 16 :: IPv4
      255.255.0.0

      &gt;&gt;&gt; intToMask (-16) :: IPv4
      0.0.255.255

      &gt;&gt;&gt; intToMask 16 :: IPv6
      ffff::

      &gt;&gt;&gt; intToMask (-16) :: IPv6
      ::ffff

    -}</span><span>
</span><span id="line-40"></span><span>    </span><span id="intToMask"><span class="annot"><a href="Data.IP.Op.html#intToMask"><span class="hs-identifier hs-type">intToMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679072411"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679072449"><span class="annot"><span class="annottext">masked :: IPv4 -&gt; IPv4 -&gt; IPv4
</span><a href="Data.IP.Op.html#masked"><span class="hs-identifier hs-var hs-var hs-var hs-var">masked</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; IPv4 -&gt; IPv4
</span><a href="Data.IP.Range.html#maskedIPv4"><span class="hs-identifier hs-var">maskedIPv4</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679072451"><span class="annot"><span class="annottext">intToMask :: Int -&gt; IPv4
</span><a href="Data.IP.Op.html#intToMask"><span class="hs-identifier hs-var hs-var hs-var hs-var">intToMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IPv4
</span><a href="Data.IP.Mask.html#maskIPv4"><span class="hs-identifier hs-var">maskIPv4</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679072458"><span class="annot"><span class="annottext">masked :: IPv6 -&gt; IPv6 -&gt; IPv6
</span><a href="Data.IP.Op.html#masked"><span class="hs-identifier hs-var hs-var hs-var hs-var">masked</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv6 -&gt; IPv6 -&gt; IPv6
</span><a href="Data.IP.Range.html#maskedIPv6"><span class="hs-identifier hs-var">maskedIPv6</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679072460"><span class="annot"><span class="annottext">intToMask :: Int -&gt; IPv6
</span><a href="Data.IP.Op.html#intToMask"><span class="hs-identifier hs-var hs-var hs-var hs-var">intToMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IPv6
</span><a href="Data.IP.Mask.html#maskIPv6"><span class="hs-identifier hs-var">maskIPv6</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">{-|
  The &gt;:&gt; operator takes two 'AddrRange'. It returns 'True' if
  the first 'AddrRange' contains the second 'AddrRange'. Otherwise,
  it returns 'False'.

&gt;&gt;&gt; makeAddrRange (&quot;127.0.2.1&quot; :: IPv4) 8 &gt;:&gt; makeAddrRange &quot;127.0.2.1&quot; 24
True
&gt;&gt;&gt; makeAddrRange (&quot;127.0.2.1&quot; :: IPv4) 24 &gt;:&gt; makeAddrRange &quot;127.0.2.1&quot; 8
False
&gt;&gt;&gt; makeAddrRange (&quot;2001:DB8::1&quot; :: IPv6) 16 &gt;:&gt; makeAddrRange &quot;2001:DB8::1&quot; 32
True
&gt;&gt;&gt; makeAddrRange (&quot;2001:DB8::1&quot; :: IPv6) 32 &gt;:&gt; makeAddrRange &quot;2001:DB8::1&quot; 16
False
-}</span></span><span>
</span><span id="line-66"></span><span id="local-6989586621679072413"><span class="annot"><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-type">(&gt;:&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072413"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072413"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072413"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-67"></span><span id="local-6989586621679072470"><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072470"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%3E%3A%3E"><span class="annot"><span class="annottext">&gt;:&gt; :: forall a. Addr a =&gt; AddrRange a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#%3E%3A%3E"><span class="hs-operator hs-var hs-var">&gt;:&gt;</span></a></span></span><span> </span><span id="local-6989586621679072471"><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072471"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; Int
forall a. AddrRange a -&gt; Int
</span><a href="Data.IP.Range.html#mlen"><span class="hs-identifier hs-var">mlen</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072470"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; Int
forall a. AddrRange a -&gt; Int
</span><a href="Data.IP.Range.html#mlen"><span class="hs-identifier hs-var">mlen</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072471"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddrRange a -&gt; a
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072471"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; a
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072470"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; a
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072470"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">{-|
  The 'isMatchedTo' function take an 'Addr' address and an 'AddrRange',
  and returns 'True' if the range contains the address.

&gt;&gt;&gt; (&quot;127.0.2.0&quot; :: IPv4) `isMatchedTo` makeAddrRange &quot;127.0.2.1&quot; 24
True
&gt;&gt;&gt; (&quot;127.0.2.0&quot; :: IPv4) `isMatchedTo` makeAddrRange &quot;127.0.2.1&quot; 32
False
&gt;&gt;&gt; (&quot;2001:DB8::1&quot; :: IPv6) `isMatchedTo` makeAddrRange &quot;2001:DB8::1&quot; 32
True
&gt;&gt;&gt; (&quot;2001:DB8::&quot; :: IPv6) `isMatchedTo` makeAddrRange &quot;2001:DB8::1&quot; 128
False
-}</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621679072420"><span class="annot"><a href="Data.IP.Op.html#isMatchedTo"><span class="hs-identifier hs-type">isMatchedTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679072420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-84"></span><span id="isMatchedTo"><span class="annot"><span class="annottext">isMatchedTo :: forall a. Addr a =&gt; a -&gt; AddrRange a -&gt; Bool
</span><a href="Data.IP.Op.html#isMatchedTo"><span class="hs-identifier hs-var hs-var">isMatchedTo</span></a></span></span><span> </span><span id="local-6989586621679072482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072482"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679072483"><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072483"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072482"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; a
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072483"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AddrRange a -&gt; a
forall a. AddrRange a -&gt; a
</span><a href="Data.IP.Range.html#addr"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange a
</span><a href="#local-6989586621679072483"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">{-|
  The 'makeAddrRange' functions takes an 'Addr' address and a mask
  length. It creates a bit mask from the mask length and masks
  the 'Addr' address, then returns 'AddrRange' made of them.

&gt;&gt;&gt; makeAddrRange (toIPv4 [127,0,2,1]) 8
127.0.0.0/8
&gt;&gt;&gt; makeAddrRange (toIPv6 [0x2001,0xDB8,0,0,0,0,0,1]) 8
2000::/8
-}</span></span><span>
</span><span id="line-96"></span><span id="local-6989586621679072422"><span class="annot"><a href="Data.IP.Op.html#makeAddrRange"><span class="hs-identifier hs-type">makeAddrRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679072422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072422"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-97"></span><span id="makeAddrRange"><span class="annot"><span class="annottext">makeAddrRange :: forall a. Addr a =&gt; a -&gt; Int -&gt; AddrRange a
</span><a href="Data.IP.Op.html#makeAddrRange"><span class="hs-identifier hs-var hs-var">makeAddrRange</span></a></span></span><span> </span><span id="local-6989586621679072487"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072487"><span class="hs-identifier hs-var">ad</span></a></span></span><span> </span><span id="local-6989586621679072488"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072488"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Int -&gt; AddrRange a
forall a. a -&gt; a -&gt; Int -&gt; AddrRange a
</span><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-var">AddrRange</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072489"><span class="hs-identifier hs-var">adr</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072490"><span class="hs-identifier hs-var">msk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072488"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679072490"><span class="annot"><span class="annottext">msk :: a
</span><a href="#local-6989586621679072490"><span class="hs-identifier hs-var hs-var">msk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a. Addr a =&gt; Int -&gt; a
</span><a href="Data.IP.Op.html#intToMask"><span class="hs-identifier hs-var">intToMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072488"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679072489"><span class="annot"><span class="annottext">adr :: a
</span><a href="#local-6989586621679072489"><span class="hs-identifier hs-var hs-var">adr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072487"><span class="hs-identifier hs-var">ad</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Addr a =&gt; a -&gt; a -&gt; a
</span><a href="Data.IP.Op.html#masked"><span class="hs-operator hs-var">`masked`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072490"><span class="hs-identifier hs-var">msk</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><span class="hs-comment">-- | Convert IPv4 range to IPV4-embedded-in-IPV6 range</span></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Data.IP.Op.html#ipv4RangeToIPv6"><span class="hs-identifier hs-type">ipv4RangeToIPv6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv4"><span class="hs-identifier hs-type">IPv4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="Data.IP.Addr.html#IPv6"><span class="hs-identifier hs-type">IPv6</span></a></span><span>
</span><span id="line-105"></span><span id="ipv4RangeToIPv6"><span class="annot"><span class="annottext">ipv4RangeToIPv6 :: AddrRange IPv4 -&gt; AddrRange IPv6
</span><a href="Data.IP.Op.html#ipv4RangeToIPv6"><span class="hs-identifier hs-var hs-var">ipv4RangeToIPv6</span></a></span></span><span> </span><span id="local-6989586621679072496"><span class="annot"><span class="annottext">AddrRange IPv4
</span><a href="#local-6989586621679072496"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">IPv6 -&gt; Int -&gt; AddrRange IPv6
forall a. Addr a =&gt; a -&gt; Int -&gt; AddrRange a
</span><a href="Data.IP.Op.html#makeAddrRange"><span class="hs-identifier hs-var">makeAddrRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; IPv6
</span><a href="Data.IP.Addr.html#toIPv6"><span class="hs-identifier hs-var">toIPv6</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xffff</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072498"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shift`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072501"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072502"><span class="hs-identifier hs-var">i3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shift`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072503"><span class="hs-identifier hs-var">i4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072504"><span class="hs-identifier hs-var">masklen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">96</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679072507"><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679072507"><span class="hs-identifier hs-var">ip</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679072504"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072504"><span class="hs-identifier hs-var">masklen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddrRange IPv4 -&gt; (IPv4, Int)
forall a. Addr a =&gt; AddrRange a -&gt; (a, Int)
</span><a href="Data.IP.Op.html#addrRangePair"><span class="hs-identifier hs-var">addrRangePair</span></a></span><span> </span><span class="annot"><span class="annottext">AddrRange IPv4
</span><a href="#local-6989586621679072496"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679072498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072498"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679072501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072501"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679072502"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072502"><span class="hs-identifier hs-var">i3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679072503"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072503"><span class="hs-identifier hs-var">i4</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IPv4 -&gt; [Int]
</span><a href="Data.IP.Addr.html#fromIPv4"><span class="hs-identifier hs-var">fromIPv4</span></a></span><span> </span><span class="annot"><span class="annottext">IPv4
</span><a href="#local-6989586621679072507"><span class="hs-identifier hs-var">ip</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><span class="hs-comment">{-|
  The 'unmakeAddrRange' functions take a 'AddrRange' and
  returns the network address and a mask length.

&gt;&gt;&gt; addrRangePair (&quot;127.0.0.0/8&quot; :: AddrRange IPv4)
(127.0.0.0,8)
&gt;&gt;&gt; addrRangePair (&quot;2000::/8&quot; :: AddrRange IPv6)
(2000::,8)
-}</span></span><span>
</span><span id="line-121"></span><span id="local-6989586621679072427"><span class="annot"><a href="Data.IP.Op.html#addrRangePair"><span class="hs-identifier hs-type">addrRangePair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.IP.Op.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679072427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679072427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-122"></span><span id="addrRangePair"><span class="annot"><span class="annottext">addrRangePair :: forall a. Addr a =&gt; AddrRange a -&gt; (a, Int)
</span><a href="Data.IP.Op.html#addrRangePair"><span class="hs-identifier hs-var hs-var">addrRangePair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.IP.Range.html#AddrRange"><span class="hs-identifier hs-type">AddrRange</span></a></span><span> </span><span id="local-6989586621679072511"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072511"><span class="hs-identifier hs-var">adr</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679072512"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072512"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679072511"><span class="hs-identifier hs-var">adr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679072512"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span></pre></body></html>