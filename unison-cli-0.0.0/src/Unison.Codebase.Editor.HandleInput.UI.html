<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Unison.Codebase.Editor.HandleInput.UI</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUI"><span class="hs-identifier">openUI</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lens</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Branch.Type</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V2Branch</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Reference</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Reference</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Referent</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Referent</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Referent</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V2.Referent</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Sqlite.Project</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Project</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Sqlite.ProjectBranch</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ProjectBranch</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html"><span class="hs-identifier">Unison.Cli.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Unison.Cli.Monad.html#Cli"><span class="hs-identifier">Cli</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html"><span class="hs-identifier">Unison.Cli.Monad</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cli</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Unison.Cli.MonadUtils.html"><span class="hs-identifier">Unison.Cli.MonadUtils</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cli</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Codebase</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Codebase</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.Path</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Path</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.ProjectPath</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Codebase.SqliteCodebase.Conversions</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Conversions</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.ConstructorType</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ConstructorType</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.HashQualified</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HQ</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Name</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Name</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Name</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Parser.Ann</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ann</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Prelude</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Project</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProjectAndBranch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProjectAndBranch</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Referent</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Referent</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Server.CodebaseServer</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Server</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Sqlite</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Sqlite</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unison.Symbol</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Web.Browser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">openBrowser</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUI"><span class="hs-identifier hs-type">openUI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Path'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html#Cli"><span class="hs-identifier hs-type">Cli</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span id="openUI"><span class="annot"><span class="annottext">openUI :: Path' -&gt; Cli ()
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUI"><span class="hs-identifier hs-var hs-var">openUI</span></a></span></span><span> </span><span id="local-6989586621680913229"><span class="annot"><span class="annottext">Path'
</span><a href="#local-6989586621680913229"><span class="hs-identifier hs-var">path'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="Unison.Cli.Monad.html#Env"><span class="hs-identifier hs-type">Cli.Env</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680913231"><span class="annot"><span class="annottext">Maybe BaseUrl
serverBaseUrl :: Maybe BaseUrl
$sel:serverBaseUrl:Env :: Env -&gt; Maybe BaseUrl
</span><a href="#local-6989586621680913231"><span class="hs-identifier hs-var hs-var">serverBaseUrl</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cli Env
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621680913233"><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913233"><span class="hs-identifier hs-var">defnPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Path' -&gt; Cli ProjectPath
</span><a href="Unison.Cli.MonadUtils.html#resolvePath%27"><span class="hs-identifier hs-var">Cli.resolvePath'</span></a></span><span> </span><span class="annot"><span class="annottext">Path'
</span><a href="#local-6989586621680913229"><span class="hs-identifier hs-var">path'</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621680913235"><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913235"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cli ProjectPath
</span><a href="Unison.Cli.MonadUtils.html#getCurrentProjectPath"><span class="hs-identifier hs-var">Cli.getCurrentProjectPath</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="annottext">Maybe BaseUrl -&gt; (BaseUrl -&gt; Cli ()) -&gt; Cli ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe BaseUrl
</span><a href="#local-6989586621680913231"><span class="hs-identifier hs-var">serverBaseUrl</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680913238"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680913238"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="annottext">BaseUrl -&gt; ProjectPath -&gt; Absolute -&gt; Cli ()
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUIForProject"><span class="hs-identifier hs-var">openUIForProject</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680913238"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913235"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913233"><span class="hs-identifier hs-var">defnPath</span></a></span><span> </span><span class="annot"><span class="annottext">ProjectPath -&gt; Getting Absolute ProjectPath Absolute -&gt; Absolute
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Absolute ProjectPath Absolute
forall p b (f :: * -&gt; *).
Functor f =&gt;
(Absolute -&gt; f Absolute)
-&gt; ProjectPathG p b -&gt; f (ProjectPathG p b)
</span><span class="hs-identifier hs-var">PP.absPath_</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUIForProject"><span class="hs-identifier hs-type">openUIForProject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.BaseUrl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PP.ProjectPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Absolute</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html#Cli"><span class="hs-identifier hs-type">Cli</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span id="openUIForProject"><span class="annot"><span class="annottext">openUIForProject :: BaseUrl -&gt; ProjectPath -&gt; Absolute -&gt; Cli ()
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#openUIForProject"><span class="hs-identifier hs-var hs-var">openUIForProject</span></a></span></span><span> </span><span id="local-6989586621680913242"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680913242"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span id="local-6989586621680913243"><span class="annot"><span class="annottext">pp :: ProjectPath
</span><a href="#local-6989586621680913243"><span class="hs-identifier hs-var">pp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PP.ProjectPath</span></span><span> </span><span id="local-6989586621680913245"><span class="annot"><span class="annottext">Project
</span><a href="#local-6989586621680913245"><span class="hs-identifier hs-var">project</span></a></span></span><span> </span><span id="local-6989586621680913246"><span class="annot"><span class="annottext">ProjectBranch
</span><a href="#local-6989586621680913246"><span class="hs-identifier hs-var">projectBranch</span></a></span></span><span> </span><span id="local-6989586621680913247"><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913247"><span class="hs-identifier hs-var">perspective</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680913248"><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913248"><span class="hs-identifier hs-var">defnPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621680913249"><span class="annot"><span class="annottext">Maybe DefinitionReference
</span><a href="#local-6989586621680913249"><span class="hs-identifier hs-var">mayDefinitionRef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Absolute -&gt; Cli (Maybe DefinitionReference)
</span><a href="#local-6989586621680913250"><span class="hs-identifier hs-var">getDefinitionRef</span></a></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913247"><span class="hs-identifier hs-var">perspective</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913251"><span class="annot"><span class="annottext">projectBranchNames :: ProjectAndBranch ProjectName ProjectBranchName
</span><a href="#local-6989586621680913251"><span class="hs-identifier hs-var hs-var">projectBranchNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Project -&gt; ProjectName)
-&gt; (ProjectBranch -&gt; ProjectBranchName)
-&gt; ProjectAndBranch Project ProjectBranch
-&gt; ProjectAndBranch ProjectName ProjectBranchName
forall a b c d.
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; ProjectAndBranch a c -&gt; ProjectAndBranch b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">Project -&gt; ProjectName
</span><span class="hs-identifier hs-var">Project.name</span></span><span> </span><span class="annot"><span class="annottext">ProjectBranch -&gt; ProjectBranchName
</span><span class="hs-identifier hs-var">ProjectBranch.name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Project -&gt; ProjectBranch -&gt; ProjectAndBranch Project ProjectBranch
forall a b. a -&gt; b -&gt; ProjectAndBranch a b
</span><span class="hs-identifier hs-var">ProjectAndBranch</span></span><span> </span><span class="annot"><span class="annottext">Project
</span><a href="#local-6989586621680913245"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">ProjectBranch
</span><a href="#local-6989586621680913246"><span class="hs-identifier hs-var">projectBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621680913255"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680913255"><span class="hs-identifier hs-var">_success</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Cli Bool
forall a. IO a -&gt; Cli a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Cli Bool) -&gt; (Text -&gt; IO Bool) -&gt; Text -&gt; Cli Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">openBrowser</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO Bool) -&gt; (Text -&gt; String) -&gt; Text -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Cli Bool) -&gt; Text -&gt; Cli Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Service -&gt; BaseUrl -&gt; Text
</span><span class="hs-identifier hs-var">Server.urlFor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProjectAndBranch ProjectName ProjectBranchName
-&gt; Absolute -&gt; Maybe DefinitionReference -&gt; Service
</span><span class="hs-identifier hs-var">Server.ProjectBranchUI</span></span><span> </span><span class="annot"><span class="annottext">ProjectAndBranch ProjectName ProjectBranchName
</span><a href="#local-6989586621680913251"><span class="hs-identifier hs-var">projectBranchNames</span></a></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913247"><span class="hs-identifier hs-var">perspective</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DefinitionReference
</span><a href="#local-6989586621680913249"><span class="hs-identifier hs-var">mayDefinitionRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680913242"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">-- If the provided ui path matches a definition, find it.</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="#local-6989586621680913250"><span class="hs-identifier hs-type">getDefinitionRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Path.Absolute</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html#Cli"><span class="hs-identifier hs-type">Cli</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Server.DefinitionReference</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621680913250"><span class="annot"><span class="annottext">getDefinitionRef :: Absolute -&gt; Cli (Maybe DefinitionReference)
</span><a href="#local-6989586621680913250"><span class="hs-identifier hs-var hs-var">getDefinitionRef</span></a></span></span><span> </span><span id="local-6989586621680913261"><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913261"><span class="hs-identifier hs-var">perspective</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT Cli DefinitionReference -&gt; Cli (Maybe DefinitionReference)
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT Cli DefinitionReference -&gt; Cli (Maybe DefinitionReference))
-&gt; MaybeT Cli DefinitionReference
-&gt; Cli (Maybe DefinitionReference)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-54"></span><span>      </span><span class="annot"><a href="Unison.Cli.Monad.html#Env"><span class="hs-identifier hs-type">Cli.Env</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621680913263"><span class="annot"><span class="annottext">Codebase IO Symbol Ann
codebase :: Codebase IO Symbol Ann
$sel:codebase:Env :: Env -&gt; Codebase IO Symbol Ann
</span><a href="#local-6989586621680913263"><span class="hs-identifier hs-var hs-var">codebase</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cli Env -&gt; MaybeT Cli Env
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; MaybeT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">Cli Env
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-55"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680913266"><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913266"><span class="hs-identifier hs-var">pathToDefinitionNamespace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680913267"><span class="annot"><span class="annottext">NameSegment
</span><a href="#local-6989586621680913267"><span class="hs-identifier hs-var">_nameSeg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Absolute, NameSegment) -&gt; MaybeT Cli (Absolute, NameSegment)
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Absolute, NameSegment)
 -&gt; MaybeT Cli (Absolute, NameSegment))
-&gt; Maybe (Absolute, NameSegment)
-&gt; MaybeT Cli (Absolute, NameSegment)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Absolute -&gt; Maybe (Absolute, NameSegment)
forall s a. Snoc s s a a =&gt; s -&gt; Maybe (s, a)
</span><span class="hs-identifier hs-var">Lens.unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913248"><span class="hs-identifier hs-var">defnPath</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913270"><span class="annot"><span class="annottext">defnNamespaceProjectPath :: ProjectPath
</span><a href="#local-6989586621680913270"><span class="hs-identifier hs-var hs-var">defnNamespaceProjectPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913243"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">ProjectPath -&gt; (ProjectPath -&gt; ProjectPath) -&gt; ProjectPath
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Absolute -&gt; Identity Absolute)
-&gt; ProjectPath -&gt; Identity ProjectPath
forall p b (f :: * -&gt; *).
Functor f =&gt;
(Absolute -&gt; f Absolute)
-&gt; ProjectPathG p b -&gt; f (ProjectPathG p b)
</span><span class="hs-identifier hs-var">PP.absPath_</span></span><span> </span><span class="annot"><span class="annottext">((Absolute -&gt; Identity Absolute)
 -&gt; ProjectPath -&gt; Identity ProjectPath)
-&gt; Absolute -&gt; ProjectPath -&gt; ProjectPath
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913266"><span class="hs-identifier hs-var">pathToDefinitionNamespace</span></a></span><span>
</span><span id="line-57"></span><span>      </span><span id="local-6989586621680913273"><span class="annot"><span class="annottext">Branch Transaction
</span><a href="#local-6989586621680913273"><span class="hs-identifier hs-var">namespaceBranch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cli (Branch Transaction) -&gt; MaybeT Cli (Branch Transaction)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; MaybeT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Cli (Branch Transaction) -&gt; MaybeT Cli (Branch Transaction))
-&gt; (Transaction (Branch Transaction) -&gt; Cli (Branch Transaction))
-&gt; Transaction (Branch Transaction)
-&gt; MaybeT Cli (Branch Transaction)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Transaction (Branch Transaction) -&gt; Cli (Branch Transaction)
forall a. Transaction a -&gt; Cli a
</span><a href="Unison.Cli.Monad.html#runTransaction"><span class="hs-identifier hs-var">Cli.runTransaction</span></a></span><span> </span><span class="annot"><span class="annottext">(Transaction (Branch Transaction)
 -&gt; MaybeT Cli (Branch Transaction))
-&gt; Transaction (Branch Transaction)
-&gt; MaybeT Cli (Branch Transaction)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProjectPath -&gt; Transaction (Branch Transaction)
</span><span class="hs-identifier hs-var">Codebase.getShallowBranchAtProjectPath</span></span><span> </span><span class="annot"><span class="annottext">ProjectPath
</span><a href="#local-6989586621680913270"><span class="hs-identifier hs-var">defnNamespaceProjectPath</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span id="local-6989586621680913276"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913276"><span class="hs-identifier hs-var">fqn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; MaybeT Cli Name
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; MaybeT Cli Name) -&gt; Maybe Name -&gt; MaybeT Cli Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>        </span><span id="local-6989586621680913277"><span class="annot"><span class="annottext">[NameSegment]
</span><a href="#local-6989586621680913277"><span class="hs-identifier hs-var">pathFromPerspective</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[NameSegment] -&gt; [NameSegment] -&gt; Maybe [NameSegment]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><span class="hs-identifier hs-var">List.stripPrefix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path -&gt; [NameSegment]
</span><span class="hs-identifier hs-var">Path.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Absolute -&gt; Path
</span><span class="hs-identifier hs-var">Path.unabsolute</span></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913261"><span class="hs-identifier hs-var">perspective</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path -&gt; [NameSegment]
</span><span class="hs-identifier hs-var">Path.toList</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; [NameSegment]) -&gt; Path -&gt; [NameSegment]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Absolute -&gt; Path
</span><span class="hs-identifier hs-var">Path.unabsolute</span></span><span> </span><span class="annot"><span class="annottext">Absolute
</span><a href="#local-6989586621680913248"><span class="hs-identifier hs-var">defnPath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><span class="annottext">Path -&gt; Maybe Name
</span><span class="hs-identifier hs-var">Path.toName</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; Maybe Name)
-&gt; ([NameSegment] -&gt; Path) -&gt; [NameSegment] -&gt; Maybe Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[NameSegment] -&gt; Path
</span><span class="hs-identifier hs-var">Path.fromList</span></span><span> </span><span class="annot"><span class="annottext">([NameSegment] -&gt; Maybe Name) -&gt; [NameSegment] -&gt; Maybe Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[NameSegment]
</span><a href="#local-6989586621680913277"><span class="hs-identifier hs-var">pathFromPerspective</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span id="local-6989586621680913283"><span class="annot"><span class="annottext">DefinitionReference
</span><a href="#local-6989586621680913283"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cli (Maybe DefinitionReference) -&gt; MaybeT Cli DefinitionReference
forall (m :: * -&gt; *) a. m (Maybe a) -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">MaybeT</span></span><span> </span><span class="annot"><span class="annottext">(Cli (Maybe DefinitionReference) -&gt; MaybeT Cli DefinitionReference)
-&gt; Cli (Maybe DefinitionReference)
-&gt; MaybeT Cli DefinitionReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Codebase IO Symbol Ann
-&gt; Branch Transaction -&gt; Name -&gt; Cli (Maybe DefinitionReference)
forall (m :: * -&gt; *) (n :: * -&gt; *).
Codebase m Symbol Ann
-&gt; Branch n -&gt; Name -&gt; Cli (Maybe DefinitionReference)
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#getTermOrTypeRef"><span class="hs-identifier hs-var">getTermOrTypeRef</span></a></span><span> </span><span class="annot"><span class="annottext">Codebase IO Symbol Ann
</span><a href="#local-6989586621680913263"><span class="hs-identifier hs-var">codebase</span></a></span><span> </span><span class="annot"><span class="annottext">Branch Transaction
</span><a href="#local-6989586621680913273"><span class="hs-identifier hs-var">namespaceBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913276"><span class="hs-identifier hs-var">fqn</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span class="hs-identifier">pure</span><span> </span><span class="annot"><span class="annottext">DefinitionReference
</span><a href="#local-6989586621680913283"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span id="local-6989586621680913141"><span id="local-6989586621680913142"><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#getTermOrTypeRef"><span class="hs-identifier hs-type">getTermOrTypeRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Codebase</span></span><span> </span><span class="annot"><a href="#local-6989586621680913141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2Branch.Branch</span></span><span> </span><span class="annot"><a href="#local-6989586621680913142"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Unison.Cli.Monad.html#Cli"><span class="hs-identifier hs-type">Cli</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.DefinitionReference</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-65"></span><span id="getTermOrTypeRef"><span class="annot"><span class="annottext">getTermOrTypeRef :: forall (m :: * -&gt; *) (n :: * -&gt; *).
Codebase m Symbol Ann
-&gt; Branch n -&gt; Name -&gt; Cli (Maybe DefinitionReference)
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#getTermOrTypeRef"><span class="hs-identifier hs-var hs-var">getTermOrTypeRef</span></a></span></span><span> </span><span id="local-6989586621680913301"><span class="annot"><span class="annottext">Codebase m Symbol Ann
</span><a href="#local-6989586621680913301"><span class="hs-identifier hs-var">codebase</span></a></span></span><span> </span><span id="local-6989586621680913302"><span class="annot"><span class="annottext">Branch n
</span><a href="#local-6989586621680913302"><span class="hs-identifier hs-var">namespaceBranch</span></a></span></span><span> </span><span id="local-6989586621680913303"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913303"><span class="hs-identifier hs-var">fqn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT Cli DefinitionReference -&gt; Cli (Maybe DefinitionReference)
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">(MaybeT Cli DefinitionReference -&gt; Cli (Maybe DefinitionReference))
-&gt; MaybeT Cli DefinitionReference
-&gt; Cli (Maybe DefinitionReference)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913304"><span class="annot"><span class="annottext">nameSeg :: NameSegment
</span><a href="#local-6989586621680913304"><span class="hs-identifier hs-var hs-var">nameSeg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameSegment
</span><span class="hs-identifier hs-var">Name.lastSegment</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913303"><span class="hs-identifier hs-var">fqn</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913306"><span class="annot"><span class="annottext">terms :: MaybeT Cli DefinitionReference
</span><a href="#local-6989586621680913306"><span class="hs-identifier hs-var hs-var">terms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>        </span><span id="local-6989586621680913307"><span class="annot"><span class="annottext">Map Referent (n MdValues)
</span><a href="#local-6989586621680913307"><span class="hs-identifier hs-var">matchingTerms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Referent (n MdValues))
-&gt; MaybeT Cli (Map Referent (n MdValues))
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Map Referent (n MdValues))
 -&gt; MaybeT Cli (Map Referent (n MdValues)))
-&gt; Maybe (Map Referent (n MdValues))
-&gt; MaybeT Cli (Map Referent (n MdValues))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameSegment
-&gt; Map NameSegment (Map Referent (n MdValues))
-&gt; Maybe (Map Referent (n MdValues))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">NameSegment
</span><a href="#local-6989586621680913304"><span class="hs-identifier hs-var">nameSeg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Branch n -&gt; Map NameSegment (Map Referent (n MdValues))
forall (m :: * -&gt; *).
Branch m -&gt; Map NameSegment (Map Referent (m MdValues))
</span><span class="hs-identifier hs-var">V2Branch.terms</span></span><span> </span><span class="annot"><span class="annottext">Branch n
</span><a href="#local-6989586621680913302"><span class="hs-identifier hs-var">namespaceBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>        </span><span id="local-6989586621680913310"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913310"><span class="hs-identifier hs-var">oneTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Referent -&gt; MaybeT Cli Referent
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Referent -&gt; MaybeT Cli Referent)
-&gt; Maybe Referent -&gt; MaybeT Cli Referent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Referent -&gt; Maybe Referent
forall a. Set a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Set.lookupMin</span></span><span> </span><span class="annot"><span class="annottext">(Set Referent -&gt; Maybe Referent) -&gt; Set Referent -&gt; Maybe Referent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Referent (n MdValues) -&gt; Set Referent
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map Referent (n MdValues)
</span><a href="#local-6989586621680913307"><span class="hs-identifier hs-var">matchingTerms</span></a></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">Cli DefinitionReference -&gt; MaybeT Cli DefinitionReference
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; MaybeT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Cli DefinitionReference -&gt; MaybeT Cli DefinitionReference)
-&gt; Cli DefinitionReference -&gt; MaybeT Cli DefinitionReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Transaction DefinitionReference -&gt; Cli DefinitionReference
forall a. Transaction a -&gt; Cli a
</span><a href="Unison.Cli.Monad.html#runTransaction"><span class="hs-identifier hs-var">Cli.runTransaction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Codebase m Symbol Ann
-&gt; Name -&gt; Referent -&gt; Transaction DefinitionReference
forall (m :: * -&gt; *).
Codebase m Symbol Ann
-&gt; Name -&gt; Referent -&gt; Transaction DefinitionReference
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTermReference"><span class="hs-identifier hs-var">toTermReference</span></a></span><span> </span><span class="annot"><span class="annottext">Codebase m Symbol Ann
</span><a href="#local-6989586621680913301"><span class="hs-identifier hs-var">codebase</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913303"><span class="hs-identifier hs-var">fqn</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913310"><span class="hs-identifier hs-var">oneTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913314"><span class="annot"><span class="annottext">types :: MaybeT Cli DefinitionReference
</span><a href="#local-6989586621680913314"><span class="hs-identifier hs-var hs-var">types</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621680913315"><span class="annot"><span class="annottext">Map Reference (n MdValues)
</span><a href="#local-6989586621680913315"><span class="hs-identifier hs-var">matchingTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Reference (n MdValues))
-&gt; MaybeT Cli (Map Reference (n MdValues))
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Map Reference (n MdValues))
 -&gt; MaybeT Cli (Map Reference (n MdValues)))
-&gt; Maybe (Map Reference (n MdValues))
-&gt; MaybeT Cli (Map Reference (n MdValues))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameSegment
-&gt; Map NameSegment (Map Reference (n MdValues))
-&gt; Maybe (Map Reference (n MdValues))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">NameSegment
</span><a href="#local-6989586621680913304"><span class="hs-identifier hs-var">nameSeg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Branch n -&gt; Map NameSegment (Map Reference (n MdValues))
forall (m :: * -&gt; *).
Branch m -&gt; Map NameSegment (Map Reference (m MdValues))
</span><span class="hs-identifier hs-var">V2Branch.types</span></span><span> </span><span class="annot"><span class="annottext">Branch n
</span><a href="#local-6989586621680913302"><span class="hs-identifier hs-var">namespaceBranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621680913317"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913317"><span class="hs-identifier hs-var">oneType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Reference -&gt; MaybeT Cli Reference
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; MaybeT m a
</span><span class="hs-identifier hs-var">hoistMaybe</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Reference -&gt; MaybeT Cli Reference)
-&gt; Maybe Reference -&gt; MaybeT Cli Reference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Reference -&gt; Maybe Reference
forall a. Set a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Set.lookupMin</span></span><span> </span><span class="annot"><span class="annottext">(Set Reference -&gt; Maybe Reference)
-&gt; Set Reference -&gt; Maybe Reference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Reference (n MdValues) -&gt; Set Reference
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map Reference (n MdValues)
</span><a href="#local-6989586621680913315"><span class="hs-identifier hs-var">matchingTypes</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Reference -&gt; DefinitionReference
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTypeReference"><span class="hs-identifier hs-var">toTypeReference</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913303"><span class="hs-identifier hs-var">fqn</span></a></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913317"><span class="hs-identifier hs-var">oneType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">MaybeT Cli DefinitionReference
</span><a href="#local-6989586621680913306"><span class="hs-identifier hs-var">terms</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeT Cli DefinitionReference
-&gt; MaybeT Cli DefinitionReference -&gt; MaybeT Cli DefinitionReference
forall a. MaybeT Cli a -&gt; MaybeT Cli a -&gt; MaybeT Cli a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">MaybeT Cli DefinitionReference
</span><a href="#local-6989586621680913314"><span class="hs-identifier hs-var">types</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTypeReference"><span class="hs-identifier hs-type">toTypeReference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2.Reference</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.DefinitionReference</span></span><span>
</span><span id="line-78"></span><span id="toTypeReference"><span class="annot"><span class="annottext">toTypeReference :: Name -&gt; Reference -&gt; DefinitionReference
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTypeReference"><span class="hs-identifier hs-var hs-var">toTypeReference</span></a></span></span><span> </span><span id="local-6989586621680913320"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913320"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680913321"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913321"><span class="hs-identifier hs-var">reference</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">HashQualified Name -&gt; DefinitionReference
</span><span class="hs-identifier hs-var">Server.TypeReference</span></span><span> </span><span class="annot"><span class="annottext">(HashQualified Name -&gt; DefinitionReference)
-&gt; HashQualified Name -&gt; DefinitionReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; Reference -&gt; HashQualified Name
forall n. n -&gt; Reference -&gt; HashQualified n
</span><span class="hs-identifier hs-var">HQ.fromNamedReference</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913320"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Reference
</span><span class="hs-identifier hs-var">Conversions.reference2to1</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913321"><span class="hs-identifier hs-var">reference</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621680913157"><span class="annot"><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTermReference"><span class="hs-identifier hs-type">toTermReference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Codebase</span></span><span> </span><span class="annot"><a href="#local-6989586621680913157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ann</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2.Referent</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sqlite.Transaction</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Server.DefinitionReference</span></span></span><span>
</span><span id="line-83"></span><span id="toTermReference"><span class="annot"><span class="annottext">toTermReference :: forall (m :: * -&gt; *).
Codebase m Symbol Ann
-&gt; Name -&gt; Referent -&gt; Transaction DefinitionReference
</span><a href="Unison.Codebase.Editor.HandleInput.UI.html#toTermReference"><span class="hs-identifier hs-var hs-var">toTermReference</span></a></span></span><span> </span><span id="local-6989586621680913333"><span class="annot"><span class="annottext">Codebase m Symbol Ann
</span><a href="#local-6989586621680913333"><span class="hs-identifier hs-var">codebase</span></a></span></span><span> </span><span id="local-6989586621680913334"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913334"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680913335"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913335"><span class="hs-identifier hs-var">referent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913335"><span class="hs-identifier hs-var">referent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">V2.Referent.Ref</span></span><span> </span><span id="local-6989586621680913337"><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913337"><span class="hs-identifier hs-var">reference</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>      </span><span class="annot"><span class="annottext">DefinitionReference -&gt; Transaction DefinitionReference
forall a. a -&gt; Transaction a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(DefinitionReference -&gt; Transaction DefinitionReference)
-&gt; DefinitionReference -&gt; Transaction DefinitionReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">HashQualified Name -&gt; DefinitionReference
</span><span class="hs-identifier hs-var">Server.TermReference</span></span><span> </span><span class="annot"><span class="annottext">(HashQualified Name -&gt; DefinitionReference)
-&gt; HashQualified Name -&gt; DefinitionReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-88"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Reference -&gt; HashQualified Name
forall n. n -&gt; Reference -&gt; HashQualified n
</span><span class="hs-identifier hs-var">HQ.fromNamedReference</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913334"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Reference -&gt; Reference
</span><span class="hs-identifier hs-var">Conversions.reference2to1</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><a href="#local-6989586621680913337"><span class="hs-identifier hs-var">reference</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">V2.Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>      </span><span id="local-6989586621680913340"><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913340"><span class="hs-identifier hs-var">v1Referent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Reference -&gt; Transaction ConstructorType)
-&gt; Referent -&gt; Transaction Referent
forall (m :: * -&gt; *).
Applicative m =&gt;
(Reference -&gt; m ConstructorType) -&gt; Referent -&gt; m Referent
</span><span class="hs-identifier hs-var">Conversions.referent2to1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Codebase m Symbol Ann -&gt; Reference -&gt; Transaction ConstructorType
forall (m :: * -&gt; *) v a.
Codebase m v a -&gt; Reference -&gt; Transaction ConstructorType
</span><span class="hs-identifier hs-var">Codebase.getDeclType</span></span><span> </span><span class="annot"><span class="annottext">Codebase m Symbol Ann
</span><a href="#local-6989586621680913333"><span class="hs-identifier hs-var">codebase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913335"><span class="hs-identifier hs-var">referent</span></a></span><span>
</span><span id="line-91"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680913343"><span class="annot"><span class="annottext">hq :: HashQualified Name
</span><a href="#local-6989586621680913343"><span class="hs-identifier hs-var hs-var">hq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Referent -&gt; HashQualified Name
forall n. n -&gt; Referent -&gt; HashQualified n
</span><span class="hs-identifier hs-var">HQ.fromNamedReferent</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680913334"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913340"><span class="hs-identifier hs-var">v1Referent</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">DefinitionReference -&gt; Transaction DefinitionReference
forall a. a -&gt; Transaction a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Referent
</span><a href="#local-6989586621680913340"><span class="hs-identifier hs-var">v1Referent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">ConstructorType.Data</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>          </span><span class="annot"><span class="annottext">HashQualified Name -&gt; DefinitionReference
</span><span class="hs-identifier hs-var">Server.DataConstructorReference</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680913343"><span class="hs-identifier hs-var">hq</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Referent.Con</span></span><span> </span><span class="annot"><span class="annottext">ConstructorReference
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ConstructorType
</span><span class="hs-identifier hs-var">ConstructorType.Effect</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>          </span><span class="annot"><span class="annottext">HashQualified Name -&gt; DefinitionReference
</span><span class="hs-identifier hs-var">Server.AbilityConstructorReference</span></span><span> </span><span class="annot"><span class="annottext">HashQualified Name
</span><a href="#local-6989586621680913343"><span class="hs-identifier hs-var">hq</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Referent.Ref</span></span><span> </span><span class="annot"><span class="annottext">Reference
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; DefinitionReference
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Impossible! *twirls mustache*&quot;</span></span><span>
</span><span id="line-99"></span></pre></body></html>