<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Extra functions for working with times. Unlike the other modules in this package, there is no</span><span>
</span><span id="line-4"></span><span class="hs-comment">--   corresponding @System.Time@ module. This module enhances the functionality</span><span>
</span><span id="line-5"></span><span class="hs-comment">--   from &quot;Data.Time.Clock&quot;, but in quite different ways.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">--   Throughout, time is measured in 'Seconds', which is a type alias for 'Double'.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.Time.Extra</span><span class="hs-special">(</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier">Seconds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="System.Time.Extra.html#sleep"><span class="hs-identifier">sleep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Time.Extra.html#timeout"><span class="hs-identifier">timeout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="System.Time.Extra.html#showDuration"><span class="hs-identifier">showDuration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="System.Time.Extra.html#offsetTime"><span class="hs-identifier">offsetTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Time.Extra.html#offsetTimeIncrease"><span class="hs-identifier">offsetTimeIncrease</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Time.Extra.html#duration"><span class="hs-identifier">duration</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Clock</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Numeric.Extra.html"><span class="hs-identifier">Numeric.Extra</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Extra.html"><span class="hs-identifier">Control.Monad.Extra</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Exception.Extra.html"><span class="hs-identifier">Control.Exception.Extra</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Unique</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="annot"><span class="hs-comment">-- | A type alias for seconds, which are stored as 'Double'.</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">type</span><span> </span><span id="Seconds"><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-var">Seconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- | Sleep for a number of seconds.</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- &gt; fmap (round . fst) (duration $ sleep 1) == pure 1</span><span>
</span><span id="line-31"></span><span class="annot"><a href="System.Time.Extra.html#sleep"><span class="hs-identifier hs-type">sleep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span id="sleep"><span class="annot"><span class="annottext">sleep :: Seconds -&gt; IO ()
</span><a href="System.Time.Extra.html#sleep"><span class="hs-identifier hs-var hs-var">sleep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seconds -&gt; IO (Either Seconds ())) -&gt; Seconds -&gt; IO ()
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m (Either a b)) -&gt; a -&gt; m b
</span><a href="Control.Monad.Extra.html#loopM"><span class="hs-identifier hs-var">loopM</span></a></span><span> </span><span class="annot"><span class="annottext">((Seconds -&gt; IO (Either Seconds ())) -&gt; Seconds -&gt; IO ())
-&gt; (Seconds -&gt; IO (Either Seconds ())) -&gt; Seconds -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679070722"><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070722"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-comment">-- important to handle both overflow and underflow vs Int</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070722"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="annottext">Either Seconds () -&gt; IO (Either Seconds ())
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Seconds () -&gt; IO (Either Seconds ()))
-&gt; Either Seconds () -&gt; IO (Either Seconds ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either Seconds ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070722"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">2000</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2000000000</span></span><span> </span><span class="hs-comment">-- 2000 * 1e6</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="annottext">Either Seconds () -&gt; IO (Either Seconds ())
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Seconds () -&gt; IO (Either Seconds ()))
-&gt; Either Seconds () -&gt; IO (Either Seconds ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Either Seconds ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Seconds -&gt; Either Seconds ()) -&gt; Seconds -&gt; Either Seconds ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070722"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">2000</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO ()) -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Int
forall b. Integral b =&gt; Seconds -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">ceiling</span></span><span> </span><span class="annot"><span class="annottext">(Seconds -&gt; Int) -&gt; Seconds -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070722"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="annottext">Either Seconds () -&gt; IO (Either Seconds ())
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either Seconds () -&gt; IO (Either Seconds ()))
-&gt; Either Seconds () -&gt; IO (Either Seconds ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either Seconds ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- An internal type that is thrown as a dynamic exception to</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- interrupt the running IO computation when the timeout has</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- expired.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">newtype</span><span> </span><span id="Timeout"><span class="annot"><a href="System.Time.Extra.html#Timeout"><span class="hs-identifier hs-var">Timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Timeout"><span class="annot"><a href="System.Time.Extra.html#Timeout"><span class="hs-identifier hs-var">Timeout</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unique</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070730"><span id="local-6989586621679070735"><span class="annot"><span class="annottext">Timeout -&gt; Timeout -&gt; Bool
(Timeout -&gt; Timeout -&gt; Bool)
-&gt; (Timeout -&gt; Timeout -&gt; Bool) -&gt; Eq Timeout
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Timeout -&gt; Timeout -&gt; Bool
== :: Timeout -&gt; Timeout -&gt; Bool
$c/= :: Timeout -&gt; Timeout -&gt; Bool
/= :: Timeout -&gt; Timeout -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679070741"><span id="local-6989586621679070746"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="System.Time.Extra.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679070749"><span class="annot"><span class="annottext">show :: Timeout -&gt; String
</span><a href="#local-6989586621679070749"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&lt;timeout&gt;&gt;&quot;</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679070756"><span id="local-6989586621679070760"><span id="local-6989586621679070763"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="System.Time.Extra.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span></span></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | A version of 'System.Timeout.timeout' that takes 'Seconds' and never</span><span>
</span><span id="line-53"></span><span class="hs-comment">--   overflows the bounds of an 'Int'. In addition, the bug that negative</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   timeouts run for ever has been fixed.</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt; timeout (-3) (print 1) == pure Nothing</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt; timeout 0.1  (print 1) == fmap Just (print 1)</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt; do (t, _) &lt;- duration $ timeout 0.1 $ sleep 1000; print t; pure $ t &lt; 1</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- &gt; timeout 0.1  (sleep 2 &gt;&gt; print 1) == pure Nothing</span><span>
</span><span id="line-60"></span><span id="local-6989586621679070636"><span class="annot"><a href="System.Time.Extra.html#timeout"><span class="hs-identifier hs-type">timeout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679070636"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679070636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- Copied from GHC with a few tweaks.</span><span>
</span><span id="line-62"></span><span id="timeout"><span class="annot"><span class="annottext">timeout :: forall a. Seconds -&gt; IO a -&gt; IO (Maybe a)
</span><a href="System.Time.Extra.html#timeout"><span class="hs-identifier hs-var hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621679070779"><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070779"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070780"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679070780"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070779"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>        </span><span id="local-6989586621679070782"><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679070782"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ThreadId
</span><span class="hs-identifier hs-var">myThreadId</span></span><span>
</span><span id="line-66"></span><span>        </span><span id="local-6989586621679070784"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679070784"><span class="hs-identifier hs-var">ex</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Unique -&gt; Timeout) -&gt; IO Unique -&gt; IO Timeout
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Timeout
</span><a href="System.Time.Extra.html#Timeout"><span class="hs-identifier hs-var">Timeout</span></a></span><span> </span><span class="annot"><span class="annottext">IO Unique
</span><span class="hs-identifier hs-var">newUnique</span></span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><span class="annottext">(Timeout -&gt; Bool)
-&gt; (Timeout -&gt; IO (Maybe a)) -&gt; IO (Maybe a) -&gt; IO (Maybe a)
forall e a.
Exception e =&gt;
(e -&gt; Bool) -&gt; (e -&gt; IO a) -&gt; IO a -&gt; IO a
</span><a href="Control.Exception.Extra.html#handleBool"><span class="hs-identifier hs-var">handleBool</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timeout -&gt; Timeout -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679070784"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Maybe a) -&gt; Timeout -&gt; IO (Maybe a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe a) -&gt; Timeout -&gt; IO (Maybe a))
-&gt; IO (Maybe a) -&gt; Timeout -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; IO (Maybe a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO ThreadId
-&gt; (ThreadId -&gt; IO ())
-&gt; (ThreadId -&gt; IO (Maybe a))
-&gt; IO (Maybe a)
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((forall a. IO a -&gt; IO a) -&gt; IO ()) -&gt; IO ThreadId
</span><span class="hs-identifier hs-var">forkIOWithUnmask</span></span><span> </span><span class="annot"><span class="annottext">(((forall a. IO a -&gt; IO a) -&gt; IO ()) -&gt; IO ThreadId)
-&gt; ((forall a. IO a -&gt; IO a) -&gt; IO ()) -&gt; IO ThreadId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679070790"><span class="annot"><span class="annottext">forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679070790"><span class="hs-identifier hs-var">unmask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
</span><a href="#local-6989586621679070790"><span class="hs-identifier hs-var">unmask</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; IO ()
</span><a href="System.Time.Extra.html#sleep"><span class="hs-identifier hs-var">sleep</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070779"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ThreadId -&gt; Timeout -&gt; IO ()
forall e. Exception e =&gt; ThreadId -&gt; e -&gt; IO ()
</span><span class="hs-identifier hs-var">throwTo</span></span><span> </span><span class="annot"><span class="annottext">ThreadId
</span><a href="#local-6989586621679070782"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621679070784"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>                            </span><span class="annot"><span class="annottext">ThreadId -&gt; IO ()
</span><span class="hs-identifier hs-var">killThread</span></span><span>
</span><span id="line-71"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ThreadId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; IO a -&gt; IO (Maybe a)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679070780"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Show a number of seconds, typically a duration, in a suitable manner with</span><span>
</span><span id="line-75"></span><span class="hs-comment">--   reasonable precision for a human.</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt; showDuration 3.435   == &quot;3.44s&quot;</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt; showDuration 623.8   == &quot;10m24s&quot;</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &gt; showDuration 62003.8 == &quot;17h13m&quot;</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- &gt; showDuration 1e8     == &quot;27777h47m&quot;</span><span>
</span><span id="line-81"></span><span class="annot"><a href="System.Time.Extra.html#showDuration"><span class="hs-identifier hs-type">showDuration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-82"></span><span id="showDuration"><span class="annot"><span class="annottext">showDuration :: Seconds -&gt; String
</span><a href="System.Time.Extra.html#showDuration"><span class="hs-identifier hs-var hs-var">showDuration</span></a></span></span><span> </span><span id="local-6989586621679070793"><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">3600</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; String -&gt; ShowS
forall {p}. RealFrac p =&gt; p -&gt; String -&gt; ShowS
</span><a href="#local-6989586621679070794"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;h&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;m&quot;</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">60</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; String -&gt; ShowS
forall {p}. RealFrac p =&gt; p -&gt; String -&gt; ShowS
</span><a href="#local-6989586621679070794"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;m&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;s&quot;</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seconds -&gt; String
forall a. RealFloat a =&gt; Int -&gt; a -&gt; String
</span><a href="Numeric.Extra.html#showDP"><span class="hs-identifier hs-var">showDP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070793"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;s&quot;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679070794"><span class="annot"><span class="annottext">f :: p -&gt; String -&gt; ShowS
</span><a href="#local-6989586621679070794"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679070817"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679070817"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679070818"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679070818"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679070819"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679070819"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679070820"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679070818"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679070821"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679070821"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679070819"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-88"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070820"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679070820"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070821"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679070821"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; Integer
forall b. Integral b =&gt; p -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679070817"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">60</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Call once to start, then call repeatedly to get the elapsed time since the first call.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--   The time is guaranteed to be monotonic. This function is robust to system time changes.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt; do f &lt;- offsetTime; xs &lt;- replicateM 10 f; pure $ xs == sort xs</span><span>
</span><span id="line-95"></span><span class="annot"><a href="System.Time.Extra.html#offsetTime"><span class="hs-identifier hs-type">offsetTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="offsetTime"><span class="annot"><span class="annottext">offsetTime :: IO (IO Seconds)
</span><a href="System.Time.Extra.html#offsetTime"><span class="hs-identifier hs-var hs-var">offsetTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679070841"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621679070841"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO TimeSpec
</span><a href="#local-6989586621679070842"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">IO Seconds -&gt; IO (IO Seconds)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(IO Seconds -&gt; IO (IO Seconds)) -&gt; IO Seconds -&gt; IO (IO Seconds)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-99"></span><span>        </span><span id="local-6989586621679070843"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621679070843"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO TimeSpec
</span><a href="#local-6989586621679070842"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="annottext">Seconds -&gt; IO Seconds
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Seconds -&gt; IO Seconds) -&gt; Seconds -&gt; IO Seconds
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seconds
</span><span class="hs-number">1e-9</span></span><span> </span><span class="annot"><span class="annottext">Seconds -&gt; Seconds -&gt; Seconds
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Seconds
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeSpec -&gt; Integer
</span><span class="hs-identifier hs-var">toNanoSecs</span></span><span> </span><span class="annot"><span class="annottext">(TimeSpec -&gt; Integer) -&gt; TimeSpec -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621679070843"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec -&gt; TimeSpec -&gt; TimeSpec
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621679070841"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679070842"><span class="annot"><span class="annottext">time :: IO TimeSpec
</span><a href="#local-6989586621679070842"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Clock -&gt; IO TimeSpec
</span><span class="hs-identifier hs-var">getTime</span></span><span> </span><span class="annot"><span class="annottext">Clock
</span><span class="hs-identifier hs-var">Monotonic</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">offsetTimeIncrease</span><span> </span><span class="hs-pragma">&quot;Use 'offsetTime' instead, which is guaranteed to always increase.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><span class="hs-comment">-- | A synonym for 'offsetTime'.</span></span><span>
</span><span id="line-106"></span><span class="annot"><a href="System.Time.Extra.html#offsetTimeIncrease"><span class="hs-identifier hs-type">offsetTimeIncrease</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span id="offsetTimeIncrease"><span class="annot"><span class="annottext">offsetTimeIncrease :: IO (IO Seconds)
</span><a href="System.Time.Extra.html#offsetTimeIncrease"><span class="hs-identifier hs-var hs-var">offsetTimeIncrease</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (IO Seconds)
</span><a href="System.Time.Extra.html#offsetTime"><span class="hs-identifier hs-var">offsetTime</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Record how long a computation takes in 'Seconds'.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt; do (a,_) &lt;- duration $ sleep 1; pure $ a &gt;= 1 &amp;&amp; a &lt;= 1.5</span><span>
</span><span id="line-112"></span><span id="local-6989586621679070664"><span id="local-6989586621679070666"><span class="annot"><a href="System.Time.Extra.html#duration"><span class="hs-identifier hs-type">duration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679070664"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679070664"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679070666"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679070664"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Time.Extra.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679070666"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-113"></span><span id="duration"><span class="annot"><span class="annottext">duration :: forall (m :: * -&gt; *) a. MonadIO m =&gt; m a -&gt; m (Seconds, a)
</span><a href="System.Time.Extra.html#duration"><span class="hs-identifier hs-var hs-var">duration</span></a></span></span><span> </span><span id="local-6989586621679070858"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679070858"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679070859"><span class="annot"><span class="annottext">IO Seconds
</span><a href="#local-6989586621679070859"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (IO Seconds) -&gt; m (IO Seconds)
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO (IO Seconds)
</span><a href="System.Time.Extra.html#offsetTime"><span class="hs-identifier hs-var">offsetTime</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679070861"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679070861"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679070858"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679070862"><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070862"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Seconds -&gt; m Seconds
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO Seconds
</span><a href="#local-6989586621679070859"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">(Seconds, a) -&gt; m (Seconds, a)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seconds
</span><a href="#local-6989586621679070862"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679070861"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span></pre></body></html>