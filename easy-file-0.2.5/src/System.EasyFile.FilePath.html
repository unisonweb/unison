<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-
  This module based on System.FilePath.Internal of file-path.
  The code was copied with the permission from the author
  of file-path, Neil Mitchell. Thanks!
  See the copyright at the end of file.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.EasyFile.FilePath</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Separator predicates</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-identifier">FilePath</span></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier">pathSeparator</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier">pathSeparators</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier">isPathSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span class="hs-comment">{- xxx
    searchPathSeparator, isSearchPathSeparator,
-}</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier">extSeparator</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier">isExtSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">{- xxx
    -- * Path methods (environment $PATH)
    splitSearchPath, getSearchPath,
-}</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extension methods</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier">splitExtension</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier">takeExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceExtension"><span class="hs-identifier">replaceExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier">dropExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier">addExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#hasExtension"><span class="hs-identifier">hasExtension</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator">(&lt;.&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier">splitExtensions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#dropExtensions"><span class="hs-identifier">dropExtensions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeExtensions"><span class="hs-identifier">takeExtensions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Drive methods</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier">splitDrive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier">joinDrive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier">takeDrive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier">hasDrive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier">dropDrive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier">isDrive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Operations on a FilePath, as a list of directories</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier">splitFileName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier">takeFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceFileName"><span class="hs-identifier">replaceFileName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier">dropFileName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeBaseName"><span class="hs-identifier">takeBaseName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceBaseName"><span class="hs-identifier">replaceBaseName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#takeDirectory"><span class="hs-identifier">takeDirectory</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceDirectory"><span class="hs-identifier">replaceDirectory</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier">combine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator">(&lt;/&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier">splitPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier">joinPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier">splitDirectories</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Low level FilePath operators</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier">hasTrailingPathSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier">addTrailingPathSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier">dropTrailingPathSeparator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * File name manipulators</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier">normalise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier">equalFilePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#makeRelative"><span class="hs-identifier">makeRelative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier">isRelative</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.EasyFile.FilePath.html#isAbsolute"><span class="hs-identifier">isAbsolute</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span class="hs-comment">{- xxx
    isValid, makeValid
-}</span><span class="hs-cpp">

#ifdef TESTING
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">isRelativeDrive</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toUpper</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- import System.Environment(getEnv) -- xxx</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">7</span><span>  </span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-type">&lt;.&gt;</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span>  </span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-type">&lt;/&gt;</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Platform Abstraction Methods (private)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Is the operating system Unix or Linux like</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-type">isPosix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-79"></span><span id="isPosix"><span class="annot"><span class="annottext">isPosix :: Bool
</span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var hs-var">isPosix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">-- | Is the operating system Windows like</span></span><span>
</span><span id="line-82"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-type">isWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-cpp">
#if defined(mingw32_HOST_OS) || defined(__MINGW32__)
</span><span class="hs-identifier">isWindows</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-cpp">
#else
</span><span id="isWindows"><span class="annot"><span class="annottext">isWindows :: Bool
</span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var hs-var">isWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-89"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The basic functions</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | The character that separates directories.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt; pathSeparator ==  '/'</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt; isPathSeparator pathSeparator</span><span>
</span><span id="line-96"></span><span class="annot"><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-type">pathSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-97"></span><span id="pathSeparator"><span class="annot"><span class="annottext">pathSeparator :: Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var hs-var">pathSeparator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | The list of all possible separators.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; Windows: pathSeparators == ['\\', '/']</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt; Posix:   pathSeparators == ['/']</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt; pathSeparator `elem` pathSeparators</span><span>
</span><span id="line-104"></span><span class="annot"><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier hs-type">pathSeparators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span id="pathSeparators"><span class="annot"><span class="annottext">pathSeparators :: FilePath
</span><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier hs-var hs-var">pathSeparators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\/&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/&quot;</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Rather than using @(== 'pathSeparator')@, use this. Test if something</span><span>
</span><span id="line-108"></span><span class="hs-comment">--   is a path separator.</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt; isPathSeparator a == (a `elem` pathSeparators)</span><span>
</span><span id="line-111"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-type">isPathSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-112"></span><span id="isPathSeparator"><span class="annot"><span class="annottext">isPathSeparator :: Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var hs-var">isPathSeparator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="System.EasyFile.FilePath.html#pathSeparators"><span class="hs-identifier hs-var">pathSeparators</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">{- xxx
-- | The character that is used to separate the entries in the $PATH environment variable.
--
-- &gt; Windows: searchPathSeparator == ';'
-- &gt; Posix:   searchPathSeparator == ':'
searchPathSeparator :: Char
searchPathSeparator = if isWindows then ';' else ':'

-- | Is the character a file separator?
--
-- &gt; isSearchPathSeparator a == (a == searchPathSeparator)
isSearchPathSeparator :: Char -&gt; Bool
isSearchPathSeparator = (== searchPathSeparator)
-}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | File extension character</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &gt; extSeparator == '.'</span><span>
</span><span id="line-133"></span><span class="annot"><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-type">extSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-134"></span><span id="extSeparator"><span class="annot"><span class="annottext">extSeparator :: Char
</span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var hs-var">extSeparator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Is the character an extension character?</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- &gt; isExtSeparator a == (a == extSeparator)</span><span>
</span><span id="line-139"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-type">isExtSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-140"></span><span id="isExtSeparator"><span class="annot"><span class="annottext">isExtSeparator :: Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var hs-var">isExtSeparator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var">extSeparator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">{- xxx
---------------------------------------------------------------------
-- Path methods (environment $PATH)

-- | Take a string, split it on the 'searchPathSeparator' character.
--
--   Follows the recommendations in
--   &lt;http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html&gt;
--
-- &gt; Posix:   splitSearchPath &quot;File1:File2:File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Posix:   splitSearchPath &quot;File1::File2:File3&quot; == [&quot;File1&quot;,&quot;.&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Windows: splitSearchPath &quot;File1;File2;File3&quot;  == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
-- &gt; Windows: splitSearchPath &quot;File1;;File2;File3&quot; == [&quot;File1&quot;,&quot;File2&quot;,&quot;File3&quot;]
splitSearchPath :: String -&gt; [FilePath]
splitSearchPath = f
    where
    f xs = case break isSearchPathSeparator xs of
           (pre, []    ) -&gt; g pre
           (pre, _:post) -&gt; g pre ++ f post

    g &quot;&quot; = [&quot;.&quot; | isPosix]
    g x = [x]


-- | Get a list of filepaths in the $PATH.
getSearchPath :: IO [FilePath]
getSearchPath = fmap splitSearchPath (getEnv &quot;PATH&quot;)
-}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Extension methods</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Split on the extension. 'addExtension' is the inverse.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- &gt; uncurry (++) (splitExtension x) == x</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt; uncurry addExtension (splitExtension x) == x</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt; splitExtension &quot;file.txt&quot; == (&quot;file&quot;,&quot;.txt&quot;)</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt; splitExtension &quot;file&quot; == (&quot;file&quot;,&quot;&quot;)</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt; splitExtension &quot;file/file.txt&quot; == (&quot;file/file&quot;,&quot;.txt&quot;)</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt; splitExtension &quot;file.txt/boris&quot; == (&quot;file.txt/boris&quot;,&quot;&quot;)</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- &gt; splitExtension &quot;file.txt/boris.ext&quot; == (&quot;file.txt/boris&quot;,&quot;.ext&quot;)</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- &gt; splitExtension &quot;file/path.txt.bob.fred&quot; == (&quot;file/path.txt.bob&quot;,&quot;.fred&quot;)</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- &gt; splitExtension &quot;file/path.txt/&quot; == (&quot;file/path.txt/&quot;,&quot;&quot;)</span><span>
</span><span id="line-188"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-type">splitExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="splitExtension"><span class="annot"><span class="annottext">splitExtension :: FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var hs-var">splitExtension</span></a></span></span><span> </span><span id="local-6989586621679041510"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041510"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041511"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041510"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621679041512"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041512"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041513"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041513"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041514"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041513"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041512"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041516"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041514"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041514"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041517"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041517"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041510"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041516"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041516"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041511"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041511"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; (FilePath, FilePath))
-&gt; FilePath -&gt; (FilePath, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041517"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Get the extension of a file, returns @\&quot;\&quot;@ for no extension, @.ext@ otherwise.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- &gt; takeExtension x == snd (splitExtension x)</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- &gt; Valid x =&gt; takeExtension (addExtension x &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- &gt; Valid x =&gt; takeExtension (replaceExtension x &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><span id="line-201"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier hs-type">takeExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-202"></span><span id="takeExtension"><span class="annot"><span class="annottext">takeExtension :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier hs-var hs-var">takeExtension</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Set the extension of a file, overwriting one if already present.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;bob&quot; == &quot;file.bob&quot;</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- &gt; replaceExtension &quot;file&quot; &quot;.bob&quot; == &quot;file.bob&quot;</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- &gt; replaceExtension &quot;file.txt&quot; &quot;&quot; == &quot;file&quot;</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- &gt; replaceExtension &quot;file.fred.bob&quot; &quot;txt&quot; == &quot;file.fred.txt&quot;</span><span>
</span><span id="line-211"></span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceExtension"><span class="hs-identifier hs-type">replaceExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-212"></span><span id="replaceExtension"><span class="annot"><span class="annottext">replaceExtension :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#replaceExtension"><span class="hs-identifier hs-var hs-var">replaceExtension</span></a></span></span><span> </span><span id="local-6989586621679041520"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041520"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679041521"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041521"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041520"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041521"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">-- | Alias to 'addExtension', for people who like that sort of thing.</span></span><span>
</span><span id="line-215"></span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-type">(&lt;.&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-216"></span><span id="%3C.%3E"><span class="annot"><span class="annottext">&lt;.&gt; :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var hs-var">(&lt;.&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-var">addExtension</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Remove last extension, and the \&quot;.\&quot; preceding it.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- &gt; dropExtension x == fst (splitExtension x)</span><span>
</span><span id="line-221"></span><span class="annot"><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-type">dropExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-222"></span><span id="dropExtension"><span class="annot"><span class="annottext">dropExtension :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var hs-var">dropExtension</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtension"><span class="hs-identifier hs-var">splitExtension</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Add an extension, even if there is already one there.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   E.g. @addExtension \&quot;foo.txt\&quot; \&quot;bat\&quot; -&gt; \&quot;foo.txt.bat\&quot;@.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- &gt; addExtension &quot;file.txt&quot; &quot;bib&quot; == &quot;file.txt.bib&quot;</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- &gt; addExtension &quot;file.&quot; &quot;.bib&quot; == &quot;file..bib&quot;</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- &gt; addExtension &quot;file&quot; &quot;.bib&quot; == &quot;file.bib&quot;</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- &gt; addExtension &quot;/&quot; &quot;x&quot; == &quot;/.x&quot;</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (addExtension (addTrailingPathSeparator x) &quot;ext&quot;) == &quot;.ext&quot;</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- &gt; Windows: addExtension &quot;\\\\share&quot; &quot;.txt&quot; == &quot;\\\\share\\.txt&quot;</span><span>
</span><span id="line-233"></span><span class="annot"><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-type">addExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-234"></span><span id="addExtension"><span class="annot"><span class="annottext">addExtension :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-var hs-var">addExtension</span></a></span></span><span> </span><span id="local-6989586621679041523"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041523"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041523"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-235"></span><span class="annot"><a href="System.EasyFile.FilePath.html#addExtension"><span class="hs-identifier hs-var">addExtension</span></a></span><span> </span><span id="local-6989586621679041524"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041524"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621679041525"><span class="annot"><span class="annottext">xs :: FilePath
</span><a href="#local-6989586621679041525"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679041526"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041526"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041527"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041528"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>        </span><span id="local-6989586621679041528"><span class="annot"><span class="annottext">res :: FilePath
</span><a href="#local-6989586621679041528"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041526"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041525"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-238"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#extSeparator"><span class="hs-identifier hs-var">extSeparator</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041525"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041527"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041527"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041529"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041529"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041524"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Does the given filename have an extension?</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- &gt; null (takeExtension x) == not (hasExtension x)</span><span>
</span><span id="line-245"></span><span class="annot"><a href="System.EasyFile.FilePath.html#hasExtension"><span class="hs-identifier hs-type">hasExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-246"></span><span id="hasExtension"><span class="annot"><span class="annottext">hasExtension :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasExtension"><span class="hs-identifier hs-var hs-var">hasExtension</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Split on all extensions</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- &gt; splitExtensions &quot;file.tar.gz&quot; == (&quot;file&quot;,&quot;.tar.gz&quot;)</span><span>
</span><span id="line-252"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-type">splitExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span id="splitExtensions"><span class="annot"><span class="annottext">splitExtensions :: FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var hs-var">splitExtensions</span></a></span></span><span> </span><span id="local-6989586621679041531"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041531"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041532"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041533"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041534"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041532"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041532"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041535"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041535"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041531"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041533"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041533"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041534"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041534"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isExtSeparator"><span class="hs-identifier hs-var">isExtSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041535"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Drop all extensions</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- &gt; not $ hasExtension (dropExtensions x)</span><span>
</span><span id="line-261"></span><span class="annot"><a href="System.EasyFile.FilePath.html#dropExtensions"><span class="hs-identifier hs-type">dropExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-262"></span><span id="dropExtensions"><span class="annot"><span class="annottext">dropExtensions :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropExtensions"><span class="hs-identifier hs-var hs-var">dropExtensions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var">splitExtensions</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Get all extensions</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- &gt; takeExtensions &quot;file.tar.gz&quot; == &quot;.tar.gz&quot;</span><span>
</span><span id="line-267"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeExtensions"><span class="hs-identifier hs-type">takeExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-268"></span><span id="takeExtensions"><span class="annot"><span class="annottext">takeExtensions :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeExtensions"><span class="hs-identifier hs-var hs-var">takeExtensions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitExtensions"><span class="hs-identifier hs-var">splitExtensions</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- Drive methods</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Is the given character a valid drive letter?</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- only a-z and A-Z are letters, not isAlpha which is more unicodey</span><span>
</span><span id="line-277"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-type">isLetter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-278"></span><span id="isLetter"><span class="annot"><span class="annottext">isLetter :: Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var hs-var">isLetter</span></a></span></span><span> </span><span id="local-6989586621679041537"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Split a path into a drive and a path.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--   On Unix, \/ is a Drive.</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- &gt; uncurry (++) (splitDrive x) == x</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;c:/file&quot; == (&quot;c:/&quot;,&quot;file&quot;)</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\shared\\test&quot; == (&quot;\\\\shared\\&quot;,&quot;test&quot;)</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\shared&quot; == (&quot;\\\\shared&quot;,&quot;&quot;)</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\UNC\\shared\\file&quot; == (&quot;\\\\?\\UNC\\shared\\&quot;,&quot;file&quot;)</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\UNCshared\\file&quot; == (&quot;\\\\?\\&quot;,&quot;UNCshared\\file&quot;)</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;\\\\?\\d:\\file&quot; == (&quot;\\\\?\\d:\\&quot;,&quot;file&quot;)</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- &gt; Windows: splitDrive &quot;/d&quot; == (&quot;&quot;,&quot;/d&quot;) -- xxx</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;/test&quot; == (&quot;/&quot;,&quot;test&quot;) -- xxx</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;//test&quot; == (&quot;//&quot;,&quot;test&quot;)</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;test/file&quot; == (&quot;&quot;,&quot;test/file&quot;)</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- &gt; Posix:   splitDrive &quot;file&quot; == (&quot;&quot;,&quot;file&quot;)</span><span>
</span><span id="line-297"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-type">splitDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span id="splitDrive"><span class="annot"><span class="annottext">splitDrive :: FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var hs-var">splitDrive</span></a></span></span><span> </span><span id="local-6989586621679041541"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041541"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041541"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span id="local-6989586621679041543"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041543"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041544"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; (FilePath, FilePath)
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041544"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679041544"><span class="annot"><span class="annottext">y :: Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041544"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041543"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span id="local-6989586621679041546"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041546"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041547"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; (FilePath, FilePath)
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041547"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679041547"><span class="annot"><span class="annottext">y :: Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041547"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier hs-var">readDriveUNC</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041546"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span id="local-6989586621679041549"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041549"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041550"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; (FilePath, FilePath)
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041550"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679041550"><span class="annot"><span class="annottext">y :: Maybe (FilePath, FilePath)
</span><a href="#local-6989586621679041550"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier hs-var">readDriveShare</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041549"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span id="local-6989586621679041552"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041552"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041552"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-type">addSlash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span id="addSlash"><span class="annot"><span class="annottext">addSlash :: FilePath -&gt; FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-var hs-var">addSlash</span></a></span></span><span> </span><span id="local-6989586621679041554"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041554"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679041555"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041555"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041554"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041556"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041557"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041556"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041556"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041557"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041557"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041555"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- &quot;\\?\D:\&lt;path&gt;&quot; or &quot;\\?\UNC\&lt;server&gt;\&lt;share&gt;&quot;</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- a is &quot;\\?\&quot;</span><span>
</span><span id="line-318"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier hs-type">readDriveUNC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span id="readDriveUNC"><span class="annot"><span class="annottext">readDriveUNC :: FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier hs-var hs-var">readDriveUNC</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041558"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041558"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041559"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041559"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041560"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041560"><span class="hs-identifier hs-var">s3</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041561"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041561"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041558"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041559"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041560"><span class="hs-identifier hs-var">s3</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041561"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'U'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'N'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'C'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041563"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041563"><span class="hs-identifier hs-var">s4</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041563"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041564"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041564"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041565"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041565"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-var">readDriveShareName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041561"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041558"><span class="hs-identifier hs-var">s1</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041559"><span class="hs-identifier hs-var">s2</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041560"><span class="hs-identifier hs-var">s3</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041561"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041564"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041565"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041561"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041569"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041569"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041570"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041570"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041558"><span class="hs-identifier hs-var">s1</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041559"><span class="hs-identifier hs-var">s2</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041560"><span class="hs-identifier hs-var">s3</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041569"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041570"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveUNC"><span class="hs-identifier hs-var">readDriveUNC</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">{- c:\ -}</span><span>
</span><span id="line-330"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-type">readDriveLetter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span id="readDriveLetter"><span class="annot"><span class="annottext">readDriveLetter :: FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var hs-var">readDriveLetter</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041571"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041571"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041572"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041572"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041573"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041573"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041571"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041572"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; Maybe (FilePath, FilePath))
-&gt; (FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-var">addSlash</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041571"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041572"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041573"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041574"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041574"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041575"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041575"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041574"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041574"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041575"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">{- \\sharename\ -}</span><span>
</span><span id="line-336"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier hs-type">readDriveShare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span id="readDriveShare"><span class="annot"><span class="annottext">readDriveShare :: FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier hs-var hs-var">readDriveShare</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041576"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041576"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041577"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041577"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041578"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041578"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041576"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041577"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; Maybe (FilePath, FilePath)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041576"><span class="hs-identifier hs-var">s1</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041577"><span class="hs-identifier hs-var">s2</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041579"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041580"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041579"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041579"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041580"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041580"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-var">readDriveShareName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041578"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-340"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveShare"><span class="hs-identifier hs-var">readDriveShare</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">{- assume you have already seen \\ -}</span><span>
</span><span id="line-343"></span><span class="hs-comment">{- share\bob -&gt; &quot;share&quot;,&quot;\&quot;,&quot;bob&quot; -}</span><span>
</span><span id="line-344"></span><span class="annot"><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-type">readDriveShareName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span id="readDriveShareName"><span class="annot"><span class="annottext">readDriveShareName :: FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveShareName"><span class="hs-identifier hs-var hs-var">readDriveShareName</span></a></span></span><span> </span><span id="local-6989586621679041581"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041581"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#addSlash"><span class="hs-identifier hs-var">addSlash</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041582"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041583"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041582"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041582"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041583"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041583"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041581"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Join a drive and the rest of the path.</span><span>
</span><span id="line-351"></span><span class="hs-comment">--</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- &gt;          uncurry joinDrive (splitDrive x) == x</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- &gt; Windows: joinDrive &quot;C:&quot; &quot;foo&quot; == &quot;C:foo&quot;</span><span>
</span><span id="line-354"></span><span class="hs-comment">-- &gt; Windows: joinDrive &quot;C:/&quot; &quot;bar&quot; == &quot;C:/bar&quot;</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- &gt; Windows: joinDrive &quot;\\\\share&quot; &quot;foo&quot; == &quot;\\\\share/foo&quot; -- xxx</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- &gt; Windows: joinDrive &quot;/:&quot; &quot;foo&quot; == &quot;/:/foo&quot; -- xxx</span><span>
</span><span id="line-357"></span><span class="annot"><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-type">joinDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-358"></span><span id="joinDrive"><span class="annot"><span class="annottext">joinDrive :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var hs-var">joinDrive</span></a></span></span><span> </span><span id="local-6989586621679041584"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679041585"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-359"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-360"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-361"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-362"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-363"></span><span>                                </span><span class="hs-special">[</span><span id="local-6989586621679041588"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041588"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isLetter"><span class="hs-identifier hs-var">isLetter</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041588"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-364"></span><span>                                </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041585"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Get the drive from a filepath.</span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- &gt; takeDrive x == fst (splitDrive x)</span><span>
</span><span id="line-369"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-type">takeDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-370"></span><span id="takeDrive"><span class="annot"><span class="annottext">takeDrive :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var hs-var">takeDrive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | Delete the drive, if it exists.</span><span>
</span><span id="line-373"></span><span class="hs-comment">--</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- &gt; dropDrive x == snd (splitDrive x)</span><span>
</span><span id="line-375"></span><span class="annot"><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-type">dropDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-376"></span><span id="dropDrive"><span class="annot"><span class="annottext">dropDrive :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var hs-var">dropDrive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Does a path have a drive.</span><span>
</span><span id="line-379"></span><span class="hs-comment">--</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- &gt; not (hasDrive x) == null (takeDrive x)</span><span>
</span><span id="line-381"></span><span class="annot"><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-type">hasDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-382"></span><span id="hasDrive"><span class="annot"><span class="annottext">hasDrive :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var hs-var">hasDrive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (FilePath -&gt; Bool) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><span class="hs-comment">-- | Is an element a drive</span></span><span>
</span><span id="line-386"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-type">isDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-387"></span><span id="isDrive"><span class="annot"><span class="annottext">isDrive :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var hs-var">isDrive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var">dropDrive</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- Operations on a filepath, as a list of directories</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Split a filename into directory and file. 'combine' is the inverse.</span><span>
</span><span id="line-394"></span><span class="hs-comment">--</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- &gt; uncurry (++) (splitFileName x) == x</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- &gt; Valid x =&gt; uncurry combine (splitFileName x) == x</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- &gt; splitFileName &quot;file/bob.txt&quot; == (&quot;file/&quot;, &quot;bob.txt&quot;)</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- &gt; splitFileName &quot;file/&quot; == (&quot;file/&quot;, &quot;&quot;)</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- &gt; splitFileName &quot;bob&quot; == (&quot;&quot;, &quot;bob&quot;)</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- &gt; Posix:   splitFileName &quot;/&quot; == (&quot;/&quot;,&quot;&quot;)</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- &gt; Windows: splitFileName &quot;c:&quot; == (&quot;c:&quot;,&quot;&quot;)</span><span>
</span><span id="line-402"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-type">splitFileName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span id="splitFileName"><span class="annot"><span class="annottext">splitFileName :: FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var hs-var">splitFileName</span></a></span></span><span> </span><span id="local-6989586621679041589"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041589"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041590"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041591"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041592"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041592"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041592"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041591"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041591"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; (FilePath, FilePath))
-&gt; FilePath -&gt; (FilePath, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041593"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041590"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041590"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041593"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041593"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041589"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- | Set the filename.</span><span>
</span><span id="line-410"></span><span class="hs-comment">--</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- &gt; Valid x =&gt; replaceFileName x (takeFileName x) == x</span><span>
</span><span id="line-412"></span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceFileName"><span class="hs-identifier hs-type">replaceFileName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-413"></span><span id="replaceFileName"><span class="annot"><span class="annottext">replaceFileName :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#replaceFileName"><span class="hs-identifier hs-var hs-var">replaceFileName</span></a></span></span><span> </span><span id="local-6989586621679041594"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041594"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679041595"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041595"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var">dropFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041594"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041595"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Drop the filename.</span><span>
</span><span id="line-416"></span><span class="hs-comment">--</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- &gt; dropFileName x == fst (splitFileName x)</span><span>
</span><span id="line-418"></span><span class="annot"><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-type">dropFileName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-419"></span><span id="dropFileName"><span class="annot"><span class="annottext">dropFileName :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var hs-var">dropFileName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Get the file name.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- &gt; takeFileName &quot;test/&quot; == &quot;&quot;</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- &gt; takeFileName x `isSuffixOf` x</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- &gt; takeFileName x == snd (splitFileName x)</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (replaceFileName x &quot;fred&quot;) == &quot;fred&quot;</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- &gt; Valid x =&gt; takeFileName (x &lt;/&gt; &quot;fred&quot;) == &quot;fred&quot;</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- &gt; Valid x =&gt; isRelative (takeFileName x)</span><span>
</span><span id="line-430"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-type">takeFileName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-431"></span><span id="takeFileName"><span class="annot"><span class="annottext">takeFileName :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var hs-var">takeFileName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath -&gt; (FilePath, FilePath)) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- | Get the base name, without an extension or path.</span><span>
</span><span id="line-434"></span><span class="hs-comment">--</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- &gt; takeBaseName &quot;file/test.txt&quot; == &quot;test&quot;</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- &gt; takeBaseName &quot;dave.ext&quot; == &quot;dave&quot;</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- &gt; takeBaseName &quot;&quot; == &quot;&quot;</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- &gt; takeBaseName &quot;test&quot; == &quot;test&quot;</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- &gt; takeBaseName (addTrailingPathSeparator x) == &quot;&quot;</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- &gt; takeBaseName &quot;file/file.tar.gz&quot; == &quot;file.tar&quot;</span><span>
</span><span id="line-441"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeBaseName"><span class="hs-identifier hs-type">takeBaseName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-442"></span><span id="takeBaseName"><span class="annot"><span class="annottext">takeBaseName :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeBaseName"><span class="hs-identifier hs-var hs-var">takeBaseName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- | Set the base name.</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt; replaceBaseName &quot;file/test.txt&quot; &quot;bob&quot; == &quot;file/bob.txt&quot;</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- &gt; replaceBaseName &quot;fred&quot; &quot;bill&quot; == &quot;bill&quot;</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- &gt; replaceBaseName &quot;/dave/fred/bob.gz.tar&quot; &quot;new&quot; == &quot;/dave/fred/new.tar&quot;</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- &gt; replaceBaseName x (takeBaseName x) == x</span><span>
</span><span id="line-450"></span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceBaseName"><span class="hs-identifier hs-type">replaceBaseName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-451"></span><span id="replaceBaseName"><span class="annot"><span class="annottext">replaceBaseName :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#replaceBaseName"><span class="hs-identifier hs-var hs-var">replaceBaseName</span></a></span></span><span> </span><span id="local-6989586621679041596"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041596"><span class="hs-identifier hs-var">pth</span></a></span></span><span> </span><span id="local-6989586621679041597"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041597"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041599"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041597"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041600"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041599"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041599"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041601"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041601"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitFileName"><span class="hs-identifier hs-var">splitFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041596"><span class="hs-identifier hs-var">pth</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621679041600"><span class="annot"><span class="annottext">ext :: FilePath
</span><a href="#local-6989586621679041600"><span class="hs-identifier hs-var hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeExtension"><span class="hs-identifier hs-var">takeExtension</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041601"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">-- | Is an item either a directory or the last character a path separator?</span><span>
</span><span id="line-457"></span><span class="hs-comment">--</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- &gt; hasTrailingPathSeparator &quot;test&quot; == False</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- &gt; hasTrailingPathSeparator &quot;test/&quot; == True</span><span>
</span><span id="line-460"></span><span class="annot"><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-type">hasTrailingPathSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-461"></span><span id="hasTrailingPathSeparator"><span class="annot"><span class="annottext">hasTrailingPathSeparator :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var hs-var">hasTrailingPathSeparator</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-462"></span><span class="annot"><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a></span><span> </span><span id="local-6989586621679041602"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041602"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041602"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Add a trailing file path separator if one is not already present.</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- &gt; hasTrailingPathSeparator (addTrailingPathSeparator x)</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- &gt; hasTrailingPathSeparator x ==&gt; addTrailingPathSeparator x == x</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- &gt; addTrailingPathSeparator &quot;test/rest&quot; == &quot;test/rest/&quot;</span><span>
</span><span id="line-470"></span><span class="annot"><a href="System.EasyFile.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier hs-type">addTrailingPathSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-471"></span><span id="addTrailingPathSeparator"><span class="annot"><span class="annottext">addTrailingPathSeparator :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#addTrailingPathSeparator"><span class="hs-identifier hs-var hs-var">addTrailingPathSeparator</span></a></span></span><span> </span><span id="local-6989586621679041603"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041603"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Remove any trailing path separators</span><span>
</span><span id="line-475"></span><span class="hs-comment">--</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- &gt; dropTrailingPathSeparator &quot;file/test/&quot; == &quot;file/test&quot;</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- &gt; not (hasTrailingPathSeparator (dropTrailingPathSeparator x)) || isDrive x</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- &gt; dropTrailingPathSeparator &quot;/&quot; == &quot;/&quot;</span><span>
</span><span id="line-479"></span><span class="annot"><a href="System.EasyFile.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-type">dropTrailingPathSeparator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-480"></span><span id="dropTrailingPathSeparator"><span class="annot"><span class="annottext">dropTrailingPathSeparator :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropTrailingPathSeparator"><span class="hs-identifier hs-var hs-var">dropTrailingPathSeparator</span></a></span></span><span> </span><span id="local-6989586621679041604"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasTrailingPathSeparator"><span class="hs-identifier hs-var">hasTrailingPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679041605"><span class="annot"><span class="annottext">x' :: FilePath
</span><a href="#local-6989586621679041605"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-483"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041605"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041605"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041604"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | Get the directory name, move up one level.</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- &gt;           takeDirectory x `isPrefixOf` x</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- &gt;           takeDirectory &quot;foo&quot; == &quot;&quot;</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- &gt;           takeDirectory &quot;/foo/bar/baz&quot; == &quot;/foo/bar&quot;</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &gt;           takeDirectory &quot;/foo/bar/baz/&quot; == &quot;/foo/bar/baz&quot;</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- &gt;           takeDirectory &quot;foo/bar/baz&quot; == &quot;foo/bar&quot;</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- &gt; Windows:  takeDirectory &quot;foo\\bar\\\\&quot; == &quot;foo\\bar&quot; -- xxx</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- &gt; Windows:  takeDirectory &quot;C:/&quot; == &quot;C:/&quot;</span><span>
</span><span id="line-496"></span><span class="annot"><a href="System.EasyFile.FilePath.html#takeDirectory"><span class="hs-identifier hs-type">takeDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-497"></span><span id="takeDirectory"><span class="annot"><span class="annottext">takeDirectory :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeDirectory"><span class="hs-identifier hs-var hs-var">takeDirectory</span></a></span></span><span> </span><span id="local-6989586621679041607"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041607"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-498"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041609"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-499"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041609"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>        </span><span id="local-6989586621679041609"><span class="annot"><span class="annottext">res :: FilePath
</span><a href="#local-6989586621679041609"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span id="local-6989586621679041608"><span class="annot"><span class="annottext">file :: FilePath
</span><a href="#local-6989586621679041608"><span class="hs-identifier hs-var hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropFileName"><span class="hs-identifier hs-var">dropFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041607"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- | Set the directory, keeping the filename the same.</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- &gt; replaceDirectory x (takeDirectory x) `equalFilePath` x</span><span>
</span><span id="line-507"></span><span class="annot"><a href="System.EasyFile.FilePath.html#replaceDirectory"><span class="hs-identifier hs-type">replaceDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-508"></span><span id="replaceDirectory"><span class="annot"><span class="annottext">replaceDirectory :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#replaceDirectory"><span class="hs-identifier hs-var hs-var">replaceDirectory</span></a></span></span><span> </span><span id="local-6989586621679041610"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041610"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679041611"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041611"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeFileName"><span class="hs-identifier hs-var">takeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041610"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">-- | Combine two paths, if the second path 'isAbsolute', then it returns the second.</span><span>
</span><span id="line-512"></span><span class="hs-comment">--</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- &gt; Valid x =&gt; combine (takeDirectory x) (takeFileName x) `equalFilePath` x</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- &gt; combine &quot;/&quot; &quot;test&quot; == &quot;/test&quot;</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- &gt; combine &quot;home&quot; &quot;bob&quot; == &quot;home/bob&quot;</span><span>
</span><span id="line-516"></span><span class="annot"><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-517"></span><span id="combine"><span class="annot"><span class="annottext">combine :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679041612"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041612"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679041613"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var">hasDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-518"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var">combineAlways</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041612"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041613"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="annot"><span class="hs-comment">-- | Combine two paths, assuming rhs is NOT absolute.</span></span><span>
</span><span id="line-521"></span><span class="annot"><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-type">combineAlways</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-522"></span><span id="combineAlways"><span class="annot"><span class="annottext">combineAlways :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combineAlways"><span class="hs-identifier hs-var hs-var">combineAlways</span></a></span></span><span> </span><span id="local-6989586621679041615"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679041616"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-523"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-524"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-525"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isDrive"><span class="hs-identifier hs-var">isDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-526"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041615"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041616"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="annot"><span class="hs-comment">-- | A nice alias for 'combine'.</span></span><span>
</span><span id="line-530"></span><span class="annot"><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-type">(&lt;/&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-531"></span><span id="%3C%2F%3E"><span class="annot"><span class="annottext">&lt;/&gt; :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#%3C%2F%3E"><span class="hs-operator hs-var hs-var">(&lt;/&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | Split a path by the directory separator.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- &gt; concat (splitPath x) == x</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- &gt; splitPath &quot;test//item/&quot; == [&quot;test//&quot;,&quot;item/&quot;]</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- &gt; splitPath &quot;test/item/file&quot; == [&quot;test/&quot;,&quot;item/&quot;,&quot;file&quot;]</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- &gt; splitPath &quot;&quot; == []</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- &gt; Windows: splitPath &quot;c:/test/path&quot; == [&quot;c:/&quot;,&quot;test/&quot;,&quot;path&quot;]</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- &gt; Posix:   splitPath &quot;/file/test&quot; == [&quot;/&quot;,&quot;file/&quot;,&quot;test&quot;]</span><span>
</span><span id="line-542"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier hs-type">splitPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-543"></span><span id="splitPath"><span class="annot"><span class="annottext">splitPath :: FilePath -&gt; [FilePath]
</span><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier hs-var hs-var">splitPath</span></a></span></span><span> </span><span id="local-6989586621679041617"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041617"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041618"><span class="hs-identifier hs-var">drive</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041618"><span class="hs-identifier hs-var">drive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="#local-6989586621679041620"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041621"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041618"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041618"><span class="hs-identifier hs-var">drive</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041621"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041621"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041617"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>        </span><span id="local-6989586621679041620"><span class="annot"><span class="annottext">f :: FilePath -&gt; [FilePath]
</span><a href="#local-6989586621679041620"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><a href="#local-6989586621679041620"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621679041622"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041622"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041623"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041624"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="#local-6989586621679041620"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041625"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-549"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-550"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679041623"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041623"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041626"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041626"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041622"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-551"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679041624"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041624"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041625"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041625"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041626"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-comment">-- | Just as 'splitPath', but don't add the trailing slashes to each element.</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- &gt; splitDirectories &quot;test/file&quot; == [&quot;test&quot;,&quot;file&quot;]</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- &gt; splitDirectories &quot;/test/file&quot; == [&quot;/&quot;,&quot;test&quot;,&quot;file&quot;]</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- &gt; Valid x =&gt; joinPath (splitDirectories x) `equalFilePath` x</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- &gt; splitDirectories &quot;&quot; == []</span><span>
</span><span id="line-559"></span><span class="annot"><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier hs-type">splitDirectories</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span id="splitDirectories"><span class="annot"><span class="annottext">splitDirectories :: FilePath -&gt; [FilePath]
</span><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier hs-var hs-var">splitDirectories</span></a></span></span><span> </span><span id="local-6989586621679041627"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041627"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#hasDrive"><span class="hs-identifier hs-var">hasDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041627"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041628"><span class="hs-identifier hs-var">pathComponents</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041629"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041628"><span class="hs-identifier hs-var">pathComponents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041629"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041628"><span class="hs-identifier hs-var">pathComponents</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-564"></span><span>        </span><span id="local-6989586621679041628"><span class="annot"><span class="annottext">pathComponents :: [FilePath]
</span><a href="#local-6989586621679041628"><span class="hs-identifier hs-var hs-var">pathComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="System.EasyFile.FilePath.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041627"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span>        </span><span id="local-6989586621679041629"><span class="annot"><span class="annottext">f :: [FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041629"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679041631"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041631"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041632"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041631"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621679041632"><span class="annot"><span class="annottext">g :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041632"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679041634"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041634"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041635"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041634"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041635"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-568"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679041635"><span class="annot"><span class="annottext">res :: FilePath
</span><a href="#local-6989586621679041635"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041634"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">-- | Join path elements back together.</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- &gt; Valid x =&gt; joinPath (splitPath x) == x</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- &gt; joinPath [] == &quot;&quot;</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- &gt; Posix: joinPath [&quot;test&quot;,&quot;file&quot;,&quot;path&quot;] == &quot;test/file/path&quot;</span><span>
</span><span id="line-576"></span><span>
</span><span id="line-577"></span><span class="hs-comment">-- Note that this definition on c:\\c:\\, join then split will give c:\\.</span><span>
</span><span id="line-578"></span><span class="annot"><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier hs-type">joinPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-579"></span><span id="joinPath"><span class="annot"><span class="annottext">joinPath :: [FilePath] -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier hs-var hs-var">joinPath</span></a></span></span><span> </span><span id="local-6989586621679041637"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041637"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; FilePath)
-&gt; FilePath -&gt; [FilePath] -&gt; FilePath
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041637"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">---------------------------------------------------------------------</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- File name manipulators</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | Equality of two 'FilePath's.</span><span>
</span><span id="line-590"></span><span class="hs-comment">--   If you call @System.Directory.canonicalizePath@</span><span>
</span><span id="line-591"></span><span class="hs-comment">--   first this has a much better chance of working.</span><span>
</span><span id="line-592"></span><span class="hs-comment">--   Note that this doesn't follow symlinks or DOSNAM~1s.</span><span>
</span><span id="line-593"></span><span class="hs-comment">--</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- &gt;          x == y ==&gt; equalFilePath x y</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- &gt;          normalise x == normalise y ==&gt; equalFilePath x y</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- &gt; Posix:   equalFilePath &quot;foo&quot; &quot;foo/&quot;</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;/foo&quot;)</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- &gt; Posix:   not (equalFilePath &quot;foo&quot; &quot;FOO&quot;)</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- &gt; Windows: equalFilePath &quot;foo&quot; &quot;FOO&quot;</span><span>
</span><span id="line-600"></span><span class="annot"><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-type">equalFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-601"></span><span id="equalFilePath"><span class="annot"><span class="annottext">equalFilePath :: FilePath -&gt; FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var hs-var">equalFilePath</span></a></span></span><span> </span><span id="local-6989586621679041639"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041639"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679041640"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041640"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041641"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041639"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041641"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041640"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>        </span><span id="local-6989586621679041641"><span class="annot"><span class="annottext">f :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041641"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679041642"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041642"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isWindows"><span class="hs-identifier hs-var">isWindows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041643"><span class="hs-identifier hs-var">dropTrailSlash</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041642"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-604"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041643"><span class="hs-identifier hs-var">dropTrailSlash</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041642"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span>        </span><span id="local-6989586621679041643"><span class="annot"><span class="annottext">dropTrailSlash :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041643"><span class="hs-identifier hs-var hs-var">dropTrailSlash</span></a></span></span><span> </span><span id="local-6989586621679041653"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041653"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041653"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041653"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041653"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-607"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041653"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="hs-comment">-- | Contract a filename, based on a relative path.</span><span>
</span><span id="line-611"></span><span class="hs-comment">--</span><span>
</span><span id="line-612"></span><span class="hs-comment">--   There is no corresponding @makeAbsolute@ function, instead use</span><span>
</span><span id="line-613"></span><span class="hs-comment">--   @System.Directory.canonicalizePath@ which has the same effect.</span><span>
</span><span id="line-614"></span><span class="hs-comment">--</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- &gt;          Valid y =&gt; equalFilePath x y || (isRelative x &amp;&amp; makeRelative y x == x) || equalFilePath (y &lt;/&gt; makeRelative y x) x</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- &gt;          makeRelative x x == &quot;.&quot;</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- &gt;          null y || equalFilePath (makeRelative x (x &lt;/&gt; y)) y || null (takeFileName x)</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;c:/home/bob&quot; == &quot;bob&quot;</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;D:/Home/Bob&quot; == &quot;D:/Home/Bob&quot;</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- &gt; Windows: makeRelative &quot;C:/Home&quot; &quot;C:Home/Bob&quot; == &quot;C:Home/Bob&quot;</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- &gt; Windows: makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;bob&quot;</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/Home&quot; &quot;/home/bob&quot; == &quot;/home/bob&quot;</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/home/&quot; &quot;/home/bob/foo/bar&quot; == &quot;bob/foo/bar&quot;</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/fred&quot; &quot;bob&quot; == &quot;bob&quot;</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred&quot; == &quot;fred&quot;</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;/file/test&quot; &quot;/file/test/fred/&quot; == &quot;fred/&quot;</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- &gt; Posix:   makeRelative &quot;some/path&quot; &quot;some/path/a/b/c&quot; == &quot;a/b/c&quot;</span><span>
</span><span id="line-628"></span><span class="annot"><a href="System.EasyFile.FilePath.html#makeRelative"><span class="hs-identifier hs-type">makeRelative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-629"></span><span id="makeRelative"><span class="annot"><span class="annottext">makeRelative :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#makeRelative"><span class="hs-identifier hs-var hs-var">makeRelative</span></a></span></span><span> </span><span id="local-6989586621679041656"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span id="local-6989586621679041657"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span></span><span>
</span><span id="line-630"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var">equalFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-631"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041658"><span class="hs-identifier hs-var">takeAbs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041658"><span class="hs-identifier hs-var">takeAbs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-632"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041660"><span class="hs-identifier hs-var">dropAbs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041656"><span class="hs-identifier hs-var">root</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041660"><span class="hs-identifier hs-var">dropAbs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-634"></span><span>        </span><span id="local-6989586621679041659"><span class="annot"><span class="annottext">f :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span id="local-6989586621679041661"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041661"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041661"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-635"></span><span>        </span><span class="annot"><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621679041662"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041662"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679041663"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041663"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041664"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041664"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041665"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041665"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="#local-6989586621679041666"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041662"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-636"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679041667"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041667"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041668"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041668"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="#local-6989586621679041666"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041663"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-637"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#equalFilePath"><span class="hs-identifier hs-var">equalFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041664"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041667"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621679041659"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041665"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041668"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041657"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679041666"><span class="annot"><span class="annottext">g :: FilePath -&gt; (FilePath, FilePath)
</span><a href="#local-6989586621679041666"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679041669"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041669"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041670"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041671"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041670"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041670"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041671"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041671"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; (FilePath, FilePath)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; (FilePath, FilePath))
-&gt; FilePath -&gt; (FilePath, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041669"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>        </span><span class="hs-comment">-- on windows, need to drop '/' which is kind of absolute, but not a drive</span><span>
</span><span id="line-643"></span><span>        </span><span id="local-6989586621679041660"><span class="annot"><span class="annottext">dropAbs :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041660"><span class="hs-identifier hs-var hs-var">dropAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041672"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041672"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041673"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041673"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041673"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><a href="#local-6989586621679041660"><span class="hs-identifier hs-var">dropAbs</span></a></span><span> </span><span id="local-6989586621679041674"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041674"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#dropDrive"><span class="hs-identifier hs-var">dropDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041674"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span>        </span><span id="local-6989586621679041658"><span class="annot"><span class="annottext">takeAbs :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041658"><span class="hs-identifier hs-var hs-var">takeAbs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041675"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041675"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041675"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span>        </span><span class="annot"><a href="#local-6989586621679041658"><span class="hs-identifier hs-var">takeAbs</span></a></span><span> </span><span id="local-6989586621679041676"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041676"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679041677"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041677"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041677"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041677"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041676"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="hs-comment">-- | Normalise a file</span><span>
</span><span id="line-650"></span><span class="hs-comment">--</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- * \/\/ outside of the drive can be made blank</span><span>
</span><span id="line-652"></span><span class="hs-comment">--</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- * \/ -&gt; 'pathSeparator'</span><span>
</span><span id="line-654"></span><span class="hs-comment">--</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- * .\/ -&gt; \&quot;\&quot;</span><span>
</span><span id="line-656"></span><span class="hs-comment">--</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;/file/\\test////&quot; == &quot;/file/\\test/&quot;</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;/file/./test&quot; == &quot;/file/test&quot;</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;/test/file/../bob/fred/&quot; == &quot;/test/file/../bob/fred/&quot;</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;../bob/fred/&quot; == &quot;../bob/fred/&quot;</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;./bob/fred/&quot; == &quot;bob/fred/&quot;</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- &gt; Windows: normalise &quot;c:\\file/bob\\&quot; == &quot;C:/file/bob/&quot;</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- &gt; Windows: normalise &quot;c:/&quot; == &quot;C:/&quot;</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- &gt; Windows: normalise &quot;\\\\server\\test&quot; == &quot;\\\\server\\test&quot; -- xxx</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- &gt; Windows: normalise &quot;.&quot; == &quot;.&quot;</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- &gt; Posix:   normalise &quot;./&quot; == &quot;./&quot;</span><span>
</span><span id="line-667"></span><span class="annot"><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-type">normalise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-668"></span><span id="normalise"><span class="annot"><span class="annottext">normalise :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#normalise"><span class="hs-identifier hs-var hs-var">normalise</span></a></span></span><span> </span><span id="local-6989586621679041678"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041678"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinDrive"><span class="hs-identifier hs-var">joinDrive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier hs-var">normaliseDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041680"><span class="hs-identifier hs-var">drv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041681"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041682"><span class="hs-identifier hs-var">pth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>              </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041682"><span class="hs-identifier hs-var">pth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041682"><span class="hs-identifier hs-var">pth</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-671"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679041680"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041680"><span class="hs-identifier hs-var">drv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679041682"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041682"><span class="hs-identifier hs-var">pth</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#splitDrive"><span class="hs-identifier hs-var">splitDrive</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041678"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>        </span><span id="local-6989586621679041681"><span class="annot"><span class="annottext">f :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041681"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#joinPath"><span class="hs-identifier hs-var">joinPath</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; FilePath)
-&gt; (FilePath -&gt; [FilePath]) -&gt; FilePath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041683"><span class="hs-identifier hs-var">dropDots</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [FilePath])
-&gt; (FilePath -&gt; [FilePath]) -&gt; FilePath -&gt; [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="System.EasyFile.FilePath.html#splitDirectories"><span class="hs-identifier hs-var">splitDirectories</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [FilePath])
-&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>        </span><span id="local-6989586621679041684"><span class="annot"><span class="annottext">propSep :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679041684"><span class="hs-identifier hs-var hs-var">propSep</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041685"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041685"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041686"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041686"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041687"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041687"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041685"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041686"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041685"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041687"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>        </span><span class="annot"><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041688"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041688"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041689"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041689"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041688"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041689"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-679"></span><span>        </span><span class="annot"><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041690"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041690"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041691"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041691"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041690"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><a href="#local-6989586621679041684"><span class="hs-identifier hs-var">propSep</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-681"></span><span>
</span><span id="line-682"></span><span>        </span><span id="local-6989586621679041683"><span class="annot"><span class="annottext">dropDots :: [FilePath] -&gt; [FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041683"><span class="hs-identifier hs-var hs-var">dropDots</span></a></span></span><span> </span><span id="local-6989586621679041693"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041693"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041694"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041694"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041694"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041683"><span class="hs-identifier hs-var">dropDots</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041693"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041694"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-683"></span><span>        </span><span class="annot"><a href="#local-6989586621679041683"><span class="hs-identifier hs-var">dropDots</span></a></span><span> </span><span id="local-6989586621679041695"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041695"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679041696"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041696"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679041697"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041697"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
</span><a href="#local-6989586621679041683"><span class="hs-identifier hs-var">dropDots</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041696"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041695"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041697"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><a href="#local-6989586621679041683"><span class="hs-identifier hs-var">dropDots</span></a></span><span> </span><span id="local-6989586621679041698"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041698"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679041698"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="annot"><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier hs-type">normaliseDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-687"></span><span id="normaliseDrive"><span class="annot"><span class="annottext">normaliseDrive :: FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier hs-var hs-var">normaliseDrive</span></a></span></span><span> </span><span id="local-6989586621679041699"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041699"><span class="hs-identifier hs-var">drive</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="System.EasyFile.FilePath.html#isPosix"><span class="hs-identifier hs-var">isPosix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041699"><span class="hs-identifier hs-var">drive</span></a></span><span>
</span><span id="line-688"></span><span class="annot"><a href="System.EasyFile.FilePath.html#normaliseDrive"><span class="hs-identifier hs-var">normaliseDrive</span></a></span><span> </span><span id="local-6989586621679041700"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041700"><span class="hs-identifier hs-var">drive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, FilePath) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (FilePath, FilePath) -&gt; Bool)
-&gt; Maybe (FilePath, FilePath) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041701"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-689"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041701"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-690"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041700"><span class="hs-identifier hs-var">drive</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-692"></span><span>        </span><span id="local-6989586621679041701"><span class="annot"><span class="annottext">x2 :: FilePath
</span><a href="#local-6989586621679041701"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><a href="#local-6989586621679041702"><span class="hs-identifier hs-var">repSlash</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041700"><span class="hs-identifier hs-var">drive</span></a></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span>        </span><span id="local-6989586621679041702"><span class="annot"><span class="annottext">repSlash :: Char -&gt; Char
</span><a href="#local-6989586621679041702"><span class="hs-identifier hs-var hs-var">repSlash</span></a></span></span><span> </span><span id="local-6989586621679041703"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041703"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041703"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="System.EasyFile.FilePath.html#pathSeparator"><span class="hs-identifier hs-var">pathSeparator</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679041703"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">{- xxx
-- information for validity functions on Windows
-- see http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/fs/naming_a_file.asp
badCharacters :: [Char]
badCharacters = &quot;:*?&gt;&lt;|\&quot;&quot;
badElements :: [FilePath]
badElements = [&quot;CON&quot;, &quot;PRN&quot;, &quot;AUX&quot;, &quot;NUL&quot;, &quot;COM1&quot;, &quot;COM2&quot;, &quot;COM3&quot;, &quot;COM4&quot;, &quot;COM5&quot;, &quot;COM6&quot;, &quot;COM7&quot;, &quot;COM8&quot;, &quot;COM9&quot;, &quot;LPT1&quot;, &quot;LPT2&quot;, &quot;LPT3&quot;, &quot;LPT4&quot;, &quot;LPT5&quot;, &quot;LPT6&quot;, &quot;LPT7&quot;, &quot;LPT8&quot;, &quot;LPT9&quot;, &quot;CLOCK$&quot;]

-- | Is a FilePath valid, i.e. could you create a file like it?
--
-- &gt;          isValid &quot;&quot; == False
-- &gt; Posix:   isValid &quot;/random_ path:*&quot; == True
-- &gt; Posix:   isValid x == not (null x)
-- &gt; Windows: isValid &quot;c:\\test&quot; == True
-- &gt; Windows: isValid &quot;c:\\test:of_test&quot; == False
-- &gt; Windows: isValid &quot;test*&quot; == False
-- &gt; Windows: isValid &quot;c:\\test\\nul&quot; == False
-- &gt; Windows: isValid &quot;c:\\test\\prn.txt&quot; == False
-- &gt; Windows: isValid &quot;c:\\nul\\file&quot; == False
-- &gt; Windows: isValid &quot;\\\\&quot; == False
isValid :: FilePath -&gt; Bool
isValid &quot;&quot; = False
isValid _ | isPosix = True
isValid path =
        not (any (`elem` badCharacters) x2) &amp;&amp;
        not (any f $ splitDirectories x2) &amp;&amp;
        not (length path &gt;= 2 &amp;&amp; all isPathSeparator path)
    where
        x2 = dropDrive path
        f x = map toUpper (dropExtensions x) `elem` badElements


-- | Take a FilePath and make it valid; does not change already valid FilePaths.
--
-- &gt; isValid (makeValid x)
-- &gt; isValid x ==&gt; makeValid x == x
-- &gt; makeValid &quot;&quot; == &quot;_&quot;
-- &gt; Windows: makeValid &quot;c:\\test:of_test&quot; == &quot;c:\\test_of_test&quot;
-- &gt; Windows: makeValid &quot;test*&quot; == &quot;test_&quot;
-- &gt; Windows: makeValid &quot;c:\\test\\nul&quot; == &quot;c:\\test\\nul_&quot;
-- &gt; Windows: makeValid &quot;c:\\test\\prn.txt&quot; == &quot;c:\\test\\prn_.txt&quot;
-- &gt; Windows: makeValid &quot;c:\\test/prn.txt&quot; == &quot;c:\\test/prn_.txt&quot;
-- &gt; Windows: makeValid &quot;c:\\nul\\file&quot; == &quot;c:\\nul_\\file&quot;
makeValid :: FilePath -&gt; FilePath
makeValid &quot;&quot; = &quot;_&quot;
makeValid path | isPosix = path
makeValid x | length x &gt;= 2 &amp;&amp; all isPathSeparator x = take 2 x ++ &quot;drive&quot;
makeValid path = joinDrive drv $ validElements $ validChars pth
    where
        (drv,pth) = splitDrive path

        validChars x = map f x
        f x | x `elem` badCharacters = '_'
            | otherwise = x

        validElements x = joinPath $ map g $ splitPath x
        g x = h (reverse b) ++ reverse a
            where (a,b) = span isPathSeparator $ reverse x
        h x = if map toUpper a `elem` badElements then a ++ &quot;_&quot; &lt;.&gt; b else x
            where (a,b) = splitExtensions x
-}</span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span class="hs-comment">-- | Is a path relative, or is it fixed to the root?</span><span>
</span><span id="line-759"></span><span class="hs-comment">--</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;path\\test&quot; == True</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:\\test&quot; == False</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:test&quot; == True</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;c:&quot; == True</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;\\\\foo&quot; == False</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- &gt; Windows: isRelative &quot;/foo&quot; == True</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- &gt; Posix:   isRelative &quot;test/path&quot; == True</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- &gt; Posix:   isRelative &quot;/test&quot; == False</span><span>
</span><span id="line-768"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier hs-type">isRelative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-769"></span><span id="isRelative"><span class="annot"><span class="annottext">isRelative :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier hs-var hs-var">isRelative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isRelativeDrive"><span class="hs-identifier hs-var">isRelativeDrive</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Bool) -&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="System.EasyFile.FilePath.html#takeDrive"><span class="hs-identifier hs-var">takeDrive</span></a></span><span>
</span><span id="line-770"></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="hs-comment">-- &gt; isRelativeDrive &quot;&quot; == True</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:\\&quot; == False</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:/&quot; == False</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;c:&quot; == True</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- &gt; Windows: isRelativeDrive &quot;\\\\foo&quot; == False</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- &gt; Posix:   isRelativeDrive &quot;/&quot; == False</span><span>
</span><span id="line-778"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isRelativeDrive"><span class="hs-identifier hs-type">isRelativeDrive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-779"></span><span id="isRelativeDrive"><span class="annot"><span class="annottext">isRelativeDrive :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isRelativeDrive"><span class="hs-identifier hs-var hs-var">isRelativeDrive</span></a></span></span><span> </span><span id="local-6989586621679041705"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041705"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-780"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; ((FilePath, FilePath) -&gt; Bool)
-&gt; Maybe (FilePath, FilePath)
-&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((FilePath, FilePath) -&gt; Bool) -&gt; (FilePath, FilePath) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isPathSeparator"><span class="hs-identifier hs-var">isPathSeparator</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool)
-&gt; ((FilePath, FilePath) -&gt; Char) -&gt; (FilePath, FilePath) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Char
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Char)
-&gt; ((FilePath, FilePath) -&gt; FilePath)
-&gt; (FilePath, FilePath)
-&gt; Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe (FilePath, FilePath)
</span><a href="System.EasyFile.FilePath.html#readDriveLetter"><span class="hs-identifier hs-var">readDriveLetter</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679041705"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- | @not . 'isRelative'@</span><span>
</span><span id="line-784"></span><span class="hs-comment">--</span><span>
</span><span id="line-785"></span><span class="hs-comment">-- &gt; isAbsolute x == not (isRelative x)</span><span>
</span><span id="line-786"></span><span class="annot"><a href="System.EasyFile.FilePath.html#isAbsolute"><span class="hs-identifier hs-type">isAbsolute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-787"></span><span id="isAbsolute"><span class="annot"><span class="annottext">isAbsolute :: FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isAbsolute"><span class="hs-identifier hs-var hs-var">isAbsolute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (FilePath -&gt; Bool) -&gt; FilePath -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="System.EasyFile.FilePath.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span class="hs-comment">{-
Copyright Neil Mitchell 2005-2007.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of Neil Mitchell nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-}</span><span>
</span><span id="line-821"></span></pre></body></html>