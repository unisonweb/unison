<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Network.Wai</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">wai-3.2.4: Web Application Interface.</span><ul class="links" id="page-menu"><li><a href="src/Network.Wai.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Network.Wai</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Types</a></li><li><a href="#g:2">Request</a><ul><li><a href="#g:3">Request accessors</a></li><li><a href="#g:4">Request modifiers</a></li></ul></li><li><a href="#g:5">Response</a><ul><li><a href="#g:6">Response composers</a></li><li><a href="#g:7">Response accessors</a></li><li><a href="#g:8">Response modifiers</a></li></ul></li><li><a href="#g:9">Middleware composition</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module defines a generic web application interface. It is a common
protocol between web servers and web applications.</p><p>The overriding design principles here are performance and generality. To
address performance, this library uses a streaming interface for request and
response bodies, paired with bytestring's <code><a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a></code> type.  The advantages of a
streaming API over lazy IO have been debated elsewhere and so will not be
addressed here.  However, helper functions like <code><a href="Network-Wai.html#v:responseLBS" title="Network.Wai">responseLBS</a></code> allow you to
continue using lazy IO if you so desire.</p><p>Generality is achieved by removing many variables commonly found in similar
projects that are not universal to all servers. The goal is that the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code>
object contains only data which is meaningful in all circumstances.</p><p>Please remember when using this package that, while your application may
compile without a hitch against many different servers, there are other
considerations to be taken when moving to a new backend. For example, if you
transfer from a CGI application to a FastCGI one, you might suddenly find you
have a memory leak. Conversely, a FastCGI application would be well served to
preload all templates from disk when first starting; this would kill the
performance of a CGI application.</p><p>This package purposely provides very little functionality. You can find various
middlewares, backends and utilities on Hackage. Some of the most commonly used
include:</p><dl><dt>warp</dt><dd><a href="http://hackage.haskell.org/package/warp">http://hackage.haskell.org/package/warp</a></dd><dt>wai-extra</dt><dd><a href="http://hackage.haskell.org/package/wai-extra">http://hackage.haskell.org/package/wai-extra</a></dd></dl></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Application">Application</a> = <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; (<a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-Wai.html#t:ResponseReceived" title="Network.Wai">ResponseReceived</a>) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-Wai.html#t:ResponseReceived" title="Network.Wai">ResponseReceived</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Middleware">Middleware</a> = <a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a> -&gt; <a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ResponseReceived">ResponseReceived</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Request">Request</a></li><li class="src short"><a href="#v:defaultRequest">defaultRequest</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:RequestBodyLength">RequestBodyLength</a><ul class="subs"><li>= <a href="#v:ChunkedBody">ChunkedBody</a></li><li>| <a href="#v:KnownLength">KnownLength</a> <a href="../base-4.18.2.1/Data-Word.html#t:Word64" title="Data.Word">Word64</a></li></ul></li><li class="src short"><a href="#v:requestMethod">requestMethod</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Method.html#t:Method" title="Network.HTTP.Types.Method">Method</a></li><li class="src short"><a href="#v:httpVersion">httpVersion</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Version.html#t:HttpVersion" title="Network.HTTP.Types.Version">HttpVersion</a></li><li class="src short"><a href="#v:rawPathInfo">rawPathInfo</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:rawQueryString">rawQueryString</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:requestHeaders">requestHeaders</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a></li><li class="src short"><a href="#v:isSecure">isSecure</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:remoteHost">remoteHost</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../network-3.1.4.0/Network-Socket.html#t:SockAddr" title="Network.Socket">SockAddr</a></li><li class="src short"><a href="#v:pathInfo">pathInfo</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>]</li><li class="src short"><a href="#v:queryString">queryString</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-URI.html#t:Query" title="Network.HTTP.Types.URI">Query</a></li><li class="src short"><a href="#v:getRequestBodyChunk">getRequestBodyChunk</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:requestBody">requestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:vault">vault</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../vault-0.3.1.5/Data-Vault-Lazy.html#t:Vault" title="Data.Vault.Lazy">Vault</a></li><li class="src short"><a href="#v:requestBodyLength">requestBodyLength</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a></li><li class="src short"><a href="#v:requestHeaderHost">requestHeaderHost</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:requestHeaderRange">requestHeaderRange</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:requestHeaderReferer">requestHeaderReferer</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:requestHeaderUserAgent">requestHeaderUserAgent</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:strictRequestBody">strictRequestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></li><li class="src short"><a href="#v:consumeRequestBodyStrict">consumeRequestBodyStrict</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></li><li class="src short"><a href="#v:lazyRequestBody">lazyRequestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></li><li class="src short"><a href="#v:consumeRequestBodyLazy">consumeRequestBodyLazy</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></li><li class="src short"><a href="#v:setRequestBodyChunks">setRequestBodyChunks</a> :: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></li><li class="src short"><a href="#v:mapRequestHeaders">mapRequestHeaders</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a>) -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Response">Response</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:StreamingBody">StreamingBody</a> = (<a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:FilePart">FilePart</a> = <a href="#v:FilePart">FilePart</a> {<ul class="subs"><li><a href="#v:filePartOffset">filePartOffset</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li><a href="#v:filePartByteCount">filePartByteCount</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li><a href="#v:filePartFileSize">filePartFileSize</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></li></ul>}</li><li class="src short"><a href="#v:responseFile">responseFile</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:responseBuilder">responseBuilder</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:responseLBS">responseLBS</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:responseStream">responseStream</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="Network-Wai.html#t:StreamingBody" title="Network.Wai">StreamingBody</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:responseRaw">responseRaw</a> :: (<a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; (<a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:responseStatus">responseStatus</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a></li><li class="src short"><a href="#v:responseHeaders">responseHeaders</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a></li><li class="src short"><a href="#v:responseToStream">responseToStream</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; (<a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a>, <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a>, (<a href="Network-Wai.html#t:StreamingBody" title="Network.Wai">StreamingBody</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a)</li><li class="src short"><a href="#v:mapResponseHeaders">mapResponseHeaders</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a>) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:mapResponseStatus">mapResponseStatus</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a>) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></li><li class="src short"><a href="#v:ifRequest">ifRequest</a> :: (<a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a> -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></li><li class="src short"><a href="#v:modifyRequest">modifyRequest</a> :: (<a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></li><li class="src short"><a href="#v:modifyResponse">modifyResponse</a> :: (<a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Types</h1></a><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Application" class="def">Application</a> = <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; (<a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-Wai.html#t:ResponseReceived" title="Network.Wai">ResponseReceived</a>) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Network-Wai.html#t:ResponseReceived" title="Network.Wai">ResponseReceived</a> <a href="src/Network.Wai.html#Application" class="link">Source</a> <a href="#t:Application" class="selflink">#</a></p><div class="doc"><p>The WAI application.</p><p>Note that, since WAI 3.0, this type is structured in continuation passing
 style to allow for proper safe resource handling. This was handled in the
 past via other means (e.g., <code>ResourceT</code>). As a demonstration:</p><pre>app :: Application
app req respond = bracket_
    (putStrLn &quot;Allocating scarce resource&quot;)
    (putStrLn &quot;Cleaning up&quot;)
    (respond $ responseLBS status200 [] &quot;Hello World&quot;)
</pre></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Middleware" class="def">Middleware</a> = <a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a> -&gt; <a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a> <a href="src/Network.Wai.html#Middleware" class="link">Source</a> <a href="#t:Middleware" class="selflink">#</a></p><div class="doc"><p>A <code>Middleware</code> is a component that sits between the server and application.</p><p>It can modify both the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code> and <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code>,
 to provide simple transformations that are required for all (or most of)
 your web server&#8217;s routes.</p><h1>Users of middleware</h1><p>If you are trying to apply one or more <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code>s to your <code><a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></code>,
 just call them as functions.</p><p>For example, if you have <code>corsMiddleware</code> and <code>authorizationMiddleware</code>,
 and you want to authorize first, you can do:</p><pre>let allMiddleware app = authorizationMiddleware (corsMiddleware app)
</pre><p>to get a new <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code>, which first authorizes, then sets, CORS headers.
 The &#8220;outer&#8221; middleware is called first.</p><p>You can also chain them via <code><a href="../base-4.18.2.1/Data-Function.html#v:." title="Data.Function">(.)</a></code>:</p><pre>let allMiddleware =
        authorizationMiddleware
      . corsMiddleware
      . &#8230; more middleware here &#8230;
</pre><p>Then, once you have an <code>app :: Application</code>, you can wrap it
 in your middleware:</p><pre>let myApp = allMiddleware app :: Application
</pre><p>and run it as usual:</p><pre>Warp.run port myApp
</pre><h1>Authors of middleware</h1><p>When fully expanded, <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code> has the type signature:</p><pre>(Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived) -&gt; Request -&gt; (Response -&gt; IO ResponseReceived) -&gt; IO ResponseReceived</pre><p>or if we shorten to <code>type Respond = Response -&gt; IO ResponseReceived</code>:</p><pre>(Request -&gt; Respond -&gt; IO ResponseReceived) -&gt; Request -&gt; Respond -&gt; IO ResponseReceived</pre><p>so a middleware definition takes 3 arguments, an inner application, a request and a response callback.</p><p>Compare with the type of a simple <code><a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></code>:</p><pre>Request -&gt; Respond -&gt; IO ResponseReceived</pre><p>It takes the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code> and <code>Respond</code>, but not the extra application.</p><p>Said differently, a middleware has the power of a normal <code><a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></code>
 &#8212; it can inspect the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code> and return a <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> &#8212;
 but it can (and in many cases it <em>should</em>) also call the <code><a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></code> which was passed to it.</p><h2>Modifying the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code></h2><p>A lot of middleware just looks at the request and does something based on its values.</p><p>For example, the <code>authorizationMiddleware</code> from above could look at the <code>Authorization</code>
 HTTP header and run <a href="https://jwt.io/">JWT</a> verification logic against the database.</p><pre>authorizationMiddleware app req respond = do
  case verifyJWT (<code><a href="Network-Wai.html#v:requestHeaders" title="Network.Wai">requestHeaders</a></code> req) of
    InvalidJWT err -&gt; respond (invalidJWTResponse err)
    ValidJWT -&gt; app req respond
</pre><p>Notice how the inner app is called when the validation was successful.
 If it was not, we can respond
 e.g. with <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401">HTTP 401 Unauthorized</a>,
 by constructing a <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> with <code><a href="Network-Wai.html#v:responseLBS" title="Network.Wai">responseLBS</a></code> and passing it to <code>respond</code>.</p><h2>Passing arguments to and from your <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code></h2><p>Middleware must often be configurable.
 Let&#8217;s say you have a type <code>JWTSettings</code> that you want to be passed to the middleware.
 Simply pass an extra argument to your middleware. Then your middleware type turns into:</p><pre>authorizationMiddleware :: JWTSettings -&gt; Application -&gt; Request -&gt; Respond -&gt; IO ResponseReceived
authorizationMiddleware jwtSettings req respond =
  case verifyJWT jwtSettings (<code><a href="Network-Wai.html#v:requestHeaders" title="Network.Wai">requestHeaders</a></code> req) of
    InvalidJWT err -&gt; respond (invalidJWTResponse err)
    ValidJWT -&gt; app req respond
</pre><p>or alternatively:</p><pre>authorizationMiddleware :: JWTSettings -&gt; Middleware
</pre><p>Perhaps less intuitively, you can also <em>pass on</em> data from middleware to the wrapped <code><a href="Network-Wai.html#t:Application" title="Network.Wai">Application</a></code>:</p><pre>authorizationMiddleware :: JWTSettings -&gt; (JWT -&gt; Application) -&gt; Request -&gt; Respond -&gt; IO ResponseReceived
authorizationMiddleware jwtSettings req respond =
  case verifyJWT jwtSettings (<code><a href="Network-Wai.html#v:requestHeaders" title="Network.Wai">requestHeaders</a></code> req) of
    InvalidJWT err -&gt; respond (invalidJWTResponse err)
    ValidJWT jwt -&gt; app jwt req respond
</pre><p>although then, chaining different middleware has to take this extra argument into account:</p><pre>let finalApp =
      authorizationMiddleware
        (\jwt -&gt; corsMiddleware
           (&#8230; more middleware here &#8230;
             (app jwt)))
</pre><h2>Modifying the <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code></h2><p><code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code> can also modify the <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> that is returned by the inner application.</p><p>This is done by taking the <code>respond</code> callback, using it to define a new <code>respond'</code>,
 and passing this new <code>respond'</code> to the <code>app</code>:</p><pre>gzipMiddleware app req respond = do
  let respond' resp = do
        resp' &lt;- gzipResponseBody resp
        respond resp'
  app req respond'
</pre><p>However, modifying the response (especially the response body) is not trivial,
 so in order to get a sense of how to do it (dealing with the type of <code><a href="Network-Wai.html#v:responseToStream" title="Network.Wai">responseToStream</a></code>),
 it&#8217;s best to look at an example, for example <a href="https://hackage.haskell.org/package/wai-extra/docs/src/Network.Wai.Middleware.Gzip.html#gzip">the GZIP middleware of wai-extra</a>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ResponseReceived" class="def">ResponseReceived</a> <a href="src/Network.Wai.Internal.html#ResponseReceived" class="link">Source</a> <a href="#t:ResponseReceived" class="selflink">#</a></p><div class="doc"><p>A special datatype to indicate that the WAI handler has received the
 response. This is to avoid the need for Rank2Types in the definition of
 Application.</p><p>It is <em>highly</em> advised that only WAI handlers import and use the data
 constructor for this data type.</p><p><em>Since: 3.0.0</em></p></div></div><a href="#g:2" id="g:2"><h1>Request</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Request" class="def">Request</a> <a href="src/Network.Wai.Internal.html#Request" class="link">Source</a> <a href="#t:Request" class="selflink">#</a></p><div class="doc"><p>Information on the request sent by the client. This abstracts away the
 details of the underlying implementation.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Request">Instances</h4><details id="i:Request" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Request:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></span> <a href="src/Network.Wai.Internal.html#line-111" class="link">Source</a> <a href="#t:Request" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Request:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-Wai-Internal.html">Network.Wai.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:defaultRequest" class="def">defaultRequest</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> <a href="src/Network.Wai.html#defaultRequest" class="link">Source</a> <a href="#v:defaultRequest" class="selflink">#</a></p><div class="doc"><p>A default, blank request.</p><p><em>Since: 2.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RequestBodyLength" class="def">RequestBodyLength</a> <a href="src/Network.Wai.Internal.html#RequestBodyLength" class="link">Source</a> <a href="#t:RequestBodyLength" class="selflink">#</a></p><div class="doc"><p>The size of the request body. In the case of chunked bodies, the size will
 not be known.</p><p><em>Since: 1.4.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ChunkedBody" class="def">ChunkedBody</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:KnownLength" class="def">KnownLength</a> <a href="../base-4.18.2.1/Data-Word.html#t:Word64" title="Data.Word">Word64</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RequestBodyLength">Instances</h4><details id="i:RequestBodyLength" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RequestBodyLength:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a></span> <a href="src/Network.Wai.Internal.html#line-151" class="link">Source</a> <a href="#t:RequestBodyLength" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RequestBodyLength:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-Wai-Internal.html">Network.Wai.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:3" id="g:3"><h2>Request accessors</h2></a><div class="top"><p class="src"><a id="v:requestMethod" class="def">requestMethod</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Method.html#t:Method" title="Network.HTTP.Types.Method">Method</a> <a href="src/Network.Wai.Internal.html#requestMethod" class="link">Source</a> <a href="#v:requestMethod" class="selflink">#</a></p><div class="doc"><p>Request method such as GET.</p></div></div><div class="top"><p class="src"><a id="v:httpVersion" class="def">httpVersion</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Version.html#t:HttpVersion" title="Network.HTTP.Types.Version">HttpVersion</a> <a href="src/Network.Wai.Internal.html#httpVersion" class="link">Source</a> <a href="#v:httpVersion" class="selflink">#</a></p><div class="doc"><p>HTTP version such as 1.1.</p></div></div><div class="top"><p class="src"><a id="v:rawPathInfo" class="def">rawPathInfo</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#rawPathInfo" class="link">Source</a> <a href="#v:rawPathInfo" class="selflink">#</a></p><div class="doc"><p>Extra path information sent by the client. The meaning varies slightly
 depending on backend; in a standalone server setting, this is most likely
 all information after the domain name. In a CGI application, this would be
 the information following the path to the CGI executable itself.</p><p>Middlewares and routing tools should not modify this raw value, as it may
 be used for such things as creating redirect destinations by applications.
 Instead, if you are writing a middleware or routing framework, modify the
 <code>pathInfo</code> instead. This is the approach taken by systems like Yesod
 subsites.</p><p><em>Note</em>: At the time of writing this documentation, there is at least one
 system (<code>Network.Wai.UrlMap</code> from <code>wai-extra</code>) that does not follow the
 above recommendation. Therefore, it is recommended that you test the
 behavior of your application when using <code>rawPathInfo</code> and any form of
 library that might modify the <code>Request</code>.</p></div></div><div class="top"><p class="src"><a id="v:rawQueryString" class="def">rawQueryString</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#rawQueryString" class="link">Source</a> <a href="#v:rawQueryString" class="selflink">#</a></p><div class="doc"><p>If no query string was specified, this should be empty. This value
 <em>will</em> include the leading question mark.
 Do not modify this raw value - modify queryString instead.</p></div></div><div class="top"><p class="src"><a id="v:requestHeaders" class="def">requestHeaders</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a> <a href="src/Network.Wai.Internal.html#requestHeaders" class="link">Source</a> <a href="#v:requestHeaders" class="selflink">#</a></p><div class="doc"><p>A list of headers (a pair of key and value) in an HTTP request.</p></div></div><div class="top"><p class="src"><a id="v:isSecure" class="def">isSecure</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Network.Wai.Internal.html#isSecure" class="link">Source</a> <a href="#v:isSecure" class="selflink">#</a></p><div class="doc"><p>Was this request made over an SSL connection?</p><p>Note that this value will <em>not</em> tell you if the client originally made
 this request over SSL, but rather whether the current connection is SSL.
 The distinction lies with reverse proxies. In many cases, the client will
 connect to a load balancer over SSL, but connect to the WAI handler
 without SSL. In such a case, <code><a href="Network-Wai.html#v:isSecure" title="Network.Wai">isSecure</a></code> will be <code><a href="../base-4.18.2.1/Data-Bool.html#v:False" title="Data.Bool">False</a></code>, but from a user
 perspective, there is a secure connection.</p></div></div><div class="top"><p class="src"><a id="v:remoteHost" class="def">remoteHost</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../network-3.1.4.0/Network-Socket.html#t:SockAddr" title="Network.Socket">SockAddr</a> <a href="src/Network.Wai.Internal.html#remoteHost" class="link">Source</a> <a href="#v:remoteHost" class="selflink">#</a></p><div class="doc"><p>The client's host information.</p></div></div><div class="top"><p class="src"><a id="v:pathInfo" class="def">pathInfo</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>] <a href="src/Network.Wai.Internal.html#pathInfo" class="link">Source</a> <a href="#v:pathInfo" class="selflink">#</a></p><div class="doc"><p>Path info in individual pieces - the URL without a hostname/port and
 without a query string, split on forward slashes.</p></div></div><div class="top"><p class="src"><a id="v:queryString" class="def">queryString</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-URI.html#t:Query" title="Network.HTTP.Types.URI">Query</a> <a href="src/Network.Wai.Internal.html#queryString" class="link">Source</a> <a href="#v:queryString" class="selflink">#</a></p><div class="doc"><p>Parsed query string information.</p></div></div><div class="top"><p class="src"><a id="v:getRequestBodyChunk" class="def">getRequestBodyChunk</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#getRequestBodyChunk" class="link">Source</a> <a href="#v:getRequestBodyChunk" class="selflink">#</a></p><div class="doc"><p>Get the next chunk of the body. Returns <code><a href="../bytestring-0.11.5.3/Data-ByteString.html#v:empty" title="Data.ByteString">empty</a></code> when the
 body is fully consumed.</p><p><em>Since: 3.2.2</em></p></div></div><div class="top"><p class="src"><a id="v:requestBody" class="def">requestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#requestBody" class="link">Source</a> <a href="#v:requestBody" class="selflink">#</a></p><div class="doc"><div class="warning"><p>Deprecated: requestBody's name is misleading because it only gets a partial chunk of the body. Use getRequestBodyChunk instead when getting the field, and setRequestBodyChunks when setting the field.</p></div><p>Get the next chunk of the body. Returns <code><a href="../bytestring-0.11.5.3/Data-ByteString.html#v:empty" title="Data.ByteString">empty</a></code> when the
 body is fully consumed. Since 3.2.2, this is deprecated in favor of <code><a href="Network-Wai.html#v:getRequestBodyChunk" title="Network.Wai">getRequestBodyChunk</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:vault" class="def">vault</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../vault-0.3.1.5/Data-Vault-Lazy.html#t:Vault" title="Data.Vault.Lazy">Vault</a> <a href="src/Network.Wai.Internal.html#vault" class="link">Source</a> <a href="#v:vault" class="selflink">#</a></p><div class="doc"><p>A location for arbitrary data to be shared by applications and middleware.</p></div></div><div class="top"><p class="src"><a id="v:requestBodyLength" class="def">requestBodyLength</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:RequestBodyLength" title="Network.Wai">RequestBodyLength</a> <a href="src/Network.Wai.Internal.html#requestBodyLength" class="link">Source</a> <a href="#v:requestBodyLength" class="selflink">#</a></p><div class="doc"><p>The size of the request body. In the case of a chunked request body,
 this may be unknown.</p><p><em>Since: 1.4.0</em></p></div></div><div class="top"><p class="src"><a id="v:requestHeaderHost" class="def">requestHeaderHost</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#requestHeaderHost" class="link">Source</a> <a href="#v:requestHeaderHost" class="selflink">#</a></p><div class="doc"><p>The value of the Host header in a HTTP request.</p><p><em>Since: 2.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:requestHeaderRange" class="def">requestHeaderRange</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#requestHeaderRange" class="link">Source</a> <a href="#v:requestHeaderRange" class="selflink">#</a></p><div class="doc"><p>The value of the Range header in a HTTP request.</p><p><em>Since: 2.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:requestHeaderReferer" class="def">requestHeaderReferer</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#requestHeaderReferer" class="link">Source</a> <a href="#v:requestHeaderReferer" class="selflink">#</a></p><div class="doc"><p>The value of the Referer header in a HTTP request.</p><p><em>Since: 3.2.0</em></p></div></div><div class="top"><p class="src"><a id="v:requestHeaderUserAgent" class="def">requestHeaderUserAgent</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Network.Wai.Internal.html#requestHeaderUserAgent" class="link">Source</a> <a href="#v:requestHeaderUserAgent" class="selflink">#</a></p><div class="doc"><p>The value of the User-Agent header in a HTTP request.</p><p><em>Since: 3.2.0</em></p></div></div><div class="doc"><h2>Streaming Request Bodies</h2><p>WAI is designed for streaming in request bodies, which allows you to process them incrementally.
 You can stream in the request body using functions like <code><a href="Network-Wai.html#v:getRequestBodyChunk" title="Network.Wai">getRequestBodyChunk</a></code>,
 the <code>wai-conduit</code> package, or Yesod's <code>rawRequestBody</code>.</p><p>In the normal case, incremental processing is more efficient, since it
 reduces maximum total memory usage.
 In the worst case, it helps protect your server against denial-of-service (DOS) attacks, in which
 an attacker sends huge request bodies to your server.</p><p>Consider these tips to avoid reading the entire request body into memory:</p><ul><li>Look for library functions that support incremental processing. Sometimes these will use streaming
 libraries like <code>conduit</code>, <code>pipes</code>, or <code>streaming</code>.</li><li>Any attoparsec parser supports streaming input. For an example of this, see the
 <a href="Data-Conduit-Attoparsec.html">Data.Conduit.Attoparsec</a> module in <code>conduit-extra</code>.</li><li>Consider streaming directly to a file on disk. For an example of this, see the
 <a href="Data-Conduit-Binary.html">Data.Conduit.Binary</a> module in <code>conduit-extra</code>.</li><li>If you need to direct the request body to multiple destinations, you can stream to both those
 destinations at the same time.
 For example, if you wanted to run an HMAC on the request body as well as parse it into JSON,
 you could use Conduit's <code>zipSinks</code> to send the data to <code>cryptonite-conduit</code>'s <code>sinkHMAC</code> and
 <code>aeson</code>'s Attoparsec parser.</li><li>If possible, avoid processing large data on your server at all.
 For example, instead of uploading a file to your server and then to AWS S3,
 you can have the browser upload directly to S3.</li></ul><p>That said, sometimes it is convenient, or even necessary to read the whole request body into memory.
 For these purposes, functions like <code><a href="Network-Wai.html#v:strictRequestBody" title="Network.Wai">strictRequestBody</a></code> or <code><a href="Network-Wai.html#v:lazyRequestBody" title="Network.Wai">lazyRequestBody</a></code> can be used.
 When this is the case, consider these strategies to mitigating potential DOS attacks:</p><ul><li>Set a limit on the request body size you allow.
 If certain endpoints need larger bodies, whitelist just those endpoints for the large size.
 Be especially cautious about endpoints that don't require authentication, since these are easier to DOS.
 You can accomplish this with <code>wai-extra</code>'s <code>requestSizeLimitMiddleware</code> or Yesod's <code>maximumContentLength</code>.</li><li>Consider rate limiting not just on total requests, but also on total bytes sent in.</li><li>Consider using services that allow you to identify and blacklist attackers.</li><li>Minimize the amount of time the request body stays in memory.</li><li>If you need to share request bodies across middleware and your application, you can do so using Wai's <code><a href="Network-Wai.html#v:vault" title="Network.Wai">vault</a></code>.
 If you do this, remove the request body from the vault as soon as possible.</li></ul><p>Warning: Incremental processing will not always be sufficient to prevent a DOS attack.
 For example, if an attacker sends you a JSON body with a 2MB long string inside,
 even if you process the body incrementally, you'll still end up with a 2MB-sized <code>Text</code>.</p><p>To mitigate this, employ some of the countermeasures listed above,
 and try to reject such payloads as early as possible in your codebase.</p></div><div class="top"><p class="src"><a id="v:strictRequestBody" class="def">strictRequestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> <a href="src/Network.Wai.html#strictRequestBody" class="link">Source</a> <a href="#v:strictRequestBody" class="selflink">#</a></p><div class="doc"><p>Get the request body as a lazy ByteString. However, do <em>not</em> use any lazy
 I/O, instead reading the entire body into memory strictly.</p><p>Note: Since this function consumes the request body, future calls to it will return the empty string.</p><p><em>Since: 3.0.1</em></p></div></div><div class="top"><p class="src"><a id="v:consumeRequestBodyStrict" class="def">consumeRequestBodyStrict</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> <a href="src/Network.Wai.html#consumeRequestBodyStrict" class="link">Source</a> <a href="#v:consumeRequestBodyStrict" class="selflink">#</a></p><div class="doc"><p>Synonym for <code><a href="Network-Wai.html#v:strictRequestBody" title="Network.Wai">strictRequestBody</a></code>.
 This function name is meant to signal the non-idempotent nature of <code><a href="Network-Wai.html#v:strictRequestBody" title="Network.Wai">strictRequestBody</a></code>.</p><p><em>Since: 3.2.3</em></p></div></div><div class="top"><p class="src"><a id="v:lazyRequestBody" class="def">lazyRequestBody</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> <a href="src/Network.Wai.html#lazyRequestBody" class="link">Source</a> <a href="#v:lazyRequestBody" class="selflink">#</a></p><div class="doc"><p>Get the request body as a lazy ByteString. This uses lazy I/O under the
 surface, and therefore all typical warnings regarding lazy I/O apply.</p><p>Note: Since this function consumes the request body, future calls to it will return the empty string.</p><p><em>Since: 1.4.1</em></p></div></div><div class="top"><p class="src"><a id="v:consumeRequestBodyLazy" class="def">consumeRequestBodyLazy</a> :: <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> <a href="src/Network.Wai.html#consumeRequestBodyLazy" class="link">Source</a> <a href="#v:consumeRequestBodyLazy" class="selflink">#</a></p><div class="doc"><p>Synonym for <code><a href="Network-Wai.html#v:lazyRequestBody" title="Network.Wai">lazyRequestBody</a></code>.
 This function name is meant to signal the non-idempotent nature of <code><a href="Network-Wai.html#v:lazyRequestBody" title="Network.Wai">lazyRequestBody</a></code>.</p><p><em>Since: 3.2.3</em></p></div></div><a href="#g:4" id="g:4"><h2>Request modifiers</h2></a><div class="top"><p class="src"><a id="v:setRequestBodyChunks" class="def">setRequestBodyChunks</a> :: <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> <a href="src/Network.Wai.Internal.html#setRequestBodyChunks" class="link">Source</a> <a href="#v:setRequestBodyChunks" class="selflink">#</a></p><div class="doc"><p>Set the <code><a href="Network-Wai.html#v:requestBody" title="Network.Wai">requestBody</a></code> attribute on a request without triggering a
 deprecation warning.</p><p>The supplied IO action should return the next chunk of the body each time it
 is called and <code><a href="../bytestring-0.11.5.3/Data-ByteString.html#v:empty" title="Data.ByteString">empty</a></code> when it has been fully consumed.</p><p><em>Since: 3.2.4</em></p></div></div><div class="top"><p class="src"><a id="v:mapRequestHeaders" class="def">mapRequestHeaders</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:RequestHeaders" title="Network.HTTP.Types.Header">RequestHeaders</a>) -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> <a href="src/Network.Wai.html#mapRequestHeaders" class="link">Source</a> <a href="#v:mapRequestHeaders" class="selflink">#</a></p><div class="doc"><p>Apply the provided function to the request header list of the <code><a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a></code>.</p><p><em>Since: 3.2.4</em></p></div></div><a href="#g:5" id="g:5"><h1>Response</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Response" class="def">Response</a> <a href="src/Network.Wai.Internal.html#Response" class="link">Source</a> <a href="#t:Response" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:StreamingBody" class="def">StreamingBody</a> = (<a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/Network.Wai.Internal.html#StreamingBody" class="link">Source</a> <a href="#t:StreamingBody" class="selflink">#</a></p><div class="doc"><p>Represents a streaming HTTP response body. It's a function of two
 parameters; the first parameter provides a means of sending another chunk of
 data, and the second parameter provides a means of flushing the data to the
 client.</p><p><em>Since: 3.0.0</em></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FilePart" class="def">FilePart</a> <a href="src/Network.Wai.Internal.html#FilePart" class="link">Source</a> <a href="#t:FilePart" class="selflink">#</a></p><div class="doc"><p>Information on which part to be sent.
   Sophisticated application handles Range (and If-Range) then
   create <code><a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a></code>.</p><p><em>Since: 0.4.0</em></p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:FilePart" class="def">FilePart</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:filePartOffset" class="def">filePartOffset</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:filePartByteCount" class="def">filePartByteCount</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:filePartFileSize" class="def">filePartFileSize</a> :: <a href="../base-4.18.2.1/Prelude.html#t:Integer" title="Prelude">Integer</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:FilePart">Instances</h4><details id="i:FilePart" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilePart:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a></span> <a href="src/Network.Wai.Internal.html#line-162" class="link">Source</a> <a href="#t:FilePart" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilePart:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Network-Wai-Internal.html">Network.Wai.Internal</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:6" id="g:6"><h2>Response composers</h2></a><div class="top"><p class="src"><a id="v:responseFile" class="def">responseFile</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Network-Wai.html#t:FilePart" title="Network.Wai">FilePart</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#responseFile" class="link">Source</a> <a href="#v:responseFile" class="selflink">#</a></p><div class="doc"><p>Creating <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> from a file.</p><p><em>Since: 2.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:responseBuilder" class="def">responseBuilder</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#responseBuilder" class="link">Source</a> <a href="#v:responseBuilder" class="selflink">#</a></p><div class="doc"><p>Creating <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> from <code><a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a></code>.</p><p>Some questions and answers about the usage of <code><a href="../binary-0.8.9.1/Data-Binary-Builder.html#t:Builder" title="Data.Binary.Builder">Builder</a></code> here:</p><p>Q1. Shouldn't it be at the user's discretion to use Builders internally and
 then create a stream of ByteStrings?</p><p>A1. That would be less efficient, as we wouldn't get cheap concatenation
 with the response headers.</p><p>Q2. Isn't it really inefficient to convert from ByteString to Builder, and
 then right back to ByteString?</p><p>A2. No. If the ByteStrings are small, then they will be copied into a larger
 buffer, which should be a performance gain overall (less system calls). If
 they are already large, then an insert operation is used
 to avoid copying.</p><p>Q3. Doesn't this prevent us from creating comet-style servers, since data
 will be cached?</p><p>A3. You can force a Builder to output a ByteString before it is an
 optimal size by sending a flush command.</p><p><em>Since: 2.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:responseLBS" class="def">responseLBS</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#responseLBS" class="link">Source</a> <a href="#v:responseLBS" class="selflink">#</a></p><div class="doc"><p>Creating <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> from <code><a href="../bytestring-0.11.5.3/Data-ByteString-Lazy.html#t:ByteString" title="Data.ByteString.Lazy">ByteString</a></code>. This is a wrapper for
   <code><a href="Network-Wai.html#v:responseBuilder" title="Network.Wai">responseBuilder</a></code>.</p><p><em>Since: 0.3.0</em></p></div></div><div class="top"><p class="src"><a id="v:responseStream" class="def">responseStream</a> :: <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="Network-Wai.html#t:StreamingBody" title="Network.Wai">StreamingBody</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#responseStream" class="link">Source</a> <a href="#v:responseStream" class="selflink">#</a></p><div class="doc"><p>Creating <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> from a stream of values.</p><p>In order to allocate resources in an exception-safe manner, you can use the
 <code>bracket</code> pattern outside of the call to <code>responseStream</code>. As a trivial
 example:</p><pre>app :: Application
app req respond = bracket_
    (putStrLn &quot;Allocating scarce resource&quot;)
    (putStrLn &quot;Cleaning up&quot;)
    $ respond $ responseStream status200 [] $ \write flush -&gt; do
        write $ byteString &quot;Hello\n&quot;
        flush
        write $ byteString &quot;World\n&quot;
</pre><p>Note that in some cases you can use <code>bracket</code> from inside <code>responseStream</code>
 as well. However, placing the call on the outside allows your status value
 and response headers to depend on the scarce resource.</p><p><em>Since: 3.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:responseRaw" class="def">responseRaw</a> :: (<a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; (<a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> ()) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#responseRaw" class="link">Source</a> <a href="#v:responseRaw" class="selflink">#</a></p><div class="doc"><p>Create a response for a raw application. This is useful for &quot;upgrade&quot;
 situations such as WebSockets, where an application requests for the server
 to grant it raw network access.</p><p>This function requires a backup response to be provided, for the case where
 the handler in question does not support such upgrading (e.g., CGI apps).</p><p>In the event that you read from the request body before returning a
 <code>responseRaw</code>, behavior is undefined.</p><p><em>Since: 2.1.0</em></p></div></div><a href="#g:7" id="g:7"><h2>Response accessors</h2></a><div class="top"><p class="src"><a id="v:responseStatus" class="def">responseStatus</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> <a href="src/Network.Wai.html#responseStatus" class="link">Source</a> <a href="#v:responseStatus" class="selflink">#</a></p><div class="doc"><p>Accessing <code><a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a></code> in <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code>.</p><p><em>Since: 1.2.0</em></p></div></div><div class="top"><p class="src"><a id="v:responseHeaders" class="def">responseHeaders</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> <a href="src/Network.Wai.html#responseHeaders" class="link">Source</a> <a href="#v:responseHeaders" class="selflink">#</a></p><div class="doc"><p>Accessing <code><a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a></code> in <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code>.</p><p><em>Since: 2.0.0</em></p></div></div><a href="#g:8" id="g:8"><h2>Response modifiers</h2></a><div class="top"><p class="src"><a id="v:responseToStream" class="def">responseToStream</a> :: <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; (<a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a>, <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a>, (<a href="Network-Wai.html#t:StreamingBody" title="Network.Wai">StreamingBody</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) <a href="src/Network.Wai.html#responseToStream" class="link">Source</a> <a href="#v:responseToStream" class="selflink">#</a></p><div class="doc"><p>Converting the body information in <code><a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a></code> to a <code><a href="Network-Wai.html#t:StreamingBody" title="Network.Wai">StreamingBody</a></code>.</p><p><em>Since: 3.0.0</em></p></div></div><div class="top"><p class="src"><a id="v:mapResponseHeaders" class="def">mapResponseHeaders</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Header.html#t:ResponseHeaders" title="Network.HTTP.Types.Header">ResponseHeaders</a>) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#mapResponseHeaders" class="link">Source</a> <a href="#v:mapResponseHeaders" class="selflink">#</a></p><div class="doc"><p>Apply the provided function to the response header list of the Response.</p><p><em>Since: 3.0.3.0</em></p></div></div><div class="top"><p class="src"><a id="v:mapResponseStatus" class="def">mapResponseStatus</a> :: (<a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a> -&gt; <a href="../http-types-0.12.4/Network-HTTP-Types-Status.html#t:Status" title="Network.HTTP.Types.Status">Status</a>) -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> <a href="src/Network.Wai.html#mapResponseStatus" class="link">Source</a> <a href="#v:mapResponseStatus" class="selflink">#</a></p><div class="doc"><p>Apply the provided function to the response status of the Response.</p><p><em>Since: 3.2.1</em></p></div></div><a href="#g:9" id="g:9"><h1>Middleware composition</h1></a><div class="top"><p class="src"><a id="v:ifRequest" class="def">ifRequest</a> :: (<a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a> -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a> <a href="src/Network.Wai.html#ifRequest" class="link">Source</a> <a href="#v:ifRequest" class="selflink">#</a></p><div class="doc"><p>Conditionally apply a <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code></p><p><em>Since: 3.0.3.0</em></p></div></div><div class="top"><p class="src"><a id="v:modifyRequest" class="def">modifyRequest</a> :: (<a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Network-Wai.html#t:Request" title="Network.Wai">Request</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a> <a href="src/Network.Wai.html#modifyRequest" class="link">Source</a> <a href="#v:modifyRequest" class="selflink">#</a></p><div class="doc"><p>Apply a function that modifies a request as a <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code></p><p><em>Since: 3.2.4</em></p></div></div><div class="top"><p class="src"><a id="v:modifyResponse" class="def">modifyResponse</a> :: (<a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a> <a href="src/Network.Wai.html#modifyResponse" class="link">Source</a> <a href="#v:modifyResponse" class="selflink">#</a></p><div class="doc"><p>Apply a function that modifies a response as a <code><a href="Network-Wai.html#t:Middleware" title="Network.Wai">Middleware</a></code></p><p><em>Since: 3.0.3.0</em></p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>