<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.Massiv.Array.Numeric.Integral</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">massiv-1.0.4.0: Massiv (&#1052;&#1072;&#1089;&#1089;&#1080;&#1074;) is an Array Library.</span><ul class="links" id="page-menu"><li><a href="src/Data.Massiv.Array.Numeric.Integral.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Alexey Kuleshevich 2018-2022</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>Alexey Kuleshevich &lt;lehins@yandex.ru&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.Massiv.Array.Numeric.Integral</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Trapezoid Rule</a></li><li><a href="#g:2">Simpson's Rule</a></li><li><a href="#g:3">General Integral approximation</a></li><li><a href="#g:4">From functions</a><ul><li><a href="#g:5">Sampled at the edge</a></li><li><a href="#g:6">Sampled at the midpoint</a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc empty">&nbsp;</div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:midpointRule">midpointRule</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; r -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e) -&gt; e -&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li><li class="src short"><a href="#v:midpointStencil">midpointStencil</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix) =&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</li><li class="src short"><a href="#v:trapezoidRule">trapezoidRule</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; r -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e) -&gt; e -&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li><li class="src short"><a href="#v:trapezoidStencil">trapezoidStencil</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix) =&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</li><li class="src short"><a href="#v:simpsonsRule">simpsonsRule</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; r -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e) -&gt; e -&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li><li class="src short"><a href="#v:simpsonsStencil">simpsonsStencil</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix) =&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</li><li class="src short"><a href="#v:integrateWith">integrateWith</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e) =&gt; (<a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e) -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e</li><li class="src short"><a href="#v:integralApprox">integralApprox</a> :: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e) =&gt; (e -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e) -&gt; e -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li><li class="src short"><a href="#v:fromFunction">fromFunction</a> :: (<a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix, <a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; ix -&gt; e) -&gt; a -&gt; a -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li><li class="src short"><a href="#v:fromFunctionMidpoint">fromFunctionMidpoint</a> :: (<a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix, <a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; ix -&gt; e) -&gt; a -&gt; a -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>Inspiration for the code in this module was taken from <a href="http://tutorial.math.lamar.edu">Paul Dawkins Online
 Notes</a>. In particular the page on <a href="http://tutorial.math.lamar.edu/Classes/CalcII/ApproximatingDefIntegrals.aspx">Integral
 Approximation</a>,
 so if you need to brush up on some theory it is a great place to start.</p><p>Implementation-wise, integral approximation here relies heavily on stencils
 with stride, because such computation is fast and is automatically
 parallelizable.</p><p>Here are some examples of where this can be useful:</p><h3>Integral of a function on a region</h3><p>Say we have a gaussian <code>f(x) = e^(x^2)</code> on interval <code>[0, 2]</code> (as in Paul's tutorial above). For
 this we define a function <code>f</code>, an array with equally spaced (<em>dx</em>) sample input values and apply
 the function to that array, which will give us an array of <code>n + 1</code> sample points, or looking from
 a different angle <code>n</code> intervals.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>import Data.Massiv.Array
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>f x = exp ( x ^ (2 :: Int) ) :: Float
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fromFunction Seq (\ scale x -&gt; f (scale x)) 0 2 (Sz1 1) 4
</code></strong>Array D Seq (Sz1 5)
  [ 1.0, 1.2840254, 2.7182817, 9.487736, 54.59815 ]
</pre><p>Once we have that array of sample points ready, we could use <code><a href="Data-Massiv-Array-Numeric-Integral.html#v:integralApprox" title="Data.Massiv.Array.Numeric.Integral">integralApprox</a></code> and one of the
 stencils to compute an integral, but there are already functions that will do both steps for you:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>simpsonsRule Seq U (\ scale x -&gt; f (scale x)) 0 2 (Sz1 1) 4
</code></strong>Array D Seq (Sz1 1)
  [ 17.353626 ]
</pre><p><code>scale</code> is the function that will change an array index into equally spaced and
 appropriately shifted values of <code>x, y, ...</code> before they can get applied to <code>f(x, y, ...)</code></p><h3>Accurate values of a function</h3><p>Another very useful place where integral approximation can be used is when a more accurate
 representation of a non-linear function is desired. Consider the same gaussian function applied
 to equally spaced values, with zero being in the middle of the vector:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>xArr = makeArrayR D Seq (Sz1 4) $ \ i -&gt; fromIntegral i - 1.5 :: Float
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>xArr
</code></strong>Array D Seq (Sz1 4)
  [ -1.5, -0.5, 0.5, 1.5 ]
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fmap f xArr
</code></strong>Array D Seq (Sz1 4)
  [ 9.487736, 1.2840254, 1.2840254, 9.487736 ]
</pre><p>The problem with above example is that computed values do not accurately represent the total
 value contained within each vector cell. For that reason if your were to later use it for example
 as convolution stencil, approximation would be very poor. The way to solve it is to approximate
 an integral across each cell of vector by drastically blowing up the <code>xArr</code> and then reducing it
 to a smaller array by using one of the approximation rules:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>startValue = -2 :: Float
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>distPerCell = 1 :: Float
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>desiredSize = Sz1 4 :: Sz1
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>numSamples = 4 :: Int
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>xArrX4 = fromFunction Seq ($) startValue distPerCell desiredSize numSamples
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>xArrX4
</code></strong>Array D Seq (Sz1 17)
  [ -2.0, -1.75, -1.5, -1.25, -1.0, -0.75, -0.5, -0.25, 0.0, 0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0 ]
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>yArrX4 = computeAs U $ fmap f xArrX4
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>integralApprox trapezoidStencil distPerCell desiredSize numSamples yArrX4
</code></strong>Array D Seq (Sz1 4)
  [ 16.074406, 1.4906789, 1.4906789, 16.074408 ]
</pre><p>We can clearly see the difference is huge, but it doesn't mean it is much better than our
 previous estimate. In order to get more accurate results we can use a better Simpson's rule for
 approximation and many more sample points. There is no need to create individual arrays <code>xArrX4</code>
 and <code>yArrX4</code>, there are functions like <code><a href="Data-Massiv-Array-Numeric-Integral.html#v:simpsonsRule" title="Data.Massiv.Array.Numeric.Integral">simpsonsRule</a></code> that will take care of it for us:</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>simpsonsRule Seq U (\ scale i -&gt; f (scale i)) startValue distPerCell desiredSize 128
</code></strong>Array D Seq (Sz1 4)
  [ 14.989977, 1.4626511, 1.4626517, 14.989977 ]
</pre></div><div class="top"><p class="src"><a id="v:midpointRule" class="def">midpointRule</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#midpointRule" class="link">Source</a> <a href="#v:midpointRule" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a></td><td class="doc"><p>Computation strategy.</p></td></tr><tr><td class="src">-&gt; r</td><td class="doc"><p>Intermediate array representation.</p></td></tr><tr><td class="src">-&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e)</td><td class="doc"><p><code>f(x,y,...)</code> - Function to integrate</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>a</code> - Starting value point.</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>d</code> - Distance per matrix cell.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix</td><td class="doc"><p><code>sz</code> - Result matrix size.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of sample points per cell in each direction.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Use midpoint rule to approximate an integral.</p></div></div><div class="top"><p class="src"><a id="v:midpointStencil" class="def">midpointStencil</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#midpointStencil" class="link">Source</a> <a href="#v:midpointStencil" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; e</td><td class="doc"><p><code>&#916;x</code> - distance between sample points</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a></td><td class="doc"><p>Dimension along which to integrate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - number of sample points.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><strong>Midpoint Rule</strong></p><p><span class="mathjax">\[
 \int_{{\,a}}^{{\,b}}{{f\left( x \right)\,dx}} \approx \Delta x \cdot \,f\left( {x_1 + \frac{\Delta x}{2}} \right) + \Delta x \cdot \,f\left( {x_2 + \frac{\Delta x}{2}} \right) +  \cdots  + \Delta x \cdot \,f\left( {x_n + \frac{\Delta x}{2}} \right)
 \]</span></p></div></div><a href="#g:1" id="g:1"><h2>Trapezoid Rule</h2></a><div class="top"><p class="src"><a id="v:trapezoidRule" class="def">trapezoidRule</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#trapezoidRule" class="link">Source</a> <a href="#v:trapezoidRule" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a></td><td class="doc"><p>Computation strategy</p></td></tr><tr><td class="src">-&gt; r</td><td class="doc"><p>Intermediate array representation</p></td></tr><tr><td class="src">-&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e)</td><td class="doc"><p><code>f(x,y,...)</code> - function to integrate</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>a</code> - Starting value point.</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>d</code> - Distance per matrix cell.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix</td><td class="doc"><p><code>sz</code> - Result matrix size.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of sample points per cell in each direction.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Use trapezoid rule to approximate an integral.</p></div></div><div class="top"><p class="src"><a id="v:trapezoidStencil" class="def">trapezoidStencil</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#trapezoidStencil" class="link">Source</a> <a href="#v:trapezoidStencil" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; e</td><td class="doc"><p><code>&#916;x</code> - distance between sample points</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a></td><td class="doc"><p>Dimension along which to integrate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - number of sample points.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><strong>Trapezoid Rule</strong></p><p><span class="mathjax">\[
 \int_{{\,a}}^{{\,b}}{{f\left( x \right)\,dx}} \approx \frac{{\Delta x}}{2}\cdot\left( {f\left( {{x_0}} \right) + f\left( {{x_1}} \right)} \right) + \frac{{\Delta x}}{2}\cdot\left( {f\left( {{x_1}} \right) + f\left( {{x_2}} \right)} \right) +  \cdots  + \frac{{\Delta x}}{2}\cdot\left( {f\left( {{x_{n - 1}}} \right) + f\left( {{x_n}} \right)} \right)
 \]</span></p></div></div><a href="#g:2" id="g:2"><h2>Simpson's Rule</h2></a><div class="top"><p class="src"><a id="v:simpsonsRule" class="def">simpsonsRule</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#simpsonsRule" class="link">Source</a> <a href="#v:simpsonsRule" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a></td><td class="doc"><p>Computation strategy</p></td></tr><tr><td class="src">-&gt; r</td><td class="doc"><p>Intermediate array representation</p></td></tr><tr><td class="src">-&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; e) -&gt; ix -&gt; e)</td><td class="doc"><p><code>f(x,y,...)</code> - Function to integrate</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>a</code> - Starting value point.</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>d</code> - Distance per matrix cell.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix</td><td class="doc"><p><code>sz</code> - Result matrix size.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of sample points per cell in each direction. This value must be even,
 otherwise error.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Use Simpson's rule to approximate an integral.</p></div></div><div class="top"><p class="src"><a id="v:simpsonsStencil" class="def">simpsonsStencil</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#simpsonsStencil" class="link">Source</a> <a href="#v:simpsonsStencil" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; e</td><td class="doc"><p><code>&#916;x</code> - distance between sample points</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a></td><td class="doc"><p>Dimension along which to integrate</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of sample points. This value should be even, otherwise error.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><strong>Simpson's Rule</strong></p><p><span class="mathjax">\[
 \int_{{\,a}}^{{\,b}}{{f\left( x \right)\,dx}} \approx \frac{{\Delta x}}{3}\cdot\left( {f\left( {{x_0}} \right) + 4\cdot f\left( {{x_1}} \right) + f\left( {{x_2}} \right)} \right) + \frac{{\Delta x}}{3}\cdot\left( {f\left( {{x_2}} \right) + 4\cdot f\left( {{x_3}} \right) + f\left( {{x_4}} \right)} \right) +  \cdots  + \frac{{\Delta x}}{3}\cdot\left( {f\left( {{x_{n - 2}}} \right) + 4\cdot f\left( {{x_{n - 1}}} \right) + f\left( {{x_n}} \right)} \right)
 \]</span></p></div></div><a href="#g:3" id="g:3"><h1>General Integral approximation</h1></a><div class="top"><p class="src"><a id="v:integrateWith" class="def">integrateWith</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#integrateWith" class="link">Source</a> <a href="#v:integrateWith" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a></td><td class="doc"><p>Dimension along which integration should be estimated.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of samples</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Integrate with a stencil along a particular dimension.</p></div></div><div class="top"><p class="src"><a id="v:integralApprox" class="def">integralApprox</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#integralApprox" class="link">Source</a> <a href="#v:integralApprox" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> e, <a href="Data-Massiv-Core.html#t:StrideLoad" title="Data.Massiv.Core">StrideLoad</a> <a href="Data-Massiv-Array-Delayed.html#t:DW" title="Data.Massiv.Array.Delayed">DW</a> ix e, <a href="Data-Massiv-Core.html#t:Manifest" title="Data.Massiv.Core">Manifest</a> r e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (e -&gt; <a href="Data-Massiv-Core-Index.html#t:Dim" title="Data.Massiv.Core.Index">Dim</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a> ix e e)</td><td class="doc"><p>Integration Stencil</p></td></tr><tr><td class="src">-&gt; e</td><td class="doc"><p><code>d</code> - Length of interval per cell</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix</td><td class="doc"><p><code>sz</code> - Result size of the matrix</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Number of samples</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> r ix e</td><td class="doc"><p>Array with values of <code>f(x,y,..)</code> that will be used as source for integration.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Compute an approximation of integral using a supplied rule in a form of <code><a href="Data-Massiv-Array-Stencil.html#t:Stencil" title="Data.Massiv.Array.Stencil">Stencil</a></code>.</p></div></div><a href="#g:4" id="g:4"><h1>From functions</h1></a><a href="#g:5" id="g:5"><h2>Sampled at the edge</h2></a><div class="top"><p class="src"><a id="v:fromFunction" class="def">fromFunction</a> <a href="src/Data.Massiv.Array.Numeric.Integral.html#fromFunction" class="link">Source</a> <a href="#v:fromFunction" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix, <a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a></td><td class="doc"><p>Computation strategy</p></td></tr><tr><td class="src">-&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; ix -&gt; e)</td><td class="doc"><p>A function that will produce elements of scaled up array. First argument is a scaling
 function that should be applied to individual indicies.</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p><code>a</code> - Starting point</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p><code>d</code> - Distance per cell</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix</td><td class="doc"><p><code>sz</code> - Size of the desired array</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p><code>n</code> - Scaling factor, i.e. number of sample points per cell.</p></td></tr><tr><td class="src">-&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create an array from a function with sample points at the edges</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fromFunction Seq (\ scale (i :. j) -&gt; scale i + scale j :: Double) (-2) 1 (Sz 4) 2
</code></strong>Array D Seq (Sz (9 :. 9))
  [ [ -4.0, -3.5, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0 ]
  , [ -3.5, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5 ]
  , [ -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0 ]
  , [ -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5 ]
  , [ -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0 ]
  , [ -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5 ]
  , [ -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0 ]
  , [ -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5 ]
  , [ 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0 ]
  ]
</pre></div></div><a href="#g:6" id="g:6"><h2>Sampled at the midpoint</h2></a><div class="top"><p class="src"><a id="v:fromFunctionMidpoint" class="def">fromFunctionMidpoint</a> :: (<a href="Data-Massiv-Core-Index.html#t:Index" title="Data.Massiv.Core.Index">Index</a> ix, <a href="../base-4.18.2.1/Prelude.html#t:Fractional" title="Prelude">Fractional</a> a) =&gt; <a href="Data-Massiv-Core.html#t:Comp" title="Data.Massiv.Core">Comp</a> -&gt; ((<a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; a) -&gt; ix -&gt; e) -&gt; a -&gt; a -&gt; <a href="Data-Massiv-Core-Index.html#t:Sz" title="Data.Massiv.Core.Index">Sz</a> ix -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-Massiv-Core-List.html#t:Array" title="Data.Massiv.Core.List">Array</a> <a href="Data-Massiv-Array-Delayed.html#t:D" title="Data.Massiv.Array.Delayed">D</a> ix e <a href="src/Data.Massiv.Array.Numeric.Integral.html#fromFunctionMidpoint" class="link">Source</a> <a href="#v:fromFunctionMidpoint" class="selflink">#</a></p><div class="doc"><p>Similar to <code><a href="Data-Massiv-Array-Numeric-Integral.html#v:fromFunction" title="Data.Massiv.Array.Numeric.Integral">fromFunction</a></code>, but will create an array from a function with sample points in the
 middle of cells.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>fromFunctionMidpoint Seq (\ scale (i :. j) -&gt; scale i + scale j :: Double) (-2) 1 (Sz 4) 2
</code></strong>Array D Seq (Sz (8 :. 8))
  [ [ -3.5, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0 ]
  , [ -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5 ]
  , [ -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0 ]
  , [ -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5 ]
  , [ -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0 ]
  , [ -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5 ]
  , [ -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0 ]
  , [ 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5 ]
  ]
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>