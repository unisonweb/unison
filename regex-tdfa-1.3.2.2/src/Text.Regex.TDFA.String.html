<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{- |
This modules provides 'RegexMaker' and 'RegexLike' instances for using
'String' with the TDFA backend.

This exports instances of the high level API and the medium level
API of 'compile','execute', and 'regexec'.
-}</span></span><span>
</span><span id="line-8"></span><span class="hs-comment">{- By Chris Kuklewicz, 2009. BSD License, see the LICENSE file. -}</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.TDFA.String</span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Types</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier">Regex</span></a></span><span>
</span><span id="line-12"></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchOffset</span></span><span>
</span><span id="line-13"></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchLength</span></span><span>
</span><span id="line-14"></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier">CompOption</span></a></span><span>
</span><span id="line-15"></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Medium level API functions</span></span><span>
</span><span id="line-17"></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier">compile</span></a></span><span>
</span><span id="line-18"></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.String.html#execute"><span class="hs-identifier">execute</span></a></span><span>
</span><span id="line-19"></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.String.html#regexec"><span class="hs-identifier">regexec</span></a></span><span>
</span><span id="line-20"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex.Base.Impl</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">polymatch</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">polymatchM</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex.Base.RegexLike</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RegexMaker</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">RegexLike</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">RegexContext</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchOffset</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchLength</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html"><span class="hs-identifier">Text.Regex.TDFA.Common</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier">common_error</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier">Regex</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier">CompOption</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier">captureGroups</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.ReadRegex.html"><span class="hs-identifier">Text.Regex.TDFA.ReadRegex</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier">parseRegex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.TDFA.html"><span class="hs-identifier">Text.Regex.TDFA.TDFA</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.TDFA.html#patternToRegex"><span class="hs-identifier">patternToRegex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array.IArray</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">elems</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">amap</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">listToMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.NewDFA.Engine.html"><span class="hs-identifier">Text.Regex.TDFA.NewDFA.Engine</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.NewDFA.Engine.html#execMatch"><span class="hs-identifier">execMatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.NewDFA.Tester.html"><span class="hs-identifier">Text.Regex.TDFA.NewDFA.Tester</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tester</span></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.NewDFA.Tester.html#matchTest"><span class="hs-identifier">matchTest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span id="local-6989586621679114298"><span class="annot"><a href="Text.Regex.TDFA.String.html#err"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679114298"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-34"></span><span id="err"><span class="annot"><span class="annottext">err :: forall a. String -&gt; a
</span><a href="Text.Regex.TDFA.String.html#err"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; a
forall a. String -&gt; String -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Text.Regex.TDFA.String&quot;</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span id="local-6989586621679114301"><span class="annot"><a href="Text.Regex.TDFA.String.html#unwrap"><span class="hs-identifier hs-type">unwrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679114301"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679114301"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-37"></span><span id="unwrap"><span class="annot"><span class="annottext">unwrap :: forall v. Either String v -&gt; v
</span><a href="Text.Regex.TDFA.String.html#unwrap"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621679114407"><span class="annot"><span class="annottext">Either String v
</span><a href="#local-6989586621679114407"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String v
</span><a href="#local-6989586621679114407"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679114408"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114408"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; v
forall a. String -&gt; a
</span><a href="Text.Regex.TDFA.String.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Text.Regex.TDFA.String died: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114408"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679114409"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679114409"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679114409"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Flags (summed together)</span></span><span>
</span><span id="line-41"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Flags (summed together)</span></span><span>
</span><span id="line-42"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The regular expression to compile (ASCII only, no null bytes)</span></span><span>
</span><span id="line-43"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Returns: the compiled regular expression</span></span><span>
</span><span id="line-44"></span><span id="compile"><span class="annot"><span class="annottext">compile :: CompOption -&gt; ExecOption -&gt; String -&gt; Either String Regex
</span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span id="local-6989586621679114410"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114410"><span class="hs-identifier hs-var">compOpt</span></a></span></span><span> </span><span id="local-6989586621679114411"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114411"><span class="hs-identifier hs-var">execOpt</span></a></span></span><span> </span><span id="local-6989586621679114412"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114412"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either ParseError (Pattern, (MatchOffset, DoPa))
</span><a href="Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier hs-var">parseRegex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114412"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679114413"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679114413"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Regex
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parseRegex for Text.Regex.TDFA.String failed:&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">ParseError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679114413"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679114415"><span class="annot"><span class="annottext">(Pattern, (MatchOffset, DoPa))
</span><a href="#local-6989586621679114415"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; Either String Regex
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern, (MatchOffset, DoPa)) -&gt; CompOption -&gt; ExecOption -&gt; Regex
</span><a href="Text.Regex.TDFA.TDFA.html#patternToRegex"><span class="hs-identifier hs-var">patternToRegex</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern, (MatchOffset, DoPa))
</span><a href="#local-6989586621679114415"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114410"><span class="hs-identifier hs-var">compOpt</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114411"><span class="hs-identifier hs-var">execOpt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679114420"><span id="local-6989586621679114425"><span class="annot"><span class="hs-identifier hs-type">RegexMaker</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679114431"><span class="annot"><span class="annottext">makeRegexOpts :: CompOption -&gt; ExecOption -&gt; String -&gt; Regex
</span><a href="#local-6989586621679114431"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRegexOpts</span></a></span></span><span> </span><span id="local-6989586621679114433"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114433"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679114434"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114434"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679114435"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114435"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String Regex -&gt; Regex
forall v. Either String v -&gt; v
</span><a href="Text.Regex.TDFA.String.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompOption -&gt; ExecOption -&gt; String -&gt; Either String Regex
</span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114433"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114434"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114435"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679114441"><span class="annot"><span class="annottext">makeRegexOptsM :: forall (m :: * -&gt; *).
MonadFail m =&gt;
CompOption -&gt; ExecOption -&gt; String -&gt; m Regex
</span><a href="#local-6989586621679114441"><span class="hs-identifier hs-var hs-var hs-var hs-var">makeRegexOptsM</span></a></span></span><span> </span><span id="local-6989586621679114443"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114443"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679114444"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114444"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679114445"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114445"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; m Regex)
-&gt; (Regex -&gt; m Regex) -&gt; Either String Regex -&gt; m Regex
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m Regex
forall a. String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">Regex -&gt; m Regex
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either String Regex -&gt; m Regex) -&gt; Either String Regex -&gt; m Regex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; ExecOption -&gt; String -&gt; Either String Regex
</span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679114443"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679114444"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114445"><span class="hs-identifier hs-var">source</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Text.Regex.TDFA.String.html#execute"><span class="hs-identifier hs-type">execute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Compiled regular expression</span></span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ String to match against</span></span><span>
</span><span id="line-55"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MatchArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span id="execute"><span class="annot"><span class="annottext">execute :: Regex -&gt; String -&gt; Either String (Maybe MatchArray)
</span><a href="Text.Regex.TDFA.String.html#execute"><span class="hs-identifier hs-var hs-var">execute</span></a></span></span><span> </span><span id="local-6989586621679114447"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114447"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114448"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114448"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MatchArray -&gt; Either String (Maybe MatchArray)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; Maybe MatchArray
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe MatchArray
</span><span class="hs-identifier hs-var">matchOnce</span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114447"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114448"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Text.Regex.TDFA.String.html#regexec"><span class="hs-identifier hs-type">regexec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Compiled regular expression</span></span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ String to match against</span></span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span id="regexec"><span class="annot"><span class="annottext">regexec :: Regex
-&gt; String
-&gt; Either String (Maybe (String, String, String, [String]))
</span><a href="Text.Regex.TDFA.String.html#regexec"><span class="hs-identifier hs-var hs-var">regexec</span></a></span></span><span> </span><span id="local-6989586621679114450"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114450"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114451"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114451"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String, String, [String])
-&gt; Either String (Maybe (String, String, String, [String]))
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (String, String, String, [String])
 -&gt; Either String (Maybe (String, String, String, [String])))
-&gt; Maybe (String, String, String, [String])
-&gt; Either String (Maybe (String, String, String, [String]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; Maybe (String, MatchText String, String)
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; Maybe (source, MatchText source, source)
</span><span class="hs-identifier hs-var">matchOnceText</span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114450"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114451"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679114453"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114453"><span class="hs-identifier hs-var">pre</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679114454"><span class="annot"><span class="annottext">MatchText String
</span><a href="#local-6989586621679114454"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679114455"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114455"><span class="hs-identifier hs-var">post</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679114456"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114456"><span class="hs-identifier hs-var">main</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679114457"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679114457"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((String, (MatchOffset, MatchOffset)) -&gt; String)
-&gt; [(String, (MatchOffset, MatchOffset))] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(String, (MatchOffset, MatchOffset)) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchText String -&gt; [(String, (MatchOffset, MatchOffset))]
forall (a :: * -&gt; * -&gt; *) e i. (IArray a e, Ix i) =&gt; a i e -&gt; [e]
</span><span class="hs-identifier hs-var">elems</span></span><span> </span><span class="annot"><span class="annottext">MatchText String
</span><a href="#local-6989586621679114454"><span class="hs-identifier hs-var">mt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String, String, String, [String])
-&gt; Maybe (String, String, String, [String])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114453"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114456"><span class="hs-identifier hs-var">main</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114455"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679114457"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">Maybe (String, MatchText String, String)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (String, String, String, [String])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Minimal definition for now</span><span>
</span><span id="line-68"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679114468"><span class="annot"><span class="hs-identifier hs-type">RegexLike</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679114472"><span class="annot"><span class="annottext">matchOnce :: Regex -&gt; String -&gt; Maybe MatchArray
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">matchOnce</span></span></span><span> </span><span id="local-6989586621679114473"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114473"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114474"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114474"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MatchArray] -&gt; Maybe MatchArray
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; [MatchArray]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [MatchArray]
</span><span class="hs-identifier hs-var">matchAll</span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114473"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114474"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679114478"><span class="annot"><span class="annottext">matchAll :: Regex -&gt; String -&gt; [MatchArray]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">matchAll</span></span></span><span> </span><span id="local-6989586621679114479"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114479"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114480"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114480"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; MatchOffset -&gt; Char -&gt; String -&gt; [MatchArray]
forall text.
Uncons text =&gt;
Regex -&gt; MatchOffset -&gt; Char -&gt; text -&gt; [MatchArray]
</span><a href="Text.Regex.TDFA.NewDFA.Engine.html#execMatch"><span class="hs-identifier hs-var">execMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114479"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">MatchOffset
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114480"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679114484"><span class="annot"><span class="annottext">matchCount :: Regex -&gt; String -&gt; MatchOffset
</span><a href="#local-6989586621679114484"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchCount</span></a></span></span><span> </span><span id="local-6989586621679114486"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114486"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114487"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114487"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MatchArray] -&gt; MatchOffset
forall a. [a] -&gt; MatchOffset
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; MatchOffset
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; [MatchArray]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [MatchArray]
</span><span class="hs-identifier hs-var">matchAll</span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114489"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114487"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679114489"><span class="annot"><span class="annottext">r' :: Regex
</span><a href="#local-6989586621679114489"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114486"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier hs-var">regex_execOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#regex_execOptions"><span class="hs-identifier hs-var">regex_execOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679114486"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#captureGroups"><span class="hs-identifier hs-var">captureGroups</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679114492"><span class="annot"><span class="annottext">matchTest :: Regex -&gt; String -&gt; Bool
</span><a href="#local-6989586621679114492"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; Bool
forall text. Uncons text =&gt; Regex -&gt; text -&gt; Bool
</span><a href="Text.Regex.TDFA.NewDFA.Tester.html#matchTest"><span class="hs-identifier hs-var">Tester.matchTest</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- matchOnceText</span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679114500"><span class="annot"><span class="annottext">matchAllText :: Regex -&gt; String -&gt; [MatchText String]
</span><a href="#local-6989586621679114500"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchAllText</span></a></span></span><span> </span><span id="local-6989586621679114502"><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114502"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679114503"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679114520"><span class="annot"><span class="annottext">go :: MatchOffset
-&gt; [a]
-&gt; [a i (MatchOffset, MatchOffset)]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
</span><a href="#local-6989586621679114520"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679114521"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[a i (MatchOffset, MatchOffset)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114521"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">MatchOffset -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a i ([a], (MatchOffset, MatchOffset))]
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="#local-6989586621679114520"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679114523"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114523"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621679114524"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114524"><span class="hs-identifier hs-var">_t</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><a href="#local-6989586621679114520"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679114525"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114525"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679114526"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114526"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679114527"><span class="annot"><span class="annottext">a i (MatchOffset, MatchOffset)
</span><a href="#local-6989586621679114527"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679114528"><span class="annot"><span class="annottext">[a i (MatchOffset, MatchOffset)]
</span><a href="#local-6989586621679114528"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679114534"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114534"><span class="hs-identifier hs-var">off0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679114535"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114535"><span class="hs-identifier hs-var">len0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a i (MatchOffset, MatchOffset)
</span><a href="#local-6989586621679114527"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a i (MatchOffset, MatchOffset) -&gt; i -&gt; (MatchOffset, MatchOffset)
forall (a :: * -&gt; * -&gt; *) e i.
(IArray a e, Ix i) =&gt;
a i e -&gt; i -&gt; e
</span><span class="hs-operator hs-var">!</span></span><span class="annot"><span class="annottext">i
</span><span class="hs-number">0</span></span><span>
</span><span id="line-79"></span><span>                            </span><span id="local-6989586621679114537"><span class="annot"><span class="annottext">trans :: (MatchOffset, MatchOffset) -&gt; ([a], (MatchOffset, MatchOffset))
</span><a href="#local-6989586621679114537"><span class="hs-identifier hs-var hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679114538"><span class="annot"><span class="annottext">pair :: (MatchOffset, MatchOffset)
</span><a href="#local-6989586621679114538"><span class="hs-identifier hs-var">pair</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679114539"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114539"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679114540"><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114540"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset -&gt; [a] -&gt; [a]
forall a. MatchOffset -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114540"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset -&gt; [a] -&gt; [a]
forall a. MatchOffset -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114539"><span class="hs-identifier hs-var">off</span></a></span><span class="annot"><span class="annottext">MatchOffset -&gt; MatchOffset -&gt; MatchOffset
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114525"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114526"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(MatchOffset, MatchOffset)
</span><a href="#local-6989586621679114538"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>                            </span><span id="local-6989586621679114545"><span class="annot"><span class="annottext">t' :: [a]
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MatchOffset -&gt; [a] -&gt; [a]
forall a. MatchOffset -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114534"><span class="hs-identifier hs-var">off0</span></a></span><span class="annot"><span class="annottext">MatchOffset -&gt; MatchOffset -&gt; MatchOffset
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114535"><span class="hs-identifier hs-var">len0</span></a></span><span class="annot"><span class="annottext">MatchOffset -&gt; MatchOffset -&gt; MatchOffset
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114525"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114526"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-81"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((MatchOffset, MatchOffset) -&gt; ([a], (MatchOffset, MatchOffset)))
-&gt; a i (MatchOffset, MatchOffset)
-&gt; a i ([a], (MatchOffset, MatchOffset))
forall (a :: * -&gt; * -&gt; *) e' e i.
(IArray a e', IArray a e, Ix i) =&gt;
(e' -&gt; e) -&gt; a i e' -&gt; a i e
</span><span class="hs-identifier hs-var">amap</span></span><span> </span><span class="annot"><span class="annottext">(MatchOffset, MatchOffset) -&gt; ([a], (MatchOffset, MatchOffset))
</span><a href="#local-6989586621679114537"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">a i (MatchOffset, MatchOffset)
</span><a href="#local-6989586621679114527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a i ([a], (MatchOffset, MatchOffset))
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
forall a b. a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">seq</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset
-&gt; [a]
-&gt; [a i (MatchOffset, MatchOffset)]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
</span><a href="#local-6989586621679114520"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114534"><span class="hs-identifier hs-var">off0</span></a></span><span class="annot"><span class="annottext">MatchOffset -&gt; MatchOffset -&gt; MatchOffset
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">MatchOffset
</span><a href="#local-6989586621679114535"><span class="hs-identifier hs-var">len0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679114545"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">[a i (MatchOffset, MatchOffset)]
</span><a href="#local-6989586621679114528"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MatchOffset -&gt; String -&gt; [MatchArray] -&gt; [MatchText String]
forall {a :: * -&gt; * -&gt; *} {a} {i}.
(IArray a ([a], (MatchOffset, MatchOffset)),
 IArray a (MatchOffset, MatchOffset), Ix i, Num i) =&gt;
MatchOffset
-&gt; [a]
-&gt; [a i (MatchOffset, MatchOffset)]
-&gt; [a i ([a], (MatchOffset, MatchOffset))]
</span><a href="#local-6989586621679114520"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">MatchOffset
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; [MatchArray]
forall regex source.
RegexLike regex source =&gt;
regex -&gt; source -&gt; [MatchArray]
</span><span class="hs-identifier hs-var">matchAll</span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679114502"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679114503"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RegexContext</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679114554"><span class="annot"><span class="annottext">match :: Regex -&gt; String -&gt; String
</span><a href="#local-6989586621679114554"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; String
forall a b. RegexLike a b =&gt; a -&gt; b -&gt; b
</span><span class="hs-identifier hs-var">polymatch</span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679114559"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *). MonadFail m =&gt; Regex -&gt; String -&gt; m String
</span><a href="#local-6989586621679114559"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; String -&gt; m String
forall a b (m :: * -&gt; *).
(RegexLike a b, MonadFail m) =&gt;
a -&gt; b -&gt; m b
</span><span class="hs-identifier hs-var">polymatchM</span></span><span>
</span><span id="line-87"></span></pre></body></html>