<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-incomplete-uni-patterns #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This &quot;Text.Regex.TDFA.Pattern&quot; module provides the 'Pattern' data</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- type and its subtypes.  This 'Pattern' type is used to represent</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- the parsed form of a regular expression.</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.TDFA.Pattern</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier">Pattern</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier">PatternSet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier">PatternSetCharacterClass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCollatingElement"><span class="hs-identifier">PatternSetCollatingElement</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetEquivalenceClass"><span class="hs-identifier">PatternSetEquivalenceClass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier">GroupIndex</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier">DoPa</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#decodeCharacterClass"><span class="hs-identifier">decodeCharacterClass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#decodePatternSet"><span class="hs-identifier">decodePatternSet</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier">showPattern</span></a></span><span>
</span><span id="line-17"></span><span class="annot"><span class="hs-comment">-- ** Internal use</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#starTrans"><span class="hs-identifier">starTrans</span></a></span><span>
</span><span id="line-19"></span><span class="annot"><span class="hs-comment">-- ** Internal use, operations to support debugging under @ghci@</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#starTrans%27"><span class="hs-identifier">starTrans'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier">simplify'</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#dfsPattern"><span class="hs-identifier">dfsPattern</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">{- By Chris Kuklewicz, 2007. BSD License, see the LICENSE file. -}</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">partition</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html"><span class="hs-identifier">Text.Regex.TDFA.Common</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier">DoPa</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier">GroupIndex</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier">common_error</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span id="local-6989586621679110477"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#err"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679110477"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-31"></span><span id="err"><span class="annot"><span class="annottext">err :: forall a. String -&gt; a
</span><a href="Text.Regex.TDFA.Pattern.html#err"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; a
forall a. String -&gt; String -&gt; a
</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Text.Regex.TDFA.Pattern&quot;</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | 'Pattern' is the type returned by the regular expression parser 'parseRegex'.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- This is consumed by the &quot;Text.Regex.TDFA.CorePattern&quot; module and the tender leaves</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- are nibbled by the &quot;Text.Regex.TDFA.TNFA&quot; module.</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- The 'DoPa' field is the index of the component in the regex string @r@.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Pattern"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PEmpty"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span></span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @()@, matches the empty string.</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PGroup"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#GroupIndex"><span class="hs-identifier hs-type">GroupIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-comment">-- ^ Group @(r)@.  @Nothing@ indicates non-matching 'PGroup'</span><span>
</span><span id="line-43"></span><span>      </span><span class="hs-comment">-- (never produced by parser 'parseRegex').</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="POr"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span></span><span>     </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-45"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Alternative @r|s@ (flattened by 'starTrans').</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PConcat"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Sequence @rs@ (flattened by 'starTrans').</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PQuest"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-var">PQuest</span></a></span></span><span>  </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Zero or one repetitions @r?@ (eliminated by 'starTrans').</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PPlus"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-var">PPlus</span></a></span></span><span>   </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-51"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ One or more repetitions @r+@ (eliminated by 'starTrans').</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PStar"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-53"></span><span>      </span><span class="hs-comment">-- ^ Zero or more repetitions @r*@.</span><span>
</span><span id="line-54"></span><span>      </span><span class="hs-comment">-- @True@ (default) means may accept the empty string on its first iteration.</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PBound"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-var">PBound</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="hs-comment">-- ^ Given number or repetitions @r{n}@ or @r{n,m}@</span><span>
</span><span id="line-57"></span><span>      </span><span class="hs-comment">-- (eliminated by 'starTrans').</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">-- The rest of these need an index of where in the regex string it is from</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PCarat"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PCarat"><span class="hs-identifier hs-var">PCarat</span></a></span></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><span class="annottext">Pattern -&gt; DoPa
</span><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @^@ matches beginning of input.</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PDollar"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDollar"><span class="hs-identifier hs-var">PDollar</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @$@ matches end of input.</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- The following test and accept a single character</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PDot"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDot"><span class="hs-identifier hs-var">PDot</span></a></span></span><span>    </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ @.@ matches any character.</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PAny"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAny"><span class="hs-identifier hs-var">PAny</span></a></span></span><span>    </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span> </span><span id="getPatternSet"><span class="annot"><span class="annottext">Pattern -&gt; PatternSet
</span><a href="Text.Regex.TDFA.Pattern.html#getPatternSet"><span class="hs-identifier hs-var hs-var">getPatternSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Bracket expression @[...]@.</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PAnyNot"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAnyNot"><span class="hs-identifier hs-var">PAnyNot</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span> </span><span id="getPatternSet"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getPatternSet"><span class="hs-identifier hs-var">getPatternSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-71"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Inverted bracket expression @[^...]@.</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PEscape"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PEscape"><span class="hs-identifier hs-var">PEscape</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span> </span><span id="getPatternChar"><span class="annot"><span class="annottext">Pattern -&gt; Char
</span><a href="Text.Regex.TDFA.Pattern.html#getPatternChar"><span class="hs-identifier hs-var hs-var">getPatternChar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Backslashed character @\c@, may have special meaning.</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PChar"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PChar"><span class="hs-identifier hs-var">PChar</span></a></span></span><span>   </span><span class="hs-special">{</span><span> </span><span id="getDoPa"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getDoPa"><span class="hs-identifier hs-var">getDoPa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Common.html#DoPa"><span class="hs-identifier hs-type">DoPa</span></a></span><span class="hs-special">,</span><span> </span><span id="getPatternChar"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#getPatternChar"><span class="hs-identifier hs-var">getPatternChar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Single character, matches given character.</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- The following are semantic tags created in starTrans, not the parser</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PNonCapture"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-var">PNonCapture</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-79"></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Tag for internal use, introduced by 'starTrans'.</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PNonEmpty"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonEmpty"><span class="hs-identifier hs-var">PNonEmpty</span></a></span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-81"></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Tag for internal use, introduced by 'starTrans'.</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110645"><span id="local-6989586621679110678"><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Bool
(Pattern -&gt; Pattern -&gt; Bool)
-&gt; (Pattern -&gt; Pattern -&gt; Bool) -&gt; Eq Pattern
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Pattern -&gt; Pattern -&gt; Bool
== :: Pattern -&gt; Pattern -&gt; Bool
$c/= :: Pattern -&gt; Pattern -&gt; Bool
/= :: Pattern -&gt; Pattern -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679110682"><span id="local-6989586621679110730"><span id="local-6989586621679110733"><span class="annot"><span class="annottext">Int -&gt; Pattern -&gt; ShowS
[Pattern] -&gt; ShowS
Pattern -&gt; String
(Int -&gt; Pattern -&gt; ShowS)
-&gt; (Pattern -&gt; String) -&gt; ([Pattern] -&gt; ShowS) -&gt; Show Pattern
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Pattern -&gt; ShowS
showsPrec :: Int -&gt; Pattern -&gt; ShowS
$cshow :: Pattern -&gt; String
show :: Pattern -&gt; String
$cshowList :: [Pattern] -&gt; ShowS
showList :: [Pattern] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Andreas Abel, 2022-07-18, issue #47:</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- The following claim is FALSE:</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- I have not been checking, but this should have the property that</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- parsing the resulting string should result in an identical 'Pattern'.</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- This is not true if 'starTrans' has created 'PNonCapture' and 'PNonEmpty'</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- values or a @'PStar' False@.  The contents of a @[...]@ grouping are</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- always shown in a sorted canonical order.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-type">showPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-93"></span><span id="showPattern"><span class="annot"><span class="annottext">showPattern :: Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var hs-var">showPattern</span></a></span></span><span> </span><span id="local-6989586621679110736"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110736"><span class="hs-identifier hs-var">pIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110736"><span class="hs-identifier hs-var">pIn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;()&quot;</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110737"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679110738"><span class="hs-identifier hs-var">paren</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679110739"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679110739"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; String) -&gt; [Pattern] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679110739"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679110741"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679110741"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; String) -&gt; [Pattern] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679110741"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679110743"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110743"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110743"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;?&quot;</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679110744"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110744"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110744"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- If PStar has mayFirstBeNull False then reparsing will forget this flag</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110745"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679110746"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679110747"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110747"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679110748"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110748"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110747"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110748"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679110750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110750"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679110751"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">mj</span></a></span></span><span> </span><span id="local-6989586621679110752"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110752"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110752"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110750"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (Int -&gt; String) -&gt; Maybe Int -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679110754"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110754"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110754"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">mj</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PCarat"><span class="hs-identifier hs-type">PCarat</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDollar"><span class="hs-identifier hs-type">PDollar</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDot"><span class="hs-identifier hs-type">PDot</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAny"><span class="hs-identifier hs-type">PAny</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110755"><span class="annot"><span class="annottext">PatternSet
</span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">PatternSet -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PatternSet
</span><a href="#local-6989586621679110755"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAnyNot"><span class="hs-identifier hs-type">PAnyNot</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110756"><span class="annot"><span class="annottext">PatternSet
</span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'^'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">PatternSet -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">PatternSet
</span><a href="#local-6989586621679110756"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PEscape"><span class="hs-identifier hs-type">PEscape</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110757"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110757"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PChar"><span class="hs-identifier hs-type">PChar</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679110758"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110758"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110758"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- The following were not directly from the parser, and will not be parsed in properly</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-type">PNonCapture</span></a></span><span> </span><span id="local-6989586621679110759"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110759"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110759"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonEmpty"><span class="hs-identifier hs-type">PNonEmpty</span></a></span><span> </span><span id="local-6989586621679110760"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#showPattern"><span class="hs-identifier hs-var">showPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679110760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">{-
        groupRange x n (y:ys) = if (fromEnum y)-(fromEnum x) == n then groupRange x (succ n) ys
                                else (if n &lt;=3 then take n [x..]
                                      else x:'-':(toEnum (pred n+fromEnum x)):[]) ++ groupRange y 1 ys
        groupRange x n [] = if n &lt;=3 then take n [x..]
                            else x:'-':(toEnum (pred n+fromEnum x)):[]
-}</span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679110738"><span class="annot"><span class="annottext">paren :: ShowS
</span><a href="#local-6989586621679110738"><span class="hs-identifier hs-var hs-var">paren</span></a></span></span><span> </span><span id="local-6989586621679110761"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110761"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Content of a bracket expression @[...]@ organized into</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- characters,</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- POSIX character classes (e.g. @[[:alnum:]]@),</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- collating elements (e.g. @[.ch.]@, unused), and</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- equivalence classes (e.g. @[=a=]@, treated as characters).</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-keyword">data</span><span> </span><span id="PatternSet"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-var">PatternSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PatternSet"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-var">PatternSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-type">PatternSetCharacterClass</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCollatingElement"><span class="hs-identifier hs-type">PatternSetCollatingElement</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetEquivalenceClass"><span class="hs-identifier hs-type">PatternSetEquivalenceClass</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110764"><span id="local-6989586621679110774"><span class="annot"><span class="annottext">PatternSet -&gt; PatternSet -&gt; Bool
(PatternSet -&gt; PatternSet -&gt; Bool)
-&gt; (PatternSet -&gt; PatternSet -&gt; Bool) -&gt; Eq PatternSet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PatternSet -&gt; PatternSet -&gt; Bool
== :: PatternSet -&gt; PatternSet -&gt; Bool
$c/= :: PatternSet -&gt; PatternSet -&gt; Bool
/= :: PatternSet -&gt; PatternSet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Hand-rolled implementation, giving textual rather than Haskell representation.</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679110786"><span id="local-6989586621679110789"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679110798"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; PatternSet -&gt; ShowS
</span><a href="#local-6989586621679110798"><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679110800"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110800"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span id="local-6989586621679110801"><span class="annot"><span class="annottext">Maybe (Set Char)
</span><a href="#local-6989586621679110801"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679110802"><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><a href="#local-6989586621679110802"><span class="hs-identifier hs-var">scc</span></a></span></span><span> </span><span id="local-6989586621679110803"><span class="annot"><span class="annottext">Maybe (Set PatternSetCollatingElement)
</span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">sce</span></a></span></span><span> </span><span id="local-6989586621679110804"><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">sec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110807"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110807"><span class="hs-identifier hs-var">special</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679110808"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">normal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, String)
-&gt; (Set Char -&gt; (String, String))
-&gt; Maybe (Set Char)
-&gt; (String, String)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]-&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String))
-&gt; (Set Char -&gt; String) -&gt; Set Char -&gt; (String, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set Char -&gt; String
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set Char)
</span><a href="#local-6989586621679110801"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span id="local-6989586621679110814"><span class="annot"><span class="annottext">charSpec :: String
</span><a href="#local-6989586621679110814"><span class="hs-identifier hs-var hs-var">charSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110807"><span class="hs-identifier hs-var">special</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679110816"><span class="hs-identifier hs-var">byRange</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110808"><span class="hs-identifier hs-var">normal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679110820"><span class="annot"><span class="annottext">scc' :: String
</span><a href="#local-6989586621679110820"><span class="hs-identifier hs-var hs-var">scc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Set PatternSetCharacterClass -&gt; String)
-&gt; Maybe (Set PatternSetCharacterClass)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PatternSetCharacterClass -&gt; String)
-&gt; [PatternSetCharacterClass] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">PatternSetCharacterClass -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PatternSetCharacterClass] -&gt; String)
-&gt; (Set PatternSetCharacterClass -&gt; [PatternSetCharacterClass])
-&gt; Set PatternSetCharacterClass
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set PatternSetCharacterClass -&gt; [PatternSetCharacterClass]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><a href="#local-6989586621679110802"><span class="hs-identifier hs-var">scc</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621679110825"><span class="annot"><span class="annottext">sce' :: String
</span><a href="#local-6989586621679110825"><span class="hs-identifier hs-var hs-var">sce'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Set PatternSetCollatingElement -&gt; String)
-&gt; Maybe (Set PatternSetCollatingElement)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PatternSetCollatingElement -&gt; String)
-&gt; [PatternSetCollatingElement] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">PatternSetCollatingElement -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PatternSetCollatingElement] -&gt; String)
-&gt; (Set PatternSetCollatingElement -&gt; [PatternSetCollatingElement])
-&gt; Set PatternSetCollatingElement
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set PatternSetCollatingElement -&gt; [PatternSetCollatingElement]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCollatingElement)
</span><a href="#local-6989586621679110803"><span class="hs-identifier hs-var">sce</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span id="local-6989586621679110829"><span class="annot"><span class="annottext">sec' :: String
</span><a href="#local-6989586621679110829"><span class="hs-identifier hs-var hs-var">sec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Set PatternSetEquivalenceClass -&gt; String)
-&gt; Maybe (Set PatternSetEquivalenceClass)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PatternSetEquivalenceClass -&gt; String)
-&gt; [PatternSetEquivalenceClass] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">PatternSetEquivalenceClass -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PatternSetEquivalenceClass] -&gt; String)
-&gt; (Set PatternSetEquivalenceClass -&gt; [PatternSetEquivalenceClass])
-&gt; Set PatternSetEquivalenceClass
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set PatternSetEquivalenceClass -&gt; [PatternSetEquivalenceClass]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><a href="#local-6989586621679110804"><span class="hs-identifier hs-var">sec</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110814"><span class="hs-identifier hs-var">charSpec</span></a></span><span>
</span><span id="line-146"></span><span>       </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110800"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110820"><span class="hs-identifier hs-var">scc'</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110800"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110825"><span class="hs-identifier hs-var">sce'</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110800"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110829"><span class="hs-identifier hs-var">sec'</span></a></span><span>
</span><span id="line-147"></span><span>       </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110807"><span class="hs-identifier hs-var">special</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ShowS
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679110816"><span class="annot"><span class="annottext">byRange :: ShowS
</span><a href="#local-6989586621679110816"><span class="hs-identifier hs-var hs-var">byRange</span></a></span></span><span> </span><span id="local-6989586621679110835"><span class="annot"><span class="annottext">xAll :: String
</span><a href="#local-6989586621679110835"><span class="hs-identifier hs-var">xAll</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679110836"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110836"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679110837"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110837"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110835"><span class="hs-identifier hs-var">xAll</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110835"><span class="hs-identifier hs-var">xAll</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; ShowS
</span><a href="#local-6989586621679110840"><span class="hs-identifier hs-var">groupRange</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110836"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110837"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-151"></span><span>          </span><span id="local-6989586621679110840"><span class="annot"><span class="annottext">groupRange :: Char -&gt; Int -&gt; ShowS
</span><a href="#local-6989586621679110840"><span class="hs-identifier hs-var hs-var">groupRange</span></a></span></span><span> </span><span id="local-6989586621679110861"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679110862"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110863"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679110864"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110864"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; ShowS
</span><a href="#local-6989586621679110840"><span class="hs-identifier hs-var">groupRange</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110864"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-152"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110862"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110861"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; ShowS
</span><a href="#local-6989586621679110840"><span class="hs-identifier hs-var">groupRange</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110863"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679110864"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-154"></span><span>          </span><span class="annot"><a href="#local-6989586621679110840"><span class="hs-identifier hs-var">groupRange</span></a></span><span> </span><span id="local-6989586621679110871"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679110872"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110872"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110872"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110872"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679110872"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679110871"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><span class="hs-comment">-- | Content of @[: :]@, e.g. @&quot;alnum&quot;@ for @[:alnum:]@.</span></span><span>
</span><span id="line-158"></span><span class="hs-keyword">newtype</span><span> </span><span id="PatternSetCharacterClass"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-var">PatternSetCharacterClass</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="PatternSetCharacterClass"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-var">PatternSetCharacterClass</span></a></span></span><span>   </span><span class="hs-special">{</span><span id="unSCC"><span class="annot"><span class="annottext">PatternSetCharacterClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSCC"><span class="hs-identifier hs-var hs-var">unSCC</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110876"><span id="local-6989586621679110881"><span class="annot"><span class="annottext">PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
(PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; (PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; Eq PatternSetCharacterClass
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
== :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
$c/= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
/= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679110888"><span id="local-6989586621679110894"><span id="local-6989586621679110899"><span id="local-6989586621679110904"><span id="local-6989586621679110909"><span id="local-6989586621679110914"><span id="local-6989586621679110919"><span class="annot"><span class="annottext">Eq PatternSetCharacterClass
Eq PatternSetCharacterClass =&gt;
(PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Ordering)
-&gt; (PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; (PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; (PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; (PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool)
-&gt; (PatternSetCharacterClass
    -&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass)
-&gt; (PatternSetCharacterClass
    -&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass)
-&gt; Ord PatternSetCharacterClass
PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Ordering
PatternSetCharacterClass
-&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Ordering
compare :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Ordering
$c&lt; :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
&lt; :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
$c&lt;= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
&lt;= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
$c&gt; :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
&gt; :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
$c&gt;= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
&gt;= :: PatternSetCharacterClass -&gt; PatternSetCharacterClass -&gt; Bool
$cmax :: PatternSetCharacterClass
-&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass
max :: PatternSetCharacterClass
-&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass
$cmin :: PatternSetCharacterClass
-&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass
min :: PatternSetCharacterClass
-&gt; PatternSetCharacterClass -&gt; PatternSetCharacterClass
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | Content of @[. .]@, e.g. @&quot;ch&quot;@ for @[.ch.]@.</span></span><span>
</span><span id="line-162"></span><span class="hs-keyword">newtype</span><span> </span><span id="PatternSetCollatingElement"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCollatingElement"><span class="hs-identifier hs-var">PatternSetCollatingElement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PatternSetCollatingElement"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCollatingElement"><span class="hs-identifier hs-var">PatternSetCollatingElement</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unSCE"><span class="annot"><span class="annottext">PatternSetCollatingElement -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSCE"><span class="hs-identifier hs-var hs-var">unSCE</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110929"><span id="local-6989586621679110934"><span class="annot"><span class="annottext">PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
(PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; Eq PatternSetCollatingElement
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
== :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
$c/= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
/= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679110941"><span id="local-6989586621679110946"><span id="local-6989586621679110951"><span id="local-6989586621679110956"><span id="local-6989586621679110961"><span id="local-6989586621679110966"><span id="local-6989586621679110971"><span class="annot"><span class="annottext">Eq PatternSetCollatingElement
Eq PatternSetCollatingElement =&gt;
(PatternSetCollatingElement
 -&gt; PatternSetCollatingElement -&gt; Ordering)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; Bool)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement)
-&gt; (PatternSetCollatingElement
    -&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement)
-&gt; Ord PatternSetCollatingElement
PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; Ordering
PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; Ordering
compare :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; Ordering
$c&lt; :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
&lt; :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
$c&lt;= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
&lt;= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
$c&gt; :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
&gt; :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
$c&gt;= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
&gt;= :: PatternSetCollatingElement -&gt; PatternSetCollatingElement -&gt; Bool
$cmax :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement
max :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement
$cmin :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement
min :: PatternSetCollatingElement
-&gt; PatternSetCollatingElement -&gt; PatternSetCollatingElement
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">-- | Content of @[= =]@, e.g. @&quot;a&quot;@ for @[=a=]@.</span></span><span>
</span><span id="line-166"></span><span class="hs-keyword">newtype</span><span> </span><span id="PatternSetEquivalenceClass"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetEquivalenceClass"><span class="hs-identifier hs-var">PatternSetEquivalenceClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PatternSetEquivalenceClass"><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetEquivalenceClass"><span class="hs-identifier hs-var">PatternSetEquivalenceClass</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unSEC"><span class="annot"><span class="annottext">PatternSetEquivalenceClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSEC"><span class="hs-identifier hs-var hs-var">unSEC</span></a></span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679110979"><span id="local-6989586621679110984"><span class="annot"><span class="annottext">PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
(PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; Eq PatternSetEquivalenceClass
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
== :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
$c/= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
/= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679110991"><span id="local-6989586621679110996"><span id="local-6989586621679111001"><span id="local-6989586621679111006"><span id="local-6989586621679111011"><span id="local-6989586621679111016"><span id="local-6989586621679111021"><span class="annot"><span class="annottext">Eq PatternSetEquivalenceClass
Eq PatternSetEquivalenceClass =&gt;
(PatternSetEquivalenceClass
 -&gt; PatternSetEquivalenceClass -&gt; Ordering)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; Bool)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass)
-&gt; (PatternSetEquivalenceClass
    -&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass)
-&gt; Ord PatternSetEquivalenceClass
PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; Ordering
PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; Ordering
compare :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; Ordering
$c&lt; :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
&lt; :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
$c&lt;= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
&lt;= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
$c&gt; :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
&gt; :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
$c&gt;= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
&gt;= :: PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass -&gt; Bool
$cmax :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass
max :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass
$cmin :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass
min :: PatternSetEquivalenceClass
-&gt; PatternSetEquivalenceClass -&gt; PatternSetEquivalenceClass
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | Hand-rolled implementation, giving textual rather than Haskell representation.</span></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679111028"><span id="local-6989586621679111031"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-type">PatternSetCharacterClass</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679111035"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; PatternSetCharacterClass -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111036"><span class="annot"><span class="annottext">PatternSetCharacterClass
</span><a href="#local-6989586621679111036"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternSetCharacterClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSCC"><span class="hs-identifier hs-var">unSCC</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSetCharacterClass
</span><a href="#local-6989586621679111036"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | Hand-rolled implementation, giving textual rather than Haskell representation.</span></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679111039"><span id="local-6989586621679111042"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCollatingElement"><span class="hs-identifier hs-type">PatternSetCollatingElement</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679111046"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; PatternSetCollatingElement -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111047"><span class="annot"><span class="annottext">PatternSetCollatingElement
</span><a href="#local-6989586621679111047"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternSetCollatingElement -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSCE"><span class="hs-identifier hs-var">unSCE</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSetCollatingElement
</span><a href="#local-6989586621679111047"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- | Hand-rolled implementation, giving textual rather than Haskell representation.</span></span><span>
</span><span id="line-178"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679111050"><span id="local-6989586621679111053"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetEquivalenceClass"><span class="hs-identifier hs-type">PatternSetEquivalenceClass</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679111057"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; PatternSetEquivalenceClass -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111058"><span class="annot"><span class="annottext">PatternSetEquivalenceClass
</span><a href="#local-6989586621679111058"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternSetEquivalenceClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSEC"><span class="hs-identifier hs-var">unSEC</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSetEquivalenceClass
</span><a href="#local-6989586621679111058"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | @decodePatternSet@ cannot handle collating element and treats</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- equivalence classes as just their definition and nothing more.</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- @since 1.3.2</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#decodePatternSet"><span class="hs-identifier hs-type">decodePatternSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-186"></span><span id="decodePatternSet"><span class="annot"><span class="annottext">decodePatternSet :: PatternSet -&gt; Set Char
</span><a href="Text.Regex.TDFA.Pattern.html#decodePatternSet"><span class="hs-identifier hs-var hs-var">decodePatternSet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSet"><span class="hs-identifier hs-type">PatternSet</span></a></span><span> </span><span id="local-6989586621679111059"><span class="annot"><span class="annottext">Maybe (Set Char)
</span><a href="#local-6989586621679111059"><span class="hs-identifier hs-var">msc</span></a></span></span><span> </span><span id="local-6989586621679111060"><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><a href="#local-6989586621679111060"><span class="hs-identifier hs-var">mscc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCollatingElement)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111061"><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><a href="#local-6989586621679111061"><span class="hs-identifier hs-var">msec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111062"><span class="annot"><span class="annottext">baseMSC :: Set Char
</span><a href="#local-6989586621679111062"><span class="hs-identifier hs-var hs-var">baseMSC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Char -&gt; (Set Char -&gt; Set Char) -&gt; Maybe (Set Char) -&gt; Set Char
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Set Char
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Set Char -&gt; Set Char
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Set Char)
</span><a href="#local-6989586621679111059"><span class="hs-identifier hs-var">msc</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span id="local-6989586621679111067"><span class="annot"><span class="annottext">withMSCC :: Set Char
</span><a href="#local-6989586621679111067"><span class="hs-identifier hs-var hs-var">withMSCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Char -&gt; Char -&gt; Set Char) -&gt; Set Char -&gt; String -&gt; Set Char
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Set Char -&gt; Set Char) -&gt; Set Char -&gt; Char -&gt; Set Char
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Set Char -&gt; Set Char
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679111062"><span class="hs-identifier hs-var">baseMSC</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; (Set PatternSetCharacterClass -&gt; String)
-&gt; Maybe (Set PatternSetCharacterClass)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PatternSetCharacterClass -&gt; String)
-&gt; [PatternSetCharacterClass] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">PatternSetCharacterClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#decodeCharacterClass"><span class="hs-identifier hs-var">decodeCharacterClass</span></a></span><span> </span><span class="annot"><span class="annottext">([PatternSetCharacterClass] -&gt; String)
-&gt; (Set PatternSetCharacterClass -&gt; [PatternSetCharacterClass])
-&gt; Set PatternSetCharacterClass
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set PatternSetCharacterClass -&gt; [PatternSetCharacterClass]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetCharacterClass)
</span><a href="#local-6989586621679111060"><span class="hs-identifier hs-var">mscc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621679111074"><span class="annot"><span class="annottext">withMSEC :: Set Char
</span><a href="#local-6989586621679111074"><span class="hs-identifier hs-var hs-var">withMSEC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Char -&gt; Char -&gt; Set Char) -&gt; Set Char -&gt; String -&gt; Set Char
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Set Char -&gt; Set Char) -&gt; Set Char -&gt; Char -&gt; Set Char
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Set Char -&gt; Set Char
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679111067"><span class="hs-identifier hs-var">withMSCC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; (Set PatternSetEquivalenceClass -&gt; String)
-&gt; Maybe (Set PatternSetEquivalenceClass)
-&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PatternSetEquivalenceClass -&gt; String)
-&gt; [PatternSetEquivalenceClass] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">PatternSetEquivalenceClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#unSEC"><span class="hs-identifier hs-var">unSEC</span></a></span><span> </span><span class="annot"><span class="annottext">([PatternSetEquivalenceClass] -&gt; String)
-&gt; (Set PatternSetEquivalenceClass -&gt; [PatternSetEquivalenceClass])
-&gt; Set PatternSetEquivalenceClass
-&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set PatternSetEquivalenceClass -&gt; [PatternSetEquivalenceClass]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toAscList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Set PatternSetEquivalenceClass)
</span><a href="#local-6989586621679111061"><span class="hs-identifier hs-var">msec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set Char
</span><a href="#local-6989586621679111074"><span class="hs-identifier hs-var">withMSEC</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | This returns the strictly ascending list of characters</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- represented by @[: :]@ POSIX character classes.</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- Unrecognized class names return an empty string.</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- @since 1.3.2</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#decodeCharacterClass"><span class="hs-identifier hs-type">decodeCharacterClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-type">PatternSetCharacterClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-198"></span><span id="decodeCharacterClass"><span class="annot"><span class="annottext">decodeCharacterClass :: PatternSetCharacterClass -&gt; String
</span><a href="Text.Regex.TDFA.Pattern.html#decodeCharacterClass"><span class="hs-identifier hs-var hs-var">decodeCharacterClass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PatternSetCharacterClass"><span class="hs-identifier hs-type">PatternSetCharacterClass</span></a></span><span> </span><span id="local-6989586621679111075"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679111075"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679111075"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;alnum&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;digit&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;punct&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\33'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\47'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\58'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\64'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\91'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\96'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\123'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\126'</span></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;alpha&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;graph&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\41'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\126'</span></span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;space&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t\n\v\f\r &quot;</span></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;blank&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t &quot;</span></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lower&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;upper&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cntrl&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\31'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\127&quot;</span></span><span> </span><span class="hs-comment">-- with NUL</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;print&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\32'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\126'</span></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xdigit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'F'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'f'</span></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;word&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- == -- ==</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Do the transformation and simplification in a single traversal.</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- This removes the 'PPlus', 'PQuest', and 'PBound' values, changing to 'POr'</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- and 'PEmpty' and 'PStar'.  For some 'PBound' values it adds</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- 'PNonEmpty' and 'PNonCapture' semantic marker.  It also simplifies to</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- flatten out nested 'POr' and 'PConcat' instances and eliminate some</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- unneeded 'PEmpty' values.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#starTrans"><span class="hs-identifier hs-type">starTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-224"></span><span id="starTrans"><span class="annot"><span class="annottext">starTrans :: Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#starTrans"><span class="hs-identifier hs-var hs-var">starTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#dfsPattern"><span class="hs-identifier hs-var">dfsPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#starTrans%27"><span class="hs-identifier hs-var">starTrans'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | Apply a 'Pattern' transformation function depth first.</span></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#dfsPattern"><span class="hs-identifier hs-type">dfsPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The transformation function.</span></span><span>
</span><span id="line-228"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ The 'Pattern' to transform.</span></span><span>
</span><span id="line-229"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>               </span><span class="annot"><span class="hs-comment">-- ^ The transformed 'Pattern'.</span></span><span>
</span><span id="line-230"></span><span id="dfsPattern"><span class="annot"><span class="annottext">dfsPattern :: (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#dfsPattern"><span class="hs-identifier hs-var hs-var">dfsPattern</span></a></span></span><span> </span><span id="local-6989586621679111076"><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var">dfs</span></a></span><span>
</span><span id="line-231"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679111078"><span class="annot"><span class="annottext">unary :: (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var hs-var">unary</span></a></span></span><span> </span><span id="local-6989586621679111079"><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111079"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111079"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var">dfs</span></a></span><span>
</span><span id="line-232"></span><span>       </span><span id="local-6989586621679111077"><span class="annot"><span class="annottext">dfs :: Pattern -&gt; Pattern
</span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var hs-var">dfs</span></a></span></span><span> </span><span id="local-6989586621679111080"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111080"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111080"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-233"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679111081"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111081"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; [Pattern] -&gt; [Pattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var">dfs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111081"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679111082"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111082"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; [Pattern] -&gt; [Pattern]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111077"><span class="hs-identifier hs-var">dfs</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111082"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span id="local-6989586621679111083"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111083"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679111084"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111084"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">unary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111083"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111084"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-236"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679111085"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111085"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">unary</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-var">PQuest</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111085"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-237"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679111086"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">unary</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-var">PPlus</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111086"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-238"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span id="local-6989586621679111087"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679111087"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679111088"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111088"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">unary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679111087"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111088"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-239"></span><span>                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679111089"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111089"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679111090"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111090"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span id="local-6989586621679111091"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111091"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111078"><span class="hs-identifier hs-var">unary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-var">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111089"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679111090"><span class="hs-identifier hs-var">mi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111091"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-240"></span><span>                       </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111080"><span class="hs-identifier hs-var">pattern</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">{- Replace by PNonCapture
unCapture = dfsPattern unCapture' where
  unCapture' (PGroup (Just _) p) = PGroup Nothing p
  unCapture' x = x
-}</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-type">reGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-248"></span><span id="reGroup"><span class="annot"><span class="annottext">reGroup :: Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var hs-var">reGroup</span></a></span></span><span> </span><span id="local-6989586621679111093"><span class="annot"><span class="annottext">p :: Pattern
</span><a href="#local-6989586621679111093"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679111094"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111094"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111094"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111093"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span id="local-6989586621679111095"><span class="annot"><span class="annottext">p :: Pattern
</span><a href="#local-6989586621679111095"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679111096"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111096"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111095"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span id="local-6989586621679111097"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111097"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#starTrans%27"><span class="hs-identifier hs-type">starTrans'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-253"></span><span id="starTrans%27"><span class="annot"><span class="annottext">starTrans' :: Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#starTrans%27"><span class="hs-identifier hs-var hs-var">starTrans'</span></a></span></span><span> </span><span id="local-6989586621679111098"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111098"><span class="hs-identifier hs-var">pIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111098"><span class="hs-identifier hs-var">pIn</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- We know that &quot;p&quot; has been simplified in each of these cases:</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679111099"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111099"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111099"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">{- The PStar should not capture 0 characters on its first iteration,
   so set its mayFirstBeNull flag to False
 -}</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679111100"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-261"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">asGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111100"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">{- &quot;An ERE matching a single character repeated by an '*' , '?' , or
   an interval expression shall not match a null expression unless
   this is the only match for the repetition or it is necessary to
   satisfy the exact or minimum number of occurrences for the interval
   expression.&quot;
 -}</span><span>
</span><span id="line-269"></span><span class="hs-comment">{- p? is p|PEmpty which prefers even a 0-character match for p
   p{0,1} is p? is POr [p,PEmpty]
   p{0,2} is (pp?)? NOT p?p?
   p{0,3} is (p(pp?)?)?
   p{1,2} is like pp{0,1} is like pp? but see below
   p{2,5} is ppp{0,3} is pp(p(pp?)?)?

   But this is not always right.  Because if the second use of p in
   p?p? matches 0 characters then the perhaps non 0 character match of
   the first p is overwritten.

   We need a new operation &quot;p!&quot; that means &quot;p?&quot; unless &quot;p&quot; match 0
   characters, in which case skip p as if it failed in &quot;p?&quot;.  Thus
   when p cannot accept 0 characters p! and p? are equivalent.  And
   when p can only match 0 characters p! is PEmpty.  So for
   simplicity, only use ! when p can match 0 characters but not only 0
   characters.

   Call this (PNonEmpty p) in the Pattern type.
   p! is PNonEmpty p is POr [PEmpty,p]
   IS THIS TRUE?  Use QuickCheck?

   Note that if p cannot match 0 characters then p! is p? and vice versa

   The p{0,1} is still always p? and POr [p,PEmpty]
   Now p{0,2} means p?p! or (pp!)? and p{0,3} means (p(pp!)!)? or p?p!p!
   Equivalently p?p! and p?p!p!
   And p{2,2} is p'p and p{3,3} is p'p'p and p{4} is p'p'p'p
   The p{1,2} is pp! and p{1,3} is pp!p! or p(pp!)!
   And p{2,4} means p'pp!p! and p{3,6} is p'p'pp!p!p! or p'p'p(p(pp!)!)!

   But this second form still has a problem: the (pp!)! can have the first
   p match 0 and the second p match non-zero. This showed up for (.|$){1,3}
   since ($.!)! should not be a valid path but altered the qt_win commands.

   Thus only p'p'pp!p!p! has the right semantics.  For completeness:

   if p can only match only 0 characters then the cases are
   p{0,0} is (), p{0,_} = p?, p{_,_} is p

   if p can match 0 or non-zero characters then cases are
   p{0,0} is (), p{0,1} is (p)?, p{0,2} is (pp!)?, p{0,3} is (pp!p!)?
   p{1,1} is p, p{1,2} is pp!, p{1,3} is pp!p!, p{1,4} is pp!p!p!
   p{2,2} is p'p,
   p{2,3} is p'pp!,
   p{2,4} is p'pp!p! or p'p(pp!)!
   p{2,5} is p'pp!p!p! or p'p(p(pp!)!)!
   p{3,3} is p'p'p, p{3,4} is p'p'pp!, p{3,5} is p'p'pp!p!, p{3,6} is p'p'pp!p!p!

   if p can only match 1 or more characters then cases are
   p{0,0} is ()
   p{0,1} is p?, p{0,2} is (pp?)?, p{0,3} is (p(pp?)?)?, p{0,4} is (pp{0,3})?
   p{1,1} is p, p{1,j} is pp{0,pred j}
   p{2,2} is p'p, p{2,3} is p'pp?, p{2,4} is p'p(pp?)?, p{2,5} = p'p{1,4} = p'(pp{0,3})
   p{3,3} is p'p'p, p{3,4} is p'p'pp?, p{3,5} is p'p'p(pp?)?, p{3,6} is

   And by this logic, the PStar False is really p*!  So p{0,} is p*
   and p{1,} is pp*! and p{2,} is p'pp*! and p{3,} is p'p'pp*!

   The (nonEmpty' p) below is the only way PNonEmpty is introduced
   into the Pattern.  It is always preceded by p inside a PConcat
   list.  The p involved never simplifies to PEmpty.  Thus it is
   impossible to have PNonEmpty directly nested, i.e. (PNonEmpty
   (PNonEmpty _)) never occurs even after simplifications.

   The (nonCapture' p) below is the only way PNonCapture is
   introduced into the Pattern. It is always followed by p inside a
   PConcat list.

-}</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- Easy cases</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679111103"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111103"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111103"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>  </span><span class="hs-comment">-- impossibly malformed</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679111105"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111105"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679111106"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111106"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111105"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111106"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>  </span><span class="hs-comment">-- impossibly malformed</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- Medium cases</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621679111108"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111108"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111108"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">quest</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111108"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-345"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111108"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679111110"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111110"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">quest</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111110"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- Hard cases</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679111111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111111"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621679111112"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-349"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">asGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; ([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; [Pattern]) -&gt; Int -&gt; [Pattern] -&gt; [Pattern]
forall {b}. (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111114"><span class="hs-identifier hs-var">nc'p</span></a></span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; [Pattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111111"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-var">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679111114"><span class="annot"><span class="annottext">nc'p :: Pattern
</span><a href="#local-6989586621679111114"><span class="hs-identifier hs-var hs-var">nc'p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111115"><span class="hs-identifier hs-var">nonCapture'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111112"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679111116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679111117"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">quest</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-352"></span><span>                        </span><span class="hs-comment">-- The first operation is quest NOT nonEmpty. This can be tested with</span><span>
</span><span id="line-353"></span><span>                        </span><span class="hs-comment">-- &quot;a\nb&quot; &quot;((^)?|b){0,3}&quot; and &quot;a\nb&quot; &quot;((^)|b){0,3}&quot;</span><span>
</span><span id="line-354"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">quest</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var">concat'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-355"></span><span>                                        </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Int -&gt; Pattern -&gt; Pattern
forall {b}. (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">nonEmpty'</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var">concat'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111116"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">nonEmpty'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111117"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span class="hs-comment">{- 0.99.6 remove
| cannotMatchNull p -&gt; apply (quest' . (concat' p)) (pred j) (quest' p)
| otherwise -&gt; POr [ simplify' (PConcat (p : replicate (pred j) (nonEmpty' p))) , PEmpty ]
-}</span><span>
</span><span id="line-360"></span><span class="hs-comment">{- 0.99.6 add, 0.99.7 remove
    PBound i (Just j) p | canOnlyMatchNull p -&gt; p
                        | i == j -&gt; PConcat $ apply (p':) (pred i) [p]
                        | otherwise -&gt; PConcat $ apply (p':) (pred i)
                                        [p,apply (nonEmpty' . (concat' p)) (j-i-1) (nonEmpty' p) ]
      where p' = nonCapture' p
-}</span><span>
</span><span id="line-367"></span><span class="hs-comment">{- 0.99.7 add -}</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span id="local-6989586621679111120"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679111121"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111121"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679111122"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-369"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111121"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">asGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; ([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; [Pattern]) -&gt; Int -&gt; [Pattern] -&gt; [Pattern]
forall {b}. (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111123"><span class="hs-identifier hs-var">nc'p</span></a></span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; [Pattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var">asGroup</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern)
-&gt; ([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; Pattern) -&gt; [Pattern] -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Pattern] -&gt; [Pattern]) -&gt; Int -&gt; [Pattern] -&gt; [Pattern]
forall {b}. (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111123"><span class="hs-identifier hs-var">nc'p</span></a></span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; [Pattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>                                        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Int -&gt; Pattern -&gt; Pattern
forall {b}. (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">nonEmpty'</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; (Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var">concat'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111121"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111120"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111124"><span class="hs-identifier hs-var">ne'p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679111123"><span class="annot"><span class="annottext">nc'p :: Pattern
</span><a href="#local-6989586621679111123"><span class="hs-identifier hs-var hs-var">nc'p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111115"><span class="hs-identifier hs-var">nonCapture'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-373"></span><span>            </span><span id="local-6989586621679111124"><span class="annot"><span class="annottext">ne'p :: Pattern
</span><a href="#local-6989586621679111124"><span class="hs-identifier hs-var hs-var">ne'p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var">nonEmpty'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111122"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-374"></span><span class="hs-comment">{- 0.99.6
| cannotMatchNull p -&gt; PConcat $ apply (p':) (pred i) $ (p:) $
  [apply (quest' . (concat' p)) (pred (j-i)) (quest' p)]
| otherwise -&gt; PConcat $ (replicate (pred i) p') ++ p : (replicate (j-i) (nonEmpty' p))
-}</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span id="local-6989586621679111125"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679111125"><span class="hs-identifier hs-var">mayFirstBeNull</span></a></span></span><span> </span><span id="local-6989586621679111126"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679111125"><span class="hs-identifier hs-var">mayFirstBeNull</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var">quest</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111126"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-380"></span><span>                                                                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-381"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-comment">-- Left intact</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PCarat"><span class="hs-identifier hs-type">PCarat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDollar"><span class="hs-identifier hs-type">PDollar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDot"><span class="hs-identifier hs-type">PDot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAny"><span class="hs-identifier hs-type">PAny</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PAnyNot"><span class="hs-identifier hs-type">PAnyNot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PEscape"><span class="hs-identifier hs-type">PEscape</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PChar"><span class="hs-identifier hs-type">PChar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-type">PNonCapture</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonEmpty"><span class="hs-identifier hs-type">PNonEmpty</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="hs-comment">-- TODO : remove PNonEmpty from program</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679111109"><span class="annot"><span class="annottext">quest :: Pattern -&gt; Pattern
</span><a href="#local-6989586621679111109"><span class="hs-identifier hs-var hs-var">quest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679111128"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111128"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- require p to have been simplified</span><span>
</span><span id="line-398"></span><span class="hs-comment">--    quest' = (\ p -&gt; simplify' $ POr [p,PEmpty])  -- require p to have been simplified</span><span>
</span><span id="line-399"></span><span>    </span><span id="local-6989586621679111118"><span class="annot"><span class="annottext">concat' :: Pattern -&gt; Pattern -&gt; Pattern
</span><a href="#local-6989586621679111118"><span class="hs-identifier hs-var hs-var">concat'</span></a></span></span><span> </span><span id="local-6989586621679111129"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111129"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679111130"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111130"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111129"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#reGroup"><span class="hs-identifier hs-var">reGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111130"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>      </span><span class="hs-comment">-- require a and b to have been simplified</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621679111119"><span class="annot"><span class="annottext">nonEmpty' :: Pattern -&gt; Pattern
</span><a href="#local-6989586621679111119"><span class="hs-identifier hs-var hs-var">nonEmpty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679111131"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111131"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Pattern) -&gt; Pattern -&gt; Pattern
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111131"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 2009-01-19 : this was PNonEmpty</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679111115"><span class="annot"><span class="annottext">nonCapture' :: Pattern -&gt; Pattern
</span><a href="#local-6989586621679111115"><span class="hs-identifier hs-var hs-var">nonCapture'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-var">PNonCapture</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679111113"><span class="annot"><span class="annottext">apply :: (b -&gt; b) -&gt; Int -&gt; b -&gt; b
</span><a href="#local-6989586621679111113"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679111133"><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679111133"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679111134"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111134"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679111135"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679111135"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b -&gt; b) -&gt; b -&gt; b) -&gt; b -&gt; [b -&gt; b] -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; b -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679111135"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (b -&gt; b) -&gt; [b -&gt; b]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679111134"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
</span><a href="#local-6989586621679111133"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- function f applied n times to x : f^n(x)</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679111102"><span class="annot"><span class="annottext">asGroup :: Pattern -&gt; Pattern
</span><a href="#local-6989586621679111102"><span class="hs-identifier hs-var hs-var">asGroup</span></a></span></span><span> </span><span id="local-6989586621679111138"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111138"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-var">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111138"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679111127"><span class="annot"><span class="annottext">pass :: Pattern
</span><a href="#local-6989586621679111127"><span class="hs-identifier hs-var hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111098"><span class="hs-identifier hs-var">pIn</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | Function to transform a pattern into an equivalent, but less</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- redundant form.  Nested 'POr' and 'PConcat' are flattened. 'PEmpty'</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- is propagated.</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-type">simplify'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-410"></span><span id="simplify%27"><span class="annot"><span class="annottext">simplify' :: Pattern -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var hs-var">simplify'</span></a></span></span><span> </span><span id="local-6989586621679111139"><span class="annot"><span class="annottext">x :: Pattern
</span><a href="#local-6989586621679111139"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111140"><span class="annot"><span class="annottext">ps' :: [Pattern]
</span><a href="#local-6989586621679111140"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Bool) -&gt; [Pattern] -&gt; ([Pattern], [Pattern])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-var">notPEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern]
</span><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-var">flatten</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111139"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679111144"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111144"><span class="hs-identifier hs-var">notEmpty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111144"><span class="hs-identifier hs-var">notEmpty</span></a></span><span>
</span><span id="line-413"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679111145"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111145"><span class="hs-identifier hs-var">notEmpty</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679111146"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111146"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111145"><span class="hs-identifier hs-var">notEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; [Pattern] -&gt; [Pattern]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern] -&gt; [Pattern]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">(Pattern -&gt; Bool) -&gt; [Pattern] -&gt; [Pattern]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-var">notPEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111146"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- keep 1st PEmpty only</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111140"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-415"></span><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-416"></span><span>       </span><span class="hs-special">[</span><span id="local-6989586621679111147"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111147"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111147"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-417"></span><span>       </span><span class="annot"><span class="annottext">[Pattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-var">POr</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111140"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span id="local-6989586621679111148"><span class="annot"><span class="annottext">x :: Pattern
</span><a href="#local-6989586621679111148"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679111149"><span class="annot"><span class="annottext">ps' :: [Pattern]
</span><a href="#local-6989586621679111149"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Bool) -&gt; [Pattern] -&gt; [Pattern]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-var">notPEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern -&gt; [Pattern]
</span><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-var">flatten</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111148"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111149"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-422"></span><span>       </span><span class="hs-special">[</span><span id="local-6989586621679111150"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111150"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111150"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-423"></span><span>       </span><span class="annot"><span class="annottext">[Pattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern] -&gt; Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-var">PConcat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111149"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-comment">-- PConcat ps'</span><span>
</span><span id="line-424"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-type">PNonCapture</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-comment">-- 2009, perhaps useful</span><span>
</span><span id="line-426"></span><span class="hs-comment">--simplify' (PNonEmpty PEmpty) = err &quot;simplify' (PNonEmpty PEmpty) = should be Impossible!&quot; -- 2009</span><span>
</span><span id="line-427"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#simplify%27"><span class="hs-identifier hs-var">simplify'</span></a></span><span> </span><span id="local-6989586621679111151"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111151"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111151"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><span class="hs-comment">-- | Function to flatten nested 'POr' or nested 'PConcat' applicataions.</span></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-type">flatten</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-431"></span><span id="flatten"><span class="annot"><span class="annottext">flatten :: Pattern -&gt; [Pattern]
</span><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-var hs-var">flatten</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679111152"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111152"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; [Pattern]) -&gt; [Pattern] -&gt; [Pattern]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679111153"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111153"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-432"></span><span>                                       </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679111154"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111154"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111154"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-433"></span><span>                                       </span><span id="local-6989586621679111155"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111155"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111155"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111152"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-var">flatten</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679111156"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111156"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Pattern -&gt; [Pattern]) -&gt; [Pattern] -&gt; [Pattern]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679111157"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111157"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111157"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>                                           </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679111158"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111158"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111158"><span class="hs-identifier hs-var">ps'</span></a></span><span>
</span><span id="line-436"></span><span>                                           </span><span id="local-6989586621679111159"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111159"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111159"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111156"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#flatten"><span class="hs-identifier hs-var">flatten</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Pattern]
forall a. String -&gt; a
</span><a href="Text.Regex.TDFA.Pattern.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;flatten can only be applied to POr or PConcat&quot;</span></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-type">notPEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-440"></span><span id="notPEmpty"><span class="annot"><span class="annottext">notPEmpty :: Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-var hs-var">notPEmpty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#notPEmpty"><span class="hs-identifier hs-var">notPEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Determines if 'Pattern' will fail or accept @[]@ and never accept any</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- characters. Treat 'PCarat' and 'PDollar' as @True@.</span><span>
</span><span id="line-445"></span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-type">canOnlyMatchNull</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-446"></span><span id="canOnlyMatchNull"><span class="annot"><span class="annottext">canOnlyMatchNull :: Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var hs-var">canOnlyMatchNull</span></a></span></span><span> </span><span id="local-6989586621679111160"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111160"><span class="hs-identifier hs-var">pIn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111160"><span class="hs-identifier hs-var">pIn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><a href="Text.Regex.TDFA.Pattern.html#PEmpty"><span class="hs-identifier hs-var">PEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PGroup"><span class="hs-identifier hs-type">PGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111161"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111161"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#POr"><span class="hs-identifier hs-type">POr</span></a></span><span> </span><span id="local-6989586621679111162"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Bool) -&gt; [Pattern] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111162"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PConcat"><span class="hs-identifier hs-type">PConcat</span></a></span><span> </span><span id="local-6989586621679111164"><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Pattern -&gt; Bool) -&gt; [Pattern] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern]
</span><a href="#local-6989586621679111164"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PQuest"><span class="hs-identifier hs-type">PQuest</span></a></span><span> </span><span id="local-6989586621679111165"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111165"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111165"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PPlus"><span class="hs-identifier hs-type">PPlus</span></a></span><span> </span><span id="local-6989586621679111166"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111166"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111166"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PStar"><span class="hs-identifier hs-type">PStar</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111167"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111167"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111167"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PBound"><span class="hs-identifier hs-type">PBound</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679111168"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111168"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111168"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PCarat"><span class="hs-identifier hs-type">PCarat</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PDollar"><span class="hs-identifier hs-type">PDollar</span></a></span><span> </span><span class="annot"><span class="annottext">DoPa
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><a href="Text.Regex.TDFA.Pattern.html#PNonCapture"><span class="hs-identifier hs-type">PNonCapture</span></a></span><span> </span><span id="local-6989586621679111169"><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111169"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern -&gt; Bool
</span><a href="Text.Regex.TDFA.Pattern.html#canOnlyMatchNull"><span class="hs-identifier hs-var">canOnlyMatchNull</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern
</span><a href="#local-6989586621679111169"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-460"></span><span class="hs-comment">--    PNonEmpty p -&gt; canOnlyMatchNull p -- like PQuest</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">Pattern
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">{-

-- | If 'cannotMatchNull' returns 'True' then it is known that the
-- 'Pattern' will never accept an empty string.  If 'cannotMatchNull'
-- returns 'False' then it is possible but not definite that the
-- 'Pattern' could accept an empty string.
cannotMatchNull :: Pattern -&gt; Bool
cannotMatchNull pIn =
  case pIn of
    PEmpty -&gt; False
    PGroup _ p -&gt; cannotMatchNull p
    POr [] -&gt; False
    POr ps -&gt; all cannotMatchNull ps
    PConcat [] -&gt; False
    PConcat ps -&gt; any cannotMatchNull ps
    PQuest _ -&gt; False
    PPlus p -&gt; cannotMatchNull p
    PStar {} -&gt; False
    PBound 0 _ _ -&gt; False
    PBound _ _ p -&gt; cannotMatchNull p
    PCarat _ -&gt; False
    PDollar _ -&gt; False
    PNonCapture p -&gt; cannotMatchNull p
--    PNonEmpty _ -&gt; False -- like PQuest
    _ -&gt; True
-}</span><span>
</span><span id="line-489"></span></pre></body></html>