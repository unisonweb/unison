<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      : Crypto.Cipher.Camellia.Primitive</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability : Good</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- This only cover Camellia 128 bits for now. The API will change once</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- 192 and 256 mode are implemented too.</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Cipher.Camellia.Primitive</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier">Camellia</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#initCamellia"><span class="hs-identifier">initCamellia</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#encrypt"><span class="hs-identifier">encrypt</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#decrypt"><span class="hs-identifier">decrypt</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Error.html"><span class="hs-identifier">Crypto.Error</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.ByteArray.html"><span class="hs-identifier">Crypto.Internal.ByteArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ByteArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Crypto.Internal.ByteArray.html"><span class="hs-identifier">Crypto.Internal.ByteArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.Words.html"><span class="hs-identifier">Crypto.Internal.Words</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Crypto.Internal.WordArray.html"><span class="hs-identifier">Crypto.Internal.WordArray</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Memory.Endian</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">data</span><span> </span><span id="Mode"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Decrypt"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Decrypt"><span class="hs-identifier hs-var">Decrypt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Encrypt"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Encrypt"><span class="hs-identifier hs-var">Encrypt</span></a></span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-type">w64tow128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span>
</span><span id="line-32"></span><span id="w64tow128"><span class="annot"><span class="annottext">w64tow128 :: (Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var hs-var">w64tow128</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227040"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227040"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227041"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227041"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word128
</span><span class="hs-identifier hs-var">Word128</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227040"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227041"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow8"><span class="hs-identifier hs-type">w64tow8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span id="w64tow8"><span class="annot"><span class="annottext">w64tow8 :: Word64 -&gt; (Word8, Word8, Word8, Word8, Word8, Word8, Word8, Word8)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow8"><span class="hs-identifier hs-var hs-var">w64tow8</span></a></span></span><span> </span><span id="local-6989586621679227044"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227045"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227046"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227047"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227048"><span class="hs-identifier hs-var">t4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227049"><span class="hs-identifier hs-var">t5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227050"><span class="hs-identifier hs-var">t6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227051"><span class="hs-identifier hs-var">t7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227052"><span class="hs-identifier hs-var">t8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>        </span><span id="local-6989586621679227045"><span class="annot"><span class="annottext">t1 :: Word8
</span><a href="#local-6989586621679227045"><span class="hs-identifier hs-var hs-var">t1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>        </span><span id="local-6989586621679227046"><span class="annot"><span class="annottext">t2 :: Word8
</span><a href="#local-6989586621679227046"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>        </span><span id="local-6989586621679227047"><span class="annot"><span class="annottext">t3 :: Word8
</span><a href="#local-6989586621679227047"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>        </span><span id="local-6989586621679227048"><span class="annot"><span class="annottext">t4 :: Word8
</span><a href="#local-6989586621679227048"><span class="hs-identifier hs-var hs-var">t4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>        </span><span id="local-6989586621679227049"><span class="annot"><span class="annottext">t5 :: Word8
</span><a href="#local-6989586621679227049"><span class="hs-identifier hs-var hs-var">t5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>        </span><span id="local-6989586621679227050"><span class="annot"><span class="annottext">t6 :: Word8
</span><a href="#local-6989586621679227050"><span class="hs-identifier hs-var hs-var">t6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>        </span><span id="local-6989586621679227051"><span class="annot"><span class="annottext">t7 :: Word8
</span><a href="#local-6989586621679227051"><span class="hs-identifier hs-var hs-var">t7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>        </span><span id="local-6989586621679227052"><span class="annot"><span class="annottext">t8 :: Word8
</span><a href="#local-6989586621679227052"><span class="hs-identifier hs-var hs-var">t8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227044"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#w8tow64"><span class="hs-identifier hs-type">w8tow64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-47"></span><span id="w8tow64"><span class="annot"><span class="annottext">w8tow64 :: (Word8, Word8, Word8, Word8, Word8, Word8, Word8, Word8) -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w8tow64"><span class="hs-identifier hs-var hs-var">w8tow64</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227080"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227080"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227081"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227081"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227082"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227082"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227083"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227083"><span class="hs-identifier hs-var">t4</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227084"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227084"><span class="hs-identifier hs-var">t5</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227085"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227085"><span class="hs-identifier hs-var">t6</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227086"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227086"><span class="hs-identifier hs-var">t7</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679227087"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227087"><span class="hs-identifier hs-var">t8</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227080"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">56</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227081"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227082"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227083"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227084"><span class="hs-identifier hs-var">t5</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">24</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227085"><span class="hs-identifier hs-var">t6</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227086"><span class="hs-identifier hs-var">t7</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227087"><span class="hs-identifier hs-var">t8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sbox"><span class="hs-identifier hs-type">sbox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-58"></span><span id="sbox"><span class="annot"><span class="annottext">sbox :: Int -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox"><span class="hs-identifier hs-var hs-var">sbox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array8 -&gt; Int -&gt; Word8
</span><a href="Crypto.Internal.WordArray.html#arrayRead8"><span class="hs-identifier hs-var">arrayRead8</span></a></span><span> </span><span class="annot"><span class="annottext">Array8
</span><a href="#local-6989586621679227092"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679227092"><span class="annot"><span class="annottext">t :: Array8
</span><a href="#local-6989586621679227092"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Array8
</span><a href="Crypto.Internal.WordArray.html#array8"><span class="hs-identifier hs-var">array8</span></a></span><span>
</span><span id="line-60"></span><span>            </span><span class="annot"><span class="annottext">Addr#
</span><span class="hs-string">&quot;\x70\x82\x2c\xec\xb3\x27\xc0\xe5\xe4\x85\x57\x35\xea\x0c\xae\x41\
            \\x23\xef\x6b\x93\x45\x19\xa5\x21\xed\x0e\x4f\x4e\x1d\x65\x92\xbd\
            \\x86\xb8\xaf\x8f\x7c\xeb\x1f\xce\x3e\x30\xdc\x5f\x5e\xc5\x0b\x1a\
            \\xa6\xe1\x39\xca\xd5\x47\x5d\x3d\xd9\x01\x5a\xd6\x51\x56\x6c\x4d\
            \\x8b\x0d\x9a\x66\xfb\xcc\xb0\x2d\x74\x12\x2b\x20\xf0\xb1\x84\x99\
            \\xdf\x4c\xcb\xc2\x34\x7e\x76\x05\x6d\xb7\xa9\x31\xd1\x17\x04\xd7\
            \\x14\x58\x3a\x61\xde\x1b\x11\x1c\x32\x0f\x9c\x16\x53\x18\xf2\x22\
            \\xfe\x44\xcf\xb2\xc3\xb5\x7a\x91\x24\x08\xe8\xa8\x60\xfc\x69\x50\
            \\xaa\xd0\xa0\x7d\xa1\x89\x62\x97\x54\x5b\x1e\x95\xe0\xff\x64\xd2\
            \\x10\xc4\x00\x48\xa3\xf7\x75\xdb\x8a\x03\xe6\xda\x09\x3f\xdd\x94\
            \\x87\x5c\x83\x02\xcd\x4a\x90\x33\x73\x67\xf6\xf3\x9d\x7f\xbf\xe2\
            \\x52\x9b\xd8\x26\xc8\x37\xc6\x3b\x81\x96\x6f\x4b\x13\xbe\x63\x2e\
            \\xe9\x79\xa7\x8c\x9f\x6e\xbc\x8e\x29\xf5\xf9\xb6\x2f\xfd\xb4\x59\
            \\x78\x98\x06\x6a\xe7\x46\x71\xba\xd4\x25\xab\x42\x88\xa2\x8d\xfa\
            \\x72\x07\xb9\x55\xf8\xee\xac\x0a\x36\x49\x2a\x68\x3c\x38\xf1\xa4\
            \\x40\x28\xd3\x7b\xbb\xc9\x43\xc1\x15\xe3\xad\xf4\x77\xc7\x80\x9e&quot;#</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-type">sbox1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-78"></span><span id="sbox1"><span class="annot"><span class="annottext">sbox1 :: Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var hs-var">sbox1</span></a></span></span><span> </span><span id="local-6989586621679227095"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227095"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox"><span class="hs-identifier hs-var">sbox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227095"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sbox2"><span class="hs-identifier hs-type">sbox2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-81"></span><span id="sbox2"><span class="annot"><span class="annottext">sbox2 :: Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox2"><span class="hs-identifier hs-var hs-var">sbox2</span></a></span></span><span> </span><span id="local-6989586621679227097"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227097"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var">sbox1</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227097"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sbox3"><span class="hs-identifier hs-type">sbox3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-84"></span><span id="sbox3"><span class="annot"><span class="annottext">sbox3 :: Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox3"><span class="hs-identifier hs-var hs-var">sbox3</span></a></span></span><span> </span><span id="local-6989586621679227100"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227100"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var">sbox1</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227100"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sbox4"><span class="hs-identifier hs-type">sbox4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-87"></span><span id="sbox4"><span class="annot"><span class="annottext">sbox4 :: Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox4"><span class="hs-identifier hs-var hs-var">sbox4</span></a></span></span><span> </span><span id="local-6989586621679227102"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227102"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var">sbox1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227102"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma1"><span class="hs-identifier hs-type">sigma1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma2"><span class="hs-identifier hs-type">sigma2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma3"><span class="hs-identifier hs-type">sigma3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma4"><span class="hs-identifier hs-type">sigma4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma5"><span class="hs-identifier hs-type">sigma5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#sigma6"><span class="hs-identifier hs-type">sigma6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-90"></span><span id="sigma1"><span class="annot"><span class="annottext">sigma1 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma1"><span class="hs-identifier hs-var hs-var">sigma1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xA09E667F3BCC908B</span></span><span>
</span><span id="line-91"></span><span id="sigma2"><span class="annot"><span class="annottext">sigma2 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma2"><span class="hs-identifier hs-var hs-var">sigma2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xB67AE8584CAA73B2</span></span><span>
</span><span id="line-92"></span><span id="sigma3"><span class="annot"><span class="annottext">sigma3 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma3"><span class="hs-identifier hs-var hs-var">sigma3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xC6EF372FE94F82BE</span></span><span>
</span><span id="line-93"></span><span id="sigma4"><span class="annot"><span class="annottext">sigma4 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma4"><span class="hs-identifier hs-var hs-var">sigma4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x54FF53A5F1D36F1C</span></span><span>
</span><span id="line-94"></span><span id="sigma5"><span class="annot"><span class="annottext">sigma5 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma5"><span class="hs-identifier hs-var hs-var">sigma5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x10E527FADE682D1D</span></span><span>
</span><span id="line-95"></span><span id="sigma6"><span class="annot"><span class="annottext">sigma6 :: Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma6"><span class="hs-identifier hs-var hs-var">sigma6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xB05688C2B3E6C1FD</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-identifier hs-type">rotl128</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span>
</span><span id="line-98"></span><span id="rotl128"><span class="annot"><span class="annottext">rotl128 :: Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-identifier hs-var hs-var">rotl128</span></a></span></span><span> </span><span id="local-6989586621679227110"><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227110"><span class="hs-identifier hs-var">v</span></a></span></span><span>               </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227110"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-identifier hs-var">rotl128</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227111"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227111"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679227112"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227112"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word128
</span><span class="hs-identifier hs-var">Word128</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227112"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227111"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-identifier hs-var">rotl128</span></a></span><span> </span><span id="local-6989586621679227113"><span class="annot"><span class="annottext">v :: Word128
</span><a href="#local-6989586621679227113"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227114"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227114"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679227115"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227115"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679227116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227113"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word128
</span><span class="hs-identifier hs-var">Word128</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227118"><span class="hs-identifier hs-var">x1high</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227119"><span class="hs-identifier hs-var">x2low</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227120"><span class="hs-identifier hs-var">x2high</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227121"><span class="hs-identifier hs-var">x1low</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>            </span><span id="local-6989586621679227130"><span class="annot"><span class="annottext">splitBits :: b -&gt; (b, b)
</span><a href="#local-6989586621679227130"><span class="hs-identifier hs-var hs-var">splitBits</span></a></span></span><span> </span><span id="local-6989586621679227131"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679227131"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679227131"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679227134"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679227131"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679227134"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679227134"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621679227134"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Int -&gt; b
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span>
</span><span id="line-107"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679227118"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227118"><span class="hs-identifier hs-var">x1high</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227121"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227121"><span class="hs-identifier hs-var">x1low</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word64, Word64)
forall {b}. (Bits b, Num b) =&gt; b -&gt; (b, b)
</span><a href="#local-6989586621679227130"><span class="hs-identifier hs-var">splitBits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227114"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679227120"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227120"><span class="hs-identifier hs-var">x2high</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227119"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227119"><span class="hs-identifier hs-var">x2low</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word64, Word64)
forall {b}. (Bits b, Num b) =&gt; b -&gt; (b, b)
</span><a href="#local-6989586621679227130"><span class="hs-identifier hs-var">splitBits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227115"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227116"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Camellia context</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="Camellia"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-var">Camellia</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Camellia"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-var">Camellia</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="k"><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#k"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Internal.WordArray.html#Array64"><span class="hs-identifier hs-type">Array64</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kw"><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#kw"><span class="hs-identifier hs-var hs-var">kw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Internal.WordArray.html#Array64"><span class="hs-identifier hs-type">Array64</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="ke"><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#ke"><span class="hs-identifier hs-var hs-var">ke</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Internal.WordArray.html#Array64"><span class="hs-identifier hs-type">Array64</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679226938"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#setKeyInterim"><span class="hs-identifier hs-type">setKeyInterim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679226938"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226938"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-118"></span><span id="setKeyInterim"><span class="annot"><span class="annottext">setKeyInterim :: forall key.
ByteArrayAccess key =&gt;
key -&gt; (Word128, Word128, Word128, Word128)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#setKeyInterim"><span class="hs-identifier hs-var hs-var">setKeyInterim</span></a></span></span><span> </span><span id="local-6989586621679227153"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227153"><span class="hs-identifier hs-var">keyseed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var">w64tow128</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var">kL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var">w64tow128</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var">kR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var">w64tow128</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227156"><span class="hs-identifier hs-var">kA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var">w64tow128</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227157"><span class="hs-identifier hs-var">kB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679227154"><span class="annot"><span class="annottext">kL :: (Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var hs-var">kL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BE Word64 -&gt; Word64
forall a. ByteSwap a =&gt; BE a -&gt; a
</span><span class="hs-identifier hs-var">fromBE</span></span><span> </span><span class="annot"><span class="annottext">(BE Word64 -&gt; Word64) -&gt; BE Word64 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">key -&gt; Int -&gt; BE Word64
forall bs. ByteArrayAccess bs =&gt; bs -&gt; Int -&gt; BE Word64
</span><span class="hs-identifier hs-var">B.toW64BE</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227153"><span class="hs-identifier hs-var">keyseed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BE Word64 -&gt; Word64
forall a. ByteSwap a =&gt; BE a -&gt; a
</span><span class="hs-identifier hs-var">fromBE</span></span><span> </span><span class="annot"><span class="annottext">(BE Word64 -&gt; Word64) -&gt; BE Word64 -&gt; Word64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">key -&gt; Int -&gt; BE Word64
forall bs. ByteArrayAccess bs =&gt; bs -&gt; Int -&gt; BE Word64
</span><span class="hs-identifier hs-var">B.toW64BE</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227153"><span class="hs-identifier hs-var">keyseed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span id="local-6989586621679227155"><span class="annot"><span class="annottext">kR :: (Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var hs-var">kR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621679227156"><span class="annot"><span class="annottext">kA :: (Word64, Word64)
</span><a href="#local-6989586621679227156"><span class="hs-identifier hs-var hs-var">kA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227168"><span class="annot"><span class="annottext">d1 :: Word64
</span><a href="#local-6989586621679227168"><span class="hs-identifier hs-var hs-var">d1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var">kR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>                 </span><span id="local-6989586621679227172"><span class="annot"><span class="annottext">d2 :: Word64
</span><a href="#local-6989586621679227172"><span class="hs-identifier hs-var hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var">kR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                 </span><span id="local-6989586621679227175"><span class="annot"><span class="annottext">d3 :: Word64
</span><a href="#local-6989586621679227175"><span class="hs-identifier hs-var hs-var">d3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227172"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227168"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma1"><span class="hs-identifier hs-var">sigma1</span></a></span><span>
</span><span id="line-125"></span><span>                 </span><span id="local-6989586621679227178"><span class="annot"><span class="annottext">d4 :: Word64
</span><a href="#local-6989586621679227178"><span class="hs-identifier hs-var hs-var">d4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227168"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227175"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma2"><span class="hs-identifier hs-var">sigma2</span></a></span><span>
</span><span id="line-126"></span><span>                 </span><span id="local-6989586621679227180"><span class="annot"><span class="annottext">d5 :: Word64
</span><a href="#local-6989586621679227180"><span class="hs-identifier hs-var hs-var">d5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227178"><span class="hs-identifier hs-var">d4</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var">kL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                 </span><span id="local-6989586621679227182"><span class="annot"><span class="annottext">d6 :: Word64
</span><a href="#local-6989586621679227182"><span class="hs-identifier hs-var hs-var">d6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227175"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227154"><span class="hs-identifier hs-var">kL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>                 </span><span id="local-6989586621679227184"><span class="annot"><span class="annottext">d7 :: Word64
</span><a href="#local-6989586621679227184"><span class="hs-identifier hs-var hs-var">d7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227182"><span class="hs-identifier hs-var">d6</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227180"><span class="hs-identifier hs-var">d5</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma3"><span class="hs-identifier hs-var">sigma3</span></a></span><span>
</span><span id="line-129"></span><span>                 </span><span id="local-6989586621679227186"><span class="annot"><span class="annottext">d8 :: Word64
</span><a href="#local-6989586621679227186"><span class="hs-identifier hs-var hs-var">d8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227180"><span class="hs-identifier hs-var">d5</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227184"><span class="hs-identifier hs-var">d7</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma4"><span class="hs-identifier hs-var">sigma4</span></a></span><span>
</span><span id="line-130"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227186"><span class="hs-identifier hs-var">d8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227184"><span class="hs-identifier hs-var">d7</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>        </span><span id="local-6989586621679227157"><span class="annot"><span class="annottext">kB :: (Word64, Word64)
</span><a href="#local-6989586621679227157"><span class="hs-identifier hs-var hs-var">kB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227188"><span class="annot"><span class="annottext">d1 :: Word64
</span><a href="#local-6989586621679227188"><span class="hs-identifier hs-var hs-var">d1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227156"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var">kR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                 </span><span id="local-6989586621679227190"><span class="annot"><span class="annottext">d2 :: Word64
</span><a href="#local-6989586621679227190"><span class="hs-identifier hs-var hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227156"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word64
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64)
</span><a href="#local-6989586621679227155"><span class="hs-identifier hs-var">kR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                 </span><span id="local-6989586621679227192"><span class="annot"><span class="annottext">d3 :: Word64
</span><a href="#local-6989586621679227192"><span class="hs-identifier hs-var hs-var">d3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227190"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227188"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma5"><span class="hs-identifier hs-var">sigma5</span></a></span><span>
</span><span id="line-135"></span><span>                 </span><span id="local-6989586621679227194"><span class="annot"><span class="annottext">d4 :: Word64
</span><a href="#local-6989586621679227194"><span class="hs-identifier hs-var hs-var">d4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227188"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227192"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sigma6"><span class="hs-identifier hs-var">sigma6</span></a></span><span>
</span><span id="line-136"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227194"><span class="hs-identifier hs-var">d4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227192"><span class="hs-identifier hs-var">d3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Initialize a 128-bit key</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- Return the initialized key or a error message if the given </span><span>
</span><span id="line-141"></span><span class="hs-comment">-- keyseed was not 16-bytes in length.</span><span>
</span><span id="line-142"></span><span id="local-6989586621679226952"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#initCamellia"><span class="hs-identifier hs-type">initCamellia</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679226952"><span class="hs-identifier hs-type">key</span></a></span><span>
</span><span id="line-143"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226952"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The key to create the camellia context</span></span><span>
</span><span id="line-144"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Error.Types.html#CryptoFailable"><span class="hs-identifier hs-type">CryptoFailable</span></a></span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span></span><span>
</span><span id="line-145"></span><span id="initCamellia"><span class="annot"><span class="annottext">initCamellia :: forall key. ByteArray key =&gt; key -&gt; CryptoFailable Camellia
</span><a href="Crypto.Cipher.Camellia.Primitive.html#initCamellia"><span class="hs-identifier hs-var hs-var">initCamellia</span></a></span></span><span> </span><span id="local-6989586621679227201"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227201"><span class="hs-identifier hs-var">key</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">key -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227201"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoError -&gt; CryptoFailable Camellia
forall a. CryptoError -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoFailed"><span class="hs-identifier hs-var">CryptoFailed</span></a></span><span> </span><span class="annot"><span class="annottext">(CryptoError -&gt; CryptoFailable Camellia)
-&gt; CryptoError -&gt; CryptoFailable Camellia
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="Crypto.Error.Types.html#CryptoError_KeySizeInvalid"><span class="hs-identifier hs-var">CryptoError_KeySizeInvalid</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227207"><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word128
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227208"><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word128
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; (Word128, Word128, Word128, Word128)
forall key.
ByteArrayAccess key =&gt;
key -&gt; (Word128, Word128, Word128, Word128)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#setKeyInterim"><span class="hs-identifier hs-var">setKeyInterim</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679227201"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227209"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227209"><span class="hs-identifier hs-var">kw1</span></a></span></span><span> </span><span id="local-6989586621679227210"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227210"><span class="hs-identifier hs-var">kw2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227211"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227211"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621679227212"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227212"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227213"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227213"><span class="hs-identifier hs-var">k3</span></a></span></span><span> </span><span id="local-6989586621679227214"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227214"><span class="hs-identifier hs-var">k4</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227215"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227215"><span class="hs-identifier hs-var">k5</span></a></span></span><span> </span><span id="local-6989586621679227216"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227216"><span class="hs-identifier hs-var">k6</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227217"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227217"><span class="hs-identifier hs-var">ke1</span></a></span></span><span> </span><span id="local-6989586621679227218"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227218"><span class="hs-identifier hs-var">ke2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">--ke1 = (KA &lt;&lt;&lt;  30) &gt;&gt; 64; ke2 = (KA &lt;&lt;&lt;  30) &amp; MASK64;</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227219"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227219"><span class="hs-identifier hs-var">k7</span></a></span></span><span> </span><span id="local-6989586621679227220"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227220"><span class="hs-identifier hs-var">k8</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">45</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">--k7  = (KL &lt;&lt;&lt;  45) &gt;&gt; 64; k8  = (KL &lt;&lt;&lt;  45) &amp; MASK64;</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227221"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227221"><span class="hs-identifier hs-var">k9</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">45</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">--k9  = (KA &lt;&lt;&lt;  45) &gt;&gt; 64;</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679227222"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227222"><span class="hs-identifier hs-var">k10</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227223"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227223"><span class="hs-identifier hs-var">k11</span></a></span></span><span> </span><span id="local-6989586621679227224"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227224"><span class="hs-identifier hs-var">k12</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227225"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227225"><span class="hs-identifier hs-var">ke3</span></a></span></span><span> </span><span id="local-6989586621679227226"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227226"><span class="hs-identifier hs-var">ke4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">77</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227227"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227227"><span class="hs-identifier hs-var">k13</span></a></span></span><span> </span><span id="local-6989586621679227228"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227228"><span class="hs-identifier hs-var">k14</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">94</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227229"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227229"><span class="hs-identifier hs-var">k15</span></a></span></span><span> </span><span id="local-6989586621679227230"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227230"><span class="hs-identifier hs-var">k16</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">94</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227231"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227231"><span class="hs-identifier hs-var">k17</span></a></span></span><span> </span><span id="local-6989586621679227232"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227232"><span class="hs-identifier hs-var">k18</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227207"><span class="hs-identifier hs-var">kL</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">111</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227233"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227233"><span class="hs-identifier hs-var">kw3</span></a></span></span><span> </span><span id="local-6989586621679227234"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227234"><span class="hs-identifier hs-var">kw4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word128
</span><a href="#local-6989586621679227208"><span class="hs-identifier hs-var">kA</span></a></span><span> </span><span class="annot"><span class="annottext">Word128 -&gt; Int -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#rotl128"><span class="hs-operator hs-var">`rotl128`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">111</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">Camellia -&gt; CryptoFailable Camellia
forall a. a -&gt; CryptoFailable a
</span><a href="Crypto.Error.Types.html#CryptoPassed"><span class="hs-identifier hs-var">CryptoPassed</span></a></span><span> </span><span class="annot"><span class="annottext">(Camellia -&gt; CryptoFailable Camellia)
-&gt; Camellia -&gt; CryptoFailable Camellia
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kw :: Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#kw"><span class="hs-identifier hs-var">kw</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word64] -&gt; Array64
</span><a href="Crypto.Internal.WordArray.html#array64"><span class="hs-identifier hs-var">array64</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227209"><span class="hs-identifier hs-var">kw1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227210"><span class="hs-identifier hs-var">kw2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227233"><span class="hs-identifier hs-var">kw3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227234"><span class="hs-identifier hs-var">kw4</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ke :: Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#ke"><span class="hs-identifier hs-var">ke</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word64] -&gt; Array64
</span><a href="Crypto.Internal.WordArray.html#array64"><span class="hs-identifier hs-var">array64</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227217"><span class="hs-identifier hs-var">ke1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227218"><span class="hs-identifier hs-var">ke2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227225"><span class="hs-identifier hs-var">ke3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227226"><span class="hs-identifier hs-var">ke4</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">k :: Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#k"><span class="hs-identifier hs-var">k</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word64] -&gt; Array64
</span><a href="Crypto.Internal.WordArray.html#array64"><span class="hs-identifier hs-var">array64</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">18</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227211"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227212"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227213"><span class="hs-identifier hs-var">k3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227214"><span class="hs-identifier hs-var">k4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227215"><span class="hs-identifier hs-var">k5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227216"><span class="hs-identifier hs-var">k6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227219"><span class="hs-identifier hs-var">k7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227220"><span class="hs-identifier hs-var">k8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227221"><span class="hs-identifier hs-var">k9</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227222"><span class="hs-identifier hs-var">k10</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227223"><span class="hs-identifier hs-var">k11</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227224"><span class="hs-identifier hs-var">k12</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227227"><span class="hs-identifier hs-var">k13</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227228"><span class="hs-identifier hs-var">k14</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227229"><span class="hs-identifier hs-var">k15</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227230"><span class="hs-identifier hs-var">k16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227231"><span class="hs-identifier hs-var">k17</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227232"><span class="hs-identifier hs-var">k18</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-type">feistel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-172"></span><span id="feistel"><span class="annot"><span class="annottext">feistel :: Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var hs-var">feistel</span></a></span></span><span> </span><span id="local-6989586621679227237"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227237"><span class="hs-identifier hs-var">fin</span></a></span></span><span> </span><span id="local-6989586621679227238"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227238"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227240"><span class="annot"><span class="annottext">x :: Word64
</span><a href="#local-6989586621679227240"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227237"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227238"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227241"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227241"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227242"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227242"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227243"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227243"><span class="hs-identifier hs-var">t3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227244"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227244"><span class="hs-identifier hs-var">t4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227245"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227245"><span class="hs-identifier hs-var">t5</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227246"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227246"><span class="hs-identifier hs-var">t6</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227247"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227247"><span class="hs-identifier hs-var">t7</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227248"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227248"><span class="hs-identifier hs-var">t8</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word8, Word8, Word8, Word8, Word8, Word8, Word8, Word8)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow8"><span class="hs-identifier hs-var">w64tow8</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227240"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227249"><span class="annot"><span class="annottext">t1' :: Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var">sbox1</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227241"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227250"><span class="annot"><span class="annottext">t2' :: Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var hs-var">t2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox2"><span class="hs-identifier hs-var">sbox2</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227242"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227251"><span class="annot"><span class="annottext">t3' :: Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var hs-var">t3'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox3"><span class="hs-identifier hs-var">sbox3</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227243"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227252"><span class="annot"><span class="annottext">t4' :: Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var hs-var">t4'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox4"><span class="hs-identifier hs-var">sbox4</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227244"><span class="hs-identifier hs-var">t4</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227253"><span class="annot"><span class="annottext">t5' :: Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var hs-var">t5'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox2"><span class="hs-identifier hs-var">sbox2</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227245"><span class="hs-identifier hs-var">t5</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227254"><span class="annot"><span class="annottext">t6' :: Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var hs-var">t6'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox3"><span class="hs-identifier hs-var">sbox3</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227246"><span class="hs-identifier hs-var">t6</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227255"><span class="annot"><span class="annottext">t7' :: Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var hs-var">t7'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox4"><span class="hs-identifier hs-var">sbox4</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227247"><span class="hs-identifier hs-var">t7</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227256"><span class="annot"><span class="annottext">t8' :: Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var hs-var">t8'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="Crypto.Cipher.Camellia.Primitive.html#sbox1"><span class="hs-identifier hs-var">sbox1</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227248"><span class="hs-identifier hs-var">t8</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227262"><span class="annot"><span class="annottext">y1 :: Word8
</span><a href="#local-6989586621679227262"><span class="hs-identifier hs-var hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var">t3'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var">t4'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227268"><span class="annot"><span class="annottext">y2 :: Word8
</span><a href="#local-6989586621679227268"><span class="hs-identifier hs-var hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var">t2'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var">t4'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227274"><span class="annot"><span class="annottext">y3 :: Word8
</span><a href="#local-6989586621679227274"><span class="hs-identifier hs-var hs-var">y3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var">t2'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var">t3'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227280"><span class="annot"><span class="annottext">y4 :: Word8
</span><a href="#local-6989586621679227280"><span class="hs-identifier hs-var hs-var">y4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var">t2'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var">t3'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var">t4'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227285"><span class="annot"><span class="annottext">y5 :: Word8
</span><a href="#local-6989586621679227285"><span class="hs-identifier hs-var hs-var">y5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var">t2'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227290"><span class="annot"><span class="annottext">y6 :: Word8
</span><a href="#local-6989586621679227290"><span class="hs-identifier hs-var hs-var">y6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227250"><span class="hs-identifier hs-var">t2'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var">t3'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227295"><span class="annot"><span class="annottext">y7 :: Word8
</span><a href="#local-6989586621679227295"><span class="hs-identifier hs-var hs-var">y7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227251"><span class="hs-identifier hs-var">t3'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var">t4'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227256"><span class="hs-identifier hs-var">t8'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227300"><span class="annot"><span class="annottext">y8 :: Word8
</span><a href="#local-6989586621679227300"><span class="hs-identifier hs-var hs-var">y8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227249"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227252"><span class="hs-identifier hs-var">t4'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227253"><span class="hs-identifier hs-var">t5'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227254"><span class="hs-identifier hs-var">t6'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227255"><span class="hs-identifier hs-var">t7'</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">(Word8, Word8, Word8, Word8, Word8, Word8, Word8, Word8) -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w8tow64"><span class="hs-identifier hs-var">w8tow64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227262"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227268"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227274"><span class="hs-identifier hs-var">y3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227280"><span class="hs-identifier hs-var">y4</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227285"><span class="hs-identifier hs-var">y5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227290"><span class="hs-identifier hs-var">y6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227295"><span class="hs-identifier hs-var">y7</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679227300"><span class="hs-identifier hs-var">y8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#fl"><span class="hs-identifier hs-type">fl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-194"></span><span id="fl"><span class="annot"><span class="annottext">fl :: Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#fl"><span class="hs-identifier hs-var hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621679227302"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227302"><span class="hs-identifier hs-var">fin</span></a></span></span><span> </span><span id="local-6989586621679227303"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227303"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227304"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227304"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227305"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227305"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word32, Word32)
</span><a href="Crypto.Internal.Words.html#w64to32"><span class="hs-identifier hs-var">w64to32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227302"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227307"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227307"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227308"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227308"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word32, Word32)
</span><a href="Crypto.Internal.Words.html#w64to32"><span class="hs-identifier hs-var">w64to32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227303"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227313"><span class="annot"><span class="annottext">y2 :: Word32
</span><a href="#local-6989586621679227313"><span class="hs-identifier hs-var hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227305"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227304"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227307"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227316"><span class="annot"><span class="annottext">y1 :: Word32
</span><a href="#local-6989586621679227316"><span class="hs-identifier hs-var hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227304"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227313"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227308"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">(Word32, Word32) -&gt; Word64
</span><a href="Crypto.Internal.Words.html#w32to64"><span class="hs-identifier hs-var">w32to64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227316"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227313"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#flinv"><span class="hs-identifier hs-type">flinv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-202"></span><span id="flinv"><span class="annot"><span class="annottext">flinv :: Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#flinv"><span class="hs-identifier hs-var hs-var">flinv</span></a></span></span><span> </span><span id="local-6989586621679227319"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227319"><span class="hs-identifier hs-var">fin</span></a></span></span><span> </span><span id="local-6989586621679227320"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227320"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227321"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227321"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227322"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227322"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word32, Word32)
</span><a href="Crypto.Internal.Words.html#w64to32"><span class="hs-identifier hs-var">w64to32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227319"><span class="hs-identifier hs-var">fin</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227323"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227323"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227324"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227324"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word32, Word32)
</span><a href="Crypto.Internal.Words.html#w64to32"><span class="hs-identifier hs-var">w64to32</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227320"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227327"><span class="annot"><span class="annottext">x1 :: Word32
</span><a href="#local-6989586621679227327"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227321"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227322"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227324"><span class="hs-identifier hs-var">k2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227331"><span class="annot"><span class="annottext">x2 :: Word32
</span><a href="#local-6989586621679227331"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227322"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227327"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227323"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`rotateL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">(Word32, Word32) -&gt; Word64
</span><a href="Crypto.Internal.Words.html#w32to64"><span class="hs-identifier hs-var">w32to64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227327"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679227331"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">{- in decrypt mode 0-&gt;17 1-&gt;16 ... -}</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-type">getKeyK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-211"></span><span id="getKeyK"><span class="annot"><span class="annottext">getKeyK :: Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var hs-var">getKeyK</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Encrypt"><span class="hs-identifier hs-var">Encrypt</span></a></span><span> </span><span id="local-6989586621679227333"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227333"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227334"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227334"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#k"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227333"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227334"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Decrypt"><span class="hs-identifier hs-var">Decrypt</span></a></span><span> </span><span id="local-6989586621679227336"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227336"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227337"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227337"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#k"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227336"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227337"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">{- in decrypt mode 0-&gt;3 1-&gt;2 2-&gt;1 3-&gt;0 -}</span><span>
</span><span id="line-215"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-type">getKeyKe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-216"></span><span id="getKeyKe"><span class="annot"><span class="annottext">getKeyKe :: Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var hs-var">getKeyKe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Encrypt"><span class="hs-identifier hs-var">Encrypt</span></a></span><span> </span><span id="local-6989586621679227339"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227339"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227340"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227340"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#ke"><span class="hs-identifier hs-var">ke</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227339"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227340"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var">getKeyKe</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Decrypt"><span class="hs-identifier hs-var">Decrypt</span></a></span><span> </span><span id="local-6989586621679227341"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227341"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227342"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227342"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#ke"><span class="hs-identifier hs-var">ke</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227341"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227342"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">{- in decrypt mode 0-&gt;2 1-&gt;3 2-&gt;0 3-&gt;1 -}</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-type">getKeyKw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-221"></span><span id="getKeyKw"><span class="annot"><span class="annottext">getKeyKw :: Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var hs-var">getKeyKw</span></a></span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Encrypt"><span class="hs-identifier hs-var">Encrypt</span></a></span><span> </span><span id="local-6989586621679227344"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227344"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227345"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227345"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#kw"><span class="hs-identifier hs-var">kw</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227344"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227345"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var">getKeyKw</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Decrypt"><span class="hs-identifier hs-var">Decrypt</span></a></span><span> </span><span id="local-6989586621679227346"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227346"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227347"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227347"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Camellia -&gt; Array64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#kw"><span class="hs-identifier hs-var">kw</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227346"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array64 -&gt; Int -&gt; Word64
</span><a href="Crypto.Internal.WordArray.html#arrayRead64"><span class="hs-operator hs-var">`arrayRead64`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227347"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">{- perform the following
    D2 = D2 ^ F(D1, k1);     // Round 1
    D1 = D1 ^ F(D2, k2);     // Round 2
    D2 = D2 ^ F(D1, k3);     // Round 3
    D1 = D1 ^ F(D2, k4);     // Round 4
    D2 = D2 ^ F(D1, k5);     // Round 5
    D1 = D1 ^ F(D2, k6);     // Round 6
 -}</span><span>
</span><span id="line-232"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#doBlockRound"><span class="hs-identifier hs-type">doBlockRound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span id="doBlockRound"><span class="annot"><span class="annottext">doBlockRound :: Mode -&gt; Camellia -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; (Word64, Word64)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlockRound"><span class="hs-identifier hs-var hs-var">doBlockRound</span></a></span></span><span> </span><span id="local-6989586621679227351"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679227352"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679227353"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227353"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679227354"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227354"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621679227355"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227359"><span class="annot"><span class="annottext">r1 :: Word64
</span><a href="#local-6989586621679227359"><span class="hs-identifier hs-var hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227354"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227353"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 1+i -}</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227363"><span class="annot"><span class="annottext">r2 :: Word64
</span><a href="#local-6989586621679227363"><span class="hs-identifier hs-var hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227353"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227359"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 2+i -}</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227367"><span class="annot"><span class="annottext">r3 :: Word64
</span><a href="#local-6989586621679227367"><span class="hs-identifier hs-var hs-var">r3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227359"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227363"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 3+i -}</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227371"><span class="annot"><span class="annottext">r4 :: Word64
</span><a href="#local-6989586621679227371"><span class="hs-identifier hs-var hs-var">r4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227363"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227367"><span class="hs-identifier hs-var">r3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 4+i -}</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227375"><span class="annot"><span class="annottext">r5 :: Word64
</span><a href="#local-6989586621679227375"><span class="hs-identifier hs-var hs-var">r5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227367"><span class="hs-identifier hs-var">r3</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227371"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 5+i -}</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227379"><span class="annot"><span class="annottext">r6 :: Word64
</span><a href="#local-6989586621679227379"><span class="hs-identifier hs-var hs-var">r6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227371"><span class="hs-identifier hs-var">r4</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#feistel"><span class="hs-identifier hs-var">feistel</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227375"><span class="hs-identifier hs-var">r5</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyK"><span class="hs-identifier hs-var">getKeyK</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227351"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227352"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679227355"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>     </span><span class="hs-comment">{- Round 6+i -}</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227379"><span class="hs-identifier hs-var">r6</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227375"><span class="hs-identifier hs-var">r5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#doBlock"><span class="hs-identifier hs-type">doBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span>
</span><span id="line-243"></span><span id="doBlock"><span class="annot"><span class="annottext">doBlock :: Mode -&gt; Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlock"><span class="hs-identifier hs-var hs-var">doBlock</span></a></span></span><span> </span><span id="local-6989586621679227381"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679227382"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span id="local-6989586621679227383"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227383"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679227384"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227384"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227386"><span class="annot"><span class="annottext">d1a :: Word64
</span><a href="#local-6989586621679227386"><span class="hs-identifier hs-var hs-var">d1a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227383"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var">getKeyKw</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- Prewhitening -}</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227388"><span class="annot"><span class="annottext">d2a :: Word64
</span><a href="#local-6989586621679227388"><span class="hs-identifier hs-var hs-var">d2a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227384"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var">getKeyKw</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227389"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227389"><span class="hs-identifier hs-var">d1b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227390"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227390"><span class="hs-identifier hs-var">d2b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; (Word64, Word64)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlockRound"><span class="hs-identifier hs-var">doBlockRound</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227386"><span class="hs-identifier hs-var">d1a</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227388"><span class="hs-identifier hs-var">d2a</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227391"><span class="annot"><span class="annottext">d1c :: Word64
</span><a href="#local-6989586621679227391"><span class="hs-identifier hs-var hs-var">d1c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#fl"><span class="hs-identifier hs-var">fl</span></a></span><span>    </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227389"><span class="hs-identifier hs-var">d1b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var">getKeyKe</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- FL -}</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227392"><span class="annot"><span class="annottext">d2c :: Word64
</span><a href="#local-6989586621679227392"><span class="hs-identifier hs-var hs-var">d2c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#flinv"><span class="hs-identifier hs-var">flinv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227390"><span class="hs-identifier hs-var">d2b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var">getKeyKe</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- FLINV -}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227393"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227393"><span class="hs-identifier hs-var">d1d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227394"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227394"><span class="hs-identifier hs-var">d2d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; (Word64, Word64)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlockRound"><span class="hs-identifier hs-var">doBlockRound</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227391"><span class="hs-identifier hs-var">d1c</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227392"><span class="hs-identifier hs-var">d2c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227395"><span class="annot"><span class="annottext">d1e :: Word64
</span><a href="#local-6989586621679227395"><span class="hs-identifier hs-var hs-var">d1e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#fl"><span class="hs-identifier hs-var">fl</span></a></span><span>    </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227393"><span class="hs-identifier hs-var">d1d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var">getKeyKe</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- FL -}</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227396"><span class="annot"><span class="annottext">d2e :: Word64
</span><a href="#local-6989586621679227396"><span class="hs-identifier hs-var hs-var">d2e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#flinv"><span class="hs-identifier hs-var">flinv</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227394"><span class="hs-identifier hs-var">d2d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKe"><span class="hs-identifier hs-var">getKeyKe</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- FLINV -}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227397"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227397"><span class="hs-identifier hs-var">d1f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679227398"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227398"><span class="hs-identifier hs-var">d2f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Word64 -&gt; Word64 -&gt; Int -&gt; (Word64, Word64)
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlockRound"><span class="hs-identifier hs-var">doBlockRound</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227395"><span class="hs-identifier hs-var">d1e</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227396"><span class="hs-identifier hs-var">d2e</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227400"><span class="annot"><span class="annottext">d2g :: Word64
</span><a href="#local-6989586621679227400"><span class="hs-identifier hs-var hs-var">d2g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227398"><span class="hs-identifier hs-var">d2f</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var">getKeyKw</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">{- Postwhitening -}</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227402"><span class="annot"><span class="annottext">d1g :: Word64
</span><a href="#local-6989586621679227402"><span class="hs-identifier hs-var hs-var">d1g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227397"><span class="hs-identifier hs-var">d1f</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Int -&gt; Word64
</span><a href="Crypto.Cipher.Camellia.Primitive.html#getKeyKw"><span class="hs-identifier hs-var">getKeyKw</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679227381"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227382"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#w64tow128"><span class="hs-identifier hs-var">w64tow128</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227400"><span class="hs-identifier hs-var">d2g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679227402"><span class="hs-identifier hs-var">d1g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">{- encryption for 128 bits blocks -}</span><span>
</span><span id="line-264"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#encryptBlock"><span class="hs-identifier hs-type">encryptBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span>
</span><span id="line-265"></span><span id="encryptBlock"><span class="annot"><span class="annottext">encryptBlock :: Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#encryptBlock"><span class="hs-identifier hs-var hs-var">encryptBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlock"><span class="hs-identifier hs-var">doBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Encrypt"><span class="hs-identifier hs-var">Encrypt</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">{- decryption for 128 bits blocks -}</span><span>
</span><span id="line-268"></span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#decryptBlock"><span class="hs-identifier hs-type">decryptBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word128</span></span><span>
</span><span id="line-269"></span><span id="decryptBlock"><span class="annot"><span class="annottext">decryptBlock :: Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#decryptBlock"><span class="hs-identifier hs-var hs-var">decryptBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#doBlock"><span class="hs-identifier hs-var">doBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Crypto.Cipher.Camellia.Primitive.html#Decrypt"><span class="hs-identifier hs-var">Decrypt</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><span class="hs-comment">-- | Encrypts the given ByteString using the given Key</span></span><span>
</span><span id="line-272"></span><span id="local-6989586621679226963"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#encrypt"><span class="hs-identifier hs-type">encrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679226963"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The key to use</span></span><span>
</span><span id="line-274"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226963"><span class="hs-identifier hs-type">ba</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ The data to encrypt</span></span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226963"><span class="hs-identifier hs-type">ba</span></a></span></span><span>
</span><span id="line-276"></span><span id="encrypt"><span class="annot"><span class="annottext">encrypt :: forall ba. ByteArray ba =&gt; Camellia -&gt; ba -&gt; ba
</span><a href="Crypto.Cipher.Camellia.Primitive.html#encrypt"><span class="hs-identifier hs-var hs-var">encrypt</span></a></span></span><span> </span><span id="local-6989586621679227407"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227407"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word128 -&gt; Word128) -&gt; ba -&gt; ba
forall bs. ByteArray bs =&gt; (Word128 -&gt; Word128) -&gt; bs -&gt; bs
</span><span class="hs-identifier hs-var">B.mapAsWord128</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#encryptBlock"><span class="hs-identifier hs-var">encryptBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227407"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><span class="hs-comment">-- | Decrypts the given ByteString using the given Key</span></span><span>
</span><span id="line-279"></span><span id="local-6989586621679227409"><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#decrypt"><span class="hs-identifier hs-type">decrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArray</span></span><span> </span><span class="annot"><a href="#local-6989586621679227409"><span class="hs-identifier hs-type">ba</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Crypto.Cipher.Camellia.Primitive.html#Camellia"><span class="hs-identifier hs-type">Camellia</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The key to use</span></span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679227409"><span class="hs-identifier hs-type">ba</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ The data to decrypt</span></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679227409"><span class="hs-identifier hs-type">ba</span></a></span></span><span>
</span><span id="line-283"></span><span id="decrypt"><span class="annot"><span class="annottext">decrypt :: forall ba. ByteArray ba =&gt; Camellia -&gt; ba -&gt; ba
</span><a href="Crypto.Cipher.Camellia.Primitive.html#decrypt"><span class="hs-identifier hs-var hs-var">decrypt</span></a></span></span><span> </span><span id="local-6989586621679227412"><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227412"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word128 -&gt; Word128) -&gt; ba -&gt; ba
forall bs. ByteArray bs =&gt; (Word128 -&gt; Word128) -&gt; bs -&gt; bs
</span><span class="hs-identifier hs-var">B.mapAsWord128</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Camellia -&gt; Word128 -&gt; Word128
</span><a href="Crypto.Cipher.Camellia.Primitive.html#decryptBlock"><span class="hs-identifier hs-var">decryptBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Camellia
</span><a href="#local-6989586621679227412"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span></pre></body></html>