<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 800 &amp;&amp; __GLASGOW_HASKELL__ &gt;= 706
</span><span class="hs-comment">-- Work around a compiler bug</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -fsimpl-tick-factor=300 #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-comment">-- |</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Module:      Data.Aeson.Parser.Internal</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Copyright:   (c) 2011-2016 Bryan O'Sullivan</span><span>
</span><span id="line-12"></span><span class="hs-comment">--              (c) 2011 MailRank, Inc.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- License:     BSD3</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Maintainer:  Bryan O'Sullivan &lt;bos@serpentine.com&gt;</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Stability:   experimental</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Portability: portable</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Efficiently and correctly parse a JSON string.  The string must be</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- encoded as UTF-8.</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Aeson.Parser.Internal</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Lazy parsers</span></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#json"><span class="hs-identifier">json</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonEOF"><span class="hs-identifier">jsonEOF</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier">jsonWith</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonLast"><span class="hs-identifier">jsonLast</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonAccum"><span class="hs-identifier">jsonAccum</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonNoDup"><span class="hs-identifier">jsonNoDup</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#value"><span class="hs-identifier">value</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstring"><span class="hs-identifier">jstring</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier">jstring_</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-identifier">scientific</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Strict parsers</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#json%27"><span class="hs-identifier">json'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonEOF%27"><span class="hs-identifier">jsonEOF'</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier">jsonWith'</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonLast%27"><span class="hs-identifier">jsonLast'</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonAccum%27"><span class="hs-identifier">jsonAccum'</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonNoDup%27"><span class="hs-identifier">jsonNoDup'</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#value%27"><span class="hs-identifier">value'</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeWith"><span class="hs-identifier">decodeWith</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeStrictWith"><span class="hs-identifier">decodeStrictWith</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeWith"><span class="hs-identifier">eitherDecodeWith</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeStrictWith"><span class="hs-identifier">eitherDecodeStrictWith</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Handling objects with duplicate keys</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#fromListAccum"><span class="hs-identifier">fromListAccum</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#parseListNoDup"><span class="hs-identifier">parseListNoDup</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Text literal unescaping</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.UnescapePure.html#unescapeText"><span class="hs-identifier">unescapeText</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude.Compat</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html"><span class="hs-identifier">Data.Aeson.Types.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#IResult"><span class="hs-identifier">IResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#JSONPath"><span class="hs-identifier">JSONPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier">Object</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Result"><span class="hs-identifier">Result</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Aeson.KeyMap.html"><span class="hs-identifier">Data.Aeson.KeyMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">KM</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Parser</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decimal</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">endOfInput</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isDigit_w8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">signed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">string</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fix</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Scientific</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Scientific</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromListN</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reverse</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Unsafe</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Builder</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Scientific</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Sci</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Unescape.html"><span class="hs-identifier">Data.Aeson.Parser.Unescape</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Parser.UnescapePure.html#unescapeText"><span class="hs-identifier">unescapeText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Internal.Integer.html"><span class="hs-identifier">Data.Aeson.Internal.Integer</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Internal.Text.html"><span class="hs-identifier">Data.Aeson.Internal.Text</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Aeson.Internal.Word8.html"><span class="hs-identifier">Data.Aeson.Internal.Word8</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Aeson.Types</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Parsers</span><span>
</span><span id="line-86"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Parse any JSON value.</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The conversion of a parsed value to a Haskell value is deferred</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- until the Haskell value is needed.  This may improve performance if</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- only a subset of the results of conversions are needed, but at a</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- cost in thunk allocation.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- This function is an alias for 'value'. In aeson 0.8 and earlier, it</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- parsed only object or array types, in conformance with the</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- now-obsolete RFC 4627.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- ==== Warning</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- If an object contains duplicate keys, only the first one will be kept.</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- For a more flexible alternative, see 'jsonWith'.</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#json"><span class="hs-identifier hs-type">json</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-104"></span><span id="json"><span class="annot"><span class="annottext">json :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#json"><span class="hs-identifier hs-var hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#value"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Parse any JSON value.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- This is a strict version of 'json' which avoids building up thunks</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- during parsing; it performs all conversions immediately.  Prefer</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- this version if most of the JSON data needs to be accessed.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- This function is an alias for 'value''. In aeson 0.8 and earlier, it</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- parsed only object or array types, in conformance with the</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- now-obsolete RFC 4627.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- ==== Warning</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- If an object contains duplicate keys, only the first one will be kept.</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- For a more flexible alternative, see 'jsonWith''.</span><span>
</span><span id="line-120"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#json%27"><span class="hs-identifier hs-type">json'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-121"></span><span id="json%27"><span class="annot"><span class="annottext">json' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#json%27"><span class="hs-identifier hs-var hs-var">json'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#value%27"><span class="hs-identifier hs-var">value'</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- Open recursion: object_, object_', array_, array_' are parameterized by the</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- toplevel Value parser to be called recursively, to keep the parameter</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- mkObject outside of the recursive loop for proper inlining.</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#object_"><span class="hs-identifier hs-type">object_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-128"></span><span id="object_"><span class="annot"><span class="annottext">object_ :: ([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#object_"><span class="hs-identifier hs-var hs-var">object_</span></a></span></span><span> </span><span id="local-6989586621679184900"><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184900"><span class="hs-identifier hs-var">mkObject</span></a></span></span><span> </span><span id="local-6989586621679184901"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184901"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-var">Object</span></a></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Value) -&gt; Parser ByteString Object -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Key -&gt; Parser Value -&gt; Parser ByteString Object
</span><a href="Data.Aeson.Parser.Internal.html#objectValues"><span class="hs-identifier hs-var">objectValues</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184900"><span class="hs-identifier hs-var">mkObject</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Key
</span><a href="Data.Aeson.Parser.Internal.html#key"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184901"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-129"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#object_"><span class="hs-pragma hs-type">object_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#object_%27"><span class="hs-identifier hs-type">object_'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-132"></span><span id="object_%27"><span class="annot"><span class="annottext">object_' :: ([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#object_%27"><span class="hs-identifier hs-var hs-var">object_'</span></a></span></span><span> </span><span id="local-6989586621679184907"><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184907"><span class="hs-identifier hs-var">mkObject</span></a></span></span><span> </span><span id="local-6989586621679184908"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184908"><span class="hs-identifier hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">!</span><span id="local-6989586621679184909"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679184909"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Key -&gt; Parser Value -&gt; Parser ByteString Object
</span><a href="Data.Aeson.Parser.Internal.html#objectValues"><span class="hs-identifier hs-var">objectValues</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184907"><span class="hs-identifier hs-var">mkObject</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Key
</span><a href="#local-6989586621679184910"><span class="hs-identifier hs-var">key'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184908"><span class="hs-identifier hs-var">val'</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="annottext">Value -&gt; Parser Value
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-var">Object</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679184909"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679184910"><span class="annot"><span class="annottext">key' :: Parser Key
</span><a href="#local-6989586621679184910"><span class="hs-identifier hs-var hs-var">key'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679184913"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679184913"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Key
</span><a href="Data.Aeson.Parser.Internal.html#key"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">Key -&gt; Parser Key
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679184913"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-139"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#object_%27"><span class="hs-pragma hs-type">object_'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#objectValues"><span class="hs-identifier hs-type">objectValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.KeyMap.html#KeyMap"><span class="hs-identifier hs-type">KM.KeyMap</span></a></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="objectValues"><span class="annot"><span class="annottext">objectValues :: ([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Key -&gt; Parser Value -&gt; Parser ByteString Object
</span><a href="Data.Aeson.Parser.Internal.html#objectValues"><span class="hs-identifier hs-var hs-var">objectValues</span></a></span></span><span> </span><span id="local-6989586621679184914"><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184914"><span class="hs-identifier hs-var">mkObject</span></a></span></span><span> </span><span id="local-6989586621679184915"><span class="annot"><span class="annottext">Parser Key
</span><a href="#local-6989586621679184915"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679184916"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184916"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679184918"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184918"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.peekWord8'</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184918"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_CLOSE_CURLY"><span class="hs-identifier hs-var">W8_CLOSE_CURLY</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8
-&gt; Parser ByteString Object -&gt; Parser ByteString Object
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser ByteString Object
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Object
forall v. KeyMap v
</span><a href="Data.Aeson.KeyMap.html#empty"><span class="hs-identifier hs-var">KM.empty</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Parser ByteString Object
</span><a href="#local-6989586621679184923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- Why use acc pattern here, you may ask? because then the underlying 'KM.fromList'</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- implementation can make use of mutation when constructing a map. For example,</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- 'HashMap` uses 'unsafeInsert' and it's much faster because it's doing in place</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- update to the 'HashMap'!</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679184923"><span class="annot"><span class="annottext">loop :: [(Key, Value)] -&gt; Parser ByteString Object
</span><a href="#local-6989586621679184923"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679184936"><span class="annot"><span class="annottext">[(Key, Value)]
</span><a href="#local-6989586621679184936"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679184937"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679184937"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Key
</span><a href="#local-6989586621679184915"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Key -&gt; String -&gt; Parser Key
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;object key&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Key -&gt; Parser () -&gt; Parser Key
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Key -&gt; Parser ByteString Char -&gt; Parser Key
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser ByteString Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Char -&gt; String -&gt; Parser ByteString Char
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;':'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679184940"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679184940"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184916"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; String -&gt; Parser Value
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;object value&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679184941"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184941"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser Word8
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679184943"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184943"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184943"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_COMMA"><span class="hs-identifier hs-var">W8_COMMA</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184943"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_CLOSE_CURLY"><span class="hs-identifier hs-var">W8_CLOSE_CURLY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; String -&gt; Parser Word8
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;',' or '}'&quot;</span></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679184946"><span class="annot"><span class="annottext">acc' :: [(Key, Value)]
</span><a href="#local-6989586621679184946"><span class="hs-identifier hs-var hs-var">acc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679184937"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679184940"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Key, Value) -&gt; [(Key, Value)] -&gt; [(Key, Value)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)]
</span><a href="#local-6989586621679184936"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184941"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_COMMA"><span class="hs-identifier hs-var">W8_COMMA</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ByteString Object -&gt; Parser ByteString Object
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Parser ByteString Object
</span><a href="#local-6989586621679184923"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)]
</span><a href="#local-6989586621679184946"><span class="hs-identifier hs-var">acc'</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184914"><span class="hs-identifier hs-var">mkObject</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)]
</span><a href="#local-6989586621679184946"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679184947"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184947"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ByteString Object
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184947"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679184948"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679184948"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser ByteString Object
forall a. a -&gt; Parser ByteString a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679184948"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-164"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#objectValues"><span class="hs-pragma hs-type">objectValues</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#array_"><span class="hs-identifier hs-type">array_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-167"></span><span id="array_"><span class="annot"><span class="annottext">array_ :: Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#array_"><span class="hs-identifier hs-var hs-var">array_</span></a></span></span><span> </span><span id="local-6989586621679184950"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184950"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a></span><span> </span><span class="annot"><span class="annottext">(Array -&gt; Value) -&gt; Parser ByteString Array -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser ByteString Array
</span><a href="Data.Aeson.Parser.Internal.html#arrayValues"><span class="hs-identifier hs-var">arrayValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184950"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-168"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#array_"><span class="hs-pragma hs-type">array_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#array_%27"><span class="hs-identifier hs-type">array_'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-171"></span><span id="array_%27"><span class="annot"><span class="annottext">array_' :: Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#array_%27"><span class="hs-identifier hs-var hs-var">array_'</span></a></span></span><span> </span><span id="local-6989586621679184954"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184954"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">!</span><span id="local-6989586621679184955"><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679184955"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser ByteString Array
</span><a href="Data.Aeson.Parser.Internal.html#arrayValues"><span class="hs-identifier hs-var">arrayValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184954"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">Value -&gt; Parser Value
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a></span><span> </span><span class="annot"><span class="annottext">Array
</span><a href="#local-6989586621679184955"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#array_%27"><span class="hs-pragma hs-type">array_'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#arrayValues"><span class="hs-identifier hs-type">arrayValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="arrayValues"><span class="annot"><span class="annottext">arrayValues :: Parser Value -&gt; Parser ByteString Array
</span><a href="Data.Aeson.Parser.Internal.html#arrayValues"><span class="hs-identifier hs-var hs-var">arrayValues</span></a></span></span><span> </span><span id="local-6989586621679184956"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184956"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679184957"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184957"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.peekWord8'</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184957"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_CLOSE_SQUARE"><span class="hs-identifier hs-var">W8_CLOSE_SQUARE</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser ByteString Array -&gt; Parser ByteString Array
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Array -&gt; Parser ByteString Array
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Array
forall a. Vector a
</span><span class="hs-identifier hs-var">Vector.empty</span></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Int -&gt; Parser ByteString Array
</span><a href="#local-6989586621679184959"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679184959"><span class="annot"><span class="annottext">loop :: [Value] -&gt; Int -&gt; Parser ByteString Array
</span><a href="#local-6989586621679184959"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679184970"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679184970"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679184971"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679184971"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679184972"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679184972"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184956"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; String -&gt; Parser Value
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;json list value&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679184973"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184973"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser Word8
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679184974"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184974"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184974"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_COMMA"><span class="hs-identifier hs-var">W8_COMMA</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184974"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_CLOSE_SQUARE"><span class="hs-identifier hs-var">W8_CLOSE_SQUARE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; String -&gt; Parser Word8
forall i a. Parser i a -&gt; String -&gt; Parser i a
</span><span class="hs-operator hs-var">A.&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;',' or ']'&quot;</span></span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184973"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_COMMA"><span class="hs-identifier hs-var">W8_COMMA</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ByteString Array -&gt; Parser ByteString Array
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Int -&gt; Parser ByteString Array
</span><a href="#local-6989586621679184959"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679184972"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Value -&gt; [Value] -&gt; [Value]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679184970"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679184971"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Array -&gt; Parser ByteString Array
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array -&gt; Array
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Value] -&gt; Array
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.fromListN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679184971"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679184972"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Value -&gt; [Value] -&gt; [Value]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679184970"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#arrayValues"><span class="hs-pragma hs-type">arrayValues</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><span class="hs-comment">-- | Parse any JSON value. Synonym of 'json'.</span></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#value"><span class="hs-identifier hs-type">value</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-194"></span><span id="value"><span class="annot"><span class="annottext">value :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#value"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-var">jsonWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Object
forall v. [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromList"><span class="hs-identifier hs-var">KM.fromList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Parse any JSON value.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- This parser is parameterized by a function to construct an 'Object'</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- from a raw list of key-value pairs, where duplicates are preserved.</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- The pairs appear in __reverse order__ from the source.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- ==== __Examples__</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- 'json' keeps only the first occurrence of each key, using 'Data.Aeson.KeyMap.fromList'.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- 'json' = 'jsonWith' ('Right' '.' 'H.fromList')</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- 'jsonLast' keeps the last occurrence of each key, using</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- @'HashMap.Lazy.fromListWith' ('const' 'id')@.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- 'jsonLast' = 'jsonWith' ('Right' '.' 'HashMap.Lazy.fromListWith' ('const' 'id'))</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-216"></span><span class="hs-comment">--</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- 'jsonAccum' keeps wraps all values in arrays to keep duplicates, using</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- 'fromListAccum'.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- 'jsonAccum' = 'jsonWith' ('Right' . 'fromListAccum')</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- 'jsonNoDup' fails if any object contains duplicate keys, using 'parseListNoDup'.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- 'jsonNoDup' = 'jsonWith' 'parseListNoDup'</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-type">jsonWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-230"></span><span id="jsonWith"><span class="annot"><span class="annottext">jsonWith :: ([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-var hs-var">jsonWith</span></a></span></span><span> </span><span id="local-6989586621679184980"><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184980"><span class="hs-identifier hs-var">mkObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Parser Value -&gt; Parser Value) -&gt; Parser Value
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">((Parser Value -&gt; Parser Value) -&gt; Parser Value)
-&gt; (Parser Value -&gt; Parser Value) -&gt; Parser Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184981"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184981"><span class="hs-identifier hs-var">value_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679184982"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184982"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.peekWord8'</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184982"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser Value -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; Parser ByteString Text -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier hs-var">jstring_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_OPEN_CURLY"><span class="hs-identifier hs-var">W8_OPEN_CURLY</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser Value -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#object_"><span class="hs-identifier hs-var">object_</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679184980"><span class="hs-identifier hs-var">mkObject</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184981"><span class="hs-identifier hs-var">value_</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_OPEN_SQUARE"><span class="hs-identifier hs-var">W8_OPEN_SQUARE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser Value -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#array_"><span class="hs-identifier hs-var">array_</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679184981"><span class="hs-identifier hs-var">value_</span></a></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_f"><span class="hs-identifier hs-var">W8_f</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_t"><span class="hs-identifier hs-var">W8_t</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_n"><span class="hs-identifier hs-var">W8_n</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;null&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184982"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_0"><span class="hs-identifier hs-var">W8_0</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184982"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_9"><span class="hs-identifier hs-var">W8_9</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679184982"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_MINUS"><span class="hs-identifier hs-var">W8_MINUS</span></a></span><span>
</span><span id="line-241"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-var">Number</span></a></span><span> </span><span class="annot"><span class="annottext">(Scientific -&gt; Value)
-&gt; Parser ByteString Scientific -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Scientific
</span><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-identifier hs-var">scientific</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Value
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not a valid json value&quot;</span></span><span>
</span><span id="line-243"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-pragma hs-type">jsonWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | Variant of 'json' which keeps only the last occurrence of every key.</span></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonLast"><span class="hs-identifier hs-type">jsonLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-247"></span><span id="jsonLast"><span class="annot"><span class="annottext">jsonLast :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonLast"><span class="hs-identifier hs-var hs-var">jsonLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-var">jsonWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value -&gt; Value) -&gt; [(Key, Value)] -&gt; Object
forall v. (v -&gt; v -&gt; v) -&gt; [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromListWith"><span class="hs-identifier hs-var">KM.fromListWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Value -&gt; Value -&gt; Value
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Variant of 'json' wrapping all object mappings in 'Array' to preserve</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- key-value pairs with the same keys.</span><span>
</span><span id="line-251"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonAccum"><span class="hs-identifier hs-type">jsonAccum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-252"></span><span id="jsonAccum"><span class="annot"><span class="annottext">jsonAccum :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonAccum"><span class="hs-identifier hs-var hs-var">jsonAccum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-var">jsonWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Object
</span><a href="Data.Aeson.Parser.Internal.html#fromListAccum"><span class="hs-identifier hs-var">fromListAccum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">-- | Variant of 'json' which fails if any object contains duplicate keys.</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonNoDup"><span class="hs-identifier hs-type">jsonNoDup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-256"></span><span id="jsonNoDup"><span class="annot"><span class="annottext">jsonNoDup :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonNoDup"><span class="hs-identifier hs-var hs-var">jsonNoDup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith"><span class="hs-identifier hs-var">jsonWith</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="Data.Aeson.Parser.Internal.html#parseListNoDup"><span class="hs-identifier hs-var">parseListNoDup</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | @'fromListAccum' kvs@ is an object mapping keys to arrays containing all</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- associated values from the original list @kvs@.</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- &gt;&gt;&gt; fromListAccum [(&quot;apple&quot;, Bool True), (&quot;apple&quot;, Bool False), (&quot;orange&quot;, Bool False)]</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- fromList [(&quot;apple&quot;,Array [Bool False,Bool True]),(&quot;orange&quot;,Array [Bool False])]</span><span>
</span><span id="line-263"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#fromListAccum"><span class="hs-identifier hs-type">fromListAccum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-264"></span><span id="fromListAccum"><span class="annot"><span class="annottext">fromListAccum :: [(Key, Value)] -&gt; Object
</span><a href="Data.Aeson.Parser.Internal.html#fromListAccum"><span class="hs-identifier hs-var hs-var">fromListAccum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">(([Value] -&gt; [Value]) -&gt; Value)
-&gt; KeyMap ([Value] -&gt; [Value]) -&gt; Object
forall a b. (a -&gt; b) -&gt; KeyMap a -&gt; KeyMap b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Array"><span class="hs-identifier hs-var">Array</span></a></span><span> </span><span class="annot"><span class="annottext">(Array -&gt; Value)
-&gt; (([Value] -&gt; [Value]) -&gt; Array) -&gt; ([Value] -&gt; [Value]) -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Array
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">Vector.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Array)
-&gt; (([Value] -&gt; [Value]) -&gt; [Value])
-&gt; ([Value] -&gt; [Value])
-&gt; Array
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Value] -&gt; [Value]) -&gt; [Value] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KeyMap ([Value] -&gt; [Value]) -&gt; Object)
-&gt; ([(Key, Value)] -&gt; KeyMap ([Value] -&gt; [Value]))
-&gt; [(Key, Value)]
-&gt; Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Value] -&gt; [Value])
 -&gt; ([Value] -&gt; [Value]) -&gt; [Value] -&gt; [Value])
-&gt; [(Key, [Value] -&gt; [Value])] -&gt; KeyMap ([Value] -&gt; [Value])
forall v. (v -&gt; v -&gt; v) -&gt; [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromListWith"><span class="hs-identifier hs-var">KM.fromListWith</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; [Value]) -&gt; ([Value] -&gt; [Value]) -&gt; [Value] -&gt; [Value]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">([(Key, [Value] -&gt; [Value])] -&gt; KeyMap ([Value] -&gt; [Value]))
-&gt; ([(Key, Value)] -&gt; [(Key, [Value] -&gt; [Value])])
-&gt; [(Key, Value)]
-&gt; KeyMap ([Value] -&gt; [Value])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Key, Value) -&gt; (Key, [Value] -&gt; [Value]))
-&gt; [(Key, Value)] -&gt; [(Key, [Value] -&gt; [Value])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Key, Value) -&gt; (Key, [Value] -&gt; [Value]))
 -&gt; [(Key, Value)] -&gt; [(Key, [Value] -&gt; [Value])])
-&gt; ((Value -&gt; [Value] -&gt; [Value])
    -&gt; (Key, Value) -&gt; (Key, [Value] -&gt; [Value]))
-&gt; (Value -&gt; [Value] -&gt; [Value])
-&gt; [(Key, Value)]
-&gt; [(Key, [Value] -&gt; [Value])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [Value] -&gt; [Value])
-&gt; (Key, Value) -&gt; (Key, [Value] -&gt; [Value])
forall a b. (a -&gt; b) -&gt; (Key, a) -&gt; (Key, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-comment">-- | @'fromListNoDup' kvs@ fails if @kvs@ contains duplicate keys.</span></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#parseListNoDup"><span class="hs-identifier hs-type">parseListNoDup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-269"></span><span id="parseListNoDup"><span class="annot"><span class="annottext">parseListNoDup :: [(Key, Value)] -&gt; Either String Object
</span><a href="Data.Aeson.Parser.Internal.html#parseListNoDup"><span class="hs-identifier hs-var hs-var">parseListNoDup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">(Key -&gt; Maybe Value -&gt; Either String Value)
-&gt; KeyMap (Maybe Value) -&gt; Either String Object
forall (f :: * -&gt; *) v1 v2.
Applicative f =&gt;
(Key -&gt; v1 -&gt; f v2) -&gt; KeyMap v1 -&gt; f (KeyMap v2)
</span><a href="Data.Aeson.KeyMap.html#traverseWithKey"><span class="hs-identifier hs-var">KM.traverseWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Maybe Value -&gt; Either String Value
forall {a} {b}. Show a =&gt; a -&gt; Maybe b -&gt; Either String b
</span><a href="#local-6989586621679185000"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyMap (Maybe Value) -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; KeyMap (Maybe Value))
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Maybe Value -&gt; Maybe Value)
-&gt; [(Key, Maybe Value)] -&gt; KeyMap (Maybe Value)
forall v. (v -&gt; v -&gt; v) -&gt; [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromListWith"><span class="hs-identifier hs-var">KM.fromListWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Key, Maybe Value)] -&gt; KeyMap (Maybe Value))
-&gt; ([(Key, Value)] -&gt; [(Key, Maybe Value)])
-&gt; [(Key, Value)]
-&gt; KeyMap (Maybe Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Key, Value) -&gt; (Key, Maybe Value))
-&gt; [(Key, Value)] -&gt; [(Key, Maybe Value)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Key, Value) -&gt; (Key, Maybe Value))
 -&gt; [(Key, Value)] -&gt; [(Key, Maybe Value)])
-&gt; ((Value -&gt; Maybe Value) -&gt; (Key, Value) -&gt; (Key, Maybe Value))
-&gt; (Value -&gt; Maybe Value)
-&gt; [(Key, Value)]
-&gt; [(Key, Maybe Value)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; (Key, Value) -&gt; (Key, Maybe Value)
forall a b. (a -&gt; b) -&gt; (Key, a) -&gt; (Key, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679185000"><span class="annot"><span class="annottext">unwrap :: a -&gt; Maybe b -&gt; Either String b
</span><a href="#local-6989586621679185000"><span class="hs-identifier hs-var hs-var">unwrap</span></a></span></span><span> </span><span id="local-6989586621679185006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185006"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String b) -&gt; String -&gt; Either String b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;found duplicate key: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185006"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="#local-6989586621679185000"><span class="hs-identifier hs-var">unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679185008"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679185008"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either String b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679185008"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Strict version of 'value'. Synonym of 'json''.</span></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#value%27"><span class="hs-identifier hs-type">value'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-278"></span><span id="value%27"><span class="annot"><span class="annottext">value' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#value%27"><span class="hs-identifier hs-var hs-var">value'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-var">jsonWith'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Object
forall v. [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromList"><span class="hs-identifier hs-var">KM.fromList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><span class="hs-comment">-- | Strict version of 'jsonWith'.</span></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-type">jsonWith'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-282"></span><span id="jsonWith%27"><span class="annot"><span class="annottext">jsonWith' :: ([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-var hs-var">jsonWith'</span></a></span></span><span> </span><span id="local-6989586621679185009"><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679185009"><span class="hs-identifier hs-var">mkObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Parser Value -&gt; Parser Value) -&gt; Parser Value
forall a. (a -&gt; a) -&gt; a
</span><span class="hs-identifier hs-var">fix</span></span><span> </span><span class="annot"><span class="annottext">((Parser Value -&gt; Parser Value) -&gt; Parser Value)
-&gt; (Parser Value -&gt; Parser Value) -&gt; Parser Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679185010"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185010"><span class="hs-identifier hs-var">value_</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679185011"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.peekWord8'</span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>                       </span><span class="hs-glyph">!</span><span id="local-6989586621679185012"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185012"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser ByteString Text -&gt; Parser ByteString Text
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier hs-var">jstring_</span></a></span><span>
</span><span id="line-288"></span><span>                       </span><span class="annot"><span class="annottext">Value -&gt; Parser Value
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185012"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_OPEN_CURLY"><span class="hs-identifier hs-var">W8_OPEN_CURLY</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser Value -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object)
-&gt; Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#object_%27"><span class="hs-identifier hs-var">object_'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="#local-6989586621679185009"><span class="hs-identifier hs-var">mkObject</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185010"><span class="hs-identifier hs-var">value_</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_OPEN_SQUARE"><span class="hs-identifier hs-var">W8_OPEN_SQUARE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser Value -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#array_%27"><span class="hs-identifier hs-var">array_'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185010"><span class="hs-identifier hs-var">value_</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_f"><span class="hs-identifier hs-var">W8_f</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_t"><span class="hs-identifier hs-var">W8_t</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_n"><span class="hs-identifier hs-var">W8_n</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;null&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Value -&gt; Parser Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">Null</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_0"><span class="hs-identifier hs-var">W8_0</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_9"><span class="hs-identifier hs-var">W8_9</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_MINUS"><span class="hs-identifier hs-var">W8_MINUS</span></a></span><span>
</span><span id="line-295"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>                       </span><span class="hs-glyph">!</span><span id="local-6989586621679185013"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679185013"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser ByteString Scientific
</span><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-identifier hs-var">scientific</span></a></span><span>
</span><span id="line-297"></span><span>                       </span><span class="annot"><span class="annottext">Value -&gt; Parser Value
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scientific -&gt; Value
</span><a href="Data.Aeson.Types.Internal.html#Number"><span class="hs-identifier hs-var">Number</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679185013"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Value
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not a valid json value&quot;</span></span><span>
</span><span id="line-299"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-pragma hs-type">jsonWith'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><span class="hs-comment">-- | Variant of 'json'' which keeps only the last occurrence of every key.</span></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonLast%27"><span class="hs-identifier hs-type">jsonLast'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-303"></span><span id="jsonLast%27"><span class="annot"><span class="annottext">jsonLast' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonLast%27"><span class="hs-identifier hs-var hs-var">jsonLast'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-var">jsonWith'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value -&gt; Value) -&gt; [(Key, Value)] -&gt; Object
forall v. (v -&gt; v -&gt; v) -&gt; [(Key, v)] -&gt; KeyMap v
</span><a href="Data.Aeson.KeyMap.html#fromListWith"><span class="hs-identifier hs-var">KM.fromListWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Value -&gt; Value -&gt; Value
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Variant of 'json'' wrapping all object mappings in 'Array' to preserve</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- key-value pairs with the same keys.</span><span>
</span><span id="line-307"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonAccum%27"><span class="hs-identifier hs-type">jsonAccum'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-308"></span><span id="jsonAccum%27"><span class="annot"><span class="annottext">jsonAccum' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonAccum%27"><span class="hs-identifier hs-var hs-var">jsonAccum'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-var">jsonWith'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Either String Object
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Either String Object)
-&gt; ([(Key, Value)] -&gt; Object)
-&gt; [(Key, Value)]
-&gt; Either String Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Object
</span><a href="Data.Aeson.Parser.Internal.html#fromListAccum"><span class="hs-identifier hs-var">fromListAccum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">-- | Variant of 'json'' which fails if any object contains duplicate keys.</span></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonNoDup%27"><span class="hs-identifier hs-type">jsonNoDup'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-312"></span><span id="jsonNoDup%27"><span class="annot"><span class="annottext">jsonNoDup' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonNoDup%27"><span class="hs-identifier hs-var hs-var">jsonNoDup'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Key, Value)] -&gt; Either String Object) -&gt; Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonWith%27"><span class="hs-identifier hs-var">jsonWith'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Key, Value)] -&gt; Either String Object
</span><a href="Data.Aeson.Parser.Internal.html#parseListNoDup"><span class="hs-identifier hs-var">parseListNoDup</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">-- | Parse a quoted JSON string.</span></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstring"><span class="hs-identifier hs-type">jstring</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-316"></span><span id="jstring"><span class="annot"><span class="annottext">jstring :: Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring"><span class="hs-identifier hs-var hs-var">jstring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Parser Word8
</span><span class="hs-identifier hs-var">A.word8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser ByteString Text -&gt; Parser ByteString Text
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier hs-var">jstring_</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><span class="hs-comment">-- | Parse a JSON Key</span></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#key"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-320"></span><span id="key"><span class="annot"><span class="annottext">key :: Parser Key
</span><a href="Data.Aeson.Parser.Internal.html#key"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="Data.Aeson.Key.html#fromText"><span class="hs-identifier hs-var">Key.fromText</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Key) -&gt; Parser ByteString Text -&gt; Parser Key
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring"><span class="hs-identifier hs-var">jstring</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><span class="hs-comment">-- | Parse a string without a leading quote.</span></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier hs-type">jstring_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-324"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-pragma hs-type">jstring_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-325"></span><span id="jstring_"><span class="annot"><span class="annottext">jstring_ :: Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstring_"><span class="hs-identifier hs-var hs-var">jstring_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679185016"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185016"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185018"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185018"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185018"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185018"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_BACKSLASH"><span class="hs-identifier hs-var">W8_BACKSLASH</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185018"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x20</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185018"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x80</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679185022"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679185022"><span class="hs-identifier hs-var">mw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Word8)
</span><span class="hs-identifier hs-var">A.peekWord8</span></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679185022"><span class="hs-identifier hs-var">mw</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier hs-var">Nothing</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ByteString Text
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;string without end&quot;</span></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Text -&gt; Parser ByteString Text
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Data.Aeson.Internal.Text.html#unsafeDecodeASCII"><span class="hs-identifier hs-var">unsafeDecodeASCII</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185016"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679185025"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185025"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185025"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x20</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ByteString Text
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unescaped control character&quot;</span></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstringSlow"><span class="hs-identifier hs-var">jstringSlow</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185016"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstringSlow"><span class="hs-identifier hs-type">jstringSlow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-335"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jstringSlow"><span class="hs-pragma hs-type">jstringSlow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-336"></span><span id="jstringSlow"><span class="annot"><span class="annottext">jstringSlow :: ByteString -&gt; Parser ByteString Text
</span><a href="Data.Aeson.Parser.Internal.html#jstringSlow"><span class="hs-identifier hs-var hs-var">jstringSlow</span></a></span></span><span> </span><span id="local-6989586621679185027"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185027"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679185028"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185028"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Bool -&gt; Word8 -&gt; Maybe Bool) -&gt; Parser ByteString
forall s. s -&gt; (s -&gt; Word8 -&gt; Maybe s) -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">A.scan</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185030"><span class="hs-identifier hs-var">startState</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word8 -&gt; Maybe Bool
</span><a href="#local-6989586621679185031"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ByteString -&gt; Parser Word8 -&gt; Parser ByteString
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><a href="Data.Aeson.Parser.UnescapePure.html#unescapeText"><span class="hs-identifier hs-var">unescapeText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.append</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185027"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185028"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679185033"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185033"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser ByteString Text
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679185033"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679185034"><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679185034"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ByteString Text
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser ByteString Text)
-&gt; String -&gt; Parser ByteString Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnicodeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679185034"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-341"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679185030"><span class="annot"><span class="annottext">startState :: Bool
</span><a href="#local-6989586621679185030"><span class="hs-identifier hs-var hs-var">startState</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621679185031"><span class="annot"><span class="annottext">go :: Bool -&gt; Word8 -&gt; Maybe Bool
</span><a href="#local-6989586621679185031"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679185036"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185036"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679185037"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185037"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-344"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185036"><span class="hs-identifier hs-var">a</span></a></span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185037"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOUBLE_QUOTE"><span class="hs-identifier hs-var">W8_DOUBLE_QUOTE</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185039"><span class="annot"><span class="annottext">a' :: Bool
</span><a href="#local-6989586621679185039"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185037"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_BACKSLASH"><span class="hs-identifier hs-var">W8_BACKSLASH</span></a></span><span>
</span><span id="line-347"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185039"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span id="local-6989586621679184671"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeWith"><span class="hs-identifier hs-type">decodeWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679184671"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-350"></span><span id="decodeWith"><span class="annot"><span class="annottext">decodeWith :: forall a.
Parser Value -&gt; (Value -&gt; Result a) -&gt; ByteString -&gt; Maybe a
</span><a href="Data.Aeson.Parser.Internal.html#decodeWith"><span class="hs-identifier hs-var hs-var">decodeWith</span></a></span></span><span> </span><span id="local-6989586621679185040"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185040"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679185041"><span class="annot"><span class="annottext">Value -&gt; Result a
</span><a href="#local-6989586621679185041"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679185042"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185042"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; ByteString -&gt; Result Value
forall a. Parser a -&gt; ByteString -&gt; Result a
</span><span class="hs-identifier hs-var">L.parse</span></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185040"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185042"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">L.Done</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679185045"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679185045"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result a
</span><a href="#local-6989586621679185041"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679185045"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>                      </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679185047"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185047"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185047"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-354"></span><span>                      </span><span class="annot"><span class="annottext">Result a
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">Result Value
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-356"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeWith"><span class="hs-pragma hs-type">decodeWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span id="local-6989586621679184677"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeStrictWith"><span class="hs-identifier hs-type">decodeStrictWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184677"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-359"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679184677"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-360"></span><span id="decodeStrictWith"><span class="annot"><span class="annottext">decodeStrictWith :: forall a.
Parser Value -&gt; (Value -&gt; Result a) -&gt; ByteString -&gt; Maybe a
</span><a href="Data.Aeson.Parser.Internal.html#decodeStrictWith"><span class="hs-identifier hs-var hs-var">decodeStrictWith</span></a></span></span><span> </span><span id="local-6989586621679185048"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185048"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679185049"><span class="annot"><span class="annottext">Value -&gt; Result a
</span><a href="#local-6989586621679185049"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679185050"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185050"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Result a)
-&gt; (Value -&gt; Result a) -&gt; Either String Value -&gt; Result a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Result a
forall a. String -&gt; Result a
</span><a href="Data.Aeson.Types.Internal.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result a
</span><a href="#local-6989586621679185049"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Value -&gt; ByteString -&gt; Either String Value
forall a. Parser a -&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">A.parseOnly</span></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185048"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185050"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679185054"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185054"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185054"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><span class="annottext">Result a
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-364"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decodeStrictWith"><span class="hs-pragma hs-type">decodeStrictWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span id="local-6989586621679184684"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeWith"><span class="hs-identifier hs-type">eitherDecodeWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#IResult"><span class="hs-identifier hs-type">IResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184684"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span>
</span><span id="line-367"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#JSONPath"><span class="hs-identifier hs-type">JSONPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184684"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-368"></span><span id="eitherDecodeWith"><span class="annot"><span class="annottext">eitherDecodeWith :: forall a.
Parser Value
-&gt; (Value -&gt; IResult a)
-&gt; ByteString
-&gt; Either (JSONPath, String) a
</span><a href="Data.Aeson.Parser.Internal.html#eitherDecodeWith"><span class="hs-identifier hs-var hs-var">eitherDecodeWith</span></a></span></span><span> </span><span id="local-6989586621679185057"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185057"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679185058"><span class="annot"><span class="annottext">Value -&gt; IResult a
</span><a href="#local-6989586621679185058"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679185059"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185059"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; ByteString -&gt; Result Value
forall a. Parser a -&gt; ByteString -&gt; Result a
</span><span class="hs-identifier hs-var">L.parse</span></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185057"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185059"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">L.Done</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679185060"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679185060"><span class="hs-identifier hs-var">v</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; IResult a
</span><a href="#local-6989586621679185058"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679185060"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-371"></span><span>                          </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#ISuccess"><span class="hs-identifier hs-type">ISuccess</span></a></span><span> </span><span id="local-6989586621679185062"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185062"><span class="hs-identifier hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either (JSONPath, String) a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185062"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-372"></span><span>                          </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#IError"><span class="hs-identifier hs-type">IError</span></a></span><span> </span><span id="local-6989586621679185064"><span class="annot"><span class="annottext">JSONPath
</span><a href="#local-6989586621679185064"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679185065"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185065"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(JSONPath, String) -&gt; Either (JSONPath, String) a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JSONPath
</span><a href="#local-6989586621679185064"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185065"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">L.Fail</span></span><span> </span><span id="local-6989586621679185067"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185067"><span class="hs-identifier hs-var">notparsed</span></a></span></span><span> </span><span id="local-6989586621679185068"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679185068"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679185069"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185069"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(JSONPath, String) -&gt; Either (JSONPath, String) a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [String] -&gt; String -&gt; String
</span><a href="#local-6989586621679185070"><span class="hs-identifier hs-var">buildMsg</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185067"><span class="hs-identifier hs-var">notparsed</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679185068"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185069"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621679185070"><span class="hs-identifier hs-type">buildMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679185070"><span class="annot"><span class="annottext">buildMsg :: ByteString -&gt; [String] -&gt; String -&gt; String
</span><a href="#local-6989586621679185070"><span class="hs-identifier hs-var hs-var">buildMsg</span></a></span></span><span> </span><span id="local-6989586621679185071"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185071"><span class="hs-identifier hs-var">notYetParsed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679185072"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185072"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185072"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="Data.Aeson.Parser.Internal.html#formatErrorLine"><span class="hs-identifier hs-var">formatErrorLine</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185071"><span class="hs-identifier hs-var">notYetParsed</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621679185070"><span class="hs-identifier hs-var">buildMsg</span></a></span><span> </span><span id="local-6989586621679185074"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185074"><span class="hs-identifier hs-var">notYetParsed</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185075"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185075"><span class="hs-identifier hs-var">expectation</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679185076"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185076"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185076"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. Expecting &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185075"><span class="hs-identifier hs-var">expectation</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="Data.Aeson.Parser.Internal.html#formatErrorLine"><span class="hs-identifier hs-var">formatErrorLine</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185074"><span class="hs-identifier hs-var">notYetParsed</span></a></span><span>
</span><span id="line-379"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeWith"><span class="hs-pragma hs-type">eitherDecodeWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Grab the first 100 bytes from the non parsed portion and</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- format to get nicer error messages</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#formatErrorLine"><span class="hs-identifier hs-type">formatErrorLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-384"></span><span id="formatErrorLine"><span class="annot"><span class="annottext">formatErrorLine :: ByteString -&gt; String
</span><a href="Data.Aeson.Parser.Internal.html#formatErrorLine"><span class="hs-identifier hs-var hs-var">formatErrorLine</span></a></span></span><span> </span><span id="local-6989586621679185077"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185077"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">C.unpack</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-comment">-- if formatting results in empty ByteString just return that</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-comment">-- otherwise construct the error message with the bytestring builder</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185079"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185079"><span class="hs-identifier hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BSL.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185079"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-390"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">BSL.empty</span></span><span>
</span><span id="line-391"></span><span>       </span><span class="hs-keyword">else</span><span>
</span><span id="line-392"></span><span>         </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">B.toLazyByteString</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-393"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; Builder
</span><span class="hs-identifier hs-var">B.stringUtf8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; at '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><span class="hs-identifier hs-var">B.lazyByteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185079"><span class="hs-identifier hs-var">bs'</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Builder
</span><span class="hs-identifier hs-var">B.stringUtf8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-comment">-- if newline is present cut at that position</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- remove spaces, CR's, tabs, backslashes and quotes characters</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; [Word8] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">13</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">34</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">47</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">92</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-comment">-- take 100 bytes</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.take</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; String) -&gt; ByteString -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185077"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="local-6989586621679184691"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeStrictWith"><span class="hs-identifier hs-type">eitherDecodeStrictWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#IResult"><span class="hs-identifier hs-type">IResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184691"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-403"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Aeson.Types.Internal.html#JSONPath"><span class="hs-identifier hs-type">JSONPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184691"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-404"></span><span id="eitherDecodeStrictWith"><span class="annot"><span class="annottext">eitherDecodeStrictWith :: forall a.
Parser Value
-&gt; (Value -&gt; IResult a)
-&gt; ByteString
-&gt; Either (JSONPath, String) a
</span><a href="Data.Aeson.Parser.Internal.html#eitherDecodeStrictWith"><span class="hs-identifier hs-var hs-var">eitherDecodeStrictWith</span></a></span></span><span> </span><span id="local-6989586621679185089"><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185089"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679185090"><span class="annot"><span class="annottext">Value -&gt; IResult a
</span><a href="#local-6989586621679185090"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span id="local-6989586621679185091"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185091"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IResult a)
-&gt; (Value -&gt; IResult a) -&gt; Either String Value -&gt; IResult a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JSONPath -&gt; String -&gt; IResult a
forall a. JSONPath -&gt; String -&gt; IResult a
</span><a href="Data.Aeson.Types.Internal.html#IError"><span class="hs-identifier hs-var">IError</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value -&gt; IResult a
</span><a href="#local-6989586621679185090"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Value -&gt; ByteString -&gt; Either String Value
forall a. Parser a -&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">A.parseOnly</span></span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="#local-6989586621679185089"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185091"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#ISuccess"><span class="hs-identifier hs-type">ISuccess</span></a></span><span> </span><span id="local-6989586621679185092"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185092"><span class="hs-identifier hs-var">a</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either (JSONPath, String) a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185092"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#IError"><span class="hs-identifier hs-type">IError</span></a></span><span> </span><span id="local-6989586621679185093"><span class="annot"><span class="annottext">JSONPath
</span><a href="#local-6989586621679185093"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621679185094"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185094"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(JSONPath, String) -&gt; Either (JSONPath, String) a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">JSONPath
</span><a href="#local-6989586621679185093"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185094"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#eitherDecodeStrictWith"><span class="hs-pragma hs-type">eitherDecodeStrictWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- $lazy</span><span>
</span><span id="line-411"></span><span class="hs-comment">--</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- The 'json' and 'value' parsers decouple identification from</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- conversion.  Identification occurs immediately (so that an invalid</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- JSON document can be rejected as early as possible), but conversion</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- to a Haskell value is deferred until that value is needed.</span><span>
</span><span id="line-416"></span><span class="hs-comment">--</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- This decoupling can be time-efficient if only a smallish subset of</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- elements in a JSON value need to be inspected, since the cost of</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- conversion is zero for uninspected elements.  The trade off is an</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- increase in memory usage, due to allocation of thunks for values</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- that have not yet been converted.</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- $strict</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- The 'json'' and 'value'' parsers combine identification with</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- conversion.  They consume more CPU cycles up front, but have a</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- smaller memory footprint.</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | Parse a top-level JSON value followed by optional whitespace and</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- end-of-input.  See also: 'json'.</span><span>
</span><span id="line-431"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonEOF"><span class="hs-identifier hs-type">jsonEOF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-432"></span><span id="jsonEOF"><span class="annot"><span class="annottext">jsonEOF :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonEOF"><span class="hs-identifier hs-var hs-var">jsonEOF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#json"><span class="hs-identifier hs-var">json</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- | Parse a top-level JSON value followed by optional whitespace and</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- end-of-input.  See also: 'json''.</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#jsonEOF%27"><span class="hs-identifier hs-type">jsonEOF'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><a href="Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-437"></span><span id="jsonEOF%27"><span class="annot"><span class="annottext">jsonEOF' :: Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#jsonEOF%27"><span class="hs-identifier hs-var hs-var">jsonEOF'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Value
</span><a href="Data.Aeson.Parser.Internal.html#json%27"><span class="hs-identifier hs-var">json'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var">skipSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; Parser () -&gt; Parser Value
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall t. Chunk t =&gt; Parser t ()
</span><span class="hs-identifier hs-var">endOfInput</span></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | The only valid whitespace in a JSON document is space, newline,</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- carriage return, and tab.</span><span>
</span><span id="line-441"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-type">skipSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span id="skipSpace"><span class="annot"><span class="annottext">skipSpace :: Parser ()
</span><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-identifier hs-var hs-var">skipSpace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser ()
</span><span class="hs-identifier hs-var">A.skipWhile</span></span><span> </span><span class="annot"><span class="annottext">((Word8 -&gt; Bool) -&gt; Parser ()) -&gt; (Word8 -&gt; Bool) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679185096"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_SPACE"><span class="hs-identifier hs-var">W8_SPACE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_NL"><span class="hs-identifier hs-var">W8_NL</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_CR"><span class="hs-identifier hs-var">W8_CR</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_TAB"><span class="hs-identifier hs-var">W8_TAB</span></a></span><span>
</span><span id="line-443"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#skipSpace"><span class="hs-pragma hs-type">skipSpace</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">------------------ Copy-pasted and adapted from attoparsec ------------------</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- A strict pair</span><span>
</span><span id="line-448"></span><span class="hs-keyword">data</span><span> </span><span id="SP"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#SP"><span class="hs-identifier hs-var">SP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SP"><span class="annot"><a href="Data.Aeson.Parser.Internal.html#SP"><span class="hs-identifier hs-var">SP</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#decimal0"><span class="hs-identifier hs-type">decimal0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-451"></span><span id="decimal0"><span class="annot"><span class="annottext">decimal0 :: Parser Integer
</span><a href="Data.Aeson.Parser.Internal.html#decimal0"><span class="hs-identifier hs-var hs-var">decimal0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621679185103"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">digits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">A.takeWhile1</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit_w8</span></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">digits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><span class="hs-identifier hs-var">B.unsafeHead</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">digits</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_0"><span class="hs-identifier hs-var">W8_0</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Integer
forall a. String -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;leading zero&quot;</span></span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Parser Integer
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="Data.Aeson.Internal.Integer.html#bsToInteger"><span class="hs-identifier hs-var">bsToInteger</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">digits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><span class="hs-comment">-- | Parse a JSON number.</span></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-identifier hs-type">scientific</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scientific</span></span><span>
</span><span id="line-459"></span><span id="scientific"><span class="annot"><span class="annottext">scientific :: Parser ByteString Scientific
</span><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-identifier hs-var hs-var">scientific</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621679185109"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.peekWord8'</span></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679185111"><span class="annot"><span class="annottext">positive :: Bool
</span><a href="#local-6989586621679185111"><span class="hs-identifier hs-var hs-var">positive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_MINUS"><span class="hs-identifier hs-var">W8_MINUS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_PLUS"><span class="hs-identifier hs-var">W8_PLUS</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_MINUS"><span class="hs-identifier hs-var">W8_MINUS</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621679185114"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185114"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Integer
</span><a href="Data.Aeson.Parser.Internal.html#decimal0"><span class="hs-identifier hs-var">decimal0</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185118"><span class="annot"><span class="annottext">f :: ByteString -&gt; SP
</span><a href="#local-6989586621679185118"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679185119"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185119"><span class="hs-identifier hs-var">fracDigits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; SP
</span><a href="Data.Aeson.Parser.Internal.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Word8 -&gt; Integer) -&gt; Integer -&gt; ByteString -&gt; Integer
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><span class="hs-identifier hs-var">B.foldl'</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word8 -&gt; Integer
forall {a}. Num a =&gt; a -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679185121"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185114"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185119"><span class="hs-identifier hs-var">fracDigits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185119"><span class="hs-identifier hs-var">fracDigits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>      </span><span id="local-6989586621679185121"><span class="annot"><span class="annottext">step :: a -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679185121"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span id="local-6989586621679185130"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185130"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679185131"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185131"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185130"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185131"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_0"><span class="hs-identifier hs-var">W8_0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679185133"><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679185133"><span class="hs-identifier hs-var">dotty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Word8)
</span><span class="hs-identifier hs-var">A.peekWord8</span></span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span id="local-6989586621679185134"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185134"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679185135"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185135"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
</span><a href="#local-6989586621679185133"><span class="hs-identifier hs-var">dotty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_DOT"><span class="hs-identifier hs-var">W8_DOT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Parser Word8
</span><span class="hs-identifier hs-var">A.anyWord8</span></span><span> </span><span class="annot"><span class="annottext">Parser Word8 -&gt; Parser ByteString SP -&gt; Parser ByteString SP
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; SP
</span><a href="#local-6989586621679185118"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; SP) -&gt; Parser ByteString -&gt; Parser ByteString SP
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser ByteString
</span><span class="hs-identifier hs-var">A.takeWhile1</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit_w8</span></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>              </span><span class="annot"><span class="annottext">Maybe Word8
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SP -&gt; Parser ByteString SP
forall a. a -&gt; Parser ByteString a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; SP
</span><a href="Data.Aeson.Parser.Internal.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185114"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679185138"><span class="annot"><span class="annottext">signedCoeff :: Integer
</span><a href="#local-6989586621679185138"><span class="hs-identifier hs-var hs-var">signedCoeff</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185111"><span class="hs-identifier hs-var">positive</span></a></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185134"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-477"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185134"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; Parser Word8
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185139"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185139"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679185139"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_e"><span class="hs-identifier hs-var">W8_e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="Data.Aeson.Internal.Word8.html#W8_E"><span class="hs-identifier hs-var">W8_E</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Word8
-&gt; Parser ByteString Scientific -&gt; Parser ByteString Scientific
forall a b.
Parser ByteString a -&gt; Parser ByteString b -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span>
</span><span id="line-480"></span><span>      </span><span class="annot"><span class="annottext">(Int -&gt; Scientific)
-&gt; Parser ByteString Int -&gt; Parser ByteString Scientific
forall a b. (a -&gt; b) -&gt; Parser ByteString a -&gt; Parser ByteString b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Scientific
</span><span class="hs-identifier hs-var">Sci.scientific</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185138"><span class="hs-identifier hs-var">signedCoeff</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Scientific) -&gt; (Int -&gt; Int) -&gt; Int -&gt; Scientific
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185135"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ByteString Int -&gt; Parser ByteString Int
forall a. Num a =&gt; Parser a -&gt; Parser a
</span><span class="hs-identifier hs-var">signed</span></span><span> </span><span class="annot"><span class="annottext">Parser ByteString Int
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">decimal</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ByteString Scientific
-&gt; Parser ByteString Scientific -&gt; Parser ByteString Scientific
forall a.
Parser ByteString a -&gt; Parser ByteString a -&gt; Parser ByteString a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">Scientific -&gt; Parser ByteString Scientific
forall a. a -&gt; Parser ByteString a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Scientific
</span><span class="hs-identifier hs-var">Sci.scientific</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679185138"><span class="hs-identifier hs-var">signedCoeff</span></a></span><span>    </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185135"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Aeson.Parser.Internal.html#scientific"><span class="hs-pragma hs-type">scientific</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-483"></span></pre></body></html>