<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Network.TLS.Crypto.IES</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : Kazu Yamamoto &lt;kazu@iij.ad.jp&gt;</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.Crypto.IES</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier">GroupPublic</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier">GroupPrivate</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupKey"><span class="hs-identifier">GroupKey</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Group methods</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier">groupGenerateKeyPair</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier">groupGetPubShared</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier">groupGetShared</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier">encodeGroupPublic</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier">decodeGroupPublic</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Compatibility with 'Network.TLS.Crypto.DH'</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier">dhParamsForGroup</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier">dhGroupGenerateKeyPair</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier">dhGroupGetPubShared</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.ECC</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Error</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Number.Generate</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.DH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">generateParams</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.ECIES</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html"><span class="hs-identifier">Network.TLS.Crypto.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Extra.FFDHE.html"><span class="hs-identifier">Network.TLS.Extra.FFDHE</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.RNG.html"><span class="hs-identifier">Network.TLS.RNG</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Util.Serialization.html"><span class="hs-identifier">Network.TLS.Util.Serialization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">os2ip</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">i2ospOf_</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="GroupPrivate"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-var">GroupPrivate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GroupPri_P256"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P256"><span class="hs-identifier hs-var">GroupPri_P256</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P256R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_P384"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P384"><span class="hs-identifier hs-var">GroupPri_P384</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P384R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_P521"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P521"><span class="hs-identifier hs-var">GroupPri_P521</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P521R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_X255"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_X255"><span class="hs-identifier hs-var">GroupPri_X255</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X25519</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_X448"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_X448"><span class="hs-identifier hs-var">GroupPri_X448</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X448</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_FFDHE2048"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE2048"><span class="hs-identifier hs-var">GroupPri_FFDHE2048</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span>
</span><span id="line-45"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_FFDHE3072"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE3072"><span class="hs-identifier hs-var">GroupPri_FFDHE3072</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span>
</span><span id="line-46"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_FFDHE4096"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE4096"><span class="hs-identifier hs-var">GroupPri_FFDHE4096</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span>
</span><span id="line-47"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_FFDHE6144"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE6144"><span class="hs-identifier hs-var">GroupPri_FFDHE6144</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span>
</span><span id="line-48"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="GroupPri_FFDHE8192"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE8192"><span class="hs-identifier hs-var">GroupPri_FFDHE8192</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span>
</span><span id="line-49"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175090"><span id="local-6989586621679175107"><span class="annot"><span class="annottext">GroupPrivate -&gt; GroupPrivate -&gt; Bool
(GroupPrivate -&gt; GroupPrivate -&gt; Bool)
-&gt; (GroupPrivate -&gt; GroupPrivate -&gt; Bool) -&gt; Eq GroupPrivate
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: GroupPrivate -&gt; GroupPrivate -&gt; Bool
== :: GroupPrivate -&gt; GroupPrivate -&gt; Bool
$c/= :: GroupPrivate -&gt; GroupPrivate -&gt; Bool
/= :: GroupPrivate -&gt; GroupPrivate -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175112"><span id="local-6989586621679175140"><span id="local-6989586621679175144"><span class="annot"><span class="annottext">Int -&gt; GroupPrivate -&gt; ShowS
[GroupPrivate] -&gt; ShowS
GroupPrivate -&gt; String
(Int -&gt; GroupPrivate -&gt; ShowS)
-&gt; (GroupPrivate -&gt; String)
-&gt; ([GroupPrivate] -&gt; ShowS)
-&gt; Show GroupPrivate
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; GroupPrivate -&gt; ShowS
showsPrec :: Int -&gt; GroupPrivate -&gt; ShowS
$cshow :: GroupPrivate -&gt; String
show :: GroupPrivate -&gt; String
$cshowList :: [GroupPrivate] -&gt; ShowS
showList :: [GroupPrivate] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="GroupPublic"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-var">GroupPublic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GroupPub_P256"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-var">GroupPub_P256</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P256R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_P384"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-var">GroupPub_P384</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P384R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_P521"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-var">GroupPub_P521</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P521R1</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_X255"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-var">GroupPub_X255</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X25519</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_X448"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-var">GroupPub_X448</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X448</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_FFDHE2048"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-var">GroupPub_FFDHE2048</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-57"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_FFDHE3072"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-var">GroupPub_FFDHE3072</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-58"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_FFDHE4096"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-var">GroupPub_FFDHE4096</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-59"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_FFDHE6144"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-var">GroupPub_FFDHE6144</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-60"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="GroupPub_FFDHE8192"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-var">GroupPub_FFDHE8192</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-61"></span><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679175158"><span id="local-6989586621679175175"><span class="annot"><span class="annottext">GroupPublic -&gt; GroupPublic -&gt; Bool
(GroupPublic -&gt; GroupPublic -&gt; Bool)
-&gt; (GroupPublic -&gt; GroupPublic -&gt; Bool) -&gt; Eq GroupPublic
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: GroupPublic -&gt; GroupPublic -&gt; Bool
== :: GroupPublic -&gt; GroupPublic -&gt; Bool
$c/= :: GroupPublic -&gt; GroupPublic -&gt; Bool
/= :: GroupPublic -&gt; GroupPublic -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175179"><span id="local-6989586621679175206"><span id="local-6989586621679175210"><span class="annot"><span class="annottext">Int -&gt; GroupPublic -&gt; ShowS
[GroupPublic] -&gt; ShowS
GroupPublic -&gt; String
(Int -&gt; GroupPublic -&gt; ShowS)
-&gt; (GroupPublic -&gt; String)
-&gt; ([GroupPublic] -&gt; ShowS)
-&gt; Show GroupPublic
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; GroupPublic -&gt; ShowS
showsPrec :: Int -&gt; GroupPublic -&gt; ShowS
$cshow :: GroupPublic -&gt; String
show :: GroupPublic -&gt; String
$cshowList :: [GroupPublic] -&gt; ShowS
showList :: [GroupPublic] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span id="GroupKey"><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupKey"><span class="hs-identifier hs-var">GroupKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedSecret</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-type">p256</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P256R1</span></span><span>
</span><span id="line-66"></span><span id="p256"><span class="annot"><span class="annottext">p256 :: Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var hs-var">p256</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-type">p384</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P384R1</span></span><span>
</span><span id="line-69"></span><span id="p384"><span class="annot"><span class="annottext">p384 :: Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var hs-var">p384</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-type">p521</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_P521R1</span></span><span>
</span><span id="line-72"></span><span id="p521"><span class="annot"><span class="annottext">p521 :: Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var hs-var">p521</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-type">x25519</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X25519</span></span><span>
</span><span id="line-75"></span><span id="x25519"><span class="annot"><span class="annottext">x25519 :: Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var hs-var">x25519</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-type">x448</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Curve_X448</span></span><span>
</span><span id="line-78"></span><span id="x448"><span class="annot"><span class="annottext">x448 :: Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var hs-var">x448</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-type">dhParamsForGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-81"></span><span id="dhParamsForGroup"><span class="annot"><span class="annottext">dhParamsForGroup :: Group -&gt; Maybe Params
</span><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var hs-var">dhParamsForGroup</span></a></span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE2048"><span class="hs-identifier hs-var">FFDHE2048</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Maybe Params
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE3072"><span class="hs-identifier hs-var">FFDHE3072</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Maybe Params
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE4096"><span class="hs-identifier hs-var">FFDHE4096</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Maybe Params
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE6144"><span class="hs-identifier hs-var">FFDHE6144</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Maybe Params
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span>
</span><span id="line-85"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE8192"><span class="hs-identifier hs-var">FFDHE8192</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; Maybe Params
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhParamsForGroup"><span class="hs-identifier hs-var">dhParamsForGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Params
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679174904"><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-type">groupGenerateKeyPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174904"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174904"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-89"></span><span id="groupGenerateKeyPair"><span class="annot"><span class="annottext">groupGenerateKeyPair :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Group -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var hs-var">groupGenerateKeyPair</span></a></span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P256"><span class="hs-identifier hs-var">P256</span></a></span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar Curve_P256R1 -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_P256"><span class="hs-identifier hs-var">GroupPri_P256</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point Curve_P256R1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-var">GroupPub_P256</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scalar Curve_P256R1 -&gt; GroupPrivate,
 Point Curve_P256R1 -&gt; GroupPublic)
-&gt; r (KeyPair Curve_P256R1) -&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var">`fs`</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1 -&gt; r (KeyPair Curve_P256R1)
forall curve (randomly :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurve curve, MonadRandom randomly) =&gt;
proxy curve -&gt; randomly (KeyPair curve)
forall (randomly :: * -&gt; *) (proxy :: * -&gt; *).
MonadRandom randomly =&gt;
proxy Curve_P256R1 -&gt; randomly (KeyPair Curve_P256R1)
</span><span class="hs-identifier hs-var">curveGenerateKeyPair</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var">p256</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P384"><span class="hs-identifier hs-var">P384</span></a></span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar Curve_P384R1 -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_P384"><span class="hs-identifier hs-var">GroupPri_P384</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point Curve_P384R1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-var">GroupPub_P384</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scalar Curve_P384R1 -&gt; GroupPrivate,
 Point Curve_P384R1 -&gt; GroupPublic)
-&gt; r (KeyPair Curve_P384R1) -&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var">`fs`</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1 -&gt; r (KeyPair Curve_P384R1)
forall curve (randomly :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurve curve, MonadRandom randomly) =&gt;
proxy curve -&gt; randomly (KeyPair curve)
forall (randomly :: * -&gt; *) (proxy :: * -&gt; *).
MonadRandom randomly =&gt;
proxy Curve_P384R1 -&gt; randomly (KeyPair Curve_P384R1)
</span><span class="hs-identifier hs-var">curveGenerateKeyPair</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var">p384</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P521"><span class="hs-identifier hs-var">P521</span></a></span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar Curve_P521R1 -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_P521"><span class="hs-identifier hs-var">GroupPri_P521</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point Curve_P521R1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-var">GroupPub_P521</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scalar Curve_P521R1 -&gt; GroupPrivate,
 Point Curve_P521R1 -&gt; GroupPublic)
-&gt; r (KeyPair Curve_P521R1) -&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var">`fs`</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1 -&gt; r (KeyPair Curve_P521R1)
forall curve (randomly :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurve curve, MonadRandom randomly) =&gt;
proxy curve -&gt; randomly (KeyPair curve)
forall (randomly :: * -&gt; *) (proxy :: * -&gt; *).
MonadRandom randomly =&gt;
proxy Curve_P521R1 -&gt; randomly (KeyPair Curve_P521R1)
</span><span class="hs-identifier hs-var">curveGenerateKeyPair</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var">p521</span></a></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#X25519"><span class="hs-identifier hs-var">X25519</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar Curve_X25519 -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_X255"><span class="hs-identifier hs-var">GroupPri_X255</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point Curve_X25519 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-var">GroupPub_X255</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scalar Curve_X25519 -&gt; GroupPrivate,
 Point Curve_X25519 -&gt; GroupPublic)
-&gt; r (KeyPair Curve_X25519) -&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var">`fs`</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519 -&gt; r (KeyPair Curve_X25519)
forall curve (randomly :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurve curve, MonadRandom randomly) =&gt;
proxy curve -&gt; randomly (KeyPair curve)
forall (randomly :: * -&gt; *) (proxy :: * -&gt; *).
MonadRandom randomly =&gt;
proxy Curve_X25519 -&gt; randomly (KeyPair Curve_X25519)
</span><span class="hs-identifier hs-var">curveGenerateKeyPair</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var">x25519</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#X448"><span class="hs-identifier hs-var">X448</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar Curve_X448 -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_X448"><span class="hs-identifier hs-var">GroupPri_X448</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point Curve_X448 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-var">GroupPub_X448</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Scalar Curve_X448 -&gt; GroupPrivate,
 Point Curve_X448 -&gt; GroupPublic)
-&gt; r (KeyPair Curve_X448) -&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var">`fs`</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448 -&gt; r (KeyPair Curve_X448)
forall curve (randomly :: * -&gt; *) (proxy :: * -&gt; *).
(EllipticCurve curve, MonadRandom randomly) =&gt;
proxy curve -&gt; randomly (KeyPair curve)
forall (randomly :: * -&gt; *) (proxy :: * -&gt; *).
MonadRandom randomly =&gt;
proxy Curve_X448 -&gt; randomly (KeyPair Curve_X448)
</span><span class="hs-identifier hs-var">curveGenerateKeyPair</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var">x448</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE2048"><span class="hs-identifier hs-var">FFDHE2048</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-var">exp2048</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE2048"><span class="hs-identifier hs-var">GroupPri_FFDHE2048</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-var">GroupPub_FFDHE2048</span></a></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE3072"><span class="hs-identifier hs-var">FFDHE3072</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-var">exp3072</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE3072"><span class="hs-identifier hs-var">GroupPri_FFDHE3072</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-var">GroupPub_FFDHE3072</span></a></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE4096"><span class="hs-identifier hs-var">FFDHE4096</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-var">exp4096</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE4096"><span class="hs-identifier hs-var">GroupPri_FFDHE4096</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-var">GroupPub_FFDHE4096</span></a></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE6144"><span class="hs-identifier hs-var">FFDHE6144</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-var">exp6144</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE6144"><span class="hs-identifier hs-var">GroupPri_FFDHE6144</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-var">GroupPub_FFDHE6144</span></a></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGenerateKeyPair"><span class="hs-identifier hs-var">groupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE8192"><span class="hs-identifier hs-var">FFDHE8192</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-var">exp8192</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE8192"><span class="hs-identifier hs-var">GroupPri_FFDHE8192</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-var">GroupPub_FFDHE8192</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679174916"><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-type">dhGroupGenerateKeyPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174916"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174916"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-106"></span><span id="dhGroupGenerateKeyPair"><span class="annot"><span class="annottext">dhGroupGenerateKeyPair :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Group -&gt; r (Params, PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var hs-var">dhGroupGenerateKeyPair</span></a></span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE2048"><span class="hs-identifier hs-var">FFDHE2048</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; r (PrivateNumber, PublicNumber)
-&gt; r (Params, PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var">addParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-var">exp2048</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var">dhGroupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE3072"><span class="hs-identifier hs-var">FFDHE3072</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; r (PrivateNumber, PublicNumber)
-&gt; r (Params, PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var">addParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-var">exp3072</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var">dhGroupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE4096"><span class="hs-identifier hs-var">FFDHE4096</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; r (PrivateNumber, PublicNumber)
-&gt; r (Params, PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var">addParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-var">exp4096</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var">dhGroupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE6144"><span class="hs-identifier hs-var">FFDHE6144</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; r (PrivateNumber, PublicNumber)
-&gt; r (Params, PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var">addParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-var">exp6144</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var">dhGroupGenerateKeyPair</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE8192"><span class="hs-identifier hs-var">FFDHE8192</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; r (PrivateNumber, PublicNumber)
-&gt; r (Params, PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var">addParams</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-var">exp8192</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGenerateKeyPair"><span class="hs-identifier hs-var">dhGroupGenerateKeyPair</span></a></span><span> </span><span id="local-6989586621679175286"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679175286"><span class="hs-identifier hs-var">grp</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; r (Params, PrivateNumber, PublicNumber)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid FFDHE group: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Group -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679175286"><span class="hs-identifier hs-var">grp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679174922"><span id="local-6989586621679174923"><span id="local-6989586621679174924"><span class="annot"><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-type">addParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679174922"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174922"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679174923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679174924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174922"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679174923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679174924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-114"></span><span id="addParams"><span class="annot"><span class="annottext">addParams :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
Params -&gt; f (a, b) -&gt; f (Params, a, b)
</span><a href="Network.TLS.Crypto.IES.html#addParams"><span class="hs-identifier hs-var hs-var">addParams</span></a></span></span><span> </span><span id="local-6989586621679175291"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175291"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; (Params, a, b)) -&gt; f (a, b) -&gt; f (Params, a, b)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((a, b) -&gt; (Params, a, b)) -&gt; f (a, b) -&gt; f (Params, a, b))
-&gt; ((a, b) -&gt; (Params, a, b)) -&gt; f (a, b) -&gt; f (Params, a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679175292"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175292"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175293"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175293"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175291"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679175292"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679175293"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679174910"><span id="local-6989586621679174911"><span class="annot"><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174910"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-117"></span><span>   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Scalar</span></span><span> </span><span class="annot"><a href="#local-6989586621679174911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><a href="#local-6989586621679174911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174910"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyPair</span></span><span> </span><span class="annot"><a href="#local-6989586621679174911"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174910"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-120"></span><span class="hs-special">(</span><span id="local-6989586621679175298"><span class="annot"><span class="annottext">Scalar a -&gt; GroupPrivate
</span><a href="#local-6989586621679175298"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679175299"><span class="annot"><span class="annottext">Point a -&gt; GroupPublic
</span><a href="#local-6989586621679175299"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="fs"><span class="annot"><span class="annottext">fs :: forall (r :: * -&gt; *) a.
MonadRandom r =&gt;
(Scalar a -&gt; GroupPrivate, Point a -&gt; GroupPublic)
-&gt; r (KeyPair a) -&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#fs"><span class="hs-operator hs-var hs-var">`fs`</span></a></span></span><span> </span><span id="local-6989586621679175300"><span class="annot"><span class="annottext">r (KeyPair a)
</span><a href="#local-6989586621679175300"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679175301"><span class="annot"><span class="annottext">KeyPair a
</span><a href="#local-6989586621679175301"><span class="hs-identifier hs-var">keypair</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">r (KeyPair a)
</span><a href="#local-6989586621679175300"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175302"><span class="annot"><span class="annottext">pub :: Point a
</span><a href="#local-6989586621679175302"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyPair a -&gt; Point a
forall curve. KeyPair curve -&gt; Point curve
</span><span class="hs-identifier hs-var">keypairGetPublic</span></span><span> </span><span class="annot"><span class="annottext">KeyPair a
</span><a href="#local-6989586621679175301"><span class="hs-identifier hs-var">keypair</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679175304"><span class="annot"><span class="annottext">pri :: Scalar a
</span><a href="#local-6989586621679175304"><span class="hs-identifier hs-var hs-var">pri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyPair a -&gt; Scalar a
forall curve. KeyPair curve -&gt; Scalar curve
</span><span class="hs-identifier hs-var">keypairGetPrivate</span></span><span> </span><span class="annot"><span class="annottext">KeyPair a
</span><a href="#local-6989586621679175301"><span class="hs-identifier hs-var">keypair</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">(GroupPrivate, GroupPublic) -&gt; r (GroupPrivate, GroupPublic)
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar a -&gt; GroupPrivate
</span><a href="#local-6989586621679175298"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar a
</span><a href="#local-6989586621679175304"><span class="hs-identifier hs-var">pri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; GroupPublic
</span><a href="#local-6989586621679175299"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679175302"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679174915"><span class="annot"><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174915"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174915"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-132"></span><span id="gen"><span class="annot"><span class="annottext">gen :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; (PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (GroupPrivate, GroupPublic)
</span><a href="Network.TLS.Crypto.IES.html#gen"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679175314"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175314"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175315"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175315"><span class="hs-identifier hs-var">expBits</span></a></span></span><span> </span><span id="local-6989586621679175316"><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="#local-6989586621679175316"><span class="hs-identifier hs-var">priTag</span></a></span></span><span> </span><span id="local-6989586621679175317"><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="#local-6989586621679175317"><span class="hs-identifier hs-var">pubTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateNumber -&gt; GroupPrivate
</span><a href="#local-6989586621679175316"><span class="hs-identifier hs-var">priTag</span></a></span><span> </span><span class="annot"><span class="annottext">(PrivateNumber -&gt; GroupPrivate)
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; (PrivateNumber, PublicNumber)
-&gt; (GroupPrivate, GroupPublic)
forall b c b' c'. (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="#local-6989586621679175317"><span class="hs-identifier hs-var">pubTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((PrivateNumber, PublicNumber) -&gt; (GroupPrivate, GroupPublic))
-&gt; r (PrivateNumber, PublicNumber) -&gt; r (GroupPrivate, GroupPublic)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175314"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175315"><span class="hs-identifier hs-var">expBits</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679174925"><span class="annot"><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-type">gen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174925"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-135"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-136"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-137"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174925"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span id="gen%27"><span class="annot"><span class="annottext">gen' :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params -&gt; Int -&gt; r (PrivateNumber, PublicNumber)
</span><a href="Network.TLS.Crypto.IES.html#gen%27"><span class="hs-identifier hs-var hs-var">gen'</span></a></span></span><span> </span><span id="local-6989586621679175327"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175327"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175328"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175328"><span class="hs-identifier hs-var">expBits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrivateNumber -&gt; PrivateNumber
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(PrivateNumber -&gt; PrivateNumber)
-&gt; (PrivateNumber -&gt; PublicNumber)
-&gt; PrivateNumber
-&gt; (PrivateNumber, PublicNumber)
forall b c c'. (b -&gt; c) -&gt; (b -&gt; c') -&gt; b -&gt; (c, c')
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber
</span><span class="hs-identifier hs-var">calculatePublic</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175327"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrivateNumber -&gt; (PrivateNumber, PublicNumber))
-&gt; r PrivateNumber -&gt; r (PrivateNumber, PublicNumber)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; r PrivateNumber
forall (r :: * -&gt; *). MonadRandom r =&gt; Int -&gt; r PrivateNumber
</span><a href="Network.TLS.Crypto.IES.html#generatePriv"><span class="hs-identifier hs-var">generatePriv</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175328"><span class="hs-identifier hs-var">expBits</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679174959"><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-type">groupGetPubShared</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174959"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174959"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupKey"><span class="hs-identifier hs-type">GroupKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-141"></span><span id="groupGetPubShared"><span class="annot"><span class="annottext">groupGetPubShared :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
GroupPublic -&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var hs-var">groupGetPubShared</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-type">GroupPub_P256</span></a></span><span> </span><span id="local-6989586621679175368"><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175368"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">((Point, GroupKey) -&gt; (GroupPublic, GroupKey))
-&gt; Maybe (Point, GroupKey) -&gt; Maybe (GroupPublic, GroupKey)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point -&gt; GroupPublic)
-&gt; (Point, GroupKey) -&gt; (GroupPublic, GroupKey)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; GroupPublic
Point Curve_P256R1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-var">GroupPub_P256</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Point, GroupKey) -&gt; Maybe (GroupPublic, GroupKey))
-&gt; (CryptoFailable (Point, GroupKey) -&gt; Maybe (Point, GroupKey))
-&gt; CryptoFailable (Point, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable (Point, GroupKey) -&gt; Maybe (Point, GroupKey)
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (Point, GroupKey) -&gt; Maybe (GroupPublic, GroupKey))
-&gt; r (CryptoFailable (Point, GroupKey))
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
-&gt; Point Curve_P256R1
-&gt; r (CryptoFailable (Point Curve_P256R1, GroupKey))
forall (randomly :: * -&gt; *) curve (proxy :: * -&gt; *).
(MonadRandom randomly, EllipticCurveDH curve) =&gt;
proxy curve
-&gt; Point curve -&gt; randomly (CryptoFailable (Point curve, GroupKey))
</span><span class="hs-identifier hs-var">deriveEncrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var">p256</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175368"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-type">GroupPub_P384</span></a></span><span> </span><span id="local-6989586621679175372"><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175372"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">((Point SEC_p384r1, GroupKey) -&gt; (GroupPublic, GroupKey))
-&gt; Maybe (Point SEC_p384r1, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point SEC_p384r1 -&gt; GroupPublic)
-&gt; (Point SEC_p384r1, GroupKey) -&gt; (GroupPublic, GroupKey)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Point Curve_P384R1 -&gt; GroupPublic
Point SEC_p384r1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-var">GroupPub_P384</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Point SEC_p384r1, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; (CryptoFailable (Point SEC_p384r1, GroupKey)
    -&gt; Maybe (Point SEC_p384r1, GroupKey))
-&gt; CryptoFailable (Point SEC_p384r1, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable (Point SEC_p384r1, GroupKey)
-&gt; Maybe (Point SEC_p384r1, GroupKey)
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (Point SEC_p384r1, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; r (CryptoFailable (Point SEC_p384r1, GroupKey))
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
-&gt; Point Curve_P384R1
-&gt; r (CryptoFailable (Point Curve_P384R1, GroupKey))
forall (randomly :: * -&gt; *) curve (proxy :: * -&gt; *).
(MonadRandom randomly, EllipticCurveDH curve) =&gt;
proxy curve
-&gt; Point curve -&gt; randomly (CryptoFailable (Point curve, GroupKey))
</span><span class="hs-identifier hs-var">deriveEncrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var">p384</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175372"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-type">GroupPub_P521</span></a></span><span> </span><span id="local-6989586621679175373"><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175373"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">((Point SEC_p521r1, GroupKey) -&gt; (GroupPublic, GroupKey))
-&gt; Maybe (Point SEC_p521r1, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point SEC_p521r1 -&gt; GroupPublic)
-&gt; (Point SEC_p521r1, GroupKey) -&gt; (GroupPublic, GroupKey)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Point Curve_P521R1 -&gt; GroupPublic
Point SEC_p521r1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-var">GroupPub_P521</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Point SEC_p521r1, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; (CryptoFailable (Point SEC_p521r1, GroupKey)
    -&gt; Maybe (Point SEC_p521r1, GroupKey))
-&gt; CryptoFailable (Point SEC_p521r1, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable (Point SEC_p521r1, GroupKey)
-&gt; Maybe (Point SEC_p521r1, GroupKey)
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (Point SEC_p521r1, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; r (CryptoFailable (Point SEC_p521r1, GroupKey))
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
-&gt; Point Curve_P521R1
-&gt; r (CryptoFailable (Point Curve_P521R1, GroupKey))
forall (randomly :: * -&gt; *) curve (proxy :: * -&gt; *).
(MonadRandom randomly, EllipticCurveDH curve) =&gt;
proxy curve
-&gt; Point curve -&gt; randomly (CryptoFailable (Point curve, GroupKey))
</span><span class="hs-identifier hs-var">deriveEncrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var">p521</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175373"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-type">GroupPub_X255</span></a></span><span> </span><span id="local-6989586621679175374"><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175374"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">((PublicKey, GroupKey) -&gt; (GroupPublic, GroupKey))
-&gt; Maybe (PublicKey, GroupKey) -&gt; Maybe (GroupPublic, GroupKey)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PublicKey -&gt; GroupPublic)
-&gt; (PublicKey, GroupKey) -&gt; (GroupPublic, GroupKey)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; GroupPublic
Point Curve_X25519 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-var">GroupPub_X255</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (PublicKey, GroupKey) -&gt; Maybe (GroupPublic, GroupKey))
-&gt; (CryptoFailable (PublicKey, GroupKey)
    -&gt; Maybe (PublicKey, GroupKey))
-&gt; CryptoFailable (PublicKey, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable (PublicKey, GroupKey) -&gt; Maybe (PublicKey, GroupKey)
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (PublicKey, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; r (CryptoFailable (PublicKey, GroupKey))
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
-&gt; Point Curve_X25519
-&gt; r (CryptoFailable (Point Curve_X25519, GroupKey))
forall (randomly :: * -&gt; *) curve (proxy :: * -&gt; *).
(MonadRandom randomly, EllipticCurveDH curve) =&gt;
proxy curve
-&gt; Point curve -&gt; randomly (CryptoFailable (Point curve, GroupKey))
</span><span class="hs-identifier hs-var">deriveEncrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var">x25519</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175374"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-type">GroupPub_X448</span></a></span><span> </span><span id="local-6989586621679175375"><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175375"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">((PublicKey, GroupKey) -&gt; (GroupPublic, GroupKey))
-&gt; Maybe (PublicKey, GroupKey) -&gt; Maybe (GroupPublic, GroupKey)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PublicKey -&gt; GroupPublic)
-&gt; (PublicKey, GroupKey) -&gt; (GroupPublic, GroupKey)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; GroupPublic
Point Curve_X448 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-var">GroupPub_X448</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (PublicKey, GroupKey) -&gt; Maybe (GroupPublic, GroupKey))
-&gt; (CryptoFailable (PublicKey, GroupKey)
    -&gt; Maybe (PublicKey, GroupKey))
-&gt; CryptoFailable (PublicKey, GroupKey)
-&gt; Maybe (GroupPublic, GroupKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CryptoFailable (PublicKey, GroupKey) -&gt; Maybe (PublicKey, GroupKey)
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable (PublicKey, GroupKey)
 -&gt; Maybe (GroupPublic, GroupKey))
-&gt; r (CryptoFailable (PublicKey, GroupKey))
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
-&gt; Point Curve_X448
-&gt; r (CryptoFailable (Point Curve_X448, GroupKey))
forall (randomly :: * -&gt; *) curve (proxy :: * -&gt; *).
(MonadRandom randomly, EllipticCurveDH curve) =&gt;
proxy curve
-&gt; Point curve -&gt; randomly (CryptoFailable (Point curve, GroupKey))
</span><span class="hs-identifier hs-var">deriveEncrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var">x448</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175375"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-type">GroupPub_FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175376"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175376"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var">getPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-var">exp2048</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175376"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-var">GroupPub_FFDHE2048</span></a></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-type">GroupPub_FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175378"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175378"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var">getPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-var">exp3072</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175378"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-var">GroupPub_FFDHE3072</span></a></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-type">GroupPub_FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175379"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175379"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var">getPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-var">exp4096</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175379"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-var">GroupPub_FFDHE4096</span></a></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-type">GroupPub_FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175380"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175380"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var">getPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-var">exp6144</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175380"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-var">GroupPub_FFDHE6144</span></a></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetPubShared"><span class="hs-identifier hs-var">groupGetPubShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-type">GroupPub_FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175381"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175381"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var">getPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-var">exp8192</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175381"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-var">GroupPub_FFDHE8192</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679174973"><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-type">dhGroupGetPubShared</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174973"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174973"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span id="dhGroupGetPubShared"><span class="annot"><span class="annottext">dhGroupGetPubShared :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Group -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var hs-var">dhGroupGetPubShared</span></a></span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE2048"><span class="hs-identifier hs-var">FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175390"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175390"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var">getPubShared'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-var">exp2048</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175390"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var">dhGroupGetPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE3072"><span class="hs-identifier hs-var">FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175392"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175392"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var">getPubShared'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-var">exp3072</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175392"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var">dhGroupGetPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE4096"><span class="hs-identifier hs-var">FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175393"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175393"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var">getPubShared'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-var">exp4096</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175393"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var">dhGroupGetPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE6144"><span class="hs-identifier hs-var">FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175394"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var">getPubShared'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-var">exp6144</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175394"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var">dhGroupGetPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE8192"><span class="hs-identifier hs-var">FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175395"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var">getPubShared'</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-var">exp8192</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175395"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#dhGroupGetPubShared"><span class="hs-identifier hs-var">dhGroupGetPubShared</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><span class="hs-identifier">_</span></span><span>         </span><span class="annot"><span class="annottext">PublicNumber
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PublicNumber, SharedKey)
-&gt; r (Maybe (PublicNumber, SharedKey))
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PublicNumber, SharedKey)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621679174972"><span class="annot"><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-type">getPubShared</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174972"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-166"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-167"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-168"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-169"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174972"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupKey"><span class="hs-identifier hs-type">GroupKey</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-171"></span><span id="getPubShared"><span class="annot"><span class="annottext">getPubShared :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int
-&gt; PublicNumber
-&gt; (PublicNumber -&gt; GroupPublic)
-&gt; r (Maybe (GroupPublic, GroupKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared"><span class="hs-identifier hs-var hs-var">getPubShared</span></a></span></span><span> </span><span id="local-6989586621679175402"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175402"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175403"><span class="hs-identifier hs-var">expBits</span></a></span></span><span> </span><span id="local-6989586621679175404"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175404"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679175405"><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="#local-6989586621679175405"><span class="hs-identifier hs-var">pubTag</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; Bool
</span><a href="Network.TLS.Crypto.IES.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175402"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175404"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GroupPublic, GroupKey) -&gt; r (Maybe (GroupPublic, GroupKey))
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (GroupPublic, GroupKey)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-172"></span><span>                                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679175408"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175408"><span class="hs-identifier hs-var">mypri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r PrivateNumber
forall (r :: * -&gt; *). MonadRandom r =&gt; Int -&gt; r PrivateNumber
</span><a href="Network.TLS.Crypto.IES.html#generatePriv"><span class="hs-identifier hs-var">generatePriv</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175403"><span class="hs-identifier hs-var">expBits</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175409"><span class="annot"><span class="annottext">mypub :: PublicNumber
</span><a href="#local-6989586621679175409"><span class="hs-identifier hs-var hs-var">mypub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber
</span><span class="hs-identifier hs-var">calculatePublic</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175402"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175408"><span class="hs-identifier hs-var">mypri</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span> </span><span id="local-6989586621679175411"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175411"><span class="hs-identifier hs-var">share</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber -&gt; SharedKey
</span><span class="hs-identifier hs-var">getShared</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175402"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175408"><span class="hs-identifier hs-var">mypri</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175404"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">Maybe (GroupPublic, GroupKey) -&gt; r (Maybe (GroupPublic, GroupKey))
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (GroupPublic, GroupKey)
 -&gt; r (Maybe (GroupPublic, GroupKey)))
-&gt; Maybe (GroupPublic, GroupKey)
-&gt; r (Maybe (GroupPublic, GroupKey))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic, GroupKey) -&gt; Maybe (GroupPublic, GroupKey)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="#local-6989586621679175405"><span class="hs-identifier hs-var">pubTag</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175409"><span class="hs-identifier hs-var">mypub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; GroupKey
</span><span class="hs-identifier hs-var">SharedSecret</span></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175411"><span class="hs-identifier hs-var">share</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679174976"><span class="annot"><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-type">getPubShared'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174976"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-179"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span>
</span><span id="line-180"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span>
</span><span id="line-182"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174976"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-183"></span><span id="getPubShared%27"><span class="annot"><span class="annottext">getPubShared' :: forall (r :: * -&gt; *).
MonadRandom r =&gt;
Params
-&gt; Int -&gt; PublicNumber -&gt; r (Maybe (PublicNumber, SharedKey))
</span><a href="Network.TLS.Crypto.IES.html#getPubShared%27"><span class="hs-identifier hs-var hs-var">getPubShared'</span></a></span></span><span> </span><span id="local-6989586621679175420"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175420"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175421"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175421"><span class="hs-identifier hs-var">expBits</span></a></span></span><span> </span><span id="local-6989586621679175422"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175422"><span class="hs-identifier hs-var">pub</span></a></span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; Bool
</span><a href="Network.TLS.Crypto.IES.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175420"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175422"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PublicNumber, SharedKey)
-&gt; r (Maybe (PublicNumber, SharedKey))
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PublicNumber, SharedKey)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>        </span><span id="local-6989586621679175423"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175423"><span class="hs-identifier hs-var">mypri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r PrivateNumber
forall (r :: * -&gt; *). MonadRandom r =&gt; Int -&gt; r PrivateNumber
</span><a href="Network.TLS.Crypto.IES.html#generatePriv"><span class="hs-identifier hs-var">generatePriv</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175421"><span class="hs-identifier hs-var">expBits</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679175424"><span class="annot"><span class="annottext">share :: ScrubbedBytes
</span><a href="#local-6989586621679175424"><span class="hs-identifier hs-var hs-var">share</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SharedKey -&gt; ScrubbedBytes
</span><a href="Network.TLS.Crypto.IES.html#stripLeadingZeros"><span class="hs-identifier hs-var">stripLeadingZeros</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber -&gt; SharedKey
</span><span class="hs-identifier hs-var">getShared</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175420"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175423"><span class="hs-identifier hs-var">mypri</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175422"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">Maybe (PublicNumber, SharedKey)
-&gt; r (Maybe (PublicNumber, SharedKey))
forall a. a -&gt; r a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (PublicNumber, SharedKey)
 -&gt; r (Maybe (PublicNumber, SharedKey)))
-&gt; Maybe (PublicNumber, SharedKey)
-&gt; r (Maybe (PublicNumber, SharedKey))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PublicNumber, SharedKey) -&gt; Maybe (PublicNumber, SharedKey)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber
</span><span class="hs-identifier hs-var">calculatePublic</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175420"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175423"><span class="hs-identifier hs-var">mypri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; SharedKey
</span><span class="hs-identifier hs-var">SharedKey</span></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175424"><span class="hs-identifier hs-var">share</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-type">groupGetShared</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupKey"><span class="hs-identifier hs-type">GroupKey</span></a></span><span>
</span><span id="line-191"></span><span id="groupGetShared"><span class="annot"><span class="annottext">groupGetShared :: GroupPublic -&gt; GroupPrivate -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var hs-var">groupGetShared</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-type">GroupPub_P256</span></a></span><span> </span><span id="local-6989586621679175426"><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175426"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P256"><span class="hs-identifier hs-type">GroupPri_P256</span></a></span><span> </span><span id="local-6989586621679175427"><span class="annot"><span class="annottext">Scalar Curve_P256R1
</span><a href="#local-6989586621679175427"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupKey -&gt; Maybe GroupKey)
-&gt; CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
-&gt; Point Curve_P256R1
-&gt; Scalar Curve_P256R1
-&gt; CryptoFailable GroupKey
forall curve (proxy :: * -&gt; *).
EllipticCurveDH curve =&gt;
proxy curve
-&gt; Point curve -&gt; Scalar curve -&gt; CryptoFailable GroupKey
</span><span class="hs-identifier hs-var">deriveDecrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var">p256</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175426"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar Curve_P256R1
</span><a href="#local-6989586621679175427"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-type">GroupPub_P384</span></a></span><span> </span><span id="local-6989586621679175429"><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175429"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P384"><span class="hs-identifier hs-type">GroupPri_P384</span></a></span><span> </span><span id="local-6989586621679175430"><span class="annot"><span class="annottext">Scalar Curve_P384R1
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupKey -&gt; Maybe GroupKey)
-&gt; CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
-&gt; Point Curve_P384R1
-&gt; Scalar Curve_P384R1
-&gt; CryptoFailable GroupKey
forall curve (proxy :: * -&gt; *).
EllipticCurveDH curve =&gt;
proxy curve
-&gt; Point curve -&gt; Scalar curve -&gt; CryptoFailable GroupKey
</span><span class="hs-identifier hs-var">deriveDecrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var">p384</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175429"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar Curve_P384R1
</span><a href="#local-6989586621679175430"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-type">GroupPub_P521</span></a></span><span> </span><span id="local-6989586621679175431"><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175431"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_P521"><span class="hs-identifier hs-type">GroupPri_P521</span></a></span><span> </span><span id="local-6989586621679175432"><span class="annot"><span class="annottext">Scalar Curve_P521R1
</span><a href="#local-6989586621679175432"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupKey -&gt; Maybe GroupKey)
-&gt; CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
-&gt; Point Curve_P521R1
-&gt; Scalar Curve_P521R1
-&gt; CryptoFailable GroupKey
forall curve (proxy :: * -&gt; *).
EllipticCurveDH curve =&gt;
proxy curve
-&gt; Point curve -&gt; Scalar curve -&gt; CryptoFailable GroupKey
</span><span class="hs-identifier hs-var">deriveDecrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var">p521</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175431"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar Curve_P521R1
</span><a href="#local-6989586621679175432"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-type">GroupPub_X255</span></a></span><span> </span><span id="local-6989586621679175433"><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175433"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_X255"><span class="hs-identifier hs-type">GroupPri_X255</span></a></span><span> </span><span id="local-6989586621679175434"><span class="annot"><span class="annottext">Scalar Curve_X25519
</span><a href="#local-6989586621679175434"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupKey -&gt; Maybe GroupKey)
-&gt; CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
-&gt; Point Curve_X25519
-&gt; Scalar Curve_X25519
-&gt; CryptoFailable GroupKey
forall curve (proxy :: * -&gt; *).
EllipticCurveDH curve =&gt;
proxy curve
-&gt; Point curve -&gt; Scalar curve -&gt; CryptoFailable GroupKey
</span><span class="hs-identifier hs-var">deriveDecrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var">x25519</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175433"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar Curve_X25519
</span><a href="#local-6989586621679175434"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-type">GroupPub_X448</span></a></span><span> </span><span id="local-6989586621679175435"><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175435"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_X448"><span class="hs-identifier hs-type">GroupPri_X448</span></a></span><span> </span><span id="local-6989586621679175436"><span class="annot"><span class="annottext">Scalar Curve_X448
</span><a href="#local-6989586621679175436"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a. CryptoFailable a -&gt; Maybe a
</span><span class="hs-identifier hs-var">maybeCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupKey -&gt; Maybe GroupKey)
-&gt; CryptoFailable GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
-&gt; Point Curve_X448 -&gt; Scalar Curve_X448 -&gt; CryptoFailable GroupKey
forall curve (proxy :: * -&gt; *).
EllipticCurveDH curve =&gt;
proxy curve
-&gt; Point curve -&gt; Scalar curve -&gt; CryptoFailable GroupKey
</span><span class="hs-identifier hs-var">deriveDecrypt</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var">x448</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175435"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar Curve_X448
</span><a href="#local-6989586621679175436"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-type">GroupPub_FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175437"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175437"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE2048"><span class="hs-identifier hs-type">GroupPri_FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175438"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175438"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var">calcShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175437"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175438"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-type">GroupPub_FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175440"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175440"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE3072"><span class="hs-identifier hs-type">GroupPri_FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175441"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175441"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var">calcShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175440"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175441"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-type">GroupPub_FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175442"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175442"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE4096"><span class="hs-identifier hs-type">GroupPri_FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175443"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175443"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var">calcShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175442"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175443"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-type">GroupPub_FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175444"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175444"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE6144"><span class="hs-identifier hs-type">GroupPri_FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175445"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175445"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var">calcShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175444"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175445"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-type">GroupPub_FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175446"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175446"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPri_FFDHE8192"><span class="hs-identifier hs-type">GroupPri_FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175447"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175447"><span class="hs-identifier hs-var">pri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var">calcShared</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175446"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175447"><span class="hs-identifier hs-var">pri</span></a></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#groupGetShared"><span class="hs-identifier hs-var">groupGetShared</span></a></span><span> </span><span class="annot"><span class="annottext">GroupPublic
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">GroupPrivate
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GroupKey
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-type">calcShared</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedSecret</span></span><span>
</span><span id="line-204"></span><span id="calcShared"><span class="annot"><span class="annottext">calcShared :: Params -&gt; PublicNumber -&gt; PrivateNumber -&gt; Maybe GroupKey
</span><a href="Network.TLS.Crypto.IES.html#calcShared"><span class="hs-identifier hs-var hs-var">calcShared</span></a></span></span><span> </span><span id="local-6989586621679175448"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175448"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679175449"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175449"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span id="local-6989586621679175450"><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175450"><span class="hs-identifier hs-var">pri</span></a></span></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; Bool
</span><a href="Network.TLS.Crypto.IES.html#valid"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175448"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175449"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupKey -&gt; Maybe GroupKey
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(GroupKey -&gt; Maybe GroupKey) -&gt; GroupKey -&gt; Maybe GroupKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; GroupKey
</span><span class="hs-identifier hs-var">SharedSecret</span></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175451"><span class="hs-identifier hs-var">share</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GroupKey
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span> </span><span id="local-6989586621679175451"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175451"><span class="hs-identifier hs-var">share</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PrivateNumber -&gt; PublicNumber -&gt; SharedKey
</span><span class="hs-identifier hs-var">getShared</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175448"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateNumber
</span><a href="#local-6989586621679175450"><span class="hs-identifier hs-var">pri</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175449"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-type">encodeGroupPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-211"></span><span id="encodeGroupPublic"><span class="annot"><span class="annottext">encodeGroupPublic :: GroupPublic -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var hs-var">encodeGroupPublic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-type">GroupPub_P256</span></a></span><span> </span><span id="local-6989586621679175452"><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175452"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1 -&gt; Point Curve_P256R1 -&gt; ByteString
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P256R1 -&gt; Point Curve_P256R1 -&gt; bs
</span><span class="hs-identifier hs-var">encodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var">p256</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P256R1
</span><a href="#local-6989586621679175452"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-type">GroupPub_P384</span></a></span><span> </span><span id="local-6989586621679175454"><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175454"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1 -&gt; Point Curve_P384R1 -&gt; ByteString
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P384R1 -&gt; Point Curve_P384R1 -&gt; bs
</span><span class="hs-identifier hs-var">encodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var">p384</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P384R1
</span><a href="#local-6989586621679175454"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-type">GroupPub_P521</span></a></span><span> </span><span id="local-6989586621679175455"><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1 -&gt; Point Curve_P521R1 -&gt; ByteString
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P521R1 -&gt; Point Curve_P521R1 -&gt; bs
</span><span class="hs-identifier hs-var">encodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var">p521</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_P521R1
</span><a href="#local-6989586621679175455"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-type">GroupPub_X255</span></a></span><span> </span><span id="local-6989586621679175456"><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175456"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519 -&gt; Point Curve_X25519 -&gt; ByteString
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_X25519 -&gt; Point Curve_X25519 -&gt; bs
</span><span class="hs-identifier hs-var">encodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var">x25519</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X25519
</span><a href="#local-6989586621679175456"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-type">GroupPub_X448</span></a></span><span> </span><span id="local-6989586621679175457"><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175457"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448 -&gt; Point Curve_X448 -&gt; ByteString
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; Point curve -&gt; bs
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_X448 -&gt; Point Curve_X448 -&gt; bs
</span><span class="hs-identifier hs-var">encodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var">x448</span></a></span><span> </span><span class="annot"><span class="annottext">Point Curve_X448
</span><a href="#local-6989586621679175457"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-type">GroupPub_FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175458"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175458"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe2048"><span class="hs-identifier hs-var">ffdhe2048</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175458"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-type">GroupPub_FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175460"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175460"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe3072"><span class="hs-identifier hs-var">ffdhe3072</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175460"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-type">GroupPub_FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175461"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175461"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe4096"><span class="hs-identifier hs-var">ffdhe4096</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175461"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-type">GroupPub_FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175462"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175462"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe6144"><span class="hs-identifier hs-var">ffdhe6144</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175462"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-type">GroupPub_FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175463"><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175463"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var">enc</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="Network.TLS.Extra.FFDHE.html#ffdhe8192"><span class="hs-identifier hs-var">ffdhe8192</span></a></span><span> </span><span class="annot"><span class="annottext">PublicNumber
</span><a href="#local-6989586621679175463"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-type">enc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-223"></span><span id="enc"><span class="annot"><span class="annottext">enc :: Params -&gt; PublicNumber -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#enc"><span class="hs-identifier hs-var hs-var">enc</span></a></span></span><span> </span><span id="local-6989586621679175464"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175464"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span id="local-6989586621679175466"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175466"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; ByteString
forall ba. ByteArray ba =&gt; Int -&gt; Integer -&gt; ba
</span><span class="hs-identifier hs-var">i2ospOf_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params -&gt; Int
</span><span class="hs-identifier hs-var">params_bits</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679175464"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175466"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-type">decodeGroupPublic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CryptoError</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPublic"><span class="hs-identifier hs-type">GroupPublic</span></a></span><span>
</span><span id="line-226"></span><span id="decodeGroupPublic"><span class="annot"><span class="annottext">decodeGroupPublic :: Group -&gt; ByteString -&gt; Either CryptoError GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var hs-var">decodeGroupPublic</span></a></span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P256"><span class="hs-identifier hs-var">P256</span></a></span><span>   </span><span id="local-6989586621679175470"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175470"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a. CryptoFailable a -&gt; Either CryptoError a
</span><span class="hs-identifier hs-var">eitherCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point -&gt; GroupPublic
Point Curve_P256R1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P256"><span class="hs-identifier hs-var">GroupPub_P256</span></a></span><span> </span><span class="annot"><span class="annottext">(Point -&gt; GroupPublic)
-&gt; CryptoFailable Point -&gt; CryptoFailable GroupPublic
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
-&gt; ByteString -&gt; CryptoFailable (Point Curve_P256R1)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P256R1 -&gt; bs -&gt; CryptoFailable (Point Curve_P256R1)
</span><span class="hs-identifier hs-var">decodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P256R1
</span><a href="Network.TLS.Crypto.IES.html#p256"><span class="hs-identifier hs-var">p256</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175470"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P384"><span class="hs-identifier hs-var">P384</span></a></span><span>   </span><span id="local-6989586621679175473"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175473"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a. CryptoFailable a -&gt; Either CryptoError a
</span><span class="hs-identifier hs-var">eitherCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point Curve_P384R1 -&gt; GroupPublic
Point SEC_p384r1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P384"><span class="hs-identifier hs-var">GroupPub_P384</span></a></span><span> </span><span class="annot"><span class="annottext">(Point SEC_p384r1 -&gt; GroupPublic)
-&gt; CryptoFailable (Point SEC_p384r1) -&gt; CryptoFailable GroupPublic
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
-&gt; ByteString -&gt; CryptoFailable (Point Curve_P384R1)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P384R1 -&gt; bs -&gt; CryptoFailable (Point Curve_P384R1)
</span><span class="hs-identifier hs-var">decodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P384R1
</span><a href="Network.TLS.Crypto.IES.html#p384"><span class="hs-identifier hs-var">p384</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175473"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#P521"><span class="hs-identifier hs-var">P521</span></a></span><span>   </span><span id="local-6989586621679175474"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175474"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a. CryptoFailable a -&gt; Either CryptoError a
</span><span class="hs-identifier hs-var">eitherCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point Curve_P521R1 -&gt; GroupPublic
Point SEC_p521r1 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_P521"><span class="hs-identifier hs-var">GroupPub_P521</span></a></span><span> </span><span class="annot"><span class="annottext">(Point SEC_p521r1 -&gt; GroupPublic)
-&gt; CryptoFailable (Point SEC_p521r1) -&gt; CryptoFailable GroupPublic
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
-&gt; ByteString -&gt; CryptoFailable (Point Curve_P521R1)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_P521R1 -&gt; bs -&gt; CryptoFailable (Point Curve_P521R1)
</span><span class="hs-identifier hs-var">decodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_P521R1
</span><a href="Network.TLS.Crypto.IES.html#p521"><span class="hs-identifier hs-var">p521</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175474"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#X25519"><span class="hs-identifier hs-var">X25519</span></a></span><span> </span><span id="local-6989586621679175475"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175475"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a. CryptoFailable a -&gt; Either CryptoError a
</span><span class="hs-identifier hs-var">eitherCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; GroupPublic
Point Curve_X25519 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X255"><span class="hs-identifier hs-var">GroupPub_X255</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; GroupPublic)
-&gt; CryptoFailable PublicKey -&gt; CryptoFailable GroupPublic
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
-&gt; ByteString -&gt; CryptoFailable (Point Curve_X25519)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_X25519 -&gt; bs -&gt; CryptoFailable (Point Curve_X25519)
</span><span class="hs-identifier hs-var">decodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X25519
</span><a href="Network.TLS.Crypto.IES.html#x25519"><span class="hs-identifier hs-var">x25519</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175475"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#X448"><span class="hs-identifier hs-var">X448</span></a></span><span> </span><span id="local-6989586621679175476"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175476"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a. CryptoFailable a -&gt; Either CryptoError a
</span><span class="hs-identifier hs-var">eitherCryptoError</span></span><span> </span><span class="annot"><span class="annottext">(CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; CryptoFailable GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PublicKey -&gt; GroupPublic
Point Curve_X448 -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_X448"><span class="hs-identifier hs-var">GroupPub_X448</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicKey -&gt; GroupPublic)
-&gt; CryptoFailable PublicKey -&gt; CryptoFailable GroupPublic
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448 -&gt; ByteString -&gt; CryptoFailable (Point Curve_X448)
forall curve bs (proxy :: * -&gt; *).
(EllipticCurve curve, ByteArray bs) =&gt;
proxy curve -&gt; bs -&gt; CryptoFailable (Point curve)
forall bs (proxy :: * -&gt; *).
ByteArray bs =&gt;
proxy Curve_X448 -&gt; bs -&gt; CryptoFailable (Point Curve_X448)
</span><span class="hs-identifier hs-var">decodePoint</span></span><span> </span><span class="annot"><span class="annottext">Proxy Curve_X448
</span><a href="Network.TLS.Crypto.IES.html#x448"><span class="hs-identifier hs-var">x448</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175476"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE2048"><span class="hs-identifier hs-var">FFDHE2048</span></a></span><span> </span><span id="local-6989586621679175477"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175477"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; (Integer -&gt; GroupPublic)
-&gt; Integer
-&gt; Either CryptoError GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE2048"><span class="hs-identifier hs-var">GroupPub_FFDHE2048</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicNumber -&gt; GroupPublic)
-&gt; (Integer -&gt; PublicNumber) -&gt; Integer -&gt; GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PublicNumber
</span><span class="hs-identifier hs-var">PublicNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Either CryptoError GroupPublic)
-&gt; Integer -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175477"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-232"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE3072"><span class="hs-identifier hs-var">FFDHE3072</span></a></span><span> </span><span id="local-6989586621679175478"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175478"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; (Integer -&gt; GroupPublic)
-&gt; Integer
-&gt; Either CryptoError GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE3072"><span class="hs-identifier hs-var">GroupPub_FFDHE3072</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicNumber -&gt; GroupPublic)
-&gt; (Integer -&gt; PublicNumber) -&gt; Integer -&gt; GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PublicNumber
</span><span class="hs-identifier hs-var">PublicNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Either CryptoError GroupPublic)
-&gt; Integer -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175478"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE4096"><span class="hs-identifier hs-var">FFDHE4096</span></a></span><span> </span><span id="local-6989586621679175479"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175479"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; (Integer -&gt; GroupPublic)
-&gt; Integer
-&gt; Either CryptoError GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE4096"><span class="hs-identifier hs-var">GroupPub_FFDHE4096</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicNumber -&gt; GroupPublic)
-&gt; (Integer -&gt; PublicNumber) -&gt; Integer -&gt; GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PublicNumber
</span><span class="hs-identifier hs-var">PublicNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Either CryptoError GroupPublic)
-&gt; Integer -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175479"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE6144"><span class="hs-identifier hs-var">FFDHE6144</span></a></span><span> </span><span id="local-6989586621679175480"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175480"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; (Integer -&gt; GroupPublic)
-&gt; Integer
-&gt; Either CryptoError GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE6144"><span class="hs-identifier hs-var">GroupPub_FFDHE6144</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicNumber -&gt; GroupPublic)
-&gt; (Integer -&gt; PublicNumber) -&gt; Integer -&gt; GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PublicNumber
</span><span class="hs-identifier hs-var">PublicNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Either CryptoError GroupPublic)
-&gt; Integer -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175480"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="Network.TLS.Crypto.Types.html#FFDHE8192"><span class="hs-identifier hs-var">FFDHE8192</span></a></span><span> </span><span id="local-6989586621679175481"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175481"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; Either CryptoError GroupPublic
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(GroupPublic -&gt; Either CryptoError GroupPublic)
-&gt; (Integer -&gt; GroupPublic)
-&gt; Integer
-&gt; Either CryptoError GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PublicNumber -&gt; GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#GroupPub_FFDHE8192"><span class="hs-identifier hs-var">GroupPub_FFDHE8192</span></a></span><span> </span><span class="annot"><span class="annottext">(PublicNumber -&gt; GroupPublic)
-&gt; (Integer -&gt; PublicNumber) -&gt; Integer -&gt; GroupPublic
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PublicNumber
</span><span class="hs-identifier hs-var">PublicNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Either CryptoError GroupPublic)
-&gt; Integer -&gt; Either CryptoError GroupPublic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Integer
</span><span class="hs-identifier hs-var">os2ip</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679175481"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- Check that group element in not in the 2-element subgroup { 1, p - 1 }.</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- See RFC 7919 section 3 and NIST SP 56A rev 2 section 5.6.2.3.1.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#valid"><span class="hs-identifier hs-type">valid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-240"></span><span id="valid"><span class="annot"><span class="annottext">valid :: Params -&gt; PublicNumber -&gt; Bool
</span><a href="Network.TLS.Crypto.IES.html#valid"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Params</span></span><span> </span><span id="local-6989586621679175483"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175483"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PublicNumber</span></span><span> </span><span id="local-6989586621679175484"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175484"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175484"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175484"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679175483"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- strips leading zeros from the result of getShared, as required</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- for DH(E) premaster secret in SSL/TLS before version 1.3.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#stripLeadingZeros"><span class="hs-identifier hs-type">stripLeadingZeros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ScrubbedBytes</span></span><span>
</span><span id="line-245"></span><span id="stripLeadingZeros"><span class="annot"><span class="annottext">stripLeadingZeros :: SharedKey -&gt; ScrubbedBytes
</span><a href="Network.TLS.Crypto.IES.html#stripLeadingZeros"><span class="hs-identifier hs-var hs-var">stripLeadingZeros</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SharedKey</span></span><span> </span><span id="local-6989586621679175487"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175487"><span class="hs-identifier hs-var">sb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes, ScrubbedBytes) -&gt; ScrubbedBytes
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((ScrubbedBytes, ScrubbedBytes) -&gt; ScrubbedBytes)
-&gt; (ScrubbedBytes, ScrubbedBytes) -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ScrubbedBytes -&gt; (ScrubbedBytes, ScrubbedBytes)
forall bs. ByteArray bs =&gt; (Word8 -&gt; Bool) -&gt; bs -&gt; (bs, bs)
</span><span class="hs-identifier hs-var">B.span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621679175487"><span class="hs-identifier hs-var">sb</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Use short exponents as optimization, see RFC 7919 section 5.2.</span><span>
</span><span id="line-248"></span><span id="local-6989586621679174958"><span class="annot"><a href="Network.TLS.Crypto.IES.html#generatePriv"><span class="hs-identifier hs-type">generatePriv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadRandom</span></span><span> </span><span class="annot"><a href="#local-6989586621679174958"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679174958"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateNumber</span></span></span><span>
</span><span id="line-249"></span><span id="generatePriv"><span class="annot"><span class="annottext">generatePriv :: forall (r :: * -&gt; *). MonadRandom r =&gt; Int -&gt; r PrivateNumber
</span><a href="Network.TLS.Crypto.IES.html#generatePriv"><span class="hs-identifier hs-var hs-var">generatePriv</span></a></span></span><span> </span><span id="local-6989586621679175496"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175496"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PrivateNumber
</span><span class="hs-identifier hs-var">PrivateNumber</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; PrivateNumber) -&gt; r Integer -&gt; r PrivateNumber
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe GenTopPolicy -&gt; Bool -&gt; r Integer
forall (m :: * -&gt; *).
MonadRandom m =&gt;
Int -&gt; Maybe GenTopPolicy -&gt; Bool -&gt; m Integer
</span><span class="hs-identifier hs-var">generateParams</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679175496"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenTopPolicy -&gt; Maybe GenTopPolicy
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">GenTopPolicy
</span><span class="hs-identifier hs-var">SetHighest</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Short exponent bit sizes from RFC 7919 appendix A, rounded to next</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- multiple of 16 bits, i.e. going through a function like:</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- let shortExp n = head [ e | i &lt;- [1..], let e = n + i, e `mod` 16 == 0 ]</span><span>
</span><span id="line-254"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-type">exp2048</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-type">exp3072</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-type">exp4096</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-257"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-type">exp6144</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-type">exp8192</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-259"></span><span id="exp2048"><span class="annot"><span class="annottext">exp2048 :: Int
</span><a href="Network.TLS.Crypto.IES.html#exp2048"><span class="hs-identifier hs-var hs-var">exp2048</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">240</span></span><span> </span><span class="hs-comment">-- shortExp 225</span><span>
</span><span id="line-260"></span><span id="exp3072"><span class="annot"><span class="annottext">exp3072 :: Int
</span><a href="Network.TLS.Crypto.IES.html#exp3072"><span class="hs-identifier hs-var hs-var">exp3072</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">288</span></span><span> </span><span class="hs-comment">-- shortExp 275</span><span>
</span><span id="line-261"></span><span id="exp4096"><span class="annot"><span class="annottext">exp4096 :: Int
</span><a href="Network.TLS.Crypto.IES.html#exp4096"><span class="hs-identifier hs-var hs-var">exp4096</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">336</span></span><span> </span><span class="hs-comment">-- shortExp 325</span><span>
</span><span id="line-262"></span><span id="exp6144"><span class="annot"><span class="annottext">exp6144 :: Int
</span><a href="Network.TLS.Crypto.IES.html#exp6144"><span class="hs-identifier hs-var hs-var">exp6144</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">384</span></span><span> </span><span class="hs-comment">-- shortExp 375</span><span>
</span><span id="line-263"></span><span id="exp8192"><span class="annot"><span class="annottext">exp8192 :: Int
</span><a href="Network.TLS.Crypto.IES.html#exp8192"><span class="hs-identifier hs-var hs-var">exp8192</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">416</span></span><span> </span><span class="hs-comment">-- shortExp 400</span><span>
</span><span id="line-264"></span></pre></body></html>