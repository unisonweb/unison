<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      : Network.TLS.QUIC</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Experimental API to run the TLS handshake establishing a QUIC connection.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- On the northbound API:</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- * QUIC starts a TLS client or server thread with 'tlsQUICClient' or</span><span>
</span><span id="line-14"></span><span class="hs-comment">--   'tlsQUICServer'.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">--  TLS invokes QUIC callbacks to use the QUIC transport</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- * TLS uses 'quicSend' and 'quicRecv' to send and receive handshake message</span><span>
</span><span id="line-19"></span><span class="hs-comment">--   fragments.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- * TLS calls 'quicInstallKeys' to provide to QUIC the traffic secrets it</span><span>
</span><span id="line-22"></span><span class="hs-comment">--   should use for encryption/decryption.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- * TLS calls 'quicNotifyExtensions' to notify to QUIC the transport parameters</span><span>
</span><span id="line-25"></span><span class="hs-comment">--   exchanged through the handshake protocol.</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- * TLS calls 'quicDone' when the handshake is done.</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.QUIC</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Handshakers</span></span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><a href="Network.TLS.QUIC.html#tlsQUICClient"><span class="hs-identifier">tlsQUICClient</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#tlsQUICServer"><span class="hs-identifier">tlsQUICServer</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Callback</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier">QUICCallbacks</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier">CryptLevel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#KeyScheduleEvent"><span class="hs-identifier">KeyScheduleEvent</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Secrets</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#EarlySecretInfo"><span class="hs-identifier">EarlySecretInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#HandshakeSecretInfo"><span class="hs-identifier">HandshakeSecretInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#ApplicationSecretInfo"><span class="hs-identifier">ApplicationSecretInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#EarlySecret"><span class="hs-identifier">EarlySecret</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#HandshakeSecret"><span class="hs-identifier">HandshakeSecret</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ApplicationSecret"><span class="hs-identifier">ApplicationSecret</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#TrafficSecrets"><span class="hs-identifier">TrafficSecrets</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ServerTrafficSecret"><span class="hs-identifier">ServerTrafficSecret</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ClientTrafficSecret"><span class="hs-identifier">ClientTrafficSecret</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Negotiated parameters</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#NegotiatedProtocol"><span class="hs-identifier">NegotiatedProtocol</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier">HandshakeMode13</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extensions</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier">ExtensionRaw</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionID"><span class="hs-identifier">ExtensionID</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#extensionID_QuicTransportParameters"><span class="hs-identifier">extensionID_QuicTransportParameters</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Errors</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#errorTLS"><span class="hs-identifier">errorTLS</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#errorToAlertDescription"><span class="hs-identifier">errorToAlertDescription</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Common.html#errorToAlertMessage"><span class="hs-identifier">errorToAlertMessage</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#fromAlertDescription"><span class="hs-identifier">fromAlertDescription</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#toAlertDescription"><span class="hs-identifier">toAlertDescription</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Hash</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.KeySchedule.html#hkdfExpandLabel"><span class="hs-identifier">hkdfExpandLabel</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.KeySchedule.html#hkdfExtract"><span class="hs-identifier">hkdfExtract</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constants</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#quicMaxEarlyDataSize"><span class="hs-identifier">quicMaxEarlyDataSize</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Supported</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#defaultSupported"><span class="hs-identifier">defaultSupported</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html"><span class="hs-identifier">Network.TLS.Backend</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Context.html"><span class="hs-identifier">Network.TLS.Context</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html"><span class="hs-identifier">Network.TLS.Context.Internal</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Core.html"><span class="hs-identifier">Network.TLS.Core</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html"><span class="hs-identifier">Network.TLS.Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier">hashDigestSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html"><span class="hs-identifier">Network.TLS.Crypto.Types</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Extension.html"><span class="hs-identifier">Network.TLS.Extension</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Extension.html#extensionID_QuicTransportParameters"><span class="hs-identifier">extensionID_QuicTransportParameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Extra.Cipher.html"><span class="hs-identifier">Network.TLS.Extra.Cipher</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Common.html"><span class="hs-identifier">Network.TLS.Handshake.Common</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html"><span class="hs-identifier">Network.TLS.Handshake.Control</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html"><span class="hs-identifier">Network.TLS.Handshake.State</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State13.html"><span class="hs-identifier">Network.TLS.Handshake.State13</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.KeySchedule.html"><span class="hs-identifier">Network.TLS.KeySchedule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.KeySchedule.html#hkdfExtract"><span class="hs-identifier">hkdfExtract</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.KeySchedule.html#hkdfExpandLabel"><span class="hs-identifier">hkdfExpandLabel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html"><span class="hs-identifier">Network.TLS.Parameters</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Record.Layer.html"><span class="hs-identifier">Network.TLS.Record.Layer</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html"><span class="hs-identifier">Network.TLS.Record.State</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html"><span class="hs-identifier">Network.TLS.Struct</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Types.html"><span class="hs-identifier">Network.TLS.Types</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default.Class</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Network.TLS.QUIC.html#nullBackend"><span class="hs-identifier hs-type">nullBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span>
</span><span id="line-93"></span><span id="nullBackend"><span class="annot"><span class="annottext">nullBackend :: Backend
</span><a href="Network.TLS.QUIC.html#nullBackend"><span class="hs-identifier hs-var hs-var">nullBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">backendFlush :: IO ()
</span><a href="Network.TLS.Backend.html#backendFlush"><span class="hs-identifier hs-var">backendFlush</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendClose :: IO ()
</span><a href="Network.TLS.Backend.html#backendClose"><span class="hs-identifier hs-var">backendClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendSend :: ByteString -&gt; IO ()
</span><a href="Network.TLS.Backend.html#backendSend"><span class="hs-identifier hs-var">backendSend</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendRecv :: Int -&gt; IO ByteString
</span><a href="Network.TLS.Backend.html#backendRecv"><span class="hs-identifier hs-var">backendRecv</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><span class="hs-comment">-- | Argument given to 'quicInstallKeys' when encryption material is available.</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="KeyScheduleEvent"><span class="annot"><a href="Network.TLS.QUIC.html#KeyScheduleEvent"><span class="hs-identifier hs-var">KeyScheduleEvent</span></a></span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="InstallEarlyKeys"><span class="annot"><a href="Network.TLS.QUIC.html#InstallEarlyKeys"><span class="hs-identifier hs-var">InstallEarlyKeys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#EarlySecretInfo"><span class="hs-identifier hs-type">EarlySecretInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Key material and parameters for traffic at 0-RTT level</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="InstallHandshakeKeys"><span class="annot"><a href="Network.TLS.QUIC.html#InstallHandshakeKeys"><span class="hs-identifier hs-var">InstallHandshakeKeys</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#HandshakeSecretInfo"><span class="hs-identifier hs-type">HandshakeSecretInfo</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Key material and parameters for traffic at handshake level</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="InstallApplicationKeys"><span class="annot"><a href="Network.TLS.QUIC.html#InstallApplicationKeys"><span class="hs-identifier hs-var">InstallApplicationKeys</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.Control.html#ApplicationSecretInfo"><span class="hs-identifier hs-type">ApplicationSecretInfo</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Key material and parameters for traffic at application level</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Callbacks implemented by QUIC and to be called by TLS at specific points</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- during the handshake.  TLS may invoke them from external threads but calls</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- are not concurrent.  Only a single callback function is called at a given</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- point in time.</span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="QUICCallbacks"><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier hs-var">QUICCallbacks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QUICCallbacks"><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier hs-var">QUICCallbacks</span></a></span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="quicSend"><span class="annot"><span class="annottext">QUICCallbacks -&gt; [(CryptLevel, ByteString)] -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicSend"><span class="hs-identifier hs-var hs-var">quicSend</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier hs-type">CryptLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-comment">-- ^ Called by TLS so that QUIC sends one or more handshake fragments. The</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-comment">-- content transiting on this API is the plaintext of the fragments and</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-comment">-- QUIC responsability is to encrypt this payload with the key material</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- given for the specified level and an appropriate encryption scheme.</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-comment">-- The size of the fragments may exceed QUIC datagram limits so QUIC may</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-comment">-- break them into smaller fragments.</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-comment">-- The handshake protocol sometimes combines content at two levels in a</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-comment">-- single flight.  The TLS library does its best to provide this in the</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-comment">-- same @quicSend@ call and with a multi-valued argument.  QUIC can then</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-comment">-- decide how to transmit this optimally.</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="quicRecv"><span class="annot"><span class="annottext">QUICCallbacks -&gt; CryptLevel -&gt; IO (Either TLSError ByteString)
</span><a href="Network.TLS.QUIC.html#quicRecv"><span class="hs-identifier hs-var hs-var">quicRecv</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier hs-type">CryptLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-comment">-- ^ Called by TLS to receive from QUIC the next plaintext handshake</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-comment">-- fragment.  The argument specifies with which encryption level the</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-comment">-- fragment should be decrypted.</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- QUIC may return partial fragments to TLS.  TLS will then call</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-comment">-- @quicRecv@ again as long as necessary.  Note however that fragments</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-comment">-- must be returned in the correct sequence, i.e. the order the TLS peer</span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-comment">-- emitted them.</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-comment">-- The function may return an error to TLS if end of stream is reached or</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-comment">-- if a protocol error has been received, believing the handshake cannot</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">-- proceed any longer.  If the TLS handshake protocol cannot recover from</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-comment">-- this error, the failure condition will be reported back to QUIC through</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-comment">-- the control interface.</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="quicInstallKeys"><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var hs-var">quicInstallKeys</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#KeyScheduleEvent"><span class="hs-identifier hs-type">KeyScheduleEvent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-comment">-- ^ Called by TLS when new encryption material is ready to be used in the</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-comment">-- handshake.  The next 'quicSend' or 'quicRecv' may now use the</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-comment">-- associated encryption level (although the previous level is also</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-comment">-- possible: directions Send/Recv do not change at the same time).</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="quicNotifyExtensions"><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; [ExtensionRaw] -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicNotifyExtensions"><span class="hs-identifier hs-var hs-var">quicNotifyExtensions</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-comment">-- ^ Called by TLS when QUIC-specific extensions have been received from</span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-comment">-- the peer.</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="quicDone"><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicDone"><span class="hs-identifier hs-var hs-var">quicDone</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-comment">-- ^ Called when 'handshake' is done. 'tlsQUICServer' is</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">-- finished after calling this hook. 'tlsQUICClient' calls</span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-comment">-- 'recvData' after calling this hook to wait for new session</span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-comment">-- tickets.</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Network.TLS.QUIC.html#getTxLevel"><span class="hs-identifier hs-type">getTxLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier hs-type">CryptLevel</span></a></span><span>
</span><span id="line-158"></span><span id="getTxLevel"><span class="annot"><span class="annottext">getTxLevel :: Context -&gt; IO CryptLevel
</span><a href="Network.TLS.QUIC.html#getTxLevel"><span class="hs-identifier hs-var hs-var">getTxLevel</span></a></span></span><span> </span><span id="local-6989586621679196977"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196977"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679196978"><span class="annot"><span class="annottext">CryptLevel
</span><a href="#local-6989586621679196978"><span class="hs-identifier hs-var">level</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IO (Hash, Cipher, CryptLevel, ByteString)
</span><a href="Network.TLS.Handshake.State13.html#getTxState"><span class="hs-identifier hs-var">getTxState</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196977"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">CryptLevel -&gt; IO CryptLevel
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CryptLevel
</span><a href="#local-6989586621679196978"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Network.TLS.QUIC.html#getRxLevel"><span class="hs-identifier hs-type">getRxLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier hs-type">CryptLevel</span></a></span><span>
</span><span id="line-163"></span><span id="getRxLevel"><span class="annot"><span class="annottext">getRxLevel :: Context -&gt; IO CryptLevel
</span><a href="Network.TLS.QUIC.html#getRxLevel"><span class="hs-identifier hs-var hs-var">getRxLevel</span></a></span></span><span> </span><span id="local-6989586621679196981"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196981"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679196982"><span class="annot"><span class="annottext">CryptLevel
</span><a href="#local-6989586621679196982"><span class="hs-identifier hs-var">level</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IO (Hash, Cipher, CryptLevel, ByteString)
</span><a href="Network.TLS.Handshake.State13.html#getRxState"><span class="hs-identifier hs-var">getRxState</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196981"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">CryptLevel -&gt; IO CryptLevel
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CryptLevel
</span><a href="#local-6989586621679196982"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Network.TLS.QUIC.html#newRecordLayer"><span class="hs-identifier hs-type">newRecordLayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier hs-type">QUICCallbacks</span></a></span><span>
</span><span id="line-168"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Record.Layer.html#RecordLayer"><span class="hs-identifier hs-type">RecordLayer</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Record.State.html#CryptLevel"><span class="hs-identifier hs-type">CryptLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span id="newRecordLayer"><span class="annot"><span class="annottext">newRecordLayer :: Context -&gt; QUICCallbacks -&gt; RecordLayer [(CryptLevel, ByteString)]
</span><a href="Network.TLS.QUIC.html#newRecordLayer"><span class="hs-identifier hs-var hs-var">newRecordLayer</span></a></span></span><span> </span><span id="local-6989586621679196985"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196985"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679196986"><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196986"><span class="hs-identifier hs-var">callbacks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO CryptLevel
-&gt; ([(CryptLevel, ByteString)] -&gt; IO ())
-&gt; IO (Either TLSError ByteString)
-&gt; RecordLayer [(CryptLevel, ByteString)]
forall ann.
Eq ann =&gt;
IO ann
-&gt; ([(ann, ByteString)] -&gt; IO ())
-&gt; IO (Either TLSError ByteString)
-&gt; RecordLayer [(ann, ByteString)]
</span><a href="Network.TLS.Record.Layer.html#newTransparentRecordLayer"><span class="hs-identifier hs-var">newTransparentRecordLayer</span></a></span><span> </span><span class="annot"><span class="annottext">IO CryptLevel
</span><a href="#local-6989586621679196988"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">[(CryptLevel, ByteString)] -&gt; IO ()
</span><a href="#local-6989586621679196989"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either TLSError ByteString)
</span><a href="#local-6989586621679196990"><span class="hs-identifier hs-var">recv</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679196988"><span class="annot"><span class="annottext">get :: IO CryptLevel
</span><a href="#local-6989586621679196988"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IO CryptLevel
</span><a href="Network.TLS.QUIC.html#getTxLevel"><span class="hs-identifier hs-var">getTxLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196985"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679196989"><span class="annot"><span class="annottext">send :: [(CryptLevel, ByteString)] -&gt; IO ()
</span><a href="#local-6989586621679196989"><span class="hs-identifier hs-var hs-var">send</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; [(CryptLevel, ByteString)] -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicSend"><span class="hs-identifier hs-var">quicSend</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196986"><span class="hs-identifier hs-var">callbacks</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621679196990"><span class="annot"><span class="annottext">recv :: IO (Either TLSError ByteString)
</span><a href="#local-6989586621679196990"><span class="hs-identifier hs-var hs-var">recv</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; IO CryptLevel
</span><a href="Network.TLS.QUIC.html#getRxLevel"><span class="hs-identifier hs-var">getRxLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196985"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">IO CryptLevel
-&gt; (CryptLevel -&gt; IO (Either TLSError ByteString))
-&gt; IO (Either TLSError ByteString)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; CryptLevel -&gt; IO (Either TLSError ByteString)
</span><a href="Network.TLS.QUIC.html#quicRecv"><span class="hs-identifier hs-var">quicRecv</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196986"><span class="hs-identifier hs-var">callbacks</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Start a TLS handshake thread for a QUIC client.  The client will use the</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- specified TLS parameters and call the provided callback functions to send and</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- receive handshake data.</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Network.TLS.QUIC.html#tlsQUICClient"><span class="hs-identifier hs-type">tlsQUICClient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ClientParams"><span class="hs-identifier hs-type">ClientParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier hs-type">QUICCallbacks</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span id="tlsQUICClient"><span class="annot"><span class="annottext">tlsQUICClient :: ClientParams -&gt; QUICCallbacks -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#tlsQUICClient"><span class="hs-identifier hs-var hs-var">tlsQUICClient</span></a></span></span><span> </span><span id="local-6989586621679196992"><span class="annot"><span class="annottext">ClientParams
</span><a href="#local-6989586621679196992"><span class="hs-identifier hs-var">cparams</span></a></span></span><span> </span><span id="local-6989586621679196993"><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679196994"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196994"><span class="hs-identifier hs-var">ctx0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; ClientParams -&gt; IO Context
forall (m :: * -&gt; *) backend params.
(MonadIO m, HasBackend backend, TLSParams params) =&gt;
backend -&gt; params -&gt; m Context
</span><a href="Network.TLS.Context.html#contextNew"><span class="hs-identifier hs-var">contextNew</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Network.TLS.QUIC.html#nullBackend"><span class="hs-identifier hs-var">nullBackend</span></a></span><span> </span><span class="annot"><span class="annottext">ClientParams
</span><a href="#local-6989586621679196992"><span class="hs-identifier hs-var">cparams</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679196997"><span class="annot"><span class="annottext">ctx1 :: Context
</span><a href="#local-6989586621679196997"><span class="hs-identifier hs-var hs-var">ctx1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196994"><span class="hs-identifier hs-var">ctx0</span></a></span><span>
</span><span id="line-182"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxHandshakeSync"><span class="hs-identifier hs-var">ctxHandshakeSync</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#HandshakeSync"><span class="hs-identifier hs-type">HandshakeSync</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679197000"><span class="hs-identifier hs-type">sync</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Context
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ServerState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxFragmentSize"><span class="hs-identifier hs-var">ctxFragmentSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-184"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxQUICMode"><span class="hs-identifier hs-var">ctxQUICMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-185"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>        </span><span id="local-6989586621679197005"><span class="annot"><span class="annottext">rl :: RecordLayer [(CryptLevel, ByteString)]
</span><a href="#local-6989586621679197005"><span class="hs-identifier hs-var hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; QUICCallbacks -&gt; RecordLayer [(CryptLevel, ByteString)]
</span><a href="Network.TLS.QUIC.html#newRecordLayer"><span class="hs-identifier hs-var">newRecordLayer</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197006"><span class="hs-identifier hs-var">ctx2</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679197006"><span class="annot"><span class="annottext">ctx2 :: Context
</span><a href="#local-6989586621679197006"><span class="hs-identifier hs-var hs-var">ctx2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecordLayer [(CryptLevel, ByteString)] -&gt; Context -&gt; Context
forall bytes.
Monoid bytes =&gt;
RecordLayer bytes -&gt; Context -&gt; Context
</span><a href="Network.TLS.Context.Internal.html#updateRecordLayer"><span class="hs-identifier hs-var">updateRecordLayer</span></a></span><span> </span><span class="annot"><span class="annottext">RecordLayer [(CryptLevel, ByteString)]
</span><a href="#local-6989586621679197005"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679196997"><span class="hs-identifier hs-var">ctx1</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">Context -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; Context -&gt; m ()
</span><a href="Network.TLS.Handshake.html#handshake"><span class="hs-identifier hs-var">handshake</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197006"><span class="hs-identifier hs-var">ctx2</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicDone"><span class="hs-identifier hs-var">quicDone</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197006"><span class="hs-identifier hs-var">ctx2</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO ()) -&gt; IO ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; IO ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; Context -&gt; m ByteString
</span><a href="Network.TLS.Core.html#recvData"><span class="hs-identifier hs-var">recvData</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197006"><span class="hs-identifier hs-var">ctx2</span></a></span><span> </span><span class="hs-comment">-- waiting for new session tickets</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679197000"><span class="annot"><span class="annottext">sync :: Context -&gt; ClientState -&gt; IO ()
</span><a href="#local-6989586621679197000"><span class="hs-identifier hs-var hs-var">sync</span></a></span></span><span> </span><span id="local-6989586621679197016"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197016"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.Control.html#SendClientHello"><span class="hs-identifier hs-type">SendClientHello</span></a></span><span> </span><span id="local-6989586621679197018"><span class="annot"><span class="annottext">Maybe EarlySecretInfo
</span><a href="#local-6989586621679197018"><span class="hs-identifier hs-var">mEarlySecInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197016"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe EarlySecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallEarlyKeys"><span class="hs-identifier hs-var">InstallEarlyKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe EarlySecretInfo
</span><a href="#local-6989586621679197018"><span class="hs-identifier hs-var">mEarlySecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621679197000"><span class="hs-identifier hs-var">sync</span></a></span><span> </span><span id="local-6989586621679197019"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197019"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.Control.html#RecvServerHello"><span class="hs-identifier hs-type">RecvServerHello</span></a></span><span> </span><span id="local-6989586621679197021"><span class="annot"><span class="annottext">HandshakeSecretInfo
</span><a href="#local-6989586621679197021"><span class="hs-identifier hs-var">handSecInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197019"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeSecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallHandshakeKeys"><span class="hs-identifier hs-var">InstallHandshakeKeys</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeSecretInfo
</span><a href="#local-6989586621679197021"><span class="hs-identifier hs-var">handSecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621679197000"><span class="hs-identifier hs-var">sync</span></a></span><span> </span><span id="local-6989586621679197022"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197022"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.Control.html#SendClientFinished"><span class="hs-identifier hs-type">SendClientFinished</span></a></span><span> </span><span id="local-6989586621679197024"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197024"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span id="local-6989586621679197025"><span class="annot"><span class="annottext">ApplicationSecretInfo
</span><a href="#local-6989586621679197025"><span class="hs-identifier hs-var">appSecInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679197026"><span class="annot"><span class="annottext">qexts :: [ExtensionRaw]
</span><a href="#local-6989586621679197026"><span class="hs-identifier hs-var hs-var">qexts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; [ExtensionRaw]
</span><a href="Network.TLS.QUIC.html#filterQTP"><span class="hs-identifier hs-var">filterQTP</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197024"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197026"><span class="hs-identifier hs-var">qexts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>            </span><span class="annot"><span class="annottext">TLSError -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; TLSError -&gt; m a
</span><a href="Network.TLS.Context.Internal.html#throwCore"><span class="hs-identifier hs-var">throwCore</span></a></span><span> </span><span class="annot"><span class="annottext">(TLSError -&gt; IO ()) -&gt; TLSError -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Bool, AlertDescription) -&gt; TLSError
</span><a href="Network.TLS.Struct.html#Error_Protocol"><span class="hs-identifier hs-var">Error_Protocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;QUIC transport parameters are mssing&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlertDescription
</span><a href="Network.TLS.Struct.html#MissingExtension"><span class="hs-identifier hs-var">MissingExtension</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; [ExtensionRaw] -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicNotifyExtensions"><span class="hs-identifier hs-var">quicNotifyExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197022"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197026"><span class="hs-identifier hs-var">qexts</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679196993"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197022"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicationSecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallApplicationKeys"><span class="hs-identifier hs-var">InstallApplicationKeys</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicationSecretInfo
</span><a href="#local-6989586621679197025"><span class="hs-identifier hs-var">appSecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Start a TLS handshake thread for a QUIC server.  The server will use the</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- specified TLS parameters and call the provided callback functions to send and</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- receive handshake data.</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Network.TLS.QUIC.html#tlsQUICServer"><span class="hs-identifier hs-type">tlsQUICServer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ServerParams"><span class="hs-identifier hs-type">ServerParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.QUIC.html#QUICCallbacks"><span class="hs-identifier hs-type">QUICCallbacks</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span id="tlsQUICServer"><span class="annot"><span class="annottext">tlsQUICServer :: ServerParams -&gt; QUICCallbacks -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#tlsQUICServer"><span class="hs-identifier hs-var hs-var">tlsQUICServer</span></a></span></span><span> </span><span id="local-6989586621679197033"><span class="annot"><span class="annottext">ServerParams
</span><a href="#local-6989586621679197033"><span class="hs-identifier hs-var">sparams</span></a></span></span><span> </span><span id="local-6989586621679197034"><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679197035"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197035"><span class="hs-identifier hs-var">ctx0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; ServerParams -&gt; IO Context
forall (m :: * -&gt; *) backend params.
(MonadIO m, HasBackend backend, TLSParams params) =&gt;
backend -&gt; params -&gt; m Context
</span><a href="Network.TLS.Context.html#contextNew"><span class="hs-identifier hs-var">contextNew</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Network.TLS.QUIC.html#nullBackend"><span class="hs-identifier hs-var">nullBackend</span></a></span><span> </span><span class="annot"><span class="annottext">ServerParams
</span><a href="#local-6989586621679197033"><span class="hs-identifier hs-var">sparams</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679197037"><span class="annot"><span class="annottext">ctx1 :: Context
</span><a href="#local-6989586621679197037"><span class="hs-identifier hs-var hs-var">ctx1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197035"><span class="hs-identifier hs-var">ctx0</span></a></span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxHandshakeSync"><span class="hs-identifier hs-var">ctxHandshakeSync</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#HandshakeSync"><span class="hs-identifier hs-type">HandshakeSync</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Context
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ClientState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679197038"><span class="hs-identifier hs-type">sync</span></a></span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxFragmentSize"><span class="hs-identifier hs-var">ctxFragmentSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxQUICMode"><span class="hs-identifier hs-var">ctxQUICMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679197040"><span class="annot"><span class="annottext">rl :: RecordLayer [(CryptLevel, ByteString)]
</span><a href="#local-6989586621679197040"><span class="hs-identifier hs-var hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; QUICCallbacks -&gt; RecordLayer [(CryptLevel, ByteString)]
</span><a href="Network.TLS.QUIC.html#newRecordLayer"><span class="hs-identifier hs-var">newRecordLayer</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197041"><span class="hs-identifier hs-var">ctx2</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span id="local-6989586621679197041"><span class="annot"><span class="annottext">ctx2 :: Context
</span><a href="#local-6989586621679197041"><span class="hs-identifier hs-var hs-var">ctx2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecordLayer [(CryptLevel, ByteString)] -&gt; Context -&gt; Context
forall bytes.
Monoid bytes =&gt;
RecordLayer bytes -&gt; Context -&gt; Context
</span><a href="Network.TLS.Context.Internal.html#updateRecordLayer"><span class="hs-identifier hs-var">updateRecordLayer</span></a></span><span> </span><span class="annot"><span class="annottext">RecordLayer [(CryptLevel, ByteString)]
</span><a href="#local-6989586621679197040"><span class="hs-identifier hs-var">rl</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197037"><span class="hs-identifier hs-var">ctx1</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Context -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; Context -&gt; m ()
</span><a href="Network.TLS.Handshake.html#handshake"><span class="hs-identifier hs-var">handshake</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197041"><span class="hs-identifier hs-var">ctx2</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicDone"><span class="hs-identifier hs-var">quicDone</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197041"><span class="hs-identifier hs-var">ctx2</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679197038"><span class="annot"><span class="annottext">sync :: Context -&gt; ServerState -&gt; IO ()
</span><a href="#local-6989586621679197038"><span class="hs-identifier hs-var hs-var">sync</span></a></span></span><span> </span><span id="local-6989586621679197048"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197048"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.Control.html#SendServerHello"><span class="hs-identifier hs-type">SendServerHello</span></a></span><span> </span><span id="local-6989586621679197050"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197050"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span id="local-6989586621679197051"><span class="annot"><span class="annottext">Maybe EarlySecretInfo
</span><a href="#local-6989586621679197051"><span class="hs-identifier hs-var">mEarlySecInfo</span></a></span></span><span> </span><span id="local-6989586621679197052"><span class="annot"><span class="annottext">HandshakeSecretInfo
</span><a href="#local-6989586621679197052"><span class="hs-identifier hs-var">handSecInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679197053"><span class="annot"><span class="annottext">qexts :: [ExtensionRaw]
</span><a href="#local-6989586621679197053"><span class="hs-identifier hs-var hs-var">qexts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; [ExtensionRaw]
</span><a href="Network.TLS.QUIC.html#filterQTP"><span class="hs-identifier hs-var">filterQTP</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197050"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197053"><span class="hs-identifier hs-var">qexts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>            </span><span class="annot"><span class="annottext">TLSError -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; TLSError -&gt; m a
</span><a href="Network.TLS.Context.Internal.html#throwCore"><span class="hs-identifier hs-var">throwCore</span></a></span><span> </span><span class="annot"><span class="annottext">(TLSError -&gt; IO ()) -&gt; TLSError -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Bool, AlertDescription) -&gt; TLSError
</span><a href="Network.TLS.Struct.html#Error_Protocol"><span class="hs-identifier hs-var">Error_Protocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;QUIC transport parameters are mssing&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlertDescription
</span><a href="Network.TLS.Struct.html#MissingExtension"><span class="hs-identifier hs-var">MissingExtension</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; [ExtensionRaw] -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicNotifyExtensions"><span class="hs-identifier hs-var">quicNotifyExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197048"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679197053"><span class="hs-identifier hs-var">qexts</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197048"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe EarlySecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallEarlyKeys"><span class="hs-identifier hs-var">InstallEarlyKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe EarlySecretInfo
</span><a href="#local-6989586621679197051"><span class="hs-identifier hs-var">mEarlySecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197048"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeSecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallHandshakeKeys"><span class="hs-identifier hs-var">InstallHandshakeKeys</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeSecretInfo
</span><a href="#local-6989586621679197052"><span class="hs-identifier hs-var">handSecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="#local-6989586621679197038"><span class="hs-identifier hs-var">sync</span></a></span><span> </span><span id="local-6989586621679197054"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197054"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.Control.html#SendServerFinished"><span class="hs-identifier hs-type">SendServerFinished</span></a></span><span> </span><span id="local-6989586621679197056"><span class="annot"><span class="annottext">ApplicationSecretInfo
</span><a href="#local-6989586621679197056"><span class="hs-identifier hs-var">appSecInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">QUICCallbacks -&gt; Context -&gt; KeyScheduleEvent -&gt; IO ()
</span><a href="Network.TLS.QUIC.html#quicInstallKeys"><span class="hs-identifier hs-var">quicInstallKeys</span></a></span><span> </span><span class="annot"><span class="annottext">QUICCallbacks
</span><a href="#local-6989586621679197034"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197054"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApplicationSecretInfo -&gt; KeyScheduleEvent
</span><a href="Network.TLS.QUIC.html#InstallApplicationKeys"><span class="hs-identifier hs-var">InstallApplicationKeys</span></a></span><span> </span><span class="annot"><span class="annottext">ApplicationSecretInfo
</span><a href="#local-6989586621679197056"><span class="hs-identifier hs-var">appSecInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Network.TLS.QUIC.html#filterQTP"><span class="hs-identifier hs-type">filterQTP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span id="filterQTP"><span class="annot"><span class="annottext">filterQTP :: [ExtensionRaw] -&gt; [ExtensionRaw]
</span><a href="Network.TLS.QUIC.html#filterQTP"><span class="hs-identifier hs-var hs-var">filterQTP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExtensionRaw -&gt; Bool) -&gt; [ExtensionRaw] -&gt; [ExtensionRaw]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span> </span><span id="local-6989586621679197058"><span class="annot"><span class="annottext">ExtensionID
</span><a href="#local-6989586621679197058"><span class="hs-identifier hs-var">eid</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExtensionID
</span><a href="#local-6989586621679197058"><span class="hs-identifier hs-var">eid</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionID -&gt; ExtensionID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExtensionID
</span><a href="Network.TLS.Extension.html#extensionID_QuicTransportParameters"><span class="hs-identifier hs-var">extensionID_QuicTransportParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">ExtensionID
</span><a href="#local-6989586621679197058"><span class="hs-identifier hs-var">eid</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionID -&gt; ExtensionID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ExtensionID
</span><span class="hs-number">0xffa5</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- to be deleted</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Can be used by callbacks to signal an unexpected condition.  This will then</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- generate an &quot;internal_error&quot; alert in the TLS stack.</span><span>
</span><span id="line-234"></span><span id="local-6989586621679196879"><span class="annot"><a href="Network.TLS.QUIC.html#errorTLS"><span class="hs-identifier hs-type">errorTLS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679196879"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-235"></span><span id="errorTLS"><span class="annot"><span class="annottext">errorTLS :: forall a. String -&gt; IO a
</span><a href="Network.TLS.QUIC.html#errorTLS"><span class="hs-identifier hs-var hs-var">errorTLS</span></a></span></span><span> </span><span id="local-6989586621679197061"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679197061"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TLSError -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; TLSError -&gt; m a
</span><a href="Network.TLS.Context.Internal.html#throwCore"><span class="hs-identifier hs-var">throwCore</span></a></span><span> </span><span class="annot"><span class="annottext">(TLSError -&gt; IO a) -&gt; TLSError -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Bool, AlertDescription) -&gt; TLSError
</span><a href="Network.TLS.Struct.html#Error_Protocol"><span class="hs-identifier hs-var">Error_Protocol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679197061"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlertDescription
</span><a href="Network.TLS.Struct.html#InternalError"><span class="hs-identifier hs-var">InternalError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Return the alert that a TLS endpoint would send to the peer for the</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- specified library error.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Network.TLS.QUIC.html#errorToAlertDescription"><span class="hs-identifier hs-type">errorToAlertDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span>
</span><span id="line-240"></span><span id="errorToAlertDescription"><span class="annot"><span class="annottext">errorToAlertDescription :: TLSError -&gt; AlertDescription
</span><a href="Network.TLS.QUIC.html#errorToAlertDescription"><span class="hs-identifier hs-var hs-var">errorToAlertDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AlertLevel, AlertDescription) -&gt; AlertDescription
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((AlertLevel, AlertDescription) -&gt; AlertDescription)
-&gt; (TLSError -&gt; (AlertLevel, AlertDescription))
-&gt; TLSError
-&gt; AlertDescription
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TLSError -&gt; (AlertLevel, AlertDescription)
</span><a href="Network.TLS.Handshake.Common.html#errorToAlert"><span class="hs-identifier hs-var">errorToAlert</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><span class="hs-comment">-- | Encode an alert to the assigned value.</span></span><span>
</span><span id="line-243"></span><span class="annot"><a href="Network.TLS.QUIC.html#fromAlertDescription"><span class="hs-identifier hs-type">fromAlertDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-244"></span><span id="fromAlertDescription"><span class="annot"><span class="annottext">fromAlertDescription :: AlertDescription -&gt; Word8
</span><a href="Network.TLS.QUIC.html#fromAlertDescription"><span class="hs-identifier hs-var hs-var">fromAlertDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AlertDescription -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">-- | Decode an alert from the assigned value.</span></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Network.TLS.QUIC.html#toAlertDescription"><span class="hs-identifier hs-type">toAlertDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span>
</span><span id="line-248"></span><span id="toAlertDescription"><span class="annot"><span class="annottext">toAlertDescription :: Word8 -&gt; Maybe AlertDescription
</span><a href="Network.TLS.QUIC.html#toAlertDescription"><span class="hs-identifier hs-var hs-var">toAlertDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe AlertDescription
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Network.TLS.QUIC.html#defaultSupported"><span class="hs-identifier hs-type">defaultSupported</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#Supported"><span class="hs-identifier hs-type">Supported</span></a></span><span>
</span><span id="line-251"></span><span id="defaultSupported"><span class="annot"><span class="annottext">defaultSupported :: Supported
</span><a href="Network.TLS.QUIC.html#defaultSupported"><span class="hs-identifier hs-var hs-var">defaultSupported</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Supported
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#supportedVersions"><span class="hs-identifier hs-var">supportedVersions</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Types.html#TLS13"><span class="hs-identifier hs-type">TLS13</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#supportedCiphers"><span class="hs-identifier hs-var">supportedCiphers</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Network.TLS.Extra.Cipher.html#cipher_TLS13_AES256GCM_SHA384"><span class="hs-identifier hs-type">cipher_TLS13_AES256GCM_SHA384</span></a></span><span>
</span><span id="line-254"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Extra.Cipher.html#cipher_TLS13_AES128GCM_SHA256"><span class="hs-identifier hs-type">cipher_TLS13_AES128GCM_SHA256</span></a></span><span>
</span><span id="line-255"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Extra.Cipher.html#cipher_TLS13_AES128CCM_SHA256"><span class="hs-identifier hs-type">cipher_TLS13_AES128CCM_SHA256</span></a></span><span>
</span><span id="line-256"></span><span>                                </span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#supportedGroups"><span class="hs-identifier hs-var">supportedGroups</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#X25519"><span class="hs-identifier hs-type">X25519</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#X448"><span class="hs-identifier hs-type">X448</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#P256"><span class="hs-identifier hs-type">P256</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#P384"><span class="hs-identifier hs-type">P384</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#P521"><span class="hs-identifier hs-type">P521</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">-- | Max early data size for QUIC.</span></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Network.TLS.QUIC.html#quicMaxEarlyDataSize"><span class="hs-identifier hs-type">quicMaxEarlyDataSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-262"></span><span id="quicMaxEarlyDataSize"><span class="annot"><span class="annottext">quicMaxEarlyDataSize :: Int
</span><a href="Network.TLS.QUIC.html#quicMaxEarlyDataSize"><span class="hs-identifier hs-var hs-var">quicMaxEarlyDataSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xffffffff</span></span><span>
</span><span id="line-263"></span></pre></body></html>