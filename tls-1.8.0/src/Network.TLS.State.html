<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Rank2Types #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      : Network.TLS.State</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- the State module contains calls related to state initialization/manipulation</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- which is use by the Receiving module and the Sending module.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.State</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier">TLSState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier">TLSSt</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#runTLSState"><span class="hs-identifier">runTLSState</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#newTLSState"><span class="hs-identifier">newTLSState</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.RNG.html#withTLSRNG"><span class="hs-identifier">withTLSRNG</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#updateVerifiedData"><span class="hs-identifier">updateVerifiedData</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier">finishHandshakeTypeMaterial</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeMaterial"><span class="hs-identifier">finishHandshakeMaterial</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier">certVerifyHandshakeTypeMaterial</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeMaterial"><span class="hs-identifier">certVerifyHandshakeMaterial</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setVersion"><span class="hs-identifier">setVersion</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setVersionIfUnset"><span class="hs-identifier">setVersionIfUnset</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getVersion"><span class="hs-identifier">getVersion</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getVersionWithDefault"><span class="hs-identifier">getVersionWithDefault</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setSecureRenegotiation"><span class="hs-identifier">setSecureRenegotiation</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getSecureRenegotiation"><span class="hs-identifier">getSecureRenegotiation</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setExtensionALPN"><span class="hs-identifier">setExtensionALPN</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getExtensionALPN"><span class="hs-identifier">getExtensionALPN</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setNegotiatedProtocol"><span class="hs-identifier">setNegotiatedProtocol</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getNegotiatedProtocol"><span class="hs-identifier">getNegotiatedProtocol</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setClientALPNSuggest"><span class="hs-identifier">setClientALPNSuggest</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getClientALPNSuggest"><span class="hs-identifier">getClientALPNSuggest</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setClientEcPointFormatSuggest"><span class="hs-identifier">setClientEcPointFormatSuggest</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getClientEcPointFormatSuggest"><span class="hs-identifier">getClientEcPointFormatSuggest</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getClientCertificateChain"><span class="hs-identifier">getClientCertificateChain</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setClientCertificateChain"><span class="hs-identifier">setClientCertificateChain</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setClientSNI"><span class="hs-identifier">setClientSNI</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getClientSNI"><span class="hs-identifier">getClientSNI</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getVerifiedData"><span class="hs-identifier">getVerifiedData</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setSession"><span class="hs-identifier">setSession</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getSession"><span class="hs-identifier">getSession</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#isSessionResuming"><span class="hs-identifier">isSessionResuming</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#isClientContext"><span class="hs-identifier">isClientContext</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setExporterMasterSecret"><span class="hs-identifier">setExporterMasterSecret</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getExporterMasterSecret"><span class="hs-identifier">getExporterMasterSecret</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setTLS13KeyShare"><span class="hs-identifier">setTLS13KeyShare</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getTLS13KeyShare"><span class="hs-identifier">getTLS13KeyShare</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setTLS13PreSharedKey"><span class="hs-identifier">setTLS13PreSharedKey</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getTLS13PreSharedKey"><span class="hs-identifier">getTLS13PreSharedKey</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setTLS13HRR"><span class="hs-identifier">setTLS13HRR</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getTLS13HRR"><span class="hs-identifier">getTLS13HRR</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setTLS13Cookie"><span class="hs-identifier">setTLS13Cookie</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getTLS13Cookie"><span class="hs-identifier">getTLS13Cookie</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#setClientSupportsPHA"><span class="hs-identifier">setClientSupportsPHA</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#getClientSupportsPHA"><span class="hs-identifier">getClientSupportsPHA</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * random</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#genRandom"><span class="hs-identifier">genRandom</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#withRNG"><span class="hs-identifier">withRNG</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html"><span class="hs-identifier">Network.TLS.Struct</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct13.html"><span class="hs-identifier">Network.TLS.Struct13</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.RNG.html"><span class="hs-identifier">Network.TLS.RNG</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Types.html"><span class="hs-identifier">Network.TLS.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier">Role</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HostName</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Wire.html"><span class="hs-identifier">Network.TLS.Wire</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Wire.html#GetContinuation"><span class="hs-identifier">GetContinuation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Extension.html"><span class="hs-identifier">Network.TLS.Extension</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.ErrT.html"><span class="hs-identifier">Network.TLS.ErrT</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.Random</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="TLSState"><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-var">TLSState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TLSState"><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-var">TLSState</span></a></span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="stSession"><span class="annot"><span class="annottext">TLSState -&gt; Session
</span><a href="Network.TLS.State.html#stSession"><span class="hs-identifier hs-var hs-var">stSession</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stSessionResuming"><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stSessionResuming"><span class="hs-identifier hs-var hs-var">stSessionResuming</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stSecureRenegotiation"><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stSecureRenegotiation"><span class="hs-identifier hs-var hs-var">stSecureRenegotiation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- RFC 5746</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientVerifiedData"><span class="annot"><span class="annottext">TLSState -&gt; ByteString
</span><a href="Network.TLS.State.html#stClientVerifiedData"><span class="hs-identifier hs-var hs-var">stClientVerifiedData</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-comment">-- RFC 5746</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stServerVerifiedData"><span class="annot"><span class="annottext">TLSState -&gt; ByteString
</span><a href="Network.TLS.State.html#stServerVerifiedData"><span class="hs-identifier hs-var hs-var">stServerVerifiedData</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-comment">-- RFC 5746</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stExtensionALPN"><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stExtensionALPN"><span class="hs-identifier hs-var hs-var">stExtensionALPN</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- RFC 7301</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stHandshakeRecordCont"><span class="annot"><span class="annottext">TLSState -&gt; Maybe (GetContinuation (HandshakeType, ByteString))
</span><a href="Network.TLS.State.html#stHandshakeRecordCont"><span class="hs-identifier hs-var hs-var">stHandshakeRecordCont</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Wire.html#GetContinuation"><span class="hs-identifier hs-type">GetContinuation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stNegotiatedProtocol"><span class="annot"><span class="annottext">TLSState -&gt; Maybe ByteString
</span><a href="Network.TLS.State.html#stNegotiatedProtocol"><span class="hs-identifier hs-var hs-var">stNegotiatedProtocol</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-comment">-- ALPN protocol</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stHandshakeRecordCont13"><span class="annot"><span class="annottext">TLSState -&gt; Maybe (GetContinuation (HandshakeType13, ByteString))
</span><a href="Network.TLS.State.html#stHandshakeRecordCont13"><span class="hs-identifier hs-var hs-var">stHandshakeRecordCont13</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Wire.html#GetContinuation"><span class="hs-identifier hs-type">GetContinuation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct13.html#HandshakeType13"><span class="hs-identifier hs-type">HandshakeType13</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientALPNSuggest"><span class="annot"><span class="annottext">TLSState -&gt; Maybe [ByteString]
</span><a href="Network.TLS.State.html#stClientALPNSuggest"><span class="hs-identifier hs-var hs-var">stClientALPNSuggest</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientGroupSuggest"><span class="annot"><span class="annottext">TLSState -&gt; Maybe [Group]
</span><a href="Network.TLS.State.html#stClientGroupSuggest"><span class="hs-identifier hs-var hs-var">stClientGroupSuggest</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientEcPointFormatSuggest"><span class="annot"><span class="annottext">TLSState -&gt; Maybe [EcPointFormat]
</span><a href="Network.TLS.State.html#stClientEcPointFormatSuggest"><span class="hs-identifier hs-var hs-var">stClientEcPointFormatSuggest</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Extension.html#EcPointFormat"><span class="hs-identifier hs-type">EcPointFormat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientCertificateChain"><span class="annot"><span class="annottext">TLSState -&gt; Maybe CertificateChain
</span><a href="Network.TLS.State.html#stClientCertificateChain"><span class="hs-identifier hs-var hs-var">stClientCertificateChain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientSNI"><span class="annot"><span class="annottext">TLSState -&gt; Maybe HostName
</span><a href="Network.TLS.State.html#stClientSNI"><span class="hs-identifier hs-var hs-var">stClientSNI</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostName</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stRandomGen"><span class="annot"><span class="annottext">TLSState -&gt; StateRNG
</span><a href="Network.TLS.State.html#stRandomGen"><span class="hs-identifier hs-var hs-var">stRandomGen</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.RNG.html#StateRNG"><span class="hs-identifier hs-type">StateRNG</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stVersion"><span class="annot"><span class="annottext">TLSState -&gt; Maybe Version
</span><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var hs-var">stVersion</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientContext"><span class="annot"><span class="annottext">TLSState -&gt; Role
</span><a href="Network.TLS.State.html#stClientContext"><span class="hs-identifier hs-var hs-var">stClientContext</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stTLS13KeyShare"><span class="annot"><span class="annottext">TLSState -&gt; Maybe KeyShare
</span><a href="Network.TLS.State.html#stTLS13KeyShare"><span class="hs-identifier hs-var hs-var">stTLS13KeyShare</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#KeyShare"><span class="hs-identifier hs-type">KeyShare</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stTLS13PreSharedKey"><span class="annot"><span class="annottext">TLSState -&gt; Maybe PreSharedKey
</span><a href="Network.TLS.State.html#stTLS13PreSharedKey"><span class="hs-identifier hs-var hs-var">stTLS13PreSharedKey</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#PreSharedKey"><span class="hs-identifier hs-type">PreSharedKey</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stTLS13HRR"><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stTLS13HRR"><span class="hs-identifier hs-var hs-var">stTLS13HRR</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stTLS13Cookie"><span class="annot"><span class="annottext">TLSState -&gt; Maybe Cookie
</span><a href="Network.TLS.State.html#stTLS13Cookie"><span class="hs-identifier hs-var hs-var">stTLS13Cookie</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stExporterMasterSecret"><span class="annot"><span class="annottext">TLSState -&gt; Maybe ByteString
</span><a href="Network.TLS.State.html#stExporterMasterSecret"><span class="hs-identifier hs-var hs-var">stExporterMasterSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-comment">-- TLS 1.3</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="stClientSupportsPHA"><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stClientSupportsPHA"><span class="hs-identifier hs-var hs-var">stClientSupportsPHA</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- Post-Handshake Authentication (TLS 1.3)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">newtype</span><span> </span><span id="TLSSt"><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-var">TLSSt</span></a></span></span><span> </span><span id="local-6989586621679184877"><span class="annot"><a href="#local-6989586621679184877"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TLSSt"><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-var">TLSSt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runTLSSt"><span class="annot"><span class="annottext">forall a. TLSSt a -&gt; ErrT TLSError (State TLSState) a
</span><a href="Network.TLS.State.html#runTLSSt"><span class="hs-identifier hs-var hs-var">runTLSSt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.ErrT.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679184877"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185119"><span id="local-6989586621679185125"><span id="local-6989586621679185130"><span class="annot"><span class="annottext">Applicative TLSSt
Applicative TLSSt =&gt;
(forall a b. TLSSt a -&gt; (a -&gt; TLSSt b) -&gt; TLSSt b)
-&gt; (forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b)
-&gt; (forall a. a -&gt; TLSSt a)
-&gt; Monad TLSSt
forall a. a -&gt; TLSSt a
forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
forall a b. TLSSt a -&gt; (a -&gt; TLSSt b) -&gt; TLSSt b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. TLSSt a -&gt; (a -&gt; TLSSt b) -&gt; TLSSt b
&gt;&gt;= :: forall a b. TLSSt a -&gt; (a -&gt; TLSSt b) -&gt; TLSSt b
$c&gt;&gt; :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
&gt;&gt; :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
$creturn :: forall a. a -&gt; TLSSt a
return :: forall a. a -&gt; TLSSt a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185143"><span id="local-6989586621679185149"><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185158"><span id="local-6989586621679185164"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b)
-&gt; (forall a b. a -&gt; TLSSt b -&gt; TLSSt a) -&gt; Functor TLSSt
forall a b. a -&gt; TLSSt b -&gt; TLSSt a
forall a b. (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
fmap :: forall a b. (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
$c&lt;$ :: forall a b. a -&gt; TLSSt b -&gt; TLSSt a
&lt;$ :: forall a b. a -&gt; TLSSt b -&gt; TLSSt a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185176"><span id="local-6989586621679185183"><span id="local-6989586621679185189"><span id="local-6989586621679185195"><span id="local-6989586621679185201"><span class="annot"><span class="annottext">Functor TLSSt
Functor TLSSt =&gt;
(forall a. a -&gt; TLSSt a)
-&gt; (forall a b. TLSSt (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; TLSSt a -&gt; TLSSt b -&gt; TLSSt c)
-&gt; (forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b)
-&gt; (forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt a)
-&gt; Applicative TLSSt
forall a. a -&gt; TLSSt a
forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt a
forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
forall a b. TLSSt (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
forall a b c. (a -&gt; b -&gt; c) -&gt; TLSSt a -&gt; TLSSt b -&gt; TLSSt c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; TLSSt a
pure :: forall a. a -&gt; TLSSt a
$c&lt;*&gt; :: forall a b. TLSSt (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
&lt;*&gt; :: forall a b. TLSSt (a -&gt; b) -&gt; TLSSt a -&gt; TLSSt b
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; TLSSt a -&gt; TLSSt b -&gt; TLSSt c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; TLSSt a -&gt; TLSSt b -&gt; TLSSt c
$c*&gt; :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
*&gt; :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt b
$c&lt;* :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt a
&lt;* :: forall a b. TLSSt a -&gt; TLSSt b -&gt; TLSSt a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621679185229"><span class="annot"><span class="annottext">put :: TLSState -&gt; TLSSt ()
</span><a href="#local-6989586621679185229"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621679185231"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185231"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrT TLSError (State TLSState) () -&gt; TLSSt ()
forall a. ErrT TLSError (State TLSState) a -&gt; TLSSt a
</span><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-var">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State TLSState () -&gt; ErrT TLSError (State TLSState) ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT TLSError m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(State TLSState () -&gt; ErrT TLSError (State TLSState) ())
-&gt; State TLSState () -&gt; ErrT TLSError (State TLSState) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; State TLSState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185231"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679185237"><span class="annot"><span class="annottext">get :: TLSSt TLSState
</span><a href="#local-6989586621679185237"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrT TLSError (State TLSState) TLSState -&gt; TLSSt TLSState
forall a. ErrT TLSError (State TLSState) a -&gt; TLSSt a
</span><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-var">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State TLSState TLSState -&gt; ErrT TLSError (State TLSState) TLSState
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT TLSError m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">State TLSState TLSState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679185243"><span class="annot"><span class="annottext">state :: forall a. (TLSState -&gt; (a, TLSState)) -&gt; TLSSt a
</span><a href="#local-6989586621679185243"><span class="hs-identifier hs-var hs-var hs-var hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679185245"><span class="annot"><span class="annottext">TLSState -&gt; (a, TLSState)
</span><a href="#local-6989586621679185245"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrT TLSError (State TLSState) a -&gt; TLSSt a
forall a. ErrT TLSError (State TLSState) a -&gt; TLSSt a
</span><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-var">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State TLSState a -&gt; ErrT TLSError (State TLSState) a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT TLSError m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(State TLSState a -&gt; ErrT TLSError (State TLSState) a)
-&gt; State TLSState a -&gt; ErrT TLSError (State TLSState) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; (a, TLSState)) -&gt; State TLSState a
forall a. (TLSState -&gt; (a, TLSState)) -&gt; StateT TLSState Identity a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; (a, TLSState)
</span><a href="#local-6989586621679185245"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679184962"><span class="annot"><a href="Network.TLS.State.html#runTLSState"><span class="hs-identifier hs-type">runTLSState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184962"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-113"></span><span id="runTLSState"><span class="annot"><span class="annottext">runTLSState :: forall a. TLSSt a -&gt; TLSState -&gt; (Either TLSError a, TLSState)
</span><a href="Network.TLS.State.html#runTLSState"><span class="hs-identifier hs-var hs-var">runTLSState</span></a></span></span><span> </span><span id="local-6989586621679185246"><span class="annot"><span class="annottext">TLSSt a
</span><a href="#local-6989586621679185246"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679185247"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185247"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State TLSState (Either TLSError a)
-&gt; TLSState -&gt; (Either TLSError a, TLSState)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExceptT TLSError (State TLSState) a
-&gt; State TLSState (Either TLSError a)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="Network.TLS.ErrT.html#runErrT"><span class="hs-identifier hs-var">runErrT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TLSSt a -&gt; ExceptT TLSError (State TLSState) a
forall a. TLSSt a -&gt; ErrT TLSError (State TLSState) a
</span><a href="Network.TLS.State.html#runTLSSt"><span class="hs-identifier hs-var">runTLSSt</span></a></span><span> </span><span class="annot"><span class="annottext">TLSSt a
</span><a href="#local-6989586621679185246"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185247"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Network.TLS.State.html#newTLSState"><span class="hs-identifier hs-type">newTLSState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.RNG.html#StateRNG"><span class="hs-identifier hs-type">StateRNG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span>
</span><span id="line-116"></span><span id="newTLSState"><span class="annot"><span class="annottext">newTLSState :: StateRNG -&gt; Role -&gt; TLSState
</span><a href="Network.TLS.State.html#newTLSState"><span class="hs-identifier hs-var hs-var">newTLSState</span></a></span></span><span> </span><span id="local-6989586621679185250"><span class="annot"><span class="annottext">StateRNG
</span><a href="#local-6989586621679185250"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621679185251"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185251"><span class="hs-identifier hs-var">clientContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSState"><span class="hs-identifier hs-type">TLSState</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stSession :: Session
</span><a href="Network.TLS.State.html#stSession"><span class="hs-identifier hs-var">stSession</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Session
</span><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-var">Session</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stSessionResuming :: Bool
</span><a href="Network.TLS.State.html#stSessionResuming"><span class="hs-identifier hs-var">stSessionResuming</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stSecureRenegotiation :: Bool
</span><a href="Network.TLS.State.html#stSecureRenegotiation"><span class="hs-identifier hs-var">stSecureRenegotiation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientVerifiedData :: ByteString
</span><a href="Network.TLS.State.html#stClientVerifiedData"><span class="hs-identifier hs-var">stClientVerifiedData</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">B.empty</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stServerVerifiedData :: ByteString
</span><a href="Network.TLS.State.html#stServerVerifiedData"><span class="hs-identifier hs-var">stServerVerifiedData</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">B.empty</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stExtensionALPN :: Bool
</span><a href="Network.TLS.State.html#stExtensionALPN"><span class="hs-identifier hs-var">stExtensionALPN</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stHandshakeRecordCont :: Maybe (GetContinuation (HandshakeType, ByteString))
</span><a href="Network.TLS.State.html#stHandshakeRecordCont"><span class="hs-identifier hs-var">stHandshakeRecordCont</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GetContinuation (HandshakeType, ByteString))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stHandshakeRecordCont13 :: Maybe (GetContinuation (HandshakeType13, ByteString))
</span><a href="Network.TLS.State.html#stHandshakeRecordCont13"><span class="hs-identifier hs-var">stHandshakeRecordCont13</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (GetContinuation (HandshakeType13, ByteString))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stNegotiatedProtocol :: Maybe ByteString
</span><a href="Network.TLS.State.html#stNegotiatedProtocol"><span class="hs-identifier hs-var">stNegotiatedProtocol</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientALPNSuggest :: Maybe [ByteString]
</span><a href="Network.TLS.State.html#stClientALPNSuggest"><span class="hs-identifier hs-var">stClientALPNSuggest</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [ByteString]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientGroupSuggest :: Maybe [Group]
</span><a href="Network.TLS.State.html#stClientGroupSuggest"><span class="hs-identifier hs-var">stClientGroupSuggest</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Group]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientEcPointFormatSuggest :: Maybe [EcPointFormat]
</span><a href="Network.TLS.State.html#stClientEcPointFormatSuggest"><span class="hs-identifier hs-var">stClientEcPointFormatSuggest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [EcPointFormat]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientCertificateChain :: Maybe CertificateChain
</span><a href="Network.TLS.State.html#stClientCertificateChain"><span class="hs-identifier hs-var">stClientCertificateChain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CertificateChain
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientSNI :: Maybe HostName
</span><a href="Network.TLS.State.html#stClientSNI"><span class="hs-identifier hs-var">stClientSNI</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe HostName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stRandomGen :: StateRNG
</span><a href="Network.TLS.State.html#stRandomGen"><span class="hs-identifier hs-var">stRandomGen</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateRNG
</span><a href="#local-6989586621679185250"><span class="hs-identifier hs-var">rng</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stVersion :: Maybe Version
</span><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Version
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientContext :: Role
</span><a href="Network.TLS.State.html#stClientContext"><span class="hs-identifier hs-var">stClientContext</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185251"><span class="hs-identifier hs-var">clientContext</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stTLS13KeyShare :: Maybe KeyShare
</span><a href="Network.TLS.State.html#stTLS13KeyShare"><span class="hs-identifier hs-var">stTLS13KeyShare</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe KeyShare
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stTLS13PreSharedKey :: Maybe PreSharedKey
</span><a href="Network.TLS.State.html#stTLS13PreSharedKey"><span class="hs-identifier hs-var">stTLS13PreSharedKey</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PreSharedKey
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stTLS13HRR :: Bool
</span><a href="Network.TLS.State.html#stTLS13HRR"><span class="hs-identifier hs-var">stTLS13HRR</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stTLS13Cookie :: Maybe Cookie
</span><a href="Network.TLS.State.html#stTLS13Cookie"><span class="hs-identifier hs-var">stTLS13Cookie</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Cookie
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stExporterMasterSecret :: Maybe ByteString
</span><a href="Network.TLS.State.html#stExporterMasterSecret"><span class="hs-identifier hs-var">stExporterMasterSecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stClientSupportsPHA :: Bool
</span><a href="Network.TLS.State.html#stClientSupportsPHA"><span class="hs-identifier hs-var">stClientSupportsPHA</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Network.TLS.State.html#updateVerifiedData"><span class="hs-identifier hs-type">updateVerifiedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="updateVerifiedData"><span class="annot"><span class="annottext">updateVerifiedData :: Role -&gt; ByteString -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#updateVerifiedData"><span class="hs-identifier hs-var hs-var">updateVerifiedData</span></a></span></span><span> </span><span id="local-6989586621679185254"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185254"><span class="hs-identifier hs-var">sending</span></a></span></span><span> </span><span id="local-6989586621679185255"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185255"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679185256"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185256"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TLSSt Role
</span><a href="Network.TLS.State.html#isClientContext"><span class="hs-identifier hs-var">isClientContext</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185256"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185254"><span class="hs-identifier hs-var">sending</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185259"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185259"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185259"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stServerVerifiedData"><span class="hs-identifier hs-var">stServerVerifiedData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185255"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185260"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185260"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185260"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientVerifiedData"><span class="hs-identifier hs-var">stClientVerifiedData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185255"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-type">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-150"></span><span id="finishHandshakeTypeMaterial"><span class="annot"><span class="annottext">finishHandshakeTypeMaterial :: HandshakeType -&gt; Bool
</span><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var hs-var">finishHandshakeTypeMaterial</span></a></span></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientHello"><span class="hs-identifier hs-var">HandshakeType_ClientHello</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHello"><span class="hs-identifier hs-var">HandshakeType_ServerHello</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Certificate"><span class="hs-identifier hs-var">HandshakeType_Certificate</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_HelloRequest"><span class="hs-identifier hs-var">HandshakeType_HelloRequest</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHelloDone"><span class="hs-identifier hs-var">HandshakeType_ServerHelloDone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ClientKeyXchg</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ServerKeyXchg</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertRequest"><span class="hs-identifier hs-var">HandshakeType_CertRequest</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertVerify"><span class="hs-identifier hs-var">HandshakeType_CertVerify</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-159"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Finished"><span class="hs-identifier hs-var">HandshakeType_Finished</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Network.TLS.State.html#finishHandshakeMaterial"><span class="hs-identifier hs-type">finishHandshakeMaterial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-162"></span><span id="finishHandshakeMaterial"><span class="annot"><span class="annottext">finishHandshakeMaterial :: Handshake -&gt; Bool
</span><a href="Network.TLS.State.html#finishHandshakeMaterial"><span class="hs-identifier hs-var hs-var">finishHandshakeMaterial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeType -&gt; Bool
</span><a href="Network.TLS.State.html#finishHandshakeTypeMaterial"><span class="hs-identifier hs-var">finishHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">(HandshakeType -&gt; Bool)
-&gt; (Handshake -&gt; HandshakeType) -&gt; Handshake -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; HandshakeType
</span><a href="Network.TLS.Struct.html#typeOfHandshake"><span class="hs-identifier hs-var">typeOfHandshake</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-type">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-165"></span><span id="certVerifyHandshakeTypeMaterial"><span class="annot"><span class="annottext">certVerifyHandshakeTypeMaterial :: HandshakeType -&gt; Bool
</span><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var hs-var">certVerifyHandshakeTypeMaterial</span></a></span></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientHello"><span class="hs-identifier hs-var">HandshakeType_ClientHello</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-166"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHello"><span class="hs-identifier hs-var">HandshakeType_ServerHello</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Certificate"><span class="hs-identifier hs-var">HandshakeType_Certificate</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_HelloRequest"><span class="hs-identifier hs-var">HandshakeType_HelloRequest</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHelloDone"><span class="hs-identifier hs-var">HandshakeType_ServerHelloDone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ClientKeyXchg</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ServerKeyXchg</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertRequest"><span class="hs-identifier hs-var">HandshakeType_CertRequest</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertVerify"><span class="hs-identifier hs-var">HandshakeType_CertVerify</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Finished"><span class="hs-identifier hs-var">HandshakeType_Finished</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Network.TLS.State.html#certVerifyHandshakeMaterial"><span class="hs-identifier hs-type">certVerifyHandshakeMaterial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-177"></span><span id="certVerifyHandshakeMaterial"><span class="annot"><span class="annottext">certVerifyHandshakeMaterial :: Handshake -&gt; Bool
</span><a href="Network.TLS.State.html#certVerifyHandshakeMaterial"><span class="hs-identifier hs-var hs-var">certVerifyHandshakeMaterial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeType -&gt; Bool
</span><a href="Network.TLS.State.html#certVerifyHandshakeTypeMaterial"><span class="hs-identifier hs-var">certVerifyHandshakeTypeMaterial</span></a></span><span> </span><span class="annot"><span class="annottext">(HandshakeType -&gt; Bool)
-&gt; (Handshake -&gt; HandshakeType) -&gt; Handshake -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; HandshakeType
</span><a href="Network.TLS.Struct.html#typeOfHandshake"><span class="hs-identifier hs-var">typeOfHandshake</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Network.TLS.State.html#setSession"><span class="hs-identifier hs-type">setSession</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span id="setSession"><span class="annot"><span class="annottext">setSession :: Session -&gt; Bool -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setSession"><span class="hs-identifier hs-var hs-var">setSession</span></a></span></span><span> </span><span id="local-6989586621679185273"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679185273"><span class="hs-identifier hs-var">session</span></a></span></span><span> </span><span id="local-6989586621679185274"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185274"><span class="hs-identifier hs-var">resuming</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185275"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185275"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185275"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stSession"><span class="hs-identifier hs-var">stSession</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185273"><span class="hs-identifier hs-type">session</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stSessionResuming"><span class="hs-identifier hs-var">stSessionResuming</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185274"><span class="hs-identifier hs-type">resuming</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Network.TLS.State.html#getSession"><span class="hs-identifier hs-type">getSession</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span>
</span><span id="line-183"></span><span id="getSession"><span class="annot"><span class="annottext">getSession :: TLSSt Session
</span><a href="Network.TLS.State.html#getSession"><span class="hs-identifier hs-var hs-var">getSession</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Session) -&gt; TLSSt Session
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Session
</span><a href="Network.TLS.State.html#stSession"><span class="hs-identifier hs-var">stSession</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Network.TLS.State.html#isSessionResuming"><span class="hs-identifier hs-type">isSessionResuming</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-186"></span><span id="isSessionResuming"><span class="annot"><span class="annottext">isSessionResuming :: TLSSt Bool
</span><a href="Network.TLS.State.html#isSessionResuming"><span class="hs-identifier hs-var hs-var">isSessionResuming</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Bool) -&gt; TLSSt Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stSessionResuming"><span class="hs-identifier hs-var">stSessionResuming</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Network.TLS.State.html#setVersion"><span class="hs-identifier hs-type">setVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span id="setVersion"><span class="annot"><span class="annottext">setVersion :: Version -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setVersion"><span class="hs-identifier hs-var hs-var">setVersion</span></a></span></span><span> </span><span id="local-6989586621679185277"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679185277"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185278"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185278"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185278"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185277"><span class="hs-identifier hs-type">ver</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Network.TLS.State.html#setVersionIfUnset"><span class="hs-identifier hs-type">setVersionIfUnset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span id="setVersionIfUnset"><span class="annot"><span class="annottext">setVersionIfUnset :: Version -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setVersionIfUnset"><span class="hs-identifier hs-var hs-var">setVersionIfUnset</span></a></span></span><span> </span><span id="local-6989586621679185279"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679185279"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; TLSState
</span><a href="#local-6989586621679185280"><span class="hs-identifier hs-var">maybeSet</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185280"><span class="annot"><span class="annottext">maybeSet :: TLSState -&gt; TLSState
</span><a href="#local-6989586621679185280"><span class="hs-identifier hs-var hs-var">maybeSet</span></a></span></span><span> </span><span id="local-6989586621679185281"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185281"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe Version
</span><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185281"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>                           </span><span class="annot"><span class="annottext">Maybe Version
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185281"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185279"><span class="hs-identifier hs-type">ver</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185281"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Network.TLS.State.html#getVersion"><span class="hs-identifier hs-type">getVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-198"></span><span id="getVersion"><span class="annot"><span class="annottext">getVersion :: TLSSt Version
</span><a href="Network.TLS.State.html#getVersion"><span class="hs-identifier hs-var hs-var">getVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Maybe Version -&gt; Version
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HostName -&gt; Version
forall a. HasCallStack =&gt; HostName -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">HostName
</span><span class="hs-string">&quot;internal error: version hasn't been set yet&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Version -&gt; Version)
-&gt; TLSSt (Maybe Version) -&gt; TLSSt Version
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe Version) -&gt; TLSSt (Maybe Version)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe Version
</span><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Network.TLS.State.html#getVersionWithDefault"><span class="hs-identifier hs-type">getVersionWithDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-201"></span><span id="getVersionWithDefault"><span class="annot"><span class="annottext">getVersionWithDefault :: Version -&gt; TLSSt Version
</span><a href="Network.TLS.State.html#getVersionWithDefault"><span class="hs-identifier hs-var hs-var">getVersionWithDefault</span></a></span></span><span> </span><span id="local-6989586621679185285"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679185285"><span class="hs-identifier hs-var">defaultVer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Maybe Version -&gt; Version
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679185285"><span class="hs-identifier hs-var">defaultVer</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Version -&gt; Version)
-&gt; TLSSt (Maybe Version) -&gt; TLSSt Version
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe Version) -&gt; TLSSt (Maybe Version)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe Version
</span><a href="Network.TLS.State.html#stVersion"><span class="hs-identifier hs-var">stVersion</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Network.TLS.State.html#setSecureRenegotiation"><span class="hs-identifier hs-type">setSecureRenegotiation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="setSecureRenegotiation"><span class="annot"><span class="annottext">setSecureRenegotiation :: Bool -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setSecureRenegotiation"><span class="hs-identifier hs-var hs-var">setSecureRenegotiation</span></a></span></span><span> </span><span id="local-6989586621679185286"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185286"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185287"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185287"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185287"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stSecureRenegotiation"><span class="hs-identifier hs-var">stSecureRenegotiation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185286"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Network.TLS.State.html#getSecureRenegotiation"><span class="hs-identifier hs-type">getSecureRenegotiation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-207"></span><span id="getSecureRenegotiation"><span class="annot"><span class="annottext">getSecureRenegotiation :: TLSSt Bool
</span><a href="Network.TLS.State.html#getSecureRenegotiation"><span class="hs-identifier hs-var hs-var">getSecureRenegotiation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Bool) -&gt; TLSSt Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stSecureRenegotiation"><span class="hs-identifier hs-var">stSecureRenegotiation</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Network.TLS.State.html#setExtensionALPN"><span class="hs-identifier hs-type">setExtensionALPN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span id="setExtensionALPN"><span class="annot"><span class="annottext">setExtensionALPN :: Bool -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setExtensionALPN"><span class="hs-identifier hs-var hs-var">setExtensionALPN</span></a></span></span><span> </span><span id="local-6989586621679185288"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185288"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185289"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185289"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185289"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stExtensionALPN"><span class="hs-identifier hs-var">stExtensionALPN</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185288"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Network.TLS.State.html#getExtensionALPN"><span class="hs-identifier hs-type">getExtensionALPN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-213"></span><span id="getExtensionALPN"><span class="annot"><span class="annottext">getExtensionALPN :: TLSSt Bool
</span><a href="Network.TLS.State.html#getExtensionALPN"><span class="hs-identifier hs-var hs-var">getExtensionALPN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Bool) -&gt; TLSSt Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stExtensionALPN"><span class="hs-identifier hs-var">stExtensionALPN</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Network.TLS.State.html#setNegotiatedProtocol"><span class="hs-identifier hs-type">setNegotiatedProtocol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span id="setNegotiatedProtocol"><span class="annot"><span class="annottext">setNegotiatedProtocol :: ByteString -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setNegotiatedProtocol"><span class="hs-identifier hs-var hs-var">setNegotiatedProtocol</span></a></span></span><span> </span><span id="local-6989586621679185290"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185290"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185291"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185291"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185291"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stNegotiatedProtocol"><span class="hs-identifier hs-var">stNegotiatedProtocol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185290"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Network.TLS.State.html#getNegotiatedProtocol"><span class="hs-identifier hs-type">getNegotiatedProtocol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="getNegotiatedProtocol"><span class="annot"><span class="annottext">getNegotiatedProtocol :: TLSSt (Maybe ByteString)
</span><a href="Network.TLS.State.html#getNegotiatedProtocol"><span class="hs-identifier hs-var hs-var">getNegotiatedProtocol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe ByteString) -&gt; TLSSt (Maybe ByteString)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe ByteString
</span><a href="Network.TLS.State.html#stNegotiatedProtocol"><span class="hs-identifier hs-var">stNegotiatedProtocol</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Network.TLS.State.html#setClientALPNSuggest"><span class="hs-identifier hs-type">setClientALPNSuggest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span id="setClientALPNSuggest"><span class="annot"><span class="annottext">setClientALPNSuggest :: [ByteString] -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setClientALPNSuggest"><span class="hs-identifier hs-var hs-var">setClientALPNSuggest</span></a></span></span><span> </span><span id="local-6989586621679185292"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679185292"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185293"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185293"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185293"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientALPNSuggest"><span class="hs-identifier hs-var">stClientALPNSuggest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185292"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Network.TLS.State.html#getClientALPNSuggest"><span class="hs-identifier hs-type">getClientALPNSuggest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span id="getClientALPNSuggest"><span class="annot"><span class="annottext">getClientALPNSuggest :: TLSSt (Maybe [ByteString])
</span><a href="Network.TLS.State.html#getClientALPNSuggest"><span class="hs-identifier hs-var hs-var">getClientALPNSuggest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe [ByteString]) -&gt; TLSSt (Maybe [ByteString])
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe [ByteString]
</span><a href="Network.TLS.State.html#stClientALPNSuggest"><span class="hs-identifier hs-var">stClientALPNSuggest</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Network.TLS.State.html#setClientEcPointFormatSuggest"><span class="hs-identifier hs-type">setClientEcPointFormatSuggest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Extension.html#EcPointFormat"><span class="hs-identifier hs-type">EcPointFormat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span id="setClientEcPointFormatSuggest"><span class="annot"><span class="annottext">setClientEcPointFormatSuggest :: [EcPointFormat] -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setClientEcPointFormatSuggest"><span class="hs-identifier hs-var hs-var">setClientEcPointFormatSuggest</span></a></span></span><span> </span><span id="local-6989586621679185294"><span class="annot"><span class="annottext">[EcPointFormat]
</span><a href="#local-6989586621679185294"><span class="hs-identifier hs-var">epf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185295"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185295"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185295"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientEcPointFormatSuggest"><span class="hs-identifier hs-var">stClientEcPointFormatSuggest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185294"><span class="hs-identifier hs-type">epf</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Network.TLS.State.html#getClientEcPointFormatSuggest"><span class="hs-identifier hs-type">getClientEcPointFormatSuggest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Extension.html#EcPointFormat"><span class="hs-identifier hs-type">EcPointFormat</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span id="getClientEcPointFormatSuggest"><span class="annot"><span class="annottext">getClientEcPointFormatSuggest :: TLSSt (Maybe [EcPointFormat])
</span><a href="Network.TLS.State.html#getClientEcPointFormatSuggest"><span class="hs-identifier hs-var hs-var">getClientEcPointFormatSuggest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe [EcPointFormat])
-&gt; TLSSt (Maybe [EcPointFormat])
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe [EcPointFormat]
</span><a href="Network.TLS.State.html#stClientEcPointFormatSuggest"><span class="hs-identifier hs-var">stClientEcPointFormatSuggest</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Network.TLS.State.html#setClientCertificateChain"><span class="hs-identifier hs-type">setClientCertificateChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span id="setClientCertificateChain"><span class="annot"><span class="annottext">setClientCertificateChain :: CertificateChain -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setClientCertificateChain"><span class="hs-identifier hs-var hs-var">setClientCertificateChain</span></a></span></span><span> </span><span id="local-6989586621679185296"><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679185296"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185297"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185297"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185297"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientCertificateChain"><span class="hs-identifier hs-var">stClientCertificateChain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185296"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Network.TLS.State.html#getClientCertificateChain"><span class="hs-identifier hs-type">getClientCertificateChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span id="getClientCertificateChain"><span class="annot"><span class="annottext">getClientCertificateChain :: TLSSt (Maybe CertificateChain)
</span><a href="Network.TLS.State.html#getClientCertificateChain"><span class="hs-identifier hs-var hs-var">getClientCertificateChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe CertificateChain)
-&gt; TLSSt (Maybe CertificateChain)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe CertificateChain
</span><a href="Network.TLS.State.html#stClientCertificateChain"><span class="hs-identifier hs-var">stClientCertificateChain</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Network.TLS.State.html#setClientSNI"><span class="hs-identifier hs-type">setClientSNI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span id="setClientSNI"><span class="annot"><span class="annottext">setClientSNI :: HostName -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setClientSNI"><span class="hs-identifier hs-var hs-var">setClientSNI</span></a></span></span><span> </span><span id="local-6989586621679185298"><span class="annot"><span class="annottext">HostName
</span><a href="#local-6989586621679185298"><span class="hs-identifier hs-var">hn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185299"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185299"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185299"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientSNI"><span class="hs-identifier hs-var">stClientSNI</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185298"><span class="hs-identifier hs-type">hn</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Network.TLS.State.html#getClientSNI"><span class="hs-identifier hs-type">getClientSNI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HostName</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span id="getClientSNI"><span class="annot"><span class="annottext">getClientSNI :: TLSSt (Maybe HostName)
</span><a href="Network.TLS.State.html#getClientSNI"><span class="hs-identifier hs-var hs-var">getClientSNI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe HostName) -&gt; TLSSt (Maybe HostName)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe HostName
</span><a href="Network.TLS.State.html#stClientSNI"><span class="hs-identifier hs-var">stClientSNI</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Network.TLS.State.html#getVerifiedData"><span class="hs-identifier hs-type">getVerifiedData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-246"></span><span id="getVerifiedData"><span class="annot"><span class="annottext">getVerifiedData :: Role -&gt; TLSSt ByteString
</span><a href="Network.TLS.State.html#getVerifiedData"><span class="hs-identifier hs-var hs-var">getVerifiedData</span></a></span></span><span> </span><span id="local-6989586621679185300"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185300"><span class="hs-identifier hs-var">client</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; ByteString) -&gt; TLSSt ByteString
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679185300"><span class="hs-identifier hs-var">client</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; ByteString
</span><a href="Network.TLS.State.html#stClientVerifiedData"><span class="hs-identifier hs-var">stClientVerifiedData</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; ByteString
</span><a href="Network.TLS.State.html#stServerVerifiedData"><span class="hs-identifier hs-var">stServerVerifiedData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Network.TLS.State.html#isClientContext"><span class="hs-identifier hs-type">isClientContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>
</span><span id="line-249"></span><span id="isClientContext"><span class="annot"><span class="annottext">isClientContext :: TLSSt Role
</span><a href="Network.TLS.State.html#isClientContext"><span class="hs-identifier hs-var hs-var">isClientContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Role) -&gt; TLSSt Role
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Role
</span><a href="Network.TLS.State.html#stClientContext"><span class="hs-identifier hs-var">stClientContext</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Network.TLS.State.html#genRandom"><span class="hs-identifier hs-type">genRandom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-252"></span><span id="genRandom"><span class="annot"><span class="annottext">genRandom :: Int -&gt; TLSSt ByteString
</span><a href="Network.TLS.State.html#genRandom"><span class="hs-identifier hs-var hs-var">genRandom</span></a></span></span><span> </span><span id="local-6989586621679185302"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185302"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">MonadPseudoRandom StateRNG ByteString -&gt; TLSSt ByteString
forall a. MonadPseudoRandom StateRNG a -&gt; TLSSt a
</span><a href="Network.TLS.State.html#withRNG"><span class="hs-identifier hs-var">withRNG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MonadPseudoRandom StateRNG ByteString
forall byteArray.
ByteArray byteArray =&gt;
Int -&gt; MonadPseudoRandom StateRNG byteArray
forall (m :: * -&gt; *) byteArray.
(MonadRandom m, ByteArray byteArray) =&gt;
Int -&gt; m byteArray
</span><span class="hs-identifier hs-var">getRandomBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185302"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span id="local-6989586621679184985"><span class="annot"><a href="Network.TLS.State.html#withRNG"><span class="hs-identifier hs-type">withRNG</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPseudoRandom</span></span><span> </span><span class="annot"><a href="Network.TLS.RNG.html#StateRNG"><span class="hs-identifier hs-type">StateRNG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679184985"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-256"></span><span id="withRNG"><span class="annot"><span class="annottext">withRNG :: forall a. MonadPseudoRandom StateRNG a -&gt; TLSSt a
</span><a href="Network.TLS.State.html#withRNG"><span class="hs-identifier hs-var hs-var">withRNG</span></a></span></span><span> </span><span id="local-6989586621679185309"><span class="annot"><span class="annottext">MonadPseudoRandom StateRNG a
</span><a href="#local-6989586621679185309"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621679185310"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185310"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TLSSt TLSState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185311"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185311"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679185312"><span class="annot"><span class="annottext">StateRNG
</span><a href="#local-6989586621679185312"><span class="hs-identifier hs-var">rng'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateRNG -&gt; MonadPseudoRandom StateRNG a -&gt; (a, StateRNG)
forall a. StateRNG -&gt; MonadPseudoRandom StateRNG a -&gt; (a, StateRNG)
</span><a href="Network.TLS.RNG.html#withTLSRNG"><span class="hs-identifier hs-var">withTLSRNG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TLSState -&gt; StateRNG
</span><a href="Network.TLS.State.html#stRandomGen"><span class="hs-identifier hs-var">stRandomGen</span></a></span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185310"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MonadPseudoRandom StateRNG a
</span><a href="#local-6989586621679185309"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">TLSState -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185310"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stRandomGen"><span class="hs-identifier hs-var">stRandomGen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185312"><span class="hs-identifier hs-type">rng'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; TLSSt a
forall a. a -&gt; TLSSt a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185311"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Network.TLS.State.html#setExporterMasterSecret"><span class="hs-identifier hs-type">setExporterMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span id="setExporterMasterSecret"><span class="annot"><span class="annottext">setExporterMasterSecret :: ByteString -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setExporterMasterSecret"><span class="hs-identifier hs-var hs-var">setExporterMasterSecret</span></a></span></span><span> </span><span id="local-6989586621679185313"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679185313"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185314"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185314"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185314"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stExporterMasterSecret"><span class="hs-identifier hs-var">stExporterMasterSecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679185313"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Network.TLS.State.html#getExporterMasterSecret"><span class="hs-identifier hs-type">getExporterMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span id="getExporterMasterSecret"><span class="annot"><span class="annottext">getExporterMasterSecret :: TLSSt (Maybe ByteString)
</span><a href="Network.TLS.State.html#getExporterMasterSecret"><span class="hs-identifier hs-var hs-var">getExporterMasterSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe ByteString) -&gt; TLSSt (Maybe ByteString)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe ByteString
</span><a href="Network.TLS.State.html#stExporterMasterSecret"><span class="hs-identifier hs-var">stExporterMasterSecret</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Network.TLS.State.html#setTLS13KeyShare"><span class="hs-identifier hs-type">setTLS13KeyShare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#KeyShare"><span class="hs-identifier hs-type">KeyShare</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span id="setTLS13KeyShare"><span class="annot"><span class="annottext">setTLS13KeyShare :: Maybe KeyShare -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setTLS13KeyShare"><span class="hs-identifier hs-var hs-var">setTLS13KeyShare</span></a></span></span><span> </span><span id="local-6989586621679185315"><span class="annot"><span class="annottext">Maybe KeyShare
</span><a href="#local-6989586621679185315"><span class="hs-identifier hs-var">mks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185316"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185316"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185316"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stTLS13KeyShare"><span class="hs-identifier hs-var">stTLS13KeyShare</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185315"><span class="hs-identifier hs-type">mks</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Network.TLS.State.html#getTLS13KeyShare"><span class="hs-identifier hs-type">getTLS13KeyShare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#KeyShare"><span class="hs-identifier hs-type">KeyShare</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span id="getTLS13KeyShare"><span class="annot"><span class="annottext">getTLS13KeyShare :: TLSSt (Maybe KeyShare)
</span><a href="Network.TLS.State.html#getTLS13KeyShare"><span class="hs-identifier hs-var hs-var">getTLS13KeyShare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe KeyShare) -&gt; TLSSt (Maybe KeyShare)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe KeyShare
</span><a href="Network.TLS.State.html#stTLS13KeyShare"><span class="hs-identifier hs-var">stTLS13KeyShare</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><a href="Network.TLS.State.html#setTLS13PreSharedKey"><span class="hs-identifier hs-type">setTLS13PreSharedKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#PreSharedKey"><span class="hs-identifier hs-type">PreSharedKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="setTLS13PreSharedKey"><span class="annot"><span class="annottext">setTLS13PreSharedKey :: Maybe PreSharedKey -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setTLS13PreSharedKey"><span class="hs-identifier hs-var hs-var">setTLS13PreSharedKey</span></a></span></span><span> </span><span id="local-6989586621679185317"><span class="annot"><span class="annottext">Maybe PreSharedKey
</span><a href="#local-6989586621679185317"><span class="hs-identifier hs-var">mpsk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185318"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185318"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185318"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stTLS13PreSharedKey"><span class="hs-identifier hs-var">stTLS13PreSharedKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185317"><span class="hs-identifier hs-type">mpsk</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Network.TLS.State.html#getTLS13PreSharedKey"><span class="hs-identifier hs-type">getTLS13PreSharedKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#PreSharedKey"><span class="hs-identifier hs-type">PreSharedKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="getTLS13PreSharedKey"><span class="annot"><span class="annottext">getTLS13PreSharedKey :: TLSSt (Maybe PreSharedKey)
</span><a href="Network.TLS.State.html#getTLS13PreSharedKey"><span class="hs-identifier hs-var hs-var">getTLS13PreSharedKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe PreSharedKey) -&gt; TLSSt (Maybe PreSharedKey)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe PreSharedKey
</span><a href="Network.TLS.State.html#stTLS13PreSharedKey"><span class="hs-identifier hs-var">stTLS13PreSharedKey</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><a href="Network.TLS.State.html#setTLS13HRR"><span class="hs-identifier hs-type">setTLS13HRR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="setTLS13HRR"><span class="annot"><span class="annottext">setTLS13HRR :: Bool -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setTLS13HRR"><span class="hs-identifier hs-var hs-var">setTLS13HRR</span></a></span></span><span> </span><span id="local-6989586621679185319"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185319"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185320"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185320"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185320"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stTLS13HRR"><span class="hs-identifier hs-var">stTLS13HRR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185319"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Network.TLS.State.html#getTLS13HRR"><span class="hs-identifier hs-type">getTLS13HRR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-284"></span><span id="getTLS13HRR"><span class="annot"><span class="annottext">getTLS13HRR :: TLSSt Bool
</span><a href="Network.TLS.State.html#getTLS13HRR"><span class="hs-identifier hs-var hs-var">getTLS13HRR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Bool) -&gt; TLSSt Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stTLS13HRR"><span class="hs-identifier hs-var">stTLS13HRR</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Network.TLS.State.html#setTLS13Cookie"><span class="hs-identifier hs-type">setTLS13Cookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span id="setTLS13Cookie"><span class="annot"><span class="annottext">setTLS13Cookie :: Maybe Cookie -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setTLS13Cookie"><span class="hs-identifier hs-var hs-var">setTLS13Cookie</span></a></span></span><span> </span><span id="local-6989586621679185321"><span class="annot"><span class="annottext">Maybe Cookie
</span><a href="#local-6989586621679185321"><span class="hs-identifier hs-var">mcookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185322"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185322"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185322"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stTLS13Cookie"><span class="hs-identifier hs-var">stTLS13Cookie</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185321"><span class="hs-identifier hs-type">mcookie</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Network.TLS.State.html#getTLS13Cookie"><span class="hs-identifier hs-type">getTLS13Cookie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#Cookie"><span class="hs-identifier hs-type">Cookie</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span id="getTLS13Cookie"><span class="annot"><span class="annottext">getTLS13Cookie :: TLSSt (Maybe Cookie)
</span><a href="Network.TLS.State.html#getTLS13Cookie"><span class="hs-identifier hs-var hs-var">getTLS13Cookie</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Maybe Cookie) -&gt; TLSSt (Maybe Cookie)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Maybe Cookie
</span><a href="Network.TLS.State.html#stTLS13Cookie"><span class="hs-identifier hs-var">stTLS13Cookie</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Network.TLS.State.html#setClientSupportsPHA"><span class="hs-identifier hs-type">setClientSupportsPHA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="setClientSupportsPHA"><span class="annot"><span class="annottext">setClientSupportsPHA :: Bool -&gt; TLSSt ()
</span><a href="Network.TLS.State.html#setClientSupportsPHA"><span class="hs-identifier hs-var hs-var">setClientSupportsPHA</span></a></span></span><span> </span><span id="local-6989586621679185323"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679185323"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; TLSState) -&gt; TLSSt ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185324"><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185324"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TLSState
</span><a href="#local-6989586621679185324"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.State.html#stClientSupportsPHA"><span class="hs-identifier hs-var">stClientSupportsPHA</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679185323"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Network.TLS.State.html#getClientSupportsPHA"><span class="hs-identifier hs-type">getClientSupportsPHA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.State.html#TLSSt"><span class="hs-identifier hs-type">TLSSt</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-296"></span><span id="getClientSupportsPHA"><span class="annot"><span class="annottext">getClientSupportsPHA :: TLSSt Bool
</span><a href="Network.TLS.State.html#getClientSupportsPHA"><span class="hs-identifier hs-var hs-var">getClientSupportsPHA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TLSState -&gt; Bool) -&gt; TLSSt Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">TLSState -&gt; Bool
</span><a href="Network.TLS.State.html#stClientSupportsPHA"><span class="hs-identifier hs-var">stClientSupportsPHA</span></a></span><span>
</span><span id="line-297"></span></pre></body></html>