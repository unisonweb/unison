<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      : Network.TLS</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Native Haskell TLS and SSL protocol implementation for server and</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- client.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- This provides a high-level implementation of a sensitive security</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- protocol, eliminating a common set of security issues through the</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- use of the advanced type system, high level constructions and</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- common Haskell features.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Currently implement the SSL3.0, TLS1.0, TLS1.1, TLS1.2 and TLS 1.3</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- protocol, and support RSA and Ephemeral (Elliptic curve and</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- regular) Diffie Hellman key exchanges, and many extensions.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Some debug tools linked with tls, are available through the</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- http://hackage.haskell.org/package/tls-debug/.</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Basic APIs</span></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier">Context</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextNew"><span class="hs-identifier">contextNew</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.html#handshake"><span class="hs-identifier">handshake</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#sendData"><span class="hs-identifier">sendData</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#recvData"><span class="hs-identifier">recvData</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#bye"><span class="hs-identifier">bye</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Exceptions</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- $exceptions</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Backend abstraction</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html#HasBackend"><span class="hs-identifier">HasBackend</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html#Backend"><span class="hs-identifier">Backend</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parameters</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-comment">-- intentionally hide the internal methods even haddock warns.</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#TLSParams"><span class="hs-identifier">TLSParams</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ClientParams"><span class="hs-identifier">ClientParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#defaultParamsClient"><span class="hs-identifier">defaultParamsClient</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ServerParams"><span class="hs-identifier">ServerParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Shared</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#Shared"><span class="hs-identifier">Shared</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Hooks</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ClientHooks"><span class="hs-identifier">ClientHooks</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#OnCertificateRequest"><span class="hs-identifier">OnCertificateRequest</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#OnServerCertificate"><span class="hs-identifier">OnServerCertificate</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#ServerHooks"><span class="hs-identifier">ServerHooks</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Measurement.html#Measurement"><span class="hs-identifier">Measurement</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Supported</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#Supported"><span class="hs-identifier">Supported</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Debug parameters</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#DebugParams"><span class="hs-identifier">DebugParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Shared parameters</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Credentials</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#Credentials"><span class="hs-identifier">Credentials</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#Credential"><span class="hs-identifier">Credential</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#credentialLoadX509"><span class="hs-identifier">credentialLoadX509</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#credentialLoadX509FromMemory"><span class="hs-identifier">credentialLoadX509FromMemory</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#credentialLoadX509Chain"><span class="hs-identifier">credentialLoadX509Chain</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html#credentialLoadX509ChainFromMemory"><span class="hs-identifier">credentialLoadX509ChainFromMemory</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Session manager</span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Session.html#SessionManager"><span class="hs-identifier">SessionManager</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Session.html#noSessionManager"><span class="hs-identifier">noSessionManager</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#SessionID"><span class="hs-identifier">SessionID</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#SessionData"><span class="hs-identifier">SessionData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#SessionFlag"><span class="hs-identifier">SessionFlag</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#TLS13TicketInfo"><span class="hs-identifier">TLS13TicketInfo</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Validation Cache</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationCache</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationCacheQueryCallback</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationCacheAddCallback</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationCacheResult</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exceptionValidationCache</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** For 'Supported'</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier">Version</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#Compression"><span class="hs-identifier">Compression</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#nullCompression"><span class="hs-identifier">nullCompression</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier">HashAndSignatureAlgorithm</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAlgorithm"><span class="hs-identifier">HashAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#SignatureAlgorithm"><span class="hs-identifier">SignatureAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier">Group</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#EMSMode"><span class="hs-identifier">EMSMode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** For parameters and hooks</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHParams"><span class="hs-identifier">DHParams</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHPublic"><span class="hs-identifier">DHPublic</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html#GroupUsage"><span class="hs-identifier">GroupUsage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.X509.html#CertificateUsage"><span class="hs-identifier">CertificateUsage</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.X509.html#CertificateRejectReason"><span class="hs-identifier">CertificateRejectReason</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#CertificateType"><span class="hs-identifier">CertificateType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HostName</span></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Extension.html#MaxFragmentEnum"><span class="hs-identifier">MaxFragmentEnum</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Advanced APIs</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Backend</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#ctxConnection"><span class="hs-identifier">ctxConnection</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#contextFlush"><span class="hs-identifier">contextFlush</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#contextClose"><span class="hs-identifier">contextClose</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Information gathering</span></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Information"><span class="hs-identifier">Information</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#contextGetInformation"><span class="hs-identifier">contextGetInformation</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier">ClientRandom</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier">ServerRandom</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#unClientRandom"><span class="hs-identifier">unClientRandom</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#unServerRandom"><span class="hs-identifier">unServerRandom</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier">HandshakeMode13</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.html#getClientCertificateChain"><span class="hs-identifier">getClientCertificateChain</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Negotiated</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#getNegotiatedProtocol"><span class="hs-identifier">getNegotiatedProtocol</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#getClientSNI"><span class="hs-identifier">getClientSNI</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Post-handshake actions</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#updateKey"><span class="hs-identifier">updateKey</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#KeyUpdateRequest"><span class="hs-identifier">KeyUpdateRequest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.PostHandshake.html#requestCertificate"><span class="hs-identifier">requestCertificate</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#getFinished"><span class="hs-identifier">getFinished</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#getPeerFinished"><span class="hs-identifier">getPeerFinished</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Modifying hooks in context</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Hooks.html#Hooks"><span class="hs-identifier">Hooks</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#contextModifyHooks"><span class="hs-identifier">contextModifyHooks</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier">Handshake</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextHookSetHandshakeRecv"><span class="hs-identifier">contextHookSetHandshakeRecv</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct13.html#Handshake13"><span class="hs-identifier">Handshake13</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextHookSetHandshake13Recv"><span class="hs-identifier">contextHookSetHandshake13Recv</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextHookSetCertificateRecv"><span class="hs-identifier">contextHookSetCertificateRecv</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Hooks.html#Logging"><span class="hs-identifier">Logging</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier">Header</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ProtocolType"><span class="hs-identifier">ProtocolType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextHookSetLogging"><span class="hs-identifier">contextHookSetLogging</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Errors and exceptions</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Errors</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier">TLSError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier">KxError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier">AlertDescription</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Exceptions</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSException"><span class="hs-identifier">TLSException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Raw types</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Compressions class</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#CompressionC"><span class="hs-identifier">CompressionC</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#CompressionID"><span class="hs-identifier">CompressionID</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Crypto Key</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PubKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrivKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Ciphers &amp; Predefined ciphers</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html"><span class="hs-identifier">Network.TLS.Cipher</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Deprecated</span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Core.html#recvData%27"><span class="hs-identifier">recvData'</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextNewOnHandle"><span class="hs-identifier">contextNewOnHandle</span></a></span><span class="hs-cpp">
#ifdef INCLUDE_NETWORK
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Context.html#contextNewOnSocket"><span class="hs-identifier">contextNewOnSocket</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.html#Bytes"><span class="hs-identifier">Bytes</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationChecks</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationHooks</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html"><span class="hs-identifier">Network.TLS.Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Backend.html#Backend"><span class="hs-identifier">Backend</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Backend.html#HasBackend"><span class="hs-identifier">HasBackend</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html"><span class="hs-identifier">Network.TLS.Cipher</span></a></span><span>
</span><span id="line-169"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html"><span class="hs-identifier">Network.TLS.Compression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Compression.html#CompressionC"><span class="hs-identifier">CompressionC</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#Compression"><span class="hs-identifier">Compression</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#nullCompression"><span class="hs-identifier">nullCompression</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Context.html"><span class="hs-identifier">Network.TLS.Context</span></a></span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Core.html"><span class="hs-identifier">Network.TLS.Core</span></a></span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Credentials.html"><span class="hs-identifier">Network.TLS.Credentials</span></a></span><span>
</span><span id="line-173"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html"><span class="hs-identifier">Network.TLS.Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Crypto.html#KxError"><span class="hs-identifier">KxError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHParams"><span class="hs-identifier">DHParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHPublic"><span class="hs-identifier">DHPublic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier">Group</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html"><span class="hs-identifier">Network.TLS.Handshake.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier">HandshakeMode13</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Hooks.html"><span class="hs-identifier">Network.TLS.Hooks</span></a></span><span>
</span><span id="line-176"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Measurement.html"><span class="hs-identifier">Network.TLS.Measurement</span></a></span><span>
</span><span id="line-177"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Parameters.html"><span class="hs-identifier">Network.TLS.Parameters</span></a></span><span>
</span><span id="line-178"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Session.html"><span class="hs-identifier">Network.TLS.Session</span></a></span><span>
</span><span id="line-179"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Network.TLS.State.html"><span class="hs-identifier">Network.TLS.State</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-180"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html"><span class="hs-identifier">Network.TLS.Struct</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier">TLSError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSException"><span class="hs-identifier">TLSException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier">HashAndSignatureAlgorithm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAlgorithm"><span class="hs-identifier">HashAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#SignatureAlgorithm"><span class="hs-identifier">SignatureAlgorithm</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier">Header</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ProtocolType"><span class="hs-identifier">ProtocolType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#CertificateType"><span class="hs-identifier">CertificateType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier">AlertDescription</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier">ClientRandom</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier">ServerRandom</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier">Handshake</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct13.html"><span class="hs-identifier">Network.TLS.Struct13</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.TLS.Struct13.html#Handshake13"><span class="hs-identifier">Handshake13</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Types.html"><span class="hs-identifier">Network.TLS.Types</span></a></span><span>
</span><span id="line-188"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.X509.html"><span class="hs-identifier">Network.TLS.X509</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-191"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PubKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrivKey</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509.Validation</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HostName</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">Bytes</span><span> </span><span class="hs-pragma">&quot;Use Data.ByteString.Bytestring instead of Bytes.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-195"></span><span class="hs-keyword">type</span><span> </span><span id="Bytes"><span class="annot"><a href="Network.TLS.html#Bytes"><span class="hs-identifier hs-var">Bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Getting certificates from a client, if any.</span><span>
</span><span id="line-198"></span><span class="hs-comment">--   Note that the certificates are not sent by a client</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   on resumption even if client authentication is required.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--   So, this API would be replaced by the one which can treat</span><span>
</span><span id="line-201"></span><span class="hs-comment">--   both cases of full-negotiation and resumption.</span><span>
</span><span id="line-202"></span><span class="annot"><a href="Network.TLS.html#getClientCertificateChain"><span class="hs-identifier hs-type">getClientCertificateChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Context.Internal.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span id="getClientCertificateChain"><span class="annot"><span class="annottext">getClientCertificateChain :: Context -&gt; IO (Maybe CertificateChain)
</span><a href="Network.TLS.html#getClientCertificateChain"><span class="hs-identifier hs-var hs-var">getClientCertificateChain</span></a></span></span><span> </span><span id="local-6989586621679197556"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197556"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; TLSSt (Maybe CertificateChain) -&gt; IO (Maybe CertificateChain)
forall a. Context -&gt; TLSSt a -&gt; IO a
</span><a href="Network.TLS.Context.Internal.html#usingState_"><span class="hs-identifier hs-var">usingState_</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679197556"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">TLSSt (Maybe CertificateChain)
</span><a href="Network.TLS.State.html#getClientCertificateChain"><span class="hs-identifier hs-var">S.getClientCertificateChain</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><span class="hs-comment">{- $exceptions
    Since 1.8.0, this library only throws exceptions of type 'TLSException'.
    In the common case where the chosen backend is socket, 'IOException'
    may be thrown as well. This happens because the backend for sockets,
    opaque to most modules in the @tls@ library, throws those exceptions.
-}</span></span><span>
</span><span id="line-211"></span></pre></body></html>