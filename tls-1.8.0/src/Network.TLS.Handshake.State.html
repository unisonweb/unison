<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      : Network.TLS.Handshake.State</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.Handshake.State</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier">HandshakeState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigest"><span class="hs-identifier">HandshakeDigest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier">HandshakeMode13</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Status"><span class="hs-identifier">RTT0Status</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#CertReqCBdata"><span class="hs-identifier">CertReqCBdata</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier">HandshakeM</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#newEmptyHandshake"><span class="hs-identifier">newEmptyHandshake</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#runHandshake"><span class="hs-identifier">runHandshake</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * key accessors</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setPublicKey"><span class="hs-identifier">setPublicKey</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setPublicPrivateKeys"><span class="hs-identifier">setPublicPrivateKeys</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getLocalPublicPrivateKeys"><span class="hs-identifier">getLocalPublicPrivateKeys</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getRemotePublicKey"><span class="hs-identifier">getRemotePublicKey</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerDHParams"><span class="hs-identifier">setServerDHParams</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getServerDHParams"><span class="hs-identifier">getServerDHParams</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerECDHParams"><span class="hs-identifier">setServerECDHParams</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getServerECDHParams"><span class="hs-identifier">getServerECDHParams</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setDHPrivate"><span class="hs-identifier">setDHPrivate</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getDHPrivate"><span class="hs-identifier">getDHPrivate</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setGroupPrivate"><span class="hs-identifier">setGroupPrivate</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getGroupPrivate"><span class="hs-identifier">getGroupPrivate</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * cert accessors</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setClientCertSent"><span class="hs-identifier">setClientCertSent</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getClientCertSent"><span class="hs-identifier">getClientCertSent</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqSent"><span class="hs-identifier">setCertReqSent</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqSent"><span class="hs-identifier">getCertReqSent</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setClientCertChain"><span class="hs-identifier">setClientCertChain</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getClientCertChain"><span class="hs-identifier">getClientCertChain</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqToken"><span class="hs-identifier">setCertReqToken</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqToken"><span class="hs-identifier">getCertReqToken</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqCBdata"><span class="hs-identifier">setCertReqCBdata</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqCBdata"><span class="hs-identifier">getCertReqCBdata</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqSigAlgsCert"><span class="hs-identifier">setCertReqSigAlgsCert</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqSigAlgsCert"><span class="hs-identifier">getCertReqSigAlgsCert</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * digest accessors</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#addHandshakeMessage"><span class="hs-identifier">addHandshakeMessage</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#updateHandshakeDigest"><span class="hs-identifier">updateHandshakeDigest</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeMessages"><span class="hs-identifier">getHandshakeMessages</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeMessagesRev"><span class="hs-identifier">getHandshakeMessagesRev</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeDigest"><span class="hs-identifier">getHandshakeDigest</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#foldHandshakeDigest"><span class="hs-identifier">foldHandshakeDigest</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- * master secret</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setMasterSecret"><span class="hs-identifier">setMasterSecret</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setMasterSecretFromPre"><span class="hs-identifier">setMasterSecretFromPre</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * misc accessor</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getPendingCipher"><span class="hs-identifier">getPendingCipher</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerHelloParameters"><span class="hs-identifier">setServerHelloParameters</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setExtendedMasterSec"><span class="hs-identifier">setExtendedMasterSec</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getExtendedMasterSec"><span class="hs-identifier">getExtendedMasterSec</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setNegotiatedGroup"><span class="hs-identifier">setNegotiatedGroup</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getNegotiatedGroup"><span class="hs-identifier">getNegotiatedGroup</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13HandshakeMode"><span class="hs-identifier">setTLS13HandshakeMode</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13HandshakeMode"><span class="hs-identifier">getTLS13HandshakeMode</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13RTT0Status"><span class="hs-identifier">setTLS13RTT0Status</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13RTT0Status"><span class="hs-identifier">getTLS13RTT0Status</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13EarlySecret"><span class="hs-identifier">setTLS13EarlySecret</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13EarlySecret"><span class="hs-identifier">getTLS13EarlySecret</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13ResumptionSecret"><span class="hs-identifier">setTLS13ResumptionSecret</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13ResumptionSecret"><span class="hs-identifier">getTLS13ResumptionSecret</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCCS13Sent"><span class="hs-identifier">setCCS13Sent</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCCS13Sent"><span class="hs-identifier">getCCS13Sent</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Util.html"><span class="hs-identifier">Network.TLS.Util</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html"><span class="hs-identifier">Network.TLS.Struct</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html"><span class="hs-identifier">Network.TLS.Record.State</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html"><span class="hs-identifier">Network.TLS.Packet</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html"><span class="hs-identifier">Network.TLS.Crypto</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html"><span class="hs-identifier">Network.TLS.Cipher</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html"><span class="hs-identifier">Network.TLS.Compression</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Types.html"><span class="hs-identifier">Network.TLS.Types</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span> </span><span id="HandshakeKeyState"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeKeyState"><span class="hs-identifier hs-var">HandshakeKeyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HandshakeKeyState"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeKeyState"><span class="hs-identifier hs-var">HandshakeKeyState</span></a></span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="hksRemotePublicKey"><span class="annot"><span class="annottext">HandshakeKeyState -&gt; Maybe PubKey
</span><a href="Network.TLS.Handshake.State.html#hksRemotePublicKey"><span class="hs-identifier hs-var hs-var">hksRemotePublicKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hksLocalPublicPrivateKeys"><span class="annot"><span class="annottext">HandshakeKeyState -&gt; Maybe (PubKey, PrivKey)
</span><a href="Network.TLS.Handshake.State.html#hksLocalPublicPrivateKeys"><span class="hs-identifier hs-var hs-var">hksLocalPublicPrivateKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679182826"><span id="local-6989586621679182835"><span id="local-6989586621679182839"><span class="annot"><span class="annottext">Int -&gt; HandshakeKeyState -&gt; ShowS
[HandshakeKeyState] -&gt; ShowS
HandshakeKeyState -&gt; String
(Int -&gt; HandshakeKeyState -&gt; ShowS)
-&gt; (HandshakeKeyState -&gt; String)
-&gt; ([HandshakeKeyState] -&gt; ShowS)
-&gt; Show HandshakeKeyState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HandshakeKeyState -&gt; ShowS
showsPrec :: Int -&gt; HandshakeKeyState -&gt; ShowS
$cshow :: HandshakeKeyState -&gt; String
show :: HandshakeKeyState -&gt; String
$cshowList :: [HandshakeKeyState] -&gt; ShowS
showList :: [HandshakeKeyState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">data</span><span> </span><span id="HandshakeDigest"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigest"><span class="hs-identifier hs-var">HandshakeDigest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HandshakeMessages"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-var">HandshakeMessages</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span id="HandshakeDigestContext"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-var">HandshakeDigestContext</span></a></span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-96"></span><span>                     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679182849"><span id="local-6989586621679182858"><span id="local-6989586621679182862"><span class="annot"><span class="annottext">Int -&gt; HandshakeDigest -&gt; ShowS
[HandshakeDigest] -&gt; ShowS
HandshakeDigest -&gt; String
(Int -&gt; HandshakeDigest -&gt; ShowS)
-&gt; (HandshakeDigest -&gt; String)
-&gt; ([HandshakeDigest] -&gt; ShowS)
-&gt; Show HandshakeDigest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HandshakeDigest -&gt; ShowS
showsPrec :: Int -&gt; HandshakeDigest -&gt; ShowS
$cshow :: HandshakeDigest -&gt; String
show :: HandshakeDigest -&gt; String
$cshowList :: [HandshakeDigest] -&gt; ShowS
showList :: [HandshakeDigest] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">data</span><span> </span><span id="HandshakeState"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-var">HandshakeState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HandshakeState"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-var">HandshakeState</span></a></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="hstClientVersion"><span class="annot"><span class="annottext">HandshakeState -&gt; Version
</span><a href="Network.TLS.Handshake.State.html#hstClientVersion"><span class="hs-identifier hs-var hs-var">hstClientVersion</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstClientRandom"><span class="annot"><span class="annottext">HandshakeState -&gt; ClientRandom
</span><a href="Network.TLS.Handshake.State.html#hstClientRandom"><span class="hs-identifier hs-var hs-var">hstClientRandom</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstServerRandom"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerRandom
</span><a href="Network.TLS.Handshake.State.html#hstServerRandom"><span class="hs-identifier hs-var hs-var">hstServerRandom</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstMasterSecret"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstMasterSecret"><span class="hs-identifier hs-var hs-var">hstMasterSecret</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstKeyState"><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeKeyState
</span><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var hs-var">hstKeyState</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeKeyState"><span class="hs-identifier hs-type">HandshakeKeyState</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstServerDHParams"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerDHParams"><span class="hs-identifier hs-var hs-var">hstServerDHParams</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstDHPrivate"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe DHPrivate
</span><a href="Network.TLS.Handshake.State.html#hstDHPrivate"><span class="hs-identifier hs-var hs-var">hstDHPrivate</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHPrivate"><span class="hs-identifier hs-type">DHPrivate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstServerECDHParams"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerECDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerECDHParams"><span class="hs-identifier hs-var hs-var">hstServerECDHParams</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstGroupPrivate"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe GroupPrivate
</span><a href="Network.TLS.Handshake.State.html#hstGroupPrivate"><span class="hs-identifier hs-var hs-var">hstGroupPrivate</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstHandshakeDigest"><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var hs-var">hstHandshakeDigest</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigest"><span class="hs-identifier hs-type">HandshakeDigest</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstHandshakeMessages"><span class="annot"><span class="annottext">HandshakeState -&gt; [ByteString]
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var hs-var">hstHandshakeMessages</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstCertReqToken"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstCertReqToken"><span class="hs-identifier hs-var hs-var">hstCertReqToken</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Set to Just-value when a TLS13 certificate request is received</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstCertReqCBdata"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe CertReqCBdata
</span><a href="Network.TLS.Handshake.State.html#hstCertReqCBdata"><span class="hs-identifier hs-var hs-var">hstCertReqCBdata</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#CertReqCBdata"><span class="hs-identifier hs-type">CertReqCBdata</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Set to Just-value when a certificate request is received</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstCertReqSigAlgsCert"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe [HashAndSignatureAlgorithm]
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSigAlgsCert"><span class="hs-identifier hs-var hs-var">hstCertReqSigAlgsCert</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-comment">-- ^ In TLS 1.3, these are separate from the certificate</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-comment">-- issuer signature algorithm hints in the callback data.</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-comment">-- In TLS 1.2 the same list is overloaded for both purposes.</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-comment">-- Not present in TLS 1.1 and earlier</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstClientCertSent"><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstClientCertSent"><span class="hs-identifier hs-var hs-var">hstClientCertSent</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Set to true when a client certificate chain was sent</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstCertReqSent"><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSent"><span class="hs-identifier hs-var hs-var">hstCertReqSent</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-comment">-- ^ Set to true when a certificate request was sent.  This applies</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-comment">-- only to requests sent during handshake (not post-handshake).</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstClientCertChain"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe CertificateChain
</span><a href="Network.TLS.Handshake.State.html#hstClientCertChain"><span class="hs-identifier hs-var hs-var">hstClientCertChain</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstPendingTxState"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe RecordState
</span><a href="Network.TLS.Handshake.State.html#hstPendingTxState"><span class="hs-identifier hs-var hs-var">hstPendingTxState</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstPendingRxState"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe RecordState
</span><a href="Network.TLS.Handshake.State.html#hstPendingRxState"><span class="hs-identifier hs-var hs-var">hstPendingRxState</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstPendingCipher"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var hs-var">hstPendingCipher</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstPendingCompression"><span class="annot"><span class="annottext">HandshakeState -&gt; Compression
</span><a href="Network.TLS.Handshake.State.html#hstPendingCompression"><span class="hs-identifier hs-var hs-var">hstPendingCompression</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#Compression"><span class="hs-identifier hs-type">Compression</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstExtendedMasterSec"><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstExtendedMasterSec"><span class="hs-identifier hs-var hs-var">hstExtendedMasterSec</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstNegotiatedGroup"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Group
</span><a href="Network.TLS.Handshake.State.html#hstNegotiatedGroup"><span class="hs-identifier hs-var hs-var">hstNegotiatedGroup</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstTLS13HandshakeMode"><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeMode13
</span><a href="Network.TLS.Handshake.State.html#hstTLS13HandshakeMode"><span class="hs-identifier hs-var hs-var">hstTLS13HandshakeMode</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier hs-type">HandshakeMode13</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstTLS13RTT0Status"><span class="annot"><span class="annottext">HandshakeState -&gt; RTT0Status
</span><a href="Network.TLS.Handshake.State.html#hstTLS13RTT0Status"><span class="hs-identifier hs-var hs-var">hstTLS13RTT0Status</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Status"><span class="hs-identifier hs-type">RTT0Status</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstTLS13EarlySecret"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe (BaseSecret EarlySecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13EarlySecret"><span class="hs-identifier hs-var hs-var">hstTLS13EarlySecret</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#EarlySecret"><span class="hs-identifier hs-type">EarlySecret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstTLS13ResumptionSecret"><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe (BaseSecret ResumptionSecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13ResumptionSecret"><span class="hs-identifier hs-var hs-var">hstTLS13ResumptionSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ResumptionSecret"><span class="hs-identifier hs-type">ResumptionSecret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="hstCCS13Sent"><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstCCS13Sent"><span class="hs-identifier hs-var hs-var">hstCCS13Sent</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679182895"><span id="local-6989586621679182946"><span id="local-6989586621679182950"><span class="annot"><span class="annottext">Int -&gt; HandshakeState -&gt; ShowS
[HandshakeState] -&gt; ShowS
HandshakeState -&gt; String
(Int -&gt; HandshakeState -&gt; ShowS)
-&gt; (HandshakeState -&gt; String)
-&gt; ([HandshakeState] -&gt; ShowS)
-&gt; Show HandshakeState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HandshakeState -&gt; ShowS
showsPrec :: Int -&gt; HandshakeState -&gt; ShowS
$cshow :: HandshakeState -&gt; String
show :: HandshakeState -&gt; String
$cshowList :: [HandshakeState] -&gt; ShowS
showList :: [HandshakeState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><span class="hs-comment">{- | When we receive a CertificateRequest from a server, a just-in-time
   callback is issued to the application to obtain a suitable certificate.
   Somewhat unfortunately, the callback parameters don't abstract away the
   details of the TLS 1.2 Certificate Request message, which combines the
   legacy @certificate_types@ and new @supported_signature_algorithms@
   parameters is a rather subtle way.

   TLS 1.2 also (again unfortunately, in the opinion of the author of this
   comment) overloads the signature algorithms parameter to constrain not only
   the algorithms used in TLS, but also the algorithms used by issuing CAs in
   the X.509 chain.  Best practice is to NOT treat such that restriction as a
   MUST, but rather take it as merely a preference, when a choice exists.  If
   the best chain available does not match the provided signature algorithm
   list, go ahead and use it anyway, it will probably work, and the server may
   not even care about the issuer CAs at all, it may be doing DANE or have
   explicit mappings for the client's public key, ...

   The TLS 1.3 @CertificateRequest@ message, drops @certificate_types@ and no
   longer overloads @supported_signature_algorithms@ to cover X.509.  It also
   includes a new opaque context token that the client must echo back, which
   makes certain client authentication replay attacks more difficult.  We will
   store that context separately, it does not need to be presented in the user
   callback.  The certificate signature algorithms preferred by the peer are
   now in the separate @signature_algorithms_cert@ extension, but we cannot
   report these to the application callback without an API change.  The good
   news is that filtering the X.509 signature types is generally unnecessary,
   unwise and difficult.  So we just ignore this extension.

   As a result, the information we provide to the callback is no longer a
   verbatim copy of the certificate request payload.  In the case of TLS 1.3
   The 'CertificateType' list is synthetically generated from the server's
   @signature_algorithms@ extension, and the @signature_algorithms_certs@
   extension is ignored.

   Since the original TLS 1.2 'CertificateType' has no provision for the newer
   certificate types that have appeared in TLS 1.3 we're adding some synthetic
   values that have no equivalent values in the TLS 1.2 'CertificateType' as
   defined in the IANA
   &lt;https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-2
   TLS ClientCertificateType Identifiers&gt; registry.  These values are inferred
   from the TLS 1.3 @signature_algorithms@ extension, and will allow clients to
   present Ed25519 and Ed448 certificates when these become supported.
-}</span></span><span>
</span><span id="line-181"></span><span class="hs-keyword">type</span><span> </span><span id="CertReqCBdata"><span class="annot"><a href="Network.TLS.Handshake.State.html#CertReqCBdata"><span class="hs-identifier hs-var">CertReqCBdata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#CertificateType"><span class="hs-identifier hs-type">CertificateType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DistinguishedName</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-keyword">newtype</span><span> </span><span id="HandshakeM"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-var">HandshakeM</span></a></span></span><span> </span><span id="local-6989586621679182605"><span class="annot"><a href="#local-6989586621679182605"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HandshakeM"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-var">HandshakeM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runHandshakeM"><span class="annot"><span class="annottext">forall a. HandshakeM a -&gt; State HandshakeState a
</span><a href="Network.TLS.Handshake.State.html#runHandshakeM"><span class="hs-identifier hs-var hs-var">runHandshakeM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679182978"><span id="local-6989586621679182984"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b)
-&gt; (forall a b. a -&gt; HandshakeM b -&gt; HandshakeM a)
-&gt; Functor HandshakeM
forall a b. a -&gt; HandshakeM b -&gt; HandshakeM a
forall a b. (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
fmap :: forall a b. (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
$c&lt;$ :: forall a b. a -&gt; HandshakeM b -&gt; HandshakeM a
&lt;$ :: forall a b. a -&gt; HandshakeM b -&gt; HandshakeM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679182993"><span id="local-6989586621679183000"><span id="local-6989586621679183006"><span id="local-6989586621679183012"><span id="local-6989586621679183018"><span class="annot"><span class="annottext">Functor HandshakeM
Functor HandshakeM =&gt;
(forall a. a -&gt; HandshakeM a)
-&gt; (forall a b.
    HandshakeM (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM c)
-&gt; (forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b)
-&gt; (forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM a)
-&gt; Applicative HandshakeM
forall a. a -&gt; HandshakeM a
forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM a
forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
forall a b. HandshakeM (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
forall a b c.
(a -&gt; b -&gt; c) -&gt; HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; HandshakeM a
pure :: forall a. a -&gt; HandshakeM a
$c&lt;*&gt; :: forall a b. HandshakeM (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
&lt;*&gt; :: forall a b. HandshakeM (a -&gt; b) -&gt; HandshakeM a -&gt; HandshakeM b
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM c
$c*&gt; :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
*&gt; :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
$c&lt;* :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM a
&lt;* :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183029"><span id="local-6989586621679183035"><span id="local-6989586621679183040"><span class="annot"><span class="annottext">Applicative HandshakeM
Applicative HandshakeM =&gt;
(forall a b. HandshakeM a -&gt; (a -&gt; HandshakeM b) -&gt; HandshakeM b)
-&gt; (forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b)
-&gt; (forall a. a -&gt; HandshakeM a)
-&gt; Monad HandshakeM
forall a. a -&gt; HandshakeM a
forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
forall a b. HandshakeM a -&gt; (a -&gt; HandshakeM b) -&gt; HandshakeM b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. HandshakeM a -&gt; (a -&gt; HandshakeM b) -&gt; HandshakeM b
&gt;&gt;= :: forall a b. HandshakeM a -&gt; (a -&gt; HandshakeM b) -&gt; HandshakeM b
$c&gt;&gt; :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
&gt;&gt; :: forall a b. HandshakeM a -&gt; HandshakeM b -&gt; HandshakeM b
$creturn :: forall a. a -&gt; HandshakeM a
return :: forall a. a -&gt; HandshakeM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679183055"><span class="annot"><span class="annottext">put :: HandshakeState -&gt; HandshakeM ()
</span><a href="#local-6989586621679183055"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621679183057"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183057"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State HandshakeState () -&gt; HandshakeM ()
forall a. State HandshakeState a -&gt; HandshakeM a
</span><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-var">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeState -&gt; State HandshakeState ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183057"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679183060"><span class="annot"><span class="annottext">get :: HandshakeM HandshakeState
</span><a href="#local-6989586621679183060"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State HandshakeState HandshakeState -&gt; HandshakeM HandshakeState
forall a. State HandshakeState a -&gt; HandshakeM a
</span><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-var">HandshakeM</span></a></span><span> </span><span class="annot"><span class="annottext">State HandshakeState HandshakeState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679183064"><span class="annot"><span class="annottext">state :: forall a. (HandshakeState -&gt; (a, HandshakeState)) -&gt; HandshakeM a
</span><a href="#local-6989586621679183064"><span class="hs-identifier hs-var hs-var hs-var hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679183066"><span class="annot"><span class="annottext">HandshakeState -&gt; (a, HandshakeState)
</span><a href="#local-6989586621679183066"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State HandshakeState a -&gt; HandshakeM a
forall a. State HandshakeState a -&gt; HandshakeM a
</span><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-var">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HandshakeState -&gt; (a, HandshakeState)) -&gt; State HandshakeState a
forall a.
(HandshakeState -&gt; (a, HandshakeState))
-&gt; StateT HandshakeState Identity a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><span class="hs-identifier hs-var">state</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; (a, HandshakeState)
</span><a href="#local-6989586621679183066"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- create a new empty handshake state</span><span>
</span><span id="line-195"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#newEmptyHandshake"><span class="hs-identifier hs-type">newEmptyHandshake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span>
</span><span id="line-196"></span><span id="newEmptyHandshake"><span class="annot"><span class="annottext">newEmptyHandshake :: Version -&gt; ClientRandom -&gt; HandshakeState
</span><a href="Network.TLS.Handshake.State.html#newEmptyHandshake"><span class="hs-identifier hs-var hs-var">newEmptyHandshake</span></a></span></span><span> </span><span id="local-6989586621679183067"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183067"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183068"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679183068"><span class="hs-identifier hs-var">crand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hstClientVersion :: Version
</span><a href="Network.TLS.Handshake.State.html#hstClientVersion"><span class="hs-identifier hs-var">hstClientVersion</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183067"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstClientRandom :: ClientRandom
</span><a href="Network.TLS.Handshake.State.html#hstClientRandom"><span class="hs-identifier hs-var">hstClientRandom</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679183068"><span class="hs-identifier hs-var">crand</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstServerRandom :: Maybe ServerRandom
</span><a href="Network.TLS.Handshake.State.html#hstServerRandom"><span class="hs-identifier hs-var">hstServerRandom</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ServerRandom
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstMasterSecret :: Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstMasterSecret"><span class="hs-identifier hs-var">hstMasterSecret</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstKeyState :: HandshakeKeyState
</span><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PubKey -&gt; Maybe (PubKey, PrivKey) -&gt; HandshakeKeyState
</span><a href="Network.TLS.Handshake.State.html#HandshakeKeyState"><span class="hs-identifier hs-var">HandshakeKeyState</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PubKey
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PubKey, PrivKey)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstServerDHParams :: Maybe ServerDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerDHParams"><span class="hs-identifier hs-var">hstServerDHParams</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ServerDHParams
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstDHPrivate :: Maybe DHPrivate
</span><a href="Network.TLS.Handshake.State.html#hstDHPrivate"><span class="hs-identifier hs-var">hstDHPrivate</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DHPrivate
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstServerECDHParams :: Maybe ServerECDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerECDHParams"><span class="hs-identifier hs-var">hstServerECDHParams</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ServerECDHParams
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstGroupPrivate :: Maybe GroupPrivate
</span><a href="Network.TLS.Handshake.State.html#hstGroupPrivate"><span class="hs-identifier hs-var">hstGroupPrivate</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe GroupPrivate
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstHandshakeDigest :: HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-var">HandshakeMessages</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstHandshakeMessages :: [ByteString]
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstCertReqToken :: Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstCertReqToken"><span class="hs-identifier hs-var">hstCertReqToken</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstCertReqCBdata :: Maybe CertReqCBdata
</span><a href="Network.TLS.Handshake.State.html#hstCertReqCBdata"><span class="hs-identifier hs-var">hstCertReqCBdata</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CertReqCBdata
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstCertReqSigAlgsCert :: Maybe [HashAndSignatureAlgorithm]
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSigAlgsCert"><span class="hs-identifier hs-var">hstCertReqSigAlgsCert</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstClientCertSent :: Bool
</span><a href="Network.TLS.Handshake.State.html#hstClientCertSent"><span class="hs-identifier hs-var">hstClientCertSent</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstCertReqSent :: Bool
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSent"><span class="hs-identifier hs-var">hstCertReqSent</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstClientCertChain :: Maybe CertificateChain
</span><a href="Network.TLS.Handshake.State.html#hstClientCertChain"><span class="hs-identifier hs-var">hstClientCertChain</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CertificateChain
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstPendingTxState :: Maybe RecordState
</span><a href="Network.TLS.Handshake.State.html#hstPendingTxState"><span class="hs-identifier hs-var">hstPendingTxState</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RecordState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstPendingRxState :: Maybe RecordState
</span><a href="Network.TLS.Handshake.State.html#hstPendingRxState"><span class="hs-identifier hs-var">hstPendingRxState</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RecordState
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstPendingCipher :: Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Cipher
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstPendingCompression :: Compression
</span><a href="Network.TLS.Handshake.State.html#hstPendingCompression"><span class="hs-identifier hs-var">hstPendingCompression</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compression
</span><a href="Network.TLS.Compression.html#nullCompression"><span class="hs-identifier hs-var">nullCompression</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstExtendedMasterSec :: Bool
</span><a href="Network.TLS.Handshake.State.html#hstExtendedMasterSec"><span class="hs-identifier hs-var">hstExtendedMasterSec</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstNegotiatedGroup :: Maybe Group
</span><a href="Network.TLS.Handshake.State.html#hstNegotiatedGroup"><span class="hs-identifier hs-var">hstNegotiatedGroup</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Group
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstTLS13HandshakeMode :: HandshakeMode13
</span><a href="Network.TLS.Handshake.State.html#hstTLS13HandshakeMode"><span class="hs-identifier hs-var">hstTLS13HandshakeMode</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeMode13
</span><a href="Network.TLS.Handshake.State.html#FullHandshake"><span class="hs-identifier hs-var">FullHandshake</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstTLS13RTT0Status :: RTT0Status
</span><a href="Network.TLS.Handshake.State.html#hstTLS13RTT0Status"><span class="hs-identifier hs-var">hstTLS13RTT0Status</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RTT0Status
</span><a href="Network.TLS.Handshake.State.html#RTT0None"><span class="hs-identifier hs-var">RTT0None</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstTLS13EarlySecret :: Maybe (BaseSecret EarlySecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13EarlySecret"><span class="hs-identifier hs-var">hstTLS13EarlySecret</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (BaseSecret EarlySecret)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstTLS13ResumptionSecret :: Maybe (BaseSecret ResumptionSecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13ResumptionSecret"><span class="hs-identifier hs-var">hstTLS13ResumptionSecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (BaseSecret ResumptionSecret)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hstCCS13Sent :: Bool
</span><a href="Network.TLS.Handshake.State.html#hstCCS13Sent"><span class="hs-identifier hs-var">hstCCS13Sent</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621679182666"><span class="annot"><a href="Network.TLS.Handshake.State.html#runHandshake"><span class="hs-identifier hs-type">runHandshake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679182666"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679182666"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-228"></span><span id="runHandshake"><span class="annot"><span class="annottext">runHandshake :: forall a. HandshakeState -&gt; HandshakeM a -&gt; (a, HandshakeState)
</span><a href="Network.TLS.Handshake.State.html#runHandshake"><span class="hs-identifier hs-var hs-var">runHandshake</span></a></span></span><span> </span><span id="local-6989586621679183072"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183072"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span id="local-6989586621679183073"><span class="annot"><span class="annottext">HandshakeM a
</span><a href="#local-6989586621679183073"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State HandshakeState a -&gt; HandshakeState -&gt; (a, HandshakeState)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeM a -&gt; State HandshakeState a
forall a. HandshakeM a -&gt; State HandshakeState a
</span><a href="Network.TLS.Handshake.State.html#runHandshakeM"><span class="hs-identifier hs-var">runHandshakeM</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeM a
</span><a href="#local-6989586621679183073"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183072"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setPublicKey"><span class="hs-identifier hs-type">setPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span id="setPublicKey"><span class="annot"><span class="annottext">setPublicKey :: PubKey -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setPublicKey"><span class="hs-identifier hs-var hs-var">setPublicKey</span></a></span></span><span> </span><span id="local-6989586621679183075"><span class="annot"><span class="annottext">PubKey
</span><a href="#local-6989586621679183075"><span class="hs-identifier hs-var">pk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183077"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183077"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183077"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183078"><span class="hs-identifier hs-type">setPK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183077"><span class="hs-identifier hs-type">hst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183078"><span class="annot"><span class="annottext">setPK :: HandshakeKeyState -&gt; HandshakeKeyState
</span><a href="#local-6989586621679183078"><span class="hs-identifier hs-var hs-var">setPK</span></a></span></span><span> </span><span id="local-6989586621679183079"><span class="annot"><span class="annottext">HandshakeKeyState
</span><a href="#local-6989586621679183079"><span class="hs-identifier hs-var">hks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeKeyState
</span><a href="#local-6989586621679183079"><span class="hs-identifier hs-var">hks</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hksRemotePublicKey"><span class="hs-identifier hs-var">hksRemotePublicKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183075"><span class="hs-identifier hs-type">pk</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setPublicPrivateKeys"><span class="hs-identifier hs-type">setPublicPrivateKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="setPublicPrivateKeys"><span class="annot"><span class="annottext">setPublicPrivateKeys :: (PubKey, PrivKey) -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setPublicPrivateKeys"><span class="hs-identifier hs-var hs-var">setPublicPrivateKeys</span></a></span></span><span> </span><span id="local-6989586621679183080"><span class="annot"><span class="annottext">(PubKey, PrivKey)
</span><a href="#local-6989586621679183080"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183081"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183081"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183081"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183082"><span class="hs-identifier hs-type">setKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183081"><span class="hs-identifier hs-type">hst</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183082"><span class="annot"><span class="annottext">setKeys :: HandshakeKeyState -&gt; HandshakeKeyState
</span><a href="#local-6989586621679183082"><span class="hs-identifier hs-var hs-var">setKeys</span></a></span></span><span> </span><span id="local-6989586621679183083"><span class="annot"><span class="annottext">HandshakeKeyState
</span><a href="#local-6989586621679183083"><span class="hs-identifier hs-var">hks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeKeyState
</span><a href="#local-6989586621679183083"><span class="hs-identifier hs-var">hks</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hksLocalPublicPrivateKeys"><span class="hs-identifier hs-var">hksLocalPublicPrivateKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183080"><span class="hs-identifier hs-type">keys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getRemotePublicKey"><span class="hs-identifier hs-type">getRemotePublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span>
</span><span id="line-239"></span><span id="getRemotePublicKey"><span class="annot"><span class="annottext">getRemotePublicKey :: HandshakeM PubKey
</span><a href="Network.TLS.Handshake.State.html#getRemotePublicKey"><span class="hs-identifier hs-var hs-var">getRemotePublicKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe PubKey -&gt; PubKey
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;remote public key&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PubKey -&gt; PubKey)
-&gt; HandshakeM (Maybe PubKey) -&gt; HandshakeM PubKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe PubKey) -&gt; HandshakeM (Maybe PubKey)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeKeyState -&gt; Maybe PubKey
</span><a href="Network.TLS.Handshake.State.html#hksRemotePublicKey"><span class="hs-identifier hs-var">hksRemotePublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(HandshakeKeyState -&gt; Maybe PubKey)
-&gt; (HandshakeState -&gt; HandshakeKeyState)
-&gt; HandshakeState
-&gt; Maybe PubKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeKeyState
</span><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getLocalPublicPrivateKeys"><span class="hs-identifier hs-type">getLocalPublicPrivateKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span id="getLocalPublicPrivateKeys"><span class="annot"><span class="annottext">getLocalPublicPrivateKeys :: HandshakeM (PubKey, PrivKey)
</span><a href="Network.TLS.Handshake.State.html#getLocalPublicPrivateKeys"><span class="hs-identifier hs-var hs-var">getLocalPublicPrivateKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe (PubKey, PrivKey) -&gt; (PubKey, PrivKey)
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;local public/private key&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (PubKey, PrivKey) -&gt; (PubKey, PrivKey))
-&gt; HandshakeM (Maybe (PubKey, PrivKey))
-&gt; HandshakeM (PubKey, PrivKey)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe (PubKey, PrivKey))
-&gt; HandshakeM (Maybe (PubKey, PrivKey))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeKeyState -&gt; Maybe (PubKey, PrivKey)
</span><a href="Network.TLS.Handshake.State.html#hksLocalPublicPrivateKeys"><span class="hs-identifier hs-var">hksLocalPublicPrivateKeys</span></a></span><span> </span><span class="annot"><span class="annottext">(HandshakeKeyState -&gt; Maybe (PubKey, PrivKey))
-&gt; (HandshakeState -&gt; HandshakeKeyState)
-&gt; HandshakeState
-&gt; Maybe (PubKey, PrivKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeKeyState
</span><a href="Network.TLS.Handshake.State.html#hstKeyState"><span class="hs-identifier hs-var">hstKeyState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerDHParams"><span class="hs-identifier hs-type">setServerDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="setServerDHParams"><span class="annot"><span class="annottext">setServerDHParams :: ServerDHParams -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setServerDHParams"><span class="hs-identifier hs-var hs-var">setServerDHParams</span></a></span></span><span> </span><span id="local-6989586621679183088"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679183088"><span class="hs-identifier hs-var">shp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183089"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183089"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183089"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstServerDHParams"><span class="hs-identifier hs-var">hstServerDHParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183088"><span class="hs-identifier hs-type">shp</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getServerDHParams"><span class="hs-identifier hs-type">getServerDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span>
</span><span id="line-248"></span><span id="getServerDHParams"><span class="annot"><span class="annottext">getServerDHParams :: HandshakeM ServerDHParams
</span><a href="Network.TLS.Handshake.State.html#getServerDHParams"><span class="hs-identifier hs-var hs-var">getServerDHParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ServerDHParams -&gt; ServerDHParams
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server DH params&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ServerDHParams -&gt; ServerDHParams)
-&gt; HandshakeM (Maybe ServerDHParams) -&gt; HandshakeM ServerDHParams
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe ServerDHParams)
-&gt; HandshakeM (Maybe ServerDHParams)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerDHParams"><span class="hs-identifier hs-var">hstServerDHParams</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerECDHParams"><span class="hs-identifier hs-type">setServerECDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span id="setServerECDHParams"><span class="annot"><span class="annottext">setServerECDHParams :: ServerECDHParams -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setServerECDHParams"><span class="hs-identifier hs-var hs-var">setServerECDHParams</span></a></span></span><span> </span><span id="local-6989586621679183090"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679183090"><span class="hs-identifier hs-var">shp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183091"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183091"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183091"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstServerECDHParams"><span class="hs-identifier hs-var">hstServerECDHParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183090"><span class="hs-identifier hs-type">shp</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getServerECDHParams"><span class="hs-identifier hs-type">getServerECDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span>
</span><span id="line-254"></span><span id="getServerECDHParams"><span class="annot"><span class="annottext">getServerECDHParams :: HandshakeM ServerECDHParams
</span><a href="Network.TLS.Handshake.State.html#getServerECDHParams"><span class="hs-identifier hs-var hs-var">getServerECDHParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ServerECDHParams -&gt; ServerECDHParams
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server ECDH params&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ServerECDHParams -&gt; ServerECDHParams)
-&gt; HandshakeM (Maybe ServerECDHParams)
-&gt; HandshakeM ServerECDHParams
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe ServerECDHParams)
-&gt; HandshakeM (Maybe ServerECDHParams)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerECDHParams
</span><a href="Network.TLS.Handshake.State.html#hstServerECDHParams"><span class="hs-identifier hs-var">hstServerECDHParams</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setDHPrivate"><span class="hs-identifier hs-type">setDHPrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHPrivate"><span class="hs-identifier hs-type">DHPrivate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span id="setDHPrivate"><span class="annot"><span class="annottext">setDHPrivate :: DHPrivate -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setDHPrivate"><span class="hs-identifier hs-var hs-var">setDHPrivate</span></a></span></span><span> </span><span id="local-6989586621679183092"><span class="annot"><span class="annottext">DHPrivate
</span><a href="#local-6989586621679183092"><span class="hs-identifier hs-var">shp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183093"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183093"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183093"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstDHPrivate"><span class="hs-identifier hs-var">hstDHPrivate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183092"><span class="hs-identifier hs-type">shp</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getDHPrivate"><span class="hs-identifier hs-type">getDHPrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.DH.html#DHPrivate"><span class="hs-identifier hs-type">DHPrivate</span></a></span><span>
</span><span id="line-260"></span><span id="getDHPrivate"><span class="annot"><span class="annottext">getDHPrivate :: HandshakeM DHPrivate
</span><a href="Network.TLS.Handshake.State.html#getDHPrivate"><span class="hs-identifier hs-var hs-var">getDHPrivate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe DHPrivate -&gt; DHPrivate
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server DH private&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe DHPrivate -&gt; DHPrivate)
-&gt; HandshakeM (Maybe DHPrivate) -&gt; HandshakeM DHPrivate
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe DHPrivate) -&gt; HandshakeM (Maybe DHPrivate)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe DHPrivate
</span><a href="Network.TLS.Handshake.State.html#hstDHPrivate"><span class="hs-identifier hs-var">hstDHPrivate</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getGroupPrivate"><span class="hs-identifier hs-type">getGroupPrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span>
</span><span id="line-263"></span><span id="getGroupPrivate"><span class="annot"><span class="annottext">getGroupPrivate :: HandshakeM GroupPrivate
</span><a href="Network.TLS.Handshake.State.html#getGroupPrivate"><span class="hs-identifier hs-var hs-var">getGroupPrivate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe GroupPrivate -&gt; GroupPrivate
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server ECDH private&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe GroupPrivate -&gt; GroupPrivate)
-&gt; HandshakeM (Maybe GroupPrivate) -&gt; HandshakeM GroupPrivate
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe GroupPrivate)
-&gt; HandshakeM (Maybe GroupPrivate)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe GroupPrivate
</span><a href="Network.TLS.Handshake.State.html#hstGroupPrivate"><span class="hs-identifier hs-var">hstGroupPrivate</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setGroupPrivate"><span class="hs-identifier hs-type">setGroupPrivate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.IES.html#GroupPrivate"><span class="hs-identifier hs-type">GroupPrivate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span id="setGroupPrivate"><span class="annot"><span class="annottext">setGroupPrivate :: GroupPrivate -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setGroupPrivate"><span class="hs-identifier hs-var hs-var">setGroupPrivate</span></a></span></span><span> </span><span id="local-6989586621679183094"><span class="annot"><span class="annottext">GroupPrivate
</span><a href="#local-6989586621679183094"><span class="hs-identifier hs-var">shp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183095"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183095"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183095"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstGroupPrivate"><span class="hs-identifier hs-var">hstGroupPrivate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183094"><span class="hs-identifier hs-type">shp</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setExtendedMasterSec"><span class="hs-identifier hs-type">setExtendedMasterSec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span id="setExtendedMasterSec"><span class="annot"><span class="annottext">setExtendedMasterSec :: Bool -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setExtendedMasterSec"><span class="hs-identifier hs-var hs-var">setExtendedMasterSec</span></a></span></span><span> </span><span id="local-6989586621679183096"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183096"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183097"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183097"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183097"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstExtendedMasterSec"><span class="hs-identifier hs-var">hstExtendedMasterSec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183096"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getExtendedMasterSec"><span class="hs-identifier hs-type">getExtendedMasterSec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-272"></span><span id="getExtendedMasterSec"><span class="annot"><span class="annottext">getExtendedMasterSec :: HandshakeM Bool
</span><a href="Network.TLS.Handshake.State.html#getExtendedMasterSec"><span class="hs-identifier hs-var hs-var">getExtendedMasterSec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Bool) -&gt; HandshakeM Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstExtendedMasterSec"><span class="hs-identifier hs-var">hstExtendedMasterSec</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setNegotiatedGroup"><span class="hs-identifier hs-type">setNegotiatedGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="setNegotiatedGroup"><span class="annot"><span class="annottext">setNegotiatedGroup :: Group -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setNegotiatedGroup"><span class="hs-identifier hs-var hs-var">setNegotiatedGroup</span></a></span></span><span> </span><span id="local-6989586621679183098"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679183098"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183099"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183099"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183099"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstNegotiatedGroup"><span class="hs-identifier hs-var">hstNegotiatedGroup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183098"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getNegotiatedGroup"><span class="hs-identifier hs-type">getNegotiatedGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Crypto.Types.html#Group"><span class="hs-identifier hs-type">Group</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span id="getNegotiatedGroup"><span class="annot"><span class="annottext">getNegotiatedGroup :: HandshakeM (Maybe Group)
</span><a href="Network.TLS.Handshake.State.html#getNegotiatedGroup"><span class="hs-identifier hs-var hs-var">getNegotiatedGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe Group) -&gt; HandshakeM (Maybe Group)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Group
</span><a href="Network.TLS.Handshake.State.html#hstNegotiatedGroup"><span class="hs-identifier hs-var">hstNegotiatedGroup</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><span class="hs-comment">-- | Type to show which handshake mode is used in TLS 1.3.</span></span><span>
</span><span id="line-281"></span><span class="hs-keyword">data</span><span> </span><span id="HandshakeMode13"><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier hs-var">HandshakeMode13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Full handshake is used.</span></span><span>
</span><span id="line-283"></span><span>      </span><span id="FullHandshake"><span class="annot"><a href="Network.TLS.Handshake.State.html#FullHandshake"><span class="hs-identifier hs-var">FullHandshake</span></a></span></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Full handshake is used with hello retry request.</span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="HelloRetryRequest"><span class="annot"><a href="Network.TLS.Handshake.State.html#HelloRetryRequest"><span class="hs-identifier hs-var">HelloRetryRequest</span></a></span></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Server authentication is skipped.</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PreSharedKey"><span class="annot"><a href="Network.TLS.Handshake.State.html#PreSharedKey"><span class="hs-identifier hs-var">PreSharedKey</span></a></span></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="hs-comment">-- | Server authentication is skipped and early data is sent.</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="RTT0"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0"><span class="hs-identifier hs-var">RTT0</span></a></span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679183104"><span id="local-6989586621679183106"><span id="local-6989586621679183109"><span class="annot"><span class="annottext">Int -&gt; HandshakeMode13 -&gt; ShowS
[HandshakeMode13] -&gt; ShowS
HandshakeMode13 -&gt; String
(Int -&gt; HandshakeMode13 -&gt; ShowS)
-&gt; (HandshakeMode13 -&gt; String)
-&gt; ([HandshakeMode13] -&gt; ShowS)
-&gt; Show HandshakeMode13
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HandshakeMode13 -&gt; ShowS
showsPrec :: Int -&gt; HandshakeMode13 -&gt; ShowS
$cshow :: HandshakeMode13 -&gt; String
show :: HandshakeMode13 -&gt; String
$cshowList :: [HandshakeMode13] -&gt; ShowS
showList :: [HandshakeMode13] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679183112"><span id="local-6989586621679183114"><span class="annot"><span class="annottext">HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool
(HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool)
-&gt; (HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool)
-&gt; Eq HandshakeMode13
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool
== :: HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool
$c/= :: HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool
/= :: HandshakeMode13 -&gt; HandshakeMode13 -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13HandshakeMode"><span class="hs-identifier hs-type">setTLS13HandshakeMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier hs-type">HandshakeMode13</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="setTLS13HandshakeMode"><span class="annot"><span class="annottext">setTLS13HandshakeMode :: HandshakeMode13 -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setTLS13HandshakeMode"><span class="hs-identifier hs-var hs-var">setTLS13HandshakeMode</span></a></span></span><span> </span><span id="local-6989586621679183118"><span class="annot"><span class="annottext">HandshakeMode13
</span><a href="#local-6989586621679183118"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183119"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183119"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183119"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstTLS13HandshakeMode"><span class="hs-identifier hs-var">hstTLS13HandshakeMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183118"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13HandshakeMode"><span class="hs-identifier hs-type">getTLS13HandshakeMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMode13"><span class="hs-identifier hs-type">HandshakeMode13</span></a></span><span>
</span><span id="line-296"></span><span id="getTLS13HandshakeMode"><span class="annot"><span class="annottext">getTLS13HandshakeMode :: HandshakeM HandshakeMode13
</span><a href="Network.TLS.Handshake.State.html#getTLS13HandshakeMode"><span class="hs-identifier hs-var hs-var">getTLS13HandshakeMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeMode13) -&gt; HandshakeM HandshakeMode13
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeMode13
</span><a href="Network.TLS.Handshake.State.html#hstTLS13HandshakeMode"><span class="hs-identifier hs-var">hstTLS13HandshakeMode</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">data</span><span> </span><span id="RTT0Status"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Status"><span class="hs-identifier hs-var">RTT0Status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RTT0None"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0None"><span class="hs-identifier hs-var">RTT0None</span></a></span></span><span>
</span><span id="line-299"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="RTT0Sent"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Sent"><span class="hs-identifier hs-var">RTT0Sent</span></a></span></span><span>
</span><span id="line-300"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="RTT0Accepted"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Accepted"><span class="hs-identifier hs-var">RTT0Accepted</span></a></span></span><span>
</span><span id="line-301"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="RTT0Rejected"><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Rejected"><span class="hs-identifier hs-var">RTT0Rejected</span></a></span></span><span>
</span><span id="line-302"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679183124"><span id="local-6989586621679183126"><span id="local-6989586621679183129"><span class="annot"><span class="annottext">Int -&gt; RTT0Status -&gt; ShowS
[RTT0Status] -&gt; ShowS
RTT0Status -&gt; String
(Int -&gt; RTT0Status -&gt; ShowS)
-&gt; (RTT0Status -&gt; String)
-&gt; ([RTT0Status] -&gt; ShowS)
-&gt; Show RTT0Status
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RTT0Status -&gt; ShowS
showsPrec :: Int -&gt; RTT0Status -&gt; ShowS
$cshow :: RTT0Status -&gt; String
show :: RTT0Status -&gt; String
$cshowList :: [RTT0Status] -&gt; ShowS
showList :: [RTT0Status] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679183132"><span id="local-6989586621679183134"><span class="annot"><span class="annottext">RTT0Status -&gt; RTT0Status -&gt; Bool
(RTT0Status -&gt; RTT0Status -&gt; Bool)
-&gt; (RTT0Status -&gt; RTT0Status -&gt; Bool) -&gt; Eq RTT0Status
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RTT0Status -&gt; RTT0Status -&gt; Bool
== :: RTT0Status -&gt; RTT0Status -&gt; Bool
$c/= :: RTT0Status -&gt; RTT0Status -&gt; Bool
/= :: RTT0Status -&gt; RTT0Status -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13RTT0Status"><span class="hs-identifier hs-type">setTLS13RTT0Status</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Status"><span class="hs-identifier hs-type">RTT0Status</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span id="setTLS13RTT0Status"><span class="annot"><span class="annottext">setTLS13RTT0Status :: RTT0Status -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setTLS13RTT0Status"><span class="hs-identifier hs-var hs-var">setTLS13RTT0Status</span></a></span></span><span> </span><span id="local-6989586621679183137"><span class="annot"><span class="annottext">RTT0Status
</span><a href="#local-6989586621679183137"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183138"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183138"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183138"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstTLS13RTT0Status"><span class="hs-identifier hs-var">hstTLS13RTT0Status</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183137"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13RTT0Status"><span class="hs-identifier hs-type">getTLS13RTT0Status</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#RTT0Status"><span class="hs-identifier hs-type">RTT0Status</span></a></span><span>
</span><span id="line-308"></span><span id="getTLS13RTT0Status"><span class="annot"><span class="annottext">getTLS13RTT0Status :: HandshakeM RTT0Status
</span><a href="Network.TLS.Handshake.State.html#getTLS13RTT0Status"><span class="hs-identifier hs-var hs-var">getTLS13RTT0Status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; RTT0Status) -&gt; HandshakeM RTT0Status
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; RTT0Status
</span><a href="Network.TLS.Handshake.State.html#hstTLS13RTT0Status"><span class="hs-identifier hs-var">hstTLS13RTT0Status</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13EarlySecret"><span class="hs-identifier hs-type">setTLS13EarlySecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#EarlySecret"><span class="hs-identifier hs-type">EarlySecret</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span id="setTLS13EarlySecret"><span class="annot"><span class="annottext">setTLS13EarlySecret :: BaseSecret EarlySecret -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setTLS13EarlySecret"><span class="hs-identifier hs-var hs-var">setTLS13EarlySecret</span></a></span></span><span> </span><span id="local-6989586621679183139"><span class="annot"><span class="annottext">BaseSecret EarlySecret
</span><a href="#local-6989586621679183139"><span class="hs-identifier hs-var">secret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183140"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183140"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183140"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstTLS13EarlySecret"><span class="hs-identifier hs-var">hstTLS13EarlySecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183139"><span class="hs-identifier hs-type">secret</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13EarlySecret"><span class="hs-identifier hs-type">getTLS13EarlySecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#EarlySecret"><span class="hs-identifier hs-type">EarlySecret</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span id="getTLS13EarlySecret"><span class="annot"><span class="annottext">getTLS13EarlySecret :: HandshakeM (Maybe (BaseSecret EarlySecret))
</span><a href="Network.TLS.Handshake.State.html#getTLS13EarlySecret"><span class="hs-identifier hs-var hs-var">getTLS13EarlySecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe (BaseSecret EarlySecret))
-&gt; HandshakeM (Maybe (BaseSecret EarlySecret))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe (BaseSecret EarlySecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13EarlySecret"><span class="hs-identifier hs-var">hstTLS13EarlySecret</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setTLS13ResumptionSecret"><span class="hs-identifier hs-type">setTLS13ResumptionSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ResumptionSecret"><span class="hs-identifier hs-type">ResumptionSecret</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span id="setTLS13ResumptionSecret"><span class="annot"><span class="annottext">setTLS13ResumptionSecret :: BaseSecret ResumptionSecret -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setTLS13ResumptionSecret"><span class="hs-identifier hs-var hs-var">setTLS13ResumptionSecret</span></a></span></span><span> </span><span id="local-6989586621679183141"><span class="annot"><span class="annottext">BaseSecret ResumptionSecret
</span><a href="#local-6989586621679183141"><span class="hs-identifier hs-var">secret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183142"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183142"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183142"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstTLS13ResumptionSecret"><span class="hs-identifier hs-var">hstTLS13ResumptionSecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183141"><span class="hs-identifier hs-type">secret</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getTLS13ResumptionSecret"><span class="hs-identifier hs-type">getTLS13ResumptionSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#BaseSecret"><span class="hs-identifier hs-type">BaseSecret</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#ResumptionSecret"><span class="hs-identifier hs-type">ResumptionSecret</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span id="getTLS13ResumptionSecret"><span class="annot"><span class="annottext">getTLS13ResumptionSecret :: HandshakeM (Maybe (BaseSecret ResumptionSecret))
</span><a href="Network.TLS.Handshake.State.html#getTLS13ResumptionSecret"><span class="hs-identifier hs-var hs-var">getTLS13ResumptionSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe (BaseSecret ResumptionSecret))
-&gt; HandshakeM (Maybe (BaseSecret ResumptionSecret))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe (BaseSecret ResumptionSecret)
</span><a href="Network.TLS.Handshake.State.html#hstTLS13ResumptionSecret"><span class="hs-identifier hs-var">hstTLS13ResumptionSecret</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCCS13Sent"><span class="hs-identifier hs-type">setCCS13Sent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span id="setCCS13Sent"><span class="annot"><span class="annottext">setCCS13Sent :: Bool -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setCCS13Sent"><span class="hs-identifier hs-var hs-var">setCCS13Sent</span></a></span></span><span> </span><span id="local-6989586621679183143"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183143"><span class="hs-identifier hs-var">sent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183144"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183144"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183144"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstCCS13Sent"><span class="hs-identifier hs-var">hstCCS13Sent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183143"><span class="hs-identifier hs-type">sent</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCCS13Sent"><span class="hs-identifier hs-type">getCCS13Sent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-326"></span><span id="getCCS13Sent"><span class="annot"><span class="annottext">getCCS13Sent :: HandshakeM Bool
</span><a href="Network.TLS.Handshake.State.html#getCCS13Sent"><span class="hs-identifier hs-var hs-var">getCCS13Sent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Bool) -&gt; HandshakeM Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstCCS13Sent"><span class="hs-identifier hs-var">hstCCS13Sent</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqSent"><span class="hs-identifier hs-type">setCertReqSent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span id="setCertReqSent"><span class="annot"><span class="annottext">setCertReqSent :: Bool -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setCertReqSent"><span class="hs-identifier hs-var hs-var">setCertReqSent</span></a></span></span><span> </span><span id="local-6989586621679183145"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183145"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183146"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183146"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183146"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstCertReqSent"><span class="hs-identifier hs-var">hstCertReqSent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183145"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqSent"><span class="hs-identifier hs-type">getCertReqSent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-332"></span><span id="getCertReqSent"><span class="annot"><span class="annottext">getCertReqSent :: HandshakeM Bool
</span><a href="Network.TLS.Handshake.State.html#getCertReqSent"><span class="hs-identifier hs-var hs-var">getCertReqSent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Bool) -&gt; HandshakeM Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSent"><span class="hs-identifier hs-var">hstCertReqSent</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setClientCertSent"><span class="hs-identifier hs-type">setClientCertSent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span id="setClientCertSent"><span class="annot"><span class="annottext">setClientCertSent :: Bool -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setClientCertSent"><span class="hs-identifier hs-var hs-var">setClientCertSent</span></a></span></span><span> </span><span id="local-6989586621679183147"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183147"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183148"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183148"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183148"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstClientCertSent"><span class="hs-identifier hs-var">hstClientCertSent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183147"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getClientCertSent"><span class="hs-identifier hs-type">getClientCertSent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-338"></span><span id="getClientCertSent"><span class="annot"><span class="annottext">getClientCertSent :: HandshakeM Bool
</span><a href="Network.TLS.Handshake.State.html#getClientCertSent"><span class="hs-identifier hs-var hs-var">getClientCertSent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Bool) -&gt; HandshakeM Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Bool
</span><a href="Network.TLS.Handshake.State.html#hstClientCertSent"><span class="hs-identifier hs-var">hstClientCertSent</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setClientCertChain"><span class="hs-identifier hs-type">setClientCertChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span id="setClientCertChain"><span class="annot"><span class="annottext">setClientCertChain :: CertificateChain -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setClientCertChain"><span class="hs-identifier hs-var hs-var">setClientCertChain</span></a></span></span><span> </span><span id="local-6989586621679183149"><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679183149"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183150"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183150"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183150"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstClientCertChain"><span class="hs-identifier hs-var">hstClientCertChain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183149"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getClientCertChain"><span class="hs-identifier hs-type">getClientCertChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span id="getClientCertChain"><span class="annot"><span class="annottext">getClientCertChain :: HandshakeM (Maybe CertificateChain)
</span><a href="Network.TLS.Handshake.State.html#getClientCertChain"><span class="hs-identifier hs-var hs-var">getClientCertChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe CertificateChain)
-&gt; HandshakeM (Maybe CertificateChain)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe CertificateChain
</span><a href="Network.TLS.Handshake.State.html#hstClientCertChain"><span class="hs-identifier hs-var">hstClientCertChain</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqToken"><span class="hs-identifier hs-type">setCertReqToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span id="setCertReqToken"><span class="annot"><span class="annottext">setCertReqToken :: Maybe ByteString -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setCertReqToken"><span class="hs-identifier hs-var hs-var">setCertReqToken</span></a></span></span><span> </span><span id="local-6989586621679183151"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679183151"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183152"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183152"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183152"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstCertReqToken"><span class="hs-identifier hs-var">hstCertReqToken</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183151"><span class="hs-identifier hs-type">token</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqToken"><span class="hs-identifier hs-type">getCertReqToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span id="getCertReqToken"><span class="annot"><span class="annottext">getCertReqToken :: HandshakeM (Maybe ByteString)
</span><a href="Network.TLS.Handshake.State.html#getCertReqToken"><span class="hs-identifier hs-var hs-var">getCertReqToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe ByteString)
-&gt; HandshakeM (Maybe ByteString)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstCertReqToken"><span class="hs-identifier hs-var">hstCertReqToken</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">--</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqCBdata"><span class="hs-identifier hs-type">setCertReqCBdata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#CertReqCBdata"><span class="hs-identifier hs-type">CertReqCBdata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span id="setCertReqCBdata"><span class="annot"><span class="annottext">setCertReqCBdata :: Maybe CertReqCBdata -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setCertReqCBdata"><span class="hs-identifier hs-var hs-var">setCertReqCBdata</span></a></span></span><span> </span><span id="local-6989586621679183153"><span class="annot"><span class="annottext">Maybe CertReqCBdata
</span><a href="#local-6989586621679183153"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679183154"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183154"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183154"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstCertReqCBdata"><span class="hs-identifier hs-var">hstCertReqCBdata</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183153"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqCBdata"><span class="hs-identifier hs-type">getCertReqCBdata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#CertReqCBdata"><span class="hs-identifier hs-type">CertReqCBdata</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span id="getCertReqCBdata"><span class="annot"><span class="annottext">getCertReqCBdata :: HandshakeM (Maybe CertReqCBdata)
</span><a href="Network.TLS.Handshake.State.html#getCertReqCBdata"><span class="hs-identifier hs-var hs-var">getCertReqCBdata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe CertReqCBdata)
-&gt; HandshakeM (Maybe CertReqCBdata)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe CertReqCBdata
</span><a href="Network.TLS.Handshake.State.html#hstCertReqCBdata"><span class="hs-identifier hs-var">hstCertReqCBdata</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- Dead code, until we find some use for the extension</span><span>
</span><span id="line-361"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setCertReqSigAlgsCert"><span class="hs-identifier hs-type">setCertReqSigAlgsCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span id="setCertReqSigAlgsCert"><span class="annot"><span class="annottext">setCertReqSigAlgsCert :: Maybe [HashAndSignatureAlgorithm] -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setCertReqSigAlgsCert"><span class="hs-identifier hs-var hs-var">setCertReqSigAlgsCert</span></a></span></span><span> </span><span id="local-6989586621679183155"><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679183155"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183156"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183156"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183156"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstCertReqSigAlgsCert"><span class="hs-identifier hs-var">hstCertReqSigAlgsCert</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183155"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getCertReqSigAlgsCert"><span class="hs-identifier hs-type">getCertReqSigAlgsCert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span id="getCertReqSigAlgsCert"><span class="annot"><span class="annottext">getCertReqSigAlgsCert :: HandshakeM (Maybe [HashAndSignatureAlgorithm])
</span><a href="Network.TLS.Handshake.State.html#getCertReqSigAlgsCert"><span class="hs-identifier hs-var hs-var">getCertReqSigAlgsCert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe [HashAndSignatureAlgorithm])
-&gt; HandshakeM (Maybe [HashAndSignatureAlgorithm])
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe [HashAndSignatureAlgorithm]
</span><a href="Network.TLS.Handshake.State.html#hstCertReqSigAlgsCert"><span class="hs-identifier hs-var">hstCertReqSigAlgsCert</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">--</span><span>
</span><span id="line-368"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getPendingCipher"><span class="hs-identifier hs-type">getPendingCipher</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-369"></span><span id="getPendingCipher"><span class="annot"><span class="annottext">getPendingCipher :: HandshakeM Cipher
</span><a href="Network.TLS.Handshake.State.html#getPendingCipher"><span class="hs-identifier hs-var hs-var">getPendingCipher</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Cipher -&gt; Cipher
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pending cipher&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cipher -&gt; Cipher)
-&gt; HandshakeM (Maybe Cipher) -&gt; HandshakeM Cipher
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; Maybe Cipher) -&gt; HandshakeM (Maybe Cipher)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#addHandshakeMessage"><span class="hs-identifier hs-type">addHandshakeMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span id="addHandshakeMessage"><span class="annot"><span class="annottext">addHandshakeMessage :: ByteString -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#addHandshakeMessage"><span class="hs-identifier hs-var hs-var">addHandshakeMessage</span></a></span></span><span> </span><span id="local-6989586621679183157"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183157"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183158"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183158"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183158"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183157"><span class="hs-identifier hs-type">content</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183158"><span class="hs-identifier hs-type">hs</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeMessages"><span class="hs-identifier hs-type">getHandshakeMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span id="getHandshakeMessages"><span class="annot"><span class="annottext">getHandshakeMessages :: HandshakeM [ByteString]
</span><a href="Network.TLS.Handshake.State.html#getHandshakeMessages"><span class="hs-identifier hs-var hs-var">getHandshakeMessages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; [ByteString]) -&gt; HandshakeM [ByteString]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; (HandshakeState -&gt; [ByteString])
-&gt; HandshakeState
-&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; [ByteString]
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeMessagesRev"><span class="hs-identifier hs-type">getHandshakeMessagesRev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span id="getHandshakeMessagesRev"><span class="annot"><span class="annottext">getHandshakeMessagesRev :: HandshakeM [ByteString]
</span><a href="Network.TLS.Handshake.State.html#getHandshakeMessagesRev"><span class="hs-identifier hs-var hs-var">getHandshakeMessagesRev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; [ByteString]) -&gt; HandshakeM [ByteString]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; [ByteString]
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#updateHandshakeDigest"><span class="hs-identifier hs-type">updateHandshakeDigest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span id="updateHandshakeDigest"><span class="annot"><span class="annottext">updateHandshakeDigest :: ByteString -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#updateHandshakeDigest"><span class="hs-identifier hs-var hs-var">updateHandshakeDigest</span></a></span></span><span> </span><span id="local-6989586621679183160"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183160"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183161"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183161"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183161"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183161"><span class="hs-identifier hs-type">hs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span id="local-6989586621679183162"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183162"><span class="hs-identifier hs-var">bytes</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-var">HandshakeMessages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183160"><span class="hs-identifier hs-var">content</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183162"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span id="local-6989586621679183163"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183163"><span class="hs-identifier hs-var">hashCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-var">HandshakeDigestContext</span></a></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; HandshakeDigest) -&gt; HashCtx -&gt; HandshakeDigest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183163"><span class="hs-identifier hs-var">hashCtx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183160"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Compress the whole transcript with the specified function.  Function @f@</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- takes the handshake digest as input and returns an encoded handshake message</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- to replace the transcript with.</span><span>
</span><span id="line-389"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#foldHandshakeDigest"><span class="hs-identifier hs-type">foldHandshakeDigest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span id="foldHandshakeDigest"><span class="annot"><span class="annottext">foldHandshakeDigest :: Hash -&gt; (ByteString -&gt; ByteString) -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#foldHandshakeDigest"><span class="hs-identifier hs-var hs-var">foldHandshakeDigest</span></a></span></span><span> </span><span id="local-6989586621679183165"><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679183165"><span class="hs-identifier hs-var">hashAlg</span></a></span></span><span> </span><span id="local-6989586621679183166"><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679183166"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183167"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183167"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183167"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span id="local-6989586621679183168"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183168"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679183171"><span class="annot"><span class="annottext">hashCtx :: HashCtx
</span><a href="#local-6989586621679183171"><span class="hs-identifier hs-var hs-var">hashCtx</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString -&gt; HashCtx)
-&gt; HashCtx -&gt; [ByteString] -&gt; HashCtx
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679183165"><span class="hs-identifier hs-var">hashAlg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; HashCtx) -&gt; [ByteString] -&gt; HashCtx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183168"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-394"></span><span>                </span><span class="hs-glyph">!</span><span id="local-6989586621679183174"><span class="annot"><span class="annottext">folded :: ByteString
</span><a href="#local-6989586621679183174"><span class="hs-identifier hs-var hs-var">folded</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679183166"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183171"><span class="hs-identifier hs-var">hashCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183167"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183174"><span class="hs-identifier hs-type">folded</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183174"><span class="hs-identifier hs-type">folded</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span id="local-6989586621679183176"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183176"><span class="hs-identifier hs-var">hashCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679183177"><span class="annot"><span class="annottext">folded :: ByteString
</span><a href="#local-6989586621679183177"><span class="hs-identifier hs-var hs-var">folded</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679183166"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183176"><span class="hs-identifier hs-var">hashCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>                </span><span id="local-6989586621679183178"><span class="annot"><span class="annottext">hashCtx' :: HashCtx
</span><a href="#local-6989586621679183178"><span class="hs-identifier hs-var hs-var">hashCtx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679183165"><span class="hs-identifier hs-var">hashAlg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183177"><span class="hs-identifier hs-var">folded</span></a></span><span>
</span><span id="line-401"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183167"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183178"><span class="hs-identifier hs-type">hashCtx'</span></a></span><span>
</span><span id="line-402"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeMessages"><span class="hs-identifier hs-var">hstHandshakeMessages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679183177"><span class="hs-identifier hs-type">folded</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-403"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getSessionHash"><span class="hs-identifier hs-type">getSessionHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-406"></span><span id="getSessionHash"><span class="annot"><span class="annottext">getSessionHash :: HandshakeM ByteString
</span><a href="Network.TLS.Handshake.State.html#getSessionHash"><span class="hs-identifier hs-var hs-var">getSessionHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; ByteString) -&gt; HandshakeM ByteString
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; ByteString) -&gt; HandshakeM ByteString)
-&gt; (HandshakeState -&gt; ByteString) -&gt; HandshakeM ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183180"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183180"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183180"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span id="local-6989586621679183181"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183181"><span class="hs-identifier hs-var">hashCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183181"><span class="hs-identifier hs-var">hashCtx</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;un-initialized session hash&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHandshakeDigest"><span class="hs-identifier hs-type">getHandshakeDigest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-412"></span><span id="getHandshakeDigest"><span class="annot"><span class="annottext">getHandshakeDigest :: Version -&gt; Role -&gt; HandshakeM ByteString
</span><a href="Network.TLS.Handshake.State.html#getHandshakeDigest"><span class="hs-identifier hs-var hs-var">getHandshakeDigest</span></a></span></span><span> </span><span id="local-6989586621679183183"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183183"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183184"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183184"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; ByteString) -&gt; HandshakeM ByteString
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; ByteString
</span><a href="#local-6989586621679183185"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183185"><span class="annot"><span class="annottext">gen :: HandshakeState -&gt; ByteString
</span><a href="#local-6989586621679183185"><span class="hs-identifier hs-var hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679183188"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183188"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183188"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>                      </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span id="local-6989586621679183189"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183189"><span class="hs-identifier hs-var">hashCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>                         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679183190"><span class="annot"><span class="annottext">msecret :: ByteString
</span><a href="#local-6989586621679183190"><span class="hs-identifier hs-var hs-var">msecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe ByteString -&gt; ByteString
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;master secret&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ByteString
</span><a href="Network.TLS.Handshake.State.html#hstMasterSecret"><span class="hs-identifier hs-var">hstMasterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183188"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-416"></span><span>                             </span><span id="local-6989586621679183191"><span class="annot"><span class="annottext">cipher :: Cipher
</span><a href="#local-6989586621679183191"><span class="hs-identifier hs-var hs-var">cipher</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Cipher -&gt; Cipher
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cipher&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cipher -&gt; Cipher) -&gt; Maybe Cipher -&gt; Cipher
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183188"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-417"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="#local-6989586621679183192"><span class="hs-identifier hs-var">generateFinish</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183183"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183191"><span class="hs-identifier hs-var">cipher</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183190"><span class="hs-identifier hs-var">msecret</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679183189"><span class="hs-identifier hs-var">hashCtx</span></a></span><span>
</span><span id="line-418"></span><span>                      </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-419"></span><span>                         </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;un-initialized handshake digest&quot;</span></span><span>
</span><span id="line-420"></span><span>        </span><span id="local-6989586621679183192"><span class="annot"><span class="annottext">generateFinish :: Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="#local-6989586621679183192"><span class="hs-identifier hs-var hs-var">generateFinish</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183184"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateClientFinished"><span class="hs-identifier hs-var">generateClientFinished</span></a></span><span>
</span><span id="line-421"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateServerFinished"><span class="hs-identifier hs-var">generateServerFinished</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><span class="hs-comment">-- | Generate the master secret from the pre master secret.</span></span><span>
</span><span id="line-424"></span><span id="local-6989586621679182694"><span class="annot"><a href="Network.TLS.Handshake.State.html#setMasterSecretFromPre"><span class="hs-identifier hs-type">setMasterSecretFromPre</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679182694"><span class="hs-identifier hs-type">preMaster</span></a></span><span>
</span><span id="line-425"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ chosen transmission version</span></span><span>
</span><span id="line-426"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ the role (Client or Server) of the generating side</span></span><span>
</span><span id="line-427"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679182694"><span class="hs-identifier hs-type">preMaster</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the pre master secret</span></span><span>
</span><span id="line-428"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-429"></span><span id="setMasterSecretFromPre"><span class="annot"><span class="annottext">setMasterSecretFromPre :: forall preMaster.
ByteArrayAccess preMaster =&gt;
Version -&gt; Role -&gt; preMaster -&gt; HandshakeM ByteString
</span><a href="Network.TLS.Handshake.State.html#setMasterSecretFromPre"><span class="hs-identifier hs-var hs-var">setMasterSecretFromPre</span></a></span></span><span> </span><span id="local-6989586621679183207"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183207"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183208"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183208"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621679183209"><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679183209"><span class="hs-identifier hs-var">premasterSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679183210"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183210"><span class="hs-identifier hs-var">ems</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HandshakeM Bool
</span><a href="Network.TLS.Handshake.State.html#getExtendedMasterSec"><span class="hs-identifier hs-var">getExtendedMasterSec</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679183211"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183211"><span class="hs-identifier hs-var">secret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679183210"><span class="hs-identifier hs-var">ems</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HandshakeM HandshakeState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">HandshakeM HandshakeState
-&gt; (HandshakeState -&gt; HandshakeM ByteString)
-&gt; HandshakeM ByteString
forall a b. HandshakeM a -&gt; (a -&gt; HandshakeM b) -&gt; HandshakeM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; HandshakeM ByteString
</span><a href="#local-6989586621679183212"><span class="hs-identifier hs-var">genExtendedSecret</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; ByteString
</span><a href="#local-6989586621679183213"><span class="hs-identifier hs-var">genSecret</span></a></span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; ByteString)
-&gt; HandshakeM HandshakeState -&gt; HandshakeM ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HandshakeM HandshakeState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="annottext">Version -&gt; Role -&gt; ByteString -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setMasterSecret"><span class="hs-identifier hs-var">setMasterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183207"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183208"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183211"><span class="hs-identifier hs-var">secret</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; HandshakeM ByteString
forall a. a -&gt; HandshakeM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183211"><span class="hs-identifier hs-var">secret</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183213"><span class="annot"><span class="annottext">genSecret :: HandshakeState -&gt; ByteString
</span><a href="#local-6989586621679183213"><span class="hs-identifier hs-var hs-var">genSecret</span></a></span></span><span> </span><span id="local-6989586621679183215"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183215"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>            </span><span class="annot"><span class="annottext">Version
-&gt; Cipher
-&gt; preMaster
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
forall preMaster.
ByteArrayAccess preMaster =&gt;
Version
-&gt; Cipher
-&gt; preMaster
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier hs-var">generateMasterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183207"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe Cipher -&gt; Cipher
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cipher&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cipher -&gt; Cipher) -&gt; Maybe Cipher -&gt; Cipher
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183215"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                                 </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679183209"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span>
</span><span id="line-437"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeState -&gt; ClientRandom
</span><a href="Network.TLS.Handshake.State.html#hstClientRandom"><span class="hs-identifier hs-var">hstClientRandom</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183215"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe ServerRandom -&gt; ServerRandom
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server random&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ServerRandom -&gt; ServerRandom)
-&gt; Maybe ServerRandom -&gt; ServerRandom
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerRandom
</span><a href="Network.TLS.Handshake.State.html#hstServerRandom"><span class="hs-identifier hs-var">hstServerRandom</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183215"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679183212"><span class="annot"><span class="annottext">genExtendedSecret :: HandshakeState -&gt; HandshakeM ByteString
</span><a href="#local-6989586621679183212"><span class="hs-identifier hs-var hs-var">genExtendedSecret</span></a></span></span><span> </span><span id="local-6989586621679183219"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183219"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-440"></span><span>            </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; preMaster -&gt; ByteString -&gt; ByteString
forall preMaster.
ByteArrayAccess preMaster =&gt;
Version -&gt; Cipher -&gt; preMaster -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateExtendedMasterSec"><span class="hs-identifier hs-var">generateExtendedMasterSec</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183207"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe Cipher -&gt; Cipher
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cipher&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cipher -&gt; Cipher) -&gt; Maybe Cipher -&gt; Cipher
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183219"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>                                      </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679183209"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span>
</span><span id="line-442"></span><span>                </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; HandshakeM ByteString -&gt; HandshakeM ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HandshakeM ByteString
</span><a href="Network.TLS.Handshake.State.html#getSessionHash"><span class="hs-identifier hs-var">getSessionHash</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- | Set master secret and as a side effect generate the key block</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- with all the right parameters, and setup the pending tx/rx state.</span><span>
</span><span id="line-446"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setMasterSecret"><span class="hs-identifier hs-type">setMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span id="setMasterSecret"><span class="annot"><span class="annottext">setMasterSecret :: Version -&gt; Role -&gt; ByteString -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setMasterSecret"><span class="hs-identifier hs-var hs-var">setMasterSecret</span></a></span></span><span> </span><span id="local-6989586621679183221"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183221"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183222"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183222"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621679183223"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183223"><span class="hs-identifier hs-var">masterSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183224"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183224"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679183225"><span class="annot"><span class="annottext">RecordState
</span><a href="#local-6989586621679183225"><span class="hs-identifier hs-var">pendingTx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183226"><span class="annot"><span class="annottext">RecordState
</span><a href="#local-6989586621679183226"><span class="hs-identifier hs-var">pendingRx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeState
-&gt; ByteString -&gt; Version -&gt; Role -&gt; (RecordState, RecordState)
</span><a href="Network.TLS.Handshake.State.html#computeKeyBlock"><span class="hs-identifier hs-var">computeKeyBlock</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183224"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183223"><span class="hs-identifier hs-var">masterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183221"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183222"><span class="hs-keyword hs-var">role</span></a></span><span>
</span><span id="line-449"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183224"><span class="hs-identifier hs-var">hst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstMasterSecret"><span class="hs-identifier hs-var">hstMasterSecret</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183223"><span class="hs-identifier hs-type">masterSecret</span></a></span><span>
</span><span id="line-450"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstPendingTxState"><span class="hs-identifier hs-var">hstPendingTxState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183225"><span class="hs-identifier hs-type">pendingTx</span></a></span><span>
</span><span id="line-451"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstPendingRxState"><span class="hs-identifier hs-var">hstPendingRxState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183226"><span class="hs-identifier hs-type">pendingRx</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#computeKeyBlock"><span class="hs-identifier hs-type">computeKeyBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeState"><span class="hs-identifier hs-type">HandshakeState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span id="computeKeyBlock"><span class="annot"><span class="annottext">computeKeyBlock :: HandshakeState
-&gt; ByteString -&gt; Version -&gt; Role -&gt; (RecordState, RecordState)
</span><a href="Network.TLS.Handshake.State.html#computeKeyBlock"><span class="hs-identifier hs-var hs-var">computeKeyBlock</span></a></span></span><span> </span><span id="local-6989586621679183228"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span id="local-6989586621679183229"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183229"><span class="hs-identifier hs-var">masterSecret</span></a></span></span><span> </span><span id="local-6989586621679183230"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183230"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183231"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RecordState
</span><a href="#local-6989586621679183232"><span class="hs-identifier hs-var">pendingTx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RecordState
</span><a href="#local-6989586621679183233"><span class="hs-identifier hs-var">pendingRx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183234"><span class="annot"><span class="annottext">cipher :: Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var hs-var">cipher</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Cipher -&gt; Cipher
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cipher&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cipher -&gt; Cipher) -&gt; Maybe Cipher -&gt; Cipher
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe Cipher
</span><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span id="local-6989586621679183235"><span class="annot"><span class="annottext">keyblockSize :: Int
</span><a href="#local-6989586621679183235"><span class="hs-identifier hs-var hs-var">keyblockSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Int
</span><a href="Network.TLS.Cipher.html#cipherKeyBlockSize"><span class="hs-identifier hs-var">cipherKeyBlockSize</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span>        </span><span id="local-6989586621679183237"><span class="annot"><span class="annottext">bulk :: Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var hs-var">bulk</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Bulk
</span><a href="Network.TLS.Cipher.html#cipherBulk"><span class="hs-identifier hs-var">cipherBulk</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621679183241"><span class="annot"><span class="annottext">digestSize :: Int
</span><a href="#local-6989586621679183241"><span class="hs-identifier hs-var hs-var">digestSize</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BulkFunctions -&gt; Bool
</span><a href="Network.TLS.Cipher.html#hasMAC"><span class="hs-identifier hs-var">hasMAC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bulk -&gt; BulkFunctions
</span><a href="Network.TLS.Cipher.html#bulkF"><span class="hs-identifier hs-var">bulkF</span></a></span><span> </span><span class="annot"><span class="annottext">Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var">bulk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; Int
</span><a href="Network.TLS.Crypto.html#hashDigestSize"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cipher -&gt; Hash
</span><a href="Network.TLS.Cipher.html#cipherHash"><span class="hs-identifier hs-var">cipherHash</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>                                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-461"></span><span>        </span><span id="local-6989586621679183246"><span class="annot"><span class="annottext">keySize :: Int
</span><a href="#local-6989586621679183246"><span class="hs-identifier hs-var hs-var">keySize</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bulk -&gt; Int
</span><a href="Network.TLS.Cipher.html#bulkKeySize"><span class="hs-identifier hs-var">bulkKeySize</span></a></span><span> </span><span class="annot"><span class="annottext">Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var">bulk</span></a></span><span>
</span><span id="line-462"></span><span>        </span><span id="local-6989586621679183248"><span class="annot"><span class="annottext">ivSize :: Int
</span><a href="#local-6989586621679183248"><span class="hs-identifier hs-var hs-var">ivSize</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bulk -&gt; Int
</span><a href="Network.TLS.Cipher.html#bulkIVSize"><span class="hs-identifier hs-var">bulkIVSize</span></a></span><span> </span><span class="annot"><span class="annottext">Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var">bulk</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679183250"><span class="annot"><span class="annottext">kb :: ByteString
</span><a href="#local-6989586621679183250"><span class="hs-identifier hs-var hs-var">kb</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version
-&gt; Cipher
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
-&gt; Int
-&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier hs-var">generateKeyBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183230"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeState -&gt; ClientRandom
</span><a href="Network.TLS.Handshake.State.html#hstClientRandom"><span class="hs-identifier hs-var">hstClientRandom</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe ServerRandom -&gt; ServerRandom
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;server random&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ServerRandom -&gt; ServerRandom)
-&gt; Maybe ServerRandom -&gt; ServerRandom
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Maybe ServerRandom
</span><a href="Network.TLS.Handshake.State.html#hstServerRandom"><span class="hs-identifier hs-var">hstServerRandom</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>                                        </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183229"><span class="hs-identifier hs-var">masterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183235"><span class="hs-identifier hs-var">keyblockSize</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679183252"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183252"><span class="hs-identifier hs-var">cMACSecret</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183253"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183253"><span class="hs-identifier hs-var">sMACSecret</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183254"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183254"><span class="hs-identifier hs-var">cWriteKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183255"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183255"><span class="hs-identifier hs-var">sWriteKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183256"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183256"><span class="hs-identifier hs-var">cWriteIV</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679183257"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183257"><span class="hs-identifier hs-var">sWriteIV</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span>                    </span><span class="annot"><span class="annottext">String
-&gt; Maybe
     (ByteString, ByteString, ByteString, ByteString, ByteString,
      ByteString)
-&gt; (ByteString, ByteString, ByteString, ByteString, ByteString,
    ByteString)
forall a. String -&gt; Maybe a -&gt; a
</span><a href="Network.TLS.Util.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;p6&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (ByteString, ByteString, ByteString, ByteString, ByteString,
    ByteString)
 -&gt; (ByteString, ByteString, ByteString, ByteString, ByteString,
     ByteString))
-&gt; Maybe
     (ByteString, ByteString, ByteString, ByteString, ByteString,
      ByteString)
-&gt; (ByteString, ByteString, ByteString, ByteString, ByteString,
    ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (Int, Int, Int, Int, Int, Int)
-&gt; Maybe
     (ByteString, ByteString, ByteString, ByteString, ByteString,
      ByteString)
</span><a href="Network.TLS.Util.html#partition6"><span class="hs-identifier hs-var">partition6</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183250"><span class="hs-identifier hs-var">kb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183241"><span class="hs-identifier hs-var">digestSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183241"><span class="hs-identifier hs-var">digestSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183246"><span class="hs-identifier hs-var">keySize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183246"><span class="hs-identifier hs-var">keySize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183248"><span class="hs-identifier hs-var">ivSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679183248"><span class="hs-identifier hs-var">ivSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>        </span><span id="local-6989586621679183259"><span class="annot"><span class="annottext">cstClient :: CryptState
</span><a href="#local-6989586621679183259"><span class="hs-identifier hs-var hs-var">cstClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptState"><span class="hs-identifier hs-type">CryptState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cstKey :: BulkState
</span><a href="Network.TLS.Record.State.html#cstKey"><span class="hs-identifier hs-var">cstKey</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bulk -&gt; BulkDirection -&gt; ByteString -&gt; BulkState
</span><a href="Network.TLS.Cipher.html#bulkInit"><span class="hs-identifier hs-var">bulkInit</span></a></span><span> </span><span class="annot"><span class="annottext">Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var">bulk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BulkDirection
</span><a href="Network.TLS.Cipher.html#BulkEncrypt"><span class="hs-identifier hs-var">BulkEncrypt</span></a></span><span> </span><span class="annot"><span class="annottext">BulkDirection -&gt; BulkDirection -&gt; BulkDirection
forall {p}. p -&gt; p -&gt; p
</span><a href="#local-6989586621679183264"><span class="hs-operator hs-var">`orOnServer`</span></a></span><span> </span><span class="annot"><span class="annottext">BulkDirection
</span><a href="Network.TLS.Cipher.html#BulkDecrypt"><span class="hs-identifier hs-var">BulkDecrypt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183254"><span class="hs-identifier hs-var">cWriteKey</span></a></span><span>
</span><span id="line-471"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cstIV :: ByteString
</span><a href="Network.TLS.Record.State.html#cstIV"><span class="hs-identifier hs-var">cstIV</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183256"><span class="hs-identifier hs-var">cWriteIV</span></a></span><span>
</span><span id="line-472"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cstMacSecret :: ByteString
</span><a href="Network.TLS.Record.State.html#cstMacSecret"><span class="hs-identifier hs-var">cstMacSecret</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183252"><span class="hs-identifier hs-var">cMACSecret</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-473"></span><span>        </span><span id="local-6989586621679183268"><span class="annot"><span class="annottext">cstServer :: CryptState
</span><a href="#local-6989586621679183268"><span class="hs-identifier hs-var hs-var">cstServer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#CryptState"><span class="hs-identifier hs-type">CryptState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cstKey :: BulkState
</span><a href="Network.TLS.Record.State.html#cstKey"><span class="hs-identifier hs-var">cstKey</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bulk -&gt; BulkDirection -&gt; ByteString -&gt; BulkState
</span><a href="Network.TLS.Cipher.html#bulkInit"><span class="hs-identifier hs-var">bulkInit</span></a></span><span> </span><span class="annot"><span class="annottext">Bulk
</span><a href="#local-6989586621679183237"><span class="hs-identifier hs-var">bulk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BulkDirection
</span><a href="Network.TLS.Cipher.html#BulkDecrypt"><span class="hs-identifier hs-var">BulkDecrypt</span></a></span><span> </span><span class="annot"><span class="annottext">BulkDirection -&gt; BulkDirection -&gt; BulkDirection
forall {p}. p -&gt; p -&gt; p
</span><a href="#local-6989586621679183264"><span class="hs-operator hs-var">`orOnServer`</span></a></span><span> </span><span class="annot"><span class="annottext">BulkDirection
</span><a href="Network.TLS.Cipher.html#BulkEncrypt"><span class="hs-identifier hs-var">BulkEncrypt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183255"><span class="hs-identifier hs-var">sWriteKey</span></a></span><span>
</span><span id="line-474"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cstIV :: ByteString
</span><a href="Network.TLS.Record.State.html#cstIV"><span class="hs-identifier hs-var">cstIV</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183257"><span class="hs-identifier hs-var">sWriteIV</span></a></span><span>
</span><span id="line-475"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cstMacSecret :: ByteString
</span><a href="Network.TLS.Record.State.html#cstMacSecret"><span class="hs-identifier hs-var">cstMacSecret</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679183253"><span class="hs-identifier hs-var">sMACSecret</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>        </span><span id="local-6989586621679183271"><span class="annot"><span class="annottext">msClient :: MacState
</span><a href="#local-6989586621679183271"><span class="hs-identifier hs-var hs-var">msClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#MacState"><span class="hs-identifier hs-type">MacState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">msSequence :: Word64
</span><a href="Network.TLS.Record.State.html#msSequence"><span class="hs-identifier hs-var">msSequence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621679183275"><span class="annot"><span class="annottext">msServer :: MacState
</span><a href="#local-6989586621679183275"><span class="hs-identifier hs-var hs-var">msServer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#MacState"><span class="hs-identifier hs-type">MacState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">msSequence :: Word64
</span><a href="Network.TLS.Record.State.html#msSequence"><span class="hs-identifier hs-var">msSequence</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>        </span><span id="local-6989586621679183232"><span class="annot"><span class="annottext">pendingTx :: RecordState
</span><a href="#local-6989586621679183232"><span class="hs-identifier hs-var hs-var">pendingTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span>
</span><span id="line-480"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stCryptState :: CryptState
</span><a href="Network.TLS.Record.State.html#stCryptState"><span class="hs-identifier hs-var">stCryptState</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CryptState
</span><a href="#local-6989586621679183259"><span class="hs-identifier hs-var">cstClient</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CryptState
</span><a href="#local-6989586621679183268"><span class="hs-identifier hs-var">cstServer</span></a></span><span>
</span><span id="line-481"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stMacState :: MacState
</span><a href="Network.TLS.Record.State.html#stMacState"><span class="hs-identifier hs-var">stMacState</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MacState
</span><a href="#local-6989586621679183271"><span class="hs-identifier hs-var">msClient</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">MacState
</span><a href="#local-6989586621679183275"><span class="hs-identifier hs-var">msServer</span></a></span><span>
</span><span id="line-482"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCryptLevel :: CryptLevel
</span><a href="Network.TLS.Record.State.html#stCryptLevel"><span class="hs-identifier hs-var">stCryptLevel</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptLevel
</span><a href="Network.TLS.Record.State.html#CryptMasterSecret"><span class="hs-identifier hs-var">CryptMasterSecret</span></a></span><span>
</span><span id="line-483"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCipher :: Maybe Cipher
</span><a href="Network.TLS.Record.State.html#stCipher"><span class="hs-identifier hs-var">stCipher</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Maybe Cipher
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span>
</span><span id="line-484"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCompression :: Compression
</span><a href="Network.TLS.Record.State.html#stCompression"><span class="hs-identifier hs-var">stCompression</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Compression
</span><a href="Network.TLS.Handshake.State.html#hstPendingCompression"><span class="hs-identifier hs-var">hstPendingCompression</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-485"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-486"></span><span>        </span><span id="local-6989586621679183233"><span class="annot"><span class="annottext">pendingRx :: RecordState
</span><a href="#local-6989586621679183233"><span class="hs-identifier hs-var hs-var">pendingRx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Network.TLS.Record.State.html#RecordState"><span class="hs-identifier hs-type">RecordState</span></a></span><span>
</span><span id="line-487"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stCryptState :: CryptState
</span><a href="Network.TLS.Record.State.html#stCryptState"><span class="hs-identifier hs-var">stCryptState</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CryptState
</span><a href="#local-6989586621679183268"><span class="hs-identifier hs-var">cstServer</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CryptState
</span><a href="#local-6989586621679183259"><span class="hs-identifier hs-var">cstClient</span></a></span><span>
</span><span id="line-488"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stMacState :: MacState
</span><a href="Network.TLS.Record.State.html#stMacState"><span class="hs-identifier hs-var">stMacState</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MacState
</span><a href="#local-6989586621679183275"><span class="hs-identifier hs-var">msServer</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">MacState
</span><a href="#local-6989586621679183271"><span class="hs-identifier hs-var">msClient</span></a></span><span>
</span><span id="line-489"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCryptLevel :: CryptLevel
</span><a href="Network.TLS.Record.State.html#stCryptLevel"><span class="hs-identifier hs-var">stCryptLevel</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CryptLevel
</span><a href="Network.TLS.Record.State.html#CryptMasterSecret"><span class="hs-identifier hs-var">CryptMasterSecret</span></a></span><span>
</span><span id="line-490"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCipher :: Maybe Cipher
</span><a href="Network.TLS.Record.State.html#stCipher"><span class="hs-identifier hs-var">stCipher</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Maybe Cipher
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183234"><span class="hs-identifier hs-var">cipher</span></a></span><span>
</span><span id="line-491"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stCompression :: Compression
</span><a href="Network.TLS.Record.State.html#stCompression"><span class="hs-identifier hs-var">stCompression</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HandshakeState -&gt; Compression
</span><a href="Network.TLS.Handshake.State.html#hstPendingCompression"><span class="hs-identifier hs-var">hstPendingCompression</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183228"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-492"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>        </span><span id="local-6989586621679183264"><span class="annot"><span class="annottext">orOnServer :: p -&gt; p -&gt; p
</span><a href="#local-6989586621679183264"><span class="hs-identifier hs-var hs-var">orOnServer</span></a></span></span><span> </span><span id="local-6989586621679183288"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679183288"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679183289"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679183289"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679183231"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Role -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Network.TLS.Types.html#ClientRole"><span class="hs-identifier hs-var">ClientRole</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679183288"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679183289"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#setServerHelloParameters"><span class="hs-identifier hs-type">setServerHelloParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ chosen version</span></span><span>
</span><span id="line-498"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span>
</span><span id="line-499"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-500"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Compression.html#Compression"><span class="hs-identifier hs-type">Compression</span></a></span><span>
</span><span id="line-501"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeM"><span class="hs-identifier hs-type">HandshakeM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span id="setServerHelloParameters"><span class="annot"><span class="annottext">setServerHelloParameters :: Version -&gt; ServerRandom -&gt; Cipher -&gt; Compression -&gt; HandshakeM ()
</span><a href="Network.TLS.Handshake.State.html#setServerHelloParameters"><span class="hs-identifier hs-var hs-var">setServerHelloParameters</span></a></span></span><span> </span><span id="local-6989586621679183290"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183290"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183291"><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679183291"><span class="hs-identifier hs-var">sran</span></a></span></span><span> </span><span id="local-6989586621679183292"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183292"><span class="hs-identifier hs-var">cipher</span></a></span></span><span> </span><span id="local-6989586621679183293"><span class="annot"><span class="annottext">Compression
</span><a href="#local-6989586621679183293"><span class="hs-identifier hs-var">compression</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="annottext">(HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ())
-&gt; (HandshakeState -&gt; HandshakeState) -&gt; HandshakeM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679183294"><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183294"><span class="hs-identifier hs-var">hst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeState
</span><a href="#local-6989586621679183294"><span class="hs-identifier hs-var">hst</span></a></span><span>
</span><span id="line-504"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstServerRandom"><span class="hs-identifier hs-var">hstServerRandom</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183291"><span class="hs-identifier hs-type">sran</span></a></span><span>
</span><span id="line-505"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstPendingCipher"><span class="hs-identifier hs-var">hstPendingCipher</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679183292"><span class="hs-identifier hs-type">cipher</span></a></span><span>
</span><span id="line-506"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstPendingCompression"><span class="hs-identifier hs-var">hstPendingCompression</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183293"><span class="hs-identifier hs-type">compression</span></a></span><span>
</span><span id="line-507"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679183295"><span class="hs-identifier hs-type">updateDigest</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Network.TLS.Handshake.State.html#hstHandshakeDigest"><span class="hs-identifier hs-var">hstHandshakeDigest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679183294"><span class="hs-identifier hs-type">hst</span></a></span><span>
</span><span id="line-508"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679183296"><span class="annot"><span class="annottext">hashAlg :: Hash
</span><a href="#local-6989586621679183296"><span class="hs-identifier hs-var hs-var">hashAlg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; Hash
</span><a href="Network.TLS.Handshake.State.html#getHash"><span class="hs-identifier hs-var">getHash</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183290"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183292"><span class="hs-identifier hs-var">cipher</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span id="local-6989586621679183295"><span class="annot"><span class="annottext">updateDigest :: HandshakeDigest -&gt; HandshakeDigest
</span><a href="#local-6989586621679183295"><span class="hs-identifier hs-var hs-var">updateDigest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeMessages"><span class="hs-identifier hs-type">HandshakeMessages</span></a></span><span> </span><span id="local-6989586621679183301"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183301"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; HandshakeDigest
</span><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-var">HandshakeDigestContext</span></a></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; HandshakeDigest) -&gt; HashCtx -&gt; HandshakeDigest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString -&gt; HashCtx)
-&gt; HashCtx -&gt; [ByteString] -&gt; HashCtx
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hash -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashInit"><span class="hs-identifier hs-var">hashInit</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="#local-6989586621679183296"><span class="hs-identifier hs-var">hashAlg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; HashCtx) -&gt; [ByteString] -&gt; HashCtx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679183301"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><a href="#local-6989586621679183295"><span class="hs-identifier hs-var">updateDigest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Handshake.State.html#HandshakeDigestContext"><span class="hs-identifier hs-type">HandshakeDigestContext</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; HandshakeDigest
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot initialize digest with another digest&quot;</span></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">-- The TLS12 Hash is cipher specific, and some TLS12 algorithms use SHA384</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- instead of the default SHA256.</span><span>
</span><span id="line-515"></span><span class="annot"><a href="Network.TLS.Handshake.State.html#getHash"><span class="hs-identifier hs-type">getHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span>
</span><span id="line-516"></span><span id="getHash"><span class="annot"><span class="annottext">getHash :: Version -&gt; Cipher -&gt; Hash
</span><a href="Network.TLS.Handshake.State.html#getHash"><span class="hs-identifier hs-var hs-var">getHash</span></a></span></span><span> </span><span id="local-6989586621679183302"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183302"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679183303"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183303"><span class="hs-identifier hs-var">ciph</span></a></span></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679183302"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA1_MD5"><span class="hs-identifier hs-var">SHA1_MD5</span></a></span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Version -&gt; Bool) -&gt; Maybe Version -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cipher -&gt; Maybe Version
</span><a href="Network.TLS.Cipher.html#cipherMinVer"><span class="hs-identifier hs-var">cipherMinVer</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183303"><span class="hs-identifier hs-var">ciph</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-var">SHA256</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Hash
</span><a href="Network.TLS.Cipher.html#cipherHash"><span class="hs-identifier hs-var">cipherHash</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679183303"><span class="hs-identifier hs-var">ciph</span></a></span><span>
</span><span id="line-520"></span></pre></body></html>