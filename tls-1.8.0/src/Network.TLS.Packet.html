<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      : Network.TLS.Packet</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Portability : unknown</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- the Packet module contains everything necessary to serialize and deserialize things</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- with only explicit parameters, no TLS state is involved here.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Network.TLS.Packet</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * params for encoding and decoding</span></span><span>
</span><span id="line-15"></span><span>      </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier">CurrentParams</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * marshall functions for header messages</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeHeader"><span class="hs-identifier">decodeHeader</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHeaderLength"><span class="hs-identifier">decodeDeprecatedHeaderLength</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHeader"><span class="hs-identifier">decodeDeprecatedHeader</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeHeader"><span class="hs-identifier">encodeHeader</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeHeaderNoVer"><span class="hs-identifier">encodeHeaderNoVer</span></a></span><span> </span><span class="hs-comment">-- use for SSL3</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * marshall functions for alert messages</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeAlert"><span class="hs-identifier">decodeAlert</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeAlerts"><span class="hs-identifier">decodeAlerts</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeAlerts"><span class="hs-identifier">encodeAlerts</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * marshall functions for handshake messages</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeHandshakeRecord"><span class="hs-identifier">decodeHandshakeRecord</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeHandshake"><span class="hs-identifier">decodeHandshake</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHandshake"><span class="hs-identifier">decodeDeprecatedHandshake</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshake"><span class="hs-identifier">encodeHandshake</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeHeader"><span class="hs-identifier">encodeHandshakeHeader</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier">encodeHandshakeContent</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * marshall functions for change cipher spec message</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeChangeCipherSpec"><span class="hs-identifier">decodeChangeCipherSpec</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeChangeCipherSpec"><span class="hs-identifier">encodeChangeCipherSpec</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodePreMasterSecret"><span class="hs-identifier">decodePreMasterSecret</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodePreMasterSecret"><span class="hs-identifier">encodePreMasterSecret</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeSignedDHParams"><span class="hs-identifier">encodeSignedDHParams</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#encodeSignedECDHParams"><span class="hs-identifier">encodeSignedECDHParams</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#decodeReallyServerKeyXchgAlgorithmData"><span class="hs-identifier">decodeReallyServerKeyXchgAlgorithmData</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- * generate things for packet content</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier">generateMasterSecret</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateExtendedMasterSec"><span class="hs-identifier">generateExtendedMasterSec</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier">generateKeyBlock</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateClientFinished"><span class="hs-identifier">generateClientFinished</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateServerFinished"><span class="hs-identifier">generateServerFinished</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL"><span class="hs-identifier">generateCertificateVerify_SSL</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL_DSS"><span class="hs-identifier">generateCertificateVerify_SSL_DSS</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * for extensions parsing</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getSignatureHashAlgorithm"><span class="hs-identifier">getSignatureHashAlgorithm</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putSignatureHashAlgorithm"><span class="hs-identifier">putSignatureHashAlgorithm</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getBinaryVersion"><span class="hs-identifier">getBinaryVersion</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier">putBinaryVersion</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getClientRandom32"><span class="hs-identifier">getClientRandom32</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier">putClientRandom32</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getServerRandom32"><span class="hs-identifier">getServerRandom32</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier">putServerRandom32</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier">getExtensions</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putExtension"><span class="hs-identifier">putExtension</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getSession"><span class="hs-identifier">getSession</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier">putSession</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#putDNames"><span class="hs-identifier">putDNames</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#getDNames"><span class="hs-identifier">getDNames</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Imports.html"><span class="hs-identifier">Network.TLS.Imports</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html"><span class="hs-identifier">Network.TLS.Struct</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Wire.html"><span class="hs-identifier">Network.TLS.Wire</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Cap.html"><span class="hs-identifier">Network.TLS.Cap</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.X509</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CertificateChainRaw</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encodeCertificateChain</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">decodeCertificateChain</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html"><span class="hs-identifier">Network.TLS.Crypto</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.MAC.html"><span class="hs-identifier">Network.TLS.MAC</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html"><span class="hs-identifier">Network.TLS.Cipher</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Cipher.html#CipherKeyExchangeType"><span class="hs-identifier">CipherKeyExchangeType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier">Cipher</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.TLS.Util.ASN1.html"><span class="hs-identifier">Network.TLS.Util.ASN1</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BC</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteArrayAccess</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteArray</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">convert</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="CurrentParams"><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-var">CurrentParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CurrentParams"><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-var">CurrentParams</span></a></span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="cParamsVersion"><span class="annot"><span class="annottext">CurrentParams -&gt; Version
</span><a href="Network.TLS.Packet.html#cParamsVersion"><span class="hs-identifier hs-var hs-var">cParamsVersion</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ current protocol version</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="cParamsKeyXchgType"><span class="annot"><span class="annottext">CurrentParams -&gt; Maybe CipherKeyExchangeType
</span><a href="Network.TLS.Packet.html#cParamsKeyXchgType"><span class="hs-identifier hs-var hs-var">cParamsKeyXchgType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#CipherKeyExchangeType"><span class="hs-identifier hs-type">CipherKeyExchangeType</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ current key exchange type</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180114"><span id="local-6989586621679180122"><span id="local-6989586621679180126"><span class="annot"><span class="annottext">Int -&gt; CurrentParams -&gt; ShowS
[CurrentParams] -&gt; ShowS
CurrentParams -&gt; [Char]
(Int -&gt; CurrentParams -&gt; ShowS)
-&gt; (CurrentParams -&gt; [Char])
-&gt; ([CurrentParams] -&gt; ShowS)
-&gt; Show CurrentParams
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CurrentParams -&gt; ShowS
showsPrec :: Int -&gt; CurrentParams -&gt; ShowS
$cshow :: CurrentParams -&gt; [Char]
show :: CurrentParams -&gt; [Char]
$cshowList :: [CurrentParams] -&gt; ShowS
showList :: [CurrentParams] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679180131"><span id="local-6989586621679180138"><span class="annot"><span class="annottext">CurrentParams -&gt; CurrentParams -&gt; Bool
(CurrentParams -&gt; CurrentParams -&gt; Bool)
-&gt; (CurrentParams -&gt; CurrentParams -&gt; Bool) -&gt; Eq CurrentParams
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CurrentParams -&gt; CurrentParams -&gt; Bool
== :: CurrentParams -&gt; CurrentParams -&gt; Bool
$c/= :: CurrentParams -&gt; CurrentParams -&gt; Bool
/= :: CurrentParams -&gt; CurrentParams -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">{- marshall helpers -}</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-type">getVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-95"></span><span id="getVersion"><span class="annot"><span class="annottext">getVersion :: Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var hs-var">getVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679180144"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">major</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679180146"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180146"><span class="hs-identifier hs-var">minor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Word8, Word8) -&gt; Maybe Version
</span><a href="Network.TLS.Struct.html#verOfNum"><span class="hs-identifier hs-var">verOfNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">major</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180146"><span class="hs-identifier hs-var">minor</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">Maybe Version
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Version
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid version : &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180144"><span class="hs-identifier hs-var">major</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180146"><span class="hs-identifier hs-var">minor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180149"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180149"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get Version
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180149"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Network.TLS.Packet.html#getBinaryVersion"><span class="hs-identifier hs-type">getBinaryVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span id="getBinaryVersion"><span class="annot"><span class="annottext">getBinaryVersion :: Get (Maybe Version)
</span><a href="Network.TLS.Packet.html#getBinaryVersion"><span class="hs-identifier hs-var hs-var">getBinaryVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679180150"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180150"><span class="hs-identifier hs-var">major</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679180151"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180151"><span class="hs-identifier hs-var">minor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">Maybe Version -&gt; Get (Maybe Version)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Version -&gt; Get (Maybe Version))
-&gt; Maybe Version -&gt; Get (Maybe Version)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Word8, Word8) -&gt; Maybe Version
</span><a href="Network.TLS.Struct.html#verOfNum"><span class="hs-identifier hs-var">verOfNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180150"><span class="hs-identifier hs-var">major</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180151"><span class="hs-identifier hs-var">minor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-type">putBinaryVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-109"></span><span id="putBinaryVersion"><span class="annot"><span class="annottext">putBinaryVersion :: Version -&gt; Put
</span><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-var hs-var">putBinaryVersion</span></a></span></span><span> </span><span id="local-6989586621679180152"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180152"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180154"><span class="hs-identifier hs-var">major</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180155"><span class="hs-identifier hs-var">minor</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180154"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180154"><span class="hs-identifier hs-var">major</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180155"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180155"><span class="hs-identifier hs-var">minor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; (Word8, Word8)
</span><a href="Network.TLS.Struct.html#numericalVer"><span class="hs-identifier hs-var">numericalVer</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180152"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Network.TLS.Packet.html#getHeaderType"><span class="hs-identifier hs-type">getHeaderType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ProtocolType"><span class="hs-identifier hs-type">ProtocolType</span></a></span><span>
</span><span id="line-113"></span><span id="getHeaderType"><span class="annot"><span class="annottext">getHeaderType :: Get ProtocolType
</span><a href="Network.TLS.Packet.html#getHeaderType"><span class="hs-identifier hs-var hs-var">getHeaderType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679180158"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180158"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe ProtocolType
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180158"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">Maybe ProtocolType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get ProtocolType
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid header type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180158"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180160"><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180160"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProtocolType -&gt; Get ProtocolType
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180160"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Network.TLS.Packet.html#putHeaderType"><span class="hs-identifier hs-type">putHeaderType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ProtocolType"><span class="hs-identifier hs-type">ProtocolType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-120"></span><span id="putHeaderType"><span class="annot"><span class="annottext">putHeaderType :: ProtocolType -&gt; Put
</span><a href="Network.TLS.Packet.html#putHeaderType"><span class="hs-identifier hs-var hs-var">putHeaderType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Putter Word8 -&gt; (ProtocolType -&gt; Word8) -&gt; ProtocolType -&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProtocolType -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Network.TLS.Packet.html#getHandshakeType"><span class="hs-identifier hs-type">getHandshakeType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span>
</span><span id="line-123"></span><span id="getHandshakeType"><span class="annot"><span class="annottext">getHandshakeType :: Get HandshakeType
</span><a href="Network.TLS.Packet.html#getHandshakeType"><span class="hs-identifier hs-var hs-var">getHandshakeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679180165"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180165"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe HandshakeType
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180165"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">Maybe HandshakeType
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get HandshakeType
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid handshake type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180165"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180166"><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180166"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HandshakeType -&gt; Get HandshakeType
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180166"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">{-
 - decode and encode headers
 -}</span><span>
</span><span id="line-132"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeHeader"><span class="hs-identifier hs-type">decodeHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span>
</span><span id="line-133"></span><span id="decodeHeader"><span class="annot"><span class="annottext">decodeHeader :: ByteString -&gt; Either TLSError Header
</span><a href="Network.TLS.Packet.html#decodeHeader"><span class="hs-identifier hs-var hs-var">decodeHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Header -&gt; ByteString -&gt; Either TLSError Header
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;header&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get Header -&gt; ByteString -&gt; Either TLSError Header)
-&gt; Get Header -&gt; ByteString -&gt; Either TLSError Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProtocolType -&gt; Version -&gt; Word16 -&gt; Header
</span><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-var">Header</span></a></span><span> </span><span class="annot"><span class="annottext">(ProtocolType -&gt; Version -&gt; Word16 -&gt; Header)
-&gt; Get ProtocolType -&gt; Get (Version -&gt; Word16 -&gt; Header)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ProtocolType
</span><a href="Network.TLS.Packet.html#getHeaderType"><span class="hs-identifier hs-var">getHeaderType</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Version -&gt; Word16 -&gt; Header)
-&gt; Get Version -&gt; Get (Word16 -&gt; Header)
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Word16 -&gt; Header) -&gt; Get Word16 -&gt; Get Header
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHeaderLength"><span class="hs-identifier hs-type">decodeDeprecatedHeaderLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-136"></span><span id="decodeDeprecatedHeaderLength"><span class="annot"><span class="annottext">decodeDeprecatedHeaderLength :: ByteString -&gt; Either TLSError Word16
</span><a href="Network.TLS.Packet.html#decodeDeprecatedHeaderLength"><span class="hs-identifier hs-var hs-var">decodeDeprecatedHeaderLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Word16 -&gt; ByteString -&gt; Either TLSError Word16
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;deprecatedheaderlength&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get Word16 -&gt; ByteString -&gt; Either TLSError Word16)
-&gt; Get Word16 -&gt; ByteString -&gt; Either TLSError Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0x8000</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Word16) -&gt; Get Word16 -&gt; Get Word16
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHeader"><span class="hs-identifier hs-type">decodeDeprecatedHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span>
</span><span id="line-139"></span><span id="decodeDeprecatedHeader"><span class="annot"><span class="annottext">decodeDeprecatedHeader :: Word16 -&gt; ByteString -&gt; Either TLSError Header
</span><a href="Network.TLS.Packet.html#decodeDeprecatedHeader"><span class="hs-identifier hs-var hs-var">decodeDeprecatedHeader</span></a></span></span><span> </span><span id="local-6989586621679180172"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180172"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; Get Header -&gt; ByteString -&gt; Either TLSError Header
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;deprecatedheader&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get Header -&gt; ByteString -&gt; Either TLSError Header)
-&gt; Get Header -&gt; ByteString -&gt; Either TLSError Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679180173"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180173"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">Header -&gt; Get Header
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Header -&gt; Get Header) -&gt; Header -&gt; Get Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProtocolType -&gt; Version -&gt; Word16 -&gt; Header
</span><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-var">Header</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolType
</span><a href="Network.TLS.Struct.html#ProtocolType_DeprecatedHandshake"><span class="hs-identifier hs-var">ProtocolType_DeprecatedHandshake</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180173"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180172"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHeader"><span class="hs-identifier hs-type">encodeHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-146"></span><span id="encodeHeader"><span class="annot"><span class="annottext">encodeHeader :: Header -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeHeader"><span class="hs-identifier hs-var hs-var">encodeHeader</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span id="local-6989586621679180175"><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180175"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span id="local-6989586621679180176"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180176"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180177"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180177"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolType -&gt; Put
</span><a href="Network.TLS.Packet.html#putHeaderType"><span class="hs-identifier hs-var">putHeaderType</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180175"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Put
</span><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-var">putBinaryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180176"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180177"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-comment">{- FIXME check len &lt;= 2^14 -}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHeaderNoVer"><span class="hs-identifier hs-type">encodeHeaderNoVer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-150"></span><span id="encodeHeaderNoVer"><span class="annot"><span class="annottext">encodeHeaderNoVer :: Header -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeHeaderNoVer"><span class="hs-identifier hs-var hs-var">encodeHeaderNoVer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span id="local-6989586621679180180"><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180180"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679180181"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180181"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolType -&gt; Put
</span><a href="Network.TLS.Packet.html#putHeaderType"><span class="hs-identifier hs-var">putHeaderType</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolType
</span><a href="#local-6989586621679180180"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180181"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-comment">{- FIXME check len &lt;= 2^14 -}</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">{-
 - decode and encode ALERT
 -}</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeAlert"><span class="hs-identifier hs-type">decodeAlert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#AlertLevel"><span class="hs-identifier hs-type">AlertLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span id="decodeAlert"><span class="annot"><span class="annottext">decodeAlert :: Get (AlertLevel, AlertDescription)
</span><a href="Network.TLS.Packet.html#decodeAlert"><span class="hs-identifier hs-var hs-var">decodeAlert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679180182"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180182"><span class="hs-identifier hs-var">al</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679180183"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180183"><span class="hs-identifier hs-var">ad</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe AlertLevel
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180182"><span class="hs-identifier hs-var">al</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe AlertDescription
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180183"><span class="hs-identifier hs-var">ad</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180184"><span class="annot"><span class="annottext">AlertLevel
</span><a href="#local-6989586621679180184"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180185"><span class="annot"><span class="annottext">AlertDescription
</span><a href="#local-6989586621679180185"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(AlertLevel, AlertDescription)
-&gt; Get (AlertLevel, AlertDescription)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlertLevel
</span><a href="#local-6989586621679180184"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlertDescription
</span><a href="#local-6989586621679180185"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AlertLevel
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe AlertDescription
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get (AlertLevel, AlertDescription)
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cannot decode alert level&quot;</span></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AlertLevel
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe AlertDescription
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get (AlertLevel, AlertDescription)
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cannot decode alert description&quot;</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeAlerts"><span class="hs-identifier hs-type">decodeAlerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#AlertLevel"><span class="hs-identifier hs-type">AlertLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span id="decodeAlerts"><span class="annot"><span class="annottext">decodeAlerts :: ByteString -&gt; Either TLSError [(AlertLevel, AlertDescription)]
</span><a href="Network.TLS.Packet.html#decodeAlerts"><span class="hs-identifier hs-var hs-var">decodeAlerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Get [(AlertLevel, AlertDescription)]
-&gt; ByteString
-&gt; Either TLSError [(AlertLevel, AlertDescription)]
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;alerts&quot;</span></span><span> </span><span class="annot"><span class="annottext">Get [(AlertLevel, AlertDescription)]
</span><a href="#local-6989586621679180186"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180186"><span class="annot"><span class="annottext">loop :: Get [(AlertLevel, AlertDescription)]
</span><a href="#local-6989586621679180186"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>            </span><span id="local-6989586621679180193"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180193"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180193"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-170"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(AlertLevel, AlertDescription)]
-&gt; Get [(AlertLevel, AlertDescription)]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((AlertLevel, AlertDescription)
 -&gt; [(AlertLevel, AlertDescription)]
 -&gt; [(AlertLevel, AlertDescription)])
-&gt; Get (AlertLevel, AlertDescription)
-&gt; Get
     ([(AlertLevel, AlertDescription)]
      -&gt; [(AlertLevel, AlertDescription)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get (AlertLevel, AlertDescription)
</span><a href="Network.TLS.Packet.html#decodeAlert"><span class="hs-identifier hs-var">decodeAlert</span></a></span><span> </span><span class="annot"><span class="annottext">Get
  ([(AlertLevel, AlertDescription)]
   -&gt; [(AlertLevel, AlertDescription)])
-&gt; Get [(AlertLevel, AlertDescription)]
-&gt; Get [(AlertLevel, AlertDescription)]
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get [(AlertLevel, AlertDescription)]
</span><a href="#local-6989586621679180186"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeAlerts"><span class="hs-identifier hs-type">encodeAlerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#AlertLevel"><span class="hs-identifier hs-type">AlertLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#AlertDescription"><span class="hs-identifier hs-type">AlertDescription</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-174"></span><span id="encodeAlerts"><span class="annot"><span class="annottext">encodeAlerts :: [(AlertLevel, AlertDescription)] -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeAlerts"><span class="hs-identifier hs-var hs-var">encodeAlerts</span></a></span></span><span> </span><span id="local-6989586621679180195"><span class="annot"><span class="annottext">[(AlertLevel, AlertDescription)]
</span><a href="#local-6989586621679180195"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((AlertLevel, AlertDescription) -&gt; Put)
-&gt; [(AlertLevel, AlertDescription)] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(AlertLevel, AlertDescription) -&gt; Put
forall {a} {a}. (TypeValuable a, TypeValuable a) =&gt; (a, a) -&gt; Put
</span><a href="#local-6989586621679180197"><span class="hs-identifier hs-var">encodeAlert</span></a></span><span> </span><span class="annot"><span class="annottext">[(AlertLevel, AlertDescription)]
</span><a href="#local-6989586621679180195"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180197"><span class="annot"><span class="annottext">encodeAlert :: (a, a) -&gt; Put
</span><a href="#local-6989586621679180197"><span class="hs-identifier hs-var hs-var">encodeAlert</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180203"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180203"><span class="hs-identifier hs-var">al</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180204"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180204"><span class="hs-identifier hs-var">ad</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180203"><span class="hs-identifier hs-var">al</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180204"><span class="hs-identifier hs-var">ad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">{- decode and encode HANDSHAKE -}</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeHandshakeRecord"><span class="hs-identifier hs-type">decodeHandshakeRecord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Wire.html#GetResult"><span class="hs-identifier hs-type">GetResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span id="decodeHandshakeRecord"><span class="annot"><span class="annottext">decodeHandshakeRecord :: ByteString -&gt; GetResult (HandshakeType, ByteString)
</span><a href="Network.TLS.Packet.html#decodeHandshakeRecord"><span class="hs-identifier hs-var hs-var">decodeHandshakeRecord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Get (HandshakeType, ByteString)
-&gt; ByteString
-&gt; GetResult (HandshakeType, ByteString)
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; GetResult a
</span><a href="Network.TLS.Wire.html#runGet"><span class="hs-identifier hs-var">runGet</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;handshake-record&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get (HandshakeType, ByteString)
 -&gt; ByteString -&gt; GetResult (HandshakeType, ByteString))
-&gt; Get (HandshakeType, ByteString)
-&gt; ByteString
-&gt; GetResult (HandshakeType, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679180206"><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180206"><span class="hs-identifier hs-var">ty</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get HandshakeType
</span><a href="Network.TLS.Packet.html#getHandshakeType"><span class="hs-identifier hs-var">getHandshakeType</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679180207"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180207"><span class="hs-identifier hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque24"><span class="hs-identifier hs-var">getOpaque24</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">(HandshakeType, ByteString) -&gt; Get (HandshakeType, ByteString)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180206"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180207"><span class="hs-identifier hs-var">content</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeHandshake"><span class="hs-identifier hs-type">decodeHandshake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-type">CurrentParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-185"></span><span id="decodeHandshake"><span class="annot"><span class="annottext">decodeHandshake :: CurrentParams
-&gt; HandshakeType -&gt; ByteString -&gt; Either TLSError Handshake
</span><a href="Network.TLS.Packet.html#decodeHandshake"><span class="hs-identifier hs-var hs-var">decodeHandshake</span></a></span></span><span> </span><span id="local-6989586621679180209"><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180209"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span id="local-6989586621679180210"><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180210"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Handshake -&gt; ByteString -&gt; Either TLSError Handshake
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;handshake[&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">HandshakeType -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180210"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get Handshake -&gt; ByteString -&gt; Either TLSError Handshake)
-&gt; Get Handshake -&gt; ByteString -&gt; Either TLSError Handshake
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180210"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_HelloRequest"><span class="hs-identifier hs-var">HandshakeType_HelloRequest</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeHelloRequest"><span class="hs-identifier hs-var">decodeHelloRequest</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientHello"><span class="hs-identifier hs-var">HandshakeType_ClientHello</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeClientHello"><span class="hs-identifier hs-var">decodeClientHello</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHello"><span class="hs-identifier hs-var">HandshakeType_ServerHello</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerHello"><span class="hs-identifier hs-var">decodeServerHello</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Certificate"><span class="hs-identifier hs-var">HandshakeType_Certificate</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertificates"><span class="hs-identifier hs-var">decodeCertificates</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ServerKeyXchg</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg"><span class="hs-identifier hs-var">decodeServerKeyXchg</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180209"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertRequest"><span class="hs-identifier hs-var">HandshakeType_CertRequest</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertRequest"><span class="hs-identifier hs-var">decodeCertRequest</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180209"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ServerHelloDone"><span class="hs-identifier hs-var">HandshakeType_ServerHelloDone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerHelloDone"><span class="hs-identifier hs-var">decodeServerHelloDone</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_CertVerify"><span class="hs-identifier hs-var">HandshakeType_CertVerify</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertVerify"><span class="hs-identifier hs-var">decodeCertVerify</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180209"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_ClientKeyXchg"><span class="hs-identifier hs-var">HandshakeType_ClientKeyXchg</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeClientKeyXchg"><span class="hs-identifier hs-var">decodeClientKeyXchg</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180209"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="Network.TLS.Struct.html#HandshakeType_Finished"><span class="hs-identifier hs-var">HandshakeType_Finished</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="Network.TLS.Packet.html#decodeFinished"><span class="hs-identifier hs-var">decodeFinished</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeDeprecatedHandshake"><span class="hs-identifier hs-type">decodeDeprecatedHandshake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-198"></span><span id="decodeDeprecatedHandshake"><span class="annot"><span class="annottext">decodeDeprecatedHandshake :: ByteString -&gt; Either TLSError Handshake
</span><a href="Network.TLS.Packet.html#decodeDeprecatedHandshake"><span class="hs-identifier hs-var hs-var">decodeDeprecatedHandshake</span></a></span></span><span> </span><span id="local-6989586621679180231"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180231"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Handshake -&gt; ByteString -&gt; Either TLSError Handshake
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;deprecatedhandshake&quot;</span></span><span> </span><span class="annot"><span class="annottext">Get Handshake
</span><a href="#local-6989586621679180232"><span class="hs-identifier hs-var">getDeprecated</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180231"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180232"><span class="annot"><span class="annottext">getDeprecated :: Get Handshake
</span><a href="#local-6989586621679180232"><span class="hs-identifier hs-var hs-var">getDeprecated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-201"></span><span>            </span><span id="local-6989586621679180255"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180255"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span id="local-6989586621679180256"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180256"><span class="hs-identifier hs-var">cipherSpecLen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Int) -&gt; Get Word16 -&gt; Get Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span id="local-6989586621679180258"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180258"><span class="hs-identifier hs-var">sessionIdLen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Int) -&gt; Get Word16 -&gt; Get Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span id="local-6989586621679180259"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180259"><span class="hs-identifier hs-var">challengeLen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Int) -&gt; Get Word16 -&gt; Get Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-205"></span><span>            </span><span id="local-6989586621679180260"><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180260"><span class="hs-identifier hs-var">ciphers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get [Word16]
forall {t} {a}. (Ord t, Num t, Enum a) =&gt; t -&gt; Get [a]
</span><a href="#local-6989586621679180261"><span class="hs-identifier hs-var">getCipherSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180256"><span class="hs-identifier hs-var">cipherSpecLen</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span id="local-6989586621679180262"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180262"><span class="hs-identifier hs-var">session</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get Session
</span><a href="#local-6989586621679180263"><span class="hs-identifier hs-var">getSessionId</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180258"><span class="hs-identifier hs-var">sessionIdLen</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span id="local-6989586621679180264"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180264"><span class="hs-identifier hs-var">random</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ClientRandom
</span><a href="#local-6989586621679180265"><span class="hs-identifier hs-var">getChallenge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180259"><span class="hs-identifier hs-var">challengeLen</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180267"><span class="annot"><span class="annottext">compressions :: [Word8]
</span><a href="#local-6989586621679180267"><span class="hs-identifier hs-var hs-var">compressions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Handshake -&gt; Get Handshake) -&gt; Handshake -&gt; Get Handshake
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version
-&gt; ClientRandom
-&gt; Session
-&gt; [Word16]
-&gt; [Word8]
-&gt; [ExtensionRaw]
-&gt; Maybe ByteString
-&gt; Handshake
</span><a href="Network.TLS.Struct.html#ClientHello"><span class="hs-identifier hs-var">ClientHello</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180255"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180264"><span class="hs-identifier hs-var">random</span></a></span><span> </span><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180262"><span class="hs-identifier hs-var">session</span></a></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180260"><span class="hs-identifier hs-var">ciphers</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679180267"><span class="hs-identifier hs-var">compressions</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180231"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679180261"><span class="annot"><span class="annottext">getCipherSpec :: t -&gt; Get [a]
</span><a href="#local-6989586621679180261"><span class="hs-identifier hs-var hs-var">getCipherSpec</span></a></span></span><span> </span><span id="local-6989586621679180293"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180293"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180293"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Get [a]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><a href="#local-6989586621679180261"><span class="hs-identifier hs-var">getCipherSpec</span></a></span><span> </span><span id="local-6989586621679180295"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180295"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621679180296"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180296"><span class="hs-identifier hs-var">c0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679180297"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679180298"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Int) -&gt; [Word8] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; [Int]) -&gt; Get [Word8] -&gt; Get [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get Word8 -&gt; Get [Word8]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; Int -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180297"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x100</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180298"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180296"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Get [a] -&gt; Get [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Get [a]
</span><a href="#local-6989586621679180261"><span class="hs-identifier hs-var">getCipherSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679180295"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679180263"><span class="annot"><span class="annottext">getSessionId :: Int -&gt; Get Session
</span><a href="#local-6989586621679180263"><span class="hs-identifier hs-var hs-var">getSessionId</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Session -&gt; Get Session
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Session -&gt; Get Session) -&gt; Session -&gt; Get Session
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Session
</span><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-var">Session</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="#local-6989586621679180263"><span class="hs-identifier hs-var">getSessionId</span></a></span><span> </span><span id="local-6989586621679180308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180308"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Session
</span><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-var">Session</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Session)
-&gt; (ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Session
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Session) -&gt; Get ByteString -&gt; Get Session
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180308"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621679180265"><span class="annot"><span class="annottext">getChallenge :: Int -&gt; Get ClientRandom
</span><a href="#local-6989586621679180265"><span class="hs-identifier hs-var hs-var">getChallenge</span></a></span></span><span> </span><span id="local-6989586621679180320"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180320"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Get ByteString -&gt; Get ClientRandom -&gt; Get ClientRandom
forall a b. Get a -&gt; Get b -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ClientRandom
</span><a href="#local-6989586621679180265"><span class="hs-identifier hs-var">getChallenge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="#local-6989586621679180265"><span class="hs-identifier hs-var">getChallenge</span></a></span><span> </span><span id="local-6989586621679180321"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180321"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ClientRandom
</span><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-var">ClientRandom</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ClientRandom)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ClientRandom
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.append</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">B.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180321"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ClientRandom) -&gt; Get ByteString -&gt; Get ClientRandom
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180321"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeHelloRequest"><span class="hs-identifier hs-type">decodeHelloRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-220"></span><span id="decodeHelloRequest"><span class="annot"><span class="annottext">decodeHelloRequest :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeHelloRequest"><span class="hs-identifier hs-var hs-var">decodeHelloRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="Network.TLS.Struct.html#HelloRequest"><span class="hs-identifier hs-var">HelloRequest</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeClientHello"><span class="hs-identifier hs-type">decodeClientHello</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-223"></span><span id="decodeClientHello"><span class="annot"><span class="annottext">decodeClientHello :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeClientHello"><span class="hs-identifier hs-var hs-var">decodeClientHello</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679180326"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180326"><span class="hs-identifier hs-var">ver</span></a></span></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679180327"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180327"><span class="hs-identifier hs-var">random</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ClientRandom
</span><a href="Network.TLS.Packet.html#getClientRandom32"><span class="hs-identifier hs-var">getClientRandom32</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679180328"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180328"><span class="hs-identifier hs-var">session</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Session
</span><a href="Network.TLS.Packet.html#getSession"><span class="hs-identifier hs-var">getSession</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679180329"><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180329"><span class="hs-identifier hs-var">ciphers</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get [Word16]
</span><a href="Network.TLS.Wire.html#getWords16"><span class="hs-identifier hs-var">getWords16</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679180331"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679180331"><span class="hs-identifier hs-var">compressions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get [Word8]
</span><a href="Network.TLS.Wire.html#getWords8"><span class="hs-identifier hs-var">getWords8</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679180333"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180333"><span class="hs-identifier hs-var">r</span></a></span></span><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679180334"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180334"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Bool
</span><a href="Network.TLS.Cap.html#hasHelloExtensions"><span class="hs-identifier hs-var">hasHelloExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180326"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180333"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-231"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Int) -&gt; Get Word16 -&gt; Get Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get [ExtensionRaw]) -&gt; Get [ExtensionRaw]
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get [ExtensionRaw]
</span><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-var">getExtensions</span></a></span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>               </span><span id="local-6989586621679180338"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180338"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span>
</span><span id="line-234"></span><span>               </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180338"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-235"></span><span>               </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Get [ExtensionRaw]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Handshake -&gt; Get Handshake) -&gt; Handshake -&gt; Get Handshake
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version
-&gt; ClientRandom
-&gt; Session
-&gt; [Word16]
-&gt; [Word8]
-&gt; [ExtensionRaw]
-&gt; Maybe ByteString
-&gt; Handshake
</span><a href="Network.TLS.Struct.html#ClientHello"><span class="hs-identifier hs-var">ClientHello</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180326"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180327"><span class="hs-identifier hs-var">random</span></a></span><span> </span><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180328"><span class="hs-identifier hs-var">session</span></a></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180329"><span class="hs-identifier hs-var">ciphers</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679180331"><span class="hs-identifier hs-var">compressions</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180334"><span class="hs-identifier hs-var">exts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerHello"><span class="hs-identifier hs-type">decodeServerHello</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-239"></span><span id="decodeServerHello"><span class="annot"><span class="annottext">decodeServerHello :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerHello"><span class="hs-identifier hs-var hs-var">decodeServerHello</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679180339"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180339"><span class="hs-identifier hs-var">ver</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679180340"><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180340"><span class="hs-identifier hs-var">random</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ServerRandom
</span><a href="Network.TLS.Packet.html#getServerRandom32"><span class="hs-identifier hs-var">getServerRandom32</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679180341"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180341"><span class="hs-identifier hs-var">session</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Session
</span><a href="Network.TLS.Packet.html#getSession"><span class="hs-identifier hs-var">getSession</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679180342"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180342"><span class="hs-identifier hs-var">cipherid</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679180343"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180343"><span class="hs-identifier hs-var">compressionid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679180344"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180344"><span class="hs-identifier hs-var">r</span></a></span></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679180345"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180345"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Bool
</span><a href="Network.TLS.Cap.html#hasHelloExtensions"><span class="hs-identifier hs-var">hasHelloExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180339"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180344"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Int) -&gt; Get Word16 -&gt; Get Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get [ExtensionRaw]) -&gt; Get [ExtensionRaw]
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get [ExtensionRaw]
</span><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-var">getExtensions</span></a></span><span>
</span><span id="line-248"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Get [ExtensionRaw]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Handshake -&gt; Get Handshake) -&gt; Handshake -&gt; Get Handshake
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version
-&gt; ServerRandom
-&gt; Session
-&gt; Word16
-&gt; Word8
-&gt; [ExtensionRaw]
-&gt; Handshake
</span><a href="Network.TLS.Struct.html#ServerHello"><span class="hs-identifier hs-var">ServerHello</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180339"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180340"><span class="hs-identifier hs-var">random</span></a></span><span> </span><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180341"><span class="hs-identifier hs-var">session</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180342"><span class="hs-identifier hs-var">cipherid</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180343"><span class="hs-identifier hs-var">compressionid</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180345"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerHelloDone"><span class="hs-identifier hs-type">decodeServerHelloDone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-252"></span><span id="decodeServerHelloDone"><span class="annot"><span class="annottext">decodeServerHelloDone :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerHelloDone"><span class="hs-identifier hs-var hs-var">decodeServerHelloDone</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="Network.TLS.Struct.html#ServerHelloDone"><span class="hs-identifier hs-var">ServerHelloDone</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeCertificates"><span class="hs-identifier hs-type">decodeCertificates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-255"></span><span id="decodeCertificates"><span class="annot"><span class="annottext">decodeCertificates :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertificates"><span class="hs-identifier hs-var hs-var">decodeCertificates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679180348"><span class="annot"><span class="annottext">CertificateChainRaw
</span><a href="#local-6989586621679180348"><span class="hs-identifier hs-var">certsRaw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; CertificateChainRaw
</span><span class="hs-identifier hs-var">CertificateChainRaw</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; CertificateChainRaw)
-&gt; Get [ByteString] -&gt; Get CertificateChainRaw
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get Int
</span><a href="Network.TLS.Wire.html#getWord24"><span class="hs-identifier hs-var">getWord24</span></a></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get [ByteString]) -&gt; Get [ByteString]
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679180351"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180351"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get (Int, ByteString) -&gt; Get [ByteString]
forall a. Int -&gt; Get (Int, a) -&gt; Get [a]
</span><a href="Network.TLS.Wire.html#getList"><span class="hs-identifier hs-var">getList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180351"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Get (Int, ByteString)
</span><a href="#local-6989586621679180353"><span class="hs-identifier hs-var">getCertRaw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CertificateChainRaw -&gt; Either (Int, [Char]) CertificateChain
</span><span class="hs-identifier hs-var">decodeCertificateChain</span></span><span> </span><span class="annot"><span class="annottext">CertificateChainRaw
</span><a href="#local-6989586621679180348"><span class="hs-identifier hs-var">certsRaw</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-258"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679180355"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679180355"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Handshake
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;error certificate parsing &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180354"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679180355"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679180356"><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var">cc</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; Get Handshake
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Handshake -&gt; Get Handshake) -&gt; Handshake -&gt; Get Handshake
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CertificateChain -&gt; Handshake
</span><a href="Network.TLS.Struct.html#Certificates"><span class="hs-identifier hs-var">Certificates</span></a></span><span> </span><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679180356"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180353"><span class="annot"><span class="annottext">getCertRaw :: Get (Int, ByteString)
</span><a href="#local-6989586621679180353"><span class="hs-identifier hs-var hs-var">getCertRaw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque24"><span class="hs-identifier hs-var">getOpaque24</span></a></span><span> </span><span class="annot"><span class="annottext">Get ByteString
-&gt; (ByteString -&gt; Get (Int, ByteString)) -&gt; Get (Int, ByteString)
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679180362"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180362"><span class="hs-identifier hs-var">cert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, ByteString) -&gt; Get (Int, ByteString)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180362"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180362"><span class="hs-identifier hs-var">cert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeFinished"><span class="hs-identifier hs-type">decodeFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-263"></span><span id="decodeFinished"><span class="annot"><span class="annottext">decodeFinished :: Get Handshake
</span><a href="Network.TLS.Packet.html#decodeFinished"><span class="hs-identifier hs-var hs-var">decodeFinished</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Handshake
</span><a href="Network.TLS.Struct.html#Finished"><span class="hs-identifier hs-var">Finished</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Handshake) -&gt; Get ByteString -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get ByteString) -&gt; Get ByteString
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeCertRequest"><span class="hs-identifier hs-type">decodeCertRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-type">CurrentParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-266"></span><span id="decodeCertRequest"><span class="annot"><span class="annottext">decodeCertRequest :: CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertRequest"><span class="hs-identifier hs-var hs-var">decodeCertRequest</span></a></span></span><span> </span><span id="local-6989586621679180365"><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679180366"><span class="annot"><span class="annottext">[Maybe CertificateType]
</span><a href="#local-6989586621679180366"><span class="hs-identifier hs-var">mcertTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe CertificateType)
-&gt; [Word8] -&gt; [Maybe CertificateType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe CertificateType
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe CertificateType)
-&gt; (Word8 -&gt; Word8) -&gt; Word8 -&gt; Maybe CertificateType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; [Maybe CertificateType])
-&gt; Get [Word8] -&gt; Get [Maybe CertificateType]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get [Word8]
</span><a href="Network.TLS.Wire.html#getWords8"><span class="hs-identifier hs-var">getWords8</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679180367"><span class="annot"><span class="annottext">[CertificateType]
</span><a href="#local-6989586621679180367"><span class="hs-identifier hs-var">certTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Maybe CertificateType -&gt; Get CertificateType)
-&gt; [Maybe CertificateType] -&gt; Get [CertificateType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe CertificateType -&gt; Get CertificateType
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; Maybe a -&gt; m a
</span><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-var">fromJustM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;decodeCertRequest&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe CertificateType]
</span><a href="#local-6989586621679180366"><span class="hs-identifier hs-var">mcertTypes</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679180370"><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180370"><span class="hs-identifier hs-var">sigHashAlgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Version
</span><a href="Network.TLS.Packet.html#cParamsVersion"><span class="hs-identifier hs-var">cParamsVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180365"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span>
</span><span id="line-270"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[HashAndSignatureAlgorithm] -&gt; Maybe [HashAndSignatureAlgorithm]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([HashAndSignatureAlgorithm] -&gt; Maybe [HashAndSignatureAlgorithm])
-&gt; Get [HashAndSignatureAlgorithm]
-&gt; Get (Maybe [HashAndSignatureAlgorithm])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word16
-&gt; (Word16 -&gt; Get [HashAndSignatureAlgorithm])
-&gt; Get [HashAndSignatureAlgorithm]
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Get [HashAndSignatureAlgorithm]
forall {a}. Integral a =&gt; a -&gt; Get [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180372"><span class="hs-identifier hs-var">getSignatureHashAlgorithms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
-&gt; Get (Maybe [HashAndSignatureAlgorithm])
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">[CertificateType]
-&gt; Maybe [HashAndSignatureAlgorithm]
-&gt; [DistinguishedName]
-&gt; Handshake
</span><a href="Network.TLS.Struct.html#CertRequest"><span class="hs-identifier hs-var">CertRequest</span></a></span><span> </span><span class="annot"><span class="annottext">[CertificateType]
</span><a href="#local-6989586621679180367"><span class="hs-identifier hs-var">certTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180370"><span class="hs-identifier hs-var">sigHashAlgs</span></a></span><span> </span><span class="annot"><span class="annottext">([DistinguishedName] -&gt; Handshake)
-&gt; Get [DistinguishedName] -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get [DistinguishedName]
</span><a href="Network.TLS.Packet.html#getDNames"><span class="hs-identifier hs-var">getDNames</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180372"><span class="annot"><span class="annottext">getSignatureHashAlgorithms :: a -&gt; Get [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180372"><span class="hs-identifier hs-var hs-var">getSignatureHashAlgorithms</span></a></span></span><span> </span><span id="local-6989586621679180393"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180393"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Get (Int, HashAndSignatureAlgorithm)
-&gt; Get [HashAndSignatureAlgorithm]
forall a. Int -&gt; Get (Int, a) -&gt; Get [a]
</span><a href="Network.TLS.Wire.html#getList"><span class="hs-identifier hs-var">getList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180393"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get HashAndSignatureAlgorithm
</span><a href="Network.TLS.Packet.html#getSignatureHashAlgorithm"><span class="hs-identifier hs-var">getSignatureHashAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">Get HashAndSignatureAlgorithm
-&gt; (HashAndSignatureAlgorithm
    -&gt; Get (Int, HashAndSignatureAlgorithm))
-&gt; Get (Int, HashAndSignatureAlgorithm)
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679180394"><span class="annot"><span class="annottext">HashAndSignatureAlgorithm
</span><a href="#local-6989586621679180394"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, HashAndSignatureAlgorithm)
-&gt; Get (Int, HashAndSignatureAlgorithm)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HashAndSignatureAlgorithm
</span><a href="#local-6989586621679180394"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><span class="hs-comment">-- | Decode a list CA distinguished names</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Network.TLS.Packet.html#getDNames"><span class="hs-identifier hs-type">getDNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DistinguishedName</span></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span id="getDNames"><span class="annot"><span class="annottext">getDNames :: Get [DistinguishedName]
</span><a href="Network.TLS.Packet.html#getDNames"><span class="hs-identifier hs-var hs-var">getDNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679180395"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180395"><span class="hs-identifier hs-var">dNameLen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- FIXME: Decide whether to remove this check completely or to make it an option.</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- when (cParamsVersion cp &lt; TLS12 &amp;&amp; dNameLen &lt; 3) $ fail &quot;certrequest distinguishname not of the correct size&quot;</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Get (Int, DistinguishedName) -&gt; Get [DistinguishedName]
forall a. Int -&gt; Get (Int, a) -&gt; Get [a]
</span><a href="Network.TLS.Wire.html#getList"><span class="hs-identifier hs-var">getList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180395"><span class="hs-identifier hs-var">dNameLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Get (Int, DistinguishedName)
</span><a href="#local-6989586621679180396"><span class="hs-identifier hs-var">getDName</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679180396"><span class="annot"><span class="annottext">getDName :: Get (Int, DistinguishedName)
</span><a href="#local-6989586621679180396"><span class="hs-identifier hs-var hs-var">getDName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679180410"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180410"><span class="hs-identifier hs-var">dName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque16"><span class="hs-identifier hs-var">getOpaque16</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180410"><span class="hs-identifier hs-var">dName</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; Get ()) -&gt; Get () -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get ()
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;certrequest: invalid DN length&quot;</span></span><span>
</span><span id="line-286"></span><span>        </span><span id="local-6989586621679180413"><span class="annot"><span class="annottext">DistinguishedName
</span><a href="#local-6989586621679180413"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Get DistinguishedName)
-&gt; (DistinguishedName -&gt; Get DistinguishedName)
-&gt; Either [Char] DistinguishedName
-&gt; Get DistinguishedName
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get DistinguishedName
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; Get DistinguishedName
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] DistinguishedName -&gt; Get DistinguishedName)
-&gt; Either [Char] DistinguishedName -&gt; Get DistinguishedName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ByteString -&gt; Either [Char] DistinguishedName
forall a. ASN1Object a =&gt; [Char] -&gt; ByteString -&gt; Either [Char] a
</span><a href="Network.TLS.Util.ASN1.html#decodeASN1Object"><span class="hs-identifier hs-var">decodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cert request DistinguishedName&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180410"><span class="hs-identifier hs-var">dName</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">(Int, DistinguishedName) -&gt; Get (Int, DistinguishedName)
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180410"><span class="hs-identifier hs-var">dName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DistinguishedName
</span><a href="#local-6989586621679180413"><span class="hs-identifier hs-var">dn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeCertVerify"><span class="hs-identifier hs-type">decodeCertVerify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-type">CurrentParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-290"></span><span id="decodeCertVerify"><span class="annot"><span class="annottext">decodeCertVerify :: CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeCertVerify"><span class="hs-identifier hs-var hs-var">decodeCertVerify</span></a></span></span><span> </span><span id="local-6989586621679180416"><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180416"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Handshake
</span><a href="Network.TLS.Struct.html#CertVerify"><span class="hs-identifier hs-var">CertVerify</span></a></span><span> </span><span class="annot"><span class="annottext">(DigitallySigned -&gt; Handshake)
-&gt; Get DigitallySigned -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var">getDigitallySigned</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrentParams -&gt; Version
</span><a href="Network.TLS.Packet.html#cParamsVersion"><span class="hs-identifier hs-var">cParamsVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180416"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeClientKeyXchg"><span class="hs-identifier hs-type">decodeClientKeyXchg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-type">CurrentParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-293"></span><span id="decodeClientKeyXchg"><span class="annot"><span class="annottext">decodeClientKeyXchg :: CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeClientKeyXchg"><span class="hs-identifier hs-var hs-var">decodeClientKeyXchg</span></a></span></span><span> </span><span id="local-6989586621679180419"><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180419"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- case  ClientKeyXchg &lt;$&gt; (remaining &gt;&gt;= getBytes)</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Maybe CipherKeyExchangeType
</span><a href="Network.TLS.Packet.html#cParamsKeyXchgType"><span class="hs-identifier hs-var">cParamsKeyXchgType</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180419"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">Maybe CipherKeyExchangeType
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get Handshake
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;no client key exchange type&quot;</span></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180421"><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180421"><span class="hs-identifier hs-var">cke</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClientKeyXchgAlgorithmData -&gt; Handshake
</span><a href="Network.TLS.Struct.html#ClientKeyXchg"><span class="hs-identifier hs-var">ClientKeyXchg</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientKeyXchgAlgorithmData -&gt; Handshake)
-&gt; Get ClientKeyXchgAlgorithmData -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType -&gt; Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180421"><span class="hs-identifier hs-var">cke</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180423"><span class="annot"><span class="annottext">parseCKE :: CipherKeyExchangeType -&gt; Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180423"><span class="hs-identifier hs-var hs-var">parseCKE</span></a></span></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_RSA</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ClientKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#CKX_RSA"><span class="hs-identifier hs-var">CKX_RSA</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ClientKeyXchgAlgorithmData)
-&gt; Get ByteString -&gt; Get ClientKeyXchgAlgorithmData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get ByteString) -&gt; Get ByteString
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DHE_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_DHE_RSA</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180431"><span class="hs-identifier hs-var">parseClientDHPublic</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DHE_DSS"><span class="hs-identifier hs-var">CipherKeyExchange_DHE_DSS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180431"><span class="hs-identifier hs-var">parseClientDHPublic</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DH_Anon"><span class="hs-identifier hs-var">CipherKeyExchange_DH_Anon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180431"><span class="hs-identifier hs-var">parseClientDHPublic</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_ECDHE_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_ECDHE_RSA</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var">parseClientECDHPublic</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_ECDHE_ECDSA"><span class="hs-identifier hs-var">CipherKeyExchange_ECDHE_ECDSA</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var">parseClientECDHPublic</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><a href="#local-6989586621679180423"><span class="hs-identifier hs-var">parseCKE</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><span class="hs-identifier">_</span></span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get ClientKeyXchgAlgorithmData
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unsupported client key exchange type&quot;</span></span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621679180431"><span class="annot"><span class="annottext">parseClientDHPublic :: Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180431"><span class="hs-identifier hs-var hs-var">parseClientDHPublic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DHPublic -&gt; ClientKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#CKX_DH"><span class="hs-identifier hs-var">CKX_DH</span></a></span><span> </span><span class="annot"><span class="annottext">(DHPublic -&gt; ClientKeyXchgAlgorithmData)
-&gt; (Integer -&gt; DHPublic) -&gt; Integer -&gt; ClientKeyXchgAlgorithmData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; DHPublic
</span><a href="Network.TLS.Crypto.DH.html#dhPublic"><span class="hs-identifier hs-var">dhPublic</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ClientKeyXchgAlgorithmData)
-&gt; Get Integer -&gt; Get ClientKeyXchgAlgorithmData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Integer
</span><a href="Network.TLS.Wire.html#getInteger16"><span class="hs-identifier hs-var">getInteger16</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621679180435"><span class="annot"><span class="annottext">parseClientECDHPublic :: Get ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180435"><span class="hs-identifier hs-var hs-var">parseClientECDHPublic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ClientKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#CKX_ECDH"><span class="hs-identifier hs-var">CKX_ECDH</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ClientKeyXchgAlgorithmData)
-&gt; Get ByteString -&gt; Get ClientKeyXchgAlgorithmData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque8"><span class="hs-identifier hs-var">getOpaque8</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerKeyXchg_DH"><span class="hs-identifier hs-type">decodeServerKeyXchg_DH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span>
</span><span id="line-308"></span><span id="decodeServerKeyXchg_DH"><span class="annot"><span class="annottext">decodeServerKeyXchg_DH :: Get ServerDHParams
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg_DH"><span class="hs-identifier hs-var hs-var">decodeServerKeyXchg_DH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ServerDHParams
</span><a href="Network.TLS.Packet.html#getServerDHParams"><span class="hs-identifier hs-var">getServerDHParams</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- We don't support ECDH_Anon at this moment</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- decodeServerKeyXchg_ECDH :: Get ServerECDHParams</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerKeyXchg_RSA"><span class="hs-identifier hs-type">decodeServerKeyXchg_RSA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRSAParams"><span class="hs-identifier hs-type">ServerRSAParams</span></a></span><span>
</span><span id="line-314"></span><span id="decodeServerKeyXchg_RSA"><span class="annot"><span class="annottext">decodeServerKeyXchg_RSA :: Get ServerRSAParams
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg_RSA"><span class="hs-identifier hs-var hs-var">decodeServerKeyXchg_RSA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; ServerRSAParams
</span><a href="Network.TLS.Struct.html#ServerRSAParams"><span class="hs-identifier hs-var">ServerRSAParams</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; ServerRSAParams)
-&gt; Get Integer -&gt; Get (Integer -&gt; ServerRSAParams)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Integer
</span><a href="Network.TLS.Wire.html#getInteger16"><span class="hs-identifier hs-var">getInteger16</span></a></span><span> </span><span class="hs-comment">-- modulus</span><span>
</span><span id="line-315"></span><span>                                          </span><span class="annot"><span class="annottext">Get (Integer -&gt; ServerRSAParams)
-&gt; Get Integer -&gt; Get ServerRSAParams
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Integer
</span><a href="Network.TLS.Wire.html#getInteger16"><span class="hs-identifier hs-var">getInteger16</span></a></span><span> </span><span class="hs-comment">-- exponent</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerKeyXchgAlgorithmData"><span class="hs-identifier hs-type">decodeServerKeyXchgAlgorithmData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-318"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#CipherKeyExchangeType"><span class="hs-identifier hs-type">CipherKeyExchangeType</span></a></span><span>
</span><span id="line-319"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerKeyXchgAlgorithmData"><span class="hs-identifier hs-type">ServerKeyXchgAlgorithmData</span></a></span><span>
</span><span id="line-320"></span><span id="decodeServerKeyXchgAlgorithmData"><span class="annot"><span class="annottext">decodeServerKeyXchgAlgorithmData :: Version -&gt; CipherKeyExchangeType -&gt; Get ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchgAlgorithmData"><span class="hs-identifier hs-var hs-var">decodeServerKeyXchgAlgorithmData</span></a></span></span><span> </span><span id="local-6989586621679180449"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180450"><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180450"><span class="hs-identifier hs-var">cke</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get ServerKeyXchgAlgorithmData
</span><a href="#local-6989586621679180451"><span class="hs-identifier hs-var">toCKE</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180451"><span class="annot"><span class="annottext">toCKE :: Get ServerKeyXchgAlgorithmData
</span><a href="#local-6989586621679180451"><span class="hs-identifier hs-var hs-var">toCKE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180450"><span class="hs-identifier hs-var">cke</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_RSA</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ServerRSAParams -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_RSA"><span class="hs-identifier hs-var">SKX_RSA</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ServerRSAParams -&gt; ServerKeyXchgAlgorithmData)
-&gt; (ServerRSAParams -&gt; Maybe ServerRSAParams)
-&gt; ServerRSAParams
-&gt; ServerKeyXchgAlgorithmData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ServerRSAParams -&gt; Maybe ServerRSAParams
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ServerRSAParams -&gt; ServerKeyXchgAlgorithmData)
-&gt; Get ServerRSAParams -&gt; Get ServerKeyXchgAlgorithmData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ServerRSAParams
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg_RSA"><span class="hs-identifier hs-var">decodeServerKeyXchg_RSA</span></a></span><span>
</span><span id="line-323"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DH_Anon"><span class="hs-identifier hs-var">CipherKeyExchange_DH_Anon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_DH_Anon"><span class="hs-identifier hs-var">SKX_DH_Anon</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerDHParams -&gt; ServerKeyXchgAlgorithmData)
-&gt; Get ServerDHParams -&gt; Get ServerKeyXchgAlgorithmData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ServerDHParams
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg_DH"><span class="hs-identifier hs-var">decodeServerKeyXchg_DH</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DHE_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_DHE_RSA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>                </span><span id="local-6989586621679180471"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180471"><span class="hs-identifier hs-var">dhparams</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ServerDHParams
</span><a href="Network.TLS.Packet.html#getServerDHParams"><span class="hs-identifier hs-var">getServerDHParams</span></a></span><span>
</span><span id="line-326"></span><span>                </span><span id="local-6989586621679180472"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180472"><span class="hs-keyword hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var">getDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-327"></span><span>                </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData)
-&gt; ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; DigitallySigned -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_DHE_RSA"><span class="hs-identifier hs-var">SKX_DHE_RSA</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180471"><span class="hs-identifier hs-var">dhparams</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180472"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_DHE_DSS"><span class="hs-identifier hs-var">CipherKeyExchange_DHE_DSS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>                </span><span id="local-6989586621679180474"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180474"><span class="hs-identifier hs-var">dhparams</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ServerDHParams
</span><a href="Network.TLS.Packet.html#getServerDHParams"><span class="hs-identifier hs-var">getServerDHParams</span></a></span><span>
</span><span id="line-330"></span><span>                </span><span id="local-6989586621679180475"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180475"><span class="hs-keyword hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var">getDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData)
-&gt; ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; DigitallySigned -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_DHE_DSS"><span class="hs-identifier hs-var">SKX_DHE_DSS</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180474"><span class="hs-identifier hs-var">dhparams</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180475"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-332"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_ECDHE_RSA"><span class="hs-identifier hs-var">CipherKeyExchange_ECDHE_RSA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>                </span><span id="local-6989586621679180477"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180477"><span class="hs-identifier hs-var">ecdhparams</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ServerECDHParams
</span><a href="Network.TLS.Packet.html#getServerECDHParams"><span class="hs-identifier hs-var">getServerECDHParams</span></a></span><span>
</span><span id="line-334"></span><span>                </span><span id="local-6989586621679180479"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180479"><span class="hs-keyword hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var">getDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-335"></span><span>                </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData)
-&gt; ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; DigitallySigned -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_ECDHE_RSA"><span class="hs-identifier hs-var">SKX_ECDHE_RSA</span></a></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180477"><span class="hs-identifier hs-var">ecdhparams</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180479"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="Network.TLS.Cipher.html#CipherKeyExchange_ECDHE_ECDSA"><span class="hs-identifier hs-var">CipherKeyExchange_ECDHE_ECDSA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>                </span><span id="local-6989586621679180481"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180481"><span class="hs-identifier hs-var">ecdhparams</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ServerECDHParams
</span><a href="Network.TLS.Packet.html#getServerECDHParams"><span class="hs-identifier hs-var">getServerECDHParams</span></a></span><span>
</span><span id="line-338"></span><span>                </span><span id="local-6989586621679180482"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180482"><span class="hs-keyword hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var">getDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180449"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-339"></span><span>                </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData)
-&gt; ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; DigitallySigned -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_ECDHE_ECDSA"><span class="hs-identifier hs-var">SKX_ECDHE_ECDSA</span></a></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180481"><span class="hs-identifier hs-var">ecdhparams</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180482"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-340"></span><span>            </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>                </span><span id="local-6989586621679180484"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180484"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get ByteString) -&gt; Get ByteString
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span>
</span><span id="line-342"></span><span>                </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData)
-&gt; ServerKeyXchgAlgorithmData -&gt; Get ServerKeyXchgAlgorithmData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_Unknown"><span class="hs-identifier hs-var">SKX_Unknown</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180484"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeServerKeyXchg"><span class="hs-identifier hs-type">decodeServerKeyXchg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#CurrentParams"><span class="hs-identifier hs-type">CurrentParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span>
</span><span id="line-345"></span><span id="decodeServerKeyXchg"><span class="annot"><span class="annottext">decodeServerKeyXchg :: CurrentParams -&gt; Get Handshake
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchg"><span class="hs-identifier hs-var hs-var">decodeServerKeyXchg</span></a></span></span><span> </span><span id="local-6989586621679180486"><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CurrentParams -&gt; Maybe CipherKeyExchangeType
</span><a href="Network.TLS.Packet.html#cParamsKeyXchgType"><span class="hs-identifier hs-var">cParamsKeyXchgType</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180487"><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180487"><span class="hs-identifier hs-var">cke</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Handshake
</span><a href="Network.TLS.Struct.html#ServerKeyXchg"><span class="hs-identifier hs-var">ServerKeyXchg</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Handshake)
-&gt; Get ServerKeyXchgAlgorithmData -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; CipherKeyExchangeType -&gt; Get ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchgAlgorithmData"><span class="hs-identifier hs-var">decodeServerKeyXchgAlgorithmData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrentParams -&gt; Version
</span><a href="Network.TLS.Packet.html#cParamsVersion"><span class="hs-identifier hs-var">cParamsVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentParams
</span><a href="#local-6989586621679180486"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180487"><span class="hs-identifier hs-var">cke</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">Maybe CipherKeyExchangeType
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; Handshake
</span><a href="Network.TLS.Struct.html#ServerKeyXchg"><span class="hs-identifier hs-var">ServerKeyXchg</span></a></span><span> </span><span class="annot"><span class="annottext">(ServerKeyXchgAlgorithmData -&gt; Handshake)
-&gt; (ByteString -&gt; ServerKeyXchgAlgorithmData)
-&gt; ByteString
-&gt; Handshake
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Struct.html#SKX_Unparsed"><span class="hs-identifier hs-var">SKX_Unparsed</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Handshake) -&gt; Get ByteString -&gt; Get Handshake
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Get Int
</span><span class="hs-identifier hs-var">remaining</span></span><span> </span><span class="annot"><span class="annottext">Get Int -&gt; (Int -&gt; Get ByteString) -&gt; Get ByteString
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshake"><span class="hs-identifier hs-type">encodeHandshake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-351"></span><span id="encodeHandshake"><span class="annot"><span class="annottext">encodeHandshake :: Handshake -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeHandshake"><span class="hs-identifier hs-var hs-var">encodeHandshake</span></a></span></span><span> </span><span id="local-6989586621679180490"><span class="annot"><span class="annottext">Handshake
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180491"><span class="annot"><span class="annottext">content :: ByteString
</span><a href="#local-6989586621679180491"><span class="hs-identifier hs-var hs-var">content</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Handshake -&gt; Put
</span><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180492"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679180492"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180491"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180494"><span class="annot"><span class="annottext">header :: ByteString
</span><a href="#local-6989586621679180494"><span class="hs-identifier hs-var hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-355"></span><span>                    </span><span class="annot"><a href="Network.TLS.Struct.html#ClientHello"><span class="hs-identifier hs-type">ClientHello</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Session
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-comment">-- SSLv2 ClientHello message</span><span>
</span><span id="line-356"></span><span>                    </span><span class="annot"><span class="annottext">Handshake
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HandshakeType -&gt; Int -&gt; Put
</span><a href="Network.TLS.Packet.html#encodeHandshakeHeader"><span class="hs-identifier hs-var">encodeHandshakeHeader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handshake -&gt; HandshakeType
</span><a href="Network.TLS.Struct.html#typeOfHandshake"><span class="hs-identifier hs-var">typeOfHandshake</span></a></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="#local-6989586621679180490"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180492"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180494"><span class="hs-identifier hs-var">header</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180491"><span class="hs-identifier hs-var">content</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeHeader"><span class="hs-identifier hs-type">encodeHandshakeHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HandshakeType"><span class="hs-identifier hs-type">HandshakeType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-360"></span><span id="encodeHandshakeHeader"><span class="annot"><span class="annottext">encodeHandshakeHeader :: HandshakeType -&gt; Int -&gt; Put
</span><a href="Network.TLS.Packet.html#encodeHandshakeHeader"><span class="hs-identifier hs-var hs-var">encodeHandshakeHeader</span></a></span></span><span> </span><span id="local-6989586621679180497"><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180497"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679180498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180498"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HandshakeType -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">HandshakeType
</span><a href="#local-6989586621679180497"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord24"><span class="hs-identifier hs-var">putWord24</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180498"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-type">encodeHandshakeContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Handshake"><span class="hs-identifier hs-type">Handshake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span id="encodeHandshakeContent"><span class="annot"><span class="annottext">encodeHandshakeContent :: Handshake -&gt; Put
</span><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var hs-var">encodeHandshakeContent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientHello"><span class="hs-identifier hs-type">ClientHello</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Session
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180500"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180500"><span class="hs-identifier hs-var">deprecated</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180500"><span class="hs-identifier hs-var">deprecated</span></a></span><span>
</span><span id="line-366"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientHello"><span class="hs-identifier hs-type">ClientHello</span></a></span><span> </span><span id="local-6989586621679180502"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180502"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621679180503"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180503"><span class="hs-identifier hs-var">random</span></a></span></span><span> </span><span id="local-6989586621679180504"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180504"><span class="hs-identifier hs-var">session</span></a></span></span><span> </span><span id="local-6989586621679180505"><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180505"><span class="hs-identifier hs-var">cipherIDs</span></a></span></span><span> </span><span id="local-6989586621679180506"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679180506"><span class="hs-identifier hs-var">compressionIDs</span></a></span></span><span> </span><span id="local-6989586621679180507"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180507"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">Version -&gt; Put
</span><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-var">putBinaryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180502"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">ClientRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier hs-var">putClientRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180503"><span class="hs-identifier hs-var">random</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">Session -&gt; Put
</span><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier hs-var">putSession</span></a></span><span> </span><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180504"><span class="hs-identifier hs-var">session</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">[Word16] -&gt; Put
</span><a href="Network.TLS.Wire.html#putWords16"><span class="hs-identifier hs-var">putWords16</span></a></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679180505"><span class="hs-identifier hs-var">cipherIDs</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">[Word8] -&gt; Put
</span><a href="Network.TLS.Wire.html#putWords8"><span class="hs-identifier hs-var">putWords8</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679180506"><span class="hs-identifier hs-var">compressionIDs</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Put
</span><a href="Network.TLS.Packet.html#putExtensions"><span class="hs-identifier hs-var">putExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180507"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerHello"><span class="hs-identifier hs-type">ServerHello</span></a></span><span> </span><span id="local-6989586621679180511"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621679180512"><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var">random</span></a></span></span><span> </span><span id="local-6989586621679180513"><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var">session</span></a></span></span><span> </span><span id="local-6989586621679180514"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var">cipherid</span></a></span></span><span> </span><span id="local-6989586621679180515"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180515"><span class="hs-identifier hs-var">compressionID</span></a></span></span><span> </span><span id="local-6989586621679180516"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180516"><span class="hs-identifier hs-var">exts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="annottext">Version -&gt; Put
</span><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-var">putBinaryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180511"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><span class="annottext">ServerRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier hs-var">putServerRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180512"><span class="hs-identifier hs-var">random</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><span class="annottext">Session -&gt; Put
</span><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier hs-var">putSession</span></a></span><span> </span><span class="annot"><span class="annottext">Session
</span><a href="#local-6989586621679180513"><span class="hs-identifier hs-var">session</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180514"><span class="hs-identifier hs-var">cipherid</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180515"><span class="hs-identifier hs-var">compressionID</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Put
</span><a href="Network.TLS.Packet.html#putExtensions"><span class="hs-identifier hs-var">putExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180516"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Certificates"><span class="hs-identifier hs-type">Certificates</span></a></span><span> </span><span id="local-6989586621679180517"><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679180517"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque24"><span class="hs-identifier hs-var">putOpaque24</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put) -&gt; [ByteString] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque24"><span class="hs-identifier hs-var">putOpaque24</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180519"><span class="hs-identifier hs-var">certs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CertificateChainRaw</span></span><span> </span><span id="local-6989586621679180519"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180519"><span class="hs-identifier hs-var">certs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CertificateChain -&gt; CertificateChainRaw
</span><span class="hs-identifier hs-var">encodeCertificateChain</span></span><span> </span><span class="annot"><span class="annottext">CertificateChain
</span><a href="#local-6989586621679180517"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientKeyXchg"><span class="hs-identifier hs-type">ClientKeyXchg</span></a></span><span> </span><span id="local-6989586621679180520"><span class="annot"><span class="annottext">ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180520"><span class="hs-identifier hs-var">ckx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ClientKeyXchgAlgorithmData
</span><a href="#local-6989586621679180520"><span class="hs-identifier hs-var">ckx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#CKX_RSA"><span class="hs-identifier hs-type">CKX_RSA</span></a></span><span> </span><span id="local-6989586621679180521"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180521"><span class="hs-identifier hs-var">encryptedPreMaster</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180521"><span class="hs-identifier hs-var">encryptedPreMaster</span></a></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#CKX_DH"><span class="hs-identifier hs-type">CKX_DH</span></a></span><span> </span><span id="local-6989586621679180522"><span class="annot"><span class="annottext">DHPublic
</span><a href="#local-6989586621679180522"><span class="hs-identifier hs-var">clientDHPublic</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Put
</span><a href="Network.TLS.Wire.html#putInteger16"><span class="hs-identifier hs-var">putInteger16</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Put) -&gt; Integer -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DHPublic -&gt; Integer
</span><a href="Network.TLS.Crypto.DH.html#dhUnwrapPublic"><span class="hs-identifier hs-var">dhUnwrapPublic</span></a></span><span> </span><span class="annot"><span class="annottext">DHPublic
</span><a href="#local-6989586621679180522"><span class="hs-identifier hs-var">clientDHPublic</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#CKX_ECDH"><span class="hs-identifier hs-type">CKX_ECDH</span></a></span><span> </span><span id="local-6989586621679180525"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180525"><span class="hs-identifier hs-var">bytes</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque8"><span class="hs-identifier hs-var">putOpaque8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180525"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerKeyXchg"><span class="hs-identifier hs-type">ServerKeyXchg</span></a></span><span> </span><span id="local-6989586621679180527"><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData
</span><a href="#local-6989586621679180527"><span class="hs-identifier hs-var">skg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData
</span><a href="#local-6989586621679180527"><span class="hs-identifier hs-var">skg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_RSA"><span class="hs-identifier hs-type">SKX_RSA</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ServerRSAParams
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Put
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;encodeHandshakeContent SKX_RSA not implemented&quot;</span></span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_DH_Anon"><span class="hs-identifier hs-type">SKX_DH_Anon</span></a></span><span> </span><span id="local-6989586621679180528"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180528"><span class="hs-identifier hs-var">params</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-var">putServerDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180528"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_DHE_RSA"><span class="hs-identifier hs-type">SKX_DHE_RSA</span></a></span><span> </span><span id="local-6989586621679180530"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180530"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679180531"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180531"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-var">putServerDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180530"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var">putDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180531"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_DHE_DSS"><span class="hs-identifier hs-type">SKX_DHE_DSS</span></a></span><span> </span><span id="local-6989586621679180533"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180533"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679180534"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180534"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-var">putServerDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180533"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var">putDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180534"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_ECDHE_RSA"><span class="hs-identifier hs-type">SKX_ECDHE_RSA</span></a></span><span> </span><span id="local-6989586621679180535"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180535"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679180536"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180536"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerECDHParams"><span class="hs-identifier hs-var">putServerECDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180535"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var">putDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180536"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_ECDHE_ECDSA"><span class="hs-identifier hs-type">SKX_ECDHE_ECDSA</span></a></span><span> </span><span id="local-6989586621679180538"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679180539"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerECDHParams"><span class="hs-identifier hs-var">putServerECDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180538"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var">putDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180539"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><a href="Network.TLS.Struct.html#SKX_Unparsed"><span class="hs-identifier hs-type">SKX_Unparsed</span></a></span><span> </span><span id="local-6989586621679180540"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">bytes</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180540"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Put
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;encodeHandshakeContent: cannot handle: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ServerKeyXchgAlgorithmData
</span><a href="#local-6989586621679180527"><span class="hs-identifier hs-var">skg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="Network.TLS.Struct.html#HelloRequest"><span class="hs-identifier hs-var">HelloRequest</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="annot"><span class="annottext">Handshake
</span><a href="Network.TLS.Struct.html#ServerHelloDone"><span class="hs-identifier hs-var">ServerHelloDone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#CertRequest"><span class="hs-identifier hs-type">CertRequest</span></a></span><span> </span><span id="local-6989586621679180541"><span class="annot"><span class="annottext">[CertificateType]
</span><a href="#local-6989586621679180541"><span class="hs-identifier hs-var">certTypes</span></a></span></span><span> </span><span id="local-6989586621679180542"><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180542"><span class="hs-identifier hs-var">sigAlgs</span></a></span></span><span> </span><span id="local-6989586621679180543"><span class="annot"><span class="annottext">[DistinguishedName]
</span><a href="#local-6989586621679180543"><span class="hs-identifier hs-var">certAuthorities</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="annottext">[Word8] -&gt; Put
</span><a href="Network.TLS.Wire.html#putWords8"><span class="hs-identifier hs-var">putWords8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CertificateType -&gt; Word8) -&gt; [CertificateType] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CertificateType -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">[CertificateType]
</span><a href="#local-6989586621679180541"><span class="hs-identifier hs-var">certTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180542"><span class="hs-identifier hs-var">sigAlgs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">Maybe [HashAndSignatureAlgorithm]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180544"><span class="annot"><span class="annottext">[HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Word16] -&gt; Put
</span><a href="Network.TLS.Wire.html#putWords16"><span class="hs-identifier hs-var">putWords16</span></a></span><span> </span><span class="annot"><span class="annottext">([Word16] -&gt; Put) -&gt; [Word16] -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashAndSignatureAlgorithm -&gt; Word16)
-&gt; [HashAndSignatureAlgorithm] -&gt; [Word16]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679180545"><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180545"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679180546"><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180546"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashAlgorithm -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180545"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignatureAlgorithm -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180546"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HashAndSignatureAlgorithm]
</span><a href="#local-6989586621679180544"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">[DistinguishedName] -&gt; Put
</span><a href="Network.TLS.Packet.html#putDNames"><span class="hs-identifier hs-var">putDNames</span></a></span><span> </span><span class="annot"><span class="annottext">[DistinguishedName]
</span><a href="#local-6989586621679180543"><span class="hs-identifier hs-var">certAuthorities</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#CertVerify"><span class="hs-identifier hs-type">CertVerify</span></a></span><span> </span><span id="local-6989586621679180547"><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var">digitallySigned</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var">putDigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">DigitallySigned
</span><a href="#local-6989586621679180547"><span class="hs-identifier hs-var">digitallySigned</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeHandshakeContent"><span class="hs-identifier hs-var">encodeHandshakeContent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Finished"><span class="hs-identifier hs-type">Finished</span></a></span><span> </span><span id="local-6989586621679180548"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var">opaque</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180548"><span class="hs-identifier hs-var">opaque</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><span class="hs-comment">-- | Encode a list of distinguished names.</span></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Network.TLS.Packet.html#putDNames"><span class="hs-identifier hs-type">putDNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DistinguishedName</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-422"></span><span id="putDNames"><span class="annot"><span class="annottext">putDNames :: [DistinguishedName] -&gt; Put
</span><a href="Network.TLS.Packet.html#putDNames"><span class="hs-identifier hs-var hs-var">putDNames</span></a></span></span><span> </span><span id="local-6989586621679180549"><span class="annot"><span class="annottext">[DistinguishedName]
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var">dnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679180550"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180550"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DistinguishedName -&gt; PutM ByteString)
-&gt; [DistinguishedName] -&gt; PutM [ByteString]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DistinguishedName -&gt; PutM ByteString
forall {m :: * -&gt; *} {a}.
(Monad m, ASN1Object a) =&gt;
a -&gt; m ByteString
</span><a href="#local-6989586621679180551"><span class="hs-identifier hs-var">encodeCA</span></a></span><span> </span><span class="annot"><span class="annottext">[DistinguishedName]
</span><a href="#local-6989586621679180549"><span class="hs-identifier hs-var">dnames</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679180556"><span class="annot"><span class="annottext">totLength :: Int
</span><a href="#local-6989586621679180556"><span class="hs-identifier hs-var hs-var">totLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Int) -&gt; [ByteString] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (ByteString -&gt; Int) -&gt; ByteString -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180550"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180556"><span class="hs-identifier hs-var">totLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; Put) -&gt; [ByteString] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679180558"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180558"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180558"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180558"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180550"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-comment">-- Convert a distinguished name to its DER encoding.</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679180551"><span class="annot"><span class="annottext">encodeCA :: a -&gt; m ByteString
</span><a href="#local-6989586621679180551"><span class="hs-identifier hs-var hs-var">encodeCA</span></a></span></span><span> </span><span id="local-6989586621679180569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180569"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ASN1Object a =&gt; a -&gt; ByteString
</span><a href="Network.TLS.Util.ASN1.html#encodeASN1Object"><span class="hs-identifier hs-var">encodeASN1Object</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180569"><span class="hs-identifier hs-var">dn</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">{- FIXME make sure it return error if not 32 available -}</span><span>
</span><span id="line-432"></span><span class="annot"><a href="Network.TLS.Packet.html#getRandom32"><span class="hs-identifier hs-type">getRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-433"></span><span id="getRandom32"><span class="annot"><span class="annottext">getRandom32 :: Get ByteString
</span><a href="Network.TLS.Packet.html#getRandom32"><span class="hs-identifier hs-var hs-var">getRandom32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="Network.TLS.Packet.html#getServerRandom32"><span class="hs-identifier hs-type">getServerRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span>
</span><span id="line-436"></span><span id="getServerRandom32"><span class="annot"><span class="annottext">getServerRandom32 :: Get ServerRandom
</span><a href="Network.TLS.Packet.html#getServerRandom32"><span class="hs-identifier hs-var hs-var">getServerRandom32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ServerRandom
</span><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-var">ServerRandom</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ServerRandom) -&gt; Get ByteString -&gt; Get ServerRandom
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Packet.html#getRandom32"><span class="hs-identifier hs-var">getRandom32</span></a></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Network.TLS.Packet.html#getClientRandom32"><span class="hs-identifier hs-type">getClientRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span>
</span><span id="line-439"></span><span id="getClientRandom32"><span class="annot"><span class="annottext">getClientRandom32 :: Get ClientRandom
</span><a href="Network.TLS.Packet.html#getClientRandom32"><span class="hs-identifier hs-var hs-var">getClientRandom32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ClientRandom
</span><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-var">ClientRandom</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ClientRandom) -&gt; Get ByteString -&gt; Get ClientRandom
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Packet.html#getRandom32"><span class="hs-identifier hs-var">getRandom32</span></a></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Network.TLS.Packet.html#putRandom32"><span class="hs-identifier hs-type">putRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-442"></span><span id="putRandom32"><span class="annot"><span class="annottext">putRandom32 :: ByteString -&gt; Put
</span><a href="Network.TLS.Packet.html#putRandom32"><span class="hs-identifier hs-var hs-var">putRandom32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier hs-type">putClientRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-445"></span><span id="putClientRandom32"><span class="annot"><span class="annottext">putClientRandom32 :: ClientRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier hs-var hs-var">putClientRandom32</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span id="local-6989586621679180574"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Packet.html#putRandom32"><span class="hs-identifier hs-var">putRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180574"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier hs-type">putServerRandom32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-448"></span><span id="putServerRandom32"><span class="annot"><span class="annottext">putServerRandom32 :: ServerRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier hs-var hs-var">putServerRandom32</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span id="local-6989586621679180575"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180575"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Packet.html#putRandom32"><span class="hs-identifier hs-var">putRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180575"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Network.TLS.Packet.html#getSession"><span class="hs-identifier hs-type">getSession</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span>
</span><span id="line-451"></span><span id="getSession"><span class="annot"><span class="annottext">getSession :: Get Session
</span><a href="Network.TLS.Packet.html#getSession"><span class="hs-identifier hs-var hs-var">getSession</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679180576"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180576"><span class="hs-identifier hs-var">len8</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180576"><span class="hs-identifier hs-var">len8</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Session -&gt; Get Session
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Session -&gt; Get Session) -&gt; Session -&gt; Get Session
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Session
</span><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-var">Session</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-455"></span><span>        </span><span id="local-6989586621679180577"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180577"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Session
</span><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-var">Session</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Session)
-&gt; (ByteString -&gt; Maybe ByteString) -&gt; ByteString -&gt; Session
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Session) -&gt; Get ByteString -&gt; Get Session
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180577"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier hs-type">putSession</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-458"></span><span id="putSession"><span class="annot"><span class="annottext">putSession :: Session -&gt; Put
</span><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier hs-var hs-var">putSession</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-459"></span><span class="annot"><a href="Network.TLS.Packet.html#putSession"><span class="hs-identifier hs-var">putSession</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#Session"><span class="hs-identifier hs-type">Session</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180578"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180578"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque8"><span class="hs-identifier hs-var">putOpaque8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180578"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-type">getExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span id="getExtensions"><span class="annot"><span class="annottext">getExtensions :: Int -&gt; Get [ExtensionRaw]
</span><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-var hs-var">getExtensions</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Get [ExtensionRaw]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span class="annot"><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-var">getExtensions</span></a></span><span> </span><span id="local-6989586621679180579"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679180580"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var">extty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679180581"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">extdatalen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621679180582"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var">extdata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Get ByteString) -&gt; Int -&gt; Get ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">extdatalen</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679180583"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var">extxs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get [ExtensionRaw]
</span><a href="Network.TLS.Packet.html#getExtensions"><span class="hs-identifier hs-var">getExtensions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180579"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180581"><span class="hs-identifier hs-var">extdatalen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">[ExtensionRaw] -&gt; Get [ExtensionRaw]
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([ExtensionRaw] -&gt; Get [ExtensionRaw])
-&gt; [ExtensionRaw] -&gt; Get [ExtensionRaw]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ByteString -&gt; ExtensionRaw
</span><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-var">ExtensionRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180580"><span class="hs-identifier hs-var">extty</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180582"><span class="hs-identifier hs-var">extdata</span></a></span><span> </span><span class="annot"><span class="annottext">ExtensionRaw -&gt; [ExtensionRaw] -&gt; [ExtensionRaw]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180583"><span class="hs-identifier hs-var">extxs</span></a></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="annot"><a href="Network.TLS.Packet.html#putExtension"><span class="hs-identifier hs-type">putExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-471"></span><span id="putExtension"><span class="annot"><span class="annottext">putExtension :: ExtensionRaw -&gt; Put
</span><a href="Network.TLS.Packet.html#putExtension"><span class="hs-identifier hs-var hs-var">putExtension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span> </span><span id="local-6989586621679180585"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180585"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679180586"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180586"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679180585"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque16"><span class="hs-identifier hs-var">putOpaque16</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180586"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><a href="Network.TLS.Packet.html#putExtensions"><span class="hs-identifier hs-type">putExtensions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Network.TLS.Struct.html#ExtensionRaw"><span class="hs-identifier hs-type">ExtensionRaw</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-474"></span><span id="putExtensions"><span class="annot"><span class="annottext">putExtensions :: [ExtensionRaw] -&gt; Put
</span><a href="Network.TLS.Packet.html#putExtensions"><span class="hs-identifier hs-var hs-var">putExtensions</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span class="annot"><a href="Network.TLS.Packet.html#putExtensions"><span class="hs-identifier hs-var">putExtensions</span></a></span><span> </span><span id="local-6989586621679180588"><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180588"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque16"><span class="hs-identifier hs-var">putOpaque16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ExtensionRaw -&gt; Put) -&gt; [ExtensionRaw] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">ExtensionRaw -&gt; Put
</span><a href="Network.TLS.Packet.html#putExtension"><span class="hs-identifier hs-var">putExtension</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtensionRaw]
</span><a href="#local-6989586621679180588"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><a href="Network.TLS.Packet.html#getSignatureHashAlgorithm"><span class="hs-identifier hs-type">getSignatureHashAlgorithm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span>
</span><span id="line-478"></span><span id="getSignatureHashAlgorithm"><span class="annot"><span class="annottext">getSignatureHashAlgorithm :: Get HashAndSignatureAlgorithm
</span><a href="Network.TLS.Packet.html#getSignatureHashAlgorithm"><span class="hs-identifier hs-var hs-var">getSignatureHashAlgorithm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679180589"><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180589"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe HashAlgorithm
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe HashAlgorithm)
-&gt; Get Word8 -&gt; Get (Maybe HashAlgorithm)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Get (Maybe HashAlgorithm)
-&gt; (Maybe HashAlgorithm -&gt; Get HashAlgorithm) -&gt; Get HashAlgorithm
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe HashAlgorithm -&gt; Get HashAlgorithm
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; Maybe a -&gt; m a
</span><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-var">fromJustM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getSignatureHashAlgorithm&quot;</span></span><span>
</span><span id="line-480"></span><span>    </span><span id="local-6989586621679180590"><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180590"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe SignatureAlgorithm
forall a. TypeValuable a =&gt; Word8 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#valToType"><span class="hs-identifier hs-var">valToType</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe SignatureAlgorithm)
-&gt; Get Word8 -&gt; Get (Maybe SignatureAlgorithm)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Get (Maybe SignatureAlgorithm)
-&gt; (Maybe SignatureAlgorithm -&gt; Get SignatureAlgorithm)
-&gt; Get SignatureAlgorithm
forall a b. Get a -&gt; (a -&gt; Get b) -&gt; Get b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Maybe SignatureAlgorithm -&gt; Get SignatureAlgorithm
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; Maybe a -&gt; m a
</span><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-var">fromJustM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getSignatureHashAlgorithm&quot;</span></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">HashAndSignatureAlgorithm -&gt; Get HashAndSignatureAlgorithm
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180589"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180590"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Network.TLS.Packet.html#putSignatureHashAlgorithm"><span class="hs-identifier hs-type">putSignatureHashAlgorithm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#HashAndSignatureAlgorithm"><span class="hs-identifier hs-type">HashAndSignatureAlgorithm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-484"></span><span id="putSignatureHashAlgorithm"><span class="annot"><span class="annottext">putSignatureHashAlgorithm :: HashAndSignatureAlgorithm -&gt; Put
</span><a href="Network.TLS.Packet.html#putSignatureHashAlgorithm"><span class="hs-identifier hs-var hs-var">putSignatureHashAlgorithm</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679180591"><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180591"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679180592"><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180592"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashAlgorithm -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">HashAlgorithm
</span><a href="#local-6989586621679180591"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SignatureAlgorithm -&gt; Word8
forall a. TypeValuable a =&gt; a -&gt; Word8
</span><a href="Network.TLS.Struct.html#valOfType"><span class="hs-identifier hs-var">valOfType</span></a></span><span> </span><span class="annot"><span class="annottext">SignatureAlgorithm
</span><a href="#local-6989586621679180592"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="annot"><a href="Network.TLS.Packet.html#getServerDHParams"><span class="hs-identifier hs-type">getServerDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span>
</span><span id="line-488"></span><span id="getServerDHParams"><span class="annot"><span class="annottext">getServerDHParams :: Get ServerDHParams
</span><a href="Network.TLS.Packet.html#getServerDHParams"><span class="hs-identifier hs-var hs-var">getServerDHParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BigNum -&gt; BigNum -&gt; BigNum -&gt; ServerDHParams
</span><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-var">ServerDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">(BigNum -&gt; BigNum -&gt; BigNum -&gt; ServerDHParams)
-&gt; Get BigNum -&gt; Get (BigNum -&gt; BigNum -&gt; ServerDHParams)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get BigNum
</span><a href="Network.TLS.Wire.html#getBigNum16"><span class="hs-identifier hs-var">getBigNum16</span></a></span><span> </span><span class="annot"><span class="annottext">Get (BigNum -&gt; BigNum -&gt; ServerDHParams)
-&gt; Get BigNum -&gt; Get (BigNum -&gt; ServerDHParams)
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get BigNum
</span><a href="Network.TLS.Wire.html#getBigNum16"><span class="hs-identifier hs-var">getBigNum16</span></a></span><span> </span><span class="annot"><span class="annottext">Get (BigNum -&gt; ServerDHParams) -&gt; Get BigNum -&gt; Get ServerDHParams
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get BigNum
</span><a href="Network.TLS.Wire.html#getBigNum16"><span class="hs-identifier hs-var">getBigNum16</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="annot"><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-type">putServerDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-491"></span><span id="putServerDHParams"><span class="annot"><span class="annottext">putServerDHParams :: ServerDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-var hs-var">putServerDHParams</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span> </span><span id="local-6989586621679180595"><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180595"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679180596"><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180596"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679180597"><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180597"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BigNum -&gt; Put) -&gt; [BigNum] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">BigNum -&gt; Put
</span><a href="Network.TLS.Wire.html#putBigNum16"><span class="hs-identifier hs-var">putBigNum16</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180595"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180596"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BigNum
</span><a href="#local-6989586621679180597"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- RFC 4492 Section 5.4 Server Key Exchange</span><span>
</span><span id="line-494"></span><span class="annot"><a href="Network.TLS.Packet.html#getServerECDHParams"><span class="hs-identifier hs-type">getServerECDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span>
</span><span id="line-495"></span><span id="getServerECDHParams"><span class="annot"><span class="annottext">getServerECDHParams :: Get ServerECDHParams
</span><a href="Network.TLS.Packet.html#getServerECDHParams"><span class="hs-identifier hs-var hs-var">getServerECDHParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679180599"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180599"><span class="hs-identifier hs-var">curveType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180599"><span class="hs-identifier hs-var">curveType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>               </span><span class="hs-comment">-- ECParameters ECCurveType: curve name type</span><span>
</span><span id="line-499"></span><span>            </span><span id="local-6989586621679180600"><span class="annot"><span class="annottext">Maybe Group
</span><a href="#local-6989586621679180600"><span class="hs-identifier hs-var">mgrp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Maybe Group
forall a. EnumSafe16 a =&gt; Word16 -&gt; Maybe a
</span><a href="Network.TLS.Struct.html#toEnumSafe16"><span class="hs-identifier hs-var">toEnumSafe16</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Maybe Group) -&gt; Get Word16 -&gt; Get (Maybe Group)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><a href="Network.TLS.Wire.html#getWord16"><span class="hs-identifier hs-var">getWord16</span></a></span><span>  </span><span class="hs-comment">-- ECParameters NamedCurve</span><span>
</span><span id="line-500"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Group
</span><a href="#local-6989586621679180600"><span class="hs-identifier hs-var">mgrp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>              </span><span class="annot"><span class="annottext">Maybe Group
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get ServerECDHParams
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getServerECDHParams: unknown group&quot;</span></span><span>
</span><span id="line-502"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180602"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679180602"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>                  </span><span id="local-6989586621679180603"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180603"><span class="hs-identifier hs-var">mxy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque8"><span class="hs-identifier hs-var">getOpaque8</span></a></span><span> </span><span class="hs-comment">-- ECPoint</span><span>
</span><span id="line-504"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Group -&gt; ByteString -&gt; Either CryptoError GroupPublic
</span><a href="Network.TLS.Crypto.IES.html#decodeGroupPublic"><span class="hs-identifier hs-var">decodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679180602"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180603"><span class="hs-identifier hs-var">mxy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-505"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679180605"><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679180605"><span class="hs-identifier hs-var">e</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get ServerECDHParams
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Get ServerECDHParams) -&gt; [Char] -&gt; Get ServerECDHParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getServerECDHParams: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CryptoError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679180605"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-506"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679180606"><span class="annot"><span class="annottext">GroupPublic
</span><a href="#local-6989586621679180606"><span class="hs-identifier hs-var">grppub</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; Get ServerECDHParams
forall a. a -&gt; Get a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ServerECDHParams -&gt; Get ServerECDHParams)
-&gt; ServerECDHParams -&gt; Get ServerECDHParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group -&gt; GroupPublic -&gt; ServerECDHParams
</span><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-var">ServerECDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679180602"><span class="hs-identifier hs-var">grp</span></a></span><span> </span><span class="annot"><span class="annottext">GroupPublic
</span><a href="#local-6989586621679180606"><span class="hs-identifier hs-var">grppub</span></a></span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-508"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; Get ServerECDHParams
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;getServerECDHParams: unknown type for ECDH Params&quot;</span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- RFC 4492 Section 5.4 Server Key Exchange</span><span>
</span><span id="line-511"></span><span class="annot"><a href="Network.TLS.Packet.html#putServerECDHParams"><span class="hs-identifier hs-type">putServerECDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-512"></span><span id="putServerECDHParams"><span class="annot"><span class="annottext">putServerECDHParams :: ServerECDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerECDHParams"><span class="hs-identifier hs-var hs-var">putServerECDHParams</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span> </span><span id="local-6989586621679180608"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span id="local-6989586621679180609"><span class="annot"><span class="annottext">GroupPublic
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">grppub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">3</span></span><span>                            </span><span class="hs-comment">-- ECParameters ECCurveType</span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><a href="Network.TLS.Wire.html#putWord16"><span class="hs-identifier hs-var">putWord16</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Put) -&gt; Word16 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group -&gt; Word16
forall a. EnumSafe16 a =&gt; a -&gt; Word16
</span><a href="Network.TLS.Struct.html#fromEnumSafe16"><span class="hs-identifier hs-var">fromEnumSafe16</span></a></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679180608"><span class="hs-identifier hs-var">grp</span></a></span><span>        </span><span class="hs-comment">-- ECParameters NamedCurve</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque8"><span class="hs-identifier hs-var">putOpaque8</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put) -&gt; ByteString -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GroupPublic -&gt; ByteString
</span><a href="Network.TLS.Crypto.IES.html#encodeGroupPublic"><span class="hs-identifier hs-var">encodeGroupPublic</span></a></span><span> </span><span class="annot"><span class="annottext">GroupPublic
</span><a href="#local-6989586621679180609"><span class="hs-identifier hs-var">grppub</span></a></span><span> </span><span class="hs-comment">-- ECPoint</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="annot"><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-type">getDigitallySigned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#DigitallySigned"><span class="hs-identifier hs-type">DigitallySigned</span></a></span><span>
</span><span id="line-518"></span><span id="getDigitallySigned"><span class="annot"><span class="annottext">getDigitallySigned :: Version -&gt; Get DigitallySigned
</span><a href="Network.TLS.Packet.html#getDigitallySigned"><span class="hs-identifier hs-var hs-var">getDigitallySigned</span></a></span></span><span> </span><span id="local-6989586621679180612"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180612"><span class="hs-identifier hs-var">ver</span></a></span></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180612"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe HashAndSignatureAlgorithm -&gt; ByteString -&gt; DigitallySigned
</span><a href="Network.TLS.Struct.html#DigitallySigned"><span class="hs-identifier hs-var">DigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe HashAndSignatureAlgorithm -&gt; ByteString -&gt; DigitallySigned)
-&gt; Get (Maybe HashAndSignatureAlgorithm)
-&gt; Get (ByteString -&gt; DigitallySigned)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashAndSignatureAlgorithm -&gt; Maybe HashAndSignatureAlgorithm
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(HashAndSignatureAlgorithm -&gt; Maybe HashAndSignatureAlgorithm)
-&gt; Get HashAndSignatureAlgorithm
-&gt; Get (Maybe HashAndSignatureAlgorithm)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get HashAndSignatureAlgorithm
</span><a href="Network.TLS.Packet.html#getSignatureHashAlgorithm"><span class="hs-identifier hs-var">getSignatureHashAlgorithm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>                                     </span><span class="annot"><span class="annottext">Get (ByteString -&gt; DigitallySigned)
-&gt; Get ByteString -&gt; Get DigitallySigned
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque16"><span class="hs-identifier hs-var">getOpaque16</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe HashAndSignatureAlgorithm -&gt; ByteString -&gt; DigitallySigned
</span><a href="Network.TLS.Struct.html#DigitallySigned"><span class="hs-identifier hs-var">DigitallySigned</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HashAndSignatureAlgorithm
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; DigitallySigned)
-&gt; Get ByteString -&gt; Get DigitallySigned
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ByteString
</span><a href="Network.TLS.Wire.html#getOpaque16"><span class="hs-identifier hs-var">getOpaque16</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-type">putDigitallySigned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#DigitallySigned"><span class="hs-identifier hs-type">DigitallySigned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-524"></span><span id="putDigitallySigned"><span class="annot"><span class="annottext">putDigitallySigned :: DigitallySigned -&gt; Put
</span><a href="Network.TLS.Packet.html#putDigitallySigned"><span class="hs-identifier hs-var hs-var">putDigitallySigned</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#DigitallySigned"><span class="hs-identifier hs-type">DigitallySigned</span></a></span><span> </span><span id="local-6989586621679180614"><span class="annot"><span class="annottext">Maybe HashAndSignatureAlgorithm
</span><a href="#local-6989586621679180614"><span class="hs-identifier hs-var">mhash</span></a></span></span><span> </span><span id="local-6989586621679180615"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180615"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">Put
-&gt; (HashAndSignatureAlgorithm -&gt; Put)
-&gt; Maybe HashAndSignatureAlgorithm
-&gt; Put
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Put
forall a. a -&gt; PutM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashAndSignatureAlgorithm -&gt; Put
</span><a href="Network.TLS.Packet.html#putSignatureHashAlgorithm"><span class="hs-identifier hs-var">putSignatureHashAlgorithm</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HashAndSignatureAlgorithm
</span><a href="#local-6989586621679180614"><span class="hs-identifier hs-var">mhash</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putOpaque16"><span class="hs-identifier hs-var">putOpaque16</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180615"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">{-
 - decode and encode ALERT
 -}</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeChangeCipherSpec"><span class="hs-identifier hs-type">decodeChangeCipherSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span id="decodeChangeCipherSpec"><span class="annot"><span class="annottext">decodeChangeCipherSpec :: ByteString -&gt; Either TLSError ()
</span><a href="Network.TLS.Packet.html#decodeChangeCipherSpec"><span class="hs-identifier hs-var hs-var">decodeChangeCipherSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Get () -&gt; ByteString -&gt; Either TLSError ()
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;changecipherspec&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get () -&gt; ByteString -&gt; Either TLSError ())
-&gt; Get () -&gt; ByteString -&gt; Either TLSError ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679180617"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><span class="hs-identifier hs-var">getWord8</span></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679180617"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Get ()
forall a. [Char] -&gt; Get a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unknown change cipher spec content&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeChangeCipherSpec"><span class="hs-identifier hs-type">encodeChangeCipherSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-537"></span><span id="encodeChangeCipherSpec"><span class="annot"><span class="annottext">encodeChangeCipherSpec :: ByteString
</span><a href="Network.TLS.Packet.html#encodeChangeCipherSpec"><span class="hs-identifier hs-var hs-var">encodeChangeCipherSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Putter Word8
</span><span class="hs-identifier hs-var">putWord8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- rsa pre master secret</span><span>
</span><span id="line-540"></span><span class="annot"><a href="Network.TLS.Packet.html#decodePreMasterSecret"><span class="hs-identifier hs-type">decodePreMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span id="decodePreMasterSecret"><span class="annot"><span class="annottext">decodePreMasterSecret :: ByteString -&gt; Either TLSError (Version, ByteString)
</span><a href="Network.TLS.Packet.html#decodePreMasterSecret"><span class="hs-identifier hs-var hs-var">decodePreMasterSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Get (Version, ByteString)
-&gt; ByteString
-&gt; Either TLSError (Version, ByteString)
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre-master-secret&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Get (Version, ByteString)
 -&gt; ByteString -&gt; Either TLSError (Version, ByteString))
-&gt; Get (Version, ByteString)
-&gt; ByteString
-&gt; Either TLSError (Version, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Version -&gt; ByteString -&gt; (Version, ByteString))
-&gt; Get Version -&gt; Get (ByteString -&gt; (Version, ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Version
</span><a href="Network.TLS.Packet.html#getVersion"><span class="hs-identifier hs-var">getVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Get (ByteString -&gt; (Version, ByteString))
-&gt; Get ByteString -&gt; Get (Version, ByteString)
forall a b. Get (a -&gt; b) -&gt; Get a -&gt; Get b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">46</span></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="annot"><a href="Network.TLS.Packet.html#encodePreMasterSecret"><span class="hs-identifier hs-type">encodePreMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-545"></span><span id="encodePreMasterSecret"><span class="annot"><span class="annottext">encodePreMasterSecret :: Version -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodePreMasterSecret"><span class="hs-identifier hs-var hs-var">encodePreMasterSecret</span></a></span></span><span> </span><span id="local-6989586621679180619"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180619"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span id="local-6989586621679180620"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180620"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Put
</span><a href="Network.TLS.Packet.html#putBinaryVersion"><span class="hs-identifier hs-var">putBinaryVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180619"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Network.TLS.Wire.html#putBytes"><span class="hs-identifier hs-var">putBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180620"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- | in certain cases, we haven't manage to decode ServerKeyExchange properly,</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- because the decoding was too eager and the cipher wasn't been set yet.</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- we keep the Server Key Exchange in it unparsed format, and this function is</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- able to really decode the server key xchange if it's unparsed.</span><span>
</span><span id="line-551"></span><span class="annot"><a href="Network.TLS.Packet.html#decodeReallyServerKeyXchgAlgorithmData"><span class="hs-identifier hs-type">decodeReallyServerKeyXchgAlgorithmData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-552"></span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#CipherKeyExchangeType"><span class="hs-identifier hs-type">CipherKeyExchangeType</span></a></span><span>
</span><span id="line-553"></span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-554"></span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#TLSError"><span class="hs-identifier hs-type">TLSError</span></a></span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerKeyXchgAlgorithmData"><span class="hs-identifier hs-type">ServerKeyXchgAlgorithmData</span></a></span><span>
</span><span id="line-555"></span><span id="decodeReallyServerKeyXchgAlgorithmData"><span class="annot"><span class="annottext">decodeReallyServerKeyXchgAlgorithmData :: Version
-&gt; CipherKeyExchangeType
-&gt; ByteString
-&gt; Either TLSError ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Packet.html#decodeReallyServerKeyXchgAlgorithmData"><span class="hs-identifier hs-var hs-var">decodeReallyServerKeyXchgAlgorithmData</span></a></span></span><span> </span><span id="local-6989586621679180621"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180621"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180622"><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180622"><span class="hs-identifier hs-var">cke</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><span class="annottext">[Char]
-&gt; Get ServerKeyXchgAlgorithmData
-&gt; ByteString
-&gt; Either TLSError ServerKeyXchgAlgorithmData
forall a. [Char] -&gt; Get a -&gt; ByteString -&gt; Either TLSError a
</span><a href="Network.TLS.Wire.html#runGetErr"><span class="hs-identifier hs-var">runGetErr</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;server-key-xchg-algorithm-data&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; CipherKeyExchangeType -&gt; Get ServerKeyXchgAlgorithmData
</span><a href="Network.TLS.Packet.html#decodeServerKeyXchgAlgorithmData"><span class="hs-identifier hs-var">decodeServerKeyXchgAlgorithmData</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180621"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">CipherKeyExchangeType
</span><a href="#local-6989586621679180622"><span class="hs-identifier hs-var">cke</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="hs-comment">{-
 - generate things for packet content
 -}</span><span>
</span><span id="line-562"></span><span class="hs-keyword">type</span><span> </span><span id="PRF"><span class="annot"><a href="Network.TLS.Packet.html#PRF"><span class="hs-identifier hs-var">PRF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | The TLS12 PRF is cipher specific, and some TLS12 algorithms use SHA384</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- instead of the default SHA256.</span><span>
</span><span id="line-566"></span><span class="annot"><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-type">getPRF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#PRF"><span class="hs-identifier hs-type">PRF</span></a></span><span>
</span><span id="line-567"></span><span id="getPRF"><span class="annot"><span class="annottext">getPRF :: Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var hs-var">getPRF</span></a></span></span><span> </span><span id="local-6989586621679180624"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180625"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180625"><span class="hs-identifier hs-var">ciph</span></a></span></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF
</span><a href="Network.TLS.MAC.html#prf_MD5SHA1"><span class="hs-identifier hs-var">prf_MD5SHA1</span></a></span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Version -&gt; Bool) -&gt; Maybe Version -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS12"><span class="hs-identifier hs-var">TLS12</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cipher -&gt; Maybe Version
</span><a href="Network.TLS.Cipher.html#cipherMinVer"><span class="hs-identifier hs-var">cipherMinVer</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180625"><span class="hs-identifier hs-var">ciph</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF
</span><a href="Network.TLS.MAC.html#prf_SHA256"><span class="hs-identifier hs-var">prf_SHA256</span></a></span><span>
</span><span id="line-570"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Version -&gt; Hash -&gt; PRF
</span><a href="Network.TLS.MAC.html#prf_TLS"><span class="hs-identifier hs-var">prf_TLS</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180624"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">(Hash -&gt; PRF) -&gt; Hash -&gt; PRF
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hash -&gt; Maybe Hash -&gt; Hash
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA256"><span class="hs-identifier hs-var">SHA256</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Hash -&gt; Hash) -&gt; Maybe Hash -&gt; Hash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cipher -&gt; Maybe Hash
</span><a href="Network.TLS.Cipher.html#cipherPRFHash"><span class="hs-identifier hs-var">cipherPRFHash</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180625"><span class="hs-identifier hs-var">ciph</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span id="local-6989586621679179717"><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret_SSL"><span class="hs-identifier hs-type">generateMasterSecret_SSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679179717"><span class="hs-identifier hs-type">preMaster</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179717"><span class="hs-identifier hs-type">preMaster</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-573"></span><span id="generateMasterSecret_SSL"><span class="annot"><span class="annottext">generateMasterSecret_SSL :: forall preMaster.
ByteArrayAccess preMaster =&gt;
preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret_SSL"><span class="hs-identifier hs-var hs-var">generateMasterSecret_SSL</span></a></span></span><span> </span><span id="local-6989586621679180638"><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180638"><span class="hs-identifier hs-var">premasterSecret</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span id="local-6989586621679180639"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180639"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span id="local-6989586621679180640"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180640"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679180641"><span class="hs-identifier hs-var">computeMD5</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;A&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;BB&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;CCC&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180641"><span class="annot"><span class="annottext">computeMD5 :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679180641"><span class="hs-identifier hs-var hs-var">computeMD5</span></a></span></span><span>  </span><span id="local-6989586621679180645"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180645"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">preMaster -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180638"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679180648"><span class="hs-identifier hs-var">computeSHA1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180645"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621679180648"><span class="annot"><span class="annottext">computeSHA1 :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679180648"><span class="hs-identifier hs-var hs-var">computeSHA1</span></a></span></span><span> </span><span id="local-6989586621679180651"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180651"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-var">SHA1</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180651"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preMaster -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180638"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180639"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180640"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span id="local-6989586621679179723"><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret_TLS"><span class="hs-identifier hs-type">generateMasterSecret_TLS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679179723"><span class="hs-identifier hs-type">preMaster</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#PRF"><span class="hs-identifier hs-type">PRF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179723"><span class="hs-identifier hs-type">preMaster</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-579"></span><span id="generateMasterSecret_TLS"><span class="annot"><span class="annottext">generateMasterSecret_TLS :: forall preMaster.
ByteArrayAccess preMaster =&gt;
PRF -&gt; preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret_TLS"><span class="hs-identifier hs-var hs-var">generateMasterSecret_TLS</span></a></span></span><span> </span><span id="local-6989586621679180657"><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180657"><span class="hs-identifier hs-var">prf</span></a></span></span><span> </span><span id="local-6989586621679180658"><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180658"><span class="hs-identifier hs-var">premasterSecret</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span id="local-6989586621679180659"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180659"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span id="local-6989586621679180660"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180660"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180657"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">preMaster -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180658"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180661"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180661"><span class="annot"><span class="annottext">seed :: ByteString
</span><a href="#local-6989586621679180661"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;master secret&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180659"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180660"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span id="local-6989586621679179725"><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier hs-type">generateMasterSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679179725"><span class="hs-identifier hs-type">preMaster</span></a></span><span>
</span><span id="line-584"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-585"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-586"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179725"><span class="hs-identifier hs-type">preMaster</span></a></span><span>
</span><span id="line-587"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span>
</span><span id="line-588"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span>
</span><span id="line-589"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-590"></span><span id="generateMasterSecret"><span class="annot"><span class="annottext">generateMasterSecret :: forall preMaster.
ByteArrayAccess preMaster =&gt;
Version
-&gt; Cipher
-&gt; preMaster
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier hs-var hs-var">generateMasterSecret</span></a></span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#SSL2"><span class="hs-identifier hs-var">SSL2</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
forall preMaster.
ByteArrayAccess preMaster =&gt;
preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret_SSL"><span class="hs-identifier hs-var">generateMasterSecret_SSL</span></a></span><span>
</span><span id="line-591"></span><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier hs-var">generateMasterSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#SSL3"><span class="hs-identifier hs-var">SSL3</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
forall preMaster.
ByteArrayAccess preMaster =&gt;
preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret_SSL"><span class="hs-identifier hs-var">generateMasterSecret_SSL</span></a></span><span>
</span><span id="line-592"></span><span class="annot"><a href="Network.TLS.Packet.html#generateMasterSecret"><span class="hs-identifier hs-var">generateMasterSecret</span></a></span><span> </span><span id="local-6989586621679180669"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180669"><span class="hs-identifier hs-var">v</span></a></span></span><span>    </span><span id="local-6989586621679180670"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180670"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF -&gt; preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
forall preMaster.
ByteArrayAccess preMaster =&gt;
PRF -&gt; preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateMasterSecret_TLS"><span class="hs-identifier hs-var">generateMasterSecret_TLS</span></a></span><span> </span><span class="annot"><span class="annottext">(PRF -&gt; preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString)
-&gt; PRF -&gt; preMaster -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var">getPRF</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180669"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180670"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span id="local-6989586621679179727"><span class="annot"><a href="Network.TLS.Packet.html#generateExtendedMasterSec"><span class="hs-identifier hs-type">generateExtendedMasterSec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteArrayAccess</span></span><span> </span><span class="annot"><a href="#local-6989586621679179727"><span class="hs-identifier hs-type">preMaster</span></a></span><span>
</span><span id="line-595"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-596"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-597"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179727"><span class="hs-identifier hs-type">preMaster</span></a></span><span>
</span><span id="line-598"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-599"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span></span><span>
</span><span id="line-600"></span><span id="generateExtendedMasterSec"><span class="annot"><span class="annottext">generateExtendedMasterSec :: forall preMaster.
ByteArrayAccess preMaster =&gt;
Version -&gt; Cipher -&gt; preMaster -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateExtendedMasterSec"><span class="hs-identifier hs-var hs-var">generateExtendedMasterSec</span></a></span></span><span> </span><span id="local-6989586621679180674"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180674"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679180675"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180675"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679180676"><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180676"><span class="hs-identifier hs-var">premasterSecret</span></a></span></span><span> </span><span id="local-6989586621679180677"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180677"><span class="hs-identifier hs-var">sessionHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var">getPRF</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180674"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180675"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">preMaster -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><span class="hs-identifier hs-var">B.convert</span></span><span> </span><span class="annot"><span class="annottext">preMaster
</span><a href="#local-6989586621679180676"><span class="hs-identifier hs-var">premasterSecret</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180678"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180678"><span class="annot"><span class="annottext">seed :: ByteString
</span><a href="#local-6989586621679180678"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.append</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;extended master secret&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180677"><span class="hs-identifier hs-var">sessionHash</span></a></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock_TLS"><span class="hs-identifier hs-type">generateKeyBlock_TLS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#PRF"><span class="hs-identifier hs-type">PRF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-605"></span><span id="generateKeyBlock_TLS"><span class="annot"><span class="annottext">generateKeyBlock_TLS :: PRF
-&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock_TLS"><span class="hs-identifier hs-var hs-var">generateKeyBlock_TLS</span></a></span></span><span> </span><span id="local-6989586621679180681"><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180681"><span class="hs-identifier hs-var">prf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span id="local-6989586621679180682"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180682"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span id="local-6989586621679180683"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180683"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180684"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180684"><span class="hs-identifier hs-var">mastersecret</span></a></span></span><span> </span><span id="local-6989586621679180685"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180685"><span class="hs-identifier hs-var">kbsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180681"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180684"><span class="hs-identifier hs-var">mastersecret</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180686"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180685"><span class="hs-identifier hs-var">kbsize</span></a></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180686"><span class="annot"><span class="annottext">seed :: ByteString
</span><a href="#local-6989586621679180686"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;key expansion&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180683"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180682"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock_SSL"><span class="hs-identifier hs-type">generateKeyBlock_SSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-609"></span><span id="generateKeyBlock_SSL"><span class="annot"><span class="annottext">generateKeyBlock_SSL :: ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock_SSL"><span class="hs-identifier hs-var hs-var">generateKeyBlock_SSL</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span id="local-6989586621679180689"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180689"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span id="local-6989586621679180690"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180690"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679180691"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180691"><span class="hs-identifier hs-var">mastersecret</span></a></span></span><span> </span><span id="local-6989586621679180692"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180692"><span class="hs-identifier hs-var">kbsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679180693"><span class="hs-identifier hs-var">computeMD5</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [ByteString] -&gt; [ByteString]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679180692"><span class="hs-identifier hs-var">kbsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679180696"><span class="hs-identifier hs-var">labels</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180696"><span class="annot"><span class="annottext">labels :: [ByteString]
</span><a href="#local-6989586621679180696"><span class="hs-identifier hs-var hs-var">labels</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char -&gt; ByteString) -&gt; (Int, Char) -&gt; ByteString
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; ByteString
</span><span class="hs-identifier hs-var">BC.replicate</span></span><span> </span><span class="annot"><span class="annottext">(Int, Char)
</span><a href="#local-6989586621679180704"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679180704"><span class="annot"><span class="annottext">(Int, Char)
</span><a href="#local-6989586621679180704"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Char] -&gt; [(Int, Char)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-612"></span><span>        </span><span id="local-6989586621679180693"><span class="annot"><span class="annottext">computeMD5 :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679180693"><span class="hs-identifier hs-var hs-var">computeMD5</span></a></span></span><span>  </span><span id="local-6989586621679180705"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180705"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180691"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679180706"><span class="hs-identifier hs-var">computeSHA1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180705"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>        </span><span id="local-6989586621679180706"><span class="annot"><span class="annottext">computeSHA1 :: ByteString -&gt; ByteString
</span><a href="#local-6989586621679180706"><span class="hs-identifier hs-var hs-var">computeSHA1</span></a></span></span><span> </span><span id="local-6989586621679180707"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180707"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-var">SHA1</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180707"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180691"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180690"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180689"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier hs-type">generateKeyBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-616"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-617"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span>
</span><span id="line-618"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span>
</span><span id="line-619"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-620"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-621"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-622"></span><span id="generateKeyBlock"><span class="annot"><span class="annottext">generateKeyBlock :: Version
-&gt; Cipher
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
-&gt; Int
-&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier hs-var hs-var">generateKeyBlock</span></a></span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#SSL2"><span class="hs-identifier hs-var">SSL2</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock_SSL"><span class="hs-identifier hs-var">generateKeyBlock_SSL</span></a></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier hs-var">generateKeyBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#SSL3"><span class="hs-identifier hs-var">SSL3</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock_SSL"><span class="hs-identifier hs-var">generateKeyBlock_SSL</span></a></span><span>
</span><span id="line-624"></span><span class="annot"><a href="Network.TLS.Packet.html#generateKeyBlock"><span class="hs-identifier hs-var">generateKeyBlock</span></a></span><span> </span><span id="local-6989586621679180708"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180708"><span class="hs-identifier hs-var">v</span></a></span></span><span>    </span><span id="local-6989586621679180709"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180709"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF
-&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateKeyBlock_TLS"><span class="hs-identifier hs-var">generateKeyBlock_TLS</span></a></span><span> </span><span class="annot"><span class="annottext">(PRF
 -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString -&gt; Int -&gt; ByteString)
-&gt; PRF
-&gt; ClientRandom
-&gt; ServerRandom
-&gt; ByteString
-&gt; Int
-&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var">getPRF</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180708"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180709"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="annot"><a href="Network.TLS.Packet.html#generateFinished_TLS"><span class="hs-identifier hs-type">generateFinished_TLS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Packet.html#PRF"><span class="hs-identifier hs-type">PRF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-627"></span><span id="generateFinished_TLS"><span class="annot"><span class="annottext">generateFinished_TLS :: PRF -&gt; ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_TLS"><span class="hs-identifier hs-var hs-var">generateFinished_TLS</span></a></span></span><span> </span><span id="local-6989586621679180711"><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180711"><span class="hs-identifier hs-var">prf</span></a></span></span><span> </span><span id="local-6989586621679180712"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180712"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679180713"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180713"><span class="hs-identifier hs-var">mastersecret</span></a></span></span><span> </span><span id="local-6989586621679180714"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180714"><span class="hs-identifier hs-var">hashctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF
</span><a href="#local-6989586621679180711"><span class="hs-identifier hs-var">prf</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180713"><span class="hs-identifier hs-var">mastersecret</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180715"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180715"><span class="annot"><span class="annottext">seed :: ByteString
</span><a href="#local-6989586621679180715"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180712"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180714"><span class="hs-identifier hs-var">hashctx</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="annot"><a href="Network.TLS.Packet.html#generateFinished_SSL"><span class="hs-identifier hs-type">generateFinished_SSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-631"></span><span id="generateFinished_SSL"><span class="annot"><span class="annottext">generateFinished_SSL :: ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_SSL"><span class="hs-identifier hs-var hs-var">generateFinished_SSL</span></a></span></span><span> </span><span id="local-6989586621679180718"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180718"><span class="hs-identifier hs-var">sender</span></a></span></span><span> </span><span id="local-6989586621679180719"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180719"><span class="hs-identifier hs-var">mastersecret</span></a></span></span><span> </span><span id="local-6989586621679180720"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180720"><span class="hs-identifier hs-var">hashctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180721"><span class="hs-identifier hs-var">md5hash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180722"><span class="hs-identifier hs-var">sha1hash</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180721"><span class="annot"><span class="annottext">md5hash :: ByteString
</span><a href="#local-6989586621679180721"><span class="hs-identifier hs-var hs-var">md5hash</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#MD5"><span class="hs-identifier hs-var">MD5</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180719"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180723"><span class="hs-identifier hs-var">pad2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180724"><span class="hs-identifier hs-var">md5left</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-633"></span><span>        </span><span id="local-6989586621679180722"><span class="annot"><span class="annottext">sha1hash :: ByteString
</span><a href="#local-6989586621679180722"><span class="hs-identifier hs-var hs-var">sha1hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Hash -&gt; ByteString -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hash"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash
</span><a href="Network.TLS.Crypto.html#SHA1"><span class="hs-identifier hs-var">SHA1</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180719"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180723"><span class="hs-identifier hs-var">pad2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180726"><span class="hs-identifier hs-var">sha1left</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>        </span><span id="local-6989586621679180728"><span class="annot"><span class="annottext">lefthash :: ByteString
</span><a href="#local-6989586621679180728"><span class="hs-identifier hs-var hs-var">lefthash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString) -&gt; HashCtx -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; (ByteString, ByteString) -&gt; HashCtx)
-&gt; (ByteString, ByteString) -&gt; HashCtx -&gt; HashCtx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; (ByteString, ByteString) -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdateSSL"><span class="hs-identifier hs-var">hashUpdateSSL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180731"><span class="hs-identifier hs-var">pad1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180731"><span class="hs-identifier hs-var">pad1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>                             </span><span class="annot"><span class="annottext">(HashCtx -&gt; HashCtx) -&gt; HashCtx -&gt; HashCtx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString -&gt; HashCtx)
-&gt; HashCtx -&gt; [ByteString] -&gt; HashCtx
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180720"><span class="hs-identifier hs-var">hashctx</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180718"><span class="hs-identifier hs-var">sender</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180719"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679180724"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180724"><span class="hs-identifier hs-var">md5left</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679180726"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180726"><span class="hs-identifier hs-var">sha1left</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">B.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180728"><span class="hs-identifier hs-var">lefthash</span></a></span><span>
</span><span id="line-638"></span><span>        </span><span id="local-6989586621679180723"><span class="annot"><span class="annottext">pad2 :: ByteString
</span><a href="#local-6989586621679180723"><span class="hs-identifier hs-var hs-var">pad2</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">B.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x5c</span></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679180731"><span class="annot"><span class="annottext">pad1 :: ByteString
</span><a href="#local-6989586621679180731"><span class="hs-identifier hs-var hs-var">pad1</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">B.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x36</span></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><a href="Network.TLS.Packet.html#generateClientFinished"><span class="hs-identifier hs-type">generateClientFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-642"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-643"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-644"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-645"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-646"></span><span id="generateClientFinished"><span class="annot"><span class="annottext">generateClientFinished :: Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateClientFinished"><span class="hs-identifier hs-var hs-var">generateClientFinished</span></a></span></span><span> </span><span id="local-6989586621679180737"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180737"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180738"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180738"><span class="hs-identifier hs-var">ciph</span></a></span></span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180737"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS10"><span class="hs-identifier hs-var">TLS10</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_SSL"><span class="hs-identifier hs-var">generateFinished_SSL</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;CLNT&quot;</span></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF -&gt; ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_TLS"><span class="hs-identifier hs-var">generateFinished_TLS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var">getPRF</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180737"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180738"><span class="hs-identifier hs-var">ciph</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;client finished&quot;</span></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span class="annot"><a href="Network.TLS.Packet.html#generateServerFinished"><span class="hs-identifier hs-type">generateServerFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Types.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span>
</span><span id="line-651"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Cipher.html#Cipher"><span class="hs-identifier hs-type">Cipher</span></a></span><span>
</span><span id="line-652"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-653"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span>
</span><span id="line-654"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-655"></span><span id="generateServerFinished"><span class="annot"><span class="annottext">generateServerFinished :: Version -&gt; Cipher -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateServerFinished"><span class="hs-identifier hs-var hs-var">generateServerFinished</span></a></span></span><span> </span><span id="local-6989586621679180740"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180740"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span id="local-6989586621679180741"><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180741"><span class="hs-identifier hs-var">ciph</span></a></span></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180740"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Network.TLS.Types.html#TLS10"><span class="hs-identifier hs-var">TLS10</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_SSL"><span class="hs-identifier hs-var">generateFinished_SSL</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;SRVR&quot;</span></span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PRF -&gt; ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_TLS"><span class="hs-identifier hs-var">generateFinished_TLS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Cipher -&gt; PRF
</span><a href="Network.TLS.Packet.html#getPRF"><span class="hs-identifier hs-var">getPRF</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679180740"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Cipher
</span><a href="#local-6989586621679180741"><span class="hs-identifier hs-var">ciph</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;server finished&quot;</span></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">{- returns *output* after final MD5/SHA1 -}</span><span>
</span><span id="line-660"></span><span class="annot"><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL"><span class="hs-identifier hs-type">generateCertificateVerify_SSL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-661"></span><span id="generateCertificateVerify_SSL"><span class="annot"><span class="annottext">generateCertificateVerify_SSL :: ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL"><span class="hs-identifier hs-var hs-var">generateCertificateVerify_SSL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateFinished_SSL"><span class="hs-identifier hs-var">generateFinished_SSL</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">{- returns *input* before final SHA1 -}</span><span>
</span><span id="line-664"></span><span class="annot"><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL_DSS"><span class="hs-identifier hs-type">generateCertificateVerify_SSL_DSS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Crypto.html#HashCtx"><span class="hs-identifier hs-type">HashCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-665"></span><span id="generateCertificateVerify_SSL_DSS"><span class="annot"><span class="annottext">generateCertificateVerify_SSL_DSS :: ByteString -&gt; HashCtx -&gt; ByteString
</span><a href="Network.TLS.Packet.html#generateCertificateVerify_SSL_DSS"><span class="hs-identifier hs-var hs-var">generateCertificateVerify_SSL_DSS</span></a></span></span><span> </span><span id="local-6989586621679180742"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180742"><span class="hs-identifier hs-var">mastersecret</span></a></span></span><span> </span><span id="local-6989586621679180743"><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180743"><span class="hs-identifier hs-var">hashctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180744"><span class="hs-identifier hs-var">toHash</span></a></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679180744"><span class="annot"><span class="annottext">toHash :: ByteString
</span><a href="#local-6989586621679180744"><span class="hs-identifier hs-var hs-var">toHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180742"><span class="hs-identifier hs-var">mastersecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180745"><span class="hs-identifier hs-var">pad2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180746"><span class="hs-identifier hs-var">sha1left</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span>        </span><span id="local-6989586621679180746"><span class="annot"><span class="annottext">sha1left :: ByteString
</span><a href="#local-6989586621679180746"><span class="hs-identifier hs-var hs-var">sha1left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString
</span><a href="Network.TLS.Crypto.html#hashFinal"><span class="hs-identifier hs-var">hashFinal</span></a></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString) -&gt; HashCtx -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashCtx -&gt; ByteString -&gt; HashCtx)
-&gt; ByteString -&gt; HashCtx -&gt; HashCtx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180747"><span class="hs-identifier hs-var">pad1</span></a></span><span>
</span><span id="line-669"></span><span>                             </span><span class="annot"><span class="annottext">(HashCtx -&gt; HashCtx) -&gt; HashCtx -&gt; HashCtx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashCtx -&gt; ByteString -&gt; HashCtx
</span><a href="Network.TLS.Crypto.html#hashUpdate"><span class="hs-identifier hs-var">hashUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">HashCtx
</span><a href="#local-6989586621679180743"><span class="hs-identifier hs-var">hashctx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679180742"><span class="hs-identifier hs-var">mastersecret</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span id="local-6989586621679180745"><span class="annot"><span class="annottext">pad2 :: ByteString
</span><a href="#local-6989586621679180745"><span class="hs-identifier hs-var hs-var">pad2</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">B.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x5c</span></span><span>
</span><span id="line-671"></span><span>        </span><span id="local-6989586621679180747"><span class="annot"><span class="annottext">pad1 :: ByteString
</span><a href="#local-6989586621679180747"><span class="hs-identifier hs-var hs-var">pad1</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><span class="hs-identifier hs-var">B.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0x36</span></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeSignedDHParams"><span class="hs-identifier hs-type">encodeSignedDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerDHParams"><span class="hs-identifier hs-type">ServerDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-674"></span><span id="encodeSignedDHParams"><span class="annot"><span class="annottext">encodeSignedDHParams :: ServerDHParams -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeSignedDHParams"><span class="hs-identifier hs-var hs-var">encodeSignedDHParams</span></a></span></span><span> </span><span id="local-6989586621679180750"><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180750"><span class="hs-identifier hs-var">dhparams</span></a></span></span><span> </span><span id="local-6989586621679180751"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180751"><span class="hs-identifier hs-var">cran</span></a></span></span><span> </span><span id="local-6989586621679180752"><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180752"><span class="hs-identifier hs-var">sran</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><span class="annottext">ClientRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier hs-var">putClientRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180751"><span class="hs-identifier hs-var">cran</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ServerRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier hs-var">putServerRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180752"><span class="hs-identifier hs-var">sran</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ServerDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerDHParams"><span class="hs-identifier hs-var">putServerDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerDHParams
</span><a href="#local-6989586621679180750"><span class="hs-identifier hs-var">dhparams</span></a></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- Combination of RFC 5246 and 4492 is ambiguous.</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- Let's assume ecdhe_rsa and ecdhe_dss are identical to</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- dhe_rsa and dhe_dss.</span><span>
</span><span id="line-680"></span><span class="annot"><a href="Network.TLS.Packet.html#encodeSignedECDHParams"><span class="hs-identifier hs-type">encodeSignedECDHParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerECDHParams"><span class="hs-identifier hs-type">ServerECDHParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ClientRandom"><span class="hs-identifier hs-type">ClientRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Network.TLS.Struct.html#ServerRandom"><span class="hs-identifier hs-type">ServerRandom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-681"></span><span id="encodeSignedECDHParams"><span class="annot"><span class="annottext">encodeSignedECDHParams :: ServerECDHParams -&gt; ClientRandom -&gt; ServerRandom -&gt; ByteString
</span><a href="Network.TLS.Packet.html#encodeSignedECDHParams"><span class="hs-identifier hs-var hs-var">encodeSignedECDHParams</span></a></span></span><span> </span><span id="local-6989586621679180753"><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180753"><span class="hs-identifier hs-var">dhparams</span></a></span></span><span> </span><span id="local-6989586621679180754"><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180754"><span class="hs-identifier hs-var">cran</span></a></span></span><span> </span><span id="local-6989586621679180755"><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180755"><span class="hs-identifier hs-var">sran</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><span class="hs-identifier hs-var">runPut</span></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><span class="annottext">ClientRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putClientRandom32"><span class="hs-identifier hs-var">putClientRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ClientRandom
</span><a href="#local-6989586621679180754"><span class="hs-identifier hs-var">cran</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ServerRandom -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerRandom32"><span class="hs-identifier hs-var">putServerRandom32</span></a></span><span> </span><span class="annot"><span class="annottext">ServerRandom
</span><a href="#local-6989586621679180755"><span class="hs-identifier hs-var">sran</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall a b. PutM a -&gt; PutM b -&gt; PutM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams -&gt; Put
</span><a href="Network.TLS.Packet.html#putServerECDHParams"><span class="hs-identifier hs-var">putServerECDHParams</span></a></span><span> </span><span class="annot"><span class="annottext">ServerECDHParams
</span><a href="#local-6989586621679180753"><span class="hs-identifier hs-var">dhparams</span></a></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span id="local-6989586621679179684"><span id="local-6989586621679179685"><span class="annot"><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-type">fromJustM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679179684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679179685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679179684"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679179685"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-685"></span><span id="fromJustM"><span class="annot"><span class="annottext">fromJustM :: forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; Maybe a -&gt; m a
</span><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-var hs-var">fromJustM</span></a></span></span><span> </span><span id="local-6989586621679180763"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679180763"><span class="hs-identifier hs-var">what</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. [Char] -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fromJustM &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679180763"><span class="hs-identifier hs-var">what</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;: Nothing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span class="annot"><a href="Network.TLS.Packet.html#fromJustM"><span class="hs-identifier hs-var">fromJustM</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679180764"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679180764"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-687"></span></pre></body></html>