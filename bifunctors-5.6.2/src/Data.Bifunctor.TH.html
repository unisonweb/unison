<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE Unsafe #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Copyright   :  (C) 2008-2016 Edward Kmett, (C) 2015-2016 Ryan Scott</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Maintainer  :  Edward Kmett &lt;ekmett@gmail.com&gt;</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Functions to mechanically derive 'Bifunctor', 'Bifoldable',</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- or 'Bitraversable' instances, or to splice their functions directly into</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- source code. You need to enable the @TemplateHaskell@ language extension</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- in order to use this module.</span><span>
</span><span id="line-19"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Bifunctor.TH</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * @derive@- functions</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-comment">-- $derive</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-comment">-- * @make@- functions</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-comment">-- $make</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">-- * 'Bifunctor'</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifunctor"><span class="hs-identifier">deriveBifunctor</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifunctorOptions"><span class="hs-identifier">deriveBifunctorOptions</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimap"><span class="hs-identifier">makeBimap</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapOptions"><span class="hs-identifier">makeBimapOptions</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * 'Bifoldable'</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifoldable"><span class="hs-identifier">deriveBifoldable</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifoldableOptions"><span class="hs-identifier">deriveBifoldableOptions</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifold"><span class="hs-identifier">makeBifold</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldOptions"><span class="hs-identifier">makeBifoldOptions</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldMap"><span class="hs-identifier">makeBifoldMap</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier">makeBifoldMapOptions</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldr"><span class="hs-identifier">makeBifoldr</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldrOptions"><span class="hs-identifier">makeBifoldrOptions</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldl"><span class="hs-identifier">makeBifoldl</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldlOptions"><span class="hs-identifier">makeBifoldlOptions</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * 'Bitraversable'</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBitraversable"><span class="hs-identifier">deriveBitraversable</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBitraversableOptions"><span class="hs-identifier">deriveBitraversableOptions</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBitraverse"><span class="hs-identifier">makeBitraverse</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier">makeBitraverseOptions</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceA"><span class="hs-identifier">makeBisequenceA</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceAOptions"><span class="hs-identifier">makeBisequenceAOptions</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapM"><span class="hs-identifier">makeBimapM</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapMOptions"><span class="hs-identifier">makeBimapMOptions</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequence"><span class="hs-identifier">makeBisequence</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceOptions"><span class="hs-identifier">makeBisequenceOptions</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * 'Options'</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier">Options</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier">defaultOptions</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html"><span class="hs-identifier">Data.Bifunctor.TH.Internal</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">keys</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">member</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">size</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Datatype</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype.TyVarBndr</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Lib</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Ppr</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- User-facing API</span><span>
</span><span id="line-73"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Options that further configure how the functions in &quot;Data.Bifunctor.TH&quot;</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- should behave.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">newtype</span><span> </span><span id="Options"><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Options"><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="emptyCaseBehavior"><span class="annot"><span class="annottext">Options -&gt; Bool
</span><a href="Data.Bifunctor.TH.html#emptyCaseBehavior"><span class="hs-identifier hs-var hs-var">emptyCaseBehavior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- ^ If 'True', derived instances for empty data types (i.e., ones with</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">--   no data constructors) will use the @EmptyCase@ language extension.</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">--   If 'False', derived instances will simply use 'seq' instead.</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679107531"><span id="local-6989586621679107536"><span class="annot"><span class="annottext">Options -&gt; Options -&gt; Bool
(Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Bool) -&gt; Eq Options
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Options -&gt; Options -&gt; Bool
== :: Options -&gt; Options -&gt; Bool
$c/= :: Options -&gt; Options -&gt; Bool
/= :: Options -&gt; Options -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107544"><span id="local-6989586621679107549"><span id="local-6989586621679107553"><span id="local-6989586621679107557"><span id="local-6989586621679107561"><span id="local-6989586621679107565"><span id="local-6989586621679107569"><span class="annot"><span class="annottext">Eq Options
Eq Options =&gt;
(Options -&gt; Options -&gt; Ordering)
-&gt; (Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Options)
-&gt; (Options -&gt; Options -&gt; Options)
-&gt; Ord Options
Options -&gt; Options -&gt; Bool
Options -&gt; Options -&gt; Ordering
Options -&gt; Options -&gt; Options
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Options -&gt; Options -&gt; Ordering
compare :: Options -&gt; Options -&gt; Ordering
$c&lt; :: Options -&gt; Options -&gt; Bool
&lt; :: Options -&gt; Options -&gt; Bool
$c&lt;= :: Options -&gt; Options -&gt; Bool
&lt;= :: Options -&gt; Options -&gt; Bool
$c&gt; :: Options -&gt; Options -&gt; Bool
&gt; :: Options -&gt; Options -&gt; Bool
$c&gt;= :: Options -&gt; Options -&gt; Bool
&gt;= :: Options -&gt; Options -&gt; Bool
$cmax :: Options -&gt; Options -&gt; Options
max :: Options -&gt; Options -&gt; Options
$cmin :: Options -&gt; Options -&gt; Options
min :: Options -&gt; Options -&gt; Options
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107575"><span id="local-6989586621679107579"><span id="local-6989586621679107582"><span id="local-6989586621679107592"><span class="annot"><span class="annottext">ReadPrec [Options]
ReadPrec Options
Int -&gt; ReadS Options
ReadS [Options]
(Int -&gt; ReadS Options)
-&gt; ReadS [Options]
-&gt; ReadPrec Options
-&gt; ReadPrec [Options]
-&gt; Read Options
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS Options
readsPrec :: Int -&gt; ReadS Options
$creadList :: ReadS [Options]
readList :: ReadS [Options]
$creadPrec :: ReadPrec Options
readPrec :: ReadPrec Options
$creadListPrec :: ReadPrec [Options]
readListPrec :: ReadPrec [Options]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107596"><span id="local-6989586621679107601"><span id="local-6989586621679107605"><span class="annot"><span class="annottext">Int -&gt; Options -&gt; ShowS
[Options] -&gt; ShowS
Options -&gt; String
(Int -&gt; Options -&gt; ShowS)
-&gt; (Options -&gt; String) -&gt; ([Options] -&gt; ShowS) -&gt; Show Options
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Options -&gt; ShowS
showsPrec :: Int -&gt; Options -&gt; ShowS
$cshow :: Options -&gt; String
show :: Options -&gt; String
$cshowList :: [Options] -&gt; ShowS
showList :: [Options] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | Conservative 'Options' that doesn't attempt to use @EmptyCase@ (to</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- prevent users from having to enable that extension at use sites.)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-type">defaultOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span>
</span><span id="line-87"></span><span id="defaultOptions"><span class="annot"><span class="annottext">defaultOptions :: Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var hs-var">defaultOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">emptyCaseBehavior :: Bool
</span><a href="Data.Bifunctor.TH.html#emptyCaseBehavior"><span class="hs-identifier hs-var">emptyCaseBehavior</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">{- $derive

'deriveBifunctor', 'deriveBifoldable', and 'deriveBitraversable' automatically
generate their respective class instances for a given data type, newtype, or data
family instance that has at least two type variable. Examples:

@
&amp;#123;-&amp;#35; LANGUAGE TemplateHaskell &amp;#35;-&amp;#125;
import Data.Bifunctor.TH

data Pair a b = Pair a b
$('deriveBifunctor' ''Pair) -- instance Bifunctor Pair where ...

data WrapLeftPair f g a b = WrapLeftPair (f a) (g a b)
$('deriveBifoldable' ''WrapLeftPair)
-- instance (Foldable f, Bifoldable g) =&gt; Bifoldable (WrapLeftPair f g) where ...
@

If you are using @template-haskell-2.7.0.0@ or later (i.e., GHC 7.4 or later),
the @derive@ functions can be used data family instances (which requires the
@-XTypeFamilies@ extension). To do so, pass the name of a data or newtype instance
constructor (NOT a data family name!) to a @derive@ function.  Note that the
generated code may require the @-XFlexibleInstances@ extension. Example:

@
&amp;#123;-&amp;#35; LANGUAGE FlexibleInstances, TemplateHaskell, TypeFamilies &amp;#35;-&amp;#125;
import Data.Bifunctor.TH

class AssocClass a b c where
    data AssocData a b c
instance AssocClass Int b c where
    data AssocData Int b c = AssocDataInt1 Int | AssocDataInt2 b c
$('deriveBitraversable' 'AssocDataInt1) -- instance Bitraversable (AssocData Int) where ...
-- Alternatively, one could use $(deriveBitraversable 'AssocDataInt2)
@

Note that there are some limitations:

* The 'Name' argument to a @derive@ function must not be a type synonym.

* With a @derive@ function, the last two type variables must both be of kind @*@.
  Other type variables of kind @* -&gt; *@ are assumed to require a 'Functor',
  'Foldable', or 'Traversable' constraint (depending on which @derive@ function is
  used), and other type variables of kind @* -&gt; * -&gt; *@ are assumed to require an
  'Bifunctor', 'Bifoldable', or 'Bitraversable' constraint. If your data type
  doesn't meet these assumptions, use a @make@ function.

* If using the @-XDatatypeContexts@, @-XExistentialQuantification@, or @-XGADTs@
  extensions, a constraint cannot mention either of the last two type variables. For
  example, @data Illegal2 a b where I2 :: Ord a =&gt; a -&gt; b -&gt; Illegal2 a b@ cannot
  have a derived 'Bifunctor' instance.

* If either of the last two type variables is used within a constructor argument's
  type, it must only be used in the last two type arguments. For example,
  @data Legal a b = Legal (Int, Int, a, b)@ can have a derived 'Bifunctor' instance,
  but @data Illegal a b = Illegal (a, b, a, b)@ cannot.

* Data family instances must be able to eta-reduce the last two type variables. In other
  words, if you have a instance of the form:

  @
  data family Family a1 ... an t1 t2
  data instance Family e1 ... e2 v1 v2 = ...
  @

  Then the following conditions must hold:

  1. @v1@ and @v2@ must be distinct type variables.
  2. Neither @v1@ not @v2@ must be mentioned in any of @e1@, ..., @e2@.

-}</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">{- $make

There may be scenarios in which you want to, say, 'bimap' over an arbitrary data type
or data family instance without having to make the type an instance of 'Bifunctor'. For
these cases, this module provides several functions (all prefixed with @make@-) that
splice the appropriate lambda expression into your source code.

This is particularly useful for creating instances for sophisticated data types. For
example, 'deriveBifunctor' cannot infer the correct type context for
@newtype HigherKinded f a b c = HigherKinded (f a b c)@, since @f@ is of kind
@* -&gt; * -&gt; * -&gt; *@. However, it is still possible to create a 'Bifunctor' instance for
@HigherKinded@ without too much trouble using 'makeBimap':

@
&amp;#123;-&amp;#35; LANGUAGE FlexibleContexts, TemplateHaskell &amp;#35;-&amp;#125;
import Data.Bifunctor
import Data.Bifunctor.TH

newtype HigherKinded f a b c = HigherKinded (f a b c)

instance Bifunctor (f a) =&gt; Bifunctor (HigherKinded f a) where
    bimap = $(makeBimap ''HigherKinded)
@

-}</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Generates a 'Bifunctor' instance declaration for the given data type or data</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- family instance.</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifunctor"><span class="hs-identifier hs-type">deriveBifunctor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span id="deriveBifunctor"><span class="annot"><span class="annottext">deriveBifunctor :: Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifunctor"><span class="hs-identifier hs-var hs-var">deriveBifunctor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifunctorOptions"><span class="hs-identifier hs-var">deriveBifunctorOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><span class="hs-comment">-- | Like 'deriveBifunctor', but takes an 'Options' argument.</span></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifunctorOptions"><span class="hs-identifier hs-type">deriveBifunctorOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span id="deriveBifunctorOptions"><span class="annot"><span class="annottext">deriveBifunctorOptions :: Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifunctorOptions"><span class="hs-identifier hs-var hs-var">deriveBifunctorOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBiClass"><span class="hs-identifier hs-var">deriveBiClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bimap' (without requiring a</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- 'Bifunctor' instance).</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimap"><span class="hs-identifier hs-type">makeBimap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-199"></span><span id="makeBimap"><span class="annot"><span class="annottext">makeBimap :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimap"><span class="hs-identifier hs-var hs-var">makeBimap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapOptions"><span class="hs-identifier hs-var">makeBimapOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBimap', but takes an 'Options' argument.</span></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapOptions"><span class="hs-identifier hs-type">makeBimapOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-203"></span><span id="makeBimapOptions"><span class="annot"><span class="annottext">makeBimapOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapOptions"><span class="hs-identifier hs-var hs-var">makeBimapOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-var">makeBiFun</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Generates a 'Bifoldable' instance declaration for the given data type or data</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- family instance.</span><span>
</span><span id="line-207"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifoldable"><span class="hs-identifier hs-type">deriveBifoldable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span id="deriveBifoldable"><span class="annot"><span class="annottext">deriveBifoldable :: Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifoldable"><span class="hs-identifier hs-var hs-var">deriveBifoldable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifoldableOptions"><span class="hs-identifier hs-var">deriveBifoldableOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><span class="hs-comment">-- | Like 'deriveBifoldable', but takes an 'Options' argument.</span></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBifoldableOptions"><span class="hs-identifier hs-type">deriveBifoldableOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span id="deriveBifoldableOptions"><span class="annot"><span class="annottext">deriveBifoldableOptions :: Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBifoldableOptions"><span class="hs-identifier hs-var hs-var">deriveBifoldableOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBiClass"><span class="hs-identifier hs-var">deriveBiClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">--- | Generates a lambda expression which behaves like 'bifold' (without requiring a</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- 'Bifoldable' instance).</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifold"><span class="hs-identifier hs-type">makeBifold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-217"></span><span id="makeBifold"><span class="annot"><span class="annottext">makeBifold :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifold"><span class="hs-identifier hs-var hs-var">makeBifold</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldOptions"><span class="hs-identifier hs-var">makeBifoldOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBifold', but takes an 'Options' argument.</span></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldOptions"><span class="hs-identifier hs-type">makeBifoldOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-221"></span><span id="makeBifoldOptions"><span class="annot"><span class="annottext">makeBifoldOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldOptions"><span class="hs-identifier hs-var hs-var">makeBifoldOptions</span></a></span></span><span> </span><span id="local-6989586621679107612"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107612"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107613"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107613"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier hs-var">makeBifoldMapOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107612"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107613"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-222"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-223"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-224"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bifoldMap' (without requiring</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- a 'Bifoldable' instance).</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldMap"><span class="hs-identifier hs-type">makeBifoldMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-229"></span><span id="makeBifoldMap"><span class="annot"><span class="annottext">makeBifoldMap :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldMap"><span class="hs-identifier hs-var hs-var">makeBifoldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier hs-var">makeBifoldMapOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBifoldMap', but takes an 'Options' argument.</span></span><span>
</span><span id="line-232"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier hs-type">makeBifoldMapOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-233"></span><span id="makeBifoldMapOptions"><span class="annot"><span class="annottext">makeBifoldMapOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier hs-var hs-var">makeBifoldMapOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-var">makeBiFun</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bifoldr' (without requiring a</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- 'Bifoldable' instance).</span><span>
</span><span id="line-237"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldr"><span class="hs-identifier hs-type">makeBifoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-238"></span><span id="makeBifoldr"><span class="annot"><span class="annottext">makeBifoldr :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldr"><span class="hs-identifier hs-var hs-var">makeBifoldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldrOptions"><span class="hs-identifier hs-var">makeBifoldrOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBifoldr', but takes an 'Options' argument.</span></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldrOptions"><span class="hs-identifier hs-type">makeBifoldrOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-242"></span><span id="makeBifoldrOptions"><span class="annot"><span class="annottext">makeBifoldrOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldrOptions"><span class="hs-identifier hs-var hs-var">makeBifoldrOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-var">makeBiFun</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bifoldl' (without requiring a</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- 'Bifoldable' instance).</span><span>
</span><span id="line-246"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldl"><span class="hs-identifier hs-type">makeBifoldl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-247"></span><span id="makeBifoldl"><span class="annot"><span class="annottext">makeBifoldl :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldl"><span class="hs-identifier hs-var hs-var">makeBifoldl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldlOptions"><span class="hs-identifier hs-var">makeBifoldlOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBifoldl', but takes an 'Options' argument.</span></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldlOptions"><span class="hs-identifier hs-type">makeBifoldlOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-251"></span><span id="makeBifoldlOptions"><span class="annot"><span class="annottext">makeBifoldlOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldlOptions"><span class="hs-identifier hs-var hs-var">makeBifoldlOptions</span></a></span></span><span> </span><span id="local-6989586621679107618"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107618"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107619"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107619"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679107620"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107620"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679107621"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107621"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;g&quot;</span></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679107622"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107622"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;z&quot;</span></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679107623"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107623"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;t&quot;</span></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107620"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107621"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107622"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107623"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#appEndoValName"><span class="hs-identifier hs-var">appEndoValName</span></a></span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#getDualValName"><span class="hs-identifier hs-var">getDualValName</span></a></span><span>
</span><span id="line-259"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapOptions"><span class="hs-identifier hs-var">makeBifoldMapOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107618"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107619"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-260"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
</span><a href="#local-6989586621679107626"><span class="hs-identifier hs-var">foldFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107620"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-261"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
</span><a href="#local-6989586621679107626"><span class="hs-identifier hs-var">foldFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107621"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-262"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107623"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107622"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="#local-6989586621679107626"><span class="hs-identifier hs-type">foldFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679107626"><span class="annot"><span class="annottext">foldFun :: Name -&gt; Q Exp
</span><a href="#local-6989586621679107626"><span class="hs-identifier hs-var hs-var">foldFun</span></a></span></span><span> </span><span id="local-6989586621679107627"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107627"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">infixApp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#dualDataName"><span class="hs-identifier hs-var">dualDataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">infixApp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#endoDataName"><span class="hs-identifier hs-var">endoDataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#flipValName"><span class="hs-identifier hs-var">flipValName</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107627"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>                         </span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Generates a 'Bitraversable' instance declaration for the given data type or data</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- family instance.</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBitraversable"><span class="hs-identifier hs-type">deriveBitraversable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span id="deriveBitraversable"><span class="annot"><span class="annottext">deriveBitraversable :: Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBitraversable"><span class="hs-identifier hs-var hs-var">deriveBitraversable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBitraversableOptions"><span class="hs-identifier hs-var">deriveBitraversableOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><span class="hs-comment">-- | Like 'deriveBitraversable', but takes an 'Options' argument.</span></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBitraversableOptions"><span class="hs-identifier hs-type">deriveBitraversableOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-282"></span><span id="deriveBitraversableOptions"><span class="annot"><span class="annottext">deriveBitraversableOptions :: Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBitraversableOptions"><span class="hs-identifier hs-var hs-var">deriveBitraversableOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBiClass"><span class="hs-identifier hs-var">deriveBiClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bitraverse' (without</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- requiring a 'Bitraversable' instance).</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBitraverse"><span class="hs-identifier hs-type">makeBitraverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-287"></span><span id="makeBitraverse"><span class="annot"><span class="annottext">makeBitraverse :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBitraverse"><span class="hs-identifier hs-var hs-var">makeBitraverse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier hs-var">makeBitraverseOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBitraverse', but takes an 'Options' argument.</span></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier hs-type">makeBitraverseOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-291"></span><span id="makeBitraverseOptions"><span class="annot"><span class="annottext">makeBitraverseOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier hs-var hs-var">makeBitraverseOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-var">makeBiFun</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bisequenceA' (without</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- requiring a 'Bitraversable' instance).</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceA"><span class="hs-identifier hs-type">makeBisequenceA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-296"></span><span id="makeBisequenceA"><span class="annot"><span class="annottext">makeBisequenceA :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequenceA"><span class="hs-identifier hs-var hs-var">makeBisequenceA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequenceAOptions"><span class="hs-identifier hs-var">makeBisequenceAOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBitraverseA', but takes an 'Options' argument.</span></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceAOptions"><span class="hs-identifier hs-type">makeBisequenceAOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-300"></span><span id="makeBisequenceAOptions"><span class="annot"><span class="annottext">makeBisequenceAOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequenceAOptions"><span class="hs-identifier hs-var hs-var">makeBisequenceAOptions</span></a></span></span><span> </span><span id="local-6989586621679107633"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107633"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107634"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107634"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier hs-var">makeBitraverseOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107633"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107634"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-301"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-302"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-303"></span><span>                                         </span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bimapM' (without</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- requiring a 'Bitraversable' instance).</span><span>
</span><span id="line-307"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapM"><span class="hs-identifier hs-type">makeBimapM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-308"></span><span id="makeBimapM"><span class="annot"><span class="annottext">makeBimapM :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapM"><span class="hs-identifier hs-var hs-var">makeBimapM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapMOptions"><span class="hs-identifier hs-var">makeBimapMOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBimapM', but takes an 'Options' argument.</span></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapMOptions"><span class="hs-identifier hs-type">makeBimapMOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-312"></span><span id="makeBimapMOptions"><span class="annot"><span class="annottext">makeBimapMOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapMOptions"><span class="hs-identifier hs-var hs-var">makeBimapMOptions</span></a></span></span><span> </span><span id="local-6989586621679107635"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107635"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107636"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107636"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679107637"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107637"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621679107638"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107638"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;g&quot;</span></span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107637"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107638"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; (Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">infixApp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#unwrapMonadValName"><span class="hs-identifier hs-var">unwrapMonadValName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-316"></span><span>                          </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBitraverseOptions"><span class="hs-identifier hs-var">makeBitraverseOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107635"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107636"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-317"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
</span><a href="#local-6989586621679107641"><span class="hs-identifier hs-var">wrapMonadExp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107637"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-318"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
</span><a href="#local-6989586621679107641"><span class="hs-identifier hs-var">wrapMonadExp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107638"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-319"></span><span>                                </span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="#local-6989586621679107641"><span class="hs-identifier hs-type">wrapMonadExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679107641"><span class="annot"><span class="annottext">wrapMonadExp :: Name -&gt; Q Exp
</span><a href="#local-6989586621679107641"><span class="hs-identifier hs-var hs-var">wrapMonadExp</span></a></span></span><span> </span><span id="local-6989586621679107642"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107642"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">infixApp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#wrapMonadDataName"><span class="hs-identifier hs-var">wrapMonadDataName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#composeValName"><span class="hs-identifier hs-var">composeValName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107642"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Generates a lambda expression which behaves like 'bisequence' (without</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- requiring a 'Bitraversable' instance).</span><span>
</span><span id="line-326"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequence"><span class="hs-identifier hs-type">makeBisequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-327"></span><span id="makeBisequence"><span class="annot"><span class="annottext">makeBisequence :: Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequence"><span class="hs-identifier hs-var hs-var">makeBisequence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequenceOptions"><span class="hs-identifier hs-var">makeBisequenceOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="Data.Bifunctor.TH.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><span class="hs-comment">-- | Like 'makeBisequence', but takes an 'Options' argument.</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBisequenceOptions"><span class="hs-identifier hs-type">makeBisequenceOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-331"></span><span id="makeBisequenceOptions"><span class="annot"><span class="annottext">makeBisequenceOptions :: Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBisequenceOptions"><span class="hs-identifier hs-var hs-var">makeBisequenceOptions</span></a></span></span><span> </span><span id="local-6989586621679107644"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107644"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107645"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107645"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBimapMOptions"><span class="hs-identifier hs-var">makeBimapMOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107644"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107645"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-332"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-333"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#idValName"><span class="hs-identifier hs-var">idValName</span></a></span><span>
</span><span id="line-334"></span><span>                                        </span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- Code generation</span><span>
</span><span id="line-338"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><span class="hs-comment">-- | Derive a class instance declaration (depending on the BiClass argument's value).</span></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveBiClass"><span class="hs-identifier hs-type">deriveBiClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span id="deriveBiClass"><span class="annot"><span class="annottext">deriveBiClass :: BiClass -&gt; Options -&gt; Name -&gt; Q [Dec]
</span><a href="Data.Bifunctor.TH.html#deriveBiClass"><span class="hs-identifier hs-var hs-var">deriveBiClass</span></a></span></span><span> </span><span id="local-6989586621679107646"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107646"><span class="hs-identifier hs-var">biClass</span></a></span></span><span> </span><span id="local-6989586621679107647"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107647"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107648"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107648"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679107649"><span class="annot"><span class="annottext">DatatypeInfo
</span><a href="#local-6989586621679107649"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q DatatypeInfo
</span><span class="hs-identifier hs-var">reifyDatatype</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107648"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DatatypeInfo
</span><a href="#local-6989586621679107649"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">DatatypeInfo</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">datatypeContext :: DatatypeInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">datatypeContext</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107653"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107653"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-346"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeName :: DatatypeInfo -&gt; Name
</span><span class="hs-identifier hs-var">datatypeName</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107655"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107655"><span class="hs-identifier hs-var">parentName</span></a></span></span><span>
</span><span id="line-347"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeInstTypes :: DatatypeInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">datatypeInstTypes</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107657"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107657"><span class="hs-identifier hs-var">instTys</span></a></span></span><span>
</span><span id="line-348"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeVariant :: DatatypeInfo -&gt; DatatypeVariant
</span><span class="hs-identifier hs-var">datatypeVariant</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107659"><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107659"><span class="hs-identifier hs-var">variant</span></a></span></span><span>
</span><span id="line-349"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeCons :: DatatypeInfo -&gt; [ConstructorInfo]
</span><span class="hs-identifier hs-var">datatypeCons</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107661"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107661"><span class="hs-identifier hs-var">cons</span></a></span></span><span>
</span><span id="line-350"></span><span>                 </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679107662"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107662"><span class="hs-identifier hs-var">instanceCxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107663"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var">instanceType</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BiClass
-&gt; Name -&gt; [Type] -&gt; [Type] -&gt; DatatypeVariant -&gt; Q ([Type], Type)
</span><a href="Data.Bifunctor.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107646"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107655"><span class="hs-identifier hs-var">parentName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107653"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107657"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107659"><span class="hs-identifier hs-var">variant</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; [Dec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; [Dec]) -&gt; Q Dec -&gt; Q [Dec]
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">Q [Type] -&gt; Q Type -&gt; [Q Dec] -&gt; Q Dec
forall (m :: * -&gt; *).
Quote m =&gt;
m [Type] -&gt; m Type -&gt; [m Dec] -&gt; m Dec
</span><span class="hs-identifier hs-var">instanceD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Q [Type]
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107662"><span class="hs-identifier hs-var">instanceCxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Q Type
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107663"><span class="hs-identifier hs-var">instanceType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiClass
-&gt; Options -&gt; Name -&gt; [Type] -&gt; [ConstructorInfo] -&gt; [Q Dec]
</span><a href="Data.Bifunctor.TH.html#biFunDecs"><span class="hs-identifier hs-var">biFunDecs</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107646"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107647"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107655"><span class="hs-identifier hs-var">parentName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107657"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107661"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Generates a declaration defining the primary function(s) corresponding to a</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- particular class (bimap for Bifunctor, bifoldr and bifoldMap for Bifoldable, and</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- bitraverse for Bitraversable).</span><span>
</span><span id="line-360"></span><span class="hs-comment">--</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- For why both bifoldr and bifoldMap are derived for Bifoldable, see Trac #7436.</span><span>
</span><span id="line-362"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunDecs"><span class="hs-identifier hs-type">biFunDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span id="biFunDecs"><span class="annot"><span class="annottext">biFunDecs :: BiClass
-&gt; Options -&gt; Name -&gt; [Type] -&gt; [ConstructorInfo] -&gt; [Q Dec]
</span><a href="Data.Bifunctor.TH.html#biFunDecs"><span class="hs-identifier hs-var hs-var">biFunDecs</span></a></span></span><span> </span><span id="local-6989586621679107667"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107667"><span class="hs-identifier hs-var">biClass</span></a></span></span><span> </span><span id="local-6989586621679107668"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107668"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107669"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107669"><span class="hs-identifier hs-var">parentName</span></a></span></span><span> </span><span id="local-6989586621679107670"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107670"><span class="hs-identifier hs-var">instTys</span></a></span></span><span> </span><span id="local-6989586621679107671"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107671"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">(BiFun -&gt; Q Dec) -&gt; [BiFun] -&gt; [Q Dec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Q Dec
</span><a href="#local-6989586621679107672"><span class="hs-identifier hs-var">makeFunD</span></a></span><span> </span><span class="annot"><span class="annottext">([BiFun] -&gt; [Q Dec]) -&gt; [BiFun] -&gt; [Q Dec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; [BiFun]
</span><a href="Data.Bifunctor.TH.html#biClassToFuns"><span class="hs-identifier hs-var">biClassToFuns</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107667"><span class="hs-identifier hs-var">biClass</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="#local-6989586621679107672"><span class="hs-identifier hs-type">makeFunD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679107672"><span class="annot"><span class="annottext">makeFunD :: BiFun -&gt; Q Dec
</span><a href="#local-6989586621679107672"><span class="hs-identifier hs-var hs-var">makeFunD</span></a></span></span><span> </span><span id="local-6989586621679107674"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; [Q Clause] -&gt; Q Dec
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; [m Clause] -&gt; m Dec
</span><span class="hs-identifier hs-var">funD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var">biFunName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">biFun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Body -&gt; [Q Dec] -&gt; Q Clause
forall (m :: * -&gt; *).
Quote m =&gt;
[m Pat] -&gt; m Body -&gt; [m Dec] -&gt; m Clause
</span><span class="hs-identifier hs-var">clause</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp -&gt; Q Body
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Body
</span><span class="hs-identifier hs-var">normalB</span></span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Body) -&gt; Q Exp -&gt; Q Body
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; [Type] -&gt; [ConstructorInfo] -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFunForCons"><span class="hs-identifier hs-var">makeBiFunForCons</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107674"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107668"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107669"><span class="hs-identifier hs-var">parentName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107670"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107671"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">-- | Generates a lambda expression which behaves like the BiFun argument.</span></span><span>
</span><span id="line-375"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-type">makeBiFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-376"></span><span id="makeBiFun"><span class="annot"><span class="annottext">makeBiFun :: BiFun -&gt; Options -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFun"><span class="hs-identifier hs-var hs-var">makeBiFun</span></a></span></span><span> </span><span id="local-6989586621679107677"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679107678"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107679"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107679"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679107680"><span class="annot"><span class="annottext">DatatypeInfo
</span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q DatatypeInfo
</span><span class="hs-identifier hs-var">reifyDatatype</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107679"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DatatypeInfo
</span><a href="#local-6989586621679107680"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">DatatypeInfo</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">datatypeContext :: DatatypeInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">datatypeContext</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107681"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107681"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span>
</span><span id="line-380"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeName :: DatatypeInfo -&gt; Name
</span><span class="hs-identifier hs-var">datatypeName</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107682"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">parentName</span></a></span></span><span>
</span><span id="line-381"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeInstTypes :: DatatypeInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">datatypeInstTypes</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107683"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">instTys</span></a></span></span><span>
</span><span id="line-382"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeVariant :: DatatypeInfo -&gt; DatatypeVariant
</span><span class="hs-identifier hs-var">datatypeVariant</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107684"><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107684"><span class="hs-identifier hs-var">variant</span></a></span></span><span>
</span><span id="line-383"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">datatypeCons :: DatatypeInfo -&gt; [ConstructorInfo]
</span><span class="hs-identifier hs-var">datatypeCons</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107685"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107685"><span class="hs-identifier hs-var">cons</span></a></span></span><span>
</span><span id="line-384"></span><span>                 </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>      </span><span class="hs-comment">-- We force buildTypeInstance here since it performs some checks for whether</span><span>
</span><span id="line-386"></span><span>      </span><span class="hs-comment">-- or not the provided datatype can actually have bimap/bifoldr/bitraverse/etc.</span><span>
</span><span id="line-387"></span><span>      </span><span class="hs-comment">-- implemented for it, and produces errors if it can't.</span><span>
</span><span id="line-388"></span><span>      </span><span class="annot"><span class="annottext">BiClass
-&gt; Name -&gt; [Type] -&gt; [Type] -&gt; DatatypeVariant -&gt; Q ([Type], Type)
</span><a href="Data.Bifunctor.TH.html#buildTypeInstance"><span class="hs-identifier hs-var">buildTypeInstance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun -&gt; BiClass
</span><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var">biFunToClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">biFun</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">parentName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107681"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107684"><span class="hs-identifier hs-var">variant</span></a></span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><span class="annottext">Q ([Type], Type) -&gt; Q Exp -&gt; Q Exp
forall a b. Q a -&gt; Q b -&gt; Q b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Options -&gt; Name -&gt; [Type] -&gt; [ConstructorInfo] -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFunForCons"><span class="hs-identifier hs-var">makeBiFunForCons</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107677"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107678"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107682"><span class="hs-identifier hs-var">parentName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107683"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107685"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Generates a lambda expression for the given constructors.</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- All constructors must be from the same type.</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBiFunForCons"><span class="hs-identifier hs-type">makeBiFunForCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#Options"><span class="hs-identifier hs-type">Options</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-394"></span><span id="makeBiFunForCons"><span class="annot"><span class="annottext">makeBiFunForCons :: BiFun -&gt; Options -&gt; Name -&gt; [Type] -&gt; [ConstructorInfo] -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#makeBiFunForCons"><span class="hs-identifier hs-var hs-var">makeBiFunForCons</span></a></span></span><span> </span><span id="local-6989586621679107687"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679107688"><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679107689"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107689"><span class="hs-identifier hs-var">_parentName</span></a></span></span><span> </span><span id="local-6989586621679107690"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">instTys</span></a></span></span><span> </span><span id="local-6989586621679107691"><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679107692"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var">map1</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679107693"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">map2</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;g&quot;</span></span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679107694"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var">z</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;z&quot;</span></span><span> </span><span class="hs-comment">-- Only used for deriving bifoldr</span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621679107695"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679107702"><span class="annot"><span class="annottext">argNames :: [Name]
</span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var hs-var">argNames</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; [Name]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var">map1</span></a></span><span>
</span><span id="line-400"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">map2</span></a></span><span>
</span><span id="line-401"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; BiFun -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Maybe Name -&gt; Maybe Name
forall a b. Maybe a -&gt; Maybe b -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-402"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-403"></span><span>                             </span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>      </span><span id="local-6989586621679107707"><span class="annot"><span class="annottext">lastTyVars :: [Name]
</span><a href="#local-6989586621679107707"><span class="hs-identifier hs-var hs-var">lastTyVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Name) -&gt; [Type] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Data.Bifunctor.TH.Internal.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; [Name]) -&gt; [Type] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">instTys</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107690"><span class="hs-identifier hs-var">instTys</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span id="local-6989586621679107712"><span class="annot"><span class="annottext">tvMap :: Map Name Name
</span><a href="#local-6989586621679107712"><span class="hs-identifier hs-var hs-var">tvMap</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Name)] -&gt; Map Name Name
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Name)] -&gt; Map Name Name)
-&gt; [(Name, Name)] -&gt; Map Name Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [(Name, Name)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107707"><span class="hs-identifier hs-var">lastTyVars</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107692"><span class="hs-identifier hs-var">map1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107693"><span class="hs-identifier hs-var">map2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Pat) -&gt; [Name] -&gt; [Q Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var">argNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; ([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><span class="annottext">([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Q Exp) -&gt; Name -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-var">biFunConstName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Map Name Name -&gt; Q Exp
</span><a href="#local-6989586621679107714"><span class="hs-identifier hs-var">makeFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107694"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107695"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107712"><span class="hs-identifier hs-var">tvMap</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; [Q Exp] -&gt; [Q Exp]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Q Exp) -&gt; [Name] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107702"><span class="hs-identifier hs-var">argNames</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="#local-6989586621679107714"><span class="hs-identifier hs-type">makeFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679107714"><span class="annot"><span class="annottext">makeFun :: Name -&gt; Name -&gt; Map Name Name -&gt; Q Exp
</span><a href="#local-6989586621679107714"><span class="hs-identifier hs-var hs-var">makeFun</span></a></span></span><span> </span><span id="local-6989586621679107716"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679107717"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679107718"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107718"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679107719"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679107719"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q [Role]
</span><span class="hs-identifier hs-var">reifyRoles</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107689"><span class="hs-identifier hs-var">_parentName</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679107721"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier hs-var">PhantomR</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Role] -&gt; Maybe ([Role], Role)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Data.Bifunctor.TH.Internal.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679107719"><span class="hs-identifier hs-var">roles</span></a></span><span>
</span><span id="line-417"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Role]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">Role
</span><span class="hs-identifier hs-var">PhantomR</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Role] -&gt; Maybe ([Role], Role)
forall a. [a] -&gt; Maybe ([a], a)
</span><a href="Data.Bifunctor.TH.Internal.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679107721"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-418"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Q Exp
</span><a href="#local-6989586621679107724"><span class="hs-identifier hs-var">biFunPhantom</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Options -&gt; Bool
</span><a href="Data.Bifunctor.TH.html#emptyCaseBehavior"><span class="hs-identifier hs-var">emptyCaseBehavior</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="#local-6989586621679107688"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-421"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Name -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunEmptyCase"><span class="hs-identifier hs-var">biFunEmptyCase</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-424"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Name -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunNoCons"><span class="hs-identifier hs-var">biFunNoCons</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-427"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Match] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; [m Match] -&gt; m Exp
</span><span class="hs-identifier hs-var">caseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107717"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConstructorInfo -&gt; Q Match) -&gt; [ConstructorInfo] -&gt; [Q Match]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun -&gt; Name -&gt; Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBiFunForCon"><span class="hs-identifier hs-var">makeBiFunForCon</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107716"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107718"><span class="hs-identifier hs-var">tvMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConstructorInfo]
</span><a href="#local-6989586621679107691"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><a href="#local-6989586621679107724"><span class="hs-identifier hs-type">biFunPhantom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679107724"><span class="annot"><span class="annottext">biFunPhantom :: Name -&gt; Name -&gt; Q Exp
</span><a href="#local-6989586621679107724"><span class="hs-identifier hs-var hs-var">biFunPhantom</span></a></span></span><span> </span><span id="local-6989586621679107730"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107730"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679107731"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107731"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; BiFun -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunTrivial"><span class="hs-identifier hs-var">biFunTrivial</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var">coerce</span></a></span><span>
</span><span id="line-433"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#pureValName"><span class="hs-identifier hs-var">pureValName</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>                     </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107687"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107730"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><a href="#local-6989586621679107733"><span class="hs-identifier hs-type">coerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-437"></span><span>        </span><span id="local-6989586621679107733"><span class="annot"><span class="annottext">coerce :: Q Exp
</span><a href="#local-6989586621679107733"><span class="hs-identifier hs-var hs-var">coerce</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#coerceValName"><span class="hs-identifier hs-var">coerceValName</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107731"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><span class="hs-comment">-- | Generates a match for a single constructor.</span></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBiFunForCon"><span class="hs-identifier hs-type">makeBiFunForCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-441"></span><span id="makeBiFunForCon"><span class="annot"><span class="annottext">makeBiFunForCon :: BiFun -&gt; Name -&gt; Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBiFunForCon"><span class="hs-identifier hs-var hs-var">makeBiFunForCon</span></a></span></span><span> </span><span id="local-6989586621679107736"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679107737"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107737"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679107738"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679107739"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107742"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107742"><span class="hs-identifier hs-var">conName</span></a></span></span><span>
</span><span id="line-443"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constructorContext :: ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorContext</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107744"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107744"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Name] -&gt; Bool
</span><a href="Data.Bifunctor.TH.Internal.html#predMentionsName"><span class="hs-operator hs-var">`predMentionsName`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; [Name]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107744"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-445"></span><span>             </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>             </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiClass -&gt; Bool
</span><a href="Data.Bifunctor.TH.html#allowExQuant"><span class="hs-identifier hs-var">allowExQuant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun -&gt; BiClass
</span><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var">biFunToClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">biFun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q () -&gt; Q ()) -&gt; Q () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-447"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Q ()
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#existentialContextError"><span class="hs-identifier hs-var">existentialContextError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107742"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679107736"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBimapMatch"><span class="hs-identifier hs-var">makeBimapMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBifoldrMatch"><span class="hs-identifier hs-var">makeBifoldrMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107737"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapMatch"><span class="hs-identifier hs-var">makeBifoldMapMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBitraverseMatch"><span class="hs-identifier hs-var">makeBitraverseMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107738"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107739"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><span class="hs-comment">-- | Generates a match whose right-hand side implements @bimap@.</span></span><span>
</span><span id="line-455"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBimapMatch"><span class="hs-identifier hs-type">makeBimapMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-456"></span><span id="makeBimapMatch"><span class="annot"><span class="annottext">makeBimapMatch :: Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBimapMatch"><span class="hs-identifier hs-var hs-var">makeBimapMatch</span></a></span></span><span> </span><span id="local-6989586621679107756"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107756"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span id="local-6989586621679107757"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679107757"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107758"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679107759"><span class="annot"><span class="annottext">[Exp -&gt; Q Exp]
</span><a href="#local-6989586621679107759"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Name Name
-&gt; FFoldType (Exp -&gt; Q Exp) -&gt; ConstructorInfo -&gt; Q [Exp -&gt; Q Exp]
forall a. Map Name Name -&gt; FFoldType a -&gt; ConstructorInfo -&gt; Q [a]
</span><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107756"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">FFoldType (Exp -&gt; Q Exp)
</span><a href="#local-6989586621679107761"><span class="hs-identifier hs-var">ft_bimap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107757"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp -&gt; Q Exp]
</span><a href="#local-6989586621679107759"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><a href="#local-6989586621679107761"><span class="hs-identifier hs-type">ft_bimap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621679107761"><span class="annot"><span class="annottext">ft_bimap :: FFoldType (Exp -&gt; Q Exp)
</span><a href="#local-6989586621679107761"><span class="hs-identifier hs-var hs-var">ft_bimap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_triv :: Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-462"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_var :: Name -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107766"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107766"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679107767"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107767"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107756"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; Name -&gt; Name
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107766"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107767"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-463"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_fun :: (Exp -&gt; Q Exp) -&gt; (Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107771"><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107771"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679107772"><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107772"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679107773"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107773"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107775"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107775"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-464"></span><span>                      </span><span id="local-6989586621679107776"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107776"><span class="hs-identifier hs-var">gg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107771"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107775"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-465"></span><span>                      </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107772"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107773"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107776"><span class="hs-identifier hs-var">gg</span></a></span><span>
</span><span id="line-466"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: TupleSort -&gt; [Exp -&gt; Q Exp] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match)
-&gt; TupleSort -&gt; [Exp -&gt; Q Exp] -&gt; Exp -&gt; Q Exp
forall a.
(Name -&gt; [a] -&gt; Q Match) -&gt; TupleSort -&gt; [a] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var">match_for_con</span></a></span><span>
</span><span id="line-467"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_ty_app :: [(Type, Exp -&gt; Q Exp)] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107780"><span class="annot"><span class="annottext">[(Type, Exp -&gt; Q Exp)]
</span><a href="#local-6989586621679107780"><span class="hs-identifier hs-var">argGs</span></a></span></span><span> </span><span id="local-6989586621679107781"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107781"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679107782"><span class="hs-identifier hs-type">inspect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-469"></span><span>                          </span><span id="local-6989586621679107782"><span class="annot"><span class="annottext">inspect :: (Type, Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="#local-6989586621679107782"><span class="hs-identifier hs-var hs-var">inspect</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679107783"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107783"><span class="hs-identifier hs-var">argTy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107784"><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107784"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>                            </span><span class="hs-comment">-- If the argument type is a bare occurrence of one</span><span>
</span><span id="line-471"></span><span>                            </span><span class="hs-comment">-- of the data type's last type variables, then we</span><span>
</span><span id="line-472"></span><span>                            </span><span class="hs-comment">-- can generate more efficient code.</span><span>
</span><span id="line-473"></span><span>                            </span><span class="hs-comment">-- This was inspired by GHC#17880.</span><span>
</span><span id="line-474"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107785"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107785"><span class="hs-identifier hs-var">argVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Name
</span><a href="Data.Bifunctor.TH.Internal.html#varTToName_maybe"><span class="hs-identifier hs-var">varTToName_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107783"><span class="hs-identifier hs-var">argTy</span></a></span><span>
</span><span id="line-475"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107787"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Maybe Name
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107785"><span class="hs-identifier hs-var">argVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107756"><span class="hs-identifier hs-var">tvMap</span></a></span><span>
</span><span id="line-476"></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107787"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-477"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-478"></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107784"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-479"></span><span>                      </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="annot"><span class="annottext">([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#fmapArity"><span class="hs-identifier hs-var">fmapArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Type, Exp -&gt; Q Exp)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Type, Exp -&gt; Q Exp)]
</span><a href="#local-6989586621679107780"><span class="hs-identifier hs-var">argGs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>                            </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Type, Exp -&gt; Q Exp) -&gt; Q Exp)
-&gt; [(Type, Exp -&gt; Q Exp)] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Type, Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="#local-6989586621679107782"><span class="hs-identifier hs-var">inspect</span></a></span><span> </span><span class="annot"><span class="annottext">[(Type, Exp -&gt; Q Exp)]
</span><a href="#local-6989586621679107780"><span class="hs-identifier hs-var">argGs</span></a></span><span>
</span><span id="line-481"></span><span>                           </span><span class="annot"><span class="annottext">[Q Exp] -&gt; [Q Exp] -&gt; [Q Exp]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107781"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: [TyVarBndrSpec] -&gt; (Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107790"><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679107791"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679107790"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107791"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-483"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-484"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: Name -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-var">contravarianceError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107758"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-485"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- Con a1 a2 ... -&gt; Con (f1 a1) (f2 a2) ...</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><a href="#local-6989586621679107762"><span class="hs-identifier hs-type">match_for_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679107762"><span class="annot"><span class="annottext">match_for_con :: Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match
</span><a href="#local-6989586621679107762"><span class="hs-identifier hs-var hs-var">match_for_con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Q Exp] -&gt; Q Exp) -&gt; Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match
forall a. (Name -&gt; [a] -&gt; Q Exp) -&gt; Name -&gt; [Exp -&gt; a] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch"><span class="hs-identifier hs-var">mkSimpleConMatch</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; [Q Exp] -&gt; Q Exp) -&gt; Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match)
-&gt; (Name -&gt; [Q Exp] -&gt; Q Exp) -&gt; Name -&gt; [Exp -&gt; Q Exp] -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107797"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107797"><span class="hs-identifier hs-var">conName'</span></a></span></span><span> </span><span id="local-6989586621679107798"><span class="annot"><span class="annottext">[Q Exp]
</span><a href="#local-6989586621679107798"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-490"></span><span>       </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107797"><span class="hs-identifier hs-var">conName'</span></a></span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Q Exp]
</span><a href="#local-6989586621679107798"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Con x1 x2 ..</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="annot"><span class="hs-comment">-- | Generates a match whose right-hand side implements @bifoldr@.</span></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldrMatch"><span class="hs-identifier hs-type">makeBifoldrMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-494"></span><span id="makeBifoldrMatch"><span class="annot"><span class="annottext">makeBifoldrMatch :: Name -&gt; Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBifoldrMatch"><span class="hs-identifier hs-var hs-var">makeBifoldrMatch</span></a></span></span><span> </span><span id="local-6989586621679107799"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107799"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679107800"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107800"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span id="local-6989586621679107801"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679107801"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107802"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-495"></span><span>  </span><span id="local-6989586621679107803"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107803"><span class="hs-identifier hs-var">parts</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Name Name
-&gt; FFoldType (Q (Bool, Exp))
-&gt; ConstructorInfo
-&gt; Q [Q (Bool, Exp)]
forall a. Map Name Name -&gt; FFoldType a -&gt; ConstructorInfo -&gt; Q [a]
</span><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107800"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107804"><span class="hs-identifier hs-var">ft_bifoldr</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107801"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621679107805"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107805"><span class="hs-identifier hs-var">parts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107803"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107807"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107799"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107805"><span class="hs-identifier hs-var">parts'</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-comment">-- The Bool is True if the type mentions of the last two type parameters,</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-comment">-- False otherwise. Later, match_for_con uses mkSimpleConMatch2 to filter</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-comment">-- out expressions that do not mention the last parameters by checking for</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-comment">-- False.</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="#local-6989586621679107804"><span class="hs-identifier hs-type">ft_bifoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621679107804"><span class="annot"><span class="annottext">ft_bifoldr :: FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107804"><span class="hs-identifier hs-var hs-var">ft_bifoldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [ft_triv for Bifoldable and Bitraversable]</span><span>
</span><span id="line-505"></span><span>                      </span><span class="annot"><span class="annottext">ft_triv :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679107808"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107808"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107810"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107810"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107810"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-506"></span><span>                                   </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107808"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107811"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107811"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107800"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; Name -&gt; Name
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107811"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: TupleSort -&gt; [Q (Bool, Exp)] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107812"><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107812"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679107813"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107813"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>                        </span><span id="local-6989586621679107814"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107814"><span class="hs-identifier hs-var">gg</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107813"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-510"></span><span>                        </span><span id="local-6989586621679107815"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107815"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107816"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107816"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679107817"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107817"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>                          </span><span class="annot"><span class="annottext">(Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; TupleSort -&gt; [(Bool, Exp)] -&gt; Exp -&gt; Q Exp
forall a.
(Name -&gt; [a] -&gt; Q Match) -&gt; TupleSort -&gt; [a] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107807"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107817"><span class="hs-identifier hs-var">z'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107812"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107814"><span class="hs-identifier hs-var">gg</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107816"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-512"></span><span>                        </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107815"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_ty_app :: [(Type, Q (Bool, Exp))] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107818"><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107818"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>                        </span><span id="local-6989586621679107819"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107819"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam2"><span class="hs-identifier hs-var">mkSimpleLam2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107820"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107820"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679107821"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107821"><span class="hs-identifier hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-515"></span><span>                                 </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="annot"><span class="annottext">([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#foldrArity"><span class="hs-identifier hs-var">foldrArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107818"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>                                       </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Type, Q (Bool, Exp)) -&gt; Q Exp)
-&gt; [(Type, Q (Bool, Exp))] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107823"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107823"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Bool, Exp) -&gt; Exp) -&gt; Q (Bool, Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Exp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107823"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107818"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-517"></span><span>                                      </span><span class="annot"><span class="annottext">[Q Exp] -&gt; [Q Exp] -&gt; [Q Exp]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; [Exp] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107821"><span class="hs-identifier hs-var">z'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107820"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-518"></span><span>                        </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107819"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: [TyVarBndrSpec] -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107825"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107825"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107825"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-520"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-var">contravarianceError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-521"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_fun :: Q (Bool, Exp) -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#noFunctionsError"><span class="hs-identifier hs-var">noFunctionsError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-522"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107802"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-523"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><a href="#local-6989586621679107807"><span class="hs-identifier hs-type">match_for_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-526"></span><span>    </span><span id="local-6989586621679107807"><span class="annot"><span class="annottext">match_for_con :: Exp -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107807"><span class="hs-identifier hs-var hs-var">match_for_con</span></a></span></span><span> </span><span id="local-6989586621679107827"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107827"><span class="hs-identifier hs-var">zExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; (Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107829"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107829"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="#local-6989586621679107830"><span class="hs-identifier hs-var">mkBifoldr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107829"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>        </span><span class="hs-comment">-- g1 v1 (g2 v2 (.. z))</span><span>
</span><span id="line-529"></span><span>        </span><span class="annot"><a href="#local-6989586621679107830"><span class="hs-identifier hs-type">mkBifoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-530"></span><span>        </span><span id="local-6989586621679107830"><span class="annot"><span class="annottext">mkBifoldr :: [Exp] -&gt; Exp
</span><a href="#local-6989586621679107830"><span class="hs-identifier hs-var hs-var">mkBifoldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107827"><span class="hs-identifier hs-var">zExp</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="annot"><span class="hs-comment">-- | Generates a match whose right-hand side implements @bifoldMap@.</span></span><span>
</span><span id="line-533"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBifoldMapMatch"><span class="hs-identifier hs-type">makeBifoldMapMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-534"></span><span id="makeBifoldMapMatch"><span class="annot"><span class="annottext">makeBifoldMapMatch :: Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBifoldMapMatch"><span class="hs-identifier hs-var hs-var">makeBifoldMapMatch</span></a></span></span><span> </span><span id="local-6989586621679107832"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107832"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span id="local-6989586621679107833"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679107833"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107834"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107834"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621679107835"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107835"><span class="hs-identifier hs-var">parts</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Name Name
-&gt; FFoldType (Q (Bool, Exp))
-&gt; ConstructorInfo
-&gt; Q [Q (Bool, Exp)]
forall a. Map Name Name -&gt; FFoldType a -&gt; ConstructorInfo -&gt; Q [a]
</span><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107832"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107836"><span class="hs-identifier hs-var">ft_bifoldMap</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107833"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621679107837"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107837"><span class="hs-identifier hs-var">parts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107835"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107838"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107834"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107837"><span class="hs-identifier hs-var">parts'</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-comment">-- The Bool is True if the type mentions of the last two type parameters,</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-comment">-- False otherwise. Later, match_for_con uses mkSimpleConMatch2 to filter</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-comment">-- out expressions that do not mention the last parameters by checking for</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-comment">-- False.</span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><a href="#local-6989586621679107836"><span class="hs-identifier hs-type">ft_bifoldMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span id="local-6989586621679107836"><span class="annot"><span class="annottext">ft_bifoldMap :: FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107836"><span class="hs-identifier hs-var hs-var">ft_bifoldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [ft_triv for Bifoldable and Bitraversable]</span><span>
</span><span id="line-545"></span><span>                        </span><span class="annot"><span class="annottext">ft_triv :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679107839"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107839"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#memptyValName"><span class="hs-identifier hs-var">memptyValName</span></a></span><span>
</span><span id="line-546"></span><span>                                     </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107839"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107841"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107841"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107832"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; Name -&gt; Name
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107841"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: TupleSort -&gt; [Q (Bool, Exp)] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107842"><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107842"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679107843"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107843"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-549"></span><span>                          </span><span id="local-6989586621679107844"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107844"><span class="hs-identifier hs-var">gg</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107843"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-550"></span><span>                          </span><span id="local-6989586621679107845"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107845"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; TupleSort -&gt; [(Bool, Exp)] -&gt; Exp -&gt; Q Exp
forall a.
(Name -&gt; [a] -&gt; Q Match) -&gt; TupleSort -&gt; [a] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107838"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107842"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107844"><span class="hs-identifier hs-var">gg</span></a></span><span>
</span><span id="line-551"></span><span>                          </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107845"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_ty_app :: [(Type, Q (Bool, Exp))] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107846"><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107846"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-553"></span><span>                          </span><span id="local-6989586621679107847"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107847"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="annot"><span class="annottext">([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#foldMapArity"><span class="hs-identifier hs-var">foldMapArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107846"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>                                     </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Type, Q (Bool, Exp)) -&gt; Q Exp)
-&gt; [(Type, Q (Bool, Exp))] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107849"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107849"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Bool, Exp) -&gt; Exp) -&gt; Q (Bool, Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Exp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107849"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107846"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-555"></span><span>                          </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107847"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: [TyVarBndrSpec] -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107850"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107850"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107850"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-557"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-var">contravarianceError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107834"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-558"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_fun :: Q (Bool, Exp) -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#noFunctionsError"><span class="hs-identifier hs-var">noFunctionsError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107834"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-559"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107834"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-560"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><a href="#local-6989586621679107838"><span class="hs-identifier hs-type">match_for_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-563"></span><span>    </span><span id="local-6989586621679107838"><span class="annot"><span class="annottext">match_for_con :: Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107838"><span class="hs-identifier hs-var hs-var">match_for_con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; (Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107851"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107851"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="#local-6989586621679107852"><span class="hs-identifier hs-var">mkBifoldMap</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107851"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-comment">-- mappend v1 (mappend v2 ..)</span><span>
</span><span id="line-566"></span><span>        </span><span class="annot"><a href="#local-6989586621679107852"><span class="hs-identifier hs-type">mkBifoldMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-567"></span><span>        </span><span id="local-6989586621679107852"><span class="annot"><span class="annottext">mkBifoldMap :: [Exp] -&gt; Exp
</span><a href="#local-6989586621679107852"><span class="hs-identifier hs-var hs-var">mkBifoldMap</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#memptyValName"><span class="hs-identifier hs-var">memptyValName</span></a></span><span>
</span><span id="line-568"></span><span>        </span><span class="annot"><a href="#local-6989586621679107852"><span class="hs-identifier hs-var">mkBifoldMap</span></a></span><span> </span><span id="local-6989586621679107853"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107853"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; [Exp] -&gt; Exp
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldr1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; (Exp -&gt; Exp) -&gt; Exp -&gt; Exp -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#mappendValName"><span class="hs-identifier hs-var">mappendValName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107853"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span class="annot"><span class="hs-comment">-- | Generates a match whose right-hand side implements @bitraverse@.</span></span><span>
</span><span id="line-571"></span><span class="annot"><a href="Data.Bifunctor.TH.html#makeBitraverseMatch"><span class="hs-identifier hs-type">makeBitraverseMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-572"></span><span id="makeBitraverseMatch"><span class="annot"><span class="annottext">makeBitraverseMatch :: Map Name Name -&gt; ConstructorInfo -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#makeBitraverseMatch"><span class="hs-identifier hs-var hs-var">makeBitraverseMatch</span></a></span></span><span> </span><span id="local-6989586621679107856"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107856"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span id="local-6989586621679107857"><span class="annot"><span class="annottext">con :: ConstructorInfo
</span><a href="#local-6989586621679107857"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">constructorName :: ConstructorInfo -&gt; Name
</span><span class="hs-identifier hs-var">constructorName</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679107858"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107858"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679107859"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107859"><span class="hs-identifier hs-var">parts</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Name Name
-&gt; FFoldType (Q (Bool, Exp))
-&gt; ConstructorInfo
-&gt; Q [Q (Bool, Exp)]
forall a. Map Name Name -&gt; FFoldType a -&gt; ConstructorInfo -&gt; Q [a]
</span><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-var">foldDataConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107856"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107860"><span class="hs-identifier hs-var">ft_bitrav</span></a></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679107857"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span id="local-6989586621679107861"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107861"><span class="hs-identifier hs-var">parts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107859"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107862"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107858"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107861"><span class="hs-identifier hs-var">parts'</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-comment">-- The Bool is True if the type mentions of the last two type parameters,</span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-comment">-- False otherwise. Later, match_for_con uses mkSimpleConMatch2 to filter</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-comment">-- out expressions that do not mention the last parameters by checking for</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-comment">-- False.</span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><a href="#local-6989586621679107860"><span class="hs-identifier hs-type">ft_bitrav</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679107860"><span class="annot"><span class="annottext">ft_bitrav :: FFoldType (Q (Bool, Exp))
</span><a href="#local-6989586621679107860"><span class="hs-identifier hs-var hs-var">ft_bitrav</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- See Note [ft_triv for Bifoldable and Bitraversable]</span><span>
</span><span id="line-583"></span><span>                     </span><span class="annot"><span class="annottext">ft_triv :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#pureValName"><span class="hs-identifier hs-var">pureValName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107863"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107863"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679107856"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; Name -&gt; Name
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">Map.!</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107863"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: TupleSort -&gt; [Q (Bool, Exp)] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107864"><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107864"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679107865"><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107865"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-586"></span><span>                       </span><span id="local-6989586621679107866"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107866"><span class="hs-identifier hs-var">gg</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)] -&gt; Q [(Bool, Exp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Q (Bool, Exp)]
</span><a href="#local-6989586621679107865"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-587"></span><span>                       </span><span id="local-6989586621679107867"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107867"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var">mkSimpleLam</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; Q Exp) -&gt; Q Exp) -&gt; (Exp -&gt; Q Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; TupleSort -&gt; [(Bool, Exp)] -&gt; Exp -&gt; Q Exp
forall a.
(Name -&gt; [a] -&gt; Q Match) -&gt; TupleSort -&gt; [a] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-var">mkSimpleTupleCase</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107862"><span class="hs-identifier hs-var">match_for_con</span></a></span><span> </span><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679107864"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679107866"><span class="hs-identifier hs-var">gg</span></a></span><span>
</span><span id="line-588"></span><span>                       </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107867"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_ty_app :: [(Type, Q (Bool, Exp))] -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107868"><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107868"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>                       </span><span id="local-6989586621679107869"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107869"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="annot"><span class="annottext">([Q Exp] -&gt; Q Exp) -&gt; [Q Exp] -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#traverseArity"><span class="hs-identifier hs-var">traverseArity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107868"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>                                  </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((Type, Q (Bool, Exp)) -&gt; Q Exp)
-&gt; [(Type, Q (Bool, Exp))] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107871"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107871"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Bool, Exp) -&gt; Exp) -&gt; Q (Bool, Exp) -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Exp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107871"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Type, Q (Bool, Exp))]
</span><a href="#local-6989586621679107868"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-592"></span><span>                       </span><span class="annot"><span class="annottext">(Bool, Exp) -&gt; Q (Bool, Exp)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107869"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: [TyVarBndrSpec] -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679107872"><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107872"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><a href="#local-6989586621679107872"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-594"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: Name -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-var">contravarianceError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107858"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-595"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_fun :: Q (Bool, Exp) -&gt; Q (Bool, Exp) -&gt; Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Q (Bool, Exp)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#noFunctionsError"><span class="hs-identifier hs-var">noFunctionsError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107858"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-596"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: Q (Bool, Exp)
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q (Bool, Exp)
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var">outOfPlaceTyVarError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107858"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-597"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-comment">-- Con a1 a2 ... -&gt; liftA2 (\b1 b2 ... -&gt; Con b1 b2 ...) (g1 a1)</span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-comment">--                    (g2 a2) &lt;*&gt; ...</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="#local-6989586621679107862"><span class="hs-identifier hs-type">match_for_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621679107862"><span class="annot"><span class="annottext">match_for_con :: Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="#local-6989586621679107862"><span class="hs-identifier hs-var hs-var">match_for_con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch2"><span class="hs-identifier hs-var">mkSimpleConMatch2</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match)
-&gt; (Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679107873"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107873"><span class="hs-identifier hs-var">conExp</span></a></span></span><span> </span><span id="local-6989586621679107874"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107874"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621679107875"><span class="hs-identifier hs-var">mkApCon</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107873"><span class="hs-identifier hs-var">conExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107874"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>        </span><span class="hs-comment">-- liftA2 (\b1 b2 ... -&gt; Con b1 b2 ...) x1 x2 &lt;*&gt; ..</span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><a href="#local-6989586621679107875"><span class="hs-identifier hs-type">mkApCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-606"></span><span>        </span><span id="local-6989586621679107875"><span class="annot"><span class="annottext">mkApCon :: Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621679107875"><span class="hs-identifier hs-var hs-var">mkApCon</span></a></span></span><span> </span><span id="local-6989586621679107876"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107876"><span class="hs-identifier hs-var">conExp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#pureValName"><span class="hs-identifier hs-var">pureValName</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107876"><span class="hs-identifier hs-var">conExp</span></a></span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><a href="#local-6989586621679107875"><span class="hs-identifier hs-var">mkApCon</span></a></span><span> </span><span id="local-6989586621679107877"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107877"><span class="hs-identifier hs-var">conExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679107878"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107878"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#fmapValName"><span class="hs-identifier hs-var">fmapValName</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107877"><span class="hs-identifier hs-var">conExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107878"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><a href="#local-6989586621679107875"><span class="hs-identifier hs-var">mkApCon</span></a></span><span> </span><span id="local-6989586621679107880"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107880"><span class="hs-identifier hs-var">conExp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679107881"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107881"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679107882"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107882"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679107883"><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107883"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">List.foldl'</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="#local-6989586621679107885"><span class="hs-identifier hs-var">appAp</span></a></span><span>
</span><span id="line-609"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#liftA2ValName"><span class="hs-identifier hs-var">liftA2ValName</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107880"><span class="hs-identifier hs-var">conExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107881"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107882"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679107883"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-610"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679107885"><span class="annot"><span class="annottext">appAp :: Exp -&gt; Exp -&gt; Exp
</span><a href="#local-6989586621679107885"><span class="hs-identifier hs-var hs-var">appAp</span></a></span></span><span> </span><span id="local-6989586621679107887"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107887"><span class="hs-identifier hs-var">se1</span></a></span></span><span> </span><span id="local-6989586621679107888"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107888"><span class="hs-identifier hs-var">se2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Exp -&gt; Exp -&gt; Maybe Exp -&gt; Exp
</span><span class="hs-identifier hs-var">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107887"><span class="hs-identifier hs-var">se1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#apValName"><span class="hs-identifier hs-var">apValName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679107888"><span class="hs-identifier hs-var">se2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- Template Haskell reifying and AST manipulation</span><span>
</span><span id="line-614"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="hs-comment">-- For the given Types, generate an instance context and head. Coming up with</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- the instance type isn't as simple as dropping the last types, as you need to</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- be wary of kinds being instantiated with *.</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- See Note [Type inference in derived instances]</span><span>
</span><span id="line-620"></span><span class="annot"><a href="Data.Bifunctor.TH.html#buildTypeInstance"><span class="hs-identifier hs-type">buildTypeInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span>
</span><span id="line-621"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Bifunctor, Bifoldable, or Bitraversable</span></span><span>
</span><span id="line-622"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-623"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ The type constructor or data family name</span></span><span>
</span><span id="line-624"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span>
</span><span id="line-625"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ The datatype context</span></span><span>
</span><span id="line-626"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ The types to instantiate the instance with</span></span><span>
</span><span id="line-628"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DatatypeVariant</span></span><span>
</span><span id="line-629"></span><span>                  </span><span class="annot"><span class="hs-comment">-- ^ Are we dealing with a data family instance or not</span></span><span>
</span><span id="line-630"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span id="buildTypeInstance"><span class="annot"><span class="annottext">buildTypeInstance :: BiClass
-&gt; Name -&gt; [Type] -&gt; [Type] -&gt; DatatypeVariant -&gt; Q ([Type], Type)
</span><a href="Data.Bifunctor.TH.html#buildTypeInstance"><span class="hs-identifier hs-var hs-var">buildTypeInstance</span></a></span></span><span> </span><span id="local-6989586621679107892"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107892"><span class="hs-identifier hs-var">biClass</span></a></span></span><span> </span><span id="local-6989586621679107893"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span></span><span> </span><span id="local-6989586621679107894"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107894"><span class="hs-identifier hs-var">dataCxt</span></a></span></span><span> </span><span id="local-6989586621679107895"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107895"><span class="hs-identifier hs-var">instTysOrig</span></a></span></span><span> </span><span id="local-6989586621679107896"><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107896"><span class="hs-identifier hs-var">variant</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-comment">-- Make sure to expand through type/kind synonyms! Otherwise, the</span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-comment">-- eta-reduction check might get tripped up over type variables in a</span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-comment">-- synonym that are actually dropped.</span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-comment">-- (See GHC Trac #11416 for a scenario where this actually happened.)</span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679107897"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107897"><span class="hs-identifier hs-var">varTysExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107895"><span class="hs-identifier hs-var">instTysOrig</span></a></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679107900"><span class="hs-identifier hs-type">remainingLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679107900"><span class="annot"><span class="annottext">remainingLength :: Int
</span><a href="#local-6989586621679107900"><span class="hs-identifier hs-var hs-var">remainingLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107895"><span class="hs-identifier hs-var">instTysOrig</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span>        </span><span class="annot"><a href="#local-6989586621679107901"><span class="hs-identifier hs-type">droppedTysExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span>        </span><span id="local-6989586621679107901"><span class="annot"><span class="annottext">droppedTysExp :: [Type]
</span><a href="#local-6989586621679107901"><span class="hs-identifier hs-var hs-var">droppedTysExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107900"><span class="hs-identifier hs-var">remainingLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107897"><span class="hs-identifier hs-var">varTysExp</span></a></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span>        </span><span class="annot"><a href="#local-6989586621679107902"><span class="hs-identifier hs-type">droppedStarKindStati</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#StarKindStatus"><span class="hs-identifier hs-type">StarKindStatus</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-645"></span><span>        </span><span id="local-6989586621679107902"><span class="annot"><span class="annottext">droppedStarKindStati :: [StarKindStatus]
</span><a href="#local-6989586621679107902"><span class="hs-identifier hs-var hs-var">droppedStarKindStati</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; StarKindStatus) -&gt; [Type] -&gt; [StarKindStatus]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; StarKindStatus
</span><a href="Data.Bifunctor.TH.Internal.html#canRealizeKindStar"><span class="hs-identifier hs-var">canRealizeKindStar</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107901"><span class="hs-identifier hs-var">droppedTysExp</span></a></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-comment">-- Check there are enough types to drop and that all of them are either of</span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-comment">-- kind * or kind k (for some kind variable k). If not, throw an error.</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107900"><span class="hs-identifier hs-var">remainingLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(StarKindStatus -&gt; Bool) -&gt; [StarKindStatus] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StarKindStatus -&gt; StarKindStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">StarKindStatus
</span><a href="Data.Bifunctor.TH.Internal.html#NotKindStar"><span class="hs-identifier hs-var">NotKindStar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StarKindStatus]
</span><a href="#local-6989586621679107902"><span class="hs-identifier hs-var">droppedStarKindStati</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q () -&gt; Q ()) -&gt; Q () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-650"></span><span>      </span><span class="annot"><span class="annottext">BiClass -&gt; Name -&gt; Q ()
forall a. BiClass -&gt; Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107892"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679107906"><span class="hs-identifier hs-type">droppedKindVarNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621679107906"><span class="annot"><span class="annottext">droppedKindVarNames :: [Name]
</span><a href="#local-6989586621679107906"><span class="hs-identifier hs-var hs-var">droppedKindVarNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StarKindStatus] -&gt; [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#catKindVarNames"><span class="hs-identifier hs-var">catKindVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">[StarKindStatus]
</span><a href="#local-6989586621679107902"><span class="hs-identifier hs-var">droppedStarKindStati</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>        </span><span class="hs-comment">-- Substitute kind * for any dropped kind variables</span><span>
</span><span id="line-656"></span><span>        </span><span class="annot"><a href="#local-6989586621679107908"><span class="hs-identifier hs-type">varTysExpSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-657"></span><span>        </span><span id="local-6989586621679107908"><span class="annot"><span class="annottext">varTysExpSubst :: [Type]
</span><a href="#local-6989586621679107908"><span class="hs-identifier hs-var hs-var">varTysExpSubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107906"><span class="hs-identifier hs-var">droppedKindVarNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107897"><span class="hs-identifier hs-var">varTysExp</span></a></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>        </span><span class="annot"><a href="#local-6989586621679107910"><span class="hs-identifier hs-type">remainingTysExpSubst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679107911"><span class="hs-identifier hs-type">droppedTysExpSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-660"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679107910"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107910"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107911"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107911"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-661"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107900"><span class="hs-identifier hs-var">remainingLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107908"><span class="hs-identifier hs-var">varTysExpSubst</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span>        </span><span class="hs-comment">-- All of the type variables mentioned in the dropped types</span><span>
</span><span id="line-664"></span><span>        </span><span class="hs-comment">-- (post-synonym expansion)</span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><a href="#local-6989586621679107913"><span class="hs-identifier hs-type">droppedTyVarNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-666"></span><span>        </span><span id="local-6989586621679107913"><span class="annot"><span class="annottext">droppedTyVarNames :: [Name]
</span><a href="#local-6989586621679107913"><span class="hs-identifier hs-var hs-var">droppedTyVarNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Name]
forall a. TypeSubstitution a =&gt; a -&gt; [Name]
</span><span class="hs-identifier hs-var">freeVariables</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107911"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-comment">-- If any of the dropped types were polykinded, ensure that they are of kind *</span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-comment">-- after substituting * for the dropped kind variables. If not, throw an error.</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="Data.Bifunctor.TH.Internal.html#hasKindStar"><span class="hs-identifier hs-var">hasKindStar</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107911"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q () -&gt; Q ()) -&gt; Q () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-671"></span><span>      </span><span class="annot"><span class="annottext">BiClass -&gt; Name -&gt; Q ()
forall a. BiClass -&gt; Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#derivingKindError"><span class="hs-identifier hs-var">derivingKindError</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107892"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679107917"><span class="hs-identifier hs-type">preds</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-special">]</span><span>
</span><span id="line-674"></span><span>        </span><span class="annot"><a href="#local-6989586621679107918"><span class="hs-identifier hs-type">kvNames</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><a href="#local-6989586621679107919"><span class="hs-identifier hs-type">kvNames'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>        </span><span class="hs-comment">-- Derive instance constraints (and any kind variables which are specialized</span><span>
</span><span id="line-677"></span><span>        </span><span class="hs-comment">-- to * in those constraints)</span><span>
</span><span id="line-678"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679107917"><span class="annot"><span class="annottext">[Maybe Type]
</span><a href="#local-6989586621679107917"><span class="hs-identifier hs-var">preds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679107918"><span class="annot"><span class="annottext">[[Name]]
</span><a href="#local-6989586621679107918"><span class="hs-identifier hs-var">kvNames</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Maybe Type, [Name])] -&gt; ([Maybe Type], [[Name]])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(Maybe Type, [Name])] -&gt; ([Maybe Type], [[Name]]))
-&gt; [(Maybe Type, [Name])] -&gt; ([Maybe Type], [[Name]])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; (Maybe Type, [Name])) -&gt; [Type] -&gt; [(Maybe Type, [Name])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiClass -&gt; Type -&gt; (Maybe Type, [Name])
</span><a href="Data.Bifunctor.TH.html#deriveConstraint"><span class="hs-identifier hs-var">deriveConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107892"><span class="hs-identifier hs-var">biClass</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107910"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a></span><span>
</span><span id="line-679"></span><span>        </span><span id="local-6989586621679107919"><span class="annot"><span class="annottext">kvNames' :: [Name]
</span><a href="#local-6989586621679107919"><span class="hs-identifier hs-var hs-var">kvNames'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Name]] -&gt; [Name]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Name]]
</span><a href="#local-6989586621679107918"><span class="hs-identifier hs-var">kvNames</span></a></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-comment">-- Substitute the kind variables specialized in the constraints with *</span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><a href="#local-6989586621679107923"><span class="hs-identifier hs-type">remainingTysExpSubst'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621679107923"><span class="annot"><span class="annottext">remainingTysExpSubst' :: [Type]
</span><a href="#local-6989586621679107923"><span class="hs-identifier hs-var hs-var">remainingTysExpSubst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>          </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107919"><span class="hs-identifier hs-var">kvNames'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107910"><span class="hs-identifier hs-var">remainingTysExpSubst</span></a></span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span>        </span><span class="hs-comment">-- We now substitute all of the specialized-to-* kind variable names with</span><span>
</span><span id="line-687"></span><span>        </span><span class="hs-comment">-- *, but in the original types, not the synonym-expanded types. The reason</span><span>
</span><span id="line-688"></span><span>        </span><span class="hs-comment">-- we do this is a superficial one: we want the derived instance to resemble</span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-comment">-- the datatype written in source code as closely as possible. For example,</span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-comment">-- for the following data family instance:</span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-692"></span><span>        </span><span class="hs-comment">--   data family Fam a</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-comment">--   newtype instance Fam String = Fam String</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-695"></span><span>        </span><span class="hs-comment">-- We'd want to generate the instance:</span><span>
</span><span id="line-696"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-comment">--   instance C (Fam String)</span><span>
</span><span id="line-698"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-699"></span><span>        </span><span class="hs-comment">-- Not:</span><span>
</span><span id="line-700"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-701"></span><span>        </span><span class="hs-comment">--   instance C (Fam [Char])</span><span>
</span><span id="line-702"></span><span>        </span><span class="annot"><a href="#local-6989586621679107924"><span class="hs-identifier hs-type">remainingTysOrigSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span>        </span><span id="local-6989586621679107924"><span class="annot"><span class="annottext">remainingTysOrigSubst :: [Type]
</span><a href="#local-6989586621679107924"><span class="hs-identifier hs-var hs-var">remainingTysOrigSubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>          </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#substNamesWithKindStar"><span class="hs-identifier hs-var">substNamesWithKindStar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.union</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107906"><span class="hs-identifier hs-var">droppedKindVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107919"><span class="hs-identifier hs-var">kvNames'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>            </span><span class="annot"><span class="annottext">([Type] -&gt; [Type]) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679107900"><span class="hs-identifier hs-var">remainingLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107895"><span class="hs-identifier hs-var">instTysOrig</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621679107927"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107927"><span class="hs-identifier hs-var">isDataFamily</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-708"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DatatypeVariant
</span><a href="#local-6989586621679107896"><span class="hs-identifier hs-var">variant</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">Datatype</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-710"></span><span>        </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">Newtype</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-711"></span><span>        </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">DataInstance</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-712"></span><span>        </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">NewtypeInstance</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-cpp">
#if MIN_VERSION_th_abstraction(0,5,0)
</span><span>        </span><span class="annot"><span class="annottext">DatatypeVariant
</span><span class="hs-identifier hs-var">Datatype.TypeData</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Bool
forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#typeDataError"><span class="hs-identifier hs-var">typeDataError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679107934"><span class="hs-identifier hs-type">remainingTysOrigSubst'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-comment">-- See Note [Kind signatures in derived instances] for an explanation</span><span>
</span><span id="line-719"></span><span>        </span><span class="hs-comment">-- of the isDataFamily check.</span><span>
</span><span id="line-720"></span><span>        </span><span id="local-6989586621679107934"><span class="annot"><span class="annottext">remainingTysOrigSubst' :: [Type]
</span><a href="#local-6989586621679107934"><span class="hs-identifier hs-var hs-var">remainingTysOrigSubst'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-721"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679107927"><span class="hs-identifier hs-var">isDataFamily</span></a></span><span>
</span><span id="line-722"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107924"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a></span><span>
</span><span id="line-723"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; [Type] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#unSigT"><span class="hs-identifier hs-var">unSigT</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107924"><span class="hs-identifier hs-var">remainingTysOrigSubst</span></a></span><span>
</span><span id="line-724"></span><span>
</span><span id="line-725"></span><span>        </span><span class="annot"><a href="#local-6989586621679107936"><span class="hs-identifier hs-type">instanceCxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span>
</span><span id="line-726"></span><span>        </span><span id="local-6989586621679107936"><span class="annot"><span class="annottext">instanceCxt :: [Type]
</span><a href="#local-6989586621679107936"><span class="hs-identifier hs-var hs-var">instanceCxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Type] -&gt; [Type]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Type]
</span><a href="#local-6989586621679107917"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span>        </span><span class="annot"><a href="#local-6989586621679107937"><span class="hs-identifier hs-type">instanceType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-729"></span><span>        </span><span id="local-6989586621679107937"><span class="annot"><span class="annottext">instanceType :: Type
</span><a href="#local-6989586621679107937"><span class="hs-identifier hs-var hs-var">instanceType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; Name -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var">biClassName</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107892"><span class="hs-identifier hs-var">biClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>                     </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Type -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#applyTyCon"><span class="hs-identifier hs-var">applyTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107934"><span class="hs-identifier hs-var">remainingTysOrigSubst'</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span>    </span><span class="hs-comment">-- If the datatype context mentions any of the dropped type variables,</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-comment">-- we can't derive an instance, so throw an error.</span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Bool) -&gt; [Type] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Name] -&gt; Bool
</span><a href="Data.Bifunctor.TH.Internal.html#predMentionsName"><span class="hs-operator hs-var">`predMentionsName`</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107913"><span class="hs-identifier hs-var">droppedTyVarNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107894"><span class="hs-identifier hs-var">dataCxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q () -&gt; Q ()) -&gt; Q () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Q ()
forall a. Name -&gt; Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#datatypeContextError"><span class="hs-identifier hs-var">datatypeContextError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107893"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107937"><span class="hs-identifier hs-var">instanceType</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="hs-comment">-- Also ensure the dropped types can be safely eta-reduced. Otherwise,</span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-comment">-- throw an error.</span><span>
</span><span id="line-738"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Q () -&gt; Q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Bool
</span><a href="Data.Bifunctor.TH.Internal.html#canEtaReduce"><span class="hs-identifier hs-var">canEtaReduce</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107923"><span class="hs-identifier hs-var">remainingTysExpSubst'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107911"><span class="hs-identifier hs-var">droppedTysExpSubst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Q () -&gt; Q ()) -&gt; Q () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-739"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; Q ()
forall a. Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#etaReductionError"><span class="hs-identifier hs-var">etaReductionError</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107937"><span class="hs-identifier hs-var">instanceType</span></a></span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><span class="annottext">([Type], Type) -&gt; Q ([Type], Type)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679107936"><span class="hs-identifier hs-var">instanceCxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107937"><span class="hs-identifier hs-var">instanceType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="hs-comment">-- | Attempt to derive a constraint on a Type. If successful, return</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- Just the constraint and any kind variable names constrained to *.</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- Otherwise, return Nothing and the empty list.</span><span>
</span><span id="line-745"></span><span class="hs-comment">--</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- See Note [Type inference in derived instances] for the heuristics used to</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- come up with constraints.</span><span>
</span><span id="line-748"></span><span class="annot"><a href="Data.Bifunctor.TH.html#deriveConstraint"><span class="hs-identifier hs-type">deriveConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span id="deriveConstraint"><span class="annot"><span class="annottext">deriveConstraint :: BiClass -&gt; Type -&gt; (Maybe Type, [Name])
</span><a href="Data.Bifunctor.TH.html#deriveConstraint"><span class="hs-identifier hs-var hs-var">deriveConstraint</span></a></span></span><span> </span><span id="local-6989586621679107945"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107945"><span class="hs-identifier hs-var">biClass</span></a></span></span><span> </span><span id="local-6989586621679107946"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107946"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="Data.Bifunctor.TH.Internal.html#isTyVar"><span class="hs-identifier hs-var">isTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107946"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Maybe [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#hasKindVarChain"><span class="hs-identifier hs-var">hasKindVarChain</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107946"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-752"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107949"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107949"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#applyClass"><span class="hs-operator hs-var">`applyClass`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107951"><span class="hs-identifier hs-var">tName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; Maybe Name -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Int -&gt; Maybe Name
</span><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107945"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107949"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>      </span><span class="annot"><span class="annottext">Maybe [Name]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Maybe [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#hasKindVarChain"><span class="hs-identifier hs-var">hasKindVarChain</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107946"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-754"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679107953"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107953"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Type
</span><a href="Data.Bifunctor.TH.Internal.html#applyClass"><span class="hs-operator hs-var">`applyClass`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107951"><span class="hs-identifier hs-var">tName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; Maybe Name -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Int -&gt; Maybe Name
</span><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107945"><span class="hs-identifier hs-var">biClass</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679107953"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>                </span><span class="annot"><span class="annottext">Maybe [Name]
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-757"></span><span>    </span><span class="annot"><a href="#local-6989586621679107951"><span class="hs-identifier hs-type">tName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621679107951"><span class="annot"><span class="annottext">tName :: Name
</span><a href="#local-6989586621679107951"><span class="hs-identifier hs-var hs-var">tName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Name
</span><a href="Data.Bifunctor.TH.Internal.html#varTToName"><span class="hs-identifier hs-var">varTToName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107946"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="hs-comment">{-
Note [Kind signatures in derived instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

It is possible to put explicit kind signatures into the derived instances, e.g.,

  instance C a =&gt; C (Data (f :: * -&gt; *)) where ...

But it is preferable to avoid this if possible. If we come up with an incorrect
kind signature (which is entirely possible, since our type inferencer is pretty
unsophisticated - see Note [Type inference in derived instances]), then GHC will
flat-out reject the instance, which is quite unfortunate.

Plain old datatypes have the advantage that you can avoid using any kind signatures
at all in their instances. This is because a datatype declaration uses all type
variables, so the types that we use in a derived instance uniquely determine their
kinds. As long as we plug in the right types, the kind inferencer can do the rest
of the work. For this reason, we use unSigT to remove all kind signatures before
splicing in the instance context and head.

Data family instances are trickier, since a data family can have two instances that
are distinguished by kind alone, e.g.,

  data family Fam (a :: k)
  data instance Fam (a :: * -&gt; *)
  data instance Fam (a :: *)

If we dropped the kind signatures for C (Fam a), then GHC will have no way of
knowing which instance we are talking about. To avoid this scenario, we always
include explicit kind signatures in data family instances. There is a chance that
the inferred kind signatures will be incorrect, but if so, we can always fall back
on the make- functions.

Note [Type inference in derived instances]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Type inference is can be tricky to get right, and we want to avoid recreating the
entirety of GHC's type inferencer in Template Haskell. For this reason, we will
probably never come up with derived instance contexts that are as accurate as
GHC's. But that doesn't mean we can't do anything! There are a couple of simple
things we can do to make instance contexts that work for 80% of use cases:

1. If one of the last type parameters is polykinded, then its kind will be
   specialized to * in the derived instance. We note what kind variable the type
   parameter had and substitute it with * in the other types as well. For example,
   imagine you had

     data Data (a :: k) (b :: k) (c :: k)

   Then you'd want to derived instance to be:

     instance C (Data (a :: *))

   Not:

     instance C (Data (a :: k))

2. We na&#239;vely come up with instance constraints using the following criteria:

   (i)  If there's a type parameter n of kind k1 -&gt; k2 (where k1/k2 are * or kind
        variables), then generate a Functor n constraint, and if k1/k2 are kind
        variables, then substitute k1/k2 with * elsewhere in the types. We must
        consider the case where they are kind variables because you might have a
        scenario like this:

          newtype Compose (f :: k3 -&gt; *) (g :: k1 -&gt; k2 -&gt; k3) (a :: k1) (b :: k2)
            = Compose (f (g a b))

        Which would have a derived Bifunctor instance of:

          instance (Functor f, Bifunctor g) =&gt; Bifunctor (Compose f g) where ...
   (ii) If there's a type parameter n of kind k1 -&gt; k2 -&gt; k3 (where k1/k2/k3 are
        * or kind variables), then generate a Bifunctor n constraint and perform
        kind substitution as in the other case.
-}</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="hs-comment">{-
Note [Matching functions with GADT type variables]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When deriving Bifoldable, there is a tricky corner case to consider:

  data Both a b where
    BothCon :: x -&gt; x -&gt; Both x x

Which fold functions should be applied to which arguments of BothCon? We have a
choice, since both the function of type (a -&gt; m) and of type (b -&gt; m) can be
applied to either argument. In such a scenario, the second fold function takes
precedence over the first fold function, so the derived Bifoldable instance would be:

  instance Bifoldable Both where
    bifoldMap _ g (BothCon x1 x2) = g x1 &lt;&gt; g x2

This is not an arbitrary choice, as this definition ensures that
bifoldMap id = Foldable.foldMap for a derived Bifoldable instance for Both.
-}</span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- Error messages</span><span>
</span><span id="line-859"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="hs-comment">-- | Either the given data type doesn't have enough type variables, or one of</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- the type variables to be eta-reduced cannot realize kind *.</span><span>
</span><span id="line-863"></span><span id="local-6989586621679107167"><span class="annot"><a href="Data.Bifunctor.TH.html#derivingKindError"><span class="hs-identifier hs-type">derivingKindError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107167"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-864"></span><span id="derivingKindError"><span class="annot"><span class="annottext">derivingKindError :: forall a. BiClass -&gt; Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#derivingKindError"><span class="hs-identifier hs-var hs-var">derivingKindError</span></a></span></span><span> </span><span id="local-6989586621679107956"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107956"><span class="hs-identifier hs-var">biClass</span></a></span></span><span> </span><span id="local-6989586621679107957"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107957"><span class="hs-identifier hs-var">tyConName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-865"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot derive well-kinded instance of form &#8216;&quot;</span></span><span>
</span><span id="line-866"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107959"><span class="hs-identifier hs-var">className</span></a></span><span>
</span><span id="line-867"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-868"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-869"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107957"><span class="hs-identifier hs-var">tyConName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ...&quot;</span></span><span>
</span><span id="line-871"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216;\n\tClass &quot;</span></span><span>
</span><span id="line-873"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679107959"><span class="hs-identifier hs-var">className</span></a></span><span>
</span><span id="line-874"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; expects an argument of kind * -&gt; * -&gt; *&quot;</span></span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-876"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><a href="#local-6989586621679107959"><span class="hs-identifier hs-type">className</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621679107959"><span class="annot"><span class="annottext">className :: String
</span><a href="#local-6989586621679107959"><span class="hs-identifier hs-var hs-var">className</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; Name -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var">biClassName</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679107956"><span class="hs-identifier hs-var">biClass</span></a></span><span>
</span><span id="line-879"></span><span>
</span><span id="line-880"></span><span class="hs-comment">-- | One of the last two type variables appeared in a contravariant position</span><span>
</span><span id="line-881"></span><span class="hs-comment">-- when deriving Bifoldable or Bitraversable.</span><span>
</span><span id="line-882"></span><span id="local-6989586621679107963"><span class="annot"><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-type">contravarianceError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107963"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-883"></span><span id="contravarianceError"><span class="annot"><span class="annottext">contravarianceError :: forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#contravarianceError"><span class="hs-identifier hs-var hs-var">contravarianceError</span></a></span></span><span> </span><span id="local-6989586621679107965"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107965"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-884"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107965"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; must not use the last type variable(s) in a function argument&quot;</span></span><span>
</span><span id="line-887"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">-- | A constructor has a function argument in a derived Bifoldable or Bitraversable</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-891"></span><span id="local-6989586621679107966"><span class="annot"><a href="Data.Bifunctor.TH.html#noFunctionsError"><span class="hs-identifier hs-type">noFunctionsError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107966"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-892"></span><span id="noFunctionsError"><span class="annot"><span class="annottext">noFunctionsError :: forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#noFunctionsError"><span class="hs-identifier hs-var hs-var">noFunctionsError</span></a></span></span><span> </span><span id="local-6989586621679107968"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107968"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-893"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span>
</span><span id="line-894"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107968"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; must not contain function types&quot;</span></span><span>
</span><span id="line-896"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span class="hs-comment">-- | The data type has a DatatypeContext which mentions one of the eta-reduced</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- type variables.</span><span>
</span><span id="line-900"></span><span id="local-6989586621679107175"><span class="annot"><a href="Data.Bifunctor.TH.html#datatypeContextError"><span class="hs-identifier hs-type">datatypeContextError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107175"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-901"></span><span id="datatypeContextError"><span class="annot"><span class="annottext">datatypeContextError :: forall a. Name -&gt; Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#datatypeContextError"><span class="hs-identifier hs-var hs-var">datatypeContextError</span></a></span></span><span> </span><span id="local-6989586621679107972"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107972"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span id="local-6989586621679107973"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107973"><span class="hs-identifier hs-var">instanceType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't make a derived instance of &#8216;&quot;</span></span><span>
</span><span id="line-903"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107973"><span class="hs-identifier hs-var">instanceType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216;:\n\tData type &#8216;&quot;</span></span><span>
</span><span id="line-905"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107972"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; must not have a class context involving the last type argument(s)&quot;</span></span><span>
</span><span id="line-907"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-908"></span><span>
</span><span id="line-909"></span><span class="hs-comment">-- | The data type has an existential constraint which mentions one of the</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- eta-reduced type variables.</span><span>
</span><span id="line-911"></span><span id="local-6989586621679107144"><span class="annot"><a href="Data.Bifunctor.TH.html#existentialContextError"><span class="hs-identifier hs-type">existentialContextError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107144"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-912"></span><span id="existentialContextError"><span class="annot"><span class="annottext">existentialContextError :: forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#existentialContextError"><span class="hs-identifier hs-var hs-var">existentialContextError</span></a></span></span><span> </span><span id="local-6989586621679107976"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107976"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-913"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107976"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; must be truly polymorphic in the last argument(s) of the data type&quot;</span></span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-917"></span><span>
</span><span id="line-918"></span><span class="hs-comment">-- | The data type mentions one of the n eta-reduced type variables in a place other</span><span>
</span><span id="line-919"></span><span class="hs-comment">-- than the last nth positions of a data type in a constructor's field.</span><span>
</span><span id="line-920"></span><span id="local-6989586621679107977"><span class="annot"><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-type">outOfPlaceTyVarError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107977"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-921"></span><span id="outOfPlaceTyVarError"><span class="annot"><span class="annottext">outOfPlaceTyVarError :: forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#outOfPlaceTyVarError"><span class="hs-identifier hs-var hs-var">outOfPlaceTyVarError</span></a></span></span><span> </span><span id="local-6989586621679107979"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107979"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107979"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216; must only use its last two type variable(s) within&quot;</span></span><span>
</span><span id="line-925"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; the last two argument(s) of a data type&quot;</span></span><span>
</span><span id="line-926"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span class="hs-comment">-- | One of the last type variables cannot be eta-reduced (see the canEtaReduce</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- function for the criteria it would have to meet).</span><span>
</span><span id="line-930"></span><span id="local-6989586621679107176"><span class="annot"><a href="Data.Bifunctor.TH.html#etaReductionError"><span class="hs-identifier hs-type">etaReductionError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107176"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-931"></span><span id="etaReductionError"><span class="annot"><span class="annottext">etaReductionError :: forall a. Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#etaReductionError"><span class="hs-identifier hs-var hs-var">etaReductionError</span></a></span></span><span> </span><span id="local-6989586621679107982"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107982"><span class="hs-identifier hs-var">instanceType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-932"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot eta-reduce to an instance of form \n\tinstance (...) =&gt; &quot;</span></span><span>
</span><span id="line-933"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679107982"><span class="hs-identifier hs-var">instanceType</span></a></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span id="local-6989586621679107983"><span class="annot"><a href="Data.Bifunctor.TH.html#typeDataError"><span class="hs-identifier hs-type">typeDataError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107983"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-936"></span><span id="typeDataError"><span class="annot"><span class="annottext">typeDataError :: forall a. Name -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#typeDataError"><span class="hs-identifier hs-var hs-var">typeDataError</span></a></span></span><span> </span><span id="local-6989586621679107985"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107985"><span class="hs-identifier hs-var">dataName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q a
forall a. String -&gt; Q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-937"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; ShowS -&gt; String -&gt; Q a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot derive instance for &#8216;&quot;</span></span><span>
</span><span id="line-938"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679107985"><span class="hs-identifier hs-var">dataName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>  </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8216;, which is a &#8216;type data&#8216; declaration&quot;</span></span><span>
</span><span id="line-940"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Q a) -&gt; String -&gt; Q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-941"></span><span>
</span><span id="line-942"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- Class-specific constants</span><span>
</span><span id="line-944"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="annot"><span class="hs-comment">-- | A representation of which class is being derived.</span></span><span>
</span><span id="line-947"></span><span class="hs-keyword">data</span><span> </span><span id="BiClass"><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-var">BiClass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Bifunctor"><span class="annot"><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Bifoldable"><span class="annot"><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Bitraversable"><span class="annot"><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="annot"><span class="hs-comment">-- | A representation of which function is being generated.</span></span><span>
</span><span id="line-950"></span><span class="hs-keyword">data</span><span> </span><span id="BiFun"><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-var">BiFun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Bimap"><span class="annot"><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Bifoldr"><span class="annot"><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="BifoldMap"><span class="annot"><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Bitraverse"><span class="annot"><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span></span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679107987"><span id="local-6989586621679107989"><span class="annot"><span class="annottext">BiFun -&gt; BiFun -&gt; Bool
(BiFun -&gt; BiFun -&gt; Bool) -&gt; (BiFun -&gt; BiFun -&gt; Bool) -&gt; Eq BiFun
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BiFun -&gt; BiFun -&gt; Bool
== :: BiFun -&gt; BiFun -&gt; Bool
$c/= :: BiFun -&gt; BiFun -&gt; Bool
/= :: BiFun -&gt; BiFun -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-type">biFunConstName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-954"></span><span id="biFunConstName"><span class="annot"><span class="annottext">biFunConstName :: BiFun -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-var hs-var">biFunConstName</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bimapConstValName"><span class="hs-identifier hs-var">bimapConstValName</span></a></span><span>
</span><span id="line-955"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-var">biFunConstName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldrConstValName"><span class="hs-identifier hs-var">bifoldrConstValName</span></a></span><span>
</span><span id="line-956"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-var">biFunConstName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldMapConstValName"><span class="hs-identifier hs-var">bifoldMapConstValName</span></a></span><span>
</span><span id="line-957"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunConstName"><span class="hs-identifier hs-var">biFunConstName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bitraverseConstValName"><span class="hs-identifier hs-var">bitraverseConstValName</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-type">biClassName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-960"></span><span id="biClassName"><span class="annot"><span class="annottext">biClassName :: BiClass -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var hs-var">biClassName</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifunctorTypeName"><span class="hs-identifier hs-var">bifunctorTypeName</span></a></span><span>
</span><span id="line-961"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var">biClassName</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldableTypeName"><span class="hs-identifier hs-var">bifoldableTypeName</span></a></span><span>
</span><span id="line-962"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var">biClassName</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bitraversableTypeName"><span class="hs-identifier hs-var">bitraversableTypeName</span></a></span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-type">biFunName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-965"></span><span id="biFunName"><span class="annot"><span class="annottext">biFunName :: BiFun -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var hs-var">biFunName</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bimapValName"><span class="hs-identifier hs-var">bimapValName</span></a></span><span>
</span><span id="line-966"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var">biFunName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldrValName"><span class="hs-identifier hs-var">bifoldrValName</span></a></span><span>
</span><span id="line-967"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var">biFunName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldMapValName"><span class="hs-identifier hs-var">bifoldMapValName</span></a></span><span>
</span><span id="line-968"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var">biFunName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bitraverseValName"><span class="hs-identifier hs-var">bitraverseValName</span></a></span><span>
</span><span id="line-969"></span><span>
</span><span id="line-970"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassToFuns"><span class="hs-identifier hs-type">biClassToFuns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-971"></span><span id="biClassToFuns"><span class="annot"><span class="annottext">biClassToFuns :: BiClass -&gt; [BiFun]
</span><a href="Data.Bifunctor.TH.html#biClassToFuns"><span class="hs-identifier hs-var hs-var">biClassToFuns</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-972"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassToFuns"><span class="hs-identifier hs-var">biClassToFuns</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-973"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassToFuns"><span class="hs-identifier hs-var">biClassToFuns</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-974"></span><span>
</span><span id="line-975"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-type">biFunToClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span>
</span><span id="line-976"></span><span id="biFunToClass"><span class="annot"><span class="annottext">biFunToClass :: BiFun -&gt; BiClass
</span><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var hs-var">biFunToClass</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span><span>
</span><span id="line-977"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var">biFunToClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>
</span><span id="line-978"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var">biFunToClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>
</span><span id="line-979"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunToClass"><span class="hs-identifier hs-var">biFunToClass</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-type">biClassConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-982"></span><span id="biClassConstraint"><span class="annot"><span class="annottext">biClassConstraint :: BiClass -&gt; Int -&gt; Maybe Name
</span><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var hs-var">biClassConstraint</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifunctor"><span class="hs-identifier hs-var">Bifunctor</span></a></span><span>     </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#functorTypeName"><span class="hs-identifier hs-var">functorTypeName</span></a></span><span>
</span><span id="line-983"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#foldableTypeName"><span class="hs-identifier hs-var">foldableTypeName</span></a></span><span>
</span><span id="line-984"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bitraversable"><span class="hs-identifier hs-var">Bitraversable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#traversableTypeName"><span class="hs-identifier hs-var">traversableTypeName</span></a></span><span>
</span><span id="line-985"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span id="local-6989586621679108005"><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679108005"><span class="hs-identifier hs-var">biClass</span></a></span></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Maybe Name) -&gt; Name -&gt; Maybe Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BiClass -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biClassName"><span class="hs-identifier hs-var">biClassName</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="#local-6989586621679108005"><span class="hs-identifier hs-var">biClass</span></a></span><span>
</span><span id="line-986"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biClassConstraint"><span class="hs-identifier hs-var">biClassConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><span class="hs-identifier">_</span></span><span>             </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="annot"><a href="Data.Bifunctor.TH.html#fmapArity"><span class="hs-identifier hs-type">fmapArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-989"></span><span id="fmapArity"><span class="annot"><span class="annottext">fmapArity :: Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#fmapArity"><span class="hs-identifier hs-var hs-var">fmapArity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#fmapValName"><span class="hs-identifier hs-var">fmapValName</span></a></span><span>
</span><span id="line-990"></span><span class="annot"><a href="Data.Bifunctor.TH.html#fmapArity"><span class="hs-identifier hs-var">fmapArity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bimapValName"><span class="hs-identifier hs-var">bimapValName</span></a></span><span>
</span><span id="line-991"></span><span class="annot"><a href="Data.Bifunctor.TH.html#fmapArity"><span class="hs-identifier hs-var">fmapArity</span></a></span><span> </span><span id="local-6989586621679108006"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108006"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
forall a. Int -&gt; a
</span><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-var">arityErr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108006"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldrArity"><span class="hs-identifier hs-type">foldrArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-994"></span><span id="foldrArity"><span class="annot"><span class="annottext">foldrArity :: Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#foldrArity"><span class="hs-identifier hs-var hs-var">foldrArity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#foldrValName"><span class="hs-identifier hs-var">foldrValName</span></a></span><span>
</span><span id="line-995"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldrArity"><span class="hs-identifier hs-var">foldrArity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldrValName"><span class="hs-identifier hs-var">bifoldrValName</span></a></span><span>
</span><span id="line-996"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldrArity"><span class="hs-identifier hs-var">foldrArity</span></a></span><span> </span><span id="local-6989586621679108009"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108009"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
forall a. Int -&gt; a
</span><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-var">arityErr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108009"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldMapArity"><span class="hs-identifier hs-type">foldMapArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-999"></span><span id="foldMapArity"><span class="annot"><span class="annottext">foldMapArity :: Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#foldMapArity"><span class="hs-identifier hs-var hs-var">foldMapArity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#foldMapValName"><span class="hs-identifier hs-var">foldMapValName</span></a></span><span>
</span><span id="line-1000"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldMapArity"><span class="hs-identifier hs-var">foldMapArity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bifoldMapValName"><span class="hs-identifier hs-var">bifoldMapValName</span></a></span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldMapArity"><span class="hs-identifier hs-var">foldMapArity</span></a></span><span> </span><span id="local-6989586621679108011"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108011"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
forall a. Int -&gt; a
</span><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-var">arityErr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108011"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span class="annot"><a href="Data.Bifunctor.TH.html#traverseArity"><span class="hs-identifier hs-type">traverseArity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1004"></span><span id="traverseArity"><span class="annot"><span class="annottext">traverseArity :: Int -&gt; Name
</span><a href="Data.Bifunctor.TH.html#traverseArity"><span class="hs-identifier hs-var hs-var">traverseArity</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#traverseValName"><span class="hs-identifier hs-var">traverseValName</span></a></span><span>
</span><span id="line-1005"></span><span class="annot"><a href="Data.Bifunctor.TH.html#traverseArity"><span class="hs-identifier hs-var">traverseArity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#bitraverseValName"><span class="hs-identifier hs-var">bitraverseValName</span></a></span><span>
</span><span id="line-1006"></span><span class="annot"><a href="Data.Bifunctor.TH.html#traverseArity"><span class="hs-identifier hs-var">traverseArity</span></a></span><span> </span><span id="local-6989586621679108013"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108013"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
forall a. Int -&gt; a
</span><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-var">arityErr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108013"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1007"></span><span>
</span><span id="line-1008"></span><span id="local-6989586621679107189"><span class="annot"><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-type">arityErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107189"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1009"></span><span id="arityErr"><span class="annot"><span class="annottext">arityErr :: forall a. Int -&gt; a
</span><a href="Data.Bifunctor.TH.html#arityErr"><span class="hs-identifier hs-var hs-var">arityErr</span></a></span></span><span> </span><span id="local-6989586621679108018"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108018"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsupported arity: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108018"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="annot"><a href="Data.Bifunctor.TH.html#allowExQuant"><span class="hs-identifier hs-type">allowExQuant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiClass"><span class="hs-identifier hs-type">BiClass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1012"></span><span id="allowExQuant"><span class="annot"><span class="annottext">allowExQuant :: BiClass -&gt; Bool
</span><a href="Data.Bifunctor.TH.html#allowExQuant"><span class="hs-identifier hs-var hs-var">allowExQuant</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><a href="Data.Bifunctor.TH.html#Bifoldable"><span class="hs-identifier hs-var">Bifoldable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1013"></span><span class="annot"><a href="Data.Bifunctor.TH.html#allowExQuant"><span class="hs-identifier hs-var">allowExQuant</span></a></span><span> </span><span class="annot"><span class="annottext">BiClass
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunEmptyCase"><span class="hs-identifier hs-type">biFunEmptyCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1016"></span><span id="biFunEmptyCase"><span class="annot"><span class="annottext">biFunEmptyCase :: BiFun -&gt; Name -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunEmptyCase"><span class="hs-identifier hs-var hs-var">biFunEmptyCase</span></a></span></span><span> </span><span id="local-6989586621679108021"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108021"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679108022"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108022"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679108023"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108023"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1017"></span><span>    </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; BiFun -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunTrivial"><span class="hs-identifier hs-var">biFunTrivial</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108024"><span class="hs-identifier hs-var">emptyCase</span></a></span><span>
</span><span id="line-1018"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#pureValName"><span class="hs-identifier hs-var">pureValName</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108024"><span class="hs-identifier hs-var">emptyCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>                 </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108021"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108022"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1020"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1021"></span><span>    </span><span class="annot"><a href="#local-6989586621679108024"><span class="hs-identifier hs-type">emptyCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1022"></span><span>    </span><span id="local-6989586621679108024"><span class="annot"><span class="annottext">emptyCase :: Q Exp
</span><a href="#local-6989586621679108024"><span class="hs-identifier hs-var hs-var">emptyCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Match] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; [m Match] -&gt; m Exp
</span><span class="hs-identifier hs-var">caseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108023"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1023"></span><span>
</span><span id="line-1024"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunNoCons"><span class="hs-identifier hs-type">biFunNoCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1025"></span><span id="biFunNoCons"><span class="annot"><span class="annottext">biFunNoCons :: BiFun -&gt; Name -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunNoCons"><span class="hs-identifier hs-var hs-var">biFunNoCons</span></a></span></span><span> </span><span id="local-6989586621679108025"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108025"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679108026"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108026"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679108027"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108027"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1026"></span><span>    </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; BiFun -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunTrivial"><span class="hs-identifier hs-var">biFunTrivial</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108028"><span class="hs-identifier hs-var">seqAndError</span></a></span><span>
</span><span id="line-1027"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#pureValName"><span class="hs-identifier hs-var">pureValName</span></a></span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108028"><span class="hs-identifier hs-var">seqAndError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>                 </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108025"><span class="hs-identifier hs-var">biFun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108026"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1030"></span><span>    </span><span class="annot"><a href="#local-6989586621679108028"><span class="hs-identifier hs-type">seqAndError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1031"></span><span>    </span><span id="local-6989586621679108028"><span class="annot"><span class="annottext">seqAndError :: Q Exp
</span><a href="#local-6989586621679108028"><span class="hs-identifier hs-var hs-var">seqAndError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">appE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#seqValName"><span class="hs-identifier hs-var">seqValName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108027"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`appE`</span></span><span>
</span><span id="line-1032"></span><span>                  </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">appE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#errorValName"><span class="hs-identifier hs-var">errorValName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Exp
</span><span class="hs-identifier hs-var">stringE</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Q Exp) -&gt; String -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Void &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BiFun -&gt; Name
</span><a href="Data.Bifunctor.TH.html#biFunName"><span class="hs-identifier hs-var">biFunName</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108025"><span class="hs-identifier hs-var">biFun</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="annot"><a href="Data.Bifunctor.TH.html#biFunTrivial"><span class="hs-identifier hs-type">biFunTrivial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1036"></span><span id="biFunTrivial"><span class="annot"><span class="annottext">biFunTrivial :: Q Exp -&gt; Q Exp -&gt; BiFun -&gt; Name -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#biFunTrivial"><span class="hs-identifier hs-var hs-var">biFunTrivial</span></a></span></span><span> </span><span id="local-6989586621679108032"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108032"><span class="hs-identifier hs-var">bimapE</span></a></span></span><span> </span><span id="local-6989586621679108033"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108033"><span class="hs-identifier hs-var">bitraverseE</span></a></span></span><span> </span><span id="local-6989586621679108034"><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108034"><span class="hs-identifier hs-var">biFun</span></a></span></span><span> </span><span id="local-6989586621679108035"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108035"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiFun -&gt; Q Exp
</span><a href="#local-6989586621679108036"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="#local-6989586621679108034"><span class="hs-identifier hs-var">biFun</span></a></span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1038"></span><span>    </span><span class="annot"><a href="#local-6989586621679108036"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#BiFun"><span class="hs-identifier hs-type">BiFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1039"></span><span>    </span><span id="local-6989586621679108036"><span class="annot"><span class="annottext">go :: BiFun -&gt; Q Exp
</span><a href="#local-6989586621679108036"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108032"><span class="hs-identifier hs-var">bimapE</span></a></span><span>
</span><span id="line-1040"></span><span>    </span><span class="annot"><a href="#local-6989586621679108036"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bifoldr"><span class="hs-identifier hs-var">Bifoldr</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108035"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1041"></span><span>    </span><span class="annot"><a href="#local-6989586621679108036"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#BifoldMap"><span class="hs-identifier hs-var">BifoldMap</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Data.Bifunctor.TH.Internal.html#memptyValName"><span class="hs-identifier hs-var">memptyValName</span></a></span><span>
</span><span id="line-1042"></span><span>    </span><span class="annot"><a href="#local-6989586621679108036"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">BiFun
</span><a href="Data.Bifunctor.TH.html#Bitraverse"><span class="hs-identifier hs-var">Bitraverse</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108033"><span class="hs-identifier hs-var">bitraverseE</span></a></span><span>
</span><span id="line-1043"></span><span>
</span><span id="line-1044"></span><span class="hs-comment">{-
Note [ft_triv for Bifoldable and Bitraversable]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When deriving Bifoldable and Bitraversable, we filter out any subexpressions whose
type does not mention one of the last two type parameters. From this, you might
think that we don't need to implement ft_triv for bifoldr, bifoldMap, or
bitraverse at all, but in fact we do need to. Imagine the following data type:

    data T a b = MkT a (T Int b)

In a derived Bifoldable T instance, you would generate the following bifoldMap
definition:

    bifoldMap f g (MkT a1 a2) = f a1 &lt;&gt; bifoldMap (\_ -&gt; mempty) g arg2

You need to fill in bi_triv (\_ -&gt; mempty) as the first argument to the recursive
call to bifoldMap, since that is how the algorithm handles polymorphic recursion.
-}</span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- Generic traversal for functor-like deriving</span><span>
</span><span id="line-1065"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-1066"></span><span>
</span><span id="line-1067"></span><span class="hs-comment">-- Much of the code below is cargo-culted from the TcGenFunctor module in GHC.</span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span class="hs-keyword">data</span><span> </span><span id="FFoldType"><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-var">FFoldType</span></a></span></span><span> </span><span id="local-6989586621679107195"><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span></span><span>      </span><span class="hs-comment">-- Describes how to fold over a Type in a functor like way</span><span>
</span><span id="line-1070"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="FT"><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-var">FT</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="ft_triv"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var hs-var">ft_triv</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1071"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Does not contain variables</span></span><span>
</span><span id="line-1072"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_var"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; Name -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var hs-var">ft_var</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1073"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ A bare variable</span></span><span>
</span><span id="line-1074"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_co_var"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; Name -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var hs-var">ft_co_var</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1075"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ A bare variable, contravariantly</span></span><span>
</span><span id="line-1076"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_fun"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; a -&gt; a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var hs-var">ft_fun</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1077"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Function type</span></span><span>
</span><span id="line-1078"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_tup"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; TupleSort -&gt; [a] -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var hs-var">ft_tup</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1079"></span><span>          </span><span class="hs-comment">-- ^ Tuple type. The [a] is the result of folding over the</span><span>
</span><span id="line-1080"></span><span>          </span><span class="hs-comment">--   arguments of the tuple.</span><span>
</span><span id="line-1081"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_ty_app"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; [(Type, a)] -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var hs-var">ft_ty_app</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1082"></span><span>          </span><span class="hs-comment">-- ^ Type app, variables only in last argument. The [(Type, a)]</span><span>
</span><span id="line-1083"></span><span>          </span><span class="hs-comment">--   represents the last argument types. That is, they form the</span><span>
</span><span id="line-1084"></span><span>          </span><span class="hs-comment">--   argument parts of @fun_ty arg_ty_1 ... arg_ty_n@.</span><span>
</span><span id="line-1085"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_bad_app"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var hs-var">ft_bad_app</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1086"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Type app, variable other than in last arguments</span></span><span>
</span><span id="line-1087"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="ft_forall"><span class="annot"><span class="annottext">forall a. FFoldType a -&gt; [TyVarBndrSpec] -&gt; a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var hs-var">ft_forall</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndrSpec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107195"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1088"></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ Forall type</span></span><span>
</span><span id="line-1089"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-1090"></span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- Note that in GHC, this function is pure. It must be monadic here since we:</span><span>
</span><span id="line-1092"></span><span class="hs-comment">--</span><span>
</span><span id="line-1093"></span><span class="hs-comment">-- (1) Expand type synonyms</span><span>
</span><span id="line-1094"></span><span class="hs-comment">-- (2) Detect type family applications</span><span>
</span><span id="line-1095"></span><span class="hs-comment">--</span><span>
</span><span id="line-1096"></span><span class="hs-comment">-- Which require reification in Template Haskell, but are pure in Core.</span><span>
</span><span id="line-1097"></span><span class="annot"><a href="Data.Bifunctor.TH.html#functorLikeTraverse"><span class="hs-identifier hs-type">functorLikeTraverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679107204"><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-1098"></span><span>                       </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Variables to look for</span></span><span>
</span><span id="line-1099"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ How to fold</span></span><span>
</span><span id="line-1100"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ Type to process</span></span><span>
</span><span id="line-1101"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1102"></span><span id="functorLikeTraverse"><span class="annot"><span class="annottext">functorLikeTraverse :: forall a. Map Name Name -&gt; FFoldType a -&gt; Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#functorLikeTraverse"><span class="hs-identifier hs-var hs-var">functorLikeTraverse</span></a></span></span><span> </span><span id="local-6989586621679108069"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679108069"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Bifunctor.TH.html#FT"><span class="hs-identifier hs-type">FT</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ft_triv :: forall a. FFoldType a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_triv"><span class="hs-identifier hs-var">ft_triv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108070"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108070"><span class="hs-identifier hs-var">caseTrivial</span></a></span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ft_var :: forall a. FFoldType a -&gt; Name -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_var"><span class="hs-identifier hs-var">ft_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108071"><span class="annot"><span class="annottext">Name -&gt; a
</span><a href="#local-6989586621679108071"><span class="hs-identifier hs-var">caseVar</span></a></span></span><span>
</span><span id="line-1103"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_co_var :: forall a. FFoldType a -&gt; Name -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_co_var"><span class="hs-identifier hs-var">ft_co_var</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108072"><span class="annot"><span class="annottext">Name -&gt; a
</span><a href="#local-6989586621679108072"><span class="hs-identifier hs-var">caseCoVar</span></a></span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">ft_fun :: forall a. FFoldType a -&gt; a -&gt; a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_fun"><span class="hs-identifier hs-var">ft_fun</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108073"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679108073"><span class="hs-identifier hs-var">caseFun</span></a></span></span><span>
</span><span id="line-1104"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_tup :: forall a. FFoldType a -&gt; TupleSort -&gt; [a] -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_tup"><span class="hs-identifier hs-var">ft_tup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108074"><span class="annot"><span class="annottext">TupleSort -&gt; [a] -&gt; a
</span><a href="#local-6989586621679108074"><span class="hs-identifier hs-var">caseTuple</span></a></span></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">ft_ty_app :: forall a. FFoldType a -&gt; [(Type, a)] -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_ty_app"><span class="hs-identifier hs-var">ft_ty_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108075"><span class="annot"><span class="annottext">[(Type, a)] -&gt; a
</span><a href="#local-6989586621679108075"><span class="hs-identifier hs-var">caseTyApp</span></a></span></span><span>
</span><span id="line-1105"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_bad_app :: forall a. FFoldType a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_bad_app"><span class="hs-identifier hs-var">ft_bad_app</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108076"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108076"><span class="hs-identifier hs-var">caseWrongArg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ft_forall :: forall a. FFoldType a -&gt; [TyVarBndrSpec] -&gt; a -&gt; a
</span><a href="Data.Bifunctor.TH.html#ft_forall"><span class="hs-identifier hs-var">ft_forall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679108077"><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; a -&gt; a
</span><a href="#local-6989586621679108077"><span class="hs-identifier hs-var">caseForAll</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>                    </span><span id="local-6989586621679108078"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108078"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1107"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679108079"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108079"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108078"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1108"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679108080"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108080"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108079"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1109"></span><span>       </span><span class="annot"><span class="annottext">a -&gt; Q a
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108080"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1110"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1111"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- Covariant or contravariant context</span><span>
</span><span id="line-1112"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-1113"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (result of type a, does type contain var)</span><span>
</span><span id="line-1114"></span><span>    </span><span id="local-6989586621679108081"><span class="annot"><span class="annottext">go :: Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679108082"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108082"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679108083"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679108083"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-1115"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679108085"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108085"><span class="hs-identifier hs-var">funArg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108086"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108086"><span class="hs-identifier hs-var">funRes</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [Type])
</span><a href="Data.Bifunctor.TH.Internal.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108083"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1116"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679108088"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108088"><span class="hs-identifier hs-var">funArgR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108089"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108089"><span class="hs-identifier hs-var">funArgC</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108082"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108085"><span class="hs-identifier hs-var">funArg</span></a></span><span>
</span><span id="line-1117"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621679108090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108090"><span class="hs-identifier hs-var">funResR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108091"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108091"><span class="hs-identifier hs-var">funResC</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108082"><span class="hs-identifier hs-var">co</span></a></span><span>  </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108086"><span class="hs-identifier hs-var">funRes</span></a></span><span>
</span><span id="line-1118"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108089"><span class="hs-identifier hs-var">funArgC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108091"><span class="hs-identifier hs-var">funResC</span></a></span><span>
</span><span id="line-1119"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679108073"><span class="hs-identifier hs-var">caseFun</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108088"><span class="hs-identifier hs-var">funArgR</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108090"><span class="hs-identifier hs-var">funResR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1120"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var">trivial</span></a></span><span>
</span><span id="line-1121"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679108093"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108093"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679108094"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679108094"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1122"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679108095"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108095"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108096"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [Type])
</span><a href="Data.Bifunctor.TH.Internal.html#unapplyTy"><span class="hs-identifier hs-var">unapplyTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108094"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1123"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>   </span><span id="local-6989586621679108097"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108097"><span class="hs-identifier hs-var">fc</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108093"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108095"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1124"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679108098"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679108098"><span class="hs-identifier hs-var">xrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108099"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108099"><span class="hs-identifier hs-var">xcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(a, Bool)] -&gt; ([a], [Bool])) -&gt; Q [(a, Bool)] -&gt; Q ([a], [Bool])
forall a b. (a -&gt; b) -&gt; Q a -&gt; Q b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[(a, Bool)] -&gt; ([a], [Bool])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">(Q [(a, Bool)] -&gt; Q ([a], [Bool]))
-&gt; Q [(a, Bool)] -&gt; Q ([a], [Bool])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q (a, Bool)) -&gt; [Type] -&gt; Q [(a, Bool)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108093"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1125"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679108100"><span class="hs-identifier hs-type">numLastArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679108101"><span class="hs-identifier hs-type">numFirstArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1126"></span><span>          </span><span id="local-6989586621679108100"><span class="annot"><span class="annottext">numLastArgs :: Int
</span><a href="#local-6989586621679108100"><span class="hs-identifier hs-var hs-var">numLastArgs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1127"></span><span>          </span><span id="local-6989586621679108101"><span class="annot"><span class="annottext">numFirstArgs :: Int
</span><a href="#local-6989586621679108101"><span class="hs-identifier hs-var hs-var">numFirstArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108100"><span class="hs-identifier hs-var">numLastArgs</span></a></span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span>          </span><span class="annot"><a href="#local-6989586621679108103"><span class="hs-identifier hs-type">tuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>          </span><span id="local-6989586621679108103"><span class="annot"><span class="annottext">tuple :: TupleSort -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108103"><span class="hs-identifier hs-var hs-var">tuple</span></a></span></span><span> </span><span id="local-6989586621679108104"><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679108104"><span class="hs-identifier hs-var">tupSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TupleSort -&gt; [a] -&gt; a
</span><a href="#local-6989586621679108074"><span class="hs-identifier hs-var">caseTuple</span></a></span><span> </span><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679108104"><span class="hs-identifier hs-var">tupSort</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679108098"><span class="hs-identifier hs-var">xrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span>          </span><span class="annot"><a href="#local-6989586621679108105"><span class="hs-identifier hs-type">wrongArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>          </span><span id="local-6989586621679108105"><span class="annot"><span class="annottext">wrongArg :: Q (a, Bool)
</span><a href="#local-6989586621679108105"><span class="hs-identifier hs-var hs-var">wrongArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108076"><span class="hs-identifier hs-var">caseWrongArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1136"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108099"><span class="hs-identifier hs-var">xcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var">trivial</span></a></span><span> </span><span class="hs-comment">-- Variable does not occur</span><span>
</span><span id="line-1138"></span><span>          </span><span class="hs-comment">-- At this point we know that xrs, xcs is not empty,</span><span>
</span><span id="line-1139"></span><span>          </span><span class="hs-comment">-- and at least one xr is True</span><span>
</span><span id="line-1140"></span><span>          </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679108108"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108108"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108095"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1141"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TupleSort -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108103"><span class="hs-identifier hs-var">tuple</span></a></span><span> </span><span class="annot"><span class="annottext">(TupleSort -&gt; Q (a, Bool)) -&gt; TupleSort -&gt; Q (a, Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; TupleSort
</span><a href="Data.Bifunctor.TH.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108108"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1142"></span><span>          </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span id="local-6989586621679108111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108111"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108095"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1143"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TupleSort -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108103"><span class="hs-identifier hs-var">tuple</span></a></span><span> </span><span class="annot"><span class="annottext">(TupleSort -&gt; Q (a, Bool)) -&gt; TupleSort -&gt; Q (a, Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; TupleSort
</span><a href="Data.Bifunctor.TH.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108111"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1144"></span><span>          </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108097"><span class="hs-identifier hs-var">fc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Bool] -&gt; [Bool]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108101"><span class="hs-identifier hs-var">numFirstArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108099"><span class="hs-identifier hs-var">xcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108105"><span class="hs-identifier hs-var">wrongArg</span></a></span><span>                    </span><span class="hs-comment">-- T (..var..)    ty_1 ... ty_n</span><span>
</span><span id="line-1146"></span><span>          </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-comment">-- T (..no var..) ty_1 ... ty_n</span><span>
</span><span id="line-1147"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679108113"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108113"><span class="hs-identifier hs-var">itf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; [Type] -&gt; Q Bool
</span><a href="Data.Bifunctor.TH.Internal.html#isInTypeFamilyApp"><span class="hs-identifier hs-var">isInTypeFamilyApp</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108115"><span class="hs-identifier hs-var">tyVarNames</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108095"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1148"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108113"><span class="hs-identifier hs-var">itf</span></a></span><span> </span><span class="hs-comment">-- We can't decompose type families, so</span><span>
</span><span id="line-1149"></span><span>                       </span><span class="hs-comment">-- error if we encounter one here.</span><span>
</span><span id="line-1150"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108105"><span class="hs-identifier hs-var">wrongArg</span></a></span><span>
</span><span id="line-1151"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[(Type, a)] -&gt; a
</span><a href="#local-6989586621679108075"><span class="hs-identifier hs-var">caseTyApp</span></a></span><span> </span><span class="annot"><span class="annottext">([(Type, a)] -&gt; a) -&gt; [(Type, a)] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Type, a)] -&gt; [(Type, a)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108101"><span class="hs-identifier hs-var">numFirstArgs</span></a></span><span> </span><span class="annot"><span class="annottext">([(Type, a)] -&gt; [(Type, a)]) -&gt; [(Type, a)] -&gt; [(Type, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [a] -&gt; [(Type, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108096"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679108098"><span class="hs-identifier hs-var">xrs</span></a></span><span>
</span><span id="line-1152"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679108116"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108116"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679108118"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108118"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679108119"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108119"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1154"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108120"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108120"><span class="hs-identifier hs-var">kc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108121"><span class="hs-identifier hs-var">go_kind</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108116"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108119"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1155"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108120"><span class="hs-identifier hs-var">kc</span></a></span><span>
</span><span id="line-1156"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108076"><span class="hs-identifier hs-var">caseWrongArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108116"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108118"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1158"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679108122"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108122"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679108124"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108124"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1159"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name Name -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108124"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679108069"><span class="hs-identifier hs-var">tvMap</span></a></span><span>
</span><span id="line-1160"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108122"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; a
</span><a href="#local-6989586621679108072"><span class="hs-identifier hs-var">caseCoVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108124"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; a
</span><a href="#local-6989586621679108071"><span class="hs-identifier hs-var">caseVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108124"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1162"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var">trivial</span></a></span><span>
</span><span id="line-1163"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679108125"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108125"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679108127"><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679108127"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679108128"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108128"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1164"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679108129"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108129"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108130"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108130"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108125"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679108128"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1165"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108131"><span class="annot"><span class="annottext">tvbNames :: [Name]
</span><a href="#local-6989586621679108131"><span class="hs-identifier hs-var hs-var">tvbNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVarBndrSpec -&gt; Name) -&gt; [TyVarBndrSpec] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndrSpec -&gt; Name
forall flag. TyVarBndr_ flag -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679108127"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1166"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108130"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108131"><span class="hs-identifier hs-var">tvbNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108115"><span class="hs-identifier hs-var">tyVarNames</span></a></span><span>
</span><span id="line-1167"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var">trivial</span></a></span><span>
</span><span id="line-1168"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndrSpec] -&gt; a -&gt; a
</span><a href="#local-6989586621679108077"><span class="hs-identifier hs-var">caseForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndrSpec]
</span><a href="#local-6989586621679108127"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108129"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>    </span><span class="annot"><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var">trivial</span></a></span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span>    </span><span class="annot"><a href="#local-6989586621679108121"><span class="hs-identifier hs-type">go_kind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1172"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span>
</span><span id="line-1173"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1174"></span><span>    </span><span id="local-6989586621679108121"><span class="annot"><span class="annottext">go_kind :: Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108121"><span class="hs-identifier hs-var hs-var">go_kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Type -&gt; Q (a, Bool)
</span><a href="#local-6989586621679108081"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-1175"></span><span>
</span><span id="line-1176"></span><span>    </span><span class="annot"><a href="#local-6989586621679108092"><span class="hs-identifier hs-type">trivial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679107204"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>    </span><span id="local-6989586621679108092"><span class="annot"><span class="annottext">trivial :: Q (a, Bool)
</span><a href="#local-6989586621679108092"><span class="hs-identifier hs-var hs-var">trivial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Bool) -&gt; Q (a, Bool)
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679108070"><span class="hs-identifier hs-var">caseTrivial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>
</span><span id="line-1179"></span><span>    </span><span class="annot"><a href="#local-6989586621679108115"><span class="hs-identifier hs-type">tyVarNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1180"></span><span>    </span><span id="local-6989586621679108115"><span class="annot"><span class="annottext">tyVarNames :: [Name]
</span><a href="#local-6989586621679108115"><span class="hs-identifier hs-var hs-var">tyVarNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; [Name]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679108069"><span class="hs-identifier hs-var">tvMap</span></a></span><span>
</span><span id="line-1181"></span><span>
</span><span id="line-1182"></span><span class="hs-comment">-- Fold over the arguments of a data constructor in a Functor-like way.</span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-type">foldDataConArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679107146"><span class="annot"><a href="#local-6989586621679107146"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.Internal.html#TyVarMap"><span class="hs-identifier hs-type">TyVarMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#FFoldType"><span class="hs-identifier hs-type">FFoldType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679107146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstructorInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679107146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1184"></span><span id="foldDataConArgs"><span class="annot"><span class="annottext">foldDataConArgs :: forall a. Map Name Name -&gt; FFoldType a -&gt; ConstructorInfo -&gt; Q [a]
</span><a href="Data.Bifunctor.TH.html#foldDataConArgs"><span class="hs-identifier hs-var hs-var">foldDataConArgs</span></a></span></span><span> </span><span id="local-6989586621679108139"><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679108139"><span class="hs-identifier hs-var">tvMap</span></a></span></span><span> </span><span id="local-6989586621679108140"><span class="annot"><span class="annottext">FFoldType a
</span><a href="#local-6989586621679108140"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span id="local-6989586621679108141"><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679108141"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1185"></span><span>  </span><span id="local-6989586621679108142"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108142"><span class="hs-identifier hs-var">fieldTys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Q Type) -&gt; [Type] -&gt; Q [Type]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Q [Type]) -&gt; [Type] -&gt; Q [Type]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo -&gt; [Type]
</span><span class="hs-identifier hs-var">constructorFields</span></span><span> </span><span class="annot"><span class="annottext">ConstructorInfo
</span><a href="#local-6989586621679108141"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1186"></span><span>  </span><span class="annot"><span class="annottext">(Type -&gt; Q a) -&gt; [Type] -&gt; Q [a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q a
</span><a href="#local-6989586621679108144"><span class="hs-identifier hs-var">foldArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679108142"><span class="hs-identifier hs-var">fieldTys</span></a></span><span>
</span><span id="line-1187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1188"></span><span>    </span><span class="annot"><a href="#local-6989586621679108144"><span class="hs-identifier hs-type">foldArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679107146"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1189"></span><span>    </span><span id="local-6989586621679108144"><span class="annot"><span class="annottext">foldArg :: Type -&gt; Q a
</span><a href="#local-6989586621679108144"><span class="hs-identifier hs-var hs-var">foldArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name Name -&gt; FFoldType a -&gt; Type -&gt; Q a
forall a. Map Name Name -&gt; FFoldType a -&gt; Type -&gt; Q a
</span><a href="Data.Bifunctor.TH.html#functorLikeTraverse"><span class="hs-identifier hs-var">functorLikeTraverse</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name Name
</span><a href="#local-6989586621679108139"><span class="hs-identifier hs-var">tvMap</span></a></span><span> </span><span class="annot"><span class="annottext">FFoldType a
</span><a href="#local-6989586621679108140"><span class="hs-identifier hs-var">ft</span></a></span><span>
</span><span id="line-1190"></span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- Make a 'LamE' using a fresh variable.</span><span>
</span><span id="line-1192"></span><span class="annot"><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-type">mkSimpleLam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1193"></span><span id="mkSimpleLam"><span class="annot"><span class="annottext">mkSimpleLam :: (Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam"><span class="hs-identifier hs-var hs-var">mkSimpleLam</span></a></span></span><span> </span><span id="local-6989586621679108145"><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679108145"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1194"></span><span>  </span><span class="hs-comment">-- Use an underscore in front of the variable name, as it's possible for</span><span>
</span><span id="line-1195"></span><span>  </span><span class="hs-comment">-- certain Bifoldable instances to generate code like this (see #89):</span><span>
</span><span id="line-1196"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1197"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1198"></span><span>  </span><span class="hs-comment">-- bifoldMap (\\_n -&gt; mempty) ...</span><span>
</span><span id="line-1199"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1200"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1201"></span><span>  </span><span class="hs-comment">-- Without the underscore, that code would trigger -Wunused-matches warnings.</span><span>
</span><span id="line-1202"></span><span>  </span><span id="local-6989586621679108146"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108146"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_n&quot;</span></span><span>
</span><span id="line-1203"></span><span>  </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108146"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
</span><a href="#local-6989586621679108145"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108146"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1204"></span><span>
</span><span id="line-1205"></span><span class="hs-comment">-- Make a 'LamE' using two fresh variables.</span><span>
</span><span id="line-1206"></span><span class="annot"><a href="Data.Bifunctor.TH.html#mkSimpleLam2"><span class="hs-identifier hs-type">mkSimpleLam2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1207"></span><span id="mkSimpleLam2"><span class="annot"><span class="annottext">mkSimpleLam2 :: (Exp -&gt; Exp -&gt; Q Exp) -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleLam2"><span class="hs-identifier hs-var hs-var">mkSimpleLam2</span></a></span></span><span> </span><span id="local-6989586621679108147"><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679108147"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1208"></span><span>  </span><span class="hs-comment">-- Use an underscore in front of the variable name, as it's possible for</span><span>
</span><span id="line-1209"></span><span>  </span><span class="hs-comment">-- certain Bifoldable instances to generate code like this (see #89):</span><span>
</span><span id="line-1210"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1211"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1212"></span><span>  </span><span class="hs-comment">-- bifoldr (\\_n1 n2 -&gt; n2) ...</span><span>
</span><span id="line-1213"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1215"></span><span>  </span><span class="hs-comment">-- Without the underscore, that code would trigger -Wunused-matches warnings.</span><span>
</span><span id="line-1216"></span><span>  </span><span id="local-6989586621679108148"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108148"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_n1&quot;</span></span><span>
</span><span id="line-1217"></span><span>  </span><span id="local-6989586621679108149"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108149"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Name
forall (m :: * -&gt; *). Quote m =&gt; String -&gt; m Name
</span><span class="hs-identifier hs-var">newName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n2&quot;</span></span><span>
</span><span id="line-1218"></span><span>  </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108148"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108149"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Q Exp -&gt; Q Exp) -&gt; Q Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Q Exp
</span><a href="#local-6989586621679108147"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108148"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108149"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1219"></span><span>
</span><span id="line-1220"></span><span class="hs-comment">-- &quot;Con a1 a2 a3 -&gt; fold [x1 a1, x2 a2, x3 a3]&quot;</span><span>
</span><span id="line-1221"></span><span class="hs-comment">--</span><span>
</span><span id="line-1222"></span><span class="hs-comment">-- @mkSimpleConMatch fold conName insides@ produces a match clause in</span><span>
</span><span id="line-1223"></span><span class="hs-comment">-- which the LHS pattern-matches on @extraPats@, followed by a match on the</span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- constructor @conName@ and its arguments. The RHS folds (with @fold@) over</span><span>
</span><span id="line-1225"></span><span class="hs-comment">-- @conName@ and its arguments, applying an expression (from @insides@) to each</span><span>
</span><span id="line-1226"></span><span class="hs-comment">-- of the respective arguments of @conName@.</span><span>
</span><span id="line-1227"></span><span id="local-6989586621679107153"><span class="annot"><a href="Data.Bifunctor.TH.html#mkSimpleConMatch"><span class="hs-identifier hs-type">mkSimpleConMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679107153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1229"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679107153"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1230"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span></span><span>
</span><span id="line-1231"></span><span id="mkSimpleConMatch"><span class="annot"><span class="annottext">mkSimpleConMatch :: forall a. (Name -&gt; [a] -&gt; Q Exp) -&gt; Name -&gt; [Exp -&gt; a] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch"><span class="hs-identifier hs-var hs-var">mkSimpleConMatch</span></a></span></span><span> </span><span id="local-6989586621679108154"><span class="annot"><span class="annottext">Name -&gt; [a] -&gt; Q Exp
</span><a href="#local-6989586621679108154"><span class="hs-identifier hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621679108155"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108155"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span id="local-6989586621679108156"><span class="annot"><span class="annottext">[Exp -&gt; a]
</span><a href="#local-6989586621679108156"><span class="hs-identifier hs-var">insides</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1232"></span><span>  </span><span id="local-6989586621679108157"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108157"><span class="hs-identifier hs-var">varsNeeded</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Q [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_arg&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Q [Name]) -&gt; Int -&gt; Q [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Exp -&gt; a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Exp -&gt; a]
</span><a href="#local-6989586621679108156"><span class="hs-identifier hs-var">insides</span></a></span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108159"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679108159"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><a href="Data.Bifunctor.TH.html#conPCompat"><span class="hs-identifier hs-var">conPCompat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108155"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; [Name] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108157"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>  </span><span id="local-6989586621679108162"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108162"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [a] -&gt; Q Exp
</span><a href="#local-6989586621679108154"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108155"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Exp -&gt; a) -&gt; Name -&gt; a) -&gt; [Exp -&gt; a] -&gt; [Name] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679108164"><span class="annot"><span class="annottext">Exp -&gt; a
</span><a href="#local-6989586621679108164"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679108165"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108165"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; a
</span><a href="#local-6989586621679108164"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; a) -&gt; Exp -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108165"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp -&gt; a]
</span><a href="#local-6989586621679108156"><span class="hs-identifier hs-var">insides</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108157"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1235"></span><span>  </span><span class="annot"><span class="annottext">Match -&gt; Q Match
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Match -&gt; Q Match) -&gt; Match -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679108159"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108162"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1236"></span><span>
</span><span id="line-1237"></span><span class="hs-comment">-- &quot;Con a1 a2 a3 -&gt; fmap (\b2 -&gt; Con a1 b2 a3) (traverse f a2)&quot;</span><span>
</span><span id="line-1238"></span><span class="hs-comment">--</span><span>
</span><span id="line-1239"></span><span class="hs-comment">-- @mkSimpleConMatch2 fold conName insides@ behaves very similarly to</span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- 'mkSimpleConMatch', with two key differences:</span><span>
</span><span id="line-1241"></span><span class="hs-comment">--</span><span>
</span><span id="line-1242"></span><span class="hs-comment">-- 1. @insides@ is a @[(Bool, Exp)]@ instead of a @[Exp]@. This is because it</span><span>
</span><span id="line-1243"></span><span class="hs-comment">--    filters out the expressions corresponding to arguments whose types do not</span><span>
</span><span id="line-1244"></span><span class="hs-comment">--    mention the last type variable in a derived 'Foldable' or 'Traversable'</span><span>
</span><span id="line-1245"></span><span class="hs-comment">--    instance (i.e., those elements of @insides@ containing @False@).</span><span>
</span><span id="line-1246"></span><span class="hs-comment">--</span><span>
</span><span id="line-1247"></span><span class="hs-comment">-- 2. @fold@ takes an expression as its first argument instead of a</span><span>
</span><span id="line-1248"></span><span class="hs-comment">--    constructor name. This is because it uses a specialized</span><span>
</span><span id="line-1249"></span><span class="hs-comment">--    constructor function expression that only takes as many parameters as</span><span>
</span><span id="line-1250"></span><span class="hs-comment">--    there are argument types that mention the last type variable.</span><span>
</span><span id="line-1251"></span><span class="annot"><a href="Data.Bifunctor.TH.html#mkSimpleConMatch2"><span class="hs-identifier hs-type">mkSimpleConMatch2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-1252"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1253"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1254"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-1255"></span><span id="mkSimpleConMatch2"><span class="annot"><span class="annottext">mkSimpleConMatch2 :: (Exp -&gt; [Exp] -&gt; Q Exp) -&gt; Name -&gt; [(Bool, Exp)] -&gt; Q Match
</span><a href="Data.Bifunctor.TH.html#mkSimpleConMatch2"><span class="hs-identifier hs-var hs-var">mkSimpleConMatch2</span></a></span></span><span> </span><span id="local-6989586621679108168"><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Q Exp
</span><a href="#local-6989586621679108168"><span class="hs-identifier hs-var">fold</span></a></span></span><span> </span><span id="local-6989586621679108169"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108169"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span id="local-6989586621679108170"><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679108170"><span class="hs-identifier hs-var">insides</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1256"></span><span>  </span><span id="local-6989586621679108171"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108171"><span class="hs-identifier hs-var">varsNeeded</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Q [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_arg&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108172"><span class="hs-identifier hs-var">lengthInsides</span></a></span><span>
</span><span id="line-1257"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108173"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679108173"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><a href="Data.Bifunctor.TH.html#conPCompat"><span class="hs-identifier hs-var">conPCompat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108169"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; [Name] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108171"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1258"></span><span>      </span><span class="hs-comment">-- Make sure to zip BEFORE invoking catMaybes. We want the variable</span><span>
</span><span id="line-1259"></span><span>      </span><span class="hs-comment">-- indices in each expression to match up with the argument indices</span><span>
</span><span id="line-1260"></span><span>      </span><span class="hs-comment">-- in conExpr (defined below).</span><span>
</span><span id="line-1261"></span><span>      </span><span id="local-6989586621679108174"><span class="annot"><span class="annottext">exps :: [Exp]
</span><a href="#local-6989586621679108174"><span class="hs-identifier hs-var hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Exp] -&gt; [Exp]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Exp] -&gt; [Exp]) -&gt; [Maybe Exp] -&gt; [Exp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Bool, Exp) -&gt; Name -&gt; Maybe Exp)
-&gt; [(Bool, Exp)] -&gt; [Name] -&gt; [Maybe Exp]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679108175"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108175"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108176"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108176"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679108177"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108177"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108175"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108176"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108177"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1262"></span><span>                                                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Exp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-1263"></span><span>                                 </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679108170"><span class="hs-identifier hs-var">insides</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108171"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span>
</span><span id="line-1264"></span><span>      </span><span class="hs-comment">-- An element of argTysTyVarInfo is True if the constructor argument</span><span>
</span><span id="line-1265"></span><span>      </span><span class="hs-comment">-- with the same index has a type which mentions the last type</span><span>
</span><span id="line-1266"></span><span>      </span><span class="hs-comment">-- variable.</span><span>
</span><span id="line-1267"></span><span>      </span><span id="local-6989586621679108178"><span class="annot"><span class="annottext">argTysTyVarInfo :: [Bool]
</span><a href="#local-6989586621679108178"><span class="hs-identifier hs-var hs-var">argTysTyVarInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Bool, Exp) -&gt; Bool) -&gt; [(Bool, Exp)] -&gt; [Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679108179"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108179"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679108179"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679108170"><span class="hs-identifier hs-var">insides</span></a></span><span>
</span><span id="line-1268"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679108180"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108180"><span class="hs-identifier hs-var">asWithTyVar</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679108181"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108181"><span class="hs-identifier hs-var">asWithoutTyVar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Name] -&gt; ([Name], [Name])
forall a. [Bool] -&gt; [a] -&gt; ([a], [a])
</span><a href="Data.Bifunctor.TH.Internal.html#partitionByList"><span class="hs-identifier hs-var">partitionByList</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108178"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108171"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span>      </span><span id="local-6989586621679108192"><span class="annot"><span class="annottext">conExpQ :: Q Exp
</span><a href="#local-6989586621679108192"><span class="hs-identifier hs-var hs-var">conExpQ</span></a></span></span><span>
</span><span id="line-1271"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108180"><span class="hs-identifier hs-var">asWithTyVar</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108169"><span class="hs-identifier hs-var">conName</span></a></span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">(Name -&gt; Q Exp) -&gt; [Name] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108181"><span class="hs-identifier hs-var">asWithoutTyVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1272"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1273"></span><span>            </span><span id="local-6989586621679108193"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108193"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Q [Name]
</span><a href="Data.Bifunctor.TH.Internal.html#newNameList"><span class="hs-identifier hs-var">newNameList</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;b&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108172"><span class="hs-identifier hs-var">lengthInsides</span></a></span><span>
</span><span id="line-1274"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108194"><span class="annot"><span class="annottext">bs' :: [Name]
</span><a href="#local-6989586621679108194"><span class="hs-identifier hs-var hs-var">bs'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Name] -&gt; [Name]
forall a. [Bool] -&gt; [a] -&gt; [a]
</span><a href="Data.Bifunctor.TH.Internal.html#filterByList"><span class="hs-identifier hs-var">filterByList</span></a></span><span>  </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108178"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108193"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1275"></span><span>                </span><span id="local-6989586621679108201"><span class="annot"><span class="annottext">vars :: [Q Exp]
</span><a href="#local-6989586621679108201"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Q Exp] -&gt; [Q Exp] -&gt; [Q Exp]
forall a. [Bool] -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Bifunctor.TH.Internal.html#filterByLists"><span class="hs-identifier hs-var">filterByLists</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621679108178"><span class="hs-identifier hs-var">argTysTyVarInfo</span></a></span><span>
</span><span id="line-1276"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Exp) -&gt; [Name] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108193"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Exp) -&gt; [Name] -&gt; [Q Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">varE</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108171"><span class="hs-identifier hs-var">varsNeeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1277"></span><span>            </span><span class="annot"><span class="annottext">[Q Pat] -&gt; Q Exp -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Pat] -&gt; m Exp -&gt; m Exp
</span><span class="hs-identifier hs-var">lamE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Q Pat) -&gt; [Name] -&gt; [Q Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Q Pat
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Pat
</span><span class="hs-identifier hs-var">varP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679108194"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Q Exp] -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; [m Exp] -&gt; m Exp
</span><span class="hs-identifier hs-var">appsE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Q Exp
forall (m :: * -&gt; *). Quote m =&gt; Name -&gt; m Exp
</span><span class="hs-identifier hs-var">conE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108169"><span class="hs-identifier hs-var">conName</span></a></span><span class="annot"><span class="annottext">Q Exp -&gt; [Q Exp] -&gt; [Q Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Q Exp]
</span><a href="#local-6989586621679108201"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1278"></span><span>
</span><span id="line-1279"></span><span>  </span><span id="local-6989586621679108203"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108203"><span class="hs-identifier hs-var">conExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679108192"><span class="hs-identifier hs-var">conExpQ</span></a></span><span>
</span><span id="line-1280"></span><span>  </span><span id="local-6989586621679108204"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108204"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Q Exp
</span><a href="#local-6989586621679108168"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108203"><span class="hs-identifier hs-var">conExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679108174"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1281"></span><span>  </span><span class="annot"><span class="annottext">Match -&gt; Q Match
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Match -&gt; Q Match) -&gt; Match -&gt; Q Match
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679108173"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108204"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1282"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1283"></span><span>    </span><span id="local-6989586621679108172"><span class="annot"><span class="annottext">lengthInsides :: Int
</span><a href="#local-6989586621679108172"><span class="hs-identifier hs-var hs-var">lengthInsides</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Bool, Exp)]
</span><a href="#local-6989586621679108170"><span class="hs-identifier hs-var">insides</span></a></span><span>
</span><span id="line-1284"></span><span>
</span><span id="line-1285"></span><span class="hs-comment">-- Indicates whether a tuple is boxed or unboxed, as well as its number of</span><span>
</span><span id="line-1286"></span><span class="hs-comment">-- arguments. For instance, (a, b) corresponds to @Boxed 2@, and (# a, b, c #)</span><span>
</span><span id="line-1287"></span><span class="hs-comment">-- corresponds to @Unboxed 3@.</span><span>
</span><span id="line-1288"></span><span class="hs-keyword">data</span><span> </span><span id="TupleSort"><span class="annot"><a href="Data.Bifunctor.TH.html#TupleSort"><span class="hs-identifier hs-var">TupleSort</span></a></span></span><span>
</span><span id="line-1289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Boxed"><span class="annot"><a href="Data.Bifunctor.TH.html#Boxed"><span class="hs-identifier hs-var">Boxed</span></a></span></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1290"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Unboxed"><span class="annot"><a href="Data.Bifunctor.TH.html#Unboxed"><span class="hs-identifier hs-var">Unboxed</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- &quot;case x of (a1,a2,a3) -&gt; fold [x1 a1, x2 a2, x3 a3]&quot;</span><span>
</span><span id="line-1293"></span><span id="local-6989586621679107150"><span class="annot"><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-type">mkSimpleTupleCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679107150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">)</span><span>
</span><span id="line-1294"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Bifunctor.TH.html#TupleSort"><span class="hs-identifier hs-type">TupleSort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679107150"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span></span><span>
</span><span id="line-1295"></span><span id="mkSimpleTupleCase"><span class="annot"><span class="annottext">mkSimpleTupleCase :: forall a.
(Name -&gt; [a] -&gt; Q Match) -&gt; TupleSort -&gt; [a] -&gt; Exp -&gt; Q Exp
</span><a href="Data.Bifunctor.TH.html#mkSimpleTupleCase"><span class="hs-identifier hs-var hs-var">mkSimpleTupleCase</span></a></span></span><span> </span><span id="local-6989586621679108208"><span class="annot"><span class="annottext">Name -&gt; [a] -&gt; Q Match
</span><a href="#local-6989586621679108208"><span class="hs-identifier hs-var">matchForCon</span></a></span></span><span> </span><span id="local-6989586621679108209"><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679108209"><span class="hs-identifier hs-var">tupSort</span></a></span></span><span> </span><span id="local-6989586621679108210"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679108210"><span class="hs-identifier hs-var">insides</span></a></span></span><span> </span><span id="local-6989586621679108211"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108211"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1296"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679108212"><span class="annot"><span class="annottext">tupDataName :: Name
</span><a href="#local-6989586621679108212"><span class="hs-identifier hs-var hs-var">tupDataName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TupleSort
</span><a href="#local-6989586621679108209"><span class="hs-identifier hs-var">tupSort</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1297"></span><span>                      </span><span class="annot"><a href="Data.Bifunctor.TH.html#Boxed"><span class="hs-identifier hs-type">Boxed</span></a></span><span>   </span><span id="local-6989586621679108213"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108213"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108213"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1298"></span><span>                      </span><span class="annot"><a href="Data.Bifunctor.TH.html#Unboxed"><span class="hs-identifier hs-type">Unboxed</span></a></span><span> </span><span id="local-6989586621679108215"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108215"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679108215"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1299"></span><span>  </span><span id="local-6989586621679108217"><span class="annot"><span class="annottext">Match
</span><a href="#local-6989586621679108217"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [a] -&gt; Q Match
</span><a href="#local-6989586621679108208"><span class="hs-identifier hs-var">matchForCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108212"><span class="hs-identifier hs-var">tupDataName</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679108210"><span class="hs-identifier hs-var">insides</span></a></span><span>
</span><span id="line-1300"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679108211"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Match
</span><a href="#local-6989586621679108217"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1301"></span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- Adapt to the type of ConP changing in template-haskell-2.18.0.0.</span><span>
</span><span id="line-1303"></span><span class="annot"><a href="Data.Bifunctor.TH.html#conPCompat"><span class="hs-identifier hs-type">conPCompat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-1304"></span><span id="conPCompat"><span class="annot"><span class="annottext">conPCompat :: Name -&gt; [Pat] -&gt; Pat
</span><a href="Data.Bifunctor.TH.html#conPCompat"><span class="hs-identifier hs-var hs-var">conPCompat</span></a></span></span><span> </span><span id="local-6989586621679108219"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108219"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679108220"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679108220"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679108219"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,18,0)
</span><span>                         </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>                         </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679108220"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1309"></span></pre></body></html>