<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables, ExplicitForAll #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, MagicHash, UnboxedTuples #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      : Data.ByteString.Builder.RealFloat.Internal</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   : (c) Lawrence Wu 2021</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  : lawrencejwu@gmail.com</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Various floating-to-string conversion helpers that are somewhat</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- floating-size agnostic</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- This module includes</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- - Efficient formatting for scientific floating-to-string</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- - Trailing zero handling when converting to decimal power base</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- - Approximations for logarithms of powers</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- - Fast-division by reciprocal multiplication</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- - Prim-op bit-wise peek</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.ByteString.Builder.RealFloat.Internal</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier">mask</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier">NonNumbersAndZero</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsNonNumbersAndZero"><span class="hs-identifier">toCharsNonNumbersAndZero</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength9"><span class="hs-identifier">decimalLength9</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength17"><span class="hs-identifier">decimalLength17</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier">Mantissa</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier">pow5bits</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2"><span class="hs-identifier">log10pow2</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5"><span class="hs-identifier">log10pow5</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5_factor"><span class="hs-identifier">pow5_factor</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier">multipleOfPowerOf5</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf2"><span class="hs-identifier">multipleOfPowerOf2</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier">acceptBounds</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier">BoundsState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimTrailing"><span class="hs-identifier">trimTrailing</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimNoTrailing"><span class="hs-identifier">trimNoTrailing</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#closestCorrectlyRounded"><span class="hs-identifier">closestCorrectlyRounded</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-identifier">toCharsScientific</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-comment">-- hand-rolled division and remainder for f2s and d2s</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier">fquot10</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem10"><span class="hs-identifier">frem10</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot5"><span class="hs-identifier">fquot5</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem5"><span class="hs-identifier">frem5</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot10"><span class="hs-identifier">dquot10</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10"><span class="hs-identifier">dquotRem10</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot5"><span class="hs-identifier">dquot5</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#drem5"><span class="hs-identifier">drem5</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot100"><span class="hs-identifier">dquot100</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">-- prim-op helpers</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-identifier">timesWord2</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Addr"><span class="hs-identifier">Addr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier">ByteArray</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Float.html#castDoubleToWord64/GHC.Float.html#castDoubleToWord64"><span class="hs-identifier">castDoubleToWord64</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Float.html#castFloatToWord32/GHC.Float.html#castFloatToWord32"><span class="hs-identifier">castFloatToWord32</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-identifier">getWord64At</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord128At"><span class="hs-identifier">getWord128At</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- monomorphic conversions</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier">boolToWord32</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord64"><span class="hs-identifier">boolToWord64</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier">int32ToInt</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier">intToInt32</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToInt"><span class="hs-identifier">word32ToInt</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToInt"><span class="hs-identifier">word64ToInt</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier">word32ToWord64</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier">word64ToWord32</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html"><span class="hs-identifier">Data.ByteString.Builder.RealFloat.TableGenerator</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Control.Monad.html#foldM/Control.Monad.html#foldM"><span class="hs-identifier">foldM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Bits.html#/Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Bits.html#Bits/GHC.Bits.html#Bits"><span class="hs-identifier">Bits</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Bits.html#FiniteBits/GHC.Bits.html#FiniteBits"><span class="hs-identifier">FiniteBits</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier">c2w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html"><span class="hs-identifier">Data.ByteString.Builder.Prim.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-identifier">BoundedPrim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#boundedPrim"><span class="hs-identifier">boundedPrim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html"><span class="hs-identifier">Data.ByteString.Builder.RealFloat.TableGenerator</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Data.Char.html#/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier">ord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#/GHC.Int.html"><span class="hs-identifier">GHC.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier">Int</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier">Int32</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#/GHC.Prim.html"><span class="hs-identifier">GHC.Prim</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#/GHC.Ptr.html"><span class="hs-identifier">GHC.Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier">Ptr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#plusPtr/GHC.Ptr.html#plusPtr"><span class="hs-identifier">plusPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.ST.html#/GHC.ST.html"><span class="hs-identifier">GHC.ST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.ST.html#ST/GHC.ST.html#ST"><span class="hs-identifier">ST</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.ST.html#runST/GHC.ST.html#runST"><span class="hs-identifier">runST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#/GHC.Types.html"><span class="hs-identifier">GHC.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#isTrue%23/GHC.Types.html#isTrue%23"><span class="hs-identifier">isTrue#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#/GHC.Word.html"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier">Word32</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.Storable.html#/Foreign.Storable.html"><span class="hs-identifier">Foreign.Storable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/Foreign.Storable.html#poke/Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#include &lt;ghcautoconf.h&gt;
</span><span class="hs-cpp">#include &quot;MachDeps.h&quot;
</span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &lt; 64 &amp;&amp; !MIN_VERSION_ghc_prim(0,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.IntWord64</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 804
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Float.html#/GHC.Float.html"><span class="hs-identifier">GHC.Float</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Float.html#castFloatToWord32/GHC.Float.html#castFloatToWord32"><span class="hs-identifier">castFloatToWord32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Float.html#castDoubleToWord64/GHC.Float.html#castDoubleToWord64"><span class="hs-identifier">castDoubleToWord64</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Marshal.Utils</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">with</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.Storable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peek</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Interpret a 'Float' as a 'Word32' as if through a bit-for-bit copy.</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- (fallback if not available through GHC.Float)</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- e.g</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt; showHex (castFloatToWord32 1.0) [] = &quot;3f800000&quot;</span><span>
</span><span id="line-107"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">castFloatToWord32</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-108"></span><span class="hs-identifier">castFloatToWord32</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Float</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word32</span><span>
</span><span id="line-109"></span><span class="hs-identifier">castFloatToWord32</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peek</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">castPtr</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Interpret a 'Double' as a 'Word64' as if through a bit-for-bit copy.</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- (fallback if not available through GHC.Float)</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- e.g</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt; showHex (castDoubleToWord64 1.0) [] = &quot;3ff0000000000000&quot;</span><span>
</span><span id="line-117"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">castDoubleToWord64</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-118"></span><span class="hs-identifier">castDoubleToWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64</span><span>
</span><span id="line-119"></span><span class="hs-identifier">castDoubleToWord64</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">with</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peek</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">castPtr</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Build a full bit-mask of specified length.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- e.g</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- &gt; showHex (mask 12) [] = &quot;fff&quot;</span><span>
</span><span id="line-127"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-pragma hs-type">mask</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-128"></span><span id="local-6989586621679097519"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-type">mask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Bits.html#Bits/GHC.Bits.html#Bits"><span class="hs-identifier hs-type">Bits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Real.html#Integral/GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097519"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-129"></span><span id="mask"><span class="annot"><span class="annottext">mask :: forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; a -&gt; a -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#flip/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Int -&gt; a) -&gt; Int -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftL/GHC.Bits.html#unsafeShiftL"><span class="hs-identifier hs-var">unsafeShiftL</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">-- | Convert boolean false to 0 and true to 1</span></span><span>
</span><span id="line-132"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-pragma hs-type">boolToWord32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-133"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier hs-type">boolToWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-134"></span><span id="boolToWord32"><span class="annot"><span class="annottext">boolToWord32 :: Bool -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier hs-var hs-var">boolToWord32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; (Bool -&gt; Int) -&gt; Bool -&gt; Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Enum.html#fromEnum/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><span class="hs-comment">-- | Convert boolean false to 0 and true to 1</span></span><span>
</span><span id="line-137"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord64"><span class="hs-pragma hs-type">boolToWord64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord64"><span class="hs-identifier hs-type">boolToWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-139"></span><span id="boolToWord64"><span class="annot"><span class="annottext">boolToWord64 :: Bool -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord64"><span class="hs-identifier hs-var hs-var">boolToWord64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word64) -&gt; (Bool -&gt; Int) -&gt; Bool -&gt; Word64
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Enum.html#fromEnum/GHC.Enum.html#fromEnum"><span class="hs-identifier hs-var">fromEnum</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Int32 -&gt; Int@</span></span><span>
</span><span id="line-142"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-pragma hs-type">int32ToInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-143"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier hs-type">int32ToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-144"></span><span id="int32ToInt"><span class="annot"><span class="annottext">int32ToInt :: Int32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier hs-var hs-var">int32ToInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Int -&gt; Int32@</span></span><span>
</span><span id="line-147"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-pragma hs-type">intToInt32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-148"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-type">intToInt32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span>
</span><span id="line-149"></span><span id="intToInt32"><span class="annot"><span class="annottext">intToInt32 :: Int -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-var hs-var">intToInt32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Word32 -&gt; Int@</span></span><span>
</span><span id="line-152"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToInt"><span class="hs-pragma hs-type">word32ToInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToInt"><span class="hs-identifier hs-type">word32ToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-154"></span><span id="word32ToInt"><span class="annot"><span class="annottext">word32ToInt :: Word32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToInt"><span class="hs-identifier hs-var hs-var">word32ToInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Word64 -&gt; Int@</span></span><span>
</span><span id="line-157"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToInt"><span class="hs-pragma hs-type">word64ToInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToInt"><span class="hs-identifier hs-type">word64ToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-159"></span><span id="word64ToInt"><span class="annot"><span class="annottext">word64ToInt :: Word64 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToInt"><span class="hs-identifier hs-var hs-var">word64ToInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Word32 -&gt; Word64@</span></span><span>
</span><span id="line-162"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-pragma hs-type">word32ToWord64</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-type">word32ToWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-164"></span><span id="word32ToWord64"><span class="annot"><span class="annottext">word32ToWord64 :: Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var hs-var">word32ToWord64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Monomorphic conversion for @Word64 -&gt; Word32@</span></span><span>
</span><span id="line-167"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-pragma hs-type">word64ToWord32</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-168"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-type">word64ToWord32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-169"></span><span id="word64ToWord32"><span class="annot"><span class="annottext">word64ToWord32 :: Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var hs-var">word64ToWord32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Returns the number of decimal digits in v, which must not contain more than 9 digits.</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength9"><span class="hs-identifier hs-type">decimalLength9</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-174"></span><span id="decimalLength9"><span class="annot"><span class="annottext">decimalLength9 :: Word32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength9"><span class="hs-identifier hs-var hs-var">decimalLength9</span></a></span></span><span> </span><span id="local-6989586621679097806"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">100000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">100000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097806"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="annot"><span class="hs-comment">-- | Returns the number of decimal digits in v, which must not contain more than 17 digits.</span></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength17"><span class="hs-identifier hs-type">decimalLength17</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-187"></span><span id="decimalLength17"><span class="annot"><span class="annottext">decimalLength17 :: Word64 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength17"><span class="hs-identifier hs-var hs-var">decimalLength17</span></a></span></span><span> </span><span id="local-6989586621679097807"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000000000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000000000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100000000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">14</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">13</span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097807"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- From 'In-and-Out Conversions' https://dl.acm.org/citation.cfm?id=362887, we</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- have that a conversion from a base-b n-digit number to a base-v m-digit</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- number such that the round-trip conversion is identity requires</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">--    v^(m-1) &gt; b^n</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- Specifically for binary floating point to decimal conversion, we must have</span><span>
</span><span id="line-213"></span><span class="hs-comment">--</span><span>
</span><span id="line-214"></span><span class="hs-comment">--    10^(m-1) &gt; 2^n</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- =&gt; log(10^(m-1)) &gt; log(2^n)</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- =&gt; (m-1) * log(10) &gt; n * log(2)</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- =&gt; m-1 &gt; n * log(2) / log(10)</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- =&gt; m-1 &gt;= ceil(n * log(2) / log(10))</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- =&gt; m &gt;= ceil(n * log(2) / log(10)) + 1</span><span>
</span><span id="line-220"></span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- And since 32 and 64-bit floats have 23 and 52 bits of mantissa (and then an</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- implicit leading-bit), we need</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">--    ceil(24 * log(2) / log(10)) + 1 =&gt; 9</span><span>
</span><span id="line-225"></span><span class="hs-comment">--    ceil(53 * log(2) / log(10)) + 1 =&gt; 17</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- In addition, the exponent range from floats is [-45,38] and doubles is</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- [-324,308] (including subnormals) which are 3 and 4 digits respectively</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Thus we have,</span><span>
</span><span id="line-231"></span><span class="hs-comment">--</span><span>
</span><span id="line-232"></span><span class="hs-comment">--    floats: 1 (sign) + 9 (mantissa) + 1 (.) + 1 (e) + 3 (exponent) = 15</span><span>
</span><span id="line-233"></span><span class="hs-comment">--    doubles: 1 (sign) + 17 (mantissa) + 1 (.) + 1 (e) + 4 (exponent) = 24</span><span>
</span><span id="line-234"></span><span class="hs-comment">--</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#maxEncodedLength"><span class="hs-identifier hs-type">maxEncodedLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-236"></span><span id="maxEncodedLength"><span class="annot"><span class="annottext">maxEncodedLength :: Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#maxEncodedLength"><span class="hs-identifier hs-var hs-var">maxEncodedLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Storable.poke a String into a Ptr Word8, converting through c2w</span></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pokeAll"><span class="hs-identifier hs-type">pokeAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#IO/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word8/GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span id="pokeAll"><span class="annot"><span class="annottext">pokeAll :: String -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pokeAll"><span class="hs-identifier hs-var hs-var">pokeAll</span></a></span></span><span> </span><span id="local-6989586621679097810"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097810"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679097811"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679097811"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; Char -&gt; IO (Ptr Word8))
-&gt; Ptr Word8 -&gt; String -&gt; IO (Ptr Word8)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="../../base-4.18.2.1/src/Control.Monad.html#foldM/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Char -&gt; IO (Ptr Word8)
forall {b}. Ptr Word8 -&gt; Char -&gt; IO (Ptr b)
</span><a href="#local-6989586621679097812"><span class="hs-identifier hs-var">pokeOne</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679097811"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097810"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679097812"><span class="annot"><span class="annottext">pokeOne :: Ptr Word8 -&gt; Char -&gt; IO (Ptr b)
</span><a href="#local-6989586621679097812"><span class="hs-identifier hs-var hs-var">pokeOne</span></a></span></span><span> </span><span id="local-6989586621679097817"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679097817"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679097818"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679097818"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><a href="../../base-4.18.2.1/src/Foreign.Storable.html#poke/Foreign.Storable.html#poke"><span class="hs-identifier hs-var">S.poke</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679097817"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679097818"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Ptr b) -&gt; IO (Ptr b)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%3E%3E/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr b -&gt; IO (Ptr b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679097817"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="../../base-4.18.2.1/src/GHC.Ptr.html#plusPtr/GHC.Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Unsafe creation of a bounded primitive of String at most length</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- `maxEncodedLength`</span><span>
</span><span id="line-245"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boundString"><span class="hs-identifier hs-type">boundString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-identifier hs-type">BoundedPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="boundString"><span class="annot"><span class="annottext">boundString :: String -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boundString"><span class="hs-identifier hs-var hs-var">boundString</span></a></span></span><span> </span><span id="local-6989586621679097820"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097820"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ()
forall a.
Int -&gt; (a -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim a
</span><a href="Data.ByteString.Builder.Prim.Internal.html#boundedPrim"><span class="hs-identifier hs-var">boundedPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#maxEncodedLength"><span class="hs-identifier hs-var">maxEncodedLength</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ())
-&gt; (() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; () -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
forall a b. a -&gt; b -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#const/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pokeAll"><span class="hs-identifier hs-var">pokeAll</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097820"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Special rendering for NaN, positive\/negative 0, and positive\/negative</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- infinity. These are based on the IEEE representation of non-numbers.</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Infinity</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   * sign = 0 for positive infinity, 1 for negative infinity.</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   * biased exponent = all 1 bits.</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   * fraction = all 0 bits.</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- NaN</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">--   * sign = either 0 or 1 (ignored)</span><span>
</span><span id="line-260"></span><span class="hs-comment">--   * biased exponent = all 1 bits.</span><span>
</span><span id="line-261"></span><span class="hs-comment">--   * fraction = anything except all 0 bits.</span><span>
</span><span id="line-262"></span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- We also handle 0 specially here so that the exponent rendering is more</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- correct.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">--   * sign = either 0 or 1.</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   * biased exponent = all 0 bits.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   * fraction = all 0 bits.</span><span>
</span><span id="line-269"></span><span class="hs-keyword">data</span><span> </span><span id="NonNumbersAndZero"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-var">NonNumbersAndZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NonNumbersAndZero"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-var">NonNumbersAndZero</span></a></span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="negative"><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#negative"><span class="hs-identifier hs-var hs-var">negative</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="exponent_all_one"><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#exponent_all_one"><span class="hs-identifier hs-var hs-var">exponent_all_one</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mantissa_non_zero"><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mantissa_non_zero"><span class="hs-identifier hs-var hs-var">mantissa_non_zero</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><span class="hs-comment">-- | Renders NonNumbersAndZero into bounded primitive</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsNonNumbersAndZero"><span class="hs-identifier hs-type">toCharsNonNumbersAndZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-type">NonNumbersAndZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-identifier hs-type">BoundedPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span id="toCharsNonNumbersAndZero"><span class="annot"><span class="annottext">toCharsNonNumbersAndZero :: NonNumbersAndZero -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsNonNumbersAndZero"><span class="hs-identifier hs-var hs-var">toCharsNonNumbersAndZero</span></a></span></span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-type">NonNumbersAndZero</span></a></span><span class="hs-special">{</span><span id="local-6989586621679097826"><span id="local-6989586621679097827"><span id="local-6989586621679097828"><span class="annot"><span class="annottext">Bool
negative :: NonNumbersAndZero -&gt; Bool
exponent_all_one :: NonNumbersAndZero -&gt; Bool
mantissa_non_zero :: NonNumbersAndZero -&gt; Bool
negative :: Bool
exponent_all_one :: Bool
mantissa_non_zero :: Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#negative"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679097828"><span class="hs-identifier hs-var">mantissa_non_zero</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boundString"><span class="hs-identifier hs-var">boundString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NaN&quot;</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679097827"><span class="hs-identifier hs-var">exponent_all_one</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boundString"><span class="hs-identifier hs-var">boundString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BoundedPrim ()) -&gt; String -&gt; BoundedPrim ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">signStr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Infinity&quot;</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boundString"><span class="hs-identifier hs-var">boundString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; BoundedPrim ()) -&gt; String -&gt; BoundedPrim ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var">signStr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0.0e0&quot;</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679097829"><span class="annot"><span class="annottext">signStr :: String
</span><a href="#local-6989586621679097829"><span class="hs-identifier hs-var hs-var">signStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679097826"><span class="hs-identifier hs-var">negative</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Part of the calculation on whether to round up the decimal representation.</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- This is currently a constant function to match behavior in Base `show` and</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- is implemented as</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- acceptBounds _ = False</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-290"></span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- For round-to-even and correct shortest, use</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- acceptBounds v = ((v \`quot\` 4) .&amp;. 1) == 0</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-296"></span><span id="local-6989586621679097557"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier hs-type">acceptBounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-297"></span><span id="acceptBounds"><span class="annot"><span class="annottext">acceptBounds :: forall a. Mantissa a =&gt; a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier hs-var hs-var">acceptBounds</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#False/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- Logarithm Approximations</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- These are based on the same transformations.</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- e.g</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">--      log_2(5^e)                              goal function</span><span>
</span><span id="line-307"></span><span class="hs-comment">--    = e * log_2(5)                            log exponenation</span><span>
</span><span id="line-308"></span><span class="hs-comment">--   ~= e * floor(10^7 * log_2(5)) / 10^7       integer operations</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   ~= e * 1217359 / 2^19                      approximation into n / 2^m</span><span>
</span><span id="line-310"></span><span class="hs-comment">--</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- These are verified in the unit tests for the given input ranges</span><span>
</span><span id="line-312"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">-- | Returns e == 0 ? 1 : ceil(log_2(5^e)); requires 0 &lt;= e &lt;= 3528.</span></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bitsUnboxed"><span class="hs-identifier hs-type">pow5bitsUnboxed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span>
</span><span id="line-316"></span><span id="pow5bitsUnboxed"><span class="annot"><span class="annottext">pow5bitsUnboxed :: Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bitsUnboxed"><span class="hs-identifier hs-var hs-var">pow5bitsUnboxed</span></a></span></span><span> </span><span id="local-6989586621679097833"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097833"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2A%23/GHC.Prim.html#%2A%23"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1217359#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#uncheckedIShiftRL%23/GHC.Prim.html#uncheckedIShiftRL%23"><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">19#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><span class="hs-comment">-- | Returns floor(log_10(2^e)); requires 0 &lt;= e &lt;= 1650.</span></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2Unboxed"><span class="hs-identifier hs-type">log10pow2Unboxed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span>
</span><span id="line-320"></span><span id="log10pow2Unboxed"><span class="annot"><span class="annottext">log10pow2Unboxed :: Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2Unboxed"><span class="hs-identifier hs-var hs-var">log10pow2Unboxed</span></a></span></span><span> </span><span id="local-6989586621679097835"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097835"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097835"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2A%23/GHC.Prim.html#%2A%23"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">78913#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#uncheckedIShiftRL%23/GHC.Prim.html#uncheckedIShiftRL%23"><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">18#</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><span class="hs-comment">-- | Returns floor(log_10(5^e)); requires 0 &lt;= e &lt;= 2620.</span></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5Unboxed"><span class="hs-identifier hs-type">log10pow5Unboxed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span>
</span><span id="line-324"></span><span id="log10pow5Unboxed"><span class="annot"><span class="annottext">log10pow5Unboxed :: Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5Unboxed"><span class="hs-identifier hs-var hs-var">log10pow5Unboxed</span></a></span></span><span> </span><span id="local-6989586621679097837"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097837"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097837"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2A%23/GHC.Prim.html#%2A%23"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">732923#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#uncheckedIShiftRL%23/GHC.Prim.html#uncheckedIShiftRL%23"><span class="hs-operator hs-var">`uncheckedIShiftRL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">20#</span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><span class="hs-comment">-- | Boxed versions of the functions above</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-type">pow5bits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2"><span class="hs-identifier hs-type">log10pow2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5"><span class="hs-identifier hs-type">log10pow5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-328"></span><span id="pow5bits"><span class="annot"><span class="annottext">pow5bits :: Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-var hs-var">pow5bits</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Int#) -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#wrapped"><span class="hs-identifier hs-var">wrapped</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bitsUnboxed"><span class="hs-identifier hs-var">pow5bitsUnboxed</span></a></span><span>
</span><span id="line-329"></span><span id="log10pow2"><span class="annot"><span class="annottext">log10pow2 :: Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2"><span class="hs-identifier hs-var hs-var">log10pow2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Int#) -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#wrapped"><span class="hs-identifier hs-var">wrapped</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2Unboxed"><span class="hs-identifier hs-var">log10pow2Unboxed</span></a></span><span>
</span><span id="line-330"></span><span id="log10pow5"><span class="annot"><span class="annottext">log10pow5 :: Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5"><span class="hs-identifier hs-var hs-var">log10pow5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Int#) -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#wrapped"><span class="hs-identifier hs-var">wrapped</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5Unboxed"><span class="hs-identifier hs-var">log10pow5Unboxed</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- Fast Division</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- Division is slow. We leverage fixed-point arithmetic to calculate division</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- by a constant as multiplication by the inverse. This could potentially be</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- handled by an aggressive compiler, but to ensure that the optimization</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- happens, we hard-code the expected divisions / remainders by 5, 10, 100, etc</span><span>
</span><span id="line-339"></span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- e.g</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">--     x / 5                                      goal function</span><span>
</span><span id="line-343"></span><span class="hs-comment">--   = x * (1 / 5)                                reciprocal</span><span>
</span><span id="line-344"></span><span class="hs-comment">--   = x * (4 / 5) / 4</span><span>
</span><span id="line-345"></span><span class="hs-comment">--   = x * 0b0.110011001100.. / 4                 recurring binary representation</span><span>
</span><span id="line-346"></span><span class="hs-comment">--  ~= x * (0xCCCCCCCD / 2^32) / 4                approximation with integers</span><span>
</span><span id="line-347"></span><span class="hs-comment">--   = (x * 0xCCCCCCCD) &gt;&gt; 34</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- Look for `Reciprocal Multiplication, a tutorial` by Douglas W. Jones for a</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- more detailed explanation.</span><span>
</span><span id="line-351"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 10@</span></span><span>
</span><span id="line-354"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-type">fquot10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-355"></span><span id="fquot10"><span class="annot"><span class="annottext">fquot10 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var hs-var">fquot10</span></a></span></span><span> </span><span id="local-6989586621679097839"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097839"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var">word64ToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097839"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xCCCCCCCD</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">35</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><span class="hs-comment">-- | Returns @w % 10@</span></span><span>
</span><span id="line-358"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem10"><span class="hs-identifier hs-type">frem10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-359"></span><span id="frem10"><span class="annot"><span class="annottext">frem10 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem10"><span class="hs-identifier hs-var hs-var">frem10</span></a></span></span><span> </span><span id="local-6989586621679097842"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097842"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097842"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097842"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><span class="hs-comment">-- | Returns @(w / 10, w % 10)@</span></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10"><span class="hs-identifier hs-type">fquotRem10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span id="fquotRem10"><span class="annot"><span class="annottext">fquotRem10 :: Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10"><span class="hs-identifier hs-var hs-var">fquotRem10</span></a></span></span><span> </span><span id="local-6989586621679097844"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097845"><span class="annot"><span class="annottext">w' :: Word32
</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-365"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097845"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097844"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 100@</span></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot100"><span class="hs-identifier hs-type">fquot100</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-369"></span><span id="fquot100"><span class="annot"><span class="annottext">fquot100 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot100"><span class="hs-identifier hs-var hs-var">fquot100</span></a></span></span><span> </span><span id="local-6989586621679097847"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var">word64ToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097847"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x51EB851F</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">37</span></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><span class="hs-comment">-- | Returns @(w / 10000, w % 10000)@</span></span><span>
</span><span id="line-372"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10000"><span class="hs-identifier hs-type">fquotRem10000</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span id="fquotRem10000"><span class="annot"><span class="annottext">fquotRem10000 :: Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10000"><span class="hs-identifier hs-var hs-var">fquotRem10000</span></a></span></span><span> </span><span id="local-6989586621679097849"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097849"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097853"><span class="annot"><span class="annottext">w' :: Word32
</span><a href="#local-6989586621679097853"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var">word64ToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097849"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xD1B71759</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">45</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097853"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097849"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097853"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 5@</span></span><span>
</span><span id="line-378"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot5"><span class="hs-identifier hs-type">fquot5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-379"></span><span id="fquot5"><span class="annot"><span class="annottext">fquot5 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot5"><span class="hs-identifier hs-var hs-var">fquot5</span></a></span></span><span> </span><span id="local-6989586621679097854"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097854"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var">word64ToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097854"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xCCCCCCCD</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">34</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="annot"><span class="hs-comment">-- | Returns @w % 5@</span></span><span>
</span><span id="line-382"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem5"><span class="hs-identifier hs-type">frem5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span>
</span><span id="line-383"></span><span id="frem5"><span class="annot"><span class="annottext">frem5 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem5"><span class="hs-identifier hs-var hs-var">frem5</span></a></span></span><span> </span><span id="local-6989586621679097855"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097855"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097855"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot5"><span class="hs-identifier hs-var">fquot5</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097855"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">5</span></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 10@</span></span><span>
</span><span id="line-386"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot10"><span class="hs-identifier hs-type">dquot10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-387"></span><span id="dquot10"><span class="annot"><span class="annottext">dquot10 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot10"><span class="hs-identifier hs-var hs-var">dquot10</span></a></span></span><span> </span><span id="local-6989586621679097856"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097856"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679097858"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">rdx</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097856"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-operator hs-var">`timesWord2`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xCCCCCCCCCCCCCCCD</span></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097858"><span class="hs-identifier hs-var">rdx</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 100@</span></span><span>
</span><span id="line-392"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot100"><span class="hs-identifier hs-type">dquot100</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-393"></span><span id="dquot100"><span class="annot"><span class="annottext">dquot100 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot100"><span class="hs-identifier hs-var hs-var">dquot100</span></a></span></span><span> </span><span id="local-6989586621679097859"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679097862"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">rdx</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097859"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-operator hs-var">`timesWord2`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x28F5C28F5C28F5C3</span></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097862"><span class="hs-identifier hs-var">rdx</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Returns @(w / 10000, w % 10000)@</span></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10000"><span class="hs-identifier hs-type">dquotRem10000</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span id="dquotRem10000"><span class="annot"><span class="annottext">dquotRem10000 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10000"><span class="hs-identifier hs-var hs-var">dquotRem10000</span></a></span></span><span> </span><span id="local-6989586621679097864"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097864"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679097866"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097866"><span class="hs-identifier hs-var">rdx</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097864"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-operator hs-var">`timesWord2`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0x346DC5D63886594B</span></span><span>
</span><span id="line-401"></span><span>      </span><span id="local-6989586621679097868"><span class="annot"><span class="annottext">w' :: Word64
</span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097866"><span class="hs-identifier hs-var">rdx</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span>
</span><span id="line-402"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097864"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097868"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><span class="hs-comment">-- | Returns @(w / 10, w % 10)@</span></span><span>
</span><span id="line-405"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10"><span class="hs-identifier hs-type">dquotRem10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span id="dquotRem10"><span class="annot"><span class="annottext">dquotRem10 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10"><span class="hs-identifier hs-var hs-var">dquotRem10</span></a></span></span><span> </span><span id="local-6989586621679097869"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097869"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097870"><span class="annot"><span class="annottext">w' :: Word64
</span><a href="#local-6989586621679097870"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot10"><span class="hs-identifier hs-var">dquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097869"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-408"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097870"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097869"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097870"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><span class="hs-comment">-- | Returns @w / 5@</span></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot5"><span class="hs-identifier hs-type">dquot5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-412"></span><span id="dquot5"><span class="annot"><span class="annottext">dquot5 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot5"><span class="hs-identifier hs-var hs-var">dquot5</span></a></span></span><span> </span><span id="local-6989586621679097871"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097871"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679097873"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097873"><span class="hs-identifier hs-var">rdx</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097871"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-operator hs-var">`timesWord2`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0xCCCCCCCCCCCCCCCD</span></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097873"><span class="hs-identifier hs-var">rdx</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#unsafeShiftR/GHC.Bits.html#unsafeShiftR"><span class="hs-operator hs-var">`unsafeShiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><span class="hs-comment">-- | Returns @w % 5@</span></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#drem5"><span class="hs-identifier hs-type">drem5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-418"></span><span id="drem5"><span class="annot"><span class="annottext">drem5 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#drem5"><span class="hs-identifier hs-var hs-var">drem5</span></a></span></span><span> </span><span id="local-6989586621679097874"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097874"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097874"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot5"><span class="hs-identifier hs-var">dquot5</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097874"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">5</span></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><span class="hs-comment">-- | Returns @(w / 5, w % 5)@</span></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem5"><span class="hs-identifier hs-type">dquotRem5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span id="dquotRem5"><span class="annot"><span class="annottext">dquotRem5 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem5"><span class="hs-identifier hs-var hs-var">dquotRem5</span></a></span></span><span> </span><span id="local-6989586621679097876"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097876"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097877"><span class="annot"><span class="annottext">w' :: Word64
</span><a href="#local-6989586621679097877"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot5"><span class="hs-identifier hs-var">dquot5</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097876"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-424"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097877"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097876"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097877"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><span class="hs-comment">-- | Wrap a unboxed function on Int# into the boxed equivalent</span></span><span>
</span><span id="line-427"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#wrapped"><span class="hs-identifier hs-type">wrapped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-428"></span><span id="wrapped"><span class="annot"><span class="annottext">wrapped :: (Int# -&gt; Int#) -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#wrapped"><span class="hs-identifier hs-var hs-var">wrapped</span></a></span></span><span> </span><span id="local-6989586621679097878"><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="#local-6989586621679097878"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679097879"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097879"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int#
</span><a href="#local-6989586621679097878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097879"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if WORD_SIZE_IN_BITS == 32
</span><span class="hs-comment">-- | Packs 2 32-bit system words (hi, lo) into a Word64</span><span>
</span><span id="line-432"></span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64#</span><span>
</span><span id="line-433"></span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-identifier">hi</span><span> </span><span class="hs-identifier">lo</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">lo</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL64#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or64#</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">hi</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">hi</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL64#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or64#</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">lo</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Unpacks a Word64 into 2 32-bit words (hi, lo)</span><span>
</span><span id="line-441"></span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">Word#</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Word#</span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-442"></span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>    </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">w</span><span>
</span><span id="line-445"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftRL64#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32#</span><span class="hs-special">)</span><span class="hs-cpp">
     #)
</span><span class="hs-cpp">#else
</span><span>    </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftRL64#</span><span class="hs-special">`</span><span> </span><span class="hs-number">32#</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">w</span><span class="hs-cpp">
     #)
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Adds 2 Word64's with 32-bit addition and manual carrying</span><span>
</span><span id="line-454"></span><span class="hs-identifier">plusWord64</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word64#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word64#</span><span>
</span><span id="line-455"></span><span class="hs-identifier">plusWord64</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">x_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-identifier">x</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">y_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-identifier">y</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-identifier">lo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_l</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_l</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-identifier">carry</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">lo</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">ltWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">x_l</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-identifier">hi</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_h</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_h</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">plusWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">carry</span><span>
</span><span id="line-461"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-identifier">hi</span><span> </span><span class="hs-identifier">lo</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-464"></span><span class="annot"><span class="hs-comment">-- | Boxed version of `timesWord2#` for 64 bits</span></span><span>
</span><span id="line-465"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-identifier hs-type">timesWord2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span id="timesWord2"><span class="annot"><span class="annottext">timesWord2 :: Word64 -&gt; Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#timesWord2"><span class="hs-identifier hs-var hs-var">timesWord2</span></a></span></span><span> </span><span id="local-6989586621679097880"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097880"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679097881"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097881"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097883"><span class="annot"><span class="annottext">ra :: WORD64
</span><a href="#local-6989586621679097883"><span class="hs-identifier hs-var hs-var">ra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; WORD64
forall a. Mantissa a =&gt; a -&gt; WORD64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097880"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span id="local-6989586621679097886"><span class="annot"><span class="annottext">rb :: WORD64
</span><a href="#local-6989586621679097886"><span class="hs-identifier hs-var hs-var">rb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; WORD64
forall a. Mantissa a =&gt; a -&gt; WORD64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097881"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &gt;= 64
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 903
</span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">hi</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lo</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ra</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesWord2#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">rb</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679097887"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">hi_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679097888"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679097888"><span class="hs-identifier hs-var">lo_</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word64ToWord%23/GHC.Prim.html#word64ToWord%23"><span class="hs-identifier hs-var">word64ToWord#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097883"><span class="hs-identifier hs-var">ra</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; (# Word#, Word# #)
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#timesWord2%23/GHC.Prim.html#timesWord2%23"><span class="hs-operator hs-var">`timesWord2#`</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word64ToWord%23/GHC.Prim.html#word64ToWord%23"><span class="hs-identifier hs-var">word64ToWord#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097886"><span class="hs-identifier hs-var">rb</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span id="local-6989586621679097889"><span class="annot"><span class="annottext">hi :: WORD64
</span><a href="#local-6989586621679097889"><span class="hs-identifier hs-var hs-var">hi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord64%23/GHC.Prim.html#wordToWord64%23"><span class="hs-identifier hs-var">wordToWord64#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679097887"><span class="hs-identifier hs-var">hi_</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span id="local-6989586621679097890"><span class="annot"><span class="annottext">lo :: WORD64
</span><a href="#local-6989586621679097890"><span class="hs-identifier hs-var hs-var">lo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord64%23/GHC.Prim.html#wordToWord64%23"><span class="hs-identifier hs-var">wordToWord64#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679097888"><span class="hs-identifier hs-var">lo_</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#else
</span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">x_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">x_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-identifier">ra</span><span>
</span><span id="line-479"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">y_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">y_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-identifier">rb</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">phh_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">phh_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_h</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesWord2#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_h</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">phl_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">phl_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_h</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesWord2#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_l</span><span>
</span><span id="line-483"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">plh_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">plh_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_l</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesWord2#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_h</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">pll_h</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pll_l</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x_l</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">timesWord2#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">y_l</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-comment">--          x1 x0</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-comment">--  X       y1 y0</span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-comment">--  -------------</span><span>
</span><span id="line-489"></span><span>      </span><span class="hs-comment">--             00  LOW PART</span><span>
</span><span id="line-490"></span><span>      </span><span class="hs-comment">--  -------------</span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-comment">--          00</span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-comment">--       10 10     MIDDLE PART</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-comment">--  +       01</span><span>
</span><span id="line-494"></span><span>      </span><span class="hs-comment">--  -------------</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-comment">--       01</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-comment">--  + 11 11        HIGH PART</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-comment">--  -------------</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-identifier">phh</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-identifier">phh_h</span><span> </span><span class="hs-identifier">phh_l</span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-identifier">phl</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-identifier">phl_h</span><span> </span><span class="hs-identifier">phl_l</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">mh</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unpackWord64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">phl</span><span>
</span><span id="line-503"></span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">plusWord64</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">pll_h</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">plusWord64</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">plh_l</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-identifier">hi</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">phh</span><span>
</span><span id="line-507"></span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">plusWord64</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">mh</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-special">`</span><span class="hs-identifier">plusWord64</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">wordToWord64#</span><span> </span><span class="hs-identifier">plh_h</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span>      </span><span class="hs-identifier">lo</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">packWord64</span><span> </span><span class="hs-identifier">ml</span><span> </span><span class="hs-identifier">pll_l</span><span class="hs-cpp">
#endif
</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097889"><span class="hs-identifier hs-var">hi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097890"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><span class="hs-comment">-- | #ifdef for 64-bit word that seems to work on both 32- and 64-bit platforms</span></span><span>
</span><span id="line-515"></span><span class="hs-keyword">type</span><span> </span><span id="WORD64"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#WORD64"><span class="hs-identifier hs-var">WORD64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &lt; 64 || __GLASGOW_HASKELL__ &gt;= 903
</span><span>  </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word64%23/GHC.Prim.html#Word64%23"><span class="hs-identifier hs-type">Word64#</span></a></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">Word#</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-522"></span><span class="annot"><span class="hs-comment">-- | Returns the number of times @w@ is divisible by @5@</span></span><span>
</span><span id="line-523"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5_factor"><span class="hs-identifier hs-type">pow5_factor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#WORD64"><span class="hs-identifier hs-type">WORD64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span>
</span><span id="line-524"></span><span id="pow5_factor"><span class="annot"><span class="annottext">pow5_factor :: WORD64 -&gt; Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5_factor"><span class="hs-identifier hs-var hs-var">pow5_factor</span></a></span></span><span> </span><span id="local-6989586621679097892"><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097892"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679097893"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097893"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679097894"><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097894"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679097895"><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097895"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem5"><span class="hs-identifier hs-var">dquotRem5</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097892"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &gt;= 64 &amp;&amp; __GLASGOW_HASKELL__ &lt; 903
</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqWord#</span><span class="hs-special">`</span><span> </span><span class="hs-number">0##</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#else
</span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097895"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; WORD64 -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#eqWord64%23/GHC.Prim.html#eqWord64%23"><span class="hs-operator hs-var">`eqWord64#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord64%23/GHC.Prim.html#wordToWord64%23"><span class="hs-identifier hs-var">wordToWord64#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0##</span></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#endif
</span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097893"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5_factor"><span class="hs-identifier hs-var">pow5_factor</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097894"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097893"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="annot"><span class="hs-comment">-- | Returns @True@ if value is divisible by @5^p@</span></span><span>
</span><span id="line-535"></span><span id="local-6989586621679097561"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier hs-type">multipleOfPowerOf5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-536"></span><span id="multipleOfPowerOf5"><span class="annot"><span class="annottext">multipleOfPowerOf5 :: forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier hs-var hs-var">multipleOfPowerOf5</span></a></span></span><span> </span><span id="local-6989586621679097898"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679097898"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679097899"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097899"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#isTrue%23/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WORD64 -&gt; Int# -&gt; Int#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5_factor"><span class="hs-identifier hs-var">pow5_factor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; WORD64
forall a. Mantissa a =&gt; a -&gt; WORD64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679097898"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%3E%3D%23/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679097899"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><span class="hs-comment">-- | Returns @True@ if value is divisible by @2^p@</span></span><span>
</span><span id="line-539"></span><span id="local-6989586621679097900"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf2"><span class="hs-identifier hs-type">multipleOfPowerOf2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-540"></span><span id="multipleOfPowerOf2"><span class="annot"><span class="annottext">multipleOfPowerOf2 :: forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf2"><span class="hs-identifier hs-var hs-var">multipleOfPowerOf2</span></a></span></span><span> </span><span id="local-6989586621679097917"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679097918"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679097917"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Bits.html#.%26./GHC.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679097918"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="annot"><span class="hs-comment">-- | Wrapper for polymorphic handling of 32- and 64-bit floats</span></span><span>
</span><span id="line-543"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Bits.html#FiniteBits/GHC.Bits.html#FiniteBits"><span class="hs-identifier hs-type">FiniteBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Real.html#Integral/GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Mantissa"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-var">Mantissa</span></a></span></span><span> </span><span id="local-6989586621679097560"><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-comment">-- NB: might truncate!</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-comment">-- Use this when we know the value fits in 32-bits</span><span>
</span><span id="line-546"></span><span>  </span><span id="unsafeRaw"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-type">unsafeRaw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span id="raw"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-type">raw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#WORD64"><span class="hs-identifier hs-type">WORD64</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span>  </span><span id="decimalLength"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength"><span class="hs-identifier hs-type">decimalLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span id="boolToWord"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord"><span class="hs-identifier hs-type">boolToWord</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span id="quotRem10"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-type">quotRem10</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>  </span><span id="quot10"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-type">quot10</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span id="quot100"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-type">quot100</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span id="quotRem100"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem100"><span class="hs-identifier hs-type">quotRem100</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>  </span><span id="quotRem10000"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10000"><span class="hs-identifier hs-type">quotRem10000</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097560"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span>  </span><span id="local-6989586621679097943"><span class="annot"><span class="annottext">unsafeRaw :: Word32 -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeRaw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#W32%23/GHC.Word.html#W32%23"><span class="hs-identifier hs-type">W32#</span></a></span><span> </span><span id="local-6989586621679097945"><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word32ToWord%23/GHC.Prim.html#word32ToWord%23"><span class="hs-identifier hs-var">word32ToWord#</span></a></span><span> </span><span class="annot"><span class="annottext">Word32#
</span><a href="#local-6989586621679097945"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">unsafeRaw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W32#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">w</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if WORD_SIZE_IN_BITS &gt;= 64 &amp;&amp; __GLASGOW_HASKELL__ &lt; 903
</span><span>  </span><span class="hs-identifier">raw</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafeRaw</span><span class="hs-cpp">
#else
</span><span>  </span><span id="local-6989586621679097947"><span class="annot"><span class="annottext">raw :: Word32 -&gt; WORD64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-var hs-var hs-var hs-var">raw</span></a></span></span><span> </span><span id="local-6989586621679097948"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097948"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord64%23/GHC.Prim.html#wordToWord64%23"><span class="hs-identifier hs-var">wordToWord64#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097948"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679097949"><span class="annot"><span class="annottext">decimalLength :: Word32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength"><span class="hs-identifier hs-var hs-var hs-var hs-var">decimalLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength9"><span class="hs-identifier hs-var">decimalLength9</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621679097950"><span class="annot"><span class="annottext">boolToWord :: Bool -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord"><span class="hs-identifier hs-var hs-var hs-var hs-var">boolToWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier hs-var">boolToWord32</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-pragma hs-type">quotRem10</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679097951"><span class="annot"><span class="annottext">quotRem10 :: Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10"><span class="hs-identifier hs-var">fquotRem10</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-pragma hs-type">quot10</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-576"></span><span>  </span><span id="local-6989586621679097952"><span class="annot"><span class="annottext">quot10 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-var hs-var hs-var hs-var">quot10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-pragma hs-type">quot100</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-579"></span><span>  </span><span id="local-6989586621679097953"><span class="annot"><span class="annottext">quot100 :: Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-var hs-var hs-var hs-var">quot100</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot100"><span class="hs-identifier hs-var">fquot100</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621679097957"><span class="annot"><span class="annottext">quotRem100 :: Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem100"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem100</span></a></span></span><span> </span><span id="local-6989586621679097958"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097959"><span class="annot"><span class="annottext">w' :: Word32
</span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot100"><span class="hs-identifier hs-var">fquot100</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097958"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679097959"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679097960"><span class="annot"><span class="annottext">quotRem10000 :: Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10000"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem10000</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10000"><span class="hs-identifier hs-var">fquotRem10000</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &gt;= 64 &amp;&amp; __GLASGOW_HASKELL__ &lt; 903
</span><span>  </span><span class="hs-identifier">unsafeRaw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">W64#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">w</span><span class="hs-cpp">
#else
</span><span>  </span><span id="local-6989586621679097975"><span class="annot"><span class="annottext">unsafeRaw :: Word64 -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeRaw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679097976"><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word64ToWord%23/GHC.Prim.html#word64ToWord%23"><span class="hs-identifier hs-var">word64ToWord#</span></a></span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097976"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span id="local-6989586621679097977"><span class="annot"><span class="annottext">raw :: Word64 -&gt; WORD64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#raw"><span class="hs-identifier hs-var hs-var hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679097978"><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WORD64
</span><a href="#local-6989586621679097978"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>  </span><span id="local-6989586621679097979"><span class="annot"><span class="annottext">decimalLength :: Word64 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength"><span class="hs-identifier hs-var hs-var hs-var hs-var">decimalLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength17"><span class="hs-identifier hs-var">decimalLength17</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span id="local-6989586621679097980"><span class="annot"><span class="annottext">boolToWord :: Bool -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord"><span class="hs-identifier hs-var hs-var hs-var hs-var">boolToWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord64"><span class="hs-identifier hs-var">boolToWord64</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-pragma hs-type">quotRem10</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-599"></span><span>  </span><span id="local-6989586621679097981"><span class="annot"><span class="annottext">quotRem10 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10"><span class="hs-identifier hs-var">dquotRem10</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-pragma hs-type">quot10</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679097982"><span class="annot"><span class="annottext">quot10 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-var hs-var hs-var hs-var">quot10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot10"><span class="hs-identifier hs-var">dquot10</span></a></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-pragma hs-type">quot100</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-605"></span><span>  </span><span id="local-6989586621679097983"><span class="annot"><span class="annottext">quot100 :: Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-var hs-var hs-var hs-var">quot100</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot100"><span class="hs-identifier hs-var">dquot100</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>  </span><span id="local-6989586621679097987"><span class="annot"><span class="annottext">quotRem100 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem100"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem100</span></a></span></span><span> </span><span id="local-6989586621679097988"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097988"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679097989"><span class="annot"><span class="annottext">w' :: Word64
</span><a href="#local-6989586621679097989"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquot100"><span class="hs-identifier hs-var">dquot100</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097988"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-609"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097989"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097988"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679097989"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679097990"><span class="annot"><span class="annottext">quotRem10000 :: Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10000"><span class="hs-identifier hs-var hs-var hs-var hs-var">quotRem10000</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#dquotRem10000"><span class="hs-identifier hs-var">dquotRem10000</span></a></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | Bookkeeping state for finding the shortest, correctly-rounded</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- representation. The same trimming algorithm is similar enough for 32- and</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- 64-bit floats</span><span>
</span><span id="line-616"></span><span class="hs-keyword">data</span><span> </span><span id="BoundsState"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-var">BoundsState</span></a></span></span><span> </span><span id="local-6989586621679097567"><span class="annot"><a href="#local-6989586621679097567"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BoundsState"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-var">BoundsState</span></a></span></span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="vu"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var hs-var">vu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679097567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="vv"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679097567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="vw"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vw"><span class="hs-identifier hs-var hs-var">vw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679097567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="lastRemovedDigit"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var hs-var">lastRemovedDigit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679097567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="vuIsTrailingZeros"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var hs-var">vuIsTrailingZeros</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="vvIsTrailingZeros"><span class="annot"><span class="annottext">forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var hs-var">vvIsTrailingZeros</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span class="hs-comment">-- | Trim digits and update bookkeeping state when the table-computed</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- step results in trailing zeros (the general case, happens rarely)</span><span>
</span><span id="line-627"></span><span class="hs-comment">--</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- NB: This function isn't actually necessary so long as acceptBounds is always</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- @False@ since we don't do anything different with the trailing-zero</span><span>
</span><span id="line-630"></span><span class="hs-comment">-- information directly:</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- - vuIsTrailingZeros is always False.  We can see this by noting that in all</span><span>
</span><span id="line-632"></span><span class="hs-comment">--   places where vuTrailing can possible be True, we must have acceptBounds be</span><span>
</span><span id="line-633"></span><span class="hs-comment">--   True (accept_smaller)</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- - The final result doesn't change the lastRemovedDigit for rounding anyway</span><span>
</span><span id="line-635"></span><span id="local-6989586621679097575"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimTrailing"><span class="hs-identifier hs-type">trimTrailing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Show.html#Show/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097575"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097575"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097575"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-636"></span><span id="trimTrailing"><span class="annot"><span class="annottext">trimTrailing :: forall a.
(Show a, Mantissa a) =&gt;
BoundsState a -&gt; (BoundsState a, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimTrailing"><span class="hs-identifier hs-var hs-var">trimTrailing</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098011"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098011"><span class="hs-identifier hs-var">initial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098012"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098013"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098015"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098027"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098013"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098013"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; (BoundsState a, Int32)
forall {a} {b}.
(Mantissa a, Num b) =&gt;
BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098028"><span class="hs-identifier hs-var">trimTrailing'</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098011"><span class="hs-identifier hs-var">initial</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098041"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098015"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098015"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; Bool
forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var">vuIsTrailingZeros</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; (BoundsState a, Int32)
forall {a} {b}.
(Mantissa a, Num b) =&gt;
BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098042"><span class="hs-identifier hs-var">trimTrailing''</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098027"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>    </span><span id="local-6989586621679098012"><span class="annot"><span class="annottext">res :: BoundsState a
</span><a href="#local-6989586621679098012"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; Bool
forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#rem/GHC.Real.html#rem"><span class="hs-operator hs-var">`rem`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-641"></span><span>             </span><span class="hs-comment">-- set `{ lastRemovedDigit = 4 }` to round-even</span><span>
</span><span id="line-642"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-643"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098041"><span class="hs-identifier hs-var">d''</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>    </span><span id="local-6989586621679098028"><span class="annot"><span class="annottext">trimTrailing' :: BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098028"><span class="hs-identifier hs-var hs-var">trimTrailing'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098077"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-646"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098078"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098080"><span class="hs-identifier hs-var">vu'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-647"></span><span>         </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (BoundsState a, b) -&gt; (BoundsState a, b)
forall a b. (a -&gt; b) -&gt; (BoundsState a, a) -&gt; (BoundsState a, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BoundsState a, b) -&gt; (BoundsState a, b))
-&gt; (BoundsState a -&gt; (BoundsState a, b))
-&gt; BoundsState a
-&gt; (BoundsState a, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098028"><span class="hs-identifier hs-var">trimTrailing'</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundsState a -&gt; (BoundsState a, b))
-&gt; BoundsState a -&gt; (BoundsState a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-648"></span><span>          </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var">vu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098080"><span class="hs-identifier hs-type">vu'</span></a></span><span>
</span><span id="line-649"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098081"><span class="hs-identifier hs-type">vv'</span></a></span><span>
</span><span id="line-650"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vw"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">vw'</span></a></span><span>
</span><span id="line-651"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098082"><span class="hs-identifier hs-type">vvRem</span></a></span><span>
</span><span id="line-652"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var">vuIsTrailingZeros</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var">vuIsTrailingZeros</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098083"><span class="hs-identifier hs-type">vuRem</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-653"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-654"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-655"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-657"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098081"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098081"><span class="hs-identifier hs-var">vv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098082"><span class="hs-identifier hs-var">vvRem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098080"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098080"><span class="hs-identifier hs-var">vu'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098083"><span class="hs-identifier hs-var">vuRem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var">vu</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098078"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098078"><span class="hs-identifier hs-var">vw'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vw"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098077"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679098042"><span class="annot"><span class="annottext">trimTrailing'' :: BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098042"><span class="hs-identifier hs-var hs-var">trimTrailing''</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098132"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span></span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098133"><span class="hs-identifier hs-var">vuRem</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-663"></span><span>         </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; (BoundsState a, b) -&gt; (BoundsState a, b)
forall a b. (a -&gt; b) -&gt; (BoundsState a, a) -&gt; (BoundsState a, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#fmap/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">(+)</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BoundsState a, b) -&gt; (BoundsState a, b))
-&gt; (BoundsState a -&gt; (BoundsState a, b))
-&gt; BoundsState a
-&gt; (BoundsState a, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; (BoundsState a, b)
</span><a href="#local-6989586621679098042"><span class="hs-identifier hs-var">trimTrailing''</span></a></span><span> </span><span class="annot"><span class="annottext">(BoundsState a -&gt; (BoundsState a, b))
-&gt; BoundsState a -&gt; (BoundsState a, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-664"></span><span>          </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var">vu</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098134"><span class="hs-identifier hs-type">vu'</span></a></span><span>
</span><span id="line-665"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098135"><span class="hs-identifier hs-type">vv'</span></a></span><span>
</span><span id="line-666"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vw"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098136"><span class="hs-identifier hs-type">vw'</span></a></span><span>
</span><span id="line-667"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098137"><span class="hs-identifier hs-type">vvRem</span></a></span><span>
</span><span id="line-668"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098132"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098132"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-669"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-670"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098134"><span class="hs-identifier hs-var">vu'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098133"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098133"><span class="hs-identifier hs-var">vuRem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var">vu</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-673"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098135"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098135"><span class="hs-identifier hs-var">vv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098137"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098137"><span class="hs-identifier hs-var">vvRem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-674"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098136"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098136"><span class="hs-identifier hs-var">vw'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; a -&gt; (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vw"><span class="hs-identifier hs-var">vw</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098132"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">-- | Trim digits and update bookkeeping state when the table-computed</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- step results has no trailing zeros (common case)</span><span>
</span><span id="line-679"></span><span id="local-6989586621679097585"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimNoTrailing"><span class="hs-identifier hs-type">trimNoTrailing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-680"></span><span id="trimNoTrailing"><span class="annot"><span class="annottext">trimNoTrailing :: forall a. Mantissa a =&gt; BoundsState a -&gt; (BoundsState a, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimNoTrailing"><span class="hs-identifier hs-var hs-var">trimNoTrailing</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span id="local-6989586621679098178"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098178"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679098179"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098179"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679098180"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098180"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679098181"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">ld</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; Bool -&gt; BoundsState a
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; Bool -&gt; BoundsState a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-var">BoundsState</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098182"><span class="hs-identifier hs-var">ru'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098183"><span class="hs-identifier hs-var">rv'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">ld'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#False/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#False/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098185"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-683"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098182"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098182"><span class="hs-identifier hs-var">ru'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098183"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098183"><span class="hs-identifier hs-var">rv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098184"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098184"><span class="hs-identifier hs-var">ld'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098185"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098185"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; Int32 -&gt; (a, a, a, Int32)
forall {a} {c} {d}.
(Mantissa a, Mantissa c, Num d) =&gt;
a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var">trimNoTrailing'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098178"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098179"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098180"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098181"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span>    </span><span id="local-6989586621679098199"><span class="annot"><span class="annottext">trimNoTrailing' :: a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var hs-var">trimNoTrailing'</span></a></span></span><span> </span><span id="local-6989586621679098239"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098239"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span id="local-6989586621679098240"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098240"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679098241"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098241"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621679098242"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098242"><span class="hs-identifier hs-var">lastRemoved</span></a></span></span><span> </span><span id="local-6989586621679098243"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">count</span></a></span></span><span>
</span><span id="line-686"></span><span>      </span><span class="hs-comment">-- Loop iterations below (approximately), without div 100 optimization:</span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-comment">-- 0: 0.03%, 1: 13.8%, 2: 70.6%, 3: 14.0%, 4: 1.40%, 5: 0.14%, 6+: 0.02%</span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-comment">-- Loop iterations below (approximately), with div 100 optimization:</span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-comment">-- 0: 70.6%, 1: 27.8%, 2: 1.40%, 3: 0.14%, 4+: 0.02%</span><span>
</span><span id="line-690"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098245"><span class="hs-identifier hs-var">vu'</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-691"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var">trimNoTrailing''</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098245"><span class="hs-identifier hs-var">vu'</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098247"><span class="hs-identifier hs-var">vv'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; c
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-var">quot10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098240"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098247"><span class="hs-identifier hs-var">vv'</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2A/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-693"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var">trimNoTrailing''</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098239"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098240"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098241"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098242"><span class="hs-identifier hs-var">lastRemoved</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098243"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098244"><span class="annot"><span class="annottext">vw' :: a
</span><a href="#local-6989586621679098244"><span class="hs-identifier hs-var hs-var">vw'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-var">quot100</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098241"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-696"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098245"><span class="annot"><span class="annottext">vu' :: a
</span><a href="#local-6989586621679098245"><span class="hs-identifier hs-var hs-var">vu'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-var">quot100</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098239"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098247"><span class="annot"><span class="annottext">vv' :: c
</span><a href="#local-6989586621679098247"><span class="hs-identifier hs-var hs-var">vv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; c
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot100"><span class="hs-identifier hs-var">quot100</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098240"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621679098246"><span class="annot"><span class="annottext">trimNoTrailing'' :: a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098246"><span class="hs-identifier hs-var hs-var">trimNoTrailing''</span></a></span></span><span> </span><span id="local-6989586621679098278"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span id="local-6989586621679098279"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098279"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679098280"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098280"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621679098281"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098281"><span class="hs-identifier hs-var">lastRemoved</span></a></span></span><span> </span><span id="local-6989586621679098282"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098282"><span class="hs-identifier hs-var">count</span></a></span></span><span>
</span><span id="line-700"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098283"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098284"><span class="hs-identifier hs-var">vu'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; c -&gt; a -&gt; c -&gt; d -&gt; (a, c, c, d)
</span><a href="#local-6989586621679098199"><span class="hs-identifier hs-var">trimNoTrailing'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098284"><span class="hs-identifier hs-var">vu'</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098285"><span class="hs-identifier hs-var">vv'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098283"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098286"><span class="hs-identifier hs-var">lastRemoved'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098282"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098279"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098281"><span class="hs-identifier hs-var">lastRemoved</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679098282"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098285"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098285"><span class="hs-identifier hs-var">vv'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098286"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098286"><span class="hs-identifier hs-var">lastRemoved'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">c -&gt; (c, c)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10"><span class="hs-identifier hs-var">quotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679098279"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098284"><span class="annot"><span class="annottext">vu' :: a
</span><a href="#local-6989586621679098284"><span class="hs-identifier hs-var hs-var">vu'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-var">quot10</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098278"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-705"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679098283"><span class="annot"><span class="annottext">vw' :: a
</span><a href="#local-6989586621679098283"><span class="hs-identifier hs-var hs-var">vw'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Mantissa a =&gt; a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quot10"><span class="hs-identifier hs-var">quot10</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098280"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="hs-comment">-- | Returns the correctly rounded decimal representation mantissa based on if</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- we need to round up (next decimal place &gt;= 5) or if we are outside the</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- bounds</span><span>
</span><span id="line-710"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#closestCorrectlyRounded"><span class="hs-pragma hs-type">closestCorrectlyRounded</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-711"></span><span id="local-6989586621679097590"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#closestCorrectlyRounded"><span class="hs-identifier hs-type">closestCorrectlyRounded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097590"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-712"></span><span id="closestCorrectlyRounded"><span class="annot"><span class="annottext">closestCorrectlyRounded :: forall a. Mantissa a =&gt; Bool -&gt; BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#closestCorrectlyRounded"><span class="hs-identifier hs-var hs-var">closestCorrectlyRounded</span></a></span></span><span> </span><span id="local-6989586621679098327"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098327"><span class="hs-identifier hs-var">acceptBound</span></a></span></span><span> </span><span id="local-6989586621679098328"><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a
forall a. Mantissa a =&gt; Bool -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord"><span class="hs-identifier hs-var">boolToWord</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098329"><span class="hs-identifier hs-var">roundUp</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-714"></span><span>    </span><span id="local-6989586621679098330"><span class="annot"><span class="annottext">outsideBounds :: Bool
</span><a href="#local-6989586621679098330"><span class="hs-identifier hs-var hs-var">outsideBounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#not/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a -&gt; Bool
forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var">vuIsTrailingZeros</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#not/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098327"><span class="hs-identifier hs-var">acceptBound</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span id="local-6989586621679098329"><span class="annot"><span class="annottext">roundUp :: Bool
</span><a href="#local-6989586621679098329"><span class="hs-identifier hs-var hs-var">roundUp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vv"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vu"><span class="hs-identifier hs-var">vu</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%26%26/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098330"><span class="hs-identifier hs-var">outsideBounds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a -&gt; a
forall a. BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#lastRemovedDigit"><span class="hs-identifier hs-var">lastRemovedDigit</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState a
</span><a href="#local-6989586621679098328"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">5</span></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">-- Wrappe around int2Word#</span><span>
</span><span id="line-718"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-type">asciiRaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span>
</span><span id="line-719"></span><span id="asciiRaw"><span class="annot"><span class="annottext">asciiRaw :: Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var hs-var">asciiRaw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679098338"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098338"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#int2Word%23/GHC.Prim.html#int2Word%23"><span class="hs-identifier hs-var">int2Word#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098338"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiZero"><span class="hs-identifier hs-type">asciiZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-722"></span><span id="asciiZero"><span class="annot"><span class="annottext">asciiZero :: Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiZero"><span class="hs-identifier hs-var hs-var">asciiZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span>
</span><span id="line-723"></span><span>
</span><span id="line-724"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiDot"><span class="hs-identifier hs-type">asciiDot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-725"></span><span id="asciiDot"><span class="annot"><span class="annottext">asciiDot :: Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiDot"><span class="hs-identifier hs-var hs-var">asciiDot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiMinus"><span class="hs-identifier hs-type">asciiMinus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-728"></span><span id="asciiMinus"><span class="annot"><span class="annottext">asciiMinus :: Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiMinus"><span class="hs-identifier hs-var hs-var">asciiMinus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ascii_e"><span class="hs-identifier hs-type">ascii_e</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-731"></span><span id="ascii_e"><span class="annot"><span class="annottext">ascii_e :: Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#ascii_e"><span class="hs-identifier hs-var hs-var">ascii_e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#ord/GHC.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'e'</span></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span class="annot"><span class="hs-comment">-- | Convert a single-digit number to the ascii ordinal e.g '1' -&gt; 0x31</span></span><span>
</span><span id="line-734"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-type">toAscii</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span>
</span><span id="line-735"></span><span id="toAscii"><span class="annot"><span class="annottext">toAscii :: Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var hs-var">toAscii</span></a></span></span><span> </span><span id="local-6989586621679098344"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098344"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098344"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusWord%23/GHC.Prim.html#plusWord%23"><span class="hs-operator hs-var">`plusWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiZero"><span class="hs-identifier hs-var">asciiZero</span></a></span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="hs-keyword">data</span><span> </span><span id="Addr"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Addr"><span class="hs-identifier hs-var">Addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Addr"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Addr"><span class="hs-identifier hs-var">Addr</span></a></span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="annot"><span class="hs-comment">-- | Index into the 64-bit word lookup table provided</span></span><span>
</span><span id="line-740"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-pragma hs-type">getWord64At</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-741"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-identifier hs-type">getWord64At</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-742"></span><span id="getWord64At"><span class="annot"><span class="annottext">getWord64At :: Addr# -&gt; Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-identifier hs-var hs-var">getWord64At</span></a></span></span><span> </span><span id="local-6989586621679098346"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098346"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679098347"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098347"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>   </span><span class="hs-identifier">W64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">byteSwap64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexWord64OffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>   </span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#indexWord64OffAddr%23/GHC.Prim.html#indexWord64OffAddr%23"><span class="hs-identifier hs-var">indexWord64OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098346"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098347"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- | Index into the 128-bit word lookup table provided</span><span>
</span><span id="line-750"></span><span class="hs-comment">-- Return (# high-64-bits , low-64-bits #)</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- NB: really just swaps the bytes and doesn't reorder the words</span><span>
</span><span id="line-752"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord128At"><span class="hs-pragma hs-type">getWord128At</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-753"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord128At"><span class="hs-identifier hs-type">getWord128At</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Int/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-754"></span><span id="getWord128At"><span class="annot"><span class="annottext">getWord128At :: Addr# -&gt; Int -&gt; (Word64, Word64)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord128At"><span class="hs-identifier hs-var hs-var">getWord128At</span></a></span></span><span> </span><span id="local-6989586621679098348"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098348"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679098349"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098349"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>   </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">W64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">byteSwap64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexWord64OffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-number">2#</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">W64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">byteSwap64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">indexWord64OffAddr#</span><span> </span><span class="hs-identifier">arr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-number">2#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>   </span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#indexWord64OffAddr%23/GHC.Prim.html#indexWord64OffAddr%23"><span class="hs-identifier hs-var">indexWord64OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098348"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098349"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2A%23/GHC.Prim.html#%2A%23"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WORD64 -&gt; Word64
</span><a href="../../base-4.18.2.1/src/GHC.Word.html#W64%23/GHC.Word.html#W64%23"><span class="hs-identifier hs-var">W64#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; WORD64
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#indexWord64OffAddr%23/GHC.Prim.html#indexWord64OffAddr%23"><span class="hs-identifier hs-var">indexWord64OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098348"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098349"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2A%23/GHC.Prim.html#%2A%23"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>   </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-keyword">data</span><span> </span><span id="ByteArray"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-var">ByteArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ByteArray"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-var">ByteArray</span></a></span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#ByteArray%23/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="annot"><span class="hs-comment">-- | Packs 2 bytes [lsb, msb] into 16-bit word</span></span><span>
</span><span id="line-769"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#packWord16"><span class="hs-identifier hs-type">packWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span>
</span><span id="line-770"></span><span id="packWord16"><span class="annot"><span class="annottext">packWord16 :: Word# -&gt; Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#packWord16"><span class="hs-identifier hs-var hs-var">packWord16</span></a></span></span><span> </span><span id="local-6989586621679098352"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098352"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679098353"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098353"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">h</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">8#</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">or#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">l</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098352"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#uncheckedShiftL%23/GHC.Prim.html#uncheckedShiftL%23"><span class="hs-operator hs-var">`uncheckedShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#or%23/GHC.Prim.html#or%23"><span class="hs-operator hs-var">`or#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098353"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-777"></span><span class="annot"><span class="hs-comment">-- | Unpacks a 16-bit word into 2 bytes [lsb, msb]</span></span><span>
</span><span id="line-778"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#unpackWord16"><span class="hs-identifier hs-type">unpackWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-779"></span><span id="unpackWord16"><span class="annot"><span class="annottext">unpackWord16 :: Word# -&gt; (# Word#, Word# #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unpackWord16"><span class="hs-identifier hs-var hs-var">unpackWord16</span></a></span></span><span> </span><span id="local-6989586621679098355"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098355"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if defined(WORDS_BIGENDIAN)
</span><span>    </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">and#</span><span class="hs-special">`</span><span> </span><span class="hs-number">0xff##</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">uncheckedShiftRL#</span><span class="hs-special">`</span><span> </span><span class="hs-number">8#</span><span> </span><span class="hs-special">#)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098355"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#uncheckedShiftRL%23/GHC.Prim.html#uncheckedShiftRL%23"><span class="hs-operator hs-var">`uncheckedShiftRL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">8#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098355"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#and%23/GHC.Prim.html#and%23"><span class="hs-operator hs-var">`and#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xff##</span></span><span> </span><span class="hs-special">#)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span class="annot"><span class="hs-comment">-- | ByteArray of 2-digit pairs 00..99 for faster ascii rendering</span></span><span>
</span><span id="line-788"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-type">digit_table</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-type">ByteArray</span></a></span><span>
</span><span id="line-789"></span><span id="digit_table"><span class="annot"><span class="annottext">digit_table :: ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var hs-var">digit_table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s ByteArray) -&gt; ByteArray
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.ST.html#runST/GHC.ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STRep s ByteArray -&gt; ST s ByteArray
forall s a. STRep s a -&gt; ST s a
</span><a href="../../base-4.18.2.1/src/GHC.ST.html#ST/GHC.ST.html#ST"><span class="hs-identifier hs-var">ST</span></a></span><span> </span><span class="annot"><span class="annottext">(STRep s ByteArray -&gt; ST s ByteArray)
-&gt; STRep s ByteArray -&gt; ST s ByteArray
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679098358"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098358"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098359"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098359"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098360"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679098360"><span class="hs-identifier hs-var">marr</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; (# State# s, MutableByteArray# s #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#newByteArray%23/GHC.Prim.html#newByteArray%23"><span class="hs-identifier hs-var">newByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">200#</span></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098358"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span id="local-6989586621679098361"><span class="annot"><span class="annottext">go :: Word32
-&gt; (Int# -&gt; State# s -&gt; State# s) -&gt; Int# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679098361"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679098362"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098362"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679098363"><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679098363"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679098364"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679098365"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-792"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098366"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098366"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098367"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098367"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10"><span class="hs-identifier hs-var">fquotRem10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098362"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-793"></span><span>            </span><span id="local-6989586621679098370"><span class="annot"><span class="annottext">e' :: Word#
</span><a href="#local-6989586621679098370"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#packWord16"><span class="hs-identifier hs-var">packWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098367"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098366"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span>            </span><span id="local-6989586621679098371"><span class="annot"><span class="annottext">s' :: State# s
</span><a href="#local-6989586621679098371"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word16# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word16# -&gt; State# d -&gt; State# d
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#writeWord16Array%23/GHC.Prim.html#writeWord16Array%23"><span class="hs-identifier hs-var">writeWord16Array#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679098360"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word16#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord16%23/GHC.Prim.html#wordToWord16%23"><span class="hs-identifier hs-var">wordToWord16#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098370"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098365"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-cpp">
#else
</span><span>            </span><span class="hs-identifier">s'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">writeWord16Array#</span><span> </span><span class="hs-identifier">marr</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-identifier">s</span><span class="hs-cpp">
#endif
</span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#isTrue%23/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%3D%3D%23/GHC.Prim.html#%3D%3D%23"><span class="hs-operator hs-var">==#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">99#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098371"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679098363"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098364"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098371"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098377"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098377"><span class="hs-identifier hs-var">s3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098378"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679098378"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; State# s -&gt; (# State# s, ByteArray# #)
forall d.
MutableByteArray# d -&gt; State# d -&gt; (# State# d, ByteArray# #)
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#unsafeFreezeByteArray%23/GHC.Prim.html#unsafeFreezeByteArray%23"><span class="hs-identifier hs-var">unsafeFreezeByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679098360"><span class="hs-identifier hs-var">marr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32
 -&gt; (Int# -&gt; State# s -&gt; State# s) -&gt; Int# -&gt; State# s -&gt; State# s)
-&gt; (Int# -&gt; State# s -&gt; State# s)
-&gt; [Word32]
-&gt; Int#
-&gt; State# s
-&gt; State# s
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.1/src/Data.Foldable.html#foldr/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
-&gt; (Int# -&gt; State# s -&gt; State# s) -&gt; Int# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679098361"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679098380"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098380"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098380"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">99</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098359"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098377"><span class="hs-identifier hs-var">s3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-var">ByteArray</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679098378"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">#)</span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>
</span><span id="line-803"></span><span class="annot"><span class="hs-comment">-- | Unsafe index a ByteArray for the 16-bit word at the index</span></span><span>
</span><span id="line-804"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-identifier hs-type">unsafeAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-type">ByteArray</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span>
</span><span id="line-805"></span><span id="unsafeAt"><span class="annot"><span class="annottext">unsafeAt :: ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-identifier hs-var hs-var">unsafeAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#ByteArray"><span class="hs-identifier hs-type">ByteArray</span></a></span><span> </span><span id="local-6989586621679098382"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679098382"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679098383"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098383"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span>    </span><span class="annot"><span class="annottext">Word16# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word16ToWord%23/GHC.Prim.html#word16ToWord%23"><span class="hs-identifier hs-var">word16ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word16#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#indexWord16Array%23/GHC.Prim.html#indexWord16Array%23"><span class="hs-identifier hs-var">indexWord16Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679098382"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098383"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">indexWord16Array#</span><span> </span><span class="hs-identifier">bs</span><span> </span><span class="hs-identifier">i</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-812"></span><span class="annot"><span class="hs-comment">-- | Write a 16-bit word into the given address</span></span><span>
</span><span id="line-813"></span><span id="local-6989586621679097604"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-type">copyWord16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097604"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097604"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-814"></span><span id="copyWord16"><span class="annot"><span class="annottext">copyWord16 :: forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var hs-var">copyWord16</span></a></span></span><span> </span><span id="local-6989586621679098385"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098385"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679098386"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098386"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679098387"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098387"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span>    </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Word16# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Int# -&gt; Word16# -&gt; State# d -&gt; State# d
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#writeWord16OffAddr%23/GHC.Prim.html#writeWord16OffAddr%23"><span class="hs-identifier hs-var">writeWord16OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word16#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord16%23/GHC.Prim.html#wordToWord16%23"><span class="hs-identifier hs-var">wordToWord16#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098385"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098387"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">writeWord16OffAddr#</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-number">0#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-821"></span><span class="annot"><span class="hs-comment">-- | Write an 8-bit word into the given address</span></span><span>
</span><span id="line-822"></span><span id="local-6989586621679097606"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-type">poke</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Word%23/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097606"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097606"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-823"></span><span id="poke"><span class="annot"><span class="annottext">poke :: forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var hs-var">poke</span></a></span></span><span> </span><span id="local-6989586621679098389"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098389"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679098390"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098390"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679098391"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098391"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 902
</span><span>    </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Word8# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Int# -&gt; Word8# -&gt; State# d -&gt; State# d
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#writeWord8OffAddr%23/GHC.Prim.html#writeWord8OffAddr%23"><span class="hs-identifier hs-var">writeWord8OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098389"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word8#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#wordToWord8%23/GHC.Prim.html#wordToWord8%23"><span class="hs-identifier hs-var">wordToWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098390"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098391"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">writeWord8OffAddr#</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-number">0#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- | Write the mantissa into the given address. This function attempts to</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- optimize this by writing pairs of digits simultaneously when the mantissa is</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- large enough</span><span>
</span><span id="line-833"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeMantissa"><span class="hs-pragma hs-type">writeMantissa</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679098393"><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-pragma hs-type">Addr#</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-pragma hs-type">Int#</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-pragma hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098393"><span class="hs-pragma hs-type">d</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-pragma hs-type">Addr#</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-pragma hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098393"><span class="hs-pragma hs-type">d</span></a></span><span> </span><span class="hs-pragma">#)</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-834"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeMantissa"><span class="hs-pragma hs-type">writeMantissa</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621679098394"><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-pragma hs-type">Addr#</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-pragma hs-type">Int#</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-pragma hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098394"><span class="hs-pragma hs-type">d</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-pragma hs-type">Addr#</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-pragma hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098394"><span class="hs-pragma hs-type">d</span></a></span><span> </span><span class="hs-pragma">#)</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-835"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeMantissa"><span class="hs-identifier hs-type">writeMantissa</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679097608"><span class="annot"><a href="#local-6989586621679097608"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679097609"><span class="annot"><a href="#local-6989586621679097609"><span class="hs-identifier hs-type">d</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097608"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Int%23/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097609"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097609"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-836"></span><span id="writeMantissa"><span class="annot"><span class="annottext">writeMantissa :: forall a d.
Mantissa a =&gt;
Addr# -&gt; Int# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeMantissa"><span class="hs-identifier hs-var hs-var">writeMantissa</span></a></span></span><span> </span><span id="local-6989586621679098397"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span id="local-6989586621679098398"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098398"><span class="hs-identifier hs-var">olength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
forall {a} {d}.
Mantissa a =&gt;
Addr# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098399"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098398"><span class="hs-identifier hs-var">olength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-838"></span><span>    </span><span id="local-6989586621679098399"><span class="annot"><span class="annottext">go :: Addr# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098399"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679098425"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679098426"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span></span><span> </span><span id="local-6989586621679098427"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098427"><span class="hs-identifier hs-var">s1</span></a></span></span><span>
</span><span id="line-839"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10000</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-840"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098438"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098438"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098439"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098439"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem10000"><span class="hs-identifier hs-var">quotRem10000</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span><span>
</span><span id="line-841"></span><span>              </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098450"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098450"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098451"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098451"><span class="hs-identifier hs-var">c0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem100"><span class="hs-identifier hs-var">quotRem100</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098439"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-842"></span><span>              </span><span id="local-6989586621679098462"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098462"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word2Int%23/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098451"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">-1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098427"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-843"></span><span>              </span><span id="local-6989586621679098473"><span class="annot"><span class="annottext">s3 :: State# d
</span><a href="#local-6989586621679098473"><span class="hs-identifier hs-var hs-var">s3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word2Int%23/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098450"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">-3#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098462"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-844"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098399"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">-4#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098438"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098473"><span class="hs-identifier hs-var">s3</span></a></span><span>
</span><span id="line-845"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-846"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098484"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098484"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098485"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098485"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (a, a)
forall a. Mantissa a =&gt; a -&gt; (a, a)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#quotRem100"><span class="hs-identifier hs-var">quotRem100</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span><span>
</span><span id="line-847"></span><span>              </span><span id="local-6989586621679098496"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098496"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word2Int%23/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098485"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">-1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098427"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-848"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; State# d -&gt; (# Addr#, State# d #)
forall {a} {d}.
Mantissa a =&gt;
a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098497"><span class="hs-identifier hs-var">finalize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098484"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098496"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-849"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; State# d -&gt; (# Addr#, State# d #)
forall {a} {d}.
Mantissa a =&gt;
a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098497"><span class="hs-identifier hs-var">finalize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098426"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098427"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span id="local-6989586621679098497"><span class="annot"><span class="annottext">finalize :: a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="#local-6989586621679098497"><span class="hs-identifier hs-var hs-var">finalize</span></a></span></span><span> </span><span id="local-6989586621679098513"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">mantissa</span></a></span></span><span> </span><span id="local-6989586621679098514"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s1</span></a></span></span><span>
</span><span id="line-851"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-852"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098525"><span class="annot"><span class="annottext">bs :: Word#
</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word2Int%23/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">mantissa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>            </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098526"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">lsb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098527"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">msb</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; (# Word#, Word# #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unpackWord16"><span class="hs-identifier hs-var">unpackWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098525"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-854"></span><span>            </span><span id="local-6989586621679098528"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">lsb</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-855"></span><span>            </span><span id="local-6989586621679098529"><span class="annot"><span class="annottext">s3 :: State# d
</span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var hs-var">s3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiDot"><span class="hs-identifier hs-var">asciiDot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098528"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-856"></span><span>            </span><span id="local-6989586621679098530"><span class="annot"><span class="annottext">s4 :: State# d
</span><a href="#local-6989586621679098530"><span class="hs-identifier hs-var hs-var">s4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">msb</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098529"><span class="hs-identifier hs-var">s3</span></a></span><span>
</span><span id="line-857"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098398"><span class="hs-identifier hs-var">olength</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098530"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-858"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098398"><span class="hs-identifier hs-var">olength</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-859"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098541"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098541"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#packWord16"><span class="hs-identifier hs-var">packWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiDot"><span class="hs-identifier hs-var">asciiDot</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">mantissa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-860"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098398"><span class="hs-identifier hs-var">olength</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#%2B%23/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098541"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-861"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-862"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098542"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098542"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiZero"><span class="hs-identifier hs-var">asciiZero</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098514"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-863"></span><span>              </span><span id="local-6989586621679098543"><span class="annot"><span class="annottext">s3 :: State# d
</span><a href="#local-6989586621679098543"><span class="hs-identifier hs-var hs-var">s3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiDot"><span class="hs-identifier hs-var">asciiDot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098542"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-864"></span><span>              </span><span id="local-6989586621679098554"><span class="annot"><span class="annottext">s4 :: State# d
</span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var hs-var">s4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098513"><span class="hs-identifier hs-var">mantissa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098543"><span class="hs-identifier hs-var">s3</span></a></span><span>
</span><span id="line-865"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098397"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098554"><span class="hs-identifier hs-var">s4</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="annot"><span class="hs-comment">-- | Write the exponent into the given address.</span></span><span>
</span><span id="line-868"></span><span id="local-6989586621679097616"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeExponent"><span class="hs-identifier hs-type">writeExponent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097616"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097616"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">#)</span></span><span>
</span><span id="line-869"></span><span id="writeExponent"><span class="annot"><span class="annottext">writeExponent :: forall d. Addr# -&gt; Int32 -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeExponent"><span class="hs-identifier hs-var hs-var">writeExponent</span></a></span></span><span> </span><span id="local-6989586621679098561"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098562"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">expo</span></a></span></span><span> </span><span id="local-6989586621679098563"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">s1</span></a></span></span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-871"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679098566"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098566"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098567"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098567"><span class="hs-identifier hs-var">e0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; (Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquotRem10"><span class="hs-identifier hs-var">fquotRem10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Real.html#fromIntegral/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">expo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-872"></span><span>          </span><span id="local-6989586621679098569"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#word2Int%23/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098566"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-873"></span><span>          </span><span id="local-6989586621679098571"><span class="annot"><span class="annottext">s3 :: State# d
</span><a href="#local-6989586621679098571"><span class="hs-identifier hs-var hs-var">s3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word#
forall a. Mantissa a =&gt; a -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeRaw"><span class="hs-identifier hs-var">unsafeRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679098567"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-874"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098571"><span class="hs-identifier hs-var">s3</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-876"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098572"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098572"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Addr# -&gt; State# d -&gt; State# d
forall d. Word# -&gt; Addr# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#copyWord16"><span class="hs-identifier hs-var">copyWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#digit_table"><span class="hs-identifier hs-var">digit_table</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray -&gt; Int# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#unsafeAt"><span class="hs-operator hs-var">`unsafeAt`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098573"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-877"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098572"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-878"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098574"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098574"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toAscii"><span class="hs-identifier hs-var">toAscii</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#int2Word%23/GHC.Prim.html#int2Word%23"><span class="hs-identifier hs-var">int2Word#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098573"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098563"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-880"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098561"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098574"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-881"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679098573"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098573"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier hs-var">int32ToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098562"><span class="hs-identifier hs-var">expo</span></a></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="annot"><span class="hs-comment">-- | Write the sign into the given address.</span></span><span>
</span><span id="line-884"></span><span id="local-6989586621679097618"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeSign"><span class="hs-identifier hs-type">writeSign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097618"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#Addr%23/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#State%23/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097618"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-special">#)</span></span><span>
</span><span id="line-885"></span><span id="writeSign"><span class="annot"><span class="annottext">writeSign :: forall d. Addr# -&gt; Bool -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeSign"><span class="hs-identifier hs-var hs-var">writeSign</span></a></span></span><span> </span><span id="local-6989586621679098576"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#True/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679098577"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679098578"><span class="annot"><span class="annottext">s2 :: State# d
</span><a href="#local-6989586621679098578"><span class="hs-identifier hs-var hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# d -&gt; State# d
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiMinus"><span class="hs-identifier hs-var">asciiMinus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-887"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098578"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-888"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeSign"><span class="hs-identifier hs-var">writeSign</span></a></span><span> </span><span id="local-6989586621679098579"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098579"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#False/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679098580"><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098580"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098579"><span class="hs-identifier hs-var">ptr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">State# d
</span><a href="#local-6989586621679098580"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="hs-comment">-- | Returns the decimal representation of a floating point number in</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- scientific (exponential) notation</span><span>
</span><span id="line-892"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-pragma hs-type">toCharsScientific</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-893"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-pragma hs-type">toCharsScientific</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word32/GHC.Word.html#Word32"><span class="hs-pragma hs-type">Word32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-pragma hs-type">BoundedPrim</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-894"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-pragma hs-type">toCharsScientific</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-pragma hs-type">Bool</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Word.html#Word64/GHC.Word.html#Word64"><span class="hs-pragma hs-type">Word64</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-pragma hs-type">Int32</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-pragma hs-type">BoundedPrim</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-895"></span><span id="local-6989586621679097620"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-identifier hs-type">toCharsScientific</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#Mantissa"><span class="hs-identifier hs-type">Mantissa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#Bool/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Int.html#Int32/GHC.Int.html#Int32"><span class="hs-identifier hs-type">Int32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.Internal.html#BoundedPrim"><span class="hs-identifier hs-type">BoundedPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-896"></span><span id="toCharsScientific"><span class="annot"><span class="annottext">toCharsScientific :: forall a. Mantissa a =&gt; Bool -&gt; a -&gt; Int32 -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-identifier hs-var hs-var">toCharsScientific</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098591"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098591"><span class="hs-identifier hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098592"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098592"><span class="hs-identifier hs-var">mantissa</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098593"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098593"><span class="hs-identifier hs-var">expo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ()
forall a.
Int -&gt; (a -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim a
</span><a href="Data.ByteString.Builder.Prim.Internal.html#boundedPrim"><span class="hs-identifier hs-var">boundedPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#maxEncodedLength"><span class="hs-identifier hs-var">maxEncodedLength</span></a></span><span> </span><span class="annot"><span class="annottext">((() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ())
-&gt; (() -&gt; Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; BoundedPrim ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span id="local-6989586621679098595"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098595"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-897"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679098606"><span class="annot"><span class="annottext">olength :: Int
</span><a href="#local-6989586621679098606"><span class="hs-identifier hs-var">olength</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.10.0/src/GHC.Types.html#I%23/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679098607"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098607"><span class="hs-identifier hs-var">ol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Mantissa a =&gt; a -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#decimalLength"><span class="hs-identifier hs-var">decimalLength</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098592"><span class="hs-identifier hs-var">mantissa</span></a></span><span>
</span><span id="line-898"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679098611"><span class="annot"><span class="annottext">expo' :: Int32
</span><a href="#local-6989586621679098611"><span class="hs-identifier hs-var hs-var">expo'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098593"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#%2B/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-var">intToInt32</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679098606"><span class="hs-identifier hs-var">olength</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#-/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-899"></span><span>  </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Ptr Word8)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; Ptr Word8 -&gt; IO (Ptr Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Ptr Word8)) -&gt; Ptr Word8
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.ST.html#runST/GHC.ST.html#runST"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STRep s (Ptr Word8) -&gt; ST s (Ptr Word8)
forall s a. STRep s a -&gt; ST s a
</span><a href="../../base-4.18.2.1/src/GHC.ST.html#ST/GHC.ST.html#ST"><span class="hs-identifier hs-var">ST</span></a></span><span> </span><span class="annot"><span class="annottext">(STRep s (Ptr Word8) -&gt; ST s (Ptr Word8))
-&gt; STRep s (Ptr Word8) -&gt; ST s (Ptr Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.1/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679098612"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098612"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-900"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098613"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098613"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098614"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098614"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Bool -&gt; State# s -&gt; (# Addr#, State# s #)
forall d. Addr# -&gt; Bool -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeSign"><span class="hs-identifier hs-var">writeSign</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098595"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679098591"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098612"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-901"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098625"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098625"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098626"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098626"><span class="hs-identifier hs-var">s3</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; a -&gt; State# s -&gt; (# Addr#, State# s #)
forall a d.
Mantissa a =&gt;
Addr# -&gt; Int# -&gt; a -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeMantissa"><span class="hs-identifier hs-var">writeMantissa</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098613"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679098607"><span class="hs-identifier hs-var">ol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679098592"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098614"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-902"></span><span>        </span><span id="local-6989586621679098627"><span class="annot"><span class="annottext">s4 :: State# s
</span><a href="#local-6989586621679098627"><span class="hs-identifier hs-var hs-var">s4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Word# -&gt; State# s -&gt; State# s
forall d. Addr# -&gt; Word# -&gt; State# d -&gt; State# d
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#poke"><span class="hs-identifier hs-var">poke</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098625"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word#
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#asciiRaw"><span class="hs-identifier hs-var">asciiRaw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#ascii_e"><span class="hs-identifier hs-var">ascii_e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098626"><span class="hs-identifier hs-var">s3</span></a></span><span>
</span><span id="line-903"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098630"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098630"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098631"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098631"><span class="hs-identifier hs-var">s5</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Bool -&gt; State# s -&gt; (# Addr#, State# s #)
forall d. Addr# -&gt; Bool -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeSign"><span class="hs-identifier hs-var">writeSign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098625"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Addr#
</span><a href="../../ghc-prim-0.10.0/src/GHC.Prim.html#plusAddr%23/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-var">`plusAddr#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098611"><span class="hs-identifier hs-var">expo'</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.10.0/src/GHC.Classes.html#%3C/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098627"><span class="hs-identifier hs-var">s4</span></a></span><span>
</span><span id="line-904"></span><span>        </span><span class="hs-glyph">!</span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679098634"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098634"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098635"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098635"><span class="hs-identifier hs-var">s6</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int32 -&gt; State# s -&gt; (# Addr#, State# s #)
forall d. Addr# -&gt; Int32 -&gt; State# d -&gt; (# Addr#, State# d #)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#writeExponent"><span class="hs-identifier hs-var">writeExponent</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098630"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a
</span><a href="../../base-4.18.2.1/src/GHC.Num.html#abs/GHC.Num.html#abs"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679098611"><span class="hs-identifier hs-var">expo'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098631"><span class="hs-identifier hs-var">s5</span></a></span><span>
</span><span id="line-905"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679098635"><span class="hs-identifier hs-var">s6</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Ptr Word8
forall a. Addr# -&gt; Ptr a
</span><a href="../../base-4.18.2.1/src/GHC.Ptr.html#Ptr/GHC.Ptr.html#Ptr"><span class="hs-identifier hs-var">Ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679098634"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span class="hs-special">)</span><span>
</span><span id="line-906"></span></pre></body></html>