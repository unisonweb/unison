<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Data.ByteString.Base32.Internal</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">base32-0.4: Fast RFC 4648-compliant Base32 encoding</span><ul class="links" id="page-menu"><li><a href="src/Data.ByteString.Base32.Internal.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) 2020 Emily Pillmore</td></tr><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Emily Pillmore &lt;emilypi@cohomolo.gy&gt;</td></tr><tr><th>Stability</th><td>Experimental</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.ByteString.Base32.Internal</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Internal module defining the encoding and decoding
 processes and tables.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:encodeBase32_">encodeBase32_</a> :: <a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:encodeBase32NoPad_">encodeBase32NoPad_</a> :: <a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeBase32_">decodeBase32_</a> :: <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="../base-4.18.2.1/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>)</li><li class="src short"><a href="#v:validateBase32">validateBase32</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:validateLastNPads">validateLastNPads</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:encodeBase32_" class="def">encodeBase32_</a> :: <a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.ByteString.Base32.Internal.Head.html#encodeBase32_" class="link">Source</a> <a href="#v:encodeBase32_" class="selflink">#</a></p><div class="doc"><p>Head of the padded base32 encoding loop.</p><p>This function takes an alphabet in the form of an unboxed <code><a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a></code>,
 allocates the correct number of bytes that will be written, and
 executes the inner encoding loop against that data.</p></div></div><div class="top"><p class="src"><a id="v:encodeBase32NoPad_" class="def">encodeBase32NoPad_</a> :: <a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.ByteString.Base32.Internal.Head.html#encodeBase32NoPad_" class="link">Source</a> <a href="#v:encodeBase32NoPad_" class="selflink">#</a></p><div class="doc"><p>Head of the unpadded base32 encoding loop.</p><p>This function takes an alphabet in the form of an unboxed <code><a href="../base-4.18.2.1/GHC-Exts.html#t:Addr-35-" title="GHC.Exts">Addr#</a></code>,
 allocates the correct number of bytes that will be written, and
 executes the inner encoding loop against that data.</p></div></div><div class="top"><p class="src"><a id="v:decodeBase32_" class="def">decodeBase32_</a> :: <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> <a href="../base-4.18.2.1/Data-Word.html#t:Word8" title="Data.Word">Word8</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>) <a href="src/Data.ByteString.Base32.Internal.Head.html#decodeBase32_" class="link">Source</a> <a href="#v:decodeBase32_" class="selflink">#</a></p><div class="doc"><p>Head of the base32 decoding loop.</p><p>This function takes a base32-decoding lookup table and base32-encoded
 bytestring, allocates the correct number of bytes that will be written,
 and executes the inner decoding loop against that data.</p></div></div><div class="top"><p class="src"><a id="v:validateBase32" class="def">validateBase32</a> :: <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Data.ByteString.Base32.Internal.html#validateBase32" class="link">Source</a> <a href="#v:validateBase32" class="selflink">#</a></p><div class="doc"><p>Validate a base32-encoded bytestring against some alphabet.</p></div></div><div class="top"><p class="src"><a id="v:validateLastNPads" class="def">validateLastNPads</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>) -&gt; <a href="../base-4.18.2.1/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="../bytestring-0.11.5.3/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.ByteString.Base32.Internal.html#validateLastNPads" class="link">Source</a> <a href="#v:validateLastNPads" class="selflink">#</a></p><div class="doc"><p>This function checks that the last N-chars of a bytestring are '='
 and, if true, fails with a message or completes some io action.</p><p>This is necessary to check when decoding permissively (i.e. filling in padding chars).
 Consider the following 8 cases of a string of length l:</p><ul><li><code>l = 0 mod 8</code>: No pad chars are added, since the input is assumed to be good.</li><li><code>l = 1 mod 8</code>: Never an admissible length in base32</li><li><code>l = 2 mod 8</code>: 6 padding chars are added. If padding chars are present in the string, they will fail as to decode as final quanta</li><li><code>l = 3 mod 8</code>: Never an admissible length in base32</li><li><code>l = 4 mod 8</code>: 4 padding chars are added. If 2 padding chars are present in the string this can be &quot;completed&quot; in the sense that
              it now acts like a string `l == 2 mod 8` with 6 padding chars, and could potentially form corrupted data.</li><li><code>l = 5 mod 8</code>: 3 padding chars are added. If 3 padding chars are present in the string, this could form corrupted data like in the
              previous case.</li><li><code>l = 6 mod 8</code>: Never an admissible length in base32</li><li><code>l = 7 mod 8</code>: 1 padding char is added. If 5 padding chars are present in the string, this could form corrupted data like the
              previous cases.</li></ul><p>Hence, permissive decodes should only fill in padding chars when it makes sense to add them. That is,
 if an input is degenerate, it should never succeed when we add padding chars. We need the following invariant to hold:</p><pre>  B32.decodeUnpadded <a href="|">|</a> B32.decodePadded ~ B32.decode
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>