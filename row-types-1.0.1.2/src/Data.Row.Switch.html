<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-10"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Module: Data.Row.Switch</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- This module provides the ability to discharge a polymorphic variant using</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- a record that has matching fields.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Row.Switch</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier">AppliesTo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Row.Switch.html#switch"><span class="hs-identifier">switch</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Row.Switch.html#caseon"><span class="hs-identifier">caseon</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Row.Internal.html"><span class="hs-identifier">Data.Row.Internal</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Row.Records.html"><span class="hs-identifier">Data.Row.Records</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Row.Variants.html"><span class="hs-identifier">Data.Row.Variants</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><span class="hs-comment">-- | A simple class that we use to provide a constraint for function application.</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">class</span><span> </span><span id="AppliesTo"><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-var">AppliesTo</span></a></span></span><span> </span><span id="local-6989586621679098384"><span class="annot"><a href="#local-6989586621679098384"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098382"><span class="annot"><a href="#local-6989586621679098382"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679098383"><span class="annot"><a href="#local-6989586621679098383"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679098384"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098383"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098382"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679098382"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098384"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098383"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>  </span><span id="applyTo"><span class="annot"><a href="Data.Row.Switch.html#applyTo"><span class="hs-identifier hs-type">applyTo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098382"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098383"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098384"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098385"><span id="local-6989586621679098386"><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-type">AppliesTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098385"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098386"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098385"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098386"><span class="hs-identifier hs-type">x</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>  </span><span id="local-6989586621679098514"><span class="annot"><span class="annottext">applyTo :: (x -&gt; r) -&gt; x -&gt; r
</span><a href="Data.Row.Switch.html#applyTo"><span class="hs-identifier hs-var hs-var hs-var hs-var">applyTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(x -&gt; r) -&gt; x -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><span class="hs-comment">-- | A pair of a record and a variant.</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">data</span><span> </span><span id="SwitchData"><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-var">SwitchData</span></a></span></span><span> </span><span id="local-6989586621679098468"><span class="annot"><a href="#local-6989586621679098468"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098469"><span class="annot"><a href="#local-6989586621679098469"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SwitchData"><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-var">SwitchData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098468"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Variants.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098469"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">-- | Like 'Const' but for two ignored type arguments.</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">newtype</span><span> </span><span id="Const2"><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-var">Const2</span></a></span></span><span> </span><span id="local-6989586621679098392"><span class="annot"><a href="#local-6989586621679098392"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679098393"><span class="annot"><a href="#local-6989586621679098393"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span id="local-6989586621679098394"><span class="annot"><a href="#local-6989586621679098394"><span class="hs-identifier hs-type">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Const2"><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-var">Const2</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getConst2"><span class="annot"><span class="annottext">forall {k} {k} x (y :: k) (z :: k). Const2 x y z -&gt; x
</span><a href="Data.Row.Switch.html#getConst2"><span class="hs-identifier hs-var hs-var">getConst2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098392"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | A 'Var' and a 'Rec' can combine if their rows line up properly.</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Given a Variant along with a Record of functions from each possible value</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- of the variant to a single output type, apply the correct</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- function to the value in the variant.</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Data.Row.Switch.html#switch"><span class="hs-identifier hs-type">switch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098403"><span class="annot"><a href="#local-6989586621679098403"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679098402"><span class="annot"><a href="#local-6989586621679098402"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098404"><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Row.Internal.html#BiForall"><span class="hs-identifier hs-type">BiForall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098402"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-type">AppliesTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Row.Variants.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098402"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-51"></span><span id="switch"><span class="annot"><span class="annottext">switch :: forall (v :: Row (*)) (r :: Row (*)) x.
BiForall r v (AppliesTo x) =&gt;
Var v -&gt; Rec r -&gt; x
</span><a href="Data.Row.Switch.html#switch"><span class="hs-identifier hs-var hs-var">switch</span></a></span></span><span> </span><span id="local-6989586621679098522"><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679098522"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679098523"><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679098523"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Const2 x r v -&gt; x
forall {k} {k} x (y :: k) (z :: k). Const2 x y z -&gt; x
</span><a href="Data.Row.Switch.html#getConst2"><span class="hs-identifier hs-var">getConst2</span></a></span><span> </span><span class="annot"><span class="annottext">(Const2 x r v -&gt; x) -&gt; Const2 x r v -&gt; x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k1 k2 (r1 :: Row k1) (r2 :: Row k2)
       (c :: k1 -&gt; k2 -&gt; Constraint) (p :: * -&gt; * -&gt; *)
       (f :: Row k1 -&gt; Row k2 -&gt; *) (g :: Row k1 -&gt; Row k2 -&gt; *)
       (h :: k1 -&gt; k2 -&gt; *).
(BiForall r1 r2 c, Bifunctor p) =&gt;
Proxy (Proxy h, Proxy p)
-&gt; (f Empty Empty -&gt; g Empty Empty)
-&gt; (forall (&#8467; :: Symbol) (&#964;1 :: k1) (&#964;2 :: k2) (&#961;1 :: Row k1)
           (&#961;2 :: Row k2).
    (KnownSymbol &#8467;, c &#964;1 &#964;2, HasType &#8467; &#964;1 &#961;1, HasType &#8467; &#964;2 &#961;2) =&gt;
    Label &#8467; -&gt; f &#961;1 &#961;2 -&gt; p (f (&#961;1 .- &#8467;) (&#961;2 .- &#8467;)) (h &#964;1 &#964;2))
-&gt; (forall (&#8467; :: Symbol) (&#964;1 :: k1) (&#964;2 :: k2) (&#961;1 :: Row k1)
           (&#961;2 :: Row k2).
    (KnownSymbol &#8467;, c &#964;1 &#964;2, FrontExtends &#8467; &#964;1 &#961;1,
     FrontExtends &#8467; &#964;2 &#961;2, AllUniqueLabels (Extend &#8467; &#964;1 &#961;1),
     AllUniqueLabels (Extend &#8467; &#964;2 &#961;2)) =&gt;
    Label &#8467;
    -&gt; p (g &#961;1 &#961;2) (h &#964;1 &#964;2) -&gt; g (Extend &#8467; &#964;1 &#961;1) (Extend &#8467; &#964;2 &#961;2))
-&gt; f r1 r2
-&gt; g r1 r2
</span><a href="Data.Row.Internal.html#biMetamorph"><span class="hs-identifier hs-var">biMetamorph</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098402"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098403"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-type">AppliesTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-type">SwitchData</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-type">Const2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-type">Const2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">Proxy (Proxy (Const2 x), Proxy Either)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="annot"><span class="annottext">SwitchData Empty Empty -&gt; Const2 x Empty Empty
forall {r :: Row (*)} {a}. SwitchData r Empty -&gt; a
</span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var">doNil</span></a></span><span> </span><span class="annot"><span class="annottext">Label &#8467;
-&gt; SwitchData &#961;1 &#961;2
-&gt; Either (SwitchData (&#961;1 .- &#8467;) (&#961;2 .- &#8467;)) (Const2 x &#964;1 &#964;2)
forall (&#8467; :: Symbol) &#964;1 &#964;2 (&#961;1 :: Row (*)) (&#961;2 :: Row (*)).
(KnownSymbol &#8467;, AppliesTo x &#964;1 &#964;2, HasType &#8467; &#964;1 &#961;1,
 HasType &#8467; &#964;2 &#961;2) =&gt;
Label &#8467;
-&gt; SwitchData &#961;1 &#961;2
-&gt; Either (SwitchData (&#961;1 .- &#8467;) (&#961;2 .- &#8467;)) (Const2 x &#964;1 &#964;2)
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var">doUncons</span></a></span><span> </span><span class="annot"><span class="annottext">Label &#8467;
-&gt; Either (Const2 x &#961;1 &#961;2) (Const2 x &#964;1 &#964;2)
-&gt; Const2 x (Extend &#8467; &#964;1 &#961;1) (Extend &#8467; &#964;2 &#961;2)
forall {k} {k} {k} {k} {k} {k} {p} {x} {y :: k} {z :: k} {y :: k}
       {z :: k} {y :: k} {z :: k}.
p -&gt; Either (Const2 x y z) (Const2 x y z) -&gt; Const2 x y z
forall (&#8467; :: Symbol) &#964;1 &#964;2 (&#961;1 :: Row (*)) (&#961;2 :: Row (*)).
(KnownSymbol &#8467;, AppliesTo x &#964;1 &#964;2, FrontExtends &#8467; &#964;1 &#961;1,
 FrontExtends &#8467; &#964;2 &#961;2, AllUniqueLabels (Extend &#8467; &#964;1 &#961;1),
 AllUniqueLabels (Extend &#8467; &#964;2 &#961;2)) =&gt;
Label &#8467;
-&gt; Either (Const2 x &#961;1 &#961;2) (Const2 x &#964;1 &#964;2)
-&gt; Const2 x (Extend &#8467; &#964;1 &#961;1) (Extend &#8467; &#964;2 &#961;2)
</span><a href="#local-6989586621679098536"><span class="hs-identifier hs-var">doCons</span></a></span><span> </span><span class="annot"><span class="annottext">(SwitchData r v -&gt; Const2 x r v) -&gt; SwitchData r v -&gt; Const2 x r v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rec r -&gt; Var v -&gt; SwitchData r v
forall (r :: Row (*)) (v :: Row (*)).
Rec r -&gt; Var v -&gt; SwitchData r v
</span><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-var">SwitchData</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><a href="#local-6989586621679098523"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Var v
</span><a href="#local-6989586621679098522"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679098526"><span class="annot"><span class="annottext">doNil :: SwitchData r Empty -&gt; a
</span><a href="#local-6989586621679098526"><span class="hs-identifier hs-var hs-var">doNil</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-type">SwitchData</span></a></span><span> </span><span class="annot"><span class="annottext">Rec r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679098543"><span class="annot"><span class="annottext">Var Empty
</span><a href="#local-6989586621679098543"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var Empty -&gt; a
forall a. Var Empty -&gt; a
</span><a href="Data.Row.Variants.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Var Empty
</span><a href="#local-6989586621679098543"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="#local-6989586621679098527"><span class="hs-identifier hs-type">doUncons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098545"><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span></span><span> </span><span id="local-6989586621679098546"><span class="annot"><a href="#local-6989586621679098546"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679098547"><span class="annot"><a href="#local-6989586621679098547"><span class="hs-identifier hs-type">&#964;</span></a></span></span><span> </span><span id="local-6989586621679098548"><span class="annot"><a href="#local-6989586621679098548"><span class="hs-identifier hs-type">&#981;</span></a></span></span><span> </span><span id="local-6989586621679098549"><span class="annot"><a href="#local-6989586621679098549"><span class="hs-identifier hs-type">&#961;</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownSymbol</span></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-type">AppliesTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098547"><span class="hs-identifier hs-type">&#964;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Row.Internal.html#HasType"><span class="hs-identifier hs-type">HasType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098548"><span class="hs-identifier hs-type">&#981;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Row.Internal.html#HasType"><span class="hs-identifier hs-type">HasType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098547"><span class="hs-identifier hs-type">&#964;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098549"><span class="hs-identifier hs-type">&#961;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Row.Internal.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-type">SwitchData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098548"><span class="hs-identifier hs-type">&#981;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098549"><span class="hs-identifier hs-type">&#961;</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-type">SwitchData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098548"><span class="hs-identifier hs-type">&#981;</span></a></span><span> </span><span class="annot"><a href="Data.Row.Internal.html#.-"><span class="hs-operator hs-type">.-</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098549"><span class="hs-identifier hs-type">&#961;</span></a></span><span> </span><span class="annot"><a href="Data.Row.Internal.html#.-"><span class="hs-operator hs-type">.-</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098545"><span class="hs-identifier hs-type">&#8467;</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-type">Const2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098404"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098547"><span class="hs-identifier hs-type">&#964;</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679098527"><span class="annot"><span class="annottext">doUncons :: forall (&#8467; :: Symbol) &#964;1 &#964;2 (&#961;1 :: Row (*)) (&#961;2 :: Row (*)).
(KnownSymbol &#8467;, AppliesTo x &#964;1 &#964;2, HasType &#8467; &#964;1 &#961;1,
 HasType &#8467; &#964;2 &#961;2) =&gt;
Label &#8467;
-&gt; SwitchData &#961;1 &#961;2
-&gt; Either (SwitchData (&#961;1 .- &#8467;) (&#961;2 .- &#8467;)) (Const2 x &#964;1 &#964;2)
</span><a href="#local-6989586621679098527"><span class="hs-identifier hs-var hs-var">doUncons</span></a></span></span><span> </span><span id="local-6989586621679098568"><span class="annot"><span class="annottext">Label &#8467;
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-type">SwitchData</span></a></span><span> </span><span id="local-6989586621679098569"><span class="annot"><span class="annottext">Rec &#981;
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679098570"><span class="annot"><span class="annottext">Var &#961;
</span><a href="#local-6989586621679098570"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var (&#961; .- &#8467;) -&gt; SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;))
-&gt; (&#964; -&gt; Const2 x f &#964;)
-&gt; Either (Var (&#961; .- &#8467;)) &#964;
-&gt; Either (SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;)) (Const2 x f &#964;)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Either a c -&gt; Either b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec (&#981; .- &#8467;) -&gt; Var (&#961; .- &#8467;) -&gt; SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;)
forall (r :: Row (*)) (v :: Row (*)).
Rec r -&gt; Var v -&gt; SwitchData r v
</span><a href="Data.Row.Switch.html#SwitchData"><span class="hs-identifier hs-var">SwitchData</span></a></span><span> </span><span class="annot"><span class="annottext">(Rec (&#981; .- &#8467;) -&gt; Var (&#961; .- &#8467;) -&gt; SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;))
-&gt; Rec (&#981; .- &#8467;) -&gt; Var (&#961; .- &#8467;) -&gt; SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Label &#8467; -&gt; Rec &#981; -&gt; Rec (&#981; .- &#8467;)
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Label l -&gt; Rec r -&gt; Rec (r .- l)
</span><a href="Data.Row.Records.html#lazyRemove"><span class="hs-identifier hs-var">lazyRemove</span></a></span><span> </span><span class="annot"><span class="annottext">Label &#8467;
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Rec &#981;
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Const2 x f &#964;
forall {k} {k} x (y :: k) (z :: k). x -&gt; Const2 x y z
</span><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-var">Const2</span></a></span><span> </span><span class="annot"><span class="annottext">(x -&gt; Const2 x f &#964;) -&gt; (&#964; -&gt; x) -&gt; &#964; -&gt; Const2 x f &#964;
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; &#964; -&gt; x
forall r f x. AppliesTo r f x =&gt; f -&gt; x -&gt; r
</span><a href="Data.Row.Switch.html#applyTo"><span class="hs-identifier hs-var">applyTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec &#981;
</span><a href="#local-6989586621679098569"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rec &#981; -&gt; Label &#8467; -&gt; &#981; .! &#8467;
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Rec r -&gt; Label l -&gt; r .! l
</span><a href="Data.Row.Records.html#.%21"><span class="hs-operator hs-var">.!</span></a></span><span> </span><span class="annot"><span class="annottext">Label &#8467;
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either (Var (&#961; .- &#8467;)) &#964;
 -&gt; Either (SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;)) (Const2 x f &#964;))
-&gt; Either (Var (&#961; .- &#8467;)) &#964;
-&gt; Either (SwitchData (&#981; .- &#8467;) (&#961; .- &#8467;)) (Const2 x f &#964;)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Var &#961; -&gt; Label &#8467; -&gt; Either (Var (&#961; .- &#8467;)) (&#961; .! &#8467;)
forall (l :: Symbol) (r :: Row (*)).
KnownSymbol l =&gt;
Var r -&gt; Label l -&gt; Either (Var (r .- l)) (r .! l)
</span><a href="Data.Row.Variants.html#trial"><span class="hs-identifier hs-var">trial</span></a></span><span> </span><span class="annot"><span class="annottext">Var &#961;
</span><a href="#local-6989586621679098570"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Label &#8467;
</span><a href="#local-6989586621679098568"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- doCons :: forall &#8467; f &#964; &#981; &#961;. (KnownSymbol &#8467;, AppliesTo x f &#964;)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">--        =&gt; Label &#8467; -&gt; Either (Const2 x f &#964;) (Const2 x &#981; &#961;) -&gt; Const2 x (Extend &#8467; f &#981;) (Extend &#8467; &#964; &#961;)</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679098536"><span class="annot"><span class="annottext">doCons :: p -&gt; Either (Const2 x y z) (Const2 x y z) -&gt; Const2 x y z
</span><a href="#local-6989586621679098536"><span class="hs-identifier hs-var hs-var">doCons</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-type">Const2</span></a></span><span> </span><span id="local-6989586621679098576"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; Const2 x y z
forall {k} {k} x (y :: k) (z :: k). x -&gt; Const2 x y z
</span><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-var">Const2</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679098576"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="#local-6989586621679098536"><span class="hs-identifier hs-var">doCons</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-type">Const2</span></a></span><span> </span><span id="local-6989586621679098577"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; Const2 x y z
forall {k} {k} x (y :: k) (z :: k). x -&gt; Const2 x y z
</span><a href="Data.Row.Switch.html#Const2"><span class="hs-identifier hs-var">Const2</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679098577"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | The same as 'switch' but with the argument order reversed</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="Data.Row.Switch.html#caseon"><span class="hs-identifier hs-type">caseon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098500"><span class="annot"><a href="#local-6989586621679098500"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679098499"><span class="annot"><a href="#local-6989586621679098499"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098501"><span class="annot"><a href="#local-6989586621679098501"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Row.Internal.html#BiForall"><span class="hs-identifier hs-type">BiForall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098499"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098500"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Row.Switch.html#AppliesTo"><span class="hs-identifier hs-type">AppliesTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098501"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Row.Records.html#Rec"><span class="hs-identifier hs-type">Rec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098499"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Row.Variants.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098500"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098501"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-65"></span><span id="caseon"><span class="annot"><span class="annottext">caseon :: forall (v :: Row (*)) (r :: Row (*)) x.
BiForall r v (AppliesTo x) =&gt;
Rec r -&gt; Var v -&gt; x
</span><a href="Data.Row.Switch.html#caseon"><span class="hs-identifier hs-var hs-var">caseon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var v -&gt; Rec r -&gt; x) -&gt; Rec r -&gt; Var v -&gt; x
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Var v -&gt; Rec r -&gt; x
forall (v :: Row (*)) (r :: Row (*)) x.
BiForall r v (AppliesTo x) =&gt;
Var v -&gt; Rec r -&gt; x
</span><a href="Data.Row.Switch.html#switch"><span class="hs-identifier hs-var">switch</span></a></span><span>
</span><span id="line-66"></span></pre></body></html>