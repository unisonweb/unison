<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_HADDOCK hide #-}</span><span>
</span><span id="line-2"></span><span class="annot"><span class="hs-comment">-- | Combinators for constructing properties.</span></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span class="hs-cpp">
#ifndef NO_TYPEABLE
</span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifndef NO_SAFE_HASKELL
</span><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.QuickCheck.Property</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- imports</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html"><span class="hs-identifier">Test.QuickCheck.Gen</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.Unsafe.html"><span class="hs-identifier">Test.QuickCheck.Gen.Unsafe</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.Arbitrary.html"><span class="hs-identifier">Test.QuickCheck.Arbitrary</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.Text.html"><span class="hs-identifier">Test.QuickCheck.Text</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.QuickCheck.Text.html#isOneLine"><span class="hs-identifier">isOneLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier">putLine</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.Exception.html"><span class="hs-identifier">Test.QuickCheck.Exception</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html"><span class="hs-identifier">Test.QuickCheck.State</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html#State"><span class="hs-identifier">State</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier">terminal</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html#Confidence"><span class="hs-identifier">Confidence</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">

#ifndef NO_TIMEOUT
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Timeout</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">timeout</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span class="hs-cpp">
#ifndef NO_DEEPSEQ
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#ifndef NO_TYPEABLE
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- fixities</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-type">==&gt;</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#.%26."><span class="hs-operator hs-type">.&amp;.</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#.%26%26."><span class="hs-operator hs-type">.&amp;&amp;.</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#.%7C%7C."><span class="hs-operator hs-type">.||.</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- The story for exception handling:</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- To avoid insanity, we have rules about which terms can throw</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- exceptions when we evaluate them:</span><span>
</span><span id="line-52"></span><span class="hs-comment">--   * A rose tree must evaluate to WHNF without throwing an exception</span><span>
</span><span id="line-53"></span><span class="hs-comment">--   * The 'ok' component of a Result must evaluate to Just True or</span><span>
</span><span id="line-54"></span><span class="hs-comment">--     Just False or Nothing rather than raise an exception</span><span>
</span><span id="line-55"></span><span class="hs-comment">--   * IORose _ must never throw an exception when executed</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- Both rose trees and Results may loop when we evaluate them, though,</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- so we have to be careful not to force them unnecessarily.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- We also have to be careful when we use fmap or &gt;&gt;= in the Rose</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- monad that the function we supply is total, or else use</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- protectResults afterwards to install exception handlers. The</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- mapResult function on Properties installs an exception handler for</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- us, though.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- Of course, the user is free to write &quot;error &quot;ha ha&quot; :: Result&quot; if</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- they feel like it. We have to make sure that any user-supplied Rose</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- Results or Results get wrapped in exception handlers, which we do by:</span><span>
</span><span id="line-69"></span><span class="hs-comment">--   * Making the 'property' function install an exception handler</span><span>
</span><span id="line-70"></span><span class="hs-comment">--     round its argument. This function always gets called in the</span><span>
</span><span id="line-71"></span><span class="hs-comment">--     right places, because all our Property-accepting functions are</span><span>
</span><span id="line-72"></span><span class="hs-comment">--     actually polymorphic over the Testable class so they have to</span><span>
</span><span id="line-73"></span><span class="hs-comment">--     call 'property'.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--   * Installing an exception handler round a Result before we put it</span><span>
</span><span id="line-75"></span><span class="hs-comment">--     in a rose tree (the only place Results can end up).</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- * Property and Testable types</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | The type of properties.</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">newtype</span><span> </span><span id="Property"><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkProperty"><span class="annot"><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="unProperty"><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var hs-var">unProperty</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-cpp">
#ifndef NO_TYPEABLE
</span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | The class of properties, i.e., types which QuickCheck knows how to test.</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- Typically a property will be a function returning 'Bool' or 'Property'.</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- If a property does no quantification, i.e. has no</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- parameters and doesn't use 'forAll', it will only be tested once.</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- This may not be what you want if your property is an @IO Bool@.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- You can change this behaviour using the 'again' combinator.</span><span>
</span><span id="line-93"></span><span class="hs-keyword">class</span><span> </span><span id="Testable"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-var">Testable</span></a></span></span><span> </span><span id="local-6989586621679120510"><span class="annot"><a href="#local-6989586621679120510"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- | Convert the thing to a property.</span><span>
</span><span id="line-95"></span><span>  </span><span id="property"><span class="annot"><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-type">property</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679120510"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">-- | Optional; used internally in order to improve shrinking.</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- Tests a property but also quantifies over an extra value</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- (with a custom shrink and show function).</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- The 'Testable' instance for functions defines</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- @propertyForAllShrinkShow@ in a way that improves shrinking.</span><span>
</span><span id="line-102"></span><span>  </span><span id="propertyForAllShrinkShow"><span class="annot"><a href="Test.QuickCheck.Property.html#propertyForAllShrinkShow"><span class="hs-identifier hs-type">propertyForAllShrinkShow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679120509"><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120509"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120510"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679120777"><span class="annot"><a href="Test.QuickCheck.Property.html#propertyForAllShrinkShow"><span class="hs-identifier hs-var hs-var">propertyForAllShrinkShow</span></a></span><span> </span><span id="local-6989586621679120784"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679120784"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679120785"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679120785"><span class="hs-identifier hs-var">shr</span></a></span></span><span> </span><span id="local-6989586621679120786"><span class="annot"><span class="annottext">a -&gt; [String]
</span><a href="#local-6989586621679120786"><span class="hs-identifier hs-var">shw</span></a></span></span><span> </span><span id="local-6989586621679120787"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679120787"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-var">forAllShrinkBlind</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679120784"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679120785"><span class="hs-identifier hs-var">shr</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679120789"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120789"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Property -&gt; Property)
-&gt; Property -&gt; [String] -&gt; Property
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679120787"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120789"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [String]
</span><a href="#local-6989586621679120786"><span class="hs-identifier hs-var">shw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120789"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | If a property returns 'Discard', the current test case is discarded,</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- the same as if a precondition was false.</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- An example is the definition of '==&gt;':</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt; (==&gt;) :: Testable prop =&gt; Bool -&gt; prop -&gt; Property</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt; False ==&gt; _ = property Discard</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt; True  ==&gt; p = property p</span><span>
</span><span id="line-115"></span><span class="hs-keyword">data</span><span> </span><span id="Discard"><span class="annot"><a href="Test.QuickCheck.Property.html#Discard"><span class="hs-identifier hs-var">Discard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Discard"><span class="annot"><a href="Test.QuickCheck.Property.html#Discard"><span class="hs-identifier hs-var">Discard</span></a></span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120795"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Discard"><span class="hs-identifier hs-type">Discard</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679120801"><span class="annot"><span class="annottext">property :: Discard -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="annot"><span class="annottext">Discard
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#rejected"><span class="hs-identifier hs-var">rejected</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- This instance is here to make it easier to turn IO () into a Property.</span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120805"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679120809"><span class="annot"><span class="annottext">property :: () -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Property) -&gt; (() -&gt; Result) -&gt; () -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Result
</span><a href="#local-6989586621679120811"><span class="hs-identifier hs-var">liftUnit</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-comment">-- N.B. the unit gets forced only inside 'property',</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-comment">-- so that we turn exceptions into test failures</span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621679120811"><span class="annot"><span class="annottext">liftUnit :: () -&gt; Result
</span><a href="#local-6989586621679120811"><span class="hs-identifier hs-var hs-var">liftUnit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#succeeded"><span class="hs-identifier hs-var">succeeded</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120528"><span id="local-6989586621679120816"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120528"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679120528"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679120821"><span class="annot"><span class="annottext">property :: Maybe prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property)
-&gt; (Maybe prop -&gt; Property) -&gt; Maybe prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe prop -&gt; Property
forall prop. Testable prop =&gt; Maybe prop -&gt; Property
</span><a href="#local-6989586621679120822"><span class="hs-identifier hs-var">liftMaybe</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- See comment for liftUnit above</span><span>
</span><span id="line-132"></span><span>      </span><span id="local-6989586621679120822"><span class="annot"><span class="annottext">liftMaybe :: Maybe prop -&gt; Property
</span><a href="#local-6989586621679120822"><span class="hs-identifier hs-var hs-var">liftMaybe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe prop
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Discard -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">Discard
</span><a href="Test.QuickCheck.Property.html#Discard"><span class="hs-identifier hs-var">Discard</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="#local-6989586621679120822"><span class="hs-identifier hs-var">liftMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679120826"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679120826"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679120826"><span class="hs-identifier hs-var">prop</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120829"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679120833"><span class="annot"><span class="annottext">property :: Bool -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Property) -&gt; (Bool -&gt; Result) -&gt; Bool -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Result
</span><a href="Test.QuickCheck.Property.html#liftBool"><span class="hs-identifier hs-var">liftBool</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120837"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679120842"><span class="annot"><span class="annottext">property :: Result -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property)
-&gt; (Result -&gt; Gen Prop) -&gt; Result -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Gen Prop
forall a. a -&gt; Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Gen Prop) -&gt; (Result -&gt; Prop) -&gt; Result -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Prop) -&gt; (Result -&gt; Rose Result) -&gt; Result -&gt; Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#protectResults"><span class="hs-identifier hs-var">protectResults</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result)
-&gt; (Result -&gt; Rose Result) -&gt; Result -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120847"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679120851"><span class="annot"><span class="annottext">property :: Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span id="local-6989586621679120852"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679120852"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; (Prop -&gt; Gen Prop) -&gt; Prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Gen Prop
forall a. a -&gt; Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Gen Prop) -&gt; (Prop -&gt; Prop) -&gt; Prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#protectProp"><span class="hs-identifier hs-var">protectProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Property) -&gt; Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679120852"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120533"><span id="local-6989586621679120857"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120533"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120533"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679120862"><span class="annot"><span class="annottext">property :: Gen prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span id="local-6989586621679120863"><span class="annot"><span class="annottext">Gen prop
</span><a href="#local-6989586621679120863"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; Gen Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679120864"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679120864"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen prop
</span><a href="#local-6989586621679120863"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var">again</span></a></span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679120864"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120867"><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679120871"><span class="annot"><span class="annottext">property :: Property -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-type">MkProperty</span></a></span><span> </span><span id="local-6989586621679120872"><span class="annot"><span class="annottext">Gen Prop
</span><a href="#local-6989586621679120872"><span class="hs-identifier hs-var">mp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prop -&gt; Prop) -&gt; Gen Prop -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#protectProp"><span class="hs-identifier hs-var">protectProp</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Prop
</span><a href="#local-6989586621679120872"><span class="hs-identifier hs-var">mp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><span class="hs-comment">-- | Do I/O inside a property.</span></span><span>
</span><span id="line-151"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">morallyDubiousIOProperty</span><span> </span><span class="hs-pragma">&quot;Use 'ioProperty' instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-152"></span><span id="local-6989586621679120537"><span class="annot"><a href="Test.QuickCheck.Property.html#morallyDubiousIOProperty"><span class="hs-identifier hs-type">morallyDubiousIOProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120537"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120537"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-153"></span><span id="morallyDubiousIOProperty"><span class="annot"><span class="annottext">morallyDubiousIOProperty :: forall prop. Testable prop =&gt; IO prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#morallyDubiousIOProperty"><span class="hs-identifier hs-var hs-var">morallyDubiousIOProperty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO prop -&gt; Property
forall prop. Testable prop =&gt; IO prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#ioProperty"><span class="hs-identifier hs-var">ioProperty</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Do I/O inside a property.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Warning: any random values generated inside of the argument to @ioProperty@</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- will not currently be shrunk. For best results, generate all random values</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- before calling @ioProperty@, or use 'idempotentIOProperty' if that is safe.</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- Note: if your property does no quantification, it will only be tested once.</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- To test it repeatedly, use 'again'.</span><span>
</span><span id="line-163"></span><span id="local-6989586621679120878"><span class="annot"><a href="Test.QuickCheck.Property.html#ioProperty"><span class="hs-identifier hs-type">ioProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120878"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120878"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-164"></span><span id="ioProperty"><span class="annot"><span class="annottext">ioProperty :: forall prop. Testable prop =&gt; IO prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#ioProperty"><span class="hs-identifier hs-var hs-var">ioProperty</span></a></span></span><span> </span><span id="local-6989586621679120884"><span class="annot"><span class="annottext">IO prop
</span><a href="#local-6989586621679120884"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Property -&gt; Property
forall prop. Testable prop =&gt; IO prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#idempotentIOProperty"><span class="hs-identifier hs-var">idempotentIOProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(prop -&gt; Property) -&gt; IO prop -&gt; IO Property
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#noShrinking"><span class="hs-identifier hs-var">noShrinking</span></a></span><span> </span><span class="annot"><span class="annottext">IO prop
</span><a href="#local-6989586621679120884"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Do I/O inside a property.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Warning: during shrinking, the I/O may not always be re-executed.</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Instead, the I/O may be executed once and then its result retained.</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- If this is not acceptable, use 'ioProperty' instead.</span><span>
</span><span id="line-171"></span><span id="local-6989586621679120886"><span class="annot"><a href="Test.QuickCheck.Property.html#idempotentIOProperty"><span class="hs-identifier hs-type">idempotentIOProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120886"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120886"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-172"></span><span id="idempotentIOProperty"><span class="annot"><span class="annottext">idempotentIOProperty :: forall prop. Testable prop =&gt; IO prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#idempotentIOProperty"><span class="hs-identifier hs-var hs-var">idempotentIOProperty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property)
-&gt; (IO prop -&gt; Gen Prop) -&gt; IO prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(IO Prop -&gt; Prop) -&gt; Gen (IO Prop) -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Prop)
-&gt; (IO Prop -&gt; Rose Result) -&gt; IO Prop -&gt; Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#ioRose"><span class="hs-identifier hs-var">ioRose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; (IO Prop -&gt; IO (Rose Result)) -&gt; IO Prop -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Rose Result) -&gt; IO Prop -&gt; IO (Rose Result)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Gen (IO Prop) -&gt; Gen Prop)
-&gt; (IO prop -&gt; Gen (IO Prop)) -&gt; IO prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">IO (Gen Prop) -&gt; Gen (IO Prop)
forall (m :: * -&gt; *) a. Monad m =&gt; m (Gen a) -&gt; Gen (m a)
</span><a href="Test.QuickCheck.Gen.Unsafe.html#promote"><span class="hs-identifier hs-var">promote</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Gen Prop) -&gt; Gen (IO Prop))
-&gt; (IO prop -&gt; IO (Gen Prop)) -&gt; IO prop -&gt; Gen (IO Prop)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(prop -&gt; Gen Prop) -&gt; IO prop -&gt; IO (Gen Prop)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120546"><span id="local-6989586621679120547"><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Arbitrary.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120546"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679120546"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120547"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120547"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679120908"><span class="annot"><span class="annottext">property :: (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var hs-var hs-var hs-var">property</span></a></span></span><span> </span><span id="local-6989586621679120909"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679120909"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; prop) -&gt; Property
forall a.
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#propertyForAllShrinkShow"><span class="hs-identifier hs-var">propertyForAllShrinkShow</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><a href="Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="Test.QuickCheck.Arbitrary.html#shrink"><span class="hs-identifier hs-var">shrink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; (a -&gt; String) -&gt; a -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679120909"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679120920"><span class="annot"><span class="annottext">propertyForAllShrinkShow :: forall a.
Gen a
-&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#propertyForAllShrinkShow"><span class="hs-identifier hs-var hs-var hs-var hs-var">propertyForAllShrinkShow</span></a></span></span><span> </span><span id="local-6989586621679120921"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679120921"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679120922"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679120922"><span class="hs-identifier hs-var">shr</span></a></span></span><span> </span><span id="local-6989586621679120923"><span class="annot"><span class="annottext">a -&gt; [String]
</span><a href="#local-6989586621679120923"><span class="hs-identifier hs-var">shw</span></a></span></span><span> </span><span id="local-6989586621679120924"><span class="annot"><span class="annottext">a -&gt; a -&gt; prop
</span><a href="#local-6989586621679120924"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- gen :: Gen b, shr :: b -&gt; [b], f :: b -&gt; a -&gt; prop</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- Idea: Generate and shrink (b, a) as a pair</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Gen (a, a)
-&gt; ((a, a) -&gt; [(a, a)])
-&gt; ((a, a) -&gt; [String])
-&gt; ((a, a) -&gt; prop)
-&gt; Property
forall a.
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; [String]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#propertyForAllShrinkShow"><span class="hs-identifier hs-var">propertyForAllShrinkShow</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; (a, a)) -&gt; Gen a -&gt; Gen a -&gt; Gen (a, a)
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679120921"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><a href="Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [a]) -&gt; (a -&gt; [a]) -&gt; (a, a) -&gt; [(a, a)]
forall a b. (a -&gt; [a]) -&gt; (b -&gt; [b]) -&gt; (a, b) -&gt; [(a, b)]
forall (f :: * -&gt; * -&gt; *) a b.
Arbitrary2 f =&gt;
(a -&gt; [a]) -&gt; (b -&gt; [b]) -&gt; f a b -&gt; [f a b]
</span><a href="Test.QuickCheck.Arbitrary.html#liftShrink2"><span class="hs-identifier hs-var">liftShrink2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679120922"><span class="hs-identifier hs-var">shr</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="Test.QuickCheck.Arbitrary.html#shrink"><span class="hs-identifier hs-var">shrink</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679120927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120927"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679120928"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120928"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; [String]
</span><a href="#local-6989586621679120923"><span class="hs-identifier hs-var">shw</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120927"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120928"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; prop) -&gt; (a, a) -&gt; prop
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; prop
</span><a href="#local-6989586621679120924"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">-- ** Exception handling</span></span><span>
</span><span id="line-189"></span><span id="local-6989586621679120565"><span class="annot"><a href="Test.QuickCheck.Property.html#protect"><span class="hs-identifier hs-type">protect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Exception.html#AnException"><span class="hs-identifier hs-type">AnException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120565"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120565"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679120565"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-190"></span><span id="protect"><span class="annot"><span class="annottext">protect :: forall a. (AnException -&gt; a) -&gt; IO a -&gt; IO a
</span><a href="Test.QuickCheck.Property.html#protect"><span class="hs-identifier hs-var hs-var">protect</span></a></span></span><span> </span><span id="local-6989586621679120932"><span class="annot"><span class="annottext">AnException -&gt; a
</span><a href="#local-6989586621679120932"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679120933"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679120933"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnException -&gt; a) -&gt; (a -&gt; a) -&gt; Either AnException a -&gt; a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">AnException -&gt; a
</span><a href="#local-6989586621679120932"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Either AnException a -&gt; a) -&gt; IO (Either AnException a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either AnException a)
forall a. IO a -&gt; IO (Either AnException a)
</span><a href="Test.QuickCheck.Exception.html#tryEvaluateIO"><span class="hs-identifier hs-var">tryEvaluateIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679120933"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- ** Type Prop</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">newtype</span><span> </span><span id="Prop"><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-var">Prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkProp"><span class="annot"><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span></span><span class="hs-special">{</span><span> </span><span id="unProp"><span class="annot"><span class="annottext">Prop -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#unProp"><span class="hs-identifier hs-var hs-var">unProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="hs-comment">-- ** type Rose</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-keyword">data</span><span> </span><span id="Rose"><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-var">Rose</span></a></span></span><span> </span><span id="local-6989586621679120572"><span class="annot"><a href="#local-6989586621679120572"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkRose"><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679120572"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="IORose"><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- Only use IORose if you know that the argument is not going to throw an exception!</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Otherwise, try ioRose.</span><span>
</span><span id="line-202"></span><span class="annot"><a href="Test.QuickCheck.Property.html#ioRose"><span class="hs-identifier hs-type">ioRose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-203"></span><span id="ioRose"><span class="annot"><span class="annottext">ioRose :: IO (Rose Result) -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#ioRose"><span class="hs-identifier hs-var hs-var">ioRose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; (IO (Rose Result) -&gt; IO (Rose Result))
-&gt; IO (Rose Result)
-&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#protectRose"><span class="hs-identifier hs-var">protectRose</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679120573"><span class="annot"><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-type">joinRose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120573"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-206"></span><span id="joinRose"><span class="annot"><span class="annottext">joinRose :: forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var hs-var">joinRose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-type">IORose</span></a></span><span> </span><span id="local-6989586621679120944"><span class="annot"><span class="annottext">IO (Rose (Rose a))
</span><a href="#local-6989586621679120944"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose a) -&gt; Rose a
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose (Rose a) -&gt; Rose a) -&gt; IO (Rose (Rose a)) -&gt; IO (Rose a)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Rose (Rose a) -&gt; Rose a
forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Rose (Rose a))
</span><a href="#local-6989586621679120944"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="annot"><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-type">IORose</span></a></span><span> </span><span id="local-6989586621679120945"><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679120945"><span class="hs-identifier hs-var">rm</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120946"><span class="annot"><span class="annottext">[Rose (Rose a)]
</span><a href="#local-6989586621679120946"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose a) -&gt; Rose a
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose a) -&gt; Rose a) -&gt; IO (Rose a) -&gt; Rose a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679120947"><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120947"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679120945"><span class="hs-identifier hs-var">rm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Rose a -&gt; IO (Rose a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose (Rose a) -&gt; Rose a
forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose a -&gt; [Rose (Rose a)] -&gt; Rose (Rose a)
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120947"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose (Rose a)]
</span><a href="#local-6989586621679120946"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679120948"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120948"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120949"><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679120949"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679120950"><span class="annot"><span class="annottext">[Rose (Rose a)]
</span><a href="#local-6989586621679120950"><span class="hs-identifier hs-var">tts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">-- first shrinks outer quantification; makes most sense</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120948"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose (Rose a) -&gt; Rose a) -&gt; [Rose (Rose a)] -&gt; [Rose a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rose (Rose a) -&gt; Rose a
forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose (Rose a)]
</span><a href="#local-6989586621679120950"><span class="hs-identifier hs-var">tts</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose a] -&gt; [Rose a] -&gt; [Rose a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679120949"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- first shrinks inner quantification: terrible</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">--MkRose x (ts ++ map joinRose tts)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120953"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- f must be total</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679120960"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679120961"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679120961"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-type">IORose</span></a></span><span> </span><span id="local-6989586621679120962"><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679120962"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose b) -&gt; Rose b
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose a -&gt; Rose b) -&gt; IO (Rose a) -&gt; IO (Rose b)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Rose a -&gt; Rose b
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679120961"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679120962"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">fmap</span></span><span> </span><span id="local-6989586621679120963"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679120963"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679120964"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120964"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679120965"><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679120965"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; [Rose b] -&gt; Rose b
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679120963"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120964"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Rose a -&gt; Rose b
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679120963"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120966"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679120966"><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120966"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679120965"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120972"><span id="local-6989586621679120976"><span id="local-6989586621679120979"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679120982"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Rose a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679120983"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120983"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679120983"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- f must be total</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679120985"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. Rose (a -&gt; b) -&gt; Rose a -&gt; Rose b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; a -&gt; b) -&gt; Rose (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679120990"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679120995"><span class="annot"><span class="annottext">return :: forall a. a -&gt; Rose a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rose a
forall a. a -&gt; Rose a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- k must be total</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679120997"><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120997"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679120998"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. Rose a -&gt; (a -&gt; Rose b) -&gt; Rose b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679120999"><span class="annot"><span class="annottext">a -&gt; Rose b
</span><a href="#local-6989586621679120999"><span class="hs-identifier hs-var">k</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rose (Rose b) -&gt; Rose b
forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Rose b) -&gt; Rose a -&gt; Rose (Rose b)
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rose b
</span><a href="#local-6989586621679120999"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Rose a
</span><a href="#local-6989586621679120997"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | Execute the &quot;IORose&quot; bits of a rose tree, returning a tree</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- constructed by MkRose.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-type">reduceRose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span id="reduceRose"><span class="annot"><span class="annottext">reduceRose :: Rose Result -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var hs-var">reduceRose</span></a></span></span><span> </span><span id="local-6989586621679121001"><span class="annot"><span class="annottext">r :: Rose Result
</span><a href="#local-6989586621679121001"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121001"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var">reduceRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-type">IORose</span></a></span><span> </span><span id="local-6989586621679121002"><span class="annot"><span class="annottext">IO (Rose Result)
</span><a href="#local-6989586621679121002"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose Result)
</span><a href="#local-6989586621679121002"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Rose Result)
-&gt; (Rose Result -&gt; IO (Rose Result)) -&gt; IO (Rose Result)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var">reduceRose</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Apply a function to the outermost MkRose constructor of a rose tree.</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- The function must be total!</span><span>
</span><span id="line-237"></span><span id="local-6989586621679120602"><span class="annot"><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-type">onRose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120602"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-238"></span><span id="onRose"><span class="annot"><span class="annottext">onRose :: forall a. (a -&gt; [Rose a] -&gt; Rose a) -&gt; Rose a -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-var hs-var">onRose</span></a></span></span><span> </span><span id="local-6989586621679121005"><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
</span><a href="#local-6989586621679121005"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679121006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121006"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679121007"><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679121007"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
</span><a href="#local-6989586621679121005"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121006"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose a]
</span><a href="#local-6989586621679121007"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-var">onRose</span></a></span><span> </span><span id="local-6989586621679121008"><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
</span><a href="#local-6989586621679121008"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-type">IORose</span></a></span><span> </span><span id="local-6989586621679121009"><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679121009"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose a) -&gt; Rose a
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose a -&gt; Rose a) -&gt; IO (Rose a) -&gt; IO (Rose a)
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; [Rose a] -&gt; Rose a) -&gt; Rose a -&gt; Rose a
forall a. (a -&gt; [Rose a] -&gt; Rose a) -&gt; Rose a -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-var">onRose</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Rose a] -&gt; Rose a
</span><a href="#local-6989586621679121008"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Rose a)
</span><a href="#local-6989586621679121009"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-comment">-- | Wrap a rose tree in an exception handler.</span></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Test.QuickCheck.Property.html#protectRose"><span class="hs-identifier hs-type">protectRose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span id="protectRose"><span class="annot"><span class="annottext">protectRose :: IO (Rose Result) -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#protectRose"><span class="hs-identifier hs-var hs-var">protectRose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnException -&gt; Rose Result)
-&gt; IO (Rose Result) -&gt; IO (Rose Result)
forall a. (AnException -&gt; a) -&gt; IO a -&gt; IO a
</span><a href="Test.QuickCheck.Property.html#protect"><span class="hs-identifier hs-var">protect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Rose Result)
-&gt; (AnException -&gt; Result) -&gt; AnException -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; AnException -&gt; Result
</span><a href="Test.QuickCheck.Property.html#exception"><span class="hs-identifier hs-var">exception</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Exception&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><span class="hs-comment">-- | Wrap the top level of a 'Prop' in an exception handler.</span></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Test.QuickCheck.Property.html#protectProp"><span class="hs-identifier hs-type">protectProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span>
</span><span id="line-247"></span><span id="protectProp"><span class="annot"><span class="annottext">protectProp :: Prop -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#protectProp"><span class="hs-identifier hs-var hs-var">protectProp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-type">MkProp</span></a></span><span> </span><span id="local-6989586621679121011"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121011"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; (Rose Result -&gt; IO (Rose Result)) -&gt; Rose Result -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#protectRose"><span class="hs-identifier hs-var">protectRose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; IO (Rose Result))
-&gt; (Rose Result -&gt; IO (Rose Result))
-&gt; Rose Result
-&gt; IO (Rose Result)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; Rose Result -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121011"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><span class="hs-comment">-- | Wrap all the Results in a rose tree in exception handlers.</span></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Test.QuickCheck.Property.html#protectResults"><span class="hs-identifier hs-type">protectResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-251"></span><span id="protectResults"><span class="annot"><span class="annottext">protectResults :: Rose Result -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#protectResults"><span class="hs-identifier hs-var hs-var">protectResults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; [Rose Result] -&gt; Rose Result)
-&gt; Rose Result -&gt; Rose Result
forall a. (a -&gt; [Rose a] -&gt; Rose a) -&gt; Rose a -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-var">onRose</span></a></span><span> </span><span class="annot"><span class="annottext">((Result -&gt; [Rose Result] -&gt; Rose Result)
 -&gt; Rose Result -&gt; Rose Result)
-&gt; (Result -&gt; [Rose Result] -&gt; Rose Result)
-&gt; Rose Result
-&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121012"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121012"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679121013"><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121013"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; IO (Rose Result) -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679121014"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121014"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Result -&gt; IO Result
</span><a href="Test.QuickCheck.Property.html#protectResult"><span class="hs-identifier hs-var">protectResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121012"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121014"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; [Rose Result] -&gt; [Rose Result]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#protectResults"><span class="hs-identifier hs-var">protectResults</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121013"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><span class="hs-comment">-- ** Result type</span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><span class="hs-comment">-- | Different kinds of callbacks</span></span><span>
</span><span id="line-259"></span><span class="hs-keyword">data</span><span> </span><span id="Callback"><span class="annot"><a href="Test.QuickCheck.Property.html#Callback"><span class="hs-identifier hs-var">Callback</span></a></span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PostTest"><span class="annot"><a href="Test.QuickCheck.Property.html#PostTest"><span class="hs-identifier hs-var">PostTest</span></a></span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#CallbackKind"><span class="hs-identifier hs-type">CallbackKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.State.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Called just after a test</span></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PostFinalFailure"><span class="annot"><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-var">PostFinalFailure</span></a></span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#CallbackKind"><span class="hs-identifier hs-type">CallbackKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.State.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Called with the final failing test-case</span></span><span>
</span><span id="line-262"></span><span class="hs-keyword">data</span><span> </span><span id="CallbackKind"><span class="annot"><a href="Test.QuickCheck.Property.html#CallbackKind"><span class="hs-identifier hs-var">CallbackKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Counterexample"><span class="annot"><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Affected by the 'verbose' combinator</span></span><span>
</span><span id="line-263"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="NotCounterexample"><span class="annot"><a href="Test.QuickCheck.Property.html#NotCounterexample"><span class="hs-identifier hs-var">NotCounterexample</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Not affected by the 'verbose' combinator</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><span class="hs-comment">-- | The result of a single test.</span></span><span>
</span><span id="line-266"></span><span class="hs-keyword">data</span><span> </span><span id="Result"><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MkResult"><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-var">MkResult</span></a></span></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ok"><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ result of the test case; Nothing = discard</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="expect"><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var hs-var">expect</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ indicates what the expected result of the property is</span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="reason"><span class="annot"><span class="annottext">Result -&gt; String
</span><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ a message indicating what went wrong</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="theException"><span class="annot"><span class="annottext">Result -&gt; Maybe AnException
</span><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var hs-var">theException</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Exception.html#AnException"><span class="hs-identifier hs-type">AnException</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the exception thrown, if any</span></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="abort"><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.QuickCheck.Property.html#abort"><span class="hs-identifier hs-var hs-var">abort</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ if True, the test should not be repeated</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="maybeNumTests"><span class="annot"><span class="annottext">Result -&gt; Maybe Int
</span><a href="Test.QuickCheck.Property.html#maybeNumTests"><span class="hs-identifier hs-var hs-var">maybeNumTests</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ stop after this many tests</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="maybeCheckCoverage"><span class="annot"><span class="annottext">Result -&gt; Maybe Confidence
</span><a href="Test.QuickCheck.Property.html#maybeCheckCoverage"><span class="hs-identifier hs-var hs-var">maybeCheckCoverage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html#Confidence"><span class="hs-identifier hs-type">Confidence</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ required coverage confidence</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="labels"><span class="annot"><span class="annottext">Result -&gt; [String]
</span><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var hs-var">labels</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ test case labels</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="classes"><span class="annot"><span class="annottext">Result -&gt; [String]
</span><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var hs-var">classes</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ test case classes</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tables"><span class="annot"><span class="annottext">Result -&gt; [(String, String)]
</span><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var hs-var">tables</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ test case tables</span></span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="requiredCoverage"><span class="annot"><span class="annottext">Result -&gt; [(Maybe String, String, Double)]
</span><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var hs-var">requiredCoverage</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ required coverage</span></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="callbacks"><span class="annot"><span class="annottext">Result -&gt; [Callback]
</span><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var hs-var">callbacks</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.QuickCheck.Property.html#Callback"><span class="hs-identifier hs-type">Callback</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the callbacks for this test case</span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="testCase"><span class="annot"><span class="annottext">Result -&gt; [String]
</span><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var hs-var">testCase</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the generated test case</span></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Test.QuickCheck.Property.html#exception"><span class="hs-identifier hs-type">exception</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Exception.html#AnException"><span class="hs-identifier hs-type">AnException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-297"></span><span id="exception"><span class="annot"><span class="annottext">exception :: String -&gt; AnException -&gt; Result
</span><a href="Test.QuickCheck.Property.html#exception"><span class="hs-identifier hs-var hs-var">exception</span></a></span></span><span> </span><span id="local-6989586621679121035"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121035"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679121036"><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121036"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AnException -&gt; Bool
</span><a href="Test.QuickCheck.Exception.html#isDiscard"><span class="hs-identifier hs-var">isDiscard</span></a></span><span> </span><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121036"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#rejected"><span class="hs-identifier hs-var">rejected</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#formatException"><span class="hs-identifier hs-type">formatException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121035"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121036"><span class="hs-identifier hs-type">err</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>                        </span><span class="annot"><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var">theException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679121036"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Test.QuickCheck.Property.html#formatException"><span class="hs-identifier hs-type">formatException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Exception.html#AnException"><span class="hs-identifier hs-type">AnException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-303"></span><span id="formatException"><span class="annot"><span class="annottext">formatException :: String -&gt; AnException -&gt; String
</span><a href="Test.QuickCheck.Property.html#formatException"><span class="hs-identifier hs-var hs-var">formatException</span></a></span></span><span> </span><span id="local-6989586621679121040"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121040"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679121041"><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121041"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121040"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679121042"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121041"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679121042"><span class="annot"><span class="annottext">format :: String -&gt; String
</span><a href="#local-6989586621679121042"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679121043"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121043"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Test.QuickCheck.Text.html#isOneLine"><span class="hs-identifier hs-var">isOneLine</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121043"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; '&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121043"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;'&quot;</span></span><span>
</span><span id="line-305"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121045"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679121045"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121045"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121043"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Test.QuickCheck.Property.html#protectResult"><span class="hs-identifier hs-type">protectResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-308"></span><span id="protectResult"><span class="annot"><span class="annottext">protectResult :: IO Result -&gt; IO Result
</span><a href="Test.QuickCheck.Property.html#protectResult"><span class="hs-identifier hs-var hs-var">protectResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnException -&gt; Result) -&gt; IO Result -&gt; IO Result
forall a. (AnException -&gt; a) -&gt; IO a -&gt; IO a
</span><a href="Test.QuickCheck.Property.html#protect"><span class="hs-identifier hs-var">protect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AnException -&gt; Result
</span><a href="Test.QuickCheck.Property.html#exception"><span class="hs-identifier hs-var">exception</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Exception&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Test.QuickCheck.Property.html#succeeded"><span class="hs-identifier hs-type">succeeded</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-type">failed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#rejected"><span class="hs-identifier hs-type">rejected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-311"></span><span class="hs-special">(</span><span id="succeeded"><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#succeeded"><span class="hs-identifier hs-var">succeeded</span></a></span></span><span class="hs-special">,</span><span> </span><span id="failed"><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="rejected"><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#rejected"><span class="hs-identifier hs-var">rejected</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121047"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-313"></span><span>   </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121047"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-314"></span><span>   </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121047"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679121047"><span class="annot"><span class="annottext">result :: Result
</span><a href="#local-6989586621679121047"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-type">MkResult</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ok :: Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">expect :: Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">reason :: String
</span><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">theException :: Maybe AnException
</span><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var">theException</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AnException
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">abort :: Bool
</span><a href="Test.QuickCheck.Property.html#abort"><span class="hs-identifier hs-var">abort</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maybeNumTests :: Maybe Int
</span><a href="Test.QuickCheck.Property.html#maybeNumTests"><span class="hs-identifier hs-var">maybeNumTests</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maybeCheckCoverage :: Maybe Confidence
</span><a href="Test.QuickCheck.Property.html#maybeCheckCoverage"><span class="hs-identifier hs-var">maybeCheckCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Confidence
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">labels :: [String]
</span><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">classes :: [String]
</span><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tables :: [(String, String)]
</span><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">requiredCoverage :: [(Maybe String, String, Double)]
</span><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">callbacks :: [Callback]
</span><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">testCase :: [String]
</span><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- ** Lifting and mapping functions</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Test.QuickCheck.Property.html#liftBool"><span class="hs-identifier hs-type">liftBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-337"></span><span id="liftBool"><span class="annot"><span class="annottext">liftBool :: Bool -&gt; Result
</span><a href="Test.QuickCheck.Property.html#liftBool"><span class="hs-identifier hs-var hs-var">liftBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#succeeded"><span class="hs-identifier hs-var">succeeded</span></a></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Test.QuickCheck.Property.html#liftBool"><span class="hs-identifier hs-var">liftBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Falsified&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span id="local-6989586621679120609"><span class="annot"><a href="Test.QuickCheck.Property.html#mapResult"><span class="hs-identifier hs-type">mapResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120609"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120609"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-341"></span><span id="mapResult"><span class="annot"><span class="annottext">mapResult :: forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapResult"><span class="hs-identifier hs-var hs-var">mapResult</span></a></span></span><span> </span><span id="local-6989586621679121055"><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121055"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-var">mapRoseResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#protectResults"><span class="hs-identifier hs-var">protectResults</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result)
-&gt; (Rose Result -&gt; Rose Result) -&gt; Rose Result -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; Rose Result -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121055"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679121057"><span class="annot"><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-type">mapTotalResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121057"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121057"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-344"></span><span id="mapTotalResult"><span class="annot"><span class="annottext">mapTotalResult :: forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var hs-var">mapTotalResult</span></a></span></span><span> </span><span id="local-6989586621679121062"><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121062"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-var">mapRoseResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; Rose Result -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121062"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- f here mustn't throw an exception (rose tree invariant).</span><span>
</span><span id="line-347"></span><span id="local-6989586621679120611"><span class="annot"><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-type">mapRoseResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120611"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120611"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-348"></span><span id="mapRoseResult"><span class="annot"><span class="annottext">mapRoseResult :: forall prop.
Testable prop =&gt;
(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-var hs-var">mapRoseResult</span></a></span></span><span> </span><span id="local-6989586621679121065"><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121065"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Prop) -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; (Prop -&gt; Prop) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapProp"><span class="hs-identifier hs-var">mapProp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-type">MkProp</span></a></span><span> </span><span id="local-6989586621679121067"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121067"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121065"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121067"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span id="local-6989586621679120614"><span class="annot"><a href="Test.QuickCheck.Property.html#mapProp"><span class="hs-identifier hs-type">mapProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120614"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120614"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-351"></span><span id="mapProp"><span class="annot"><span class="annottext">mapProp :: forall prop. Testable prop =&gt; (Prop -&gt; Prop) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapProp"><span class="hs-identifier hs-var hs-var">mapProp</span></a></span></span><span> </span><span id="local-6989586621679121071"><span class="annot"><span class="annottext">Prop -&gt; Prop
</span><a href="#local-6989586621679121071"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Prop) -&gt; Gen Prop -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop
</span><a href="#local-6989586621679121071"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Gen Prop) -&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-354"></span><span class="annot"><span class="hs-comment">-- ** Property combinators</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Adjust the test case size for a property, by transforming it with the given</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- function.</span><span>
</span><span id="line-358"></span><span id="local-6989586621679120616"><span class="annot"><a href="Test.QuickCheck.Property.html#mapSize"><span class="hs-identifier hs-type">mapSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120616"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120616"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-359"></span><span id="mapSize"><span class="annot"><span class="annottext">mapSize :: forall prop. Testable prop =&gt; (Int -&gt; Int) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapSize"><span class="hs-identifier hs-var hs-var">mapSize</span></a></span></span><span> </span><span id="local-6989586621679121077"><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679121077"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Gen Prop -&gt; Gen Prop
forall a. (Int -&gt; Int) -&gt; Gen a -&gt; Gen a
</span><a href="Test.QuickCheck.Gen.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679121077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Gen Prop) -&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | Shrinks the argument to a property if it fails. Shrinking is done</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- automatically for most types. This function is only needed when you want to</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- override the default behavior.</span><span>
</span><span id="line-364"></span><span id="local-6989586621679120619"><span id="local-6989586621679120620"><span class="annot"><a href="Test.QuickCheck.Property.html#shrinking"><span class="hs-identifier hs-type">shrinking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120619"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-365"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ 'shrink'-like function.</span></span><span>
</span><span id="line-366"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120620"><span class="hs-identifier hs-type">a</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ The original argument</span></span><span>
</span><span id="line-367"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120619"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-368"></span><span id="shrinking"><span class="annot"><span class="annottext">shrinking :: forall prop a.
Testable prop =&gt;
(a -&gt; [a]) -&gt; a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#shrinking"><span class="hs-identifier hs-var hs-var">shrinking</span></a></span></span><span> </span><span id="local-6989586621679121084"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121084"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679121085"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121085"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679121086"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121086"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose Prop -&gt; Prop) -&gt; Gen (Rose Prop) -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Prop)
-&gt; (Rose Prop -&gt; Rose Result) -&gt; Rose Prop -&gt; Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rose (Rose Result) -&gt; Rose Result
forall a. Rose (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#joinRose"><span class="hs-identifier hs-var">joinRose</span></a></span><span> </span><span class="annot"><span class="annottext">(Rose (Rose Result) -&gt; Rose Result)
-&gt; (Rose Prop -&gt; Rose (Rose Result)) -&gt; Rose Prop -&gt; Rose Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Rose Result) -&gt; Rose Prop -&gt; Rose (Rose Result)
forall a b. (a -&gt; b) -&gt; Rose a -&gt; Rose b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose (Gen Prop) -&gt; Gen (Rose Prop)
forall (m :: * -&gt; *) a. Monad m =&gt; m (Gen a) -&gt; Gen (m a)
</span><a href="Test.QuickCheck.Gen.Unsafe.html#promote"><span class="hs-identifier hs-var">promote</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Rose (Gen Prop)
</span><a href="#local-6989586621679121087"><span class="hs-identifier hs-var">props</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121085"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679121087"><span class="annot"><span class="annottext">props :: a -&gt; Rose (Gen Prop)
</span><a href="#local-6989586621679121087"><span class="hs-identifier hs-var hs-var">props</span></a></span></span><span> </span><span id="local-6989586621679121089"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121089"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">Gen Prop -&gt; [Rose (Gen Prop)] -&gt; Rose (Gen Prop)
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121086"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121089"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rose (Gen Prop)
</span><a href="#local-6989586621679121087"><span class="hs-identifier hs-var">props</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121090"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679121090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121090"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121084"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121089"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- | Disables shrinking for a property altogether.</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- Only quantification /inside/ the call to 'noShrinking' is affected.</span><span>
</span><span id="line-375"></span><span id="local-6989586621679121091"><span class="annot"><a href="Test.QuickCheck.Property.html#noShrinking"><span class="hs-identifier hs-type">noShrinking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121091"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121091"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-376"></span><span id="noShrinking"><span class="annot"><span class="annottext">noShrinking :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#noShrinking"><span class="hs-identifier hs-var hs-var">noShrinking</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-var">mapRoseResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Result -&gt; [Rose Result] -&gt; Rose Result)
-&gt; Rose Result -&gt; Rose Result
forall a. (a -&gt; [Rose a] -&gt; Rose a) -&gt; Rose a -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#onRose"><span class="hs-identifier hs-var">onRose</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121094"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121094"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121094"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><span class="hs-comment">-- | Adds a callback</span></span><span>
</span><span id="line-379"></span><span id="local-6989586621679120624"><span class="annot"><a href="Test.QuickCheck.Property.html#callback"><span class="hs-identifier hs-type">callback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120624"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Callback"><span class="hs-identifier hs-type">Callback</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120624"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-380"></span><span id="callback"><span class="annot"><span class="annottext">callback :: forall prop. Testable prop =&gt; Callback -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#callback"><span class="hs-identifier hs-var hs-var">callback</span></a></span></span><span> </span><span id="local-6989586621679121098"><span class="annot"><span class="annottext">Callback
</span><a href="#local-6989586621679121098"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121099"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121099"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121099"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121098"><span class="hs-identifier hs-type">cb</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121099"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><span class="hs-comment">-- | Adds the given string to the counterexample if the property fails.</span></span><span>
</span><span id="line-383"></span><span id="local-6989586621679120521"><span class="annot"><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-type">counterexample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120521"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120521"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-384"></span><span id="counterexample"><span class="annot"><span class="annottext">counterexample :: forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var hs-var">counterexample</span></a></span></span><span> </span><span id="local-6989586621679121104"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121104"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121105"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121105"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121105"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121104"><span class="hs-identifier hs-type">s</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121105"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">Callback -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Callback -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-var">PostFinalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121106"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121106"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679121107"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121107"><span class="hs-identifier hs-var">_res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621679121108"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121108"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="Test.QuickCheck.Property.html#showCounterexample"><span class="hs-identifier hs-var">showCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121104"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121106"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121108"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Test.QuickCheck.Property.html#showCounterexample"><span class="hs-identifier hs-type">showCounterexample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-391"></span><span id="showCounterexample"><span class="annot"><span class="annottext">showCounterexample :: String -&gt; IO String
</span><a href="Test.QuickCheck.Property.html#showCounterexample"><span class="hs-identifier hs-var hs-var">showCounterexample</span></a></span></span><span> </span><span id="local-6989586621679121110"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121110"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679121119"><span class="annot"><span class="annottext">force :: [a] -&gt; m ()
</span><a href="#local-6989586621679121119"><span class="hs-identifier hs-var hs-var">force</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><a href="#local-6989586621679121119"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679121120"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121120"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679121121"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679121121"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121120"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m () -&gt; m ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m ()
</span><a href="#local-6989586621679121119"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679121121"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679121122"><span class="annot"><span class="annottext">Either AnException ()
</span><a href="#local-6989586621679121122"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Either AnException ())
forall a. IO a -&gt; IO (Either AnException a)
</span><a href="Test.QuickCheck.Exception.html#tryEvaluateIO"><span class="hs-identifier hs-var">tryEvaluateIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ()
forall {m :: * -&gt; *} {a}. Monad m =&gt; [a] -&gt; m ()
</span><a href="#local-6989586621679121119"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121110"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either AnException ()
</span><a href="#local-6989586621679121122"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679121123"><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121123"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; AnException -&gt; String
</span><a href="Test.QuickCheck.Property.html#formatException"><span class="hs-identifier hs-var">formatException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Exception thrown while showing test case&quot;</span></span><span> </span><span class="annot"><span class="annottext">AnException
</span><a href="#local-6989586621679121123"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121110"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><span class="hs-comment">-- | Adds the given string to the counterexample if the property fails.</span></span><span>
</span><span id="line-403"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">printTestCase</span><span> </span><span class="hs-pragma">&quot;Use counterexample instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-404"></span><span id="local-6989586621679121124"><span class="annot"><a href="Test.QuickCheck.Property.html#printTestCase"><span class="hs-identifier hs-type">printTestCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121124"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121124"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-405"></span><span id="printTestCase"><span class="annot"><span class="annottext">printTestCase :: forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#printTestCase"><span class="hs-identifier hs-var hs-var">printTestCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><span class="hs-comment">-- | Performs an 'IO' action after the last failure of a property.</span></span><span>
</span><span id="line-408"></span><span id="local-6989586621679120634"><span class="annot"><a href="Test.QuickCheck.Property.html#whenFail"><span class="hs-identifier hs-type">whenFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120634"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120634"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-409"></span><span id="whenFail"><span class="annot"><span class="annottext">whenFail :: forall prop. Testable prop =&gt; IO () -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#whenFail"><span class="hs-identifier hs-var hs-var">whenFail</span></a></span></span><span> </span><span id="local-6989586621679121131"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679121131"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="annottext">Callback -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Callback -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="annot"><span class="annottext">(Callback -&gt; prop -&gt; Property) -&gt; Callback -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-var">PostFinalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#NotCounterexample"><span class="hs-identifier hs-var">NotCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121132"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121132"><span class="hs-identifier hs-var">_st</span></a></span></span><span> </span><span id="local-6989586621679121133"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121133"><span class="hs-identifier hs-var">_res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679121131"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | Performs an 'IO' action every time a property fails. Thus,</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- if shrinking is done, this can be used to keep track of the</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- failures along the way.</span><span>
</span><span id="line-416"></span><span id="local-6989586621679121134"><span class="annot"><a href="Test.QuickCheck.Property.html#whenFail%27"><span class="hs-identifier hs-type">whenFail'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121134"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121134"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-417"></span><span id="whenFail%27"><span class="annot"><span class="annottext">whenFail' :: forall prop. Testable prop =&gt; IO () -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#whenFail%27"><span class="hs-identifier hs-var hs-var">whenFail'</span></a></span></span><span> </span><span id="local-6989586621679121143"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679121143"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><span class="annottext">Callback -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Callback -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#callback"><span class="hs-identifier hs-var">callback</span></a></span><span> </span><span class="annot"><span class="annottext">(Callback -&gt; prop -&gt; Property) -&gt; Callback -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostTest"><span class="hs-identifier hs-var">PostTest</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#NotCounterexample"><span class="hs-identifier hs-var">NotCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121144"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121144"><span class="hs-identifier hs-var">_st</span></a></span></span><span> </span><span id="local-6989586621679121145"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121145"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121145"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679121143"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | Prints out the generated test case every time the property is tested.</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- Only variables quantified over /inside/ the 'verbose' are printed.</span><span>
</span><span id="line-425"></span><span class="hs-comment">--</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- Note: for technical reasons, the test case is printed out /after/</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- the property is tested. To debug a property that goes into an</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- infinite loop, use 'within' to add a timeout instead.</span><span>
</span><span id="line-429"></span><span id="local-6989586621679121147"><span class="annot"><a href="Test.QuickCheck.Property.html#verbose"><span class="hs-identifier hs-type">verbose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121147"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121147"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-430"></span><span id="verbose"><span class="annot"><span class="annottext">verbose :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#verbose"><span class="hs-identifier hs-var hs-var">verbose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapResult"><span class="hs-identifier hs-var">mapResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121150"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121150"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121150"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121151"><span class="hs-identifier hs-type">newCallback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121150"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121150"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679121151"><span class="annot"><span class="annottext">newCallback :: [Callback] -&gt; Callback
</span><a href="#local-6989586621679121151"><span class="hs-identifier hs-var hs-var">newCallback</span></a></span></span><span> </span><span id="local-6989586621679121156"><span class="annot"><span class="annottext">[Callback]
</span><a href="#local-6989586621679121156"><span class="hs-identifier hs-var">cbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>          </span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostTest"><span class="hs-identifier hs-var">PostTest</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121157"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121157"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679121158"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121158"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121157"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; String
</span><a href="#local-6989586621679121159"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121158"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">State -&gt; Result -&gt; IO ()
</span><a href="#local-6989586621679121161"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121157"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121158"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-type">PostFinalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span id="local-6989586621679121161"><span class="annot"><span class="annottext">State -&gt; Result -&gt; IO ()
</span><a href="#local-6989586621679121161"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Callback]
</span><a href="#local-6989586621679121156"><span class="hs-identifier hs-var">cbs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>            </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121157"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-436"></span><span>        </span><span id="local-6989586621679121159"><span class="annot"><span class="annottext">status :: Result -&gt; String
</span><a href="#local-6989586621679121159"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-type">MkResult</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ok :: Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Passed&quot;</span></span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><a href="#local-6989586621679121159"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-type">MkResult</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ok :: Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed&quot;</span></span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><a href="#local-6989586621679121159"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-type">MkResult</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ok :: Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Skipped (precondition false)&quot;</span></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Prints out the generated test case every time the property fails, including during shrinking.</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- Only variables quantified over /inside/ the 'verboseShrinking' are printed.</span><span>
</span><span id="line-442"></span><span class="hs-comment">--</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- Note: for technical reasons, the test case is printed out /after/</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- the property is tested. To debug a property that goes into an</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- infinite loop, use 'within' to add a timeout instead.</span><span>
</span><span id="line-446"></span><span id="local-6989586621679121163"><span class="annot"><a href="Test.QuickCheck.Property.html#verboseShrinking"><span class="hs-identifier hs-type">verboseShrinking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121163"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121163"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-447"></span><span id="verboseShrinking"><span class="annot"><span class="annottext">verboseShrinking :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#verboseShrinking"><span class="hs-identifier hs-var hs-var">verboseShrinking</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapResult"><span class="hs-identifier hs-var">mapResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121166"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121166"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121166"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121167"><span class="hs-identifier hs-type">newCallback</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121166"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121166"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679121167"><span class="annot"><span class="annottext">newCallback :: [Callback] -&gt; Callback
</span><a href="#local-6989586621679121167"><span class="hs-identifier hs-var hs-var">newCallback</span></a></span></span><span> </span><span id="local-6989586621679121176"><span class="annot"><span class="annottext">[Callback]
</span><a href="#local-6989586621679121176"><span class="hs-identifier hs-var">cbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>          </span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostTest"><span class="hs-identifier hs-var">PostTest</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121177"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121177"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679121178"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121178"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121178"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>              </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121177"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed:&quot;</span></span><span>
</span><span id="line-452"></span><span>              </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">State -&gt; Result -&gt; IO ()
</span><a href="#local-6989586621679121180"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121177"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121178"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-type">PostFinalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span id="local-6989586621679121180"><span class="annot"><span class="annottext">State -&gt; Result -&gt; IO ()
</span><a href="#local-6989586621679121180"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Callback]
</span><a href="#local-6989586621679121176"><span class="hs-identifier hs-var">cbs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>              </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121177"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- | Indicates that a property is supposed to fail.</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- QuickCheck will report an error if it does not fail.</span><span>
</span><span id="line-457"></span><span id="local-6989586621679121181"><span class="annot"><a href="Test.QuickCheck.Property.html#expectFailure"><span class="hs-identifier hs-type">expectFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121181"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121181"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-458"></span><span id="expectFailure"><span class="annot"><span class="annottext">expectFailure :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#expectFailure"><span class="hs-identifier hs-var hs-var">expectFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121185"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121185"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121185"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Modifies a property so that it only will be tested once.</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- Opposite of 'again'.</span><span>
</span><span id="line-462"></span><span id="local-6989586621679121186"><span class="annot"><a href="Test.QuickCheck.Property.html#once"><span class="hs-identifier hs-type">once</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121186"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121186"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-463"></span><span id="once"><span class="annot"><span class="annottext">once :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#once"><span class="hs-identifier hs-var hs-var">once</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121190"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121190"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121190"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#abort"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Modifies a property so that it will be tested repeatedly.</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- Opposite of 'once'.</span><span>
</span><span id="line-467"></span><span id="local-6989586621679121191"><span class="annot"><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-type">again</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121191"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121191"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-468"></span><span id="again"><span class="annot"><span class="annottext">again :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var hs-var">again</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121194"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121194"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121194"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#abort"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Configures how many times a property will be tested.</span><span>
</span><span id="line-471"></span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- For example,</span><span>
</span><span id="line-473"></span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- &gt; quickCheck (withMaxSuccess 1000 p)</span><span>
</span><span id="line-475"></span><span class="hs-comment">--</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- will test @p@ up to 1000 times.</span><span>
</span><span id="line-477"></span><span id="local-6989586621679120648"><span class="annot"><a href="Test.QuickCheck.Property.html#withMaxSuccess"><span class="hs-identifier hs-type">withMaxSuccess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120648"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120648"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-478"></span><span id="withMaxSuccess"><span class="annot"><span class="annottext">withMaxSuccess :: forall prop. Testable prop =&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#withMaxSuccess"><span class="hs-identifier hs-var hs-var">withMaxSuccess</span></a></span></span><span> </span><span id="local-6989586621679121198"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121198"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121198"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121199"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121199"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121199"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#maybeNumTests"><span class="hs-identifier hs-var">maybeNumTests</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679121198"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | Check that all coverage requirements defined by 'cover' and 'coverTable'</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- are met, using a statistically sound test, and fail if they are not met.</span><span>
</span><span id="line-482"></span><span class="hs-comment">--</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- Ordinarily, a failed coverage check does not cause the property to fail.</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- This is because the coverage requirement is not tested in a statistically</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- sound way. If you use 'cover' to express that a certain value must appear 20%</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- of the time, QuickCheck will warn you if the value only appears in 19 out of</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- 100 test cases - but since the coverage varies randomly, you may have just</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- been unlucky, and there may not be any real problem with your test</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- generation.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- When you use 'checkCoverage', QuickCheck uses a statistical test to account</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- for the role of luck in coverage failures. It will run as many tests as</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- needed until it is sure about whether the coverage requirements are met. If a</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- coverage requirement is not met, the property fails.</span><span>
</span><span id="line-495"></span><span class="hs-comment">--</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-497"></span><span class="hs-comment">--</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- &gt; quickCheck (checkCoverage prop_foo)</span><span>
</span><span id="line-499"></span><span id="local-6989586621679121203"><span class="annot"><a href="Test.QuickCheck.Property.html#checkCoverage"><span class="hs-identifier hs-type">checkCoverage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121203"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121203"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-500"></span><span id="checkCoverage"><span class="annot"><span class="annottext">checkCoverage :: forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#checkCoverage"><span class="hs-identifier hs-var hs-var">checkCoverage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Confidence -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Confidence -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#checkCoverageWith"><span class="hs-identifier hs-var">checkCoverageWith</span></a></span><span> </span><span class="annot"><span class="annottext">Confidence
</span><a href="Test.QuickCheck.Property.html#stdConfidence"><span class="hs-identifier hs-var">stdConfidence</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">-- | Check coverage requirements using a custom confidence level.</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- See 'stdConfidence'.</span><span>
</span><span id="line-504"></span><span class="hs-comment">--</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- An example of making the statistical test less stringent in order to improve</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- performance:</span><span>
</span><span id="line-507"></span><span class="hs-comment">--</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- &gt; quickCheck (checkCoverageWith stdConfidence{certainty = 10^6} prop_foo)</span><span>
</span><span id="line-509"></span><span id="local-6989586621679120651"><span class="annot"><a href="Test.QuickCheck.Property.html#checkCoverageWith"><span class="hs-identifier hs-type">checkCoverageWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120651"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html#Confidence"><span class="hs-identifier hs-type">Confidence</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120651"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-510"></span><span id="checkCoverageWith"><span class="annot"><span class="annottext">checkCoverageWith :: forall prop. Testable prop =&gt; Confidence -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#checkCoverageWith"><span class="hs-identifier hs-var hs-var">checkCoverageWith</span></a></span></span><span> </span><span id="local-6989586621679121210"><span class="annot"><span class="annottext">Confidence
</span><a href="#local-6989586621679121210"><span class="hs-identifier hs-var">confidence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><span class="annottext">Confidence -&gt; Integer
</span><a href="Test.QuickCheck.State.html#certainty"><span class="hs-identifier hs-var">certainty</span></a></span><span> </span><span class="annot"><span class="annottext">Confidence
</span><a href="#local-6989586621679121210"><span class="hs-identifier hs-var">confidence</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="annottext">Confidence -&gt; Double
</span><a href="Test.QuickCheck.State.html#tolerance"><span class="hs-identifier hs-var">tolerance</span></a></span><span> </span><span class="annot"><span class="annottext">Confidence
</span><a href="#local-6989586621679121210"><span class="hs-identifier hs-var">confidence</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121213"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121213"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121213"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#maybeCheckCoverage"><span class="hs-identifier hs-var">maybeCheckCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679121210"><span class="hs-identifier hs-type">confidence</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | The standard parameters used by 'checkCoverage': @certainty = 10^9@,</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- @tolerance = 0.9@. See 'Confidence' for the meaning of the parameters.</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Test.QuickCheck.Property.html#stdConfidence"><span class="hs-identifier hs-type">stdConfidence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.State.html#Confidence"><span class="hs-identifier hs-type">Confidence</span></a></span><span>
</span><span id="line-518"></span><span id="stdConfidence"><span class="annot"><span class="annottext">stdConfidence :: Confidence
</span><a href="Test.QuickCheck.Property.html#stdConfidence"><span class="hs-identifier hs-var hs-var">stdConfidence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><a href="Test.QuickCheck.State.html#Confidence"><span class="hs-identifier hs-type">Confidence</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><span class="annottext">certainty :: Integer
</span><a href="Test.QuickCheck.State.html#certainty"><span class="hs-identifier hs-var">certainty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><span class="annottext">tolerance :: Double
</span><a href="Test.QuickCheck.State.html#tolerance"><span class="hs-identifier hs-var">tolerance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.9</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | Attaches a label to a test case. This is used for reporting</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- test case distribution.</span><span>
</span><span id="line-525"></span><span class="hs-comment">--</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-527"></span><span class="hs-comment">--</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- &gt; prop_reverse_reverse :: [Int] -&gt; Property</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- &gt; prop_reverse_reverse xs =</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- &gt;   label (&quot;length of input is &quot; ++ show (length xs)) $</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- &gt;     reverse (reverse xs) === xs</span><span>
</span><span id="line-532"></span><span class="hs-comment">--</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_reverse_reverse</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- +++ OK, passed 100 tests:</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- 7% length of input is 7</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- 6% length of input is 3</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- 5% length of input is 4</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- 4% length of input is 6</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-540"></span><span class="hs-comment">--</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- Each use of 'label' in your property results in a separate</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- table of test case distribution in the output. If this is</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- not what you want, use 'tabulate'.</span><span>
</span><span id="line-544"></span><span id="local-6989586621679121218"><span class="annot"><a href="Test.QuickCheck.Property.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121218"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121218"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-545"></span><span id="label"><span class="annot"><span class="annottext">label :: forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679121225"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121225"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifndef NO_DEEPSEQ
</span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121225"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="annot"><span class="annottext">((Result -&gt; Result) -&gt; prop -&gt; Property)
-&gt; (Result -&gt; Result) -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679121227"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121227"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121227"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121225"><span class="hs-identifier hs-type">s</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121227"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- | Attaches a label to a test case. This is used for reporting</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- test case distribution.</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- &gt; collect x = label (show x)</span><span>
</span><span id="line-556"></span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-558"></span><span class="hs-comment">--</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- &gt; prop_reverse_reverse :: [Int] -&gt; Property</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- &gt; prop_reverse_reverse xs =</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- &gt;   collect (length xs) $</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- &gt;     reverse (reverse xs) === xs</span><span>
</span><span id="line-563"></span><span class="hs-comment">--</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_reverse_reverse</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- +++ OK, passed 100 tests:</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- 7% 7</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- 6% 3</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- 5% 4</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- 4% 6</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- ...</span><span>
</span><span id="line-571"></span><span class="hs-comment">--</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- Each use of 'collect' in your property results in a separate</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- table of test case distribution in the output. If this is</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- not what you want, use 'tabulate'.</span><span>
</span><span id="line-575"></span><span id="local-6989586621679120660"><span id="local-6989586621679120661"><span class="annot"><a href="Test.QuickCheck.Property.html#collect"><span class="hs-identifier hs-type">collect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120661"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120661"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-576"></span><span id="collect"><span class="annot"><span class="annottext">collect :: forall a prop. (Show a, Testable prop) =&gt; a -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#collect"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span id="local-6989586621679121233"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121233"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121233"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | Reports how many test cases satisfy a given condition.</span><span>
</span><span id="line-579"></span><span class="hs-comment">--</span><span>
</span><span id="line-580"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-581"></span><span class="hs-comment">--</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- &gt; prop_sorted_sort :: [Int] -&gt; Property</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- &gt; prop_sorted_sort xs =</span><span>
</span><span id="line-584"></span><span class="hs-comment">-- &gt;   sorted xs ==&gt;</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- &gt;   classify (length xs &gt; 1) &quot;non-trivial&quot; $</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- &gt;   sort xs === xs</span><span>
</span><span id="line-587"></span><span class="hs-comment">--</span><span>
</span><span id="line-588"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_sorted_sort</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- +++ OK, passed 100 tests (22% non-trivial).</span><span>
</span><span id="line-590"></span><span id="local-6989586621679120664"><span class="annot"><a href="Test.QuickCheck.Property.html#classify"><span class="hs-identifier hs-type">classify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120664"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-591"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ @True@ if the test case should be labelled.</span></span><span>
</span><span id="line-592"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Label.</span></span><span>
</span><span id="line-593"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120664"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-594"></span><span id="classify"><span class="annot"><span class="annottext">classify :: forall prop. Testable prop =&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#classify"><span class="hs-identifier hs-var hs-var">classify</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span>
</span><span id="line-595"></span><span class="annot"><a href="Test.QuickCheck.Property.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679121240"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121240"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifndef NO_DEEPSEQ
</span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121240"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="annot"><span class="annottext">((Result -&gt; Result) -&gt; prop -&gt; Property)
-&gt; (Result -&gt; Result) -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679121241"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121241"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121241"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121240"><span class="hs-identifier hs-type">s</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121241"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">-- | Checks that at least the given proportion of /successful/ test</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- cases belong to the given class. Discarded tests (i.e. ones</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- with a false precondition) do not affect coverage.</span><span>
</span><span id="line-605"></span><span class="hs-comment">--</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- __Note:__ If the coverage check fails, QuickCheck prints out a warning, but</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- the property does /not/ fail. To make the property fail, use 'checkCoverage'.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-610"></span><span class="hs-comment">--</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- &gt; prop_sorted_sort :: [Int] -&gt; Property</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- &gt; prop_sorted_sort xs =</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- &gt;   sorted xs ==&gt;</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- &gt;   cover 50 (length xs &gt; 1) &quot;non-trivial&quot; $</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- &gt;   sort xs === xs</span><span>
</span><span id="line-616"></span><span class="hs-comment">--</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_sorted_sort</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- +++ OK, passed 100 tests; 135 discarded (26% non-trivial).</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- Only 26% non-trivial, but expected 50%</span><span>
</span><span id="line-621"></span><span id="local-6989586621679120666"><span class="annot"><a href="Test.QuickCheck.Property.html#cover"><span class="hs-identifier hs-type">cover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120666"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-622"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The required percentage (0-100) of test cases.</span></span><span>
</span><span id="line-623"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ @True@ if the test case belongs to the class.</span></span><span>
</span><span id="line-624"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Label for the test case class.</span></span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120666"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-626"></span><span id="cover"><span class="annot"><span class="annottext">cover :: forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#cover"><span class="hs-identifier hs-var hs-var">cover</span></a></span></span><span> </span><span id="local-6989586621679121245"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679121245"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679121246"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121246"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679121247"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121247"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121248"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121246"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121247"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621679121248"><span class="annot"><span class="annottext">f :: Result -&gt; Result
</span><a href="#local-6989586621679121248"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679121253"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121253"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121253"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679121247"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679121245"><span class="hs-identifier hs-type">p</span></a></span><span class="annot"><span class="hs-operator hs-type">/</span></span><span class="annot"><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121253"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="hs-comment">-- | Collects information about test case distribution into a table.</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- The arguments to 'tabulate' are the table's name and a list of values</span><span>
</span><span id="line-632"></span><span class="hs-comment">-- associated with the current test case. After testing, QuickCheck prints the</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- frequency of all collected values. The frequencies are expressed as a</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- percentage of the total number of values collected.</span><span>
</span><span id="line-635"></span><span class="hs-comment">--</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- You should prefer 'tabulate' to 'label' when each test case is associated</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- with a varying number of values. Here is a (not terribly useful) example,</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- where the test data is a list of integers and we record all values that</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- occur in the list:</span><span>
</span><span id="line-640"></span><span class="hs-comment">--</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- &gt; prop_sorted_sort :: [Int] -&gt; Property</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- &gt; prop_sorted_sort xs =</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- &gt;   sorted xs ==&gt;</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- &gt;   tabulate &quot;List elements&quot; (map show xs) $</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- &gt;   sort xs === xs</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_sorted_sort</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- +++ OK, passed 100 tests; 1684 discarded.</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- List elements (109 in total):</span><span>
</span><span id="line-651"></span><span class="hs-comment">--  3.7% 0</span><span>
</span><span id="line-652"></span><span class="hs-comment">--  3.7% 17</span><span>
</span><span id="line-653"></span><span class="hs-comment">--  3.7% 2</span><span>
</span><span id="line-654"></span><span class="hs-comment">--  3.7% 6</span><span>
</span><span id="line-655"></span><span class="hs-comment">--  2.8% -6</span><span>
</span><span id="line-656"></span><span class="hs-comment">--  2.8% -7</span><span>
</span><span id="line-657"></span><span class="hs-comment">--</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- Here is a more useful example. We are testing a chatroom, where the user can</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- log in, log out, or send a message:</span><span>
</span><span id="line-660"></span><span class="hs-comment">--</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- &gt; data Command = LogIn | LogOut | SendMessage String deriving (Data, Show)</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- &gt; instance Arbitrary Command where ...</span><span>
</span><span id="line-663"></span><span class="hs-comment">--</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- There are some restrictions on command sequences; for example, the user must</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- log in before doing anything else. The function @valid :: [Command] -&gt; Bool@</span><span>
</span><span id="line-666"></span><span class="hs-comment">-- checks that a command sequence is allowed. Our property then has the form:</span><span>
</span><span id="line-667"></span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- &gt; prop_chatroom :: [Command] -&gt; Property</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- &gt; prop_chatroom cmds =</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- &gt;   valid cmds ==&gt;</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- &gt;     ...</span><span>
</span><span id="line-672"></span><span class="hs-comment">--</span><span>
</span><span id="line-673"></span><span class="hs-comment">-- The use of '==&gt;' may skew test case distribution. We use 'collect' to see the</span><span>
</span><span id="line-674"></span><span class="hs-comment">-- length of the command sequences, and 'tabulate' to get the frequencies of the</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- individual commands:</span><span>
</span><span id="line-676"></span><span class="hs-comment">--</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- &gt; prop_chatroom :: [Command] -&gt; Property</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- &gt; prop_chatroom cmds =</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- &gt;   wellFormed cmds LoggedOut ==&gt;</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- &gt;   'collect' (length cmds) $</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- &gt;   'tabulate' &quot;Commands&quot; (map (show . 'Data.Data.toConstr') cmds) $</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- &gt;     ...</span><span>
</span><span id="line-683"></span><span class="hs-comment">--</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheckWith stdArgs{maxDiscardRatio = 1000} prop_chatroom</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- +++ OK, passed 100 tests; 2775 discarded:</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- 60% 0</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- 20% 1</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- 15% 2</span><span>
</span><span id="line-689"></span><span class="hs-comment">--  3% 3</span><span>
</span><span id="line-690"></span><span class="hs-comment">--  1% 4</span><span>
</span><span id="line-691"></span><span class="hs-comment">--  1% 5</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-693"></span><span class="hs-comment">-- Commands (68 in total):</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- 62% LogIn</span><span>
</span><span id="line-695"></span><span class="hs-comment">-- 22% SendMessage</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- 16% LogOut</span><span>
</span><span id="line-697"></span><span id="local-6989586621679120669"><span class="annot"><a href="Test.QuickCheck.Property.html#tabulate"><span class="hs-identifier hs-type">tabulate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120669"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120669"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-698"></span><span id="tabulate"><span class="annot"><span class="annottext">tabulate :: forall prop.
Testable prop =&gt;
String -&gt; [String] -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#tabulate"><span class="hs-identifier hs-var hs-var">tabulate</span></a></span></span><span> </span><span id="local-6989586621679121260"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121260"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679121261"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679121261"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifndef NO_DEEPSEQ
</span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121260"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679121261"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="annot"><span class="annottext">((Result -&gt; Result) -&gt; prop -&gt; Property)
-&gt; (Result -&gt; Result) -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679121262"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121262"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121262"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121260"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679121263"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679121263"><span class="annot"><a href="#local-6989586621679121263"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679121261"><span class="hs-identifier hs-type">values</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121262"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span class="hs-comment">-- | Checks that the values in a given 'table' appear a certain proportion of</span><span>
</span><span id="line-706"></span><span class="hs-comment">-- the time. A call to 'coverTable' @table@ @[(x1, p1), ..., (xn, pn)]@ asserts</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- that of the values in @table@, @x1@ should appear at least @p1@ percent of</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- the time, @x2@ at least @p2@ percent of the time, and so on.</span><span>
</span><span id="line-709"></span><span class="hs-comment">--</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- __Note:__ If the coverage check fails, QuickCheck prints out a warning, but</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- the property does /not/ fail. To make the property fail, use 'checkCoverage'.</span><span>
</span><span id="line-712"></span><span class="hs-comment">--</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- Continuing the example from the 'tabular' combinator...</span><span>
</span><span id="line-714"></span><span class="hs-comment">--</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- &gt; data Command = LogIn | LogOut | SendMessage String deriving (Data, Show)</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- &gt; prop_chatroom :: [Command] -&gt; Property</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- &gt; prop_chatroom cmds =</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- &gt;   wellFormed cmds LoggedOut ==&gt;</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- &gt;   'tabulate' &quot;Commands&quot; (map (show . 'Data.Data.toConstr') cmds) $</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- &gt;     ...</span><span>
</span><span id="line-721"></span><span class="hs-comment">--</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- ...we can add a coverage requirement as follows, which checks that @LogIn@,</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- @LogOut@ and @SendMessage@ each occur at least 25% of the time:</span><span>
</span><span id="line-724"></span><span class="hs-comment">--</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- &gt; prop_chatroom :: [Command] -&gt; Property</span><span>
</span><span id="line-726"></span><span class="hs-comment">-- &gt; prop_chatroom cmds =</span><span>
</span><span id="line-727"></span><span class="hs-comment">-- &gt;   wellFormed cmds LoggedOut ==&gt;</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- &gt;   coverTable &quot;Commands&quot; [(&quot;LogIn&quot;, 25), (&quot;LogOut&quot;, 25), (&quot;SendMessage&quot;, 25)] $</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- &gt;   'tabulate' &quot;Commands&quot; (map (show . 'Data.Data.toConstr') cmds) $</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- &gt;     ... property goes here ...</span><span>
</span><span id="line-731"></span><span class="hs-comment">--</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- &gt;&gt;&gt; quickCheck prop_chatroom</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- +++ OK, passed 100 tests; 2909 discarded:</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- 56% 0</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- 17% 1</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- 10% 2</span><span>
</span><span id="line-737"></span><span class="hs-comment">--  6% 3</span><span>
</span><span id="line-738"></span><span class="hs-comment">--  5% 4</span><span>
</span><span id="line-739"></span><span class="hs-comment">--  3% 5</span><span>
</span><span id="line-740"></span><span class="hs-comment">--  3% 7</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- Commands (111 in total):</span><span>
</span><span id="line-743"></span><span class="hs-comment">-- 51.4% LogIn</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- 30.6% SendMessage</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- 18.0% LogOut</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- &lt;BLANKLINE&gt;</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- Table 'Commands' had only 18.0% LogOut, but expected 25.0%</span><span>
</span><span id="line-748"></span><span id="local-6989586621679120671"><span class="annot"><a href="Test.QuickCheck.Property.html#coverTable"><span class="hs-identifier hs-type">coverTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120671"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-749"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120671"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-750"></span><span id="coverTable"><span class="annot"><span class="annottext">coverTable :: forall prop.
Testable prop =&gt;
String -&gt; [(String, Double)] -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#coverTable"><span class="hs-identifier hs-var hs-var">coverTable</span></a></span></span><span> </span><span id="local-6989586621679121273"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121273"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621679121274"><span class="annot"><span class="annottext">[(String, Double)]
</span><a href="#local-6989586621679121274"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifndef NO_DEEPSEQ
</span><span>  </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121273"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span> </span><span class="annot"><span class="annottext">[(String, Double)]
</span><a href="#local-6989586621679121274"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, Double)] -&gt; (prop -&gt; Property) -&gt; prop -&gt; Property
forall a b. NFData a =&gt; a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`deepseq`</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Result -&gt; Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapTotalResult"><span class="hs-identifier hs-var">mapTotalResult</span></a></span><span> </span><span class="annot"><span class="annottext">((Result -&gt; Result) -&gt; prop -&gt; Property)
-&gt; (Result -&gt; Result) -&gt; prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679121275"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121275"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121275"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679121276"><span class="hs-identifier hs-type">ys</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121275"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-756"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-757"></span><span>    </span><span id="local-6989586621679121276"><span class="annot"><span class="annottext">ys :: [(Maybe String, String, Double)]
</span><a href="#local-6989586621679121276"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121273"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121279"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679121280"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679121279"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121279"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679121280"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679121280"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, Double)]
</span><a href="#local-6989586621679121274"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-758"></span><span>
</span><span id="line-759"></span><span class="hs-comment">-- | Implication for properties: The resulting property holds if</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- the first argument is 'False' (in which case the test case is discarded),</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- or if the given property holds. Note that using implication carelessly can</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- severely skew test case distribution: consider using 'cover' to make sure</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- that your test data is still good quality.</span><span>
</span><span id="line-764"></span><span id="local-6989586621679120675"><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-type">(==&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120675"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120675"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-765"></span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="%3D%3D%3E"><span class="annot"><span class="annottext">==&gt; :: forall prop. Testable prop =&gt; Bool -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-var hs-var">==&gt;</span></a></span></span><span> </span><span class="annot"><span class="annottext">prop
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Discard -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">Discard
</span><a href="Test.QuickCheck.Property.html#Discard"><span class="hs-identifier hs-var">Discard</span></a></span><span>
</span><span id="line-766"></span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%3D%3E"><span class="hs-operator hs-var">==&gt;</span></a></span><span> </span><span id="local-6989586621679121284"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679121284"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679121284"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span class="hs-comment">-- | Considers a property failed if it does not complete within</span><span>
</span><span id="line-769"></span><span class="hs-comment">-- the given number of microseconds.</span><span>
</span><span id="line-770"></span><span class="hs-comment">--</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- Note: if the property times out, variables quantified inside the</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- `within` will not be printed. Therefore, you should use `within`</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- only in the body of your property.</span><span>
</span><span id="line-774"></span><span class="hs-comment">--</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- Good: @prop_foo a b c = within 1000000 ...@</span><span>
</span><span id="line-776"></span><span class="hs-comment">--</span><span>
</span><span id="line-777"></span><span class="hs-comment">-- Bad: @prop_foo = within 1000000 $ \\a b c -&gt; ...@</span><span>
</span><span id="line-778"></span><span class="hs-comment">--</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- Bad: @prop_foo a b c = ...; main = quickCheck (within 1000000 prop_foo)@</span><span>
</span><span id="line-780"></span><span id="local-6989586621679121285"><span class="annot"><a href="Test.QuickCheck.Property.html#within"><span class="hs-identifier hs-type">within</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121285"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121285"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-781"></span><span id="within"><span class="annot"><span class="annottext">within :: forall prop. Testable prop =&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#within"><span class="hs-identifier hs-var hs-var">within</span></a></span></span><span> </span><span id="local-6989586621679121290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121290"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Int -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Result -&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#onTimeout"><span class="hs-identifier hs-var">onTimeout</span></a></span><span>
</span><span id="line-782"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Timeout of &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621679121290"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; microseconds exceeded.&quot;</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>   </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121290"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">-- | Discards the test case if it does not complete within the given</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- number of microseconds. This can be useful when testing algorithms</span><span>
</span><span id="line-787"></span><span class="hs-comment">-- that have pathological cases where they run extremely slowly.</span><span>
</span><span id="line-788"></span><span id="local-6989586621679121292"><span class="annot"><a href="Test.QuickCheck.Property.html#discardAfter"><span class="hs-identifier hs-type">discardAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121292"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121292"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-789"></span><span id="discardAfter"><span class="annot"><span class="annottext">discardAfter :: forall prop. Testable prop =&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#discardAfter"><span class="hs-identifier hs-var hs-var">discardAfter</span></a></span></span><span> </span><span id="local-6989586621679121297"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121297"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Int -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; Result -&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#onTimeout"><span class="hs-identifier hs-var">onTimeout</span></a></span><span>
</span><span id="line-790"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#rejected"><span class="hs-identifier hs-var">rejected</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;Timeout of &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621679121297"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; microseconds exceeded.&quot;</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>   </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121297"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span id="local-6989586621679120678"><span class="annot"><a href="Test.QuickCheck.Property.html#onTimeout"><span class="hs-identifier hs-type">onTimeout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120678"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120678"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-794"></span><span id="onTimeout"><span class="annot"><span class="annottext">onTimeout :: forall prop. Testable prop =&gt; Result -&gt; Int -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#onTimeout"><span class="hs-identifier hs-var hs-var">onTimeout</span></a></span></span><span> </span><span id="local-6989586621679121300"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121300"><span class="hs-identifier hs-var">timeoutResult</span></a></span></span><span> </span><span id="local-6989586621679121301"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121301"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
forall prop.
Testable prop =&gt;
(Rose Result -&gt; Rose Result) -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#mapRoseResult"><span class="hs-identifier hs-var">mapRoseResult</span></a></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121302"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-795"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-796"></span><span>    </span><span id="local-6989586621679121302"><span class="annot"><span class="annottext">f :: Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121302"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679121312"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121312"><span class="hs-identifier hs-var">rose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#ioRose"><span class="hs-identifier hs-var">ioRose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; IO (Rose Result) -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-797"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679121315"><span class="annot"><span class="annottext">f (Maybe b)
</span><a href="#local-6989586621679121315"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679121316"><span class="annot"><span class="annottext">orError :: f (Maybe b) -&gt; b -&gt; f b
</span><a href="#local-6989586621679121316"><span class="hs-operator hs-var hs-var">`orError`</span></a></span></span><span> </span><span id="local-6989586621679121317"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679121317"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe b -&gt; b) -&gt; f (Maybe b) -&gt; f b
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Maybe b -&gt; b
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679121317"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (Maybe b)
</span><a href="#local-6989586621679121315"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-798"></span><span>      </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679121319"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121319"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679121320"><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121320"><span class="hs-identifier hs-var">roses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Rose Result) -&gt; IO (Maybe (Rose Result))
forall a. Int -&gt; IO a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">timeout</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121301"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var">reduceRose</span></a></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121312"><span class="hs-identifier hs-var">rose</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Rose Result)) -&gt; Rose Result -&gt; IO (Rose Result)
forall {f :: * -&gt; *} {b}. Functor f =&gt; f (Maybe b) -&gt; b -&gt; f b
</span><a href="#local-6989586621679121316"><span class="hs-operator hs-var">`orError`</span></a></span><span>
</span><span id="line-799"></span><span>        </span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121300"><span class="hs-identifier hs-var">timeoutResult</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span id="local-6989586621679121321"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121321"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Result -&gt; IO (Maybe Result)
forall a. Int -&gt; IO a -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">timeout</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679121301"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO Result -&gt; IO Result
</span><a href="Test.QuickCheck.Property.html#protectResult"><span class="hs-identifier hs-var">protectResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121319"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Result) -&gt; Result -&gt; IO Result
forall {f :: * -&gt; *} {b}. Functor f =&gt; f (Maybe b) -&gt; b -&gt; f b
</span><a href="#local-6989586621679121316"><span class="hs-operator hs-var">`orError`</span></a></span><span>
</span><span id="line-801"></span><span>        </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121300"><span class="hs-identifier hs-var">timeoutResult</span></a></span><span>
</span><span id="line-802"></span><span>      </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121321"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result) -&gt; [Rose Result] -&gt; [Rose Result]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121302"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121320"><span class="hs-identifier hs-var">roses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#ifdef NO_TIMEOUT
</span><span>    </span><span class="hs-identifier">timeout</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">Just</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- | Explicit universal quantification: uses an explicitly given</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- test case generator.</span><span>
</span><span id="line-811"></span><span id="local-6989586621679120685"><span id="local-6989586621679120686"><span class="annot"><a href="Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679120685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120686"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120685"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120686"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-813"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span id="local-6989586621679121326"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121326"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121327"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121327"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrink"><span class="hs-identifier hs-var">forAllShrink</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121326"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121327"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span class="annot"><span class="hs-comment">-- | Like 'forAll', but with an explicitly given show function.</span></span><span>
</span><span id="line-816"></span><span id="local-6989586621679120691"><span id="local-6989586621679120692"><span class="annot"><a href="Test.QuickCheck.Property.html#forAllShow"><span class="hs-identifier hs-type">forAllShow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120691"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-817"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120691"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-818"></span><span id="forAllShow"><span class="annot"><span class="annottext">forAllShow :: forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShow"><span class="hs-identifier hs-var hs-var">forAllShow</span></a></span></span><span> </span><span id="local-6989586621679121332"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121332"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121333"><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679121333"><span class="hs-identifier hs-var">shower</span></a></span></span><span> </span><span id="local-6989586621679121334"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121334"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkShow"><span class="hs-identifier hs-var">forAllShrinkShow</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121332"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679121333"><span class="hs-identifier hs-var">shower</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121334"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="annot"><span class="hs-comment">-- | Like 'forAll', but without printing the generated value.</span></span><span>
</span><span id="line-821"></span><span id="local-6989586621679120697"><span id="local-6989586621679120698"><span class="annot"><a href="Test.QuickCheck.Property.html#forAllBlind"><span class="hs-identifier hs-type">forAllBlind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120697"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-822"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120697"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-823"></span><span id="forAllBlind"><span class="annot"><span class="annottext">forAllBlind :: forall prop a. Testable prop =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllBlind"><span class="hs-identifier hs-var hs-var">forAllBlind</span></a></span></span><span> </span><span id="local-6989586621679121339"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121339"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121340"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121340"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-var">forAllShrinkBlind</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121339"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121340"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="annot"><span class="hs-comment">-- | Like 'forAll', but tries to shrink the argument for failing test cases.</span></span><span>
</span><span id="line-826"></span><span id="local-6989586621679120689"><span id="local-6989586621679120690"><span class="annot"><a href="Test.QuickCheck.Property.html#forAllShrink"><span class="hs-identifier hs-type">forAllShrink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679120689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120690"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120690"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-828"></span><span id="forAllShrink"><span class="annot"><span class="annottext">forAllShrink :: forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrink"><span class="hs-identifier hs-var hs-var">forAllShrink</span></a></span></span><span> </span><span id="local-6989586621679121345"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121345"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121346"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121346"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkShow"><span class="hs-identifier hs-var">forAllShrinkShow</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121345"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121346"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span class="annot"><span class="hs-comment">-- | Like 'forAllShrink', but with an explicitly given show function.</span></span><span>
</span><span id="line-831"></span><span id="local-6989586621679120695"><span id="local-6989586621679120696"><span class="annot"><a href="Test.QuickCheck.Property.html#forAllShrinkShow"><span class="hs-identifier hs-type">forAllShrinkShow</span></a></span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120695"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-833"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120695"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-834"></span><span id="forAllShrinkShow"><span class="annot"><span class="annottext">forAllShrinkShow :: forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; String) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkShow"><span class="hs-identifier hs-var hs-var">forAllShrinkShow</span></a></span></span><span> </span><span id="local-6989586621679121350"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121350"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121351"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121351"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679121352"><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679121352"><span class="hs-identifier hs-var">shower</span></a></span></span><span> </span><span id="local-6989586621679121353"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121353"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-835"></span><span>  </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-var">forAllShrinkBlind</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121350"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121351"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679121354"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121354"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679121352"><span class="hs-identifier hs-var">shower</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121354"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121353"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121354"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><span class="hs-comment">-- | Like 'forAllShrink', but without printing the generated value.</span></span><span>
</span><span id="line-838"></span><span id="local-6989586621679120513"><span id="local-6989586621679120514"><span class="annot"><a href="Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-type">forAllShrinkBlind</span></a></span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120513"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-840"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Gen.html#Gen"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679120514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120513"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-841"></span><span id="forAllShrinkBlind"><span class="annot"><span class="annottext">forAllShrinkBlind :: forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#forAllShrinkBlind"><span class="hs-identifier hs-var hs-var">forAllShrinkBlind</span></a></span></span><span> </span><span id="local-6989586621679121359"><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121359"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679121360"><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121360"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679121361"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121361"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-842"></span><span>  </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var">again</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-843"></span><span>  </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; Gen Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-844"></span><span>  </span><span class="annot"><span class="annottext">Gen a
</span><a href="#local-6989586621679121359"><span class="hs-identifier hs-var">gen</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; Gen Prop) -&gt; Gen Prop
forall a b. Gen a -&gt; (a -&gt; Gen b) -&gt; Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121362"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121362"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-845"></span><span>    </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; Property -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; [a]) -&gt; a -&gt; (a -&gt; prop) -&gt; Property
forall prop a.
Testable prop =&gt;
(a -&gt; [a]) -&gt; a -&gt; (a -&gt; prop) -&gt; Property
</span><a href="Test.QuickCheck.Property.html#shrinking"><span class="hs-identifier hs-var">shrinking</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
</span><a href="#local-6989586621679121360"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121362"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679121361"><span class="hs-identifier hs-var">pf</span></a></span><span>
</span><span id="line-847"></span><span>
</span><span id="line-848"></span><span class="hs-comment">-- | Nondeterministic choice: 'p1' '.&amp;.' 'p2' picks randomly one of</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- 'p1' and 'p2' to test. If you test the property 100 times it</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- makes 100 random choices.</span><span>
</span><span id="line-851"></span><span id="local-6989586621679120707"><span id="local-6989586621679120708"><span class="annot"><a href="Test.QuickCheck.Property.html#.%26."><span class="hs-operator hs-type">(.&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120707"><span class="hs-identifier hs-type">prop1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120708"><span class="hs-identifier hs-type">prop2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120707"><span class="hs-identifier hs-type">prop1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120708"><span class="hs-identifier hs-type">prop2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-852"></span><span id="local-6989586621679121372"><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121372"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id=".%26."><span class="annot"><span class="annottext">.&amp;. :: forall prop1 prop2.
(Testable prop1, Testable prop2) =&gt;
prop1 -&gt; prop2 -&gt; Property
</span><a href="Test.QuickCheck.Property.html#.%26."><span class="hs-operator hs-var hs-var">.&amp;.</span></a></span></span><span> </span><span id="local-6989586621679121373"><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121373"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-853"></span><span>  </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var">again</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-854"></span><span>  </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; Gen Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-855"></span><span>  </span><span class="annot"><span class="annottext">Gen Bool
forall a. Arbitrary a =&gt; Gen a
</span><a href="Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Bool -&gt; (Bool -&gt; Gen Prop) -&gt; Gen Prop
forall a b. Gen a -&gt; (a -&gt; Gen b) -&gt; Gen b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121374"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121374"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-856"></span><span>    </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; Property -&gt; Gen Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-857"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121374"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LHS&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RHS&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-858"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121374"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">prop1 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121372"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">prop2 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121373"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="annot"><span class="hs-comment">-- | Conjunction: 'p1' '.&amp;&amp;.' 'p2' passes if both 'p1' and 'p2' pass.</span></span><span>
</span><span id="line-861"></span><span id="local-6989586621679121375"><span id="local-6989586621679121376"><span class="annot"><a href="Test.QuickCheck.Property.html#.%26%26."><span class="hs-operator hs-type">(.&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121375"><span class="hs-identifier hs-type">prop1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121376"><span class="hs-identifier hs-type">prop2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121375"><span class="hs-identifier hs-type">prop1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121376"><span class="hs-identifier hs-type">prop2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-862"></span><span id="local-6989586621679121382"><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121382"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id=".%26%26."><span class="annot"><span class="annottext">.&amp;&amp;. :: forall prop1 prop2.
(Testable prop1, Testable prop2) =&gt;
prop1 -&gt; prop2 -&gt; Property
</span><a href="Test.QuickCheck.Property.html#.%26%26."><span class="hs-operator hs-var hs-var">.&amp;&amp;.</span></a></span></span><span> </span><span id="local-6989586621679121383"><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121383"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><a href="Test.QuickCheck.Property.html#conjoin"><span class="hs-identifier hs-var">conjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop1 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121382"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop2 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121383"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="annot"><span class="hs-comment">-- | Take the conjunction of several properties.</span></span><span>
</span><span id="line-865"></span><span id="local-6989586621679120713"><span class="annot"><a href="Test.QuickCheck.Property.html#conjoin"><span class="hs-identifier hs-type">conjoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679120713"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679120713"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-866"></span><span id="conjoin"><span class="annot"><span class="annottext">conjoin :: forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><a href="Test.QuickCheck.Property.html#conjoin"><span class="hs-identifier hs-var hs-var">conjoin</span></a></span></span><span> </span><span id="local-6989586621679121394"><span class="annot"><span class="annottext">[prop]
</span><a href="#local-6989586621679121394"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-867"></span><span>  </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var">again</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-868"></span><span>  </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; Gen Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679121395"><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121395"><span class="hs-identifier hs-var">roses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(prop -&gt; Gen (Rose Result)) -&gt; [prop] -&gt; Gen [Rose Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prop -&gt; Rose Result) -&gt; Gen Prop -&gt; Gen (Rose Result)
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Gen (Rose Result))
-&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Gen (Rose Result)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[prop]
</span><a href="#local-6989586621679121394"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-870"></span><span>     </span><span class="annot"><span class="annottext">Prop -&gt; Gen Prop
forall a. a -&gt; Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; [Rose Result] -&gt; Rose Result
</span><a href="#local-6989586621679121397"><span class="hs-identifier hs-var">conj</span></a></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121395"><span class="hs-identifier hs-var">roses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621679121397"><span class="annot"><span class="annottext">conj :: (Result -&gt; Result) -&gt; [Rose Result] -&gt; Rose Result
</span><a href="#local-6989586621679121397"><span class="hs-identifier hs-var hs-var">conj</span></a></span></span><span> </span><span id="local-6989586621679121407"><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121407"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-873"></span><span>    </span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121407"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#succeeded"><span class="hs-identifier hs-var">succeeded</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span>  </span><span class="annot"><a href="#local-6989586621679121397"><span class="hs-identifier hs-var">conj</span></a></span><span> </span><span id="local-6989586621679121408"><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121408"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679121409"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121409"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679121410"><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121410"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Rose Result) -&gt; Rose Result
forall a. IO (Rose a) -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#IORose"><span class="hs-identifier hs-var">IORose</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Rose Result) -&gt; Rose Result)
-&gt; IO (Rose Result) -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-876"></span><span>    </span><span id="local-6989586621679121411"><span class="annot"><span class="annottext">rose :: Rose Result
</span><a href="#local-6989586621679121411"><span class="hs-identifier hs-var">rose</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679121412"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var">reduceRose</span></a></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121409"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-878"></span><span>      </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-879"></span><span>        </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;expectFailure may not occur inside a conjunction&quot;</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; [Rose Result] -&gt; Rose Result
</span><a href="#local-6989586621679121397"><span class="hs-identifier hs-var">conj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121414"><span class="hs-identifier hs-var">addLabels</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; (Result -&gt; Result) -&gt; Result -&gt; Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121415"><span class="hs-identifier hs-var">addCallbacksAndCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; (Result -&gt; Result) -&gt; Result -&gt; Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121408"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121410"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121411"><span class="hs-identifier hs-var">rose</span></a></span><span>
</span><span id="line-882"></span><span>      </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-883"></span><span>        </span><span id="local-6989586621679121416"><span class="annot"><span class="annottext">rose2 :: Rose Result
</span><a href="#local-6989586621679121416"><span class="hs-identifier hs-var">rose2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-type">MkRose</span></a></span><span> </span><span id="local-6989586621679121417"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121417"><span class="hs-identifier hs-var">result2</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
</span><a href="Test.QuickCheck.Property.html#reduceRose"><span class="hs-identifier hs-var">reduceRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; [Rose Result] -&gt; Rose Result
</span><a href="#local-6989586621679121397"><span class="hs-identifier hs-var">conj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121415"><span class="hs-identifier hs-var">addCallbacksAndCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121412"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Result) -&gt; (Result -&gt; Result) -&gt; Result -&gt; Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="#local-6989586621679121408"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121410"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-884"></span><span>        </span><span class="annot"><span class="annottext">Rose Result -&gt; IO (Rose Result)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Rose Result -&gt; IO (Rose Result))
-&gt; Rose Result -&gt; IO (Rose Result)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-885"></span><span>          </span><span class="hs-comment">-- Nasty work to make sure we use the right callbacks</span><span>
</span><span id="line-886"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121417"><span class="hs-identifier hs-var">result2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-887"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121417"><span class="hs-identifier hs-var">result2</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-888"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121416"><span class="hs-identifier hs-var">rose2</span></a></span><span>
</span><span id="line-889"></span><span>            </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121416"><span class="hs-identifier hs-var">rose2</span></a></span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span>  </span><span id="local-6989586621679121415"><span class="annot"><span class="annottext">addCallbacksAndCoverage :: Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121415"><span class="hs-identifier hs-var hs-var">addCallbacksAndCoverage</span></a></span></span><span> </span><span id="local-6989586621679121418"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121418"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679121419"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121419"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-892"></span><span>    </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121419"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121418"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121419"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-893"></span><span>        </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121418"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121419"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-894"></span><span>  </span><span id="local-6989586621679121414"><span class="annot"><span class="annottext">addLabels :: Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121414"><span class="hs-identifier hs-var hs-var">addLabels</span></a></span></span><span> </span><span id="local-6989586621679121420"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121420"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679121421"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121421"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-895"></span><span>    </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121421"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121420"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121421"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-896"></span><span>        </span><span class="annot"><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121420"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121421"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-897"></span><span>        </span><span class="annot"><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121420"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121421"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span class="annot"><span class="hs-comment">-- | Disjunction: 'p1' '.||.' 'p2' passes unless 'p1' and 'p2' simultaneously fail.</span></span><span>
</span><span id="line-900"></span><span id="local-6989586621679121422"><span id="local-6989586621679121423"><span class="annot"><a href="Test.QuickCheck.Property.html#.%7C%7C."><span class="hs-operator hs-type">(.||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121422"><span class="hs-identifier hs-type">prop1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121423"><span class="hs-identifier hs-type">prop2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121422"><span class="hs-identifier hs-type">prop1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121423"><span class="hs-identifier hs-type">prop2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span></span><span>
</span><span id="line-901"></span><span id="local-6989586621679121429"><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121429"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id=".%7C%7C."><span class="annot"><span class="annottext">.||. :: forall prop1 prop2.
(Testable prop1, Testable prop2) =&gt;
prop1 -&gt; prop2 -&gt; Property
</span><a href="Test.QuickCheck.Property.html#.%7C%7C."><span class="hs-operator hs-var hs-var">.||.</span></a></span></span><span> </span><span id="local-6989586621679121430"><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121430"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><a href="Test.QuickCheck.Property.html#disjoin"><span class="hs-identifier hs-var">disjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop1 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop1
</span><a href="#local-6989586621679121429"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop2 -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">prop2
</span><a href="#local-6989586621679121430"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span class="annot"><span class="hs-comment">-- | Take the disjunction of several properties.</span></span><span>
</span><span id="line-904"></span><span id="local-6989586621679121432"><span class="annot"><a href="Test.QuickCheck.Property.html#disjoin"><span class="hs-identifier hs-type">disjoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121432"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679121432"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-905"></span><span id="disjoin"><span class="annot"><span class="annottext">disjoin :: forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><a href="Test.QuickCheck.Property.html#disjoin"><span class="hs-identifier hs-var hs-var">disjoin</span></a></span></span><span> </span><span id="local-6989586621679121449"><span class="annot"><span class="annottext">[prop]
</span><a href="#local-6989586621679121449"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#again"><span class="hs-identifier hs-var">again</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-907"></span><span>  </span><span class="annot"><span class="annottext">Gen Prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#MkProperty"><span class="hs-identifier hs-var">MkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Property) -&gt; Gen Prop -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679121450"><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121450"><span class="hs-identifier hs-var">roses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(prop -&gt; Gen (Rose Result)) -&gt; [prop] -&gt; Gen [Rose Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Prop -&gt; Rose Result) -&gt; Gen Prop -&gt; Gen (Rose Result)
forall a b. (a -&gt; b) -&gt; Gen a -&gt; Gen b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Rose Result
</span><a href="Test.QuickCheck.Property.html#unProp"><span class="hs-identifier hs-var">unProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Prop -&gt; Gen (Rose Result))
-&gt; (prop -&gt; Gen Prop) -&gt; prop -&gt; Gen (Rose Result)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Gen Prop
</span><a href="Test.QuickCheck.Property.html#unProperty"><span class="hs-identifier hs-var">unProperty</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Gen Prop) -&gt; (prop -&gt; Property) -&gt; prop -&gt; Gen Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">prop -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[prop]
</span><a href="#local-6989586621679121449"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-909"></span><span>     </span><span class="annot"><span class="annottext">Prop -&gt; Gen Prop
forall a. a -&gt; Gen a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rose Result -&gt; Prop
</span><a href="Test.QuickCheck.Property.html#MkProp"><span class="hs-identifier hs-var">MkProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rose Result -&gt; Rose Result -&gt; Rose Result)
-&gt; Rose Result -&gt; [Rose Result] -&gt; Rose Result
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Rose Result -&gt; Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121451"><span class="hs-identifier hs-var">disj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; [Rose Result] -&gt; Rose Result
forall a. a -&gt; [Rose a] -&gt; Rose a
</span><a href="Test.QuickCheck.Property.html#MkRose"><span class="hs-identifier hs-var">MkRose</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Rose Result]
</span><a href="#local-6989586621679121450"><span class="hs-identifier hs-var">roses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><a href="#local-6989586621679121451"><span class="hs-identifier hs-type">disj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Rose"><span class="hs-identifier hs-type">Rose</span></a></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-912"></span><span>  </span><span id="local-6989586621679121451"><span class="annot"><span class="annottext">disj :: Rose Result -&gt; Rose Result -&gt; Rose Result
</span><a href="#local-6989586621679121451"><span class="hs-identifier hs-var hs-var">disj</span></a></span></span><span> </span><span id="local-6989586621679121452"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121452"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679121453"><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121453"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-913"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679121454"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121452"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-914"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-915"></span><span>         </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121455"><span class="hs-identifier hs-var">expectFailureError</span></a></span><span>
</span><span id="line-916"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-917"></span><span>           </span><span id="local-6989586621679121456"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rose Result
</span><a href="#local-6989586621679121453"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-918"></span><span>           </span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Rose Result) -&gt; Result -&gt; Rose Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-919"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-920"></span><span>               </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121455"><span class="hs-identifier hs-var">expectFailureError</span></a></span><span>
</span><span id="line-921"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121457"><span class="hs-identifier hs-var">addCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span>
</span><span id="line-922"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-923"></span><span>                 </span><span class="annot"><a href="Test.QuickCheck.Property.html#MkResult"><span class="hs-identifier hs-type">MkResult</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-924"></span><span>                   </span><span class="annot"><span class="annottext">ok :: Maybe Bool
</span><a href="Test.QuickCheck.Property.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-925"></span><span>                   </span><span class="annot"><span class="annottext">expect :: Bool
</span><a href="Test.QuickCheck.Property.html#expect"><span class="hs-identifier hs-var">expect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-926"></span><span>                   </span><span class="annot"><span class="annottext">reason :: String
</span><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="#local-6989586621679121458"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; String
</span><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; String
</span><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-927"></span><span>                   </span><span class="annot"><span class="annottext">theException :: Maybe AnException
</span><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var">theException</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe AnException
</span><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var">theException</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AnException -&gt; Maybe AnException -&gt; Maybe AnException
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Maybe AnException
</span><a href="Test.QuickCheck.Property.html#theException"><span class="hs-identifier hs-var">theException</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-928"></span><span>                   </span><span class="hs-comment">-- The following few fields are not important because the</span><span>
</span><span id="line-929"></span><span>                   </span><span class="hs-comment">-- test case has failed anyway</span><span>
</span><span id="line-930"></span><span>                   </span><span class="annot"><span class="annottext">abort :: Bool
</span><a href="Test.QuickCheck.Property.html#abort"><span class="hs-identifier hs-var">abort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-931"></span><span>                   </span><span class="annot"><span class="annottext">maybeNumTests :: Maybe Int
</span><a href="Test.QuickCheck.Property.html#maybeNumTests"><span class="hs-identifier hs-var">maybeNumTests</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-932"></span><span>                   </span><span class="annot"><span class="annottext">maybeCheckCoverage :: Maybe Confidence
</span><a href="Test.QuickCheck.Property.html#maybeCheckCoverage"><span class="hs-identifier hs-var">maybeCheckCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Confidence
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-933"></span><span>                   </span><span class="annot"><span class="annottext">labels :: [String]
</span><a href="Test.QuickCheck.Property.html#labels"><span class="hs-identifier hs-var">labels</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-934"></span><span>                   </span><span class="annot"><span class="annottext">classes :: [String]
</span><a href="Test.QuickCheck.Property.html#classes"><span class="hs-identifier hs-var">classes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-935"></span><span>                   </span><span class="annot"><span class="annottext">tables :: [(String, String)]
</span><a href="Test.QuickCheck.Property.html#tables"><span class="hs-identifier hs-var">tables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-936"></span><span>                   </span><span class="annot"><span class="annottext">requiredCoverage :: [(Maybe String, String, Double)]
</span><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-937"></span><span>                   </span><span class="annot"><span class="annottext">callbacks :: [Callback]
</span><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-938"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; [Callback]
</span><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span> </span><span class="annot"><span class="annottext">[Callback] -&gt; [Callback] -&gt; [Callback]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-939"></span><span>                     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CallbackKind -&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
</span><a href="Test.QuickCheck.Property.html#PostFinalFailure"><span class="hs-identifier hs-var">PostFinalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">CallbackKind
</span><a href="Test.QuickCheck.Property.html#Counterexample"><span class="hs-identifier hs-var">Counterexample</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Result -&gt; IO ()) -&gt; Callback)
-&gt; (State -&gt; Result -&gt; IO ()) -&gt; Callback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679121460"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121460"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679121461"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121461"><span class="hs-identifier hs-var">_res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Terminal -&gt; String -&gt; IO ()
</span><a href="Test.QuickCheck.Text.html#putLine"><span class="hs-identifier hs-var">putLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Terminal
</span><a href="Test.QuickCheck.State.html#terminal"><span class="hs-identifier hs-var">terminal</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679121460"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Callback] -&gt; [Callback] -&gt; [Callback]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-940"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; [Callback]
</span><a href="Test.QuickCheck.Property.html#callbacks"><span class="hs-identifier hs-var">callbacks</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-941"></span><span>                   </span><span class="annot"><span class="annottext">testCase :: [String]
</span><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-942"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; [String]
</span><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-943"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; [String]
</span><a href="Test.QuickCheck.Property.html#testCase"><span class="hs-identifier hs-var">testCase</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-944"></span><span>               </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121456"><span class="hs-identifier hs-var">result2</span></a></span><span>
</span><span id="line-945"></span><span>         </span><span class="hs-comment">-- The &quot;obvious&quot; semantics of .||. has:</span><span>
</span><span id="line-946"></span><span>         </span><span class="hs-comment">--   discard .||. true = true</span><span>
</span><span id="line-947"></span><span>         </span><span class="hs-comment">--   discard .||. discard = discard</span><span>
</span><span id="line-948"></span><span>         </span><span class="hs-comment">-- but this implementation gives discard .||. true = discard.</span><span>
</span><span id="line-949"></span><span>         </span><span class="hs-comment">-- This is reasonable because evaluating result2 in the case</span><span>
</span><span id="line-950"></span><span>         </span><span class="hs-comment">-- that result1 discards is just busy-work - it won't ever</span><span>
</span><span id="line-951"></span><span>         </span><span class="hs-comment">-- cause the property to fail. On the other hand, discarding</span><span>
</span><span id="line-952"></span><span>         </span><span class="hs-comment">-- instead of returning true causes us to execute one more</span><span>
</span><span id="line-953"></span><span>         </span><span class="hs-comment">-- test case - but assuming that preconditions are cheap to</span><span>
</span><span id="line-954"></span><span>         </span><span class="hs-comment">-- evaluate, this is no more work than evaluating result2</span><span>
</span><span id="line-955"></span><span>         </span><span class="hs-comment">-- would be, while (unlike evaluating result2) it might catch</span><span>
</span><span id="line-956"></span><span>         </span><span class="hs-comment">-- a bug.</span><span>
</span><span id="line-957"></span><span>         </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Rose Result
forall a. a -&gt; Rose a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121454"><span class="hs-identifier hs-var">result1</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>  </span><span id="local-6989586621679121455"><span class="annot"><span class="annottext">expectFailureError :: Result
</span><a href="#local-6989586621679121455"><span class="hs-identifier hs-var hs-var">expectFailureError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="Test.QuickCheck.Property.html#failed"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#reason"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;expectFailure may not occur inside a disjunction&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-960"></span><span>  </span><span id="local-6989586621679121458"><span class="annot"><span class="annottext">sep :: String -&gt; String -&gt; String
</span><a href="#local-6989586621679121458"><span class="hs-identifier hs-var hs-var">sep</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679121462"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121462"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-961"></span><span>  </span><span class="annot"><a href="#local-6989586621679121458"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span id="local-6989586621679121463"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121463"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121463"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span class="annot"><a href="#local-6989586621679121458"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span id="local-6989586621679121464"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121464"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679121465"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121465"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121464"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679121465"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-963"></span><span>
</span><span id="line-964"></span><span>  </span><span id="local-6989586621679121457"><span class="annot"><span class="annottext">addCoverage :: Result -&gt; Result -&gt; Result
</span><a href="#local-6989586621679121457"><span class="hs-identifier hs-var hs-var">addCoverage</span></a></span></span><span> </span><span id="local-6989586621679121466"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121466"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679121467"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121467"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-965"></span><span>    </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679121467"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121466"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#requiredCoverage"><span class="hs-identifier hs-var">requiredCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span class="annot"><span class="hs-comment">-- | Like '==', but prints a counterexample when it fails.</span></span><span>
</span><span id="line-968"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%3D%3D"><span class="hs-operator hs-type">===</span></a></span><span>
</span><span id="line-969"></span><span id="local-6989586621679120725"><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%3D%3D"><span class="hs-operator hs-type">(===)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679120725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679120725"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120725"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-970"></span><span id="local-6989586621679121474"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121474"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="%3D%3D%3D"><span class="annot"><span class="annottext">=== :: forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><a href="Test.QuickCheck.Property.html#%3D%3D%3D"><span class="hs-operator hs-var hs-var">===</span></a></span></span><span> </span><span id="local-6989586621679121475"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121475"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-971"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121474"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="#local-6989586621679121476"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121477"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121475"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121477"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-973"></span><span>    </span><span id="local-6989586621679121477"><span class="annot"><span class="annottext">res :: Bool
</span><a href="#local-6989586621679121477"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121474"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121475"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-974"></span><span>    </span><span id="local-6989586621679121476"><span class="annot"><span class="annottext">interpret :: Bool -&gt; String
</span><a href="#local-6989586621679121476"><span class="hs-identifier hs-var hs-var">interpret</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; == &quot;</span></span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><a href="#local-6989586621679121476"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; /= &quot;</span></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="annot"><span class="hs-comment">-- | Like '/=', but prints a counterexample when it fails.</span></span><span>
</span><span id="line-978"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%2F%3D"><span class="hs-operator hs-type">=/=</span></a></span><span>
</span><span id="line-979"></span><span id="local-6989586621679121481"><span class="annot"><a href="Test.QuickCheck.Property.html#%3D%2F%3D"><span class="hs-operator hs-type">(=/=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679121481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679121481"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-980"></span><span id="local-6989586621679121487"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121487"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="%3D%2F%3D"><span class="annot"><span class="annottext">=/= :: forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><a href="Test.QuickCheck.Property.html#%3D%2F%3D"><span class="hs-operator hs-var hs-var">=/=</span></a></span></span><span> </span><span id="local-6989586621679121488"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121488"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-981"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#counterexample"><span class="hs-identifier hs-var">counterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121487"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="#local-6989586621679121489"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121490"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121488"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679121490"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-983"></span><span>    </span><span id="local-6989586621679121490"><span class="annot"><span class="annottext">res :: Bool
</span><a href="#local-6989586621679121490"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121487"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121488"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-984"></span><span>    </span><span id="local-6989586621679121489"><span class="annot"><span class="annottext">interpret :: Bool -&gt; String
</span><a href="#local-6989586621679121489"><span class="hs-identifier hs-var hs-var">interpret</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; /= &quot;</span></span><span>
</span><span id="line-985"></span><span>    </span><span class="annot"><a href="#local-6989586621679121489"><span class="hs-identifier hs-var">interpret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; == &quot;</span></span><span class="hs-cpp">

#ifndef NO_DEEPSEQ
</span><span class="annot"><span class="hs-comment">-- | Checks that a value is total, i.e., doesn't crash when evaluated.</span></span><span>
</span><span id="line-989"></span><span id="local-6989586621679120728"><span class="annot"><a href="Test.QuickCheck.Property.html#total"><span class="hs-identifier hs-type">total</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679120728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679120728"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.QuickCheck.Property.html#Property"><span class="hs-identifier hs-type">Property</span></a></span></span><span>
</span><span id="line-990"></span><span id="total"><span class="annot"><span class="annottext">total :: forall a. NFData a =&gt; a -&gt; Property
</span><a href="Test.QuickCheck.Property.html#total"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span id="local-6989586621679121496"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121496"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="Test.QuickCheck.Property.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679121496"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-993"></span><span class="hs-comment">--------------------------------------------------------------------------</span><span>
</span><span id="line-994"></span><span class="hs-comment">-- the end.</span><span>
</span><span id="line-995"></span></pre></body></html>