<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Servant.Server.Internal.Router</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">servant-server-0.20: A family of combinators for defining webservices APIs and serving them</span><ul class="links" id="page-menu"><li><a href="src/Servant.Server.Internal.Router.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Servant.Server.Internal.Router</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Router">Router</a> env = <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:CaptureHint">CaptureHint</a> = <a href="#v:CaptureHint">CaptureHint</a> {<ul class="subs"><li><a href="#v:captureName">captureName</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li><a href="#v:captureType">captureType</a> :: <a href="../base-4.18.2.1/Data-Typeable.html#t:TypeRep" title="Data.Typeable">TypeRep</a></li></ul>}</li><li class="src short"><a href="#v:toCaptureTag">toCaptureTag</a> :: <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:toCaptureTags">toCaptureTags</a> :: [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Router-39-">Router'</a> env a<ul class="subs"><li>= <a href="#v:StaticRouter">StaticRouter</a> (<a href="../containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a)) [env -&gt; a]</li><li>| <a href="#v:CaptureRouter">CaptureRouter</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> (<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>, env) a)</li><li>| <a href="#v:CaptureAllRouter">CaptureAllRouter</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> ([<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>], env) a)</li><li>| <a href="#v:RawRouter">RawRouter</a> (env -&gt; a)</li><li>| <a href="#v:Choice">Choice</a> (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a) (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a)</li></ul></li><li class="src short"><a href="#v:pathRouter">pathRouter</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a</li><li class="src short"><a href="#v:leafRouter">leafRouter</a> :: (env -&gt; a) -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a</li><li class="src short"><a href="#v:choice">choice</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a</li><li class="src short"><span class="keyword">data</span> <a href="#t:RouterStructure">RouterStructure</a><ul class="subs"><li>= <a href="#v:StaticRouterStructure">StaticRouterStructure</a> (<a href="../containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a>) <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li>| <a href="#v:CaptureRouterStructure">CaptureRouterStructure</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></li><li>| <a href="#v:RawRouterStructure">RawRouterStructure</a></li><li>| <a href="#v:ChoiceStructure">ChoiceStructure</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></li></ul></li><li class="src short"><a href="#v:routerStructure">routerStructure</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></li><li class="src short"><a href="#v:sameStructure">sameStructure</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env b -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:routerLayout">routerLayout</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:tweakResponse">tweakResponse</a> :: (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env</li><li class="src short"><a href="#v:runRouter">runRouter</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> () -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a></li><li class="src short"><a href="#v:runRouterEnv">runRouterEnv</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env -&gt; env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a></li><li class="src short"><a href="#v:runChoice">runChoice</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; [env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a>] -&gt; env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a></li><li class="src short"><a href="#v:worseHTTPCode">worseHTTPCode</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Router" class="def">Router</a> env = <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a> <a href="src/Servant.Server.Internal.Router.html#Router" class="link">Source</a> <a href="#t:Router" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CaptureHint" class="def">CaptureHint</a> <a href="src/Servant.Server.Internal.Router.html#CaptureHint" class="link">Source</a> <a href="#t:CaptureHint" class="selflink">#</a></p><div class="doc"><p>Holds information about pieces of url that are captured as variables.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CaptureHint" class="def">CaptureHint</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:captureName" class="def">captureName</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></dfn><div class="doc"><p>Holds the name of the captured variable</p></div></li><li><dfn class="src"><a id="v:captureType" class="def">captureType</a> :: <a href="../base-4.18.2.1/Data-Typeable.html#t:TypeRep" title="Data.Typeable">TypeRep</a></dfn><div class="doc"><p>Holds the type of the captured variable</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CaptureHint">Instances</h4><details id="i:CaptureHint" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CaptureHint:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a></span> <a href="src/Servant.Server.Internal.Router.html#line-38" class="link">Source</a> <a href="#t:CaptureHint" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CaptureHint:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Router.html">Servant.Server.Internal.Router</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CaptureHint:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a></span> <a href="src/Servant.Server.Internal.Router.html#line-38" class="link">Source</a> <a href="#t:CaptureHint" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CaptureHint:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Router.html">Servant.Server.Internal.Router</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:toCaptureTag" class="def">toCaptureTag</a> :: <a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a> -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Servant.Server.Internal.Router.html#toCaptureTag" class="link">Source</a> <a href="#v:toCaptureTag" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:toCaptureTags" class="def">toCaptureTags</a> :: [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Servant.Server.Internal.Router.html#toCaptureTags" class="link">Source</a> <a href="#v:toCaptureTags" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Router-39-" class="def">Router'</a> env a <a href="src/Servant.Server.Internal.Router.html#Router%27" class="link">Source</a> <a href="#t:Router-39-" class="selflink">#</a></p><div class="doc"><p>Internal representation of a router.</p><p>The first argument describes an environment type that is
 expected as extra input by the routers at the leaves. The
 environment is filled while running the router, with path
 components that can be used to process captures.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:StaticRouter" class="def">StaticRouter</a> (<a href="../containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a)) [env -&gt; a]</td><td class="doc"><p>the map contains routers for subpaths (first path component used
   for lookup and removed afterwards), the list contains handlers
   for the empty path, to be tried in order</p></td></tr><tr><td class="src"><a id="v:CaptureRouter" class="def">CaptureRouter</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> (<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>, env) a)</td><td class="doc"><p>first path component is passed to the child router in its
   environment and removed afterwards.
   The first argument is a list of hints for all variables that can be
   captured by the router. The fact that it is a list is counter-intuitive,
   because the <code>Capture</code> combinator only allows to capture a single varible,
   with a single name and a single type. However, the <code><a href="Servant-Server-Internal-Router.html#v:choice" title="Servant.Server.Internal.Router">choice</a></code> smart
   constructor may merge two <code>Capture</code> combinators with different hints, thus
   forcing the type to be '[CaptureHint]'.
   Because <code><a href="Servant-Server-Internal-Router.html#v:CaptureRouter" title="Servant.Server.Internal.Router">CaptureRouter</a></code> is built from a <code>Capture</code> combinator, the list of
   hints should always be non-empty.</p></td></tr><tr><td class="src"><a id="v:CaptureAllRouter" class="def">CaptureAllRouter</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> ([<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>], env) a)</td><td class="doc"><p>all path components are passed to the child router in its
   environment and are removed afterwards
   The first argument is a hint for the list of variables that can be
   captured by the router. Note that the <code><a href="Servant-Server-Internal-Router.html#v:captureType" title="Servant.Server.Internal.Router">captureType</a></code> field of the hint
   should always be '[a]' for some <code>a</code>.</p></td></tr><tr><td class="src"><a id="v:RawRouter" class="def">RawRouter</a> (env -&gt; a)</td><td class="doc"><p>to be used for routes we do not know anything about</p></td></tr><tr><td class="src"><a id="v:Choice" class="def">Choice</a> (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a) (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a)</td><td class="doc"><p>left-biased choice between two routers</p></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Router-39-">Instances</h4><details id="i:Router-39-" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Router-39-:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env)</span> <a href="src/Servant.Server.Internal.Router.html#line-79" class="link">Source</a> <a href="#t:Router-39-" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Router-39-:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Router.html">Servant.Server.Internal.Router</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env b -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:pathRouter" class="def">pathRouter</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a <a href="src/Servant.Server.Internal.Router.html#pathRouter" class="link">Source</a> <a href="#v:pathRouter" class="selflink">#</a></p><div class="doc"><p>Smart constructor for a single static path component.</p></div></div><div class="top"><p class="src"><a id="v:leafRouter" class="def">leafRouter</a> :: (env -&gt; a) -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a <a href="src/Servant.Server.Internal.Router.html#leafRouter" class="link">Source</a> <a href="#v:leafRouter" class="selflink">#</a></p><div class="doc"><p>Smart constructor for a leaf, i.e., a router that expects
 the empty path.</p></div></div><div class="top"><p class="src"><a id="v:choice" class="def">choice</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a <a href="src/Servant.Server.Internal.Router.html#choice" class="link">Source</a> <a href="#v:choice" class="selflink">#</a></p><div class="doc"><p>Smart constructor for the choice between routers.
 We currently optimize the following cases:</p><ul><li>Two static routers can be joined by joining their maps
     and concatenating their leaf-lists.</li><li>Two dynamic routers can be joined by joining their codomains.</li><li>Choice nodes can be reordered.</li></ul></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RouterStructure" class="def">RouterStructure</a> <a href="src/Servant.Server.Internal.Router.html#RouterStructure" class="link">Source</a> <a href="#t:RouterStructure" class="selflink">#</a></p><div class="doc"><p>Datatype used for representing and debugging the
 structure of a router. Abstracts from the handlers
 at the leaves.</p><p>Two <code><a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a></code>s can be structurally compared by computing
 their <code><a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></code> using <code><a href="Servant-Server-Internal-Router.html#v:routerStructure" title="Servant.Server.Internal.Router">routerStructure</a></code> and
 then testing for equality, see <code><a href="Servant-Server-Internal-Router.html#v:sameStructure" title="Servant.Server.Internal.Router">sameStructure</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:StaticRouterStructure" class="def">StaticRouterStructure</a> (<a href="../containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a>) <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:CaptureRouterStructure" class="def">CaptureRouterStructure</a> [<a href="Servant-Server-Internal-Router.html#t:CaptureHint" title="Servant.Server.Internal.Router">CaptureHint</a>] <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></td><td class="doc"><p>The first argument holds information about variables
 that are captured by the router. There may be several hints
 if several routers have been aggregated by the <code><a href="Servant-Server-Internal-Router.html#v:choice" title="Servant.Server.Internal.Router">choice</a></code>
 smart constructor.</p></td></tr><tr><td class="src"><a id="v:RawRouterStructure" class="def">RawRouterStructure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ChoiceStructure" class="def">ChoiceStructure</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RouterStructure">Instances</h4><details id="i:RouterStructure" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RouterStructure:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></span> <a href="src/Servant.Server.Internal.Router.html#line-124" class="link">Source</a> <a href="#t:RouterStructure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RouterStructure:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Router.html">Servant.Server.Internal.Router</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RouterStructure:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a></span> <a href="src/Servant.Server.Internal.Router.html#line-124" class="link">Source</a> <a href="#t:RouterStructure" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RouterStructure:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Router.html">Servant.Server.Internal.Router</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:routerStructure" class="def">routerStructure</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:RouterStructure" title="Servant.Server.Internal.Router">RouterStructure</a> <a href="src/Servant.Server.Internal.Router.html#routerStructure" class="link">Source</a> <a href="#v:routerStructure" class="selflink">#</a></p><div class="doc"><p>Compute the structure of a router.</p><p>Assumes that the request or text being passed
 in <code>WithRequest</code> or <code><a href="Servant-Server-Internal-Router.html#v:CaptureRouter" title="Servant.Server.Internal.Router">CaptureRouter</a></code> does not
 affect the structure of the underlying tree.</p></div></div><div class="top"><p class="src"><a id="v:sameStructure" class="def">sameStructure</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env b -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Servant.Server.Internal.Router.html#sameStructure" class="link">Source</a> <a href="#v:sameStructure" class="selflink">#</a></p><div class="doc"><p>Compare the structure of two routers.</p></div></div><div class="top"><p class="src"><a id="v:routerLayout" class="def">routerLayout</a> :: <a href="Servant-Server-Internal-Router.html#t:Router-39-" title="Servant.Server.Internal.Router">Router'</a> env a -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Servant.Server.Internal.Router.html#routerLayout" class="link">Source</a> <a href="#v:routerLayout" class="selflink">#</a></p><div class="doc"><p>Provide a textual representation of the
 structure of a router.</p></div></div><div class="top"><p class="src"><a id="v:tweakResponse" class="def">tweakResponse</a> :: (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env <a href="src/Servant.Server.Internal.Router.html#tweakResponse" class="link">Source</a> <a href="#v:tweakResponse" class="selflink">#</a></p><div class="doc"><p>Apply a transformation to the response of a <code><a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:runRouter" class="def">runRouter</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> () -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a> <a href="src/Servant.Server.Internal.Router.html#runRouter" class="link">Source</a> <a href="#v:runRouter" class="selflink">#</a></p><div class="doc"><p>Interpret a router as an application.</p></div></div><div class="top"><p class="src"><a id="v:runRouterEnv" class="def">runRouterEnv</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; <a href="Servant-Server-Internal-Router.html#t:Router" title="Servant.Server.Internal.Router">Router</a> env -&gt; env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a> <a href="src/Servant.Server.Internal.Router.html#runRouterEnv" class="link">Source</a> <a href="#v:runRouterEnv" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runChoice" class="def">runChoice</a> :: <a href="Servant-Server-Internal-ErrorFormatter.html#t:NotFoundErrorFormatter" title="Servant.Server.Internal.ErrorFormatter">NotFoundErrorFormatter</a> -&gt; [env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a>] -&gt; env -&gt; <a href="Servant-Server-Internal-RoutingApplication.html#t:RoutingApplication" title="Servant.Server.Internal.RoutingApplication">RoutingApplication</a> <a href="src/Servant.Server.Internal.Router.html#runChoice" class="link">Source</a> <a href="#v:runChoice" class="selflink">#</a></p><div class="doc"><p>Try a list of routing applications in order.
 We stop as soon as one fails fatally or succeeds.
 If all fail normally, we pick the &quot;best&quot; error.</p></div></div><div class="top"><p class="src"><a id="v:worseHTTPCode" class="def">worseHTTPCode</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Servant.Server.Internal.Router.html#worseHTTPCode" class="link">Source</a> <a href="#v:worseHTTPCode" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>