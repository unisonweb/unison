<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Servant.Server.Internal.Delayed</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">servant-server-0.20: A family of combinators for defining webservices APIs and serving them</span><ul class="links" id="page-menu"><li><a href="src/Servant.Server.Internal.Delayed.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Servant.Server.Internal.Delayed</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Delayed">Delayed</a> env c <span class="keyword">where</span><ul class="subs"><li><a href="#v:Delayed">Delayed</a> :: {..} -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env c</li></ul></li><li class="src short"><a href="#v:emptyDelayed">emptyDelayed</a> :: <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a</li><li class="src short"><a href="#v:addCapture">addCapture</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; (captured -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> (captured, env) b</li><li class="src short"><a href="#v:addParameterCheck">addParameterCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</li><li class="src short"><a href="#v:addHeaderCheck">addHeaderCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</li><li class="src short"><a href="#v:addMethodCheck">addMethodCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> () -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a</li><li class="src short"><a href="#v:addAuthCheck">addAuthCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</li><li class="src short"><a href="#v:addBodyCheck">addBodyCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> c -&gt; (c -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</li><li class="src short"><a href="#v:addAcceptCheck">addAcceptCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> () -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a</li><li class="src short"><a href="#v:passToServer">passToServer</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; (<a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; a) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</li><li class="src short"><a href="#v:runDelayed">runDelayed</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; env -&gt; <a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../resourcet-1.3.0/Control-Monad-Trans-Resource.html#t:ResourceT" title="Control.Monad.Trans.Resource">ResourceT</a> <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> a)</li><li class="src short"><a href="#v:runAction">runAction</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (<a href="Servant-Server-Internal-Handler.html#t:Handler" title="Servant.Server.Internal.Handler">Handler</a> a) -&gt; env -&gt; <a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> r) -&gt; (a -&gt; <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> r</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Delayed" class="def">Delayed</a> env c <span class="keyword">where</span> <a href="src/Servant.Server.Internal.Delayed.html#Delayed" class="link">Source</a> <a href="#t:Delayed" class="selflink">#</a></p><div class="doc"><p>A <code><a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a></code> is a representation of a handler with scheduled
 delayed checks that can trigger errors.</p><p>Why would we want to delay checks?</p><p>There are two reasons:</p><ol><li value="1">In a straight-forward implementation, the order in which we
 perform checks will determine the error we generate. This is
 because once an error occurs, we would abort and not perform
 any subsequent checks, but rather return the current error.</li></ol><p>This is not a necessity: we could continue doing other checks,
 and choose the preferred error. However, that would in general
 mean more checking, which leads us to the other reason.</p><ol><li value="2">We really want to avoid doing certain checks too early. For
 example, captures involve parsing, and are much more costly
 than static route matches. In particular, if several paths
 contain the &quot;same&quot; capture, we'd like as much as possible to
 avoid trying the same parse many times. Also tricky is the
 request body. Again, this involves parsing, but also, WAI makes
 obtaining the request body a side-effecting operation. We
 could/can work around this by manually caching the request body,
 but we'd rather keep the number of times we actually try to
 decode the request body to an absolute minimum.</li></ol><p>We prefer to have the following relative priorities of error
 codes:</p><pre>404
405 (bad method)
401 (unauthorized)
415 (unsupported media type)
406 (not acceptable)
400 (bad request)
</pre><p>Therefore, while routing, we delay most checks so that they
 will ultimately occur in the right order.</p><p>A <code><a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a></code> contains many delayed blocks of tests, and
 the actual handler:</p><ol><li value="1">Delayed captures. These can actually cause 404, and
 while they're costly, they should be done first among the
 delayed checks (at least as long as we do not decouple the
 check order from the error reporting, see above). Delayed
 captures can provide inputs to the actual handler.</li><li value="2">Method check(s). This can cause a 405. On success,
 it does not provide an input for the handler. Method checks
 are comparatively cheap.</li><li value="3">Authentication checks. This can cause 401.</li><li value="4">Accept and content type header checks. These checks
 can cause 415 and 406 errors.</li><li value="5">Query parameter checks. They require parsing and can cause 400 if the
 parsing fails. Query parameter checks provide inputs to the handler</li><li value="6">Header Checks. They also require parsing and can cause 400 if parsing fails.</li><li value="7">Body check. The request body check can cause 400.</li></ol></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Delayed" class="def">Delayed</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src">:: { <a id="v:capturesD" class="def">capturesD</a> :: env -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> captures</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:methodD" class="def">methodD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:authD" class="def">authD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> auth</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:acceptD" class="def">acceptD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> ()</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:contentD" class="def">contentD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> contentType</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:paramsD" class="def">paramsD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> params</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:headersD" class="def">headersD</a> :: <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> headers</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:bodyD" class="def">bodyD</a> :: contentType -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> body</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;, <a id="v:serverD" class="def">serverD</a> :: captures -&gt; params -&gt; headers -&gt; auth -&gt; body -&gt; <a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> c</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src">&nbsp;&nbsp;&nbsp;} -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env c</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Delayed">Instances</h4><details id="i:Delayed" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Delayed:Functor:1"></span> <a href="../base-4.18.2.1/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env)</span> <a href="src/Servant.Server.Internal.Delayed.html#line-110" class="link">Source</a> <a href="#t:Delayed" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Delayed:Functor:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Servant-Server-Internal-Delayed.html">Servant.Server.Internal.Delayed</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b <a href="#v:fmap" class="selflink">#</a></p><p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a <a href="#v:-60--36-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:emptyDelayed" class="def">emptyDelayed</a> :: <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a <a href="src/Servant.Server.Internal.Delayed.html#emptyDelayed" class="link">Source</a> <a href="#v:emptyDelayed" class="selflink">#</a></p><div class="doc"><p>A <code><a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a></code> without any stored checks.</p></div></div><div class="top"><p class="src"><a id="v:addCapture" class="def">addCapture</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; (captured -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> (captured, env) b <a href="src/Servant.Server.Internal.Delayed.html#addCapture" class="link">Source</a> <a href="#v:addCapture" class="selflink">#</a></p><div class="doc"><p>Add a capture to the end of the capture block.</p></div></div><div class="top"><p class="src"><a id="v:addParameterCheck" class="def">addParameterCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b <a href="src/Servant.Server.Internal.Delayed.html#addParameterCheck" class="link">Source</a> <a href="#v:addParameterCheck" class="selflink">#</a></p><div class="doc"><p>Add a parameter check to the end of the params block</p></div></div><div class="top"><p class="src"><a id="v:addHeaderCheck" class="def">addHeaderCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b <a href="src/Servant.Server.Internal.Delayed.html#addHeaderCheck" class="link">Source</a> <a href="#v:addHeaderCheck" class="selflink">#</a></p><div class="doc"><p>Add a parameter check to the end of the params block</p></div></div><div class="top"><p class="src"><a id="v:addMethodCheck" class="def">addMethodCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> () -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a <a href="src/Servant.Server.Internal.Delayed.html#addMethodCheck" class="link">Source</a> <a href="#v:addMethodCheck" class="selflink">#</a></p><div class="doc"><p>Add a method check to the end of the method block.</p></div></div><div class="top"><p class="src"><a id="v:addAuthCheck" class="def">addAuthCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b <a href="src/Servant.Server.Internal.Delayed.html#addAuthCheck" class="link">Source</a> <a href="#v:addAuthCheck" class="selflink">#</a></p><div class="doc"><p>Add an auth check to the end of the auth block.</p></div></div><div class="top"><p class="src"><a id="v:addBodyCheck" class="def">addBodyCheck</a> <a href="src/Servant.Server.Internal.Delayed.html#addBodyCheck" class="link">Source</a> <a href="#v:addBodyCheck" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> c</td><td class="doc"><p>content type check</p></td></tr><tr><td class="src">-&gt; (c -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> a)</td><td class="doc"><p>body check</p></td></tr><tr><td class="src">-&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Add a content type and body checks around parameter checks.</p><p>We'll report failed content type check (415), before trying to parse
 query parameters (400). Which, in turn, happens before request body parsing.</p></div></div><div class="top"><p class="src"><a id="v:addAcceptCheck" class="def">addAcceptCheck</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; <a href="Servant-Server-Internal-DelayedIO.html#t:DelayedIO" title="Servant.Server.Internal.DelayedIO">DelayedIO</a> () -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a <a href="src/Servant.Server.Internal.Delayed.html#addAcceptCheck" class="link">Source</a> <a href="#v:addAcceptCheck" class="selflink">#</a></p><div class="doc"><p>Add an accept header check before handling parameters.
 In principle, we'd like
 to take a bad body (400) response take precedence over a
 failed accept check (406). BUT to allow streaming the body,
 we cannot run the body check and then still backtrack.
 We therefore do the accept check before the body check,
 when we can still backtrack. There are other solutions to
 this, but they'd be more complicated (such as delaying the
 body check further so that it can still be run in a situation
 where we'd otherwise report 406).</p></div></div><div class="top"><p class="src"><a id="v:passToServer" class="def">passToServer</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (a -&gt; b) -&gt; (<a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; a) -&gt; <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env b <a href="src/Servant.Server.Internal.Delayed.html#passToServer" class="link">Source</a> <a href="#v:passToServer" class="selflink">#</a></p><div class="doc"><p>Many combinators extract information that is passed to
 the handler without the possibility of failure. In such a
 case, <code><a href="Servant-Server-Internal-Delayed.html#v:passToServer" title="Servant.Server.Internal.Delayed">passToServer</a></code> can be used.</p></div></div><div class="top"><p class="src"><a id="v:runDelayed" class="def">runDelayed</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env a -&gt; env -&gt; <a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; <a href="../resourcet-1.3.0/Control-Monad-Trans-Resource.html#t:ResourceT" title="Control.Monad.Trans.Resource">ResourceT</a> <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> a) <a href="src/Servant.Server.Internal.Delayed.html#runDelayed" class="link">Source</a> <a href="#v:runDelayed" class="selflink">#</a></p><div class="doc"><p>Run a delayed server. Performs all scheduled operations
 in order, and passes the results from the capture and body
 blocks on to the actual handler.</p><p>This should only be called once per request; otherwise the guarantees about
 effect and HTTP error ordering break down.</p></div></div><div class="top"><p class="src"><a id="v:runAction" class="def">runAction</a> :: <a href="Servant-Server-Internal-Delayed.html#t:Delayed" title="Servant.Server.Internal.Delayed">Delayed</a> env (<a href="Servant-Server-Internal-Handler.html#t:Handler" title="Servant.Server.Internal.Handler">Handler</a> a) -&gt; env -&gt; <a href="../wai-3.2.4/Network-Wai.html#t:Request" title="Network.Wai">Request</a> -&gt; (<a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a> -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> r) -&gt; (a -&gt; <a href="Servant-Server-Internal-RouteResult.html#t:RouteResult" title="Servant.Server.Internal.RouteResult">RouteResult</a> <a href="../wai-3.2.4/Network-Wai.html#t:Response" title="Network.Wai">Response</a>) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> r <a href="src/Servant.Server.Internal.Delayed.html#runAction" class="link">Source</a> <a href="#v:runAction" class="selflink">#</a></p><div class="doc"><p>Runs a delayed server and the resulting action.
 Takes a continuation that lets us send a response.
 Also takes a continuation for how to turn the
 result of the delayed server into a response.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>