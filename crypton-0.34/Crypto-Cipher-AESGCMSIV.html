<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Crypto.Cipher.AESGCMSIV</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">crypton-0.34: Cryptography Primitives sink</span><ul class="links" id="page-menu"><li><a href="src/Crypto.Cipher.AESGCMSIV.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Olivier Ch&#233;ron &lt;olivier.cheron@gmail.com&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>unknown</td></tr><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Crypto.Cipher.AESGCMSIV</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Implementation of AES-GCM-SIV, an AEAD scheme with nonce misuse resistance
 defined in <a href="https://tools.ietf.org/html/rfc8452">RFC 8452</a>.</p><p>To achieve the nonce misuse-resistance property, encryption requires two
 passes on the plaintext, hence no streaming API is provided.  This AEAD
 operates on complete inputs held in memory.  For simplicity, the
 implementation of decryption uses a similar pattern, with performance
 penalty compared to an implementation which is able to merge both passes.</p><p>The specification allows inputs up to 2^36 bytes but this implementation
 requires AAD and plaintext/ciphertext to be both smaller than 2^32 bytes.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Nonce">Nonce</a></li><li class="src short"><a href="#v:nonce">nonce</a> :: <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> iv =&gt; iv -&gt; <a href="Crypto-Error.html#t:CryptoFailable" title="Crypto.Error">CryptoFailable</a> <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a></li><li class="src short"><a href="#v:generateNonce">generateNonce</a> :: <a href="Crypto-Random-Types.html#t:MonadRandom" title="Crypto.Random.Types">MonadRandom</a> m =&gt; m <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a></li><li class="src short"><a href="#v:encrypt">encrypt</a> :: (<a href="Crypto-Cipher-Types.html#t:BlockCipher128" title="Crypto.Cipher.Types">BlockCipher128</a> aes, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> aad, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArray" title="Data.ByteArray">ByteArray</a> ba) =&gt; aes -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; aad -&gt; ba -&gt; (<a href="Crypto-Cipher-Types.html#t:AuthTag" title="Crypto.Cipher.Types">AuthTag</a>, ba)</li><li class="src short"><a href="#v:decrypt">decrypt</a> :: (<a href="Crypto-Cipher-Types.html#t:BlockCipher128" title="Crypto.Cipher.Types">BlockCipher128</a> aes, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> aad, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArray" title="Data.ByteArray">ByteArray</a> ba) =&gt; aes -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; aad -&gt; ba -&gt; <a href="Crypto-Cipher-Types.html#t:AuthTag" title="Crypto.Cipher.Types">AuthTag</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> ba</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Nonce" class="def">Nonce</a> <a href="src/Crypto.Cipher.AESGCMSIV.html#Nonce" class="link">Source</a> <a href="#t:Nonce" class="selflink">#</a></p><div class="doc"><p>Nonce value for AES-GCM-SIV, always 12 bytes.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Nonce">Instances</h4><details id="i:Nonce" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Nonce:Show:1"></span> <a href="../base-4.18.2.1/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a></span> <a href="src/Crypto.Cipher.AESGCMSIV.html#line-52" class="link">Source</a> <a href="#t:Nonce" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Nonce:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Cipher-AESGCMSIV.html">Crypto.Cipher.AESGCMSIV</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a>] -&gt; <a href="../base-4.18.2.1/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Nonce:Eq:2"></span> <a href="../base-4.18.2.1/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a></span> <a href="src/Crypto.Cipher.AESGCMSIV.html#line-52" class="link">Source</a> <a href="#t:Nonce" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Nonce:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Cipher-AESGCMSIV.html">Crypto.Cipher.AESGCMSIV</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Nonce:ByteArrayAccess:3"></span> <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a></span> <a href="src/Crypto.Cipher.AESGCMSIV.html#line-52" class="link">Source</a> <a href="#t:Nonce" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Nonce:ByteArrayAccess:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Cipher-AESGCMSIV.html">Crypto.Cipher.AESGCMSIV</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:length">length</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="#v:length" class="selflink">#</a></p><p class="src"><a href="#v:withByteArray">withByteArray</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; (<a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a) -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> a <a href="#v:withByteArray" class="selflink">#</a></p><p class="src"><a href="#v:copyByteArrayToPtr">copyByteArrayToPtr</a> :: <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; <a href="../base-4.18.2.1/Foreign-Ptr.html#t:Ptr" title="Foreign.Ptr">Ptr</a> p -&gt; <a href="../base-4.18.2.1/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="#v:copyByteArrayToPtr" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:nonce" class="def">nonce</a> :: <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> iv =&gt; iv -&gt; <a href="Crypto-Error.html#t:CryptoFailable" title="Crypto.Error">CryptoFailable</a> <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> <a href="src/Crypto.Cipher.AESGCMSIV.html#nonce" class="link">Source</a> <a href="#v:nonce" class="selflink">#</a></p><div class="doc"><p>Nonce smart constructor.  Accepts only 12-byte inputs.</p></div></div><div class="top"><p class="src"><a id="v:generateNonce" class="def">generateNonce</a> :: <a href="Crypto-Random-Types.html#t:MonadRandom" title="Crypto.Random.Types">MonadRandom</a> m =&gt; m <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> <a href="src/Crypto.Cipher.AESGCMSIV.html#generateNonce" class="link">Source</a> <a href="#v:generateNonce" class="selflink">#</a></p><div class="doc"><p>Generate a random nonce for use with AES-GCM-SIV.</p></div></div><div class="top"><p class="src"><a id="v:encrypt" class="def">encrypt</a> :: (<a href="Crypto-Cipher-Types.html#t:BlockCipher128" title="Crypto.Cipher.Types">BlockCipher128</a> aes, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> aad, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArray" title="Data.ByteArray">ByteArray</a> ba) =&gt; aes -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; aad -&gt; ba -&gt; (<a href="Crypto-Cipher-Types.html#t:AuthTag" title="Crypto.Cipher.Types">AuthTag</a>, ba) <a href="src/Crypto.Cipher.AESGCMSIV.html#encrypt" class="link">Source</a> <a href="#v:encrypt" class="selflink">#</a></p><div class="doc"><p>AEAD encryption with the specified key and nonce.  The key must be given
 as an initialized <code><a href="Crypto-Cipher-AES.html#v:AES128" title="Crypto.Cipher.AES">AES128</a></code> or <code><a href="Crypto-Cipher-AES.html#v:AES256" title="Crypto.Cipher.AES">AES256</a></code>
 cipher.</p><p>Lengths of additional data and plaintext must be less than 2^32 bytes,
 otherwise an exception is thrown.</p></div></div><div class="top"><p class="src"><a id="v:decrypt" class="def">decrypt</a> :: (<a href="Crypto-Cipher-Types.html#t:BlockCipher128" title="Crypto.Cipher.Types">BlockCipher128</a> aes, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArrayAccess" title="Data.ByteArray">ByteArrayAccess</a> aad, <a href="../memory-0.18.0/Data-ByteArray.html#t:ByteArray" title="Data.ByteArray">ByteArray</a> ba) =&gt; aes -&gt; <a href="Crypto-Cipher-AESGCMSIV.html#t:Nonce" title="Crypto.Cipher.AESGCMSIV">Nonce</a> -&gt; aad -&gt; ba -&gt; <a href="Crypto-Cipher-Types.html#t:AuthTag" title="Crypto.Cipher.Types">AuthTag</a> -&gt; <a href="../base-4.18.2.1/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> ba <a href="src/Crypto.Cipher.AESGCMSIV.html#decrypt" class="link">Source</a> <a href="#v:decrypt" class="selflink">#</a></p><div class="doc"><p>AEAD decryption with the specified key and nonce.  The key must be given
 as an initialized <code><a href="Crypto-Cipher-AES.html#v:AES128" title="Crypto.Cipher.AES">AES128</a></code> or <code><a href="Crypto-Cipher-AES.html#v:AES256" title="Crypto.Cipher.AES">AES256</a></code>
 cipher.</p><p>Lengths of additional data and ciphertext must be less than 2^32 bytes,
 otherwise an exception is thrown.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>