<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">{-|
Module      : Text.Pretty.Simple.Internal.ExprParser
Copyright   : (c) Dennis Gosnell, 2016
License     : BSD-style (see LICENSE file)
Maintainer  : cdep.illabout@gmail.com
Stability   : experimental
Portability : POSIX

-}</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Pretty.Simple.Internal.ExprParser</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html"><span class="hs-identifier">Text.Pretty.Simple.Internal.Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#CommaSeparated"><span class="hs-identifier">CommaSeparated</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#Expr"><span class="hs-identifier">Expr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlpha</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isDigit</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | 'testString1' and 'testString2' are convenient to use in GHCi when playing</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- around with how parsing works.</span><span>
</span><span id="line-24"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#testString1"><span class="hs-identifier hs-type">testString1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-25"></span><span id="testString1"><span class="annot"><span class="annottext">testString1 :: String
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#testString1"><span class="hs-identifier hs-var hs-var">testString1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Just [TextInput {textInputClass = Just (Class {unClass = \&quot;class\&quot;}), textInputId = Just (Id {unId = \&quot;id\&quot;}), textInputName = Just (Name {unName = \&quot;name\&quot;}), textInputValue = Just (Value {unValue = \&quot;value\&quot;}), textInputPlaceholder = Just (Placeholder {unPlaceholder = \&quot;placeholder\&quot;})}, TextInput {textInputClass = Just (Class {unClass = \&quot;class\&quot;}), textInputId = Just (Id {unId = \&quot;id\&quot;}), textInputName = Just (Name {unName = \&quot;name\&quot;}), textInputValue = Just (Value {unValue = \&quot;value\&quot;}), textInputPlaceholder = Just (Placeholder {unPlaceholder = \&quot;placeholder\&quot;})}]&quot;</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><span class="hs-comment">-- | See 'testString1'.</span></span><span>
</span><span id="line-28"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#testString2"><span class="hs-identifier hs-type">testString2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-29"></span><span id="testString2"><span class="annot"><span class="annottext">testString2 :: String
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#testString2"><span class="hs-identifier hs-var hs-var">testString2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;some stuff (hello [\&quot;dia\\x40iahello\&quot;, why wh, bye] ) (bye)&quot;</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#expressionParse"><span class="hs-identifier hs-type">expressionParse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span id="expressionParse"><span class="annot"><span class="annottext">expressionParse :: String -&gt; [Expr]
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#expressionParse"><span class="hs-identifier hs-var hs-var">expressionParse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Expr], String) -&gt; [Expr]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([Expr], String) -&gt; [Expr])
-&gt; (String -&gt; ([Expr], String)) -&gt; String -&gt; [Expr]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Expr], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-var">parseExprs</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-type">parseExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span id="parseExpr"><span class="annot"><span class="annottext">parseExpr :: String -&gt; (Expr, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var hs-var">parseExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'('</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066382"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066382"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Expr]] -&gt; Expr) -&gt; ([[Expr]], String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommaSeparated [Expr] -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#Parens"><span class="hs-identifier hs-var">Parens</span></a></span><span> </span><span class="annot"><span class="annottext">(CommaSeparated [Expr] -&gt; Expr)
-&gt; ([[Expr]] -&gt; CommaSeparated [Expr]) -&gt; [[Expr]] -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Expr]] -&gt; CommaSeparated [Expr]
forall a. [a] -&gt; CommaSeparated a
</span><a href="Text.Pretty.Simple.Internal.Expr.html#CommaSeparated"><span class="hs-identifier hs-var">CommaSeparated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([[Expr]], String) -&gt; (Expr, String))
-&gt; ([[Expr]], String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066382"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066386"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066386"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Expr]] -&gt; Expr) -&gt; ([[Expr]], String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommaSeparated [Expr] -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#Brackets"><span class="hs-identifier hs-var">Brackets</span></a></span><span> </span><span class="annot"><span class="annottext">(CommaSeparated [Expr] -&gt; Expr)
-&gt; ([[Expr]] -&gt; CommaSeparated [Expr]) -&gt; [[Expr]] -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Expr]] -&gt; CommaSeparated [Expr]
forall a. [a] -&gt; CommaSeparated a
</span><a href="Text.Pretty.Simple.Internal.Expr.html#CommaSeparated"><span class="hs-identifier hs-var">CommaSeparated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([[Expr]], String) -&gt; (Expr, String))
-&gt; ([[Expr]], String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066386"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066388"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066388"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([[Expr]] -&gt; Expr) -&gt; ([[Expr]], String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommaSeparated [Expr] -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#Braces"><span class="hs-identifier hs-var">Braces</span></a></span><span> </span><span class="annot"><span class="annottext">(CommaSeparated [Expr] -&gt; Expr)
-&gt; ([[Expr]] -&gt; CommaSeparated [Expr]) -&gt; [[Expr]] -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Expr]] -&gt; CommaSeparated [Expr]
forall a. [a] -&gt; CommaSeparated a
</span><a href="Text.Pretty.Simple.Internal.Expr.html#CommaSeparated"><span class="hs-identifier hs-var">CommaSeparated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([[Expr]], String) -&gt; (Expr, String))
-&gt; ([[Expr]], String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066390"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066390"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Expr) -&gt; (String, String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#StringLit"><span class="hs-identifier hs-var">StringLit</span></a></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; (Expr, String))
-&gt; (String, String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066390"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066393"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066393"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Expr) -&gt; (String, String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#CharLit"><span class="hs-identifier hs-var">CharLit</span></a></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; (Expr, String))
-&gt; (String, String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066393"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-40"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066396"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066396"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066397"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066397"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066396"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Expr) -&gt; (String, String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#NumberLit"><span class="hs-identifier hs-var">NumberLit</span></a></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; (Expr, String))
-&gt; (String, String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseNumberLit"><span class="hs-identifier hs-var">parseNumberLit</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066396"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066397"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-41"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span id="local-6989586621679066400"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066400"><span class="hs-identifier hs-var">other</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Expr) -&gt; (String, String) -&gt; (Expr, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Expr
</span><a href="Text.Pretty.Simple.Internal.Expr.html#Other"><span class="hs-identifier hs-var">Other</span></a></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; (Expr, String))
-&gt; (String, String) -&gt; (Expr, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseOther"><span class="hs-identifier hs-var">parseOther</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066400"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Parse multiple expressions.</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- &gt;&gt;&gt; parseExprs &quot;Just 'a'&quot;</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- ([Other &quot;Just &quot;,CharLit &quot;a&quot;],&quot;&quot;)</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- Handle escaped characters correctly</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt;&gt;&gt; parseExprs $ &quot;Foo \&quot;hello \\\&quot;world!\&quot;&quot;</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- ([Other &quot;Foo &quot;,StringLit &quot;hello \\\&quot;world!&quot;],&quot;&quot;)</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &gt;&gt;&gt; parseExprs $ &quot;'\\''&quot;</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- ([CharLit &quot;\\'&quot;],&quot;&quot;)</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-type">parseExprs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span id="parseExprs"><span class="annot"><span class="annottext">parseExprs :: String -&gt; ([Expr], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-var hs-var">parseExprs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-var">parseExprs</span></a></span><span> </span><span id="local-6989586621679066403"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679066403"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679066404"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066404"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066404"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)]},&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066403"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066406"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679066406"><span class="hs-identifier hs-var">parsed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066407"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066407"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Expr, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExpr"><span class="hs-identifier hs-var">parseExpr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066403"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-59"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679066408"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679066408"><span class="hs-identifier hs-var">toParse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066409"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066409"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Expr], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-var">parseExprs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066407"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-60"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679066406"><span class="hs-identifier hs-var">parsed</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; [Expr] -&gt; [Expr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679066408"><span class="hs-identifier hs-var">toParse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066409"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-type">parseCSep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Text.Pretty.Simple.Internal.Expr.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span id="parseCSep"><span class="annot"><span class="annottext">parseCSep :: Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var hs-var">parseCSep</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span id="local-6989586621679066410"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066410"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679066411"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679066411"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679066412"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066412"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066413"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066413"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066412"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066410"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066413"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-comment">-- Mismatch condition; if the end does not match, there is a mistake</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">-- Perhaps there should be a Missing constructor for Expr</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066412"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)]}&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066411"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066412"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066410"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066413"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066414"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679066414"><span class="hs-identifier hs-var">parsed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066415"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066415"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Expr], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseExprs"><span class="hs-identifier hs-var">parseExprs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066411"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-71"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679066416"><span class="annot"><span class="annottext">[[Expr]]
</span><a href="#local-6989586621679066416"><span class="hs-identifier hs-var">toParse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066417"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066417"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; ([[Expr]], String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCSep"><span class="hs-identifier hs-var">parseCSep</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066410"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066415"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-72"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679066414"><span class="hs-identifier hs-var">parsed</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; [[Expr]] -&gt; [[Expr]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[Expr]]
</span><a href="#local-6989586621679066416"><span class="hs-identifier hs-var">toParse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066417"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Parse string literals until a trailing double quote.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt;&gt;&gt; parseStringLit &quot;foobar\&quot; baz&quot;</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- (&quot;foobar&quot;,&quot; baz&quot;)</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- Keep literal back slashes:</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- &gt;&gt;&gt; parseStringLit &quot;foobar\\\&quot; baz\&quot; after&quot;</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- (&quot;foobar\\\&quot; baz&quot;,&quot; after&quot;)</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-type">parseStringLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="parseStringLit"><span class="annot"><span class="annottext">parseStringLit :: String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var hs-var">parseStringLit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066418"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066418"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066418"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066419"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066419"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066420"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066420"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066419"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066421"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066422"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066421"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066421"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066422"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066422"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066420"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066423"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066423"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066424"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066424"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066423"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066425"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066426"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066425"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066425"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066426"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066426"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseStringLit"><span class="hs-identifier hs-var">parseStringLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066424"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Parse character literals until a trailing single quote.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;&gt;&gt; parseCharLit &quot;a' foobar&quot;</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- (&quot;a&quot;,&quot; foobar&quot;)</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- Keep literal back slashes:</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- &gt;&gt;&gt; parseCharLit &quot;\\'' hello&quot;</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- (&quot;\\'&quot;,&quot; hello&quot;)</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-type">parseCharLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span id="parseCharLit"><span class="annot"><span class="annottext">parseCharLit :: String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var hs-var">parseCharLit</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066427"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066427"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066427"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066428"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066428"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066429"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066429"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066428"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066430"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066431"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066430"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066430"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066431"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066431"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066429"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066432"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066432"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066433"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066433"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066432"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066434"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066435"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066434"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066434"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066435"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066435"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseCharLit"><span class="hs-identifier hs-var">parseCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066433"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Parses integers and reals, like @123@ and @45.67@.</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- To be more precise, any numbers matching the regex @\\d+(\\.\\d+)?@ should</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- get parsed by this function.</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;&gt;&gt; parseNumberLit '3' &quot;456hello world []&quot;</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- (&quot;3456&quot;,&quot;hello world []&quot;)</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &gt;&gt;&gt; parseNumberLit '0' &quot;.12399880 foobar&quot;</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- (&quot;0.12399880&quot;,&quot; foobar&quot;)</span><span>
</span><span id="line-117"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseNumberLit"><span class="hs-identifier hs-type">parseNumberLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span id="parseNumberLit"><span class="annot"><span class="annottext">parseNumberLit :: Char -&gt; String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseNumberLit"><span class="hs-identifier hs-var hs-var">parseNumberLit</span></a></span></span><span> </span><span id="local-6989586621679066436"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066436"><span class="hs-identifier hs-var">firstDigit</span></a></span></span><span> </span><span id="local-6989586621679066437"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066437"><span class="hs-identifier hs-var">rest1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066438"><span class="hs-identifier hs-var">rest2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066436"><span class="hs-identifier hs-var">firstDigit</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066439"><span class="hs-identifier hs-var">remainingDigits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066440"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066440"><span class="hs-identifier hs-var">rest3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679066441"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066441"><span class="hs-identifier hs-var">digitsAfterDot</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066442"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066442"><span class="hs-identifier hs-var">rest4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066440"><span class="hs-identifier hs-var">rest3</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066436"><span class="hs-identifier hs-var">firstDigit</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066439"><span class="hs-identifier hs-var">remainingDigits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066441"><span class="hs-identifier hs-var">digitsAfterDot</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066442"><span class="hs-identifier hs-var">rest4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066436"><span class="hs-identifier hs-var">firstDigit</span></a></span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066439"><span class="hs-identifier hs-var">remainingDigits</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066438"><span class="hs-identifier hs-var">rest2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621679066439"><span class="hs-identifier hs-type">remainingDigits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="#local-6989586621679066438"><span class="hs-identifier hs-type">rest2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679066439"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066439"><span class="hs-identifier hs-var">remainingDigits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679066438"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066438"><span class="hs-identifier hs-var">rest2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066437"><span class="hs-identifier hs-var">rest1</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | This function consumes input, stopping only when it hits a special</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- character or a digit.  However, if the digit is in the middle of a</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Haskell-style identifier (e.g. @foo123@), then keep going</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- anyway.</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- This is almost the same as the function</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt; parseOtherSimple = span $ \c -&gt;</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- &gt;   notElem c (&quot;{[()]}\&quot;,&quot; :: String) &amp;&amp; not (isDigit c) &amp;&amp; (c /= '\'')</span><span>
</span><span id="line-139"></span><span class="hs-comment">--</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- except 'parseOther' ignores digits and single quotes that appear in</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Haskell-like identifiers.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;hello world []&quot;</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- (&quot;hello world &quot;,&quot;[]&quot;)</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;hello234 world&quot;</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- (&quot;hello234 world&quot;,&quot;&quot;)</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;hello 234 world&quot;</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- (&quot;hello &quot;,&quot;234 world&quot;)</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;hello{[ 234 world&quot;</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- (&quot;hello&quot;,&quot;{[ 234 world&quot;)</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;H3110 World&quot;</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- (&quot;H3110 World&quot;,&quot;&quot;)</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;Node' (Leaf' 1) (Leaf' 2)&quot;</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- (&quot;Node' &quot;,&quot;(Leaf' 1) (Leaf' 2)&quot;)</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;I'm One&quot;</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- (&quot;I'm One&quot;,&quot;&quot;)</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- &gt;&gt;&gt; parseOther &quot;I'm 2&quot;</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- (&quot;I'm &quot;,&quot;2&quot;)</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseOther"><span class="hs-identifier hs-type">parseOther</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="parseOther"><span class="annot"><span class="annottext">parseOther :: String -&gt; (String, String)
</span><a href="Text.Pretty.Simple.Internal.ExprParser.html#parseOther"><span class="hs-identifier hs-var hs-var">parseOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679066444"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="#local-6989586621679066444"><span class="hs-identifier hs-type">go</span></a></span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-comment">-- ^ in an identifier?</span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679066444"><span class="annot"><span class="annottext">go :: Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679066444"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621679066444"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679066445"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679066445"><span class="hs-identifier hs-var">insideIdent</span></a></span></span><span> </span><span id="local-6989586621679066446"><span class="annot"><span class="annottext">cs :: String
</span><a href="#local-6989586621679066446"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679066447"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679066448"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066448"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{[()]}\&quot;,&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066446"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679066449"><span class="hs-identifier hs-var">ignoreInIdent</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679066445"><span class="hs-identifier hs-var">insideIdent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066446"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679066445"><span class="hs-identifier hs-var">insideIdent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String, String) -&gt; (String, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679066444"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679066452"><span class="hs-identifier hs-var">isIdentRest</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066448"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String, String) -&gt; (String, String)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; (String, String)
</span><a href="#local-6989586621679066444"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679066453"><span class="hs-identifier hs-var">isIdentBegin</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066447"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679066448"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621679066453"><span class="hs-identifier hs-type">isIdentBegin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679066453"><span class="annot"><span class="annottext">isIdentBegin :: Char -&gt; Bool
</span><a href="#local-6989586621679066453"><span class="hs-identifier hs-var hs-var">isIdentBegin</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="#local-6989586621679066453"><span class="hs-identifier hs-var">isIdentBegin</span></a></span><span> </span><span id="local-6989586621679066454"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066454"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066454"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="#local-6989586621679066452"><span class="hs-identifier hs-type">isIdentRest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679066452"><span class="annot"><span class="annottext">isIdentRest :: Char -&gt; Bool
</span><a href="#local-6989586621679066452"><span class="hs-identifier hs-var hs-var">isIdentRest</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="#local-6989586621679066452"><span class="hs-identifier hs-var">isIdentRest</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621679066452"><span class="hs-identifier hs-var">isIdentRest</span></a></span><span> </span><span id="local-6989586621679066455"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066455"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066455"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679066449"><span class="hs-identifier hs-var">ignoreInIdent</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066455"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><a href="#local-6989586621679066449"><span class="hs-identifier hs-type">ignoreInIdent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679066449"><span class="annot"><span class="annottext">ignoreInIdent :: Char -&gt; Bool
</span><a href="#local-6989586621679066449"><span class="hs-identifier hs-var hs-var">ignoreInIdent</span></a></span></span><span> </span><span id="local-6989586621679066457"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066457"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066457"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679066457"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span>
</span><span id="line-185"></span></pre></body></html>